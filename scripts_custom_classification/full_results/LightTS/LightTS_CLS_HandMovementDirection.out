Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2834300994873047
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.392 Vali Acc: 0.284 Test Loss: 1.392 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7056984901428223
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.324 Vali Acc: 0.351 Test Loss: 1.324 Test Acc: 0.351
Validation loss decreased (-0.283770 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.7585668563842773
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
Validation loss decreased (-0.351338 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.6890385150909424
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.137 Vali Acc: 0.473 Test Loss: 1.137 Test Acc: 0.473
Validation loss decreased (-0.445934 --> -0.472962).  Saving model ...
Epoch: 5 cost time: 0.827873945236206
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.116 Vali Acc: 0.500 Test Loss: 1.116 Test Acc: 0.500
Validation loss decreased (-0.472962 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.6614344120025635
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.054 Vali Acc: 0.500 Test Loss: 1.054 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.6346299648284912
Epoch: 7, Steps: 10 | Train Loss: 0.552 Vali Loss: 1.037 Vali Acc: 0.486 Test Loss: 1.037 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7175607681274414
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 0.6658790111541748
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.022 Vali Acc: 0.527 Test Loss: 1.022 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.887249231338501
Epoch: 10, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.078 Vali Acc: 0.581 Test Loss: 1.078 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.6451699733734131
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.024 Vali Acc: 0.527 Test Loss: 1.024 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6684279441833496
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.822058916091919
Epoch: 13, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6582248210906982
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.088 Vali Acc: 0.608 Test Loss: 1.088 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 15 cost time: 0.7345082759857178
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8347280025482178
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6890702247619629
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.287 Vali Acc: 0.595 Test Loss: 1.287 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8407931327819824
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.281 Vali Acc: 0.581 Test Loss: 1.281 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6348721981048584
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.359 Vali Acc: 0.581 Test Loss: 1.359 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8494961261749268
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.421 Vali Acc: 0.581 Test Loss: 1.421 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.854766845703125
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.478 Vali Acc: 0.595 Test Loss: 1.478 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7855033874511719
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.528 Vali Acc: 0.554 Test Loss: 1.528 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7462575435638428
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.582 Vali Acc: 0.554 Test Loss: 1.582 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8246486186981201
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.670 Vali Acc: 0.554 Test Loss: 1.670 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 352932
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs134_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 1.8971564769744873
Epoch: 1, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7603046894073486
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.324 Vali Acc: 0.432 Test Loss: 1.324 Test Acc: 0.432
Validation loss decreased (-0.256743 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.713770866394043
Epoch: 3, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.246 Vali Acc: 0.541 Test Loss: 1.246 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 0.6495392322540283
Epoch: 4, Steps: 10 | Train Loss: 0.947 Vali Loss: 1.192 Vali Acc: 0.514 Test Loss: 1.192 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8635485172271729
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 1.137 Vali Acc: 0.554 Test Loss: 1.137 Test Acc: 0.554
Validation loss decreased (-0.540528 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.6677079200744629
Epoch: 6, Steps: 10 | Train Loss: 0.655 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.7429018020629883
Epoch: 7, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.112 Vali Acc: 0.514 Test Loss: 1.112 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8476736545562744
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.089 Vali Acc: 0.500 Test Loss: 1.089 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8276035785675049
Epoch: 9, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.8158290386199951
Epoch: 10, Steps: 10 | Train Loss: 0.229 Vali Loss: 1.098 Vali Acc: 0.527 Test Loss: 1.098 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7785060405731201
Epoch: 11, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8985671997070312
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.186 Vali Acc: 0.541 Test Loss: 1.186 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7636308670043945
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.231 Vali Acc: 0.541 Test Loss: 1.231 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7797207832336426
Epoch: 14, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7989509105682373
Epoch: 15, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.377 Vali Acc: 0.527 Test Loss: 1.377 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.815964937210083
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.464 Vali Acc: 0.554 Test Loss: 1.464 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6478378772735596
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.519 Vali Acc: 0.541 Test Loss: 1.519 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7124698162078857
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.623 Vali Acc: 0.541 Test Loss: 1.623 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.775183916091919
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.705 Vali Acc: 0.541 Test Loss: 1.705 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs134_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 336850
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0727500915527344
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.429 Vali Acc: 0.189 Test Loss: 1.429 Test Acc: 0.189
Validation loss decreased (inf --> -0.189175).  Saving model ...
Epoch: 2 cost time: 1.0933866500854492
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.334 Vali Acc: 0.419 Test Loss: 1.334 Test Acc: 0.419
Validation loss decreased (-0.189175 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.7500157356262207
Epoch: 3, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9551746845245361
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.7920775413513184
Epoch: 5, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.129 Vali Acc: 0.595 Test Loss: 1.129 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 0.8295681476593018
Epoch: 6, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7900643348693848
Epoch: 7, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.074 Vali Acc: 0.581 Test Loss: 1.074 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9422237873077393
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.999333381652832
Epoch: 9, Steps: 10 | Train Loss: 0.343 Vali Loss: 1.064 Vali Acc: 0.541 Test Loss: 1.064 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9733059406280518
Epoch: 10, Steps: 10 | Train Loss: 0.264 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9053001403808594
Epoch: 11, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7492575645446777
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8916752338409424
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.139 Vali Acc: 0.541 Test Loss: 1.139 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9980742931365967
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.150 Vali Acc: 0.541 Test Loss: 1.150 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7213079929351807
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.188 Vali Acc: 0.568 Test Loss: 1.188 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 327364
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5466041564941406
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.334 Vali Acc: 0.432 Test Loss: 1.334 Test Acc: 0.432
Validation loss decreased (inf --> -0.432419).  Saving model ...
Epoch: 2 cost time: 0.8928663730621338
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.271 Vali Acc: 0.486 Test Loss: 1.271 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 3 cost time: 1.450972318649292
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.201 Vali Acc: 0.514 Test Loss: 1.201 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 0.9134371280670166
Epoch: 4, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7025322914123535
Epoch: 5, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.096 Vali Acc: 0.514 Test Loss: 1.096 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 6 cost time: 0.973473072052002
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.052 Vali Acc: 0.554 Test Loss: 1.052 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 0.9222848415374756
Epoch: 7, Steps: 10 | Train Loss: 0.578 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
Validation loss decreased (-0.554044 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 0.7148642539978027
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.016 Vali Acc: 0.581 Test Loss: 1.016 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7918076515197754
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.009 Vali Acc: 0.568 Test Loss: 1.009 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9503803253173828
Epoch: 10, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.995 Vali Acc: 0.581 Test Loss: 0.995 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7905945777893066
Epoch: 11, Steps: 10 | Train Loss: 0.182 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8412444591522217
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.046 Vali Acc: 0.622 Test Loss: 1.046 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 13 cost time: 0.9407074451446533
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.082 Vali Acc: 0.622 Test Loss: 1.082 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9593410491943359
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.893869161605835
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.075 Vali Acc: 0.622 Test Loss: 1.075 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7601301670074463
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.187 Vali Acc: 0.622 Test Loss: 1.187 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9259147644042969
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.084001064300537
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.214 Vali Acc: 0.622 Test Loss: 1.214 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8144021034240723
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.228 Vali Acc: 0.595 Test Loss: 1.228 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8315398693084717
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.251 Vali Acc: 0.595 Test Loss: 1.251 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9898743629455566
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.289 Vali Acc: 0.595 Test Loss: 1.289 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8825039863586426
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.381 Vali Acc: 0.595 Test Loss: 1.381 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 322266
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8383121490478516
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.340 Vali Acc: 0.311 Test Loss: 1.340 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8337841033935547
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.264 Vali Acc: 0.446 Test Loss: 1.264 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.8823256492614746
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.191 Vali Acc: 0.486 Test Loss: 1.191 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 0.7795069217681885
Epoch: 4, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.127 Vali Acc: 0.554 Test Loss: 1.127 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 0.8357131481170654
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.087 Vali Acc: 0.581 Test Loss: 1.087 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.8630609512329102
Epoch: 6, Steps: 10 | Train Loss: 0.668 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0542664527893066
Epoch: 7, Steps: 10 | Train Loss: 0.541 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.03757643699646
Epoch: 8, Steps: 10 | Train Loss: 0.420 Vali Loss: 1.004 Vali Acc: 0.608 Test Loss: 1.004 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 0.8246314525604248
Epoch: 9, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7800431251525879
Epoch: 10, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9372274875640869
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 1.053 Vali Acc: 0.608 Test Loss: 1.053 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8492553234100342
Epoch: 12, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.050 Vali Acc: 0.608 Test Loss: 1.050 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1705105304718018
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.107 Vali Acc: 0.581 Test Loss: 1.107 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1952154636383057
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.123 Vali Acc: 0.581 Test Loss: 1.123 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9817230701446533
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.165 Vali Acc: 0.554 Test Loss: 1.165 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.003340482711792
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.225 Vali Acc: 0.554 Test Loss: 1.225 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9878602027893066
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.268 Vali Acc: 0.568 Test Loss: 1.268 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9446268081665039
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.315 Vali Acc: 0.527 Test Loss: 1.315 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 319764
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7584123611450195
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.357 Vali Acc: 0.378 Test Loss: 1.357 Test Acc: 0.378
Validation loss decreased (inf --> -0.378365).  Saving model ...
Epoch: 2 cost time: 0.7867801189422607
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.288 Vali Acc: 0.500 Test Loss: 1.288 Test Acc: 0.500
Validation loss decreased (-0.378365 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.7755720615386963
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.208 Vali Acc: 0.554 Test Loss: 1.208 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 0.776686429977417
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.142 Vali Acc: 0.568 Test Loss: 1.142 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 0.9956607818603516
Epoch: 5, Steps: 10 | Train Loss: 0.840 Vali Loss: 1.096 Vali Acc: 0.554 Test Loss: 1.096 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8472623825073242
Epoch: 6, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.2284154891967773
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.042 Vali Acc: 0.514 Test Loss: 1.042 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.133918046951294
Epoch: 8, Steps: 10 | Train Loss: 0.442 Vali Loss: 1.026 Vali Acc: 0.514 Test Loss: 1.026 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0975253582000732
Epoch: 9, Steps: 10 | Train Loss: 0.348 Vali Loss: 1.057 Vali Acc: 0.568 Test Loss: 1.057 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.7038850784301758
Epoch: 10, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.033 Vali Acc: 0.595 Test Loss: 1.033 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.7893362045288086
Epoch: 11, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.057 Vali Acc: 0.608 Test Loss: 1.057 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 0.7836816310882568
Epoch: 12, Steps: 10 | Train Loss: 0.133 Vali Loss: 1.082 Vali Acc: 0.608 Test Loss: 1.082 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.082125186920166
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.097 Vali Acc: 0.635 Test Loss: 1.097 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635124).  Saving model ...
Epoch: 14 cost time: 1.1273438930511475
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0076696872711182
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8031730651855469
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.162 Vali Acc: 0.581 Test Loss: 1.162 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8620603084564209
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.239 Vali Acc: 0.554 Test Loss: 1.239 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9883270263671875
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.248 Vali Acc: 0.568 Test Loss: 1.248 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9006919860839844
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.282 Vali Acc: 0.554 Test Loss: 1.282 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.153918743133545
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.314 Vali Acc: 0.554 Test Loss: 1.314 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0146114826202393
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.367 Vali Acc: 0.527 Test Loss: 1.367 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7904026508331299
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.403 Vali Acc: 0.541 Test Loss: 1.403 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8446006774902344
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.459 Vali Acc: 0.541 Test Loss: 1.459 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 319090
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8420565128326416
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.414 Vali Acc: 0.284 Test Loss: 1.414 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1362316608428955
Epoch: 2, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.334 Vali Acc: 0.378 Test Loss: 1.334 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 1.1014060974121094
Epoch: 3, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.253 Vali Acc: 0.459 Test Loss: 1.253 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.7452957630157471
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.193 Vali Acc: 0.432 Test Loss: 1.193 Test Acc: 0.432
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.079620599746704
Epoch: 5, Steps: 10 | Train Loss: 0.795 Vali Loss: 1.157 Vali Acc: 0.486 Test Loss: 1.157 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.8887383937835693
Epoch: 6, Steps: 10 | Train Loss: 0.649 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.8407869338989258
Epoch: 7, Steps: 10 | Train Loss: 0.529 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.7731006145477295
Epoch: 8, Steps: 10 | Train Loss: 0.407 Vali Loss: 1.086 Vali Acc: 0.554 Test Loss: 1.086 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1295809745788574
Epoch: 9, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0050804615020752
Epoch: 10, Steps: 10 | Train Loss: 0.233 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9844076633453369
Epoch: 11, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.111 Vali Acc: 0.554 Test Loss: 1.111 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.007704257965088
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9582498073577881
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.136 Vali Acc: 0.568 Test Loss: 1.136 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8553783893585205
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.171 Vali Acc: 0.581 Test Loss: 1.171 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 15 cost time: 1.0274975299835205
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.204 Vali Acc: 0.568 Test Loss: 1.204 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8553762435913086
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.287 Vali Acc: 0.568 Test Loss: 1.287 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9654903411865234
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.331 Vali Acc: 0.554 Test Loss: 1.331 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9325122833251953
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.397 Vali Acc: 0.568 Test Loss: 1.397 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0631849765777588
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.426 Vali Acc: 0.554 Test Loss: 1.426 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.097318172454834
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.534 Vali Acc: 0.527 Test Loss: 1.534 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.992379903793335
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.578 Vali Acc: 0.554 Test Loss: 1.578 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2240753173828125
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.641 Vali Acc: 0.527 Test Loss: 1.641 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.770169734954834
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.731 Vali Acc: 0.554 Test Loss: 1.731 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9132585525512695
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.802 Vali Acc: 0.541 Test Loss: 1.802 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 314676
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2924742698669434
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.390 Vali Acc: 0.270 Test Loss: 1.390 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6609561443328857
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.322 Vali Acc: 0.392 Test Loss: 1.322 Test Acc: 0.392
Validation loss decreased (-0.270256 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9839887619018555
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.240 Vali Acc: 0.459 Test Loss: 1.240 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.830345869064331
Epoch: 4, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.174 Vali Acc: 0.486 Test Loss: 1.174 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.676292896270752
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.132 Vali Acc: 0.514 Test Loss: 1.132 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.940873384475708
Epoch: 6, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8114109039306641
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8206188678741455
Epoch: 8, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.0594327449798584
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 1.0294370651245117
Epoch: 10, Steps: 10 | Train Loss: 0.243 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8118939399719238
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4161722660064697
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.101 Vali Acc: 0.554 Test Loss: 1.101 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8815882205963135
Epoch: 13, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0481798648834229
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.144 Vali Acc: 0.541 Test Loss: 1.144 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2946465015411377
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1231048107147217
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.217 Vali Acc: 0.527 Test Loss: 1.217 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8396403789520264
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.264 Vali Acc: 0.541 Test Loss: 1.264 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8916614055633545
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.307 Vali Acc: 0.568 Test Loss: 1.307 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9771111011505127
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.340 Vali Acc: 0.554 Test Loss: 1.340 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 315434
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8217525482177734
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.387 Vali Acc: 0.243 Test Loss: 1.387 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.8315224647521973
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.307 Vali Acc: 0.338 Test Loss: 1.307 Test Acc: 0.338
Validation loss decreased (-0.243229 --> -0.337825).  Saving model ...
Epoch: 3 cost time: 0.9746706485748291
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.221 Vali Acc: 0.459 Test Loss: 1.221 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.019721269607544
Epoch: 4, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.154 Vali Acc: 0.514 Test Loss: 1.154 Test Acc: 0.514
Validation loss decreased (-0.459447 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8294632434844971
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.102 Vali Acc: 0.581 Test Loss: 1.102 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.8170382976531982
Epoch: 6, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8461499214172363
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.070 Vali Acc: 0.541 Test Loss: 1.070 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0364673137664795
Epoch: 8, Steps: 10 | Train Loss: 0.426 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 0.9644076824188232
Epoch: 9, Steps: 10 | Train Loss: 0.324 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7980363368988037
Epoch: 10, Steps: 10 | Train Loss: 0.248 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7814409732818604
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 1.061 Vali Acc: 0.554 Test Loss: 1.061 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.010894775390625
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9423174858093262
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.068 Vali Acc: 0.541 Test Loss: 1.068 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9024605751037598
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.113 Vali Acc: 0.541 Test Loss: 1.113 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9587223529815674
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.139 Vali Acc: 0.527 Test Loss: 1.139 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8250699043273926
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.161 Vali Acc: 0.514 Test Loss: 1.161 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8110339641571045
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7287521362304688
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.221 Vali Acc: 0.554 Test Loss: 1.221 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 312196
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3246378898620605
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.369 Vali Acc: 0.311 Test Loss: 1.369 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.6511752605438232
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.291 Vali Acc: 0.392 Test Loss: 1.291 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7472059726715088
Epoch: 3, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.209 Vali Acc: 0.554 Test Loss: 1.209 Test Acc: 0.554
Validation loss decreased (-0.391879 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 0.8991670608520508
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 0.7909195423126221
Epoch: 5, Steps: 10 | Train Loss: 0.831 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7970778942108154
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.075 Vali Acc: 0.568 Test Loss: 1.075 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.6966667175292969
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.054 Vali Acc: 0.541 Test Loss: 1.054 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8351800441741943
Epoch: 8, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.028 Vali Acc: 0.527 Test Loss: 1.028 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8207650184631348
Epoch: 9, Steps: 10 | Train Loss: 0.345 Vali Loss: 1.039 Vali Acc: 0.554 Test Loss: 1.039 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1772727966308594
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.054 Vali Acc: 0.554 Test Loss: 1.054 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8186414241790771
Epoch: 11, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.7169268131256104
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 0.6770510673522949
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.113 Vali Acc: 0.568 Test Loss: 1.113 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8261148929595947
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.140 Vali Acc: 0.568 Test Loss: 1.140 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7608363628387451
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8182027339935303
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.199 Vali Acc: 0.568 Test Loss: 1.199 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7352128028869629
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.221 Vali Acc: 0.568 Test Loss: 1.221 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9481668472290039
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.235 Vali Acc: 0.568 Test Loss: 1.235 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8636720180511475
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.282 Vali Acc: 0.568 Test Loss: 1.282 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8057963848114014
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.310 Vali Acc: 0.581 Test Loss: 1.310 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8254563808441162
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.312 Vali Acc: 0.554 Test Loss: 1.312 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8646533489227295
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.358 Vali Acc: 0.581 Test Loss: 1.358 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 314274
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.29862904548645
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.340 Vali Acc: 0.338 Test Loss: 1.340 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.7518584728240967
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.6262702941894531
Epoch: 3, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.215 Vali Acc: 0.473 Test Loss: 1.215 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.8082752227783203
Epoch: 4, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.154 Vali Acc: 0.486 Test Loss: 1.154 Test Acc: 0.486
Validation loss decreased (-0.472961 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.7163612842559814
Epoch: 5, Steps: 10 | Train Loss: 0.811 Vali Loss: 1.095 Vali Acc: 0.527 Test Loss: 1.095 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.7694590091705322
Epoch: 6, Steps: 10 | Train Loss: 0.662 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.7773404121398926
Epoch: 7, Steps: 10 | Train Loss: 0.528 Vali Loss: 1.047 Vali Acc: 0.554 Test Loss: 1.047 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 1.1205921173095703
Epoch: 8, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.035 Vali Acc: 0.541 Test Loss: 1.035 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9509153366088867
Epoch: 9, Steps: 10 | Train Loss: 0.319 Vali Loss: 1.061 Vali Acc: 0.541 Test Loss: 1.061 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8155856132507324
Epoch: 10, Steps: 10 | Train Loss: 0.230 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0615274906158447
Epoch: 11, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.037 Vali Acc: 0.541 Test Loss: 1.037 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7867844104766846
Epoch: 12, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 1.0320930480957031
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.093 Vali Acc: 0.554 Test Loss: 1.093 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9538333415985107
Epoch: 14, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8835711479187012
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.740126371383667
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.831702709197998
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8969547748565674
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.204 Vali Acc: 0.541 Test Loss: 1.204 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0737168788909912
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9387626647949219
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.259 Vali Acc: 0.554 Test Loss: 1.259 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9562764167785645
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0625059604644775
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.307 Vali Acc: 0.568 Test Loss: 1.307 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 313956
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.371222496032715
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8214423656463623
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.335 Vali Acc: 0.338 Test Loss: 1.335 Test Acc: 0.338
Validation loss decreased (-0.270256 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.9662432670593262
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.252 Vali Acc: 0.392 Test Loss: 1.252 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.6772332191467285
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.167 Vali Acc: 0.527 Test Loss: 1.167 Test Acc: 0.527
Validation loss decreased (-0.391879 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.8251135349273682
Epoch: 5, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.7829251289367676
Epoch: 6, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.063 Vali Acc: 0.527 Test Loss: 1.063 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1666045188903809
Epoch: 7, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.8006017208099365
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.1146905422210693
Epoch: 9, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9974329471588135
Epoch: 10, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.027 Vali Acc: 0.581 Test Loss: 1.027 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.9884884357452393
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.030 Vali Acc: 0.581 Test Loss: 1.030 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1480803489685059
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9351623058319092
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8618872165679932
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.148 Vali Acc: 0.568 Test Loss: 1.148 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6924388408660889
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.182 Vali Acc: 0.581 Test Loss: 1.182 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9659683704376221
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.210 Vali Acc: 0.595 Test Loss: 1.210 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 0.7848260402679443
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.244 Vali Acc: 0.554 Test Loss: 1.244 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9355294704437256
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.303 Vali Acc: 0.554 Test Loss: 1.303 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.786914587020874
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.340 Vali Acc: 0.554 Test Loss: 1.340 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8954324722290039
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.382 Vali Acc: 0.568 Test Loss: 1.382 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8385851383209229
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.443 Vali Acc: 0.595 Test Loss: 1.443 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8638849258422852
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.473 Vali Acc: 0.581 Test Loss: 1.473 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7635388374328613
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.507 Vali Acc: 0.595 Test Loss: 1.507 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8754854202270508
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.532 Vali Acc: 0.581 Test Loss: 1.532 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9113953113555908
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.595 Vali Acc: 0.595 Test Loss: 1.595 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7866570949554443
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.615 Vali Acc: 0.581 Test Loss: 1.615 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 311242
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.551682710647583
Epoch: 1, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
Validation loss decreased (inf --> -0.243229).  Saving model ...
Epoch: 2 cost time: 0.9993700981140137
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.330 Vali Acc: 0.351 Test Loss: 1.330 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9086968898773193
Epoch: 3, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.234 Vali Acc: 0.486 Test Loss: 1.234 Test Acc: 0.486
Validation loss decreased (-0.351338 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.0719120502471924
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.181 Vali Acc: 0.514 Test Loss: 1.181 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.6818380355834961
Epoch: 5, Steps: 10 | Train Loss: 0.801 Vali Loss: 1.134 Vali Acc: 0.554 Test Loss: 1.134 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.7648153305053711
Epoch: 6, Steps: 10 | Train Loss: 0.660 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.7506988048553467
Epoch: 7, Steps: 10 | Train Loss: 0.533 Vali Loss: 1.088 Vali Acc: 0.581 Test Loss: 1.088 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.7093949317932129
Epoch: 8, Steps: 10 | Train Loss: 0.412 Vali Loss: 1.060 Vali Acc: 0.527 Test Loss: 1.060 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7751777172088623
Epoch: 9, Steps: 10 | Train Loss: 0.310 Vali Loss: 1.055 Vali Acc: 0.568 Test Loss: 1.055 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9799809455871582
Epoch: 10, Steps: 10 | Train Loss: 0.222 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8242635726928711
Epoch: 11, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1830105781555176
Epoch: 12, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.112 Vali Acc: 0.568 Test Loss: 1.112 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.126767635345459
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.095 Vali Acc: 0.568 Test Loss: 1.095 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.83890700340271
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1048905849456787
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.176 Vali Acc: 0.595 Test Loss: 1.176 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 16 cost time: 0.9318039417266846
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.209 Vali Acc: 0.595 Test Loss: 1.209 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.930307149887085
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.253 Vali Acc: 0.581 Test Loss: 1.253 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9047369956970215
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.261 Vali Acc: 0.595 Test Loss: 1.261 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9516780376434326
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.320 Vali Acc: 0.595 Test Loss: 1.320 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9113187789916992
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.339 Vali Acc: 0.581 Test Loss: 1.339 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7560052871704102
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.386 Vali Acc: 0.581 Test Loss: 1.386 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8994784355163574
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.411 Vali Acc: 0.595 Test Loss: 1.411 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8463611602783203
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.455 Vali Acc: 0.568 Test Loss: 1.455 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9883489608764648
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.501 Vali Acc: 0.581 Test Loss: 1.501 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8744630813598633
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.519 Vali Acc: 0.554 Test Loss: 1.519 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 311988
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5044171810150146
Epoch: 1, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.422 Vali Acc: 0.284 Test Loss: 1.422 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7157964706420898
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.353 Vali Acc: 0.338 Test Loss: 1.353 Test Acc: 0.338
Validation loss decreased (-0.283770 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.8841748237609863
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.281 Vali Acc: 0.459 Test Loss: 1.281 Test Acc: 0.459
Validation loss decreased (-0.337824 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.9039971828460693
Epoch: 4, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.212 Vali Acc: 0.527 Test Loss: 1.212 Test Acc: 0.527
Validation loss decreased (-0.459447 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.9204070568084717
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.766082763671875
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9744765758514404
Epoch: 7, Steps: 10 | Train Loss: 0.546 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9267644882202148
Epoch: 8, Steps: 10 | Train Loss: 0.425 Vali Loss: 1.097 Vali Acc: 0.514 Test Loss: 1.097 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8781919479370117
Epoch: 9, Steps: 10 | Train Loss: 0.331 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9393510818481445
Epoch: 10, Steps: 10 | Train Loss: 0.240 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 11 cost time: 0.786341667175293
Epoch: 11, Steps: 10 | Train Loss: 0.180 Vali Loss: 1.142 Vali Acc: 0.541 Test Loss: 1.142 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8784909248352051
Epoch: 12, Steps: 10 | Train Loss: 0.130 Vali Loss: 1.147 Vali Acc: 0.595 Test Loss: 1.147 Test Acc: 0.595
Validation loss decreased (-0.540530 --> -0.594583).  Saving model ...
Epoch: 13 cost time: 0.9984588623046875
Epoch: 13, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.147 Vali Acc: 0.608 Test Loss: 1.147 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 0.933781623840332
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.185 Vali Acc: 0.595 Test Loss: 1.185 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8685085773468018
Epoch: 15, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.223 Vali Acc: 0.568 Test Loss: 1.223 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9104611873626709
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.255 Vali Acc: 0.568 Test Loss: 1.255 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9471077919006348
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.294 Vali Acc: 0.568 Test Loss: 1.294 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.929680347442627
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.319 Vali Acc: 0.554 Test Loss: 1.319 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.050135850906372
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.339 Vali Acc: 0.568 Test Loss: 1.339 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9618182182312012
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.422 Vali Acc: 0.541 Test Loss: 1.422 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.127335548400879
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.402 Vali Acc: 0.554 Test Loss: 1.402 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9281094074249268
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.462 Vali Acc: 0.527 Test Loss: 1.462 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0779805183410645
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.463 Vali Acc: 0.554 Test Loss: 1.463 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 311138
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7541818618774414
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.9092769622802734
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.328 Vali Acc: 0.419 Test Loss: 1.328 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8122551441192627
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.249 Vali Acc: 0.486 Test Loss: 1.249 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.8143022060394287
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.188 Vali Acc: 0.514 Test Loss: 1.188 Test Acc: 0.514
Validation loss decreased (-0.486474 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8117573261260986
Epoch: 5, Steps: 10 | Train Loss: 0.821 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7487261295318604
Epoch: 6, Steps: 10 | Train Loss: 0.677 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8028774261474609
Epoch: 7, Steps: 10 | Train Loss: 0.549 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.7345399856567383
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.099 Vali Acc: 0.581 Test Loss: 1.099 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 0.824061393737793
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.759122371673584
Epoch: 10, Steps: 10 | Train Loss: 0.238 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0250825881958008
Epoch: 11, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.156 Vali Acc: 0.541 Test Loss: 1.156 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8068733215332031
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8742659091949463
Epoch: 13, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.282 Vali Acc: 0.514 Test Loss: 1.282 Test Acc: 0.514
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9832966327667236
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.344 Vali Acc: 0.541 Test Loss: 1.344 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9470517635345459
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.392 Vali Acc: 0.541 Test Loss: 1.392 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.974334716796875
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.455 Vali Acc: 0.527 Test Loss: 1.455 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9459705352783203
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.525 Vali Acc: 0.527 Test Loss: 1.525 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8658492565155029
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.546 Vali Acc: 0.554 Test Loss: 1.546 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 308692
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6091325283050537
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.421 Vali Acc: 0.216 Test Loss: 1.421 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8799738883972168
Epoch: 2, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.345 Vali Acc: 0.284 Test Loss: 1.345 Test Acc: 0.284
Validation loss decreased (-0.216202 --> -0.283770).  Saving model ...
Epoch: 3 cost time: 1.0049619674682617
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.269 Vali Acc: 0.419 Test Loss: 1.269 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 1.067444086074829
Epoch: 4, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.201 Vali Acc: 0.459 Test Loss: 1.201 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 0.9361042976379395
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.140 Vali Acc: 0.500 Test Loss: 1.140 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.9216084480285645
Epoch: 6, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.110 Vali Acc: 0.527 Test Loss: 1.110 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.8417403697967529
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.087 Vali Acc: 0.527 Test Loss: 1.087 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.896228551864624
Epoch: 8, Steps: 10 | Train Loss: 0.434 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.7925209999084473
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6890153884887695
Epoch: 10, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 0.7457904815673828
Epoch: 11, Steps: 10 | Train Loss: 0.169 Vali Loss: 1.094 Vali Acc: 0.595 Test Loss: 1.094 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.8394515514373779
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7502949237823486
Epoch: 13, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.144 Vali Acc: 0.568 Test Loss: 1.144 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7565402984619141
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6832983493804932
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.227 Vali Acc: 0.541 Test Loss: 1.227 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9723925590515137
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.280 Vali Acc: 0.608 Test Loss: 1.280 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608095).  Saving model ...
Epoch: 17 cost time: 0.8399081230163574
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.307 Vali Acc: 0.595 Test Loss: 1.307 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7493112087249756
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6647543907165527
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.406 Vali Acc: 0.581 Test Loss: 1.406 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9624330997467041
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.454 Vali Acc: 0.554 Test Loss: 1.454 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8175809383392334
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.490 Vali Acc: 0.581 Test Loss: 1.490 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.166463851928711
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.526 Vali Acc: 0.568 Test Loss: 1.526 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8153672218322754
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.600 Vali Acc: 0.541 Test Loss: 1.600 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7499537467956543
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.634 Vali Acc: 0.595 Test Loss: 1.634 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1260406970977783
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.675 Vali Acc: 0.541 Test Loss: 1.675 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9166994094848633
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.729 Vali Acc: 0.568 Test Loss: 1.729 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 311706
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4328534603118896
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.438 Vali Acc: 0.162 Test Loss: 1.438 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 0.8777492046356201
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.346 Vali Acc: 0.311 Test Loss: 1.346 Test Acc: 0.311
Validation loss decreased (-0.162148 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.6986274719238281
Epoch: 3, Steps: 10 | Train Loss: 1.132 Vali Loss: 1.261 Vali Acc: 0.432 Test Loss: 1.261 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.8405821323394775
Epoch: 4, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.7663121223449707
Epoch: 5, Steps: 10 | Train Loss: 0.805 Vali Loss: 1.135 Vali Acc: 0.527 Test Loss: 1.135 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.77189040184021
Epoch: 6, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.7959535121917725
Epoch: 7, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.897000789642334
Epoch: 8, Steps: 10 | Train Loss: 0.419 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7189180850982666
Epoch: 9, Steps: 10 | Train Loss: 0.326 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.8371062278747559
Epoch: 10, Steps: 10 | Train Loss: 0.241 Vali Loss: 1.058 Vali Acc: 0.554 Test Loss: 1.058 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8394372463226318
Epoch: 11, Steps: 10 | Train Loss: 0.170 Vali Loss: 1.050 Vali Acc: 0.527 Test Loss: 1.050 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7936389446258545
Epoch: 12, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 0.7197234630584717
Epoch: 13, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.131 Vali Acc: 0.514 Test Loss: 1.131 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.84372878074646
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9734880924224854
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7089362144470215
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7062461376190186
Epoch: 17, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.164 Vali Acc: 0.541 Test Loss: 1.164 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7358236312866211
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.183 Vali Acc: 0.568 Test Loss: 1.183 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7072885036468506
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.209 Vali Acc: 0.581 Test Loss: 1.209 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6228678226470947
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.217 Vali Acc: 0.568 Test Loss: 1.217 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8202338218688965
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7127020359039307
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 313924
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3915889263153076
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7648830413818359
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.323 Vali Acc: 0.405 Test Loss: 1.323 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.841191291809082
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.249 Vali Acc: 0.527 Test Loss: 1.249 Test Acc: 0.527
Validation loss decreased (-0.405392 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.9074506759643555
Epoch: 4, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.196 Vali Acc: 0.554 Test Loss: 1.196 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554042).  Saving model ...
Epoch: 5 cost time: 0.9466886520385742
Epoch: 5, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.148 Vali Acc: 0.581 Test Loss: 1.148 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.8597185611724854
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.122 Vali Acc: 0.581 Test Loss: 1.122 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 1.0928995609283447
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9599368572235107
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.114 Vali Acc: 0.554 Test Loss: 1.114 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0677905082702637
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.093 Vali Acc: 0.527 Test Loss: 1.093 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.121354579925537
Epoch: 10, Steps: 10 | Train Loss: 0.260 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.826021671295166
Epoch: 11, Steps: 10 | Train Loss: 0.189 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0028979778289795
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9130923748016357
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.190 Vali Acc: 0.527 Test Loss: 1.190 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7289214134216309
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.188 Vali Acc: 0.554 Test Loss: 1.188 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9831359386444092
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.239 Vali Acc: 0.568 Test Loss: 1.239 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9704909324645996
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594582).  Saving model ...
Epoch: 17 cost time: 0.9263350963592529
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.293 Vali Acc: 0.568 Test Loss: 1.293 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7244176864624023
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.333 Vali Acc: 0.581 Test Loss: 1.333 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8585150241851807
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.347 Vali Acc: 0.554 Test Loss: 1.347 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1557502746582031
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.400 Vali Acc: 0.568 Test Loss: 1.400 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9686622619628906
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.418 Vali Acc: 0.527 Test Loss: 1.418 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0896694660186768
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2116849422454834
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.506 Vali Acc: 0.527 Test Loss: 1.506 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0486364364624023
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.528 Vali Acc: 0.514 Test Loss: 1.528 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0563344955444336
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.585 Vali Acc: 0.541 Test Loss: 1.585 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1167404651641846
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.592 Vali Acc: 0.514 Test Loss: 1.592 Test Acc: 0.514
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 315346
model size : 1.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3039357662200928
Epoch: 1, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.351 Vali Acc: 0.365 Test Loss: 1.351 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.7515730857849121
Epoch: 2, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.287 Vali Acc: 0.378 Test Loss: 1.287 Test Acc: 0.378
Validation loss decreased (-0.364851 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 0.9256467819213867
Epoch: 3, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.224 Vali Acc: 0.405 Test Loss: 1.224 Test Acc: 0.405
Validation loss decreased (-0.378366 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.7887611389160156
Epoch: 4, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.165 Vali Acc: 0.514 Test Loss: 1.165 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.6871874332427979
Epoch: 5, Steps: 10 | Train Loss: 0.787 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.7551834583282471
Epoch: 6, Steps: 10 | Train Loss: 0.648 Vali Loss: 1.092 Vali Acc: 0.581 Test Loss: 1.092 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.7399203777313232
Epoch: 7, Steps: 10 | Train Loss: 0.531 Vali Loss: 1.066 Vali Acc: 0.595 Test Loss: 1.066 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.8595068454742432
Epoch: 8, Steps: 10 | Train Loss: 0.414 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8383023738861084
Epoch: 9, Steps: 10 | Train Loss: 0.315 Vali Loss: 1.059 Vali Acc: 0.568 Test Loss: 1.059 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9397134780883789
Epoch: 10, Steps: 10 | Train Loss: 0.234 Vali Loss: 1.064 Vali Acc: 0.608 Test Loss: 1.064 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 0.9129242897033691
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 1.111 Vali Acc: 0.608 Test Loss: 1.111 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8677465915679932
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.104 Vali Acc: 0.595 Test Loss: 1.104 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1606717109680176
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 14 cost time: 0.9484314918518066
Epoch: 14, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.185 Vali Acc: 0.581 Test Loss: 1.185 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8440389633178711
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.211 Vali Acc: 0.581 Test Loss: 1.211 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0670132637023926
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.230 Vali Acc: 0.581 Test Loss: 1.230 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8662154674530029
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.264 Vali Acc: 0.554 Test Loss: 1.264 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8579797744750977
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.314 Vali Acc: 0.581 Test Loss: 1.314 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.888519287109375
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.350 Vali Acc: 0.568 Test Loss: 1.350 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9468686580657959
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.381 Vali Acc: 0.554 Test Loss: 1.381 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9199283123016357
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.431 Vali Acc: 0.568 Test Loss: 1.431 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7844135761260986
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.473 Vali Acc: 0.568 Test Loss: 1.473 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8990292549133301
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.502 Vali Acc: 0.568 Test Loss: 1.502 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm512_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 307716
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8028504848480225
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.373 Vali Acc: 0.365 Test Loss: 1.373 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.121614933013916
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.9878525733947754
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.432419 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.1686506271362305
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.171 Vali Acc: 0.473 Test Loss: 1.171 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8667700290679932
Epoch: 5, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.9133234024047852
Epoch: 6, Steps: 10 | Train Loss: 0.679 Vali Loss: 1.096 Vali Acc: 0.568 Test Loss: 1.096 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.036890983581543
Epoch: 7, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.067 Vali Acc: 0.541 Test Loss: 1.067 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8306443691253662
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 1.056 Vali Acc: 0.541 Test Loss: 1.056 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8760254383087158
Epoch: 9, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.057 Vali Acc: 0.541 Test Loss: 1.057 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7453415393829346
Epoch: 10, Steps: 10 | Train Loss: 0.249 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.7526392936706543
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.075 Vali Acc: 0.554 Test Loss: 1.075 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9990971088409424
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.109 Vali Acc: 0.568 Test Loss: 1.109 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.963778018951416
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1920347213745117
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.125 Vali Acc: 0.568 Test Loss: 1.125 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.139662265777588
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 16 cost time: 0.8712363243103027
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9932882785797119
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.203 Vali Acc: 0.595 Test Loss: 1.203 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2515747547149658
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.230 Vali Acc: 0.595 Test Loss: 1.230 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0161974430084229
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.256 Vali Acc: 0.581 Test Loss: 1.256 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2269070148468018
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.245107650756836
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.323 Vali Acc: 0.595 Test Loss: 1.323 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0114924907684326
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.357 Vali Acc: 0.608 Test Loss: 1.357 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608095).  Saving model ...
Epoch: 23 cost time: 0.972959041595459
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.411 Vali Acc: 0.595 Test Loss: 1.411 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.087312936782837
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.464 Vali Acc: 0.581 Test Loss: 1.464 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2084298133850098
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.522 Vali Acc: 0.595 Test Loss: 1.522 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.165389060974121
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.612 Vali Acc: 0.595 Test Loss: 1.612 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9586107730865479
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.684 Vali Acc: 0.595 Test Loss: 1.684 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9089429378509521
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.772 Vali Acc: 0.595 Test Loss: 1.772 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9006989002227783
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.867 Vali Acc: 0.595 Test Loss: 1.867 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9578583240509033
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.581 Test Loss: 1.967 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.259049892425537
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.059 Vali Acc: 0.581 Test Loss: 2.059 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0467360019683838
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 2.153 Vali Acc: 0.581 Test Loss: 2.153 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 240356
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs134_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6258692741394043
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.428 Vali Acc: 0.230 Test Loss: 1.428 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.7742700576782227
Epoch: 2, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.351 Vali Acc: 0.324 Test Loss: 1.351 Test Acc: 0.324
Validation loss decreased (-0.229715 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.7292032241821289
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.263 Vali Acc: 0.392 Test Loss: 1.263 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.7579164505004883
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.202 Vali Acc: 0.446 Test Loss: 1.202 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.781264066696167
Epoch: 5, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.152 Vali Acc: 0.527 Test Loss: 1.152 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.814723014831543
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.733959436416626
Epoch: 7, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.077 Vali Acc: 0.500 Test Loss: 1.077 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7494668960571289
Epoch: 8, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 0.9221785068511963
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9290735721588135
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.058 Vali Acc: 0.581 Test Loss: 1.058 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8492171764373779
Epoch: 11, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9309089183807373
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9855163097381592
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.791506290435791
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8904001712799072
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.172 Vali Acc: 0.568 Test Loss: 1.172 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8814883232116699
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.209 Vali Acc: 0.568 Test Loss: 1.209 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7720720767974854
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.225 Vali Acc: 0.568 Test Loss: 1.225 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7893154621124268
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs134_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 232722
model size : 0.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4461402893066406
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.421 Vali Acc: 0.230 Test Loss: 1.421 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.9255733489990234
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.342 Vali Acc: 0.324 Test Loss: 1.342 Test Acc: 0.324
Validation loss decreased (-0.229716 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.9352412223815918
Epoch: 3, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.7746529579162598
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.193 Vali Acc: 0.486 Test Loss: 1.193 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.8830351829528809
Epoch: 5, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.156 Vali Acc: 0.514 Test Loss: 1.156 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8201069831848145
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.104 Vali Acc: 0.541 Test Loss: 1.104 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.785663366317749
Epoch: 7, Steps: 10 | Train Loss: 0.567 Vali Loss: 1.095 Vali Acc: 0.541 Test Loss: 1.095 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.9010133743286133
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.081 Vali Acc: 0.541 Test Loss: 1.081 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 0.807664155960083
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.065 Vali Acc: 0.514 Test Loss: 1.065 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9110655784606934
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1238880157470703
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.853935956954956
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.102 Vali Acc: 0.541 Test Loss: 1.102 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8816676139831543
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.131 Vali Acc: 0.527 Test Loss: 1.131 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7858965396881104
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.147 Vali Acc: 0.568 Test Loss: 1.147 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 0.9119422435760498
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.173 Vali Acc: 0.568 Test Loss: 1.173 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8111679553985596
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.203 Vali Acc: 0.568 Test Loss: 1.203 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6696882247924805
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.225 Vali Acc: 0.554 Test Loss: 1.225 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7174890041351318
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.256 Vali Acc: 0.568 Test Loss: 1.256 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9197139739990234
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.568 Test Loss: 1.278 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7332990169525146
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581068).  Saving model ...
Epoch: 21 cost time: 0.8158853054046631
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.319 Vali Acc: 0.581 Test Loss: 1.319 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.905207633972168
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9568817615509033
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.375 Vali Acc: 0.595 Test Loss: 1.375 Test Acc: 0.595
Validation loss decreased (-0.581068 --> -0.594581).  Saving model ...
Epoch: 24 cost time: 1.2257864475250244
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.395 Vali Acc: 0.581 Test Loss: 1.395 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.920006513595581
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.423 Vali Acc: 0.595 Test Loss: 1.423 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8657443523406982
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.456 Vali Acc: 0.595 Test Loss: 1.456 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9119610786437988
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.481 Vali Acc: 0.595 Test Loss: 1.481 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.839846134185791
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.507 Vali Acc: 0.581 Test Loss: 1.507 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8758218288421631
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.531 Vali Acc: 0.595 Test Loss: 1.531 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9391894340515137
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.570 Vali Acc: 0.595 Test Loss: 1.570 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8263592720031738
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.609 Vali Acc: 0.595 Test Loss: 1.609 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9933981895446777
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.618 Vali Acc: 0.608 Test Loss: 1.618 Test Acc: 0.608
Validation loss decreased (-0.594581 --> -0.608092).  Saving model ...
Epoch: 33 cost time: 0.8917157649993896
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.661 Vali Acc: 0.622 Test Loss: 1.661 Test Acc: 0.622
Validation loss decreased (-0.608092 --> -0.621605).  Saving model ...
Epoch: 34 cost time: 1.052450180053711
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.686 Vali Acc: 0.608 Test Loss: 1.686 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9443469047546387
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.720 Vali Acc: 0.622 Test Loss: 1.720 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8962454795837402
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.752 Vali Acc: 0.622 Test Loss: 1.752 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.844581127166748
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.782 Vali Acc: 0.622 Test Loss: 1.782 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9728789329528809
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.799 Vali Acc: 0.622 Test Loss: 1.799 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8132343292236328
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.841 Vali Acc: 0.635 Test Loss: 1.841 Test Acc: 0.635
Validation loss decreased (-0.621605 --> -0.635117).  Saving model ...
Epoch: 40 cost time: 1.1526825428009033
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.864 Vali Acc: 0.635 Test Loss: 1.864 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.2940478324890137
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.887 Vali Acc: 0.622 Test Loss: 1.887 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9183168411254883
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.929 Vali Acc: 0.635 Test Loss: 1.929 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8386623859405518
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.950 Vali Acc: 0.635 Test Loss: 1.950 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.054074764251709
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.966 Vali Acc: 0.635 Test Loss: 1.966 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0371263027191162
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.997 Vali Acc: 0.635 Test Loss: 1.997 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.821082592010498
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.028 Vali Acc: 0.649 Test Loss: 2.028 Test Acc: 0.649
Validation loss decreased (-0.635117 --> -0.648628).  Saving model ...
Epoch: 47 cost time: 0.9997198581695557
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.042 Vali Acc: 0.635 Test Loss: 2.042 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.077690839767456
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.073 Vali Acc: 0.649 Test Loss: 2.073 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9116928577423096
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.098 Vali Acc: 0.649 Test Loss: 2.098 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9710509777069092
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.119 Vali Acc: 0.649 Test Loss: 2.119 Test Acc: 0.649
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1453027725219727
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.140 Vali Acc: 0.635 Test Loss: 2.140 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8796694278717041
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.159 Vali Acc: 0.635 Test Loss: 2.159 Test Acc: 0.635
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2391438484191895
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.182 Vali Acc: 0.635 Test Loss: 2.182 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0798280239105225
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.209 Vali Acc: 0.635 Test Loss: 2.209 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8008959293365479
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.234 Vali Acc: 0.635 Test Loss: 2.234 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8528988361358643
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 2.242 Vali Acc: 0.635 Test Loss: 2.242 Test Acc: 0.635
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6486486486486487
model parameter : 227588
model size : 0.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1228346824645996
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.401 Vali Acc: 0.338 Test Loss: 1.401 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.6987640857696533
Epoch: 2, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.308 Vali Acc: 0.432 Test Loss: 1.308 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.6933634281158447
Epoch: 3, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.213 Vali Acc: 0.527 Test Loss: 1.213 Test Acc: 0.527
Validation loss decreased (-0.432419 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.6270031929016113
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 0.6234965324401855
Epoch: 5, Steps: 10 | Train Loss: 0.796 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7747421264648438
Epoch: 6, Steps: 10 | Train Loss: 0.657 Vali Loss: 1.072 Vali Acc: 0.581 Test Loss: 1.072 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.8528478145599365
Epoch: 7, Steps: 10 | Train Loss: 0.534 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.8230767250061035
Epoch: 8, Steps: 10 | Train Loss: 0.423 Vali Loss: 1.048 Vali Acc: 0.554 Test Loss: 1.048 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8642973899841309
Epoch: 9, Steps: 10 | Train Loss: 0.328 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8525171279907227
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 1.042 Vali Acc: 0.541 Test Loss: 1.042 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8151094913482666
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7395017147064209
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6996614933013916
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.101 Vali Acc: 0.568 Test Loss: 1.101 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8820357322692871
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7189905643463135
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.8843350410461426
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.161 Vali Acc: 0.554 Test Loss: 1.161 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6695115566253662
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 225050
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2030136585235596
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.407 Vali Acc: 0.297 Test Loss: 1.407 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.0360641479492188
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.310 Vali Acc: 0.473 Test Loss: 1.310 Test Acc: 0.473
Validation loss decreased (-0.297283 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 0.9638364315032959
Epoch: 3, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.217 Vali Acc: 0.527 Test Loss: 1.217 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 4 cost time: 0.9226284027099609
Epoch: 4, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.147 Vali Acc: 0.527 Test Loss: 1.147 Test Acc: 0.527
Validation loss decreased (-0.527015 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.9107120037078857
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.103 Vali Acc: 0.554 Test Loss: 1.103 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.7584421634674072
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.772017240524292
Epoch: 7, Steps: 10 | Train Loss: 0.573 Vali Loss: 1.025 Vali Acc: 0.554 Test Loss: 1.025 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8224942684173584
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.1568446159362793
Epoch: 9, Steps: 10 | Train Loss: 0.351 Vali Loss: 1.007 Vali Acc: 0.554 Test Loss: 1.007 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8907086849212646
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.021 Vali Acc: 0.541 Test Loss: 1.021 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9052670001983643
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 0.864309549331665
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9357576370239258
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 0.8125321865081787
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.103 Vali Acc: 0.595 Test Loss: 1.103 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.814504861831665
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.113 Vali Acc: 0.608 Test Loss: 1.113 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 16 cost time: 0.8291230201721191
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.138 Vali Acc: 0.608 Test Loss: 1.138 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7851145267486572
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.175 Vali Acc: 0.595 Test Loss: 1.175 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9950976371765137
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0569050312042236
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7927958965301514
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.235 Vali Acc: 0.595 Test Loss: 1.235 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.812328577041626
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.252 Vali Acc: 0.581 Test Loss: 1.252 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7482988834381104
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.282 Vali Acc: 0.581 Test Loss: 1.282 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8215577602386475
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.298 Vali Acc: 0.581 Test Loss: 1.298 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8562536239624023
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.318 Vali Acc: 0.581 Test Loss: 1.318 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0840508937835693
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.338 Vali Acc: 0.581 Test Loss: 1.338 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 224212
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.0938684940338135
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.413 Vali Acc: 0.257 Test Loss: 1.413 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.7678165435791016
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.337 Vali Acc: 0.365 Test Loss: 1.337 Test Acc: 0.365
Validation loss decreased (-0.256743 --> -0.364851).  Saving model ...
Epoch: 3 cost time: 0.7265589237213135
Epoch: 3, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.255 Vali Acc: 0.432 Test Loss: 1.255 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.8544394969940186
Epoch: 4, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.192 Vali Acc: 0.486 Test Loss: 1.192 Test Acc: 0.486
Validation loss decreased (-0.432420 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.7809128761291504
Epoch: 5, Steps: 10 | Train Loss: 0.815 Vali Loss: 1.140 Vali Acc: 0.459 Test Loss: 1.140 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.777759313583374
Epoch: 6, Steps: 10 | Train Loss: 0.674 Vali Loss: 1.111 Vali Acc: 0.527 Test Loss: 1.111 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.855053186416626
Epoch: 7, Steps: 10 | Train Loss: 0.555 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.9225637912750244
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.6871638298034668
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.087 Vali Acc: 0.568 Test Loss: 1.087 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.9454028606414795
Epoch: 10, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 11 cost time: 0.7724404335021973
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.075 Vali Acc: 0.595 Test Loss: 1.075 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.7199497222900391
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7143199443817139
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 1.135 Vali Acc: 0.568 Test Loss: 1.135 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7107453346252441
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.159 Vali Acc: 0.568 Test Loss: 1.159 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8419537544250488
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.173 Vali Acc: 0.581 Test Loss: 1.173 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7629706859588623
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.208 Vali Acc: 0.581 Test Loss: 1.208 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8614771366119385
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.234 Vali Acc: 0.581 Test Loss: 1.234 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8856518268585205
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8102021217346191
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.293 Vali Acc: 0.568 Test Loss: 1.293 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.726060152053833
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.305 Vali Acc: 0.595 Test Loss: 1.305 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7532215118408203
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 224690
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4904918670654297
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.404 Vali Acc: 0.230 Test Loss: 1.404 Test Acc: 0.230
Validation loss decreased (inf --> -0.229716).  Saving model ...
Epoch: 2 cost time: 0.7022676467895508
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (-0.229716 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.6364409923553467
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.251 Vali Acc: 0.446 Test Loss: 1.251 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 0.9020295143127441
Epoch: 4, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.178 Vali Acc: 0.486 Test Loss: 1.178 Test Acc: 0.486
Validation loss decreased (-0.445933 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.7269706726074219
Epoch: 5, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.116 Vali Acc: 0.486 Test Loss: 1.116 Test Acc: 0.486
Validation loss decreased (-0.486475 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.8650751113891602
Epoch: 6, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.7588207721710205
Epoch: 7, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.8936738967895508
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.041 Vali Acc: 0.554 Test Loss: 1.041 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7614293098449707
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.031 Vali Acc: 0.568 Test Loss: 1.031 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.691835880279541
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8416340351104736
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 1.040 Vali Acc: 0.568 Test Loss: 1.040 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9029536247253418
Epoch: 12, Steps: 10 | Train Loss: 0.138 Vali Loss: 1.052 Vali Acc: 0.568 Test Loss: 1.052 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8154048919677734
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8027300834655762
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.094 Vali Acc: 0.554 Test Loss: 1.094 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8964602947235107
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.128 Vali Acc: 0.554 Test Loss: 1.128 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7292013168334961
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.150 Vali Acc: 0.554 Test Loss: 1.150 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7273216247558594
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.172 Vali Acc: 0.554 Test Loss: 1.172 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8617041110992432
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8487133979797363
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.195 Vali Acc: 0.554 Test Loss: 1.195 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 221300
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.87961745262146
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.352 Vali Acc: 0.392 Test Loss: 1.352 Test Acc: 0.392
Validation loss decreased (inf --> -0.391878).  Saving model ...
Epoch: 2 cost time: 0.9533975124359131
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.277 Vali Acc: 0.459 Test Loss: 1.277 Test Acc: 0.459
Validation loss decreased (-0.391878 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.1242902278900146
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.7911956310272217
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 0.7511718273162842
Epoch: 5, Steps: 10 | Train Loss: 0.856 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8508610725402832
Epoch: 6, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.053 Vali Acc: 0.527 Test Loss: 1.053 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7224500179290771
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 0.6609532833099365
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.020 Vali Acc: 0.568 Test Loss: 1.020 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.7553730010986328
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8543901443481445
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.026 Vali Acc: 0.581 Test Loss: 1.026 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.9540591239929199
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9145452976226807
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0299201011657715
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9658811092376709
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.100 Vali Acc: 0.554 Test Loss: 1.100 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8548288345336914
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.95186448097229
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1092166900634766
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 0.8011159896850586
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.186 Vali Acc: 0.554 Test Loss: 1.186 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7135839462280273
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.213 Vali Acc: 0.541 Test Loss: 1.213 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9212729930877686
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.245 Vali Acc: 0.581 Test Loss: 1.245 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.759906530380249
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.246 Vali Acc: 0.581 Test Loss: 1.246 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8716928958892822
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.259 Vali Acc: 0.568 Test Loss: 1.259 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.028348445892334
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.282 Vali Acc: 0.568 Test Loss: 1.282 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0379829406738281
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.312 Vali Acc: 0.595 Test Loss: 1.312 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9230873584747314
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.325 Vali Acc: 0.568 Test Loss: 1.325 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9665799140930176
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.352 Vali Acc: 0.595 Test Loss: 1.352 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7282402515411377
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.377 Vali Acc: 0.595 Test Loss: 1.377 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 222698
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2486913204193115
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.378 Vali Acc: 0.284 Test Loss: 1.378 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7279551029205322
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.314 Vali Acc: 0.365 Test Loss: 1.314 Test Acc: 0.365
Validation loss decreased (-0.283770 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.6916744709014893
Epoch: 3, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.243 Vali Acc: 0.432 Test Loss: 1.243 Test Acc: 0.432
Validation loss decreased (-0.364852 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.649003267288208
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.170 Vali Acc: 0.527 Test Loss: 1.170 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.7511844635009766
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 0.8600871562957764
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.090 Vali Acc: 0.595 Test Loss: 1.090 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.7386293411254883
Epoch: 7, Steps: 10 | Train Loss: 0.548 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.7281534671783447
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8000190258026123
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.035 Vali Acc: 0.568 Test Loss: 1.035 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8073141574859619
Epoch: 10, Steps: 10 | Train Loss: 0.252 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9856901168823242
Epoch: 11, Steps: 10 | Train Loss: 0.192 Vali Loss: 1.069 Vali Acc: 0.554 Test Loss: 1.069 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0384478569030762
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.094 Vali Acc: 0.568 Test Loss: 1.094 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7995333671569824
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.121 Vali Acc: 0.595 Test Loss: 1.121 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7444953918457031
Epoch: 14, Steps: 10 | Train Loss: 0.082 Vali Loss: 1.137 Vali Acc: 0.568 Test Loss: 1.137 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9943661689758301
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.152 Vali Acc: 0.595 Test Loss: 1.152 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9653792381286621
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.190 Vali Acc: 0.581 Test Loss: 1.190 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.917222261428833
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.208 Vali Acc: 0.581 Test Loss: 1.208 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 220100
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4315907955169678
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.410 Vali Acc: 0.284 Test Loss: 1.410 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7313158512115479
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.328 Vali Acc: 0.405 Test Loss: 1.328 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.7803916931152344
Epoch: 3, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.251 Vali Acc: 0.486 Test Loss: 1.251 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.7651972770690918
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.177 Vali Acc: 0.527 Test Loss: 1.177 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.872471809387207
Epoch: 5, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.121 Vali Acc: 0.554 Test Loss: 1.121 Test Acc: 0.554
Validation loss decreased (-0.527015 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.9082529544830322
Epoch: 6, Steps: 10 | Train Loss: 0.702 Vali Loss: 1.084 Vali Acc: 0.568 Test Loss: 1.084 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.939861536026001
Epoch: 7, Steps: 10 | Train Loss: 0.579 Vali Loss: 1.074 Vali Acc: 0.527 Test Loss: 1.074 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7908623218536377
Epoch: 8, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.061 Vali Acc: 0.541 Test Loss: 1.061 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8295514583587646
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6830112934112549
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6939718723297119
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.7352368831634521
Epoch: 12, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.093 Vali Acc: 0.581 Test Loss: 1.093 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 13 cost time: 0.870173454284668
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.112 Vali Acc: 0.581 Test Loss: 1.112 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8818583488464355
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.125 Vali Acc: 0.568 Test Loss: 1.125 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6799094676971436
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.152 Vali Acc: 0.554 Test Loss: 1.152 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8499045372009277
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.166 Vali Acc: 0.595 Test Loss: 1.166 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 0.8046174049377441
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.192 Vali Acc: 0.581 Test Loss: 1.192 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6629743576049805
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.226 Vali Acc: 0.581 Test Loss: 1.226 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6987309455871582
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.241 Vali Acc: 0.581 Test Loss: 1.241 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.786170244216919
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.260 Vali Acc: 0.581 Test Loss: 1.260 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7823729515075684
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.283 Vali Acc: 0.581 Test Loss: 1.283 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6608738899230957
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.309 Vali Acc: 0.581 Test Loss: 1.309 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7417080402374268
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.332 Vali Acc: 0.581 Test Loss: 1.332 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7712697982788086
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.355 Vali Acc: 0.595 Test Loss: 1.355 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7548012733459473
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.376 Vali Acc: 0.595 Test Loss: 1.376 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.693213939666748
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.401 Vali Acc: 0.595 Test Loss: 1.401 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 222562
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3403422832489014
Epoch: 1, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.350 Vali Acc: 0.324 Test Loss: 1.350 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.015878677368164
Epoch: 2, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.280 Vali Acc: 0.378 Test Loss: 1.280 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 0.7718462944030762
Epoch: 3, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.211 Vali Acc: 0.419 Test Loss: 1.211 Test Acc: 0.419
Validation loss decreased (-0.378366 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 0.88850998878479
Epoch: 4, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.160 Vali Acc: 0.486 Test Loss: 1.160 Test Acc: 0.486
Validation loss decreased (-0.418907 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.9098219871520996
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.6710941791534424
Epoch: 6, Steps: 10 | Train Loss: 0.670 Vali Loss: 1.092 Vali Acc: 0.527 Test Loss: 1.092 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.6727056503295898
Epoch: 7, Steps: 10 | Train Loss: 0.547 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.9748284816741943
Epoch: 8, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.7575242519378662
Epoch: 9, Steps: 10 | Train Loss: 0.342 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.7566843032836914
Epoch: 10, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.069 Vali Acc: 0.541 Test Loss: 1.069 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8433330059051514
Epoch: 11, Steps: 10 | Train Loss: 0.190 Vali Loss: 1.073 Vali Acc: 0.581 Test Loss: 1.073 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 12 cost time: 0.8436739444732666
Epoch: 12, Steps: 10 | Train Loss: 0.139 Vali Loss: 1.118 Vali Acc: 0.581 Test Loss: 1.118 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7880206108093262
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.8095035552978516
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.135 Vali Acc: 0.608 Test Loss: 1.135 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 15 cost time: 0.6926398277282715
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.180 Vali Acc: 0.622 Test Loss: 1.180 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 0.754387378692627
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9351363182067871
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.219 Vali Acc: 0.595 Test Loss: 1.219 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9856314659118652
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.236 Vali Acc: 0.595 Test Loss: 1.236 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0004334449768066
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9398858547210693
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.296 Vali Acc: 0.568 Test Loss: 1.296 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9781019687652588
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.308 Vali Acc: 0.595 Test Loss: 1.308 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.754946231842041
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.323 Vali Acc: 0.581 Test Loss: 1.323 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.816209077835083
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.345 Vali Acc: 0.595 Test Loss: 1.345 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9749634265899658
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.373 Vali Acc: 0.568 Test Loss: 1.373 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.92044997215271
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.386 Vali Acc: 0.608 Test Loss: 1.386 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 222628
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.1060004234313965
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.430 Vali Acc: 0.270 Test Loss: 1.430 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6523141860961914
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.359 Vali Acc: 0.324 Test Loss: 1.359 Test Acc: 0.324
Validation loss decreased (-0.270256 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.6100435256958008
Epoch: 3, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.283 Vali Acc: 0.392 Test Loss: 1.283 Test Acc: 0.392
Validation loss decreased (-0.324311 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.7492456436157227
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.218 Vali Acc: 0.446 Test Loss: 1.218 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.7369983196258545
Epoch: 5, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.8858821392059326
Epoch: 6, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.7237284183502197
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.96565842628479
Epoch: 8, Steps: 10 | Train Loss: 0.444 Vali Loss: 1.060 Vali Acc: 0.581 Test Loss: 1.060 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 0.8609509468078613
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 1.060 Vali Acc: 0.554 Test Loss: 1.060 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7673420906066895
Epoch: 10, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8240096569061279
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 1.082 Vali Acc: 0.554 Test Loss: 1.082 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8260595798492432
Epoch: 12, Steps: 10 | Train Loss: 0.132 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9100341796875
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 1.114 Vali Acc: 0.595 Test Loss: 1.114 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.6819596290588379
Epoch: 14, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.137 Vali Acc: 0.595 Test Loss: 1.137 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8672194480895996
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.176 Vali Acc: 0.581 Test Loss: 1.176 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9255781173706055
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6954548358917236
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.233 Vali Acc: 0.595 Test Loss: 1.233 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7650411128997803
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.259 Vali Acc: 0.554 Test Loss: 1.259 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9971368312835693
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.278 Vali Acc: 0.568 Test Loss: 1.278 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9484198093414307
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.309 Vali Acc: 0.568 Test Loss: 1.309 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8736891746520996
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.333 Vali Acc: 0.568 Test Loss: 1.333 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9437222480773926
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.354 Vali Acc: 0.581 Test Loss: 1.354 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8344800472259521
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 220298
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2815399169921875
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.382 Vali Acc: 0.284 Test Loss: 1.382 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.0407791137695312
Epoch: 2, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.315 Vali Acc: 0.432 Test Loss: 1.315 Test Acc: 0.432
Validation loss decreased (-0.283770 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.884835958480835
Epoch: 3, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.247 Vali Acc: 0.446 Test Loss: 1.247 Test Acc: 0.446
Validation loss decreased (-0.432419 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.0532159805297852
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.181 Vali Acc: 0.473 Test Loss: 1.181 Test Acc: 0.473
Validation loss decreased (-0.445933 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.6938877105712891
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.121 Vali Acc: 0.473 Test Loss: 1.121 Test Acc: 0.473
Validation loss decreased (-0.472961 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 0.7694091796875
Epoch: 6, Steps: 10 | Train Loss: 0.682 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
Validation loss decreased (-0.472962 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.7960476875305176
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.7100050449371338
Epoch: 8, Steps: 10 | Train Loss: 0.441 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 9 cost time: 0.8269920349121094
Epoch: 9, Steps: 10 | Train Loss: 0.339 Vali Loss: 1.053 Vali Acc: 0.581 Test Loss: 1.053 Test Acc: 0.581
Validation loss decreased (-0.527017 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.744265079498291
Epoch: 10, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8320105075836182
Epoch: 11, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.072 Vali Acc: 0.554 Test Loss: 1.072 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8885838985443115
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.098 Vali Acc: 0.568 Test Loss: 1.098 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7315442562103271
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.117 Vali Acc: 0.608 Test Loss: 1.117 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 0.6552972793579102
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.139 Vali Acc: 0.568 Test Loss: 1.139 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8073856830596924
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.176 Vali Acc: 0.581 Test Loss: 1.176 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8066256046295166
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.199 Vali Acc: 0.608 Test Loss: 1.199 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8352265357971191
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.222 Vali Acc: 0.581 Test Loss: 1.222 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7926366329193115
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.246 Vali Acc: 0.595 Test Loss: 1.246 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0033650398254395
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.252 Vali Acc: 0.595 Test Loss: 1.252 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9201316833496094
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.271 Vali Acc: 0.595 Test Loss: 1.271 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7383089065551758
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.301 Vali Acc: 0.595 Test Loss: 1.301 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8759016990661621
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.321 Vali Acc: 0.595 Test Loss: 1.321 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8594114780426025
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.337 Vali Acc: 0.581 Test Loss: 1.337 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 221300
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5156590938568115
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.379 Vali Acc: 0.338 Test Loss: 1.379 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0032196044921875
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.303 Vali Acc: 0.432 Test Loss: 1.303 Test Acc: 0.432
Validation loss decreased (-0.337824 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.9324345588684082
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.206 Vali Acc: 0.541 Test Loss: 1.206 Test Acc: 0.541
Validation loss decreased (-0.432419 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 0.8608498573303223
Epoch: 4, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.133 Vali Acc: 0.541 Test Loss: 1.133 Test Acc: 0.541
Validation loss decreased (-0.540528 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.9098162651062012
Epoch: 5, Steps: 10 | Train Loss: 0.814 Vali Loss: 1.088 Vali Acc: 0.595 Test Loss: 1.088 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594584).  Saving model ...
Epoch: 6 cost time: 0.871424674987793
Epoch: 6, Steps: 10 | Train Loss: 0.671 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0279066562652588
Epoch: 7, Steps: 10 | Train Loss: 0.544 Vali Loss: 1.038 Vali Acc: 0.527 Test Loss: 1.038 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0316963195800781
Epoch: 8, Steps: 10 | Train Loss: 0.435 Vali Loss: 1.017 Vali Acc: 0.541 Test Loss: 1.017 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9981305599212646
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 1.021 Vali Acc: 0.554 Test Loss: 1.021 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.909306526184082
Epoch: 10, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.023 Vali Acc: 0.568 Test Loss: 1.023 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0785400867462158
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.029 Vali Acc: 0.581 Test Loss: 1.029 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9585926532745361
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 13 cost time: 0.8753788471221924
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0433533191680908
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.068 Vali Acc: 0.595 Test Loss: 1.068 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8789572715759277
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.087 Vali Acc: 0.595 Test Loss: 1.087 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8999884128570557
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.117 Vali Acc: 0.608 Test Loss: 1.117 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0935227870941162
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.139 Vali Acc: 0.595 Test Loss: 1.139 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.780259370803833
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.150 Vali Acc: 0.595 Test Loss: 1.150 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.948479413986206
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.175 Vali Acc: 0.595 Test Loss: 1.175 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7688326835632324
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.197 Vali Acc: 0.595 Test Loss: 1.197 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7640631198883057
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.203 Vali Acc: 0.595 Test Loss: 1.203 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.979689359664917
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.221 Vali Acc: 0.581 Test Loss: 1.221 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 220706
model size : 0.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.794119358062744
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.446 Vali Acc: 0.203 Test Loss: 1.446 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.1856787204742432
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.375 Vali Acc: 0.338 Test Loss: 1.375 Test Acc: 0.338
Validation loss decreased (-0.202688 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.042062759399414
Epoch: 3, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.291 Vali Acc: 0.378 Test Loss: 1.291 Test Acc: 0.378
Validation loss decreased (-0.337824 --> -0.378365).  Saving model ...
Epoch: 4 cost time: 0.7770867347717285
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.232 Vali Acc: 0.446 Test Loss: 1.232 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.7530906200408936
Epoch: 5, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.180 Vali Acc: 0.500 Test Loss: 1.180 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 0.6405143737792969
Epoch: 6, Steps: 10 | Train Loss: 0.710 Vali Loss: 1.136 Vali Acc: 0.486 Test Loss: 1.136 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9577627182006836
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.131 Vali Acc: 0.500 Test Loss: 1.131 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.6467287540435791
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.104 Vali Acc: 0.500 Test Loss: 1.104 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 9 cost time: 1.122396469116211
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.8254263401031494
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.010448932647705
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9498038291931152
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8239152431488037
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7820563316345215
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.158 Vali Acc: 0.568 Test Loss: 1.158 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.1168270111083984
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.191 Vali Acc: 0.554 Test Loss: 1.191 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7493805885314941
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8346598148345947
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1101489067077637
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.252 Vali Acc: 0.581 Test Loss: 1.252 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 19 cost time: 0.8395018577575684
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.271 Vali Acc: 0.554 Test Loss: 1.271 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.273371696472168
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.294 Vali Acc: 0.581 Test Loss: 1.294 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8812792301177979
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.323 Vali Acc: 0.568 Test Loss: 1.323 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.018996000289917
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.343 Vali Acc: 0.568 Test Loss: 1.343 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9598801136016846
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.387 Vali Acc: 0.581 Test Loss: 1.387 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8960998058319092
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.377 Vali Acc: 0.581 Test Loss: 1.377 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0267832279205322
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.416 Vali Acc: 0.581 Test Loss: 1.416 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9438803195953369
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.429 Vali Acc: 0.568 Test Loss: 1.429 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0599870681762695
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.451 Vali Acc: 0.581 Test Loss: 1.451 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1721832752227783
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.473 Vali Acc: 0.581 Test Loss: 1.473 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 218516
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.974377155303955
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.371 Vali Acc: 0.284 Test Loss: 1.371 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.9149746894836426
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.298 Vali Acc: 0.459 Test Loss: 1.298 Test Acc: 0.459
Validation loss decreased (-0.283770 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.9209368228912354
Epoch: 3, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.218 Vali Acc: 0.459 Test Loss: 1.218 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.7368588447570801
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.152 Vali Acc: 0.500 Test Loss: 1.152 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1028504371643066
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 1.096 Vali Acc: 0.527 Test Loss: 1.096 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.187788963317871
Epoch: 6, Steps: 10 | Train Loss: 0.665 Vali Loss: 1.065 Vali Acc: 0.568 Test Loss: 1.065 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.8615314960479736
Epoch: 7, Steps: 10 | Train Loss: 0.540 Vali Loss: 1.037 Vali Acc: 0.568 Test Loss: 1.037 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.0156137943267822
Epoch: 8, Steps: 10 | Train Loss: 0.433 Vali Loss: 1.045 Vali Acc: 0.527 Test Loss: 1.045 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1421730518341064
Epoch: 9, Steps: 10 | Train Loss: 0.329 Vali Loss: 1.037 Vali Acc: 0.514 Test Loss: 1.037 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7948377132415771
Epoch: 10, Steps: 10 | Train Loss: 0.247 Vali Loss: 1.043 Vali Acc: 0.541 Test Loss: 1.043 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9836089611053467
Epoch: 11, Steps: 10 | Train Loss: 0.183 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.035496711730957
Epoch: 12, Steps: 10 | Train Loss: 0.136 Vali Loss: 1.068 Vali Acc: 0.608 Test Loss: 1.068 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 13 cost time: 1.0453917980194092
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 1.109 Vali Acc: 0.581 Test Loss: 1.109 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8364701271057129
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.140 Vali Acc: 0.608 Test Loss: 1.140 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0479273796081543
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 16 cost time: 1.215829610824585
Epoch: 16, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.163 Vali Acc: 0.595 Test Loss: 1.163 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9453821182250977
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.204 Vali Acc: 0.635 Test Loss: 1.204 Test Acc: 0.635
Validation loss decreased (-0.621610 --> -0.635123).  Saving model ...
Epoch: 18 cost time: 1.2108855247497559
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.235 Vali Acc: 0.622 Test Loss: 1.235 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4637672901153564
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.260 Vali Acc: 0.581 Test Loss: 1.260 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.004765272140503
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.282 Vali Acc: 0.622 Test Loss: 1.282 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.778456449508667
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.314 Vali Acc: 0.622 Test Loss: 1.314 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8583905696868896
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.337 Vali Acc: 0.635 Test Loss: 1.337 Test Acc: 0.635
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8821187019348145
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.369 Vali Acc: 0.622 Test Loss: 1.369 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1243948936462402
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.402 Vali Acc: 0.622 Test Loss: 1.402 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.009589433670044
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.428 Vali Acc: 0.622 Test Loss: 1.428 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3343970775604248
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.436 Vali Acc: 0.622 Test Loss: 1.436 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3647832870483398
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.477 Vali Acc: 0.608 Test Loss: 1.477 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 221658
model size : 0.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.873152017593384
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.345 Vali Acc: 0.284 Test Loss: 1.345 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8859167098999023
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.278 Vali Acc: 0.392 Test Loss: 1.278 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7995908260345459
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.193 Vali Acc: 0.473 Test Loss: 1.193 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9033148288726807
Epoch: 4, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.124 Vali Acc: 0.595 Test Loss: 1.124 Test Acc: 0.595
Validation loss decreased (-0.472961 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 0.9459447860717773
Epoch: 5, Steps: 10 | Train Loss: 0.845 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7373249530792236
Epoch: 6, Steps: 10 | Train Loss: 0.693 Vali Loss: 1.053 Vali Acc: 0.554 Test Loss: 1.053 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.901381254196167
Epoch: 7, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.037 Vali Acc: 0.554 Test Loss: 1.037 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.882056713104248
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.012 Vali Acc: 0.568 Test Loss: 1.012 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8131198883056641
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.028 Vali Acc: 0.541 Test Loss: 1.028 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6800332069396973
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.025 Vali Acc: 0.568 Test Loss: 1.025 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8306467533111572
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.70792555809021
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6843996047973633
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.079 Vali Acc: 0.554 Test Loss: 1.079 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8130652904510498
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.093 Vali Acc: 0.568 Test Loss: 1.093 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8285205364227295
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8414926528930664
Epoch: 16, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7714848518371582
Epoch: 17, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.169 Vali Acc: 0.541 Test Loss: 1.169 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7349584102630615
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.186 Vali Acc: 0.568 Test Loss: 1.186 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5970859527587891
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.193 Vali Acc: 0.608 Test Loss: 1.193 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608096).  Saving model ...
Epoch: 20 cost time: 0.8658924102783203
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.215 Vali Acc: 0.622 Test Loss: 1.215 Test Acc: 0.622
Validation loss decreased (-0.608096 --> -0.621609).  Saving model ...
Epoch: 21 cost time: 0.6745967864990234
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.234 Vali Acc: 0.595 Test Loss: 1.234 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7448437213897705
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.242 Vali Acc: 0.608 Test Loss: 1.242 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7881429195404053
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.265 Vali Acc: 0.622 Test Loss: 1.265 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6568670272827148
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.285 Vali Acc: 0.622 Test Loss: 1.285 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9031991958618164
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.307 Vali Acc: 0.608 Test Loss: 1.307 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7391242980957031
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.303 Vali Acc: 0.608 Test Loss: 1.303 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7186732292175293
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.326 Vali Acc: 0.608 Test Loss: 1.326 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9544663429260254
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.340 Vali Acc: 0.622 Test Loss: 1.340 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8849139213562012
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.365 Vali Acc: 0.595 Test Loss: 1.365 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9637637138366699
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.368 Vali Acc: 0.608 Test Loss: 1.368 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 224004
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8601255416870117
Epoch: 1, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 1.0291731357574463
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.328 Vali Acc: 0.351 Test Loss: 1.328 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8552463054656982
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.254 Vali Acc: 0.405 Test Loss: 1.254 Test Acc: 0.405
Validation loss decreased (-0.351338 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.8121798038482666
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.194 Vali Acc: 0.500 Test Loss: 1.194 Test Acc: 0.500
Validation loss decreased (-0.405393 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.221926212310791
Epoch: 5, Steps: 10 | Train Loss: 0.820 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.7957580089569092
Epoch: 6, Steps: 10 | Train Loss: 0.675 Vali Loss: 1.078 Vali Acc: 0.635 Test Loss: 1.078 Test Acc: 0.635
Validation loss decreased (-0.554043 --> -0.635124).  Saving model ...
Epoch: 7 cost time: 0.9355838298797607
Epoch: 7, Steps: 10 | Train Loss: 0.553 Vali Loss: 1.045 Vali Acc: 0.581 Test Loss: 1.045 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7734389305114746
Epoch: 8, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.028 Vali Acc: 0.608 Test Loss: 1.028 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9279623031616211
Epoch: 9, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.036 Vali Acc: 0.622 Test Loss: 1.036 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7828903198242188
Epoch: 10, Steps: 10 | Train Loss: 0.253 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0480103492736816
Epoch: 11, Steps: 10 | Train Loss: 0.186 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.929213285446167
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 1.048 Vali Acc: 0.608 Test Loss: 1.048 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.921140193939209
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.071 Vali Acc: 0.595 Test Loss: 1.071 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8882179260253906
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9918663501739502
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.113 Vali Acc: 0.595 Test Loss: 1.113 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0424132347106934
Epoch: 16, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 225554
model size : 0.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.545351982116699
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.469 Vali Acc: 0.176 Test Loss: 1.469 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.9201772212982178
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.376 Vali Acc: 0.311 Test Loss: 1.376 Test Acc: 0.311
Validation loss decreased (-0.175661 --> -0.310797).  Saving model ...
Epoch: 3 cost time: 0.8044652938842773
Epoch: 3, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.286 Vali Acc: 0.473 Test Loss: 1.286 Test Acc: 0.473
Validation loss decreased (-0.310797 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.9044857025146484
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.203 Vali Acc: 0.527 Test Loss: 1.203 Test Acc: 0.527
Validation loss decreased (-0.472960 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.7581501007080078
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
Validation loss decreased (-0.527015 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 0.7960617542266846
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.095 Vali Acc: 0.622 Test Loss: 1.095 Test Acc: 0.622
Validation loss decreased (-0.594583 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.0628538131713867
Epoch: 7, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.083 Vali Acc: 0.568 Test Loss: 1.083 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9399218559265137
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.058 Vali Acc: 0.554 Test Loss: 1.058 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7787787914276123
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8188025951385498
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7936797142028809
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.071 Vali Acc: 0.568 Test Loss: 1.071 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8559980392456055
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.074 Vali Acc: 0.568 Test Loss: 1.074 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8886198997497559
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9099717140197754
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7992367744445801
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.155 Vali Acc: 0.568 Test Loss: 1.155 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9717793464660645
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm256_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 218180
model size : 0.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6483280658721924
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.386 Vali Acc: 0.324 Test Loss: 1.386 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 1.1663844585418701
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.330 Vali Acc: 0.311 Test Loss: 1.330 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1543059349060059
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.263 Vali Acc: 0.392 Test Loss: 1.263 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.8277432918548584
Epoch: 4, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.208 Vali Acc: 0.446 Test Loss: 1.208 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 1.4044475555419922
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.167 Vali Acc: 0.446 Test Loss: 1.167 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 6 cost time: 1.1935207843780518
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.9423243999481201
Epoch: 7, Steps: 10 | Train Loss: 0.559 Vali Loss: 1.094 Vali Acc: 0.500 Test Loss: 1.094 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.8343749046325684
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.100 Vali Acc: 0.527 Test Loss: 1.100 Test Acc: 0.527
Validation loss decreased (-0.499989 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.9564728736877441
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9258246421813965
Epoch: 10, Steps: 10 | Train Loss: 0.256 Vali Loss: 1.119 Vali Acc: 0.514 Test Loss: 1.119 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1209540367126465
Epoch: 11, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.120 Vali Acc: 0.527 Test Loss: 1.120 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9573154449462891
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 1.146 Vali Acc: 0.514 Test Loss: 1.146 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2169370651245117
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.172 Vali Acc: 0.527 Test Loss: 1.172 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7968101501464844
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.197 Vali Acc: 0.541 Test Loss: 1.197 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 15 cost time: 0.9749047756195068
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.235 Vali Acc: 0.554 Test Loss: 1.235 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554042).  Saving model ...
Epoch: 16 cost time: 0.8820252418518066
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.252 Vali Acc: 0.541 Test Loss: 1.252 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0872983932495117
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.300 Vali Acc: 0.541 Test Loss: 1.300 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9568231105804443
Epoch: 18, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.337242841720581
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.386 Vali Acc: 0.554 Test Loss: 1.386 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.168741226196289
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.424 Vali Acc: 0.554 Test Loss: 1.424 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8437387943267822
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.468 Vali Acc: 0.541 Test Loss: 1.468 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1540050506591797
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.513 Vali Acc: 0.554 Test Loss: 1.513 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0470714569091797
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.561 Vali Acc: 0.541 Test Loss: 1.561 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8283395767211914
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.616 Vali Acc: 0.554 Test Loss: 1.616 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7780396938323975
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.658 Vali Acc: 0.541 Test Loss: 1.658 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 202500
model size : 0.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs134_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6087989807128906
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.400 Vali Acc: 0.311 Test Loss: 1.400 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.7314486503601074
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.314 Vali Acc: 0.419 Test Loss: 1.314 Test Acc: 0.419
Validation loss decreased (-0.310797 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.9282073974609375
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.231 Vali Acc: 0.419 Test Loss: 1.231 Test Acc: 0.419
Validation loss decreased (-0.418906 --> -0.418907).  Saving model ...
Epoch: 4 cost time: 1.231797218322754
Epoch: 4, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.155 Vali Acc: 0.541 Test Loss: 1.155 Test Acc: 0.541
Validation loss decreased (-0.418907 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.963367223739624
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.107 Vali Acc: 0.554 Test Loss: 1.107 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 1.2054500579833984
Epoch: 6, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.067 Vali Acc: 0.554 Test Loss: 1.067 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.0896577835083008
Epoch: 7, Steps: 10 | Train Loss: 0.574 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.9884896278381348
Epoch: 8, Steps: 10 | Train Loss: 0.459 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.008683204650879
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 0.9349832534790039
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.028 Vali Acc: 0.581 Test Loss: 1.028 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1502981185913086
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.050 Vali Acc: 0.541 Test Loss: 1.050 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9718451499938965
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1851558685302734
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2074286937713623
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.099 Vali Acc: 0.595 Test Loss: 1.099 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1382205486297607
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.136 Vali Acc: 0.554 Test Loss: 1.136 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7834713459014893
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9202232360839844
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.202 Vali Acc: 0.568 Test Loss: 1.202 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1943585872650146
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.223 Vali Acc: 0.541 Test Loss: 1.223 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.107274055480957
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.242 Vali Acc: 0.541 Test Loss: 1.242 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs134_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 199090
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.6870667934417725
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.8318188190460205
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.347 Vali Acc: 0.351 Test Loss: 1.347 Test Acc: 0.351
Validation loss decreased (-0.270256 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.8416562080383301
Epoch: 3, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.267 Vali Acc: 0.419 Test Loss: 1.267 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.9404048919677734
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.79290771484375
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 1.131 Vali Acc: 0.554 Test Loss: 1.131 Test Acc: 0.554
Validation loss decreased (-0.486475 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.8080956935882568
Epoch: 6, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.8429272174835205
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.788912296295166
Epoch: 8, Steps: 10 | Train Loss: 0.440 Vali Loss: 1.064 Vali Acc: 0.541 Test Loss: 1.064 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.722353458404541
Epoch: 9, Steps: 10 | Train Loss: 0.341 Vali Loss: 1.072 Vali Acc: 0.568 Test Loss: 1.072 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.7794458866119385
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 1.017763614654541
Epoch: 11, Steps: 10 | Train Loss: 0.191 Vali Loss: 1.061 Vali Acc: 0.527 Test Loss: 1.061 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7797048091888428
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.078 Vali Acc: 0.541 Test Loss: 1.078 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9157166481018066
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8051083087921143
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.148 Vali Acc: 0.554 Test Loss: 1.148 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6604652404785156
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.162 Vali Acc: 0.595 Test Loss: 1.162 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594583).  Saving model ...
Epoch: 16 cost time: 0.8179268836975098
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8924603462219238
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.194 Vali Acc: 0.581 Test Loss: 1.194 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0114209651947021
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.216 Vali Acc: 0.581 Test Loss: 1.216 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.76999831199646
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8665883541107178
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7593328952789307
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.277 Vali Acc: 0.581 Test Loss: 1.277 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7287557125091553
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.298 Vali Acc: 0.581 Test Loss: 1.298 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6420972347259521
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.319 Vali Acc: 0.581 Test Loss: 1.319 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6426565647125244
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7591187953948975
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.346 Vali Acc: 0.581 Test Loss: 1.346 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 196132
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.343153476715088
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.375 Vali Acc: 0.324 Test Loss: 1.375 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 0.9393537044525146
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.279 Vali Acc: 0.419 Test Loss: 1.279 Test Acc: 0.419
Validation loss decreased (-0.324311 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.7153818607330322
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.195 Vali Acc: 0.486 Test Loss: 1.195 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 0.8889188766479492
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.129 Vali Acc: 0.514 Test Loss: 1.129 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.813962459564209
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.083 Vali Acc: 0.527 Test Loss: 1.083 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.8873448371887207
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 0.7660508155822754
Epoch: 7, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.041 Vali Acc: 0.568 Test Loss: 1.041 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.7969274520874023
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.6344385147094727
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.009 Vali Acc: 0.595 Test Loss: 1.009 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594585).  Saving model ...
Epoch: 10 cost time: 0.8036532402038574
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.020 Vali Acc: 0.581 Test Loss: 1.020 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6693637371063232
Epoch: 11, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.061 Vali Acc: 0.541 Test Loss: 1.061 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7933275699615479
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.056 Vali Acc: 0.595 Test Loss: 1.056 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9083700180053711
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.079 Vali Acc: 0.554 Test Loss: 1.079 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8755195140838623
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.106 Vali Acc: 0.595 Test Loss: 1.106 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9865221977233887
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9528326988220215
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.152 Vali Acc: 0.568 Test Loss: 1.152 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9844701290130615
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.170 Vali Acc: 0.568 Test Loss: 1.170 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6527993679046631
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.200 Vali Acc: 0.554 Test Loss: 1.200 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9257693290710449
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.227 Vali Acc: 0.568 Test Loss: 1.227 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 194874
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.207907199859619
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.424 Vali Acc: 0.230 Test Loss: 1.424 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.0411760807037354
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.351 Vali Acc: 0.338 Test Loss: 1.351 Test Acc: 0.338
Validation loss decreased (-0.229715 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.7244873046875
Epoch: 3, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
Validation loss decreased (-0.337824 --> -0.418906).  Saving model ...
Epoch: 4 cost time: 0.8894922733306885
Epoch: 4, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.194 Vali Acc: 0.486 Test Loss: 1.194 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.2069644927978516
Epoch: 5, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.142 Vali Acc: 0.514 Test Loss: 1.142 Test Acc: 0.514
Validation loss decreased (-0.486475 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.9632415771484375
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.8005094528198242
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.076 Vali Acc: 0.527 Test Loss: 1.076 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.9092185497283936
Epoch: 8, Steps: 10 | Train Loss: 0.463 Vali Loss: 1.077 Vali Acc: 0.514 Test Loss: 1.077 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9087884426116943
Epoch: 9, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.057 Vali Acc: 0.554 Test Loss: 1.057 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.9571418762207031
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.045450210571289
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.091 Vali Acc: 0.527 Test Loss: 1.091 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9049482345581055
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.111 Vali Acc: 0.541 Test Loss: 1.111 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8247964382171631
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.124 Vali Acc: 0.514 Test Loss: 1.124 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1416130065917969
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.146 Vali Acc: 0.527 Test Loss: 1.146 Test Acc: 0.527
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7824442386627197
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9557027816772461
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.198 Vali Acc: 0.527 Test Loss: 1.198 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8699755668640137
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.227 Vali Acc: 0.514 Test Loss: 1.227 Test Acc: 0.514
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8514289855957031
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.236 Vali Acc: 0.541 Test Loss: 1.236 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8355712890625
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.257 Vali Acc: 0.527 Test Loss: 1.257 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 194868
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.53188419342041
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.306 Vali Acc: 0.365 Test Loss: 1.306 Test Acc: 0.365
Validation loss decreased (inf --> -0.364852).  Saving model ...
Epoch: 2 cost time: 1.027055025100708
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.1515271663665771
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.160 Vali Acc: 0.500 Test Loss: 1.160 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.10990571975708
Epoch: 4, Steps: 10 | Train Loss: 0.996 Vali Loss: 1.091 Vali Acc: 0.541 Test Loss: 1.091 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540530).  Saving model ...
Epoch: 5 cost time: 0.9952683448791504
Epoch: 5, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.047 Vali Acc: 0.527 Test Loss: 1.047 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7687311172485352
Epoch: 6, Steps: 10 | Train Loss: 0.703 Vali Loss: 1.018 Vali Acc: 0.541 Test Loss: 1.018 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.8402907848358154
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.992 Vali Acc: 0.554 Test Loss: 0.992 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 0.8111951351165771
Epoch: 8, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.968 Vali Acc: 0.595 Test Loss: 0.968 Test Acc: 0.595
Validation loss decreased (-0.554044 --> -0.594585).  Saving model ...
Epoch: 9 cost time: 0.8474545478820801
Epoch: 9, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.974 Vali Acc: 0.527 Test Loss: 0.974 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2680468559265137
Epoch: 10, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.974 Vali Acc: 0.581 Test Loss: 0.974 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8853664398193359
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.965 Vali Acc: 0.581 Test Loss: 0.965 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9550445079803467
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.985 Vali Acc: 0.581 Test Loss: 0.985 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9470155239105225
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.010 Vali Acc: 0.568 Test Loss: 1.010 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.8651890754699707
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8770606517791748
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.9976844787597656
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.069 Vali Acc: 0.608 Test Loss: 1.069 Test Acc: 0.608
Validation loss decreased (-0.594585 --> -0.608097).  Saving model ...
Epoch: 17 cost time: 1.047907829284668
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.085 Vali Acc: 0.581 Test Loss: 1.085 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7457969188690186
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.114 Vali Acc: 0.581 Test Loss: 1.114 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9184629917144775
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.131 Vali Acc: 0.581 Test Loss: 1.131 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0352537631988525
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9845778942108154
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9393901824951172
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.170 Vali Acc: 0.595 Test Loss: 1.170 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8680224418640137
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.184 Vali Acc: 0.595 Test Loss: 1.184 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9715409278869629
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.205 Vali Acc: 0.581 Test Loss: 1.205 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9795932769775391
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.218 Vali Acc: 0.595 Test Loss: 1.218 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.852656364440918
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.231 Vali Acc: 0.581 Test Loss: 1.231 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 195922
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2486071586608887
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.335 Vali Acc: 0.351 Test Loss: 1.335 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.1895854473114014
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.262 Vali Acc: 0.419 Test Loss: 1.262 Test Acc: 0.419
Validation loss decreased (-0.351338 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0110092163085938
Epoch: 3, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.181 Vali Acc: 0.486 Test Loss: 1.181 Test Acc: 0.486
Validation loss decreased (-0.418906 --> -0.486475).  Saving model ...
Epoch: 4 cost time: 0.781163215637207
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.127 Vali Acc: 0.527 Test Loss: 1.127 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 0.7111563682556152
Epoch: 5, Steps: 10 | Train Loss: 0.827 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 0.8276004791259766
Epoch: 6, Steps: 10 | Train Loss: 0.687 Vali Loss: 1.048 Vali Acc: 0.568 Test Loss: 1.048 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.8125267028808594
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 1.033 Vali Acc: 0.554 Test Loss: 1.033 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0261468887329102
Epoch: 8, Steps: 10 | Train Loss: 0.449 Vali Loss: 1.057 Vali Acc: 0.514 Test Loss: 1.057 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0672659873962402
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.017 Vali Acc: 0.581 Test Loss: 1.017 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.179459810256958
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0493218898773193
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 1.042 Vali Acc: 0.568 Test Loss: 1.042 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.034677267074585
Epoch: 12, Steps: 10 | Train Loss: 0.144 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.9623081684112549
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 1.082 Vali Acc: 0.595 Test Loss: 1.082 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8983814716339111
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.122 Vali Acc: 0.581 Test Loss: 1.122 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1415886878967285
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0379056930541992
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.151 Vali Acc: 0.595 Test Loss: 1.151 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0065813064575195
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.177 Vali Acc: 0.595 Test Loss: 1.177 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.194993495941162
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.205 Vali Acc: 0.595 Test Loss: 1.205 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9896166324615479
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.236 Vali Acc: 0.595 Test Loss: 1.236 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3234589099884033
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0122690200805664
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.272 Vali Acc: 0.581 Test Loss: 1.272 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9307699203491211
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.285 Vali Acc: 0.581 Test Loss: 1.285 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 193044
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.7306015491485596
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.355 Vali Acc: 0.284 Test Loss: 1.355 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7588534355163574
Epoch: 2, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.279 Vali Acc: 0.392 Test Loss: 1.279 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.6791479587554932
Epoch: 3, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.187 Vali Acc: 0.500 Test Loss: 1.187 Test Acc: 0.500
Validation loss decreased (-0.391879 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.9130122661590576
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.130 Vali Acc: 0.541 Test Loss: 1.130 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.0653891563415527
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.835827112197876
Epoch: 6, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.043 Vali Acc: 0.554 Test Loss: 1.043 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554044).  Saving model ...
Epoch: 7 cost time: 1.1845901012420654
Epoch: 7, Steps: 10 | Train Loss: 0.565 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.9359743595123291
Epoch: 8, Steps: 10 | Train Loss: 0.450 Vali Loss: 1.028 Vali Acc: 0.554 Test Loss: 1.028 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0835363864898682
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 1.041 Vali Acc: 0.568 Test Loss: 1.041 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.831784725189209
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.7456870079040527
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 1.031 Vali Acc: 0.554 Test Loss: 1.031 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0662147998809814
Epoch: 12, Steps: 10 | Train Loss: 0.145 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9835841655731201
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.082 Vali Acc: 0.568 Test Loss: 1.082 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7419507503509521
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.104 Vali Acc: 0.581 Test Loss: 1.104 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1087241172790527
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0088276863098145
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.149 Vali Acc: 0.568 Test Loss: 1.149 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0664749145507812
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.181 Vali Acc: 0.568 Test Loss: 1.181 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9304001331329346
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7908570766448975
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.219 Vali Acc: 0.568 Test Loss: 1.219 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.323556900024414
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.231 Vali Acc: 0.568 Test Loss: 1.231 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 194762
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.8531901836395264
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.390 Vali Acc: 0.311 Test Loss: 1.390 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9641492366790771
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.310 Vali Acc: 0.405 Test Loss: 1.310 Test Acc: 0.405
Validation loss decreased (-0.310797 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.8613057136535645
Epoch: 3, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.233 Vali Acc: 0.486 Test Loss: 1.233 Test Acc: 0.486
Validation loss decreased (-0.405392 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.1686570644378662
Epoch: 4, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.154 Vali Acc: 0.527 Test Loss: 1.154 Test Acc: 0.527
Validation loss decreased (-0.486474 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.9144382476806641
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.2699291706085205
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.061 Vali Acc: 0.568 Test Loss: 1.061 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.9939675331115723
Epoch: 7, Steps: 10 | Train Loss: 0.561 Vali Loss: 1.059 Vali Acc: 0.527 Test Loss: 1.059 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.231879472732544
Epoch: 8, Steps: 10 | Train Loss: 0.448 Vali Loss: 1.026 Vali Acc: 0.541 Test Loss: 1.026 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0625295639038086
Epoch: 9, Steps: 10 | Train Loss: 0.344 Vali Loss: 1.016 Vali Acc: 0.568 Test Loss: 1.016 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.9384095668792725
Epoch: 10, Steps: 10 | Train Loss: 0.254 Vali Loss: 1.032 Vali Acc: 0.595 Test Loss: 1.032 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.973501443862915
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 1.029 Vali Acc: 0.595 Test Loss: 1.029 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 1.0933732986450195
Epoch: 12, Steps: 10 | Train Loss: 0.140 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.93768310546875
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8014121055603027
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0934233665466309
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.096 Vali Acc: 0.581 Test Loss: 1.096 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.333071231842041
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.117 Vali Acc: 0.581 Test Loss: 1.117 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9040145874023438
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.139 Vali Acc: 0.608 Test Loss: 1.139 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 18 cost time: 0.9605751037597656
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.169 Vali Acc: 0.554 Test Loss: 1.169 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0795543193817139
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.198 Vali Acc: 0.581 Test Loss: 1.198 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9968643188476562
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.207 Vali Acc: 0.568 Test Loss: 1.207 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9591367244720459
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.224 Vali Acc: 0.581 Test Loss: 1.224 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.920783281326294
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.239 Vali Acc: 0.581 Test Loss: 1.239 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.103130578994751
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.255 Vali Acc: 0.568 Test Loss: 1.255 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0721302032470703
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.269 Vali Acc: 0.581 Test Loss: 1.269 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0710227489471436
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.286 Vali Acc: 0.581 Test Loss: 1.286 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0547089576721191
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.305 Vali Acc: 0.581 Test Loss: 1.305 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0339758396148682
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.321 Vali Acc: 0.581 Test Loss: 1.321 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 192484
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.113447904586792
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.351 Vali Acc: 0.351 Test Loss: 1.351 Test Acc: 0.351
Validation loss decreased (inf --> -0.351338).  Saving model ...
Epoch: 2 cost time: 1.0699939727783203
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.288 Vali Acc: 0.392 Test Loss: 1.288 Test Acc: 0.392
Validation loss decreased (-0.351338 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9041318893432617
Epoch: 3, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.224 Vali Acc: 0.446 Test Loss: 1.224 Test Acc: 0.446
Validation loss decreased (-0.391879 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.8216502666473389
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.153 Vali Acc: 0.500 Test Loss: 1.153 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9624431133270264
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.108 Vali Acc: 0.500 Test Loss: 1.108 Test Acc: 0.500
Validation loss decreased (-0.499988 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.0753817558288574
Epoch: 6, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.064 Vali Acc: 0.514 Test Loss: 1.064 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 0.8449933528900146
Epoch: 7, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.051 Vali Acc: 0.568 Test Loss: 1.051 Test Acc: 0.568
Validation loss decreased (-0.513503 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.862572193145752
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.035 Vali Acc: 0.554 Test Loss: 1.035 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3197829723358154
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.037 Vali Acc: 0.581 Test Loss: 1.037 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.9310548305511475
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.027 Vali Acc: 0.554 Test Loss: 1.027 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.464611530303955
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.025 Vali Acc: 0.595 Test Loss: 1.025 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.7766444683074951
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.071 Vali Acc: 0.581 Test Loss: 1.071 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8699357509613037
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.076 Vali Acc: 0.568 Test Loss: 1.076 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0382230281829834
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0242185592651367
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9024536609649658
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.147 Vali Acc: 0.581 Test Loss: 1.147 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1107261180877686
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.161 Vali Acc: 0.581 Test Loss: 1.161 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9968080520629883
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.179 Vali Acc: 0.581 Test Loss: 1.179 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0685951709747314
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.196 Vali Acc: 0.568 Test Loss: 1.196 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9516739845275879
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.224 Vali Acc: 0.581 Test Loss: 1.224 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8413615226745605
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 195138
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.442115306854248
Epoch: 1, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.465 Vali Acc: 0.230 Test Loss: 1.465 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 1.0878396034240723
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (-0.229715 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.1485753059387207
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.275 Vali Acc: 0.446 Test Loss: 1.275 Test Acc: 0.446
Validation loss decreased (-0.337824 --> -0.445933).  Saving model ...
Epoch: 4 cost time: 1.372725009918213
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.177 Vali Acc: 0.500 Test Loss: 1.177 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.0939853191375732
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 1.5209205150604248
Epoch: 6, Steps: 10 | Train Loss: 0.681 Vali Loss: 1.086 Vali Acc: 0.568 Test Loss: 1.086 Test Acc: 0.568
Validation loss decreased (-0.540529 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.9920227527618408
Epoch: 7, Steps: 10 | Train Loss: 0.554 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.9145686626434326
Epoch: 8, Steps: 10 | Train Loss: 0.443 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 1.027198076248169
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.033 Vali Acc: 0.608 Test Loss: 1.033 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 10 cost time: 0.8563206195831299
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.006 Vali Acc: 0.622 Test Loss: 1.006 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621612).  Saving model ...
Epoch: 11 cost time: 1.0041184425354004
Epoch: 11, Steps: 10 | Train Loss: 0.196 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9047987461090088
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.036 Vali Acc: 0.649 Test Loss: 1.036 Test Acc: 0.649
Validation loss decreased (-0.621612 --> -0.648638).  Saving model ...
Epoch: 13 cost time: 1.0980746746063232
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.045 Vali Acc: 0.635 Test Loss: 1.045 Test Acc: 0.635
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2968683242797852
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.061 Vali Acc: 0.649 Test Loss: 1.061 Test Acc: 0.649
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1260402202606201
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.090 Vali Acc: 0.649 Test Loss: 1.090 Test Acc: 0.649
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2849345207214355
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.109 Vali Acc: 0.635 Test Loss: 1.109 Test Acc: 0.635
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8731682300567627
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.120 Vali Acc: 0.662 Test Loss: 1.120 Test Acc: 0.662
Validation loss decreased (-0.648638 --> -0.662151).  Saving model ...
Epoch: 18 cost time: 1.0587890148162842
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.146 Vali Acc: 0.622 Test Loss: 1.146 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1206812858581543
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.163 Vali Acc: 0.622 Test Loss: 1.163 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2981929779052734
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.184 Vali Acc: 0.635 Test Loss: 1.184 Test Acc: 0.635
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1834285259246826
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.191 Vali Acc: 0.622 Test Loss: 1.191 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.279759407043457
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.211 Vali Acc: 0.608 Test Loss: 1.211 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3688764572143555
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.226 Vali Acc: 0.595 Test Loss: 1.226 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3026344776153564
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.240 Vali Acc: 0.608 Test Loss: 1.240 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3286941051483154
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.254 Vali Acc: 0.608 Test Loss: 1.254 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2618200778961182
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.263 Vali Acc: 0.608 Test Loss: 1.263 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2932333946228027
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.279 Vali Acc: 0.608 Test Loss: 1.279 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6621621621621622
model parameter : 195396
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.9295668601989746
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.405 Vali Acc: 0.284 Test Loss: 1.405 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1618733406066895
Epoch: 2, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.334 Vali Acc: 0.419 Test Loss: 1.334 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8584010601043701
Epoch: 3, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.242 Vali Acc: 0.500 Test Loss: 1.242 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1390736103057861
Epoch: 4, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.167 Vali Acc: 0.541 Test Loss: 1.167 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 1.0788135528564453
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.111 Vali Acc: 0.595 Test Loss: 1.111 Test Acc: 0.595
Validation loss decreased (-0.540529 --> -0.594583).  Saving model ...
Epoch: 6 cost time: 1.117913007736206
Epoch: 6, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0676541328430176
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1944997310638428
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.025 Vali Acc: 0.595 Test Loss: 1.025 Test Acc: 0.595
Validation loss decreased (-0.594583 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.097677230834961
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.030 Vali Acc: 0.581 Test Loss: 1.030 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1818006038665771
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1529312133789062
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.058 Vali Acc: 0.608 Test Loss: 1.058 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 0.9201412200927734
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0327749252319336
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1525402069091797
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.088 Vali Acc: 0.622 Test Loss: 1.088 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 15 cost time: 0.9684450626373291
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.122 Vali Acc: 0.608 Test Loss: 1.122 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0542125701904297
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.151 Vali Acc: 0.581 Test Loss: 1.151 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9804041385650635
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.175 Vali Acc: 0.581 Test Loss: 1.175 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9133682250976562
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.189 Vali Acc: 0.581 Test Loss: 1.189 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8620336055755615
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.212 Vali Acc: 0.581 Test Loss: 1.212 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9357545375823975
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.225 Vali Acc: 0.595 Test Loss: 1.225 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.913384199142456
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.247 Vali Acc: 0.595 Test Loss: 1.247 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9817276000976562
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.268 Vali Acc: 0.595 Test Loss: 1.268 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.85955810546875
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.282 Vali Acc: 0.581 Test Loss: 1.282 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.279881477355957
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 193258
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.529855489730835
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.416 Vali Acc: 0.284 Test Loss: 1.416 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.125136137008667
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.353 Vali Acc: 0.324 Test Loss: 1.353 Test Acc: 0.324
Validation loss decreased (-0.283770 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.1963634490966797
Epoch: 3, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.295 Vali Acc: 0.365 Test Loss: 1.295 Test Acc: 0.365
Validation loss decreased (-0.324311 --> -0.364852).  Saving model ...
Epoch: 4 cost time: 0.937932014465332
Epoch: 4, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.220 Vali Acc: 0.486 Test Loss: 1.220 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.2250895500183105
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.162 Vali Acc: 0.473 Test Loss: 1.162 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9457628726959229
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 1.129 Vali Acc: 0.500 Test Loss: 1.129 Test Acc: 0.500
Validation loss decreased (-0.486474 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.8549356460571289
Epoch: 7, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.107 Vali Acc: 0.500 Test Loss: 1.107 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.9118778705596924
Epoch: 8, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.091 Vali Acc: 0.554 Test Loss: 1.091 Test Acc: 0.554
Validation loss decreased (-0.499989 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 0.9973771572113037
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.0026905536651611
Epoch: 10, Steps: 10 | Train Loss: 0.265 Vali Loss: 1.084 Vali Acc: 0.541 Test Loss: 1.084 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.221257209777832
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.112 Vali Acc: 0.554 Test Loss: 1.112 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0787363052368164
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.120 Vali Acc: 0.541 Test Loss: 1.120 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.270575761795044
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.136 Vali Acc: 0.541 Test Loss: 1.136 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1596529483795166
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.150 Vali Acc: 0.568 Test Loss: 1.150 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8280916213989258
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 16 cost time: 1.0129733085632324
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.203 Vali Acc: 0.554 Test Loss: 1.203 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9028253555297852
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.223 Vali Acc: 0.595 Test Loss: 1.223 Test Acc: 0.595
Validation loss decreased (-0.581069 --> -0.594582).  Saving model ...
Epoch: 18 cost time: 1.0788545608520508
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.245 Vali Acc: 0.568 Test Loss: 1.245 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2657973766326904
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.271 Vali Acc: 0.568 Test Loss: 1.271 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2886662483215332
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0294325351715088
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.303 Vali Acc: 0.568 Test Loss: 1.303 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9905741214752197
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.322 Vali Acc: 0.581 Test Loss: 1.322 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.062300443649292
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9941539764404297
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.358 Vali Acc: 0.581 Test Loss: 1.358 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3755934238433838
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.377 Vali Acc: 0.568 Test Loss: 1.377 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4862089157104492
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.389 Vali Acc: 0.568 Test Loss: 1.389 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9635591506958008
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.404 Vali Acc: 0.581 Test Loss: 1.404 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 194388
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2659528255462646
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.382 Vali Acc: 0.324 Test Loss: 1.382 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.293379545211792
Epoch: 2, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.291 Vali Acc: 0.446 Test Loss: 1.291 Test Acc: 0.446
Validation loss decreased (-0.324311 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 1.5731284618377686
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.205 Vali Acc: 0.459 Test Loss: 1.205 Test Acc: 0.459
Validation loss decreased (-0.445933 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.3631680011749268
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.135 Vali Acc: 0.486 Test Loss: 1.135 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 1.0520429611206055
Epoch: 5, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.088 Vali Acc: 0.541 Test Loss: 1.088 Test Acc: 0.541
Validation loss decreased (-0.486475 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 1.1003131866455078
Epoch: 6, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.048 Vali Acc: 0.541 Test Loss: 1.048 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.9708771705627441
Epoch: 7, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.033 Vali Acc: 0.568 Test Loss: 1.033 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.9827158451080322
Epoch: 8, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.023 Vali Acc: 0.554 Test Loss: 1.023 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0943450927734375
Epoch: 9, Steps: 10 | Train Loss: 0.372 Vali Loss: 1.035 Vali Acc: 0.514 Test Loss: 1.035 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1694741249084473
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5199849605560303
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.017 Vali Acc: 0.554 Test Loss: 1.017 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.155815839767456
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.036 Vali Acc: 0.568 Test Loss: 1.036 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8706095218658447
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581070).  Saving model ...
Epoch: 14 cost time: 1.3756070137023926
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.086 Vali Acc: 0.581 Test Loss: 1.086 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.125462293624878
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.111 Vali Acc: 0.568 Test Loss: 1.111 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0907912254333496
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.136 Vali Acc: 0.581 Test Loss: 1.136 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.986417293548584
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.138 Vali Acc: 0.595 Test Loss: 1.138 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 1.0886867046356201
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.158 Vali Acc: 0.581 Test Loss: 1.158 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9677987098693848
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.180 Vali Acc: 0.581 Test Loss: 1.180 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2611603736877441
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.211 Vali Acc: 0.595 Test Loss: 1.211 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4631273746490479
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.223 Vali Acc: 0.595 Test Loss: 1.223 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.133307695388794
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.243 Vali Acc: 0.581 Test Loss: 1.243 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1621875762939453
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.262 Vali Acc: 0.581 Test Loss: 1.262 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8929200172424316
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.275 Vali Acc: 0.581 Test Loss: 1.275 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9800963401794434
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.293 Vali Acc: 0.581 Test Loss: 1.293 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9282593727111816
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.310 Vali Acc: 0.581 Test Loss: 1.310 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2253265380859375
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.323 Vali Acc: 0.581 Test Loss: 1.323 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 193922
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.225243091583252
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.447 Vali Acc: 0.257 Test Loss: 1.447 Test Acc: 0.257
Validation loss decreased (inf --> -0.256742).  Saving model ...
Epoch: 2 cost time: 0.87088942527771
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.331 Vali Acc: 0.365 Test Loss: 1.331 Test Acc: 0.365
Validation loss decreased (-0.256742 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.9711744785308838
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.231 Vali Acc: 0.486 Test Loss: 1.231 Test Acc: 0.486
Validation loss decreased (-0.364852 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.841742992401123
Epoch: 4, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.166 Vali Acc: 0.541 Test Loss: 1.166 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.8993616104125977
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.7786219120025635
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.078 Vali Acc: 0.554 Test Loss: 1.078 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.7186474800109863
Epoch: 7, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.049 Vali Acc: 0.554 Test Loss: 1.049 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 8 cost time: 0.8412072658538818
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
Validation loss decreased (-0.554044 --> -0.581071).  Saving model ...
Epoch: 9 cost time: 0.7641444206237793
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 1.049 Vali Acc: 0.568 Test Loss: 1.049 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9086565971374512
Epoch: 10, Steps: 10 | Train Loss: 0.267 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.7423923015594482
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.068 Vali Acc: 0.568 Test Loss: 1.068 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2151639461517334
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.019608497619629
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9028184413909912
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0069692134857178
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.164 Vali Acc: 0.568 Test Loss: 1.164 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.000783920288086
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.189 Vali Acc: 0.568 Test Loss: 1.189 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8193569183349609
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.216 Vali Acc: 0.568 Test Loss: 1.216 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8928611278533936
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.227 Vali Acc: 0.581 Test Loss: 1.227 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1011638641357422
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.263 Vali Acc: 0.581 Test Loss: 1.263 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.069089651107788
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.285 Vali Acc: 0.568 Test Loss: 1.285 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 191860
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.334373712539673
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.382 Vali Acc: 0.365 Test Loss: 1.382 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 1.031487226486206
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.292 Vali Acc: 0.446 Test Loss: 1.292 Test Acc: 0.446
Validation loss decreased (-0.364851 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.8605554103851318
Epoch: 3, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.198 Vali Acc: 0.514 Test Loss: 1.198 Test Acc: 0.514
Validation loss decreased (-0.445933 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 0.9663610458374023
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.105 Vali Acc: 0.608 Test Loss: 1.105 Test Acc: 0.608
Validation loss decreased (-0.513502 --> -0.608097).  Saving model ...
Epoch: 5 cost time: 0.9495799541473389
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.073 Vali Acc: 0.635 Test Loss: 1.073 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635124).  Saving model ...
Epoch: 6 cost time: 0.8790073394775391
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.043 Vali Acc: 0.568 Test Loss: 1.043 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1595594882965088
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.020 Vali Acc: 0.595 Test Loss: 1.020 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2819063663482666
Epoch: 8, Steps: 10 | Train Loss: 0.460 Vali Loss: 1.026 Vali Acc: 0.608 Test Loss: 1.026 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9983041286468506
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.010 Vali Acc: 0.595 Test Loss: 1.010 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9171884059906006
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.010 Vali Acc: 0.581 Test Loss: 1.010 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9763648509979248
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.025 Vali Acc: 0.595 Test Loss: 1.025 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9779677391052246
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.059 Vali Acc: 0.581 Test Loss: 1.059 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1572375297546387
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.032707929611206
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.079 Vali Acc: 0.595 Test Loss: 1.079 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1643791198730469
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.080 Vali Acc: 0.595 Test Loss: 1.080 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 195066
model size : 0.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.3665237426757812
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.389 Vali Acc: 0.311 Test Loss: 1.389 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.347867488861084
Epoch: 2, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.304 Vali Acc: 0.459 Test Loss: 1.304 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 1.1456618309020996
Epoch: 3, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.226 Vali Acc: 0.541 Test Loss: 1.226 Test Acc: 0.541
Validation loss decreased (-0.459446 --> -0.540528).  Saving model ...
Epoch: 4 cost time: 1.2543799877166748
Epoch: 4, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.155 Vali Acc: 0.514 Test Loss: 1.155 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2328598499298096
Epoch: 5, Steps: 10 | Train Loss: 0.833 Vali Loss: 1.100 Vali Acc: 0.568 Test Loss: 1.100 Test Acc: 0.568
Validation loss decreased (-0.540528 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.172961950302124
Epoch: 6, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.080 Vali Acc: 0.568 Test Loss: 1.080 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.3988215923309326
Epoch: 7, Steps: 10 | Train Loss: 0.563 Vali Loss: 1.046 Vali Acc: 0.568 Test Loss: 1.046 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.108405351638794
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.057 Vali Acc: 0.568 Test Loss: 1.057 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1182756423950195
Epoch: 9, Steps: 10 | Train Loss: 0.354 Vali Loss: 1.037 Vali Acc: 0.581 Test Loss: 1.037 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 1.0609855651855469
Epoch: 10, Steps: 10 | Train Loss: 0.269 Vali Loss: 1.064 Vali Acc: 0.541 Test Loss: 1.064 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0882704257965088
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.094 Vali Acc: 0.541 Test Loss: 1.094 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2053382396697998
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.080 Vali Acc: 0.541 Test Loss: 1.080 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3915276527404785
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.109 Vali Acc: 0.541 Test Loss: 1.109 Test Acc: 0.541
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0603060722351074
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.139 Vali Acc: 0.554 Test Loss: 1.139 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1210274696350098
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.135 Vali Acc: 0.554 Test Loss: 1.135 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1311485767364502
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.175 Vali Acc: 0.527 Test Loss: 1.175 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1085681915283203
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.194 Vali Acc: 0.554 Test Loss: 1.194 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3848779201507568
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.568 Test Loss: 1.222 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1174967288970947
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.249 Vali Acc: 0.568 Test Loss: 1.249 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 197476
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.0471243858337402
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.501 Vali Acc: 0.270 Test Loss: 1.501 Test Acc: 0.270
Validation loss decreased (inf --> -0.270255).  Saving model ...
Epoch: 2 cost time: 1.079084873199463
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.408 Vali Acc: 0.297 Test Loss: 1.408 Test Acc: 0.297
Validation loss decreased (-0.270255 --> -0.297283).  Saving model ...
Epoch: 3 cost time: 0.8897538185119629
Epoch: 3, Steps: 10 | Train Loss: 1.153 Vali Loss: 1.323 Vali Acc: 0.392 Test Loss: 1.323 Test Acc: 0.392
Validation loss decreased (-0.297283 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 0.9497008323669434
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.245 Vali Acc: 0.486 Test Loss: 1.245 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 5 cost time: 1.0359888076782227
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.195 Vali Acc: 0.541 Test Loss: 1.195 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 6 cost time: 0.878849983215332
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.157 Vali Acc: 0.541 Test Loss: 1.157 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 7 cost time: 0.8063952922821045
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.135 Vali Acc: 0.514 Test Loss: 1.135 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0883238315582275
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.124 Vali Acc: 0.541 Test Loss: 1.124 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.0541770458221436
Epoch: 9, Steps: 10 | Train Loss: 0.346 Vali Loss: 1.101 Vali Acc: 0.541 Test Loss: 1.101 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 10 cost time: 1.0879831314086914
Epoch: 10, Steps: 10 | Train Loss: 0.261 Vali Loss: 1.124 Vali Acc: 0.554 Test Loss: 1.124 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 11 cost time: 0.7305014133453369
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 1.140 Vali Acc: 0.541 Test Loss: 1.140 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0372579097747803
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.167 Vali Acc: 0.514 Test Loss: 1.167 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9459125995635986
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.173 Vali Acc: 0.527 Test Loss: 1.173 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9638199806213379
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.189 Vali Acc: 0.527 Test Loss: 1.189 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2002317905426025
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.223 Vali Acc: 0.554 Test Loss: 1.223 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.050154685974121
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.247 Vali Acc: 0.541 Test Loss: 1.247 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8712215423583984
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.282 Vali Acc: 0.527 Test Loss: 1.282 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.059612512588501
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.302 Vali Acc: 0.527 Test Loss: 1.302 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7437863349914551
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.317 Vali Acc: 0.527 Test Loss: 1.317 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8421123027801514
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.337 Vali Acc: 0.527 Test Loss: 1.337 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5540540540540541
model parameter : 199090
model size : 0.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.725634813308716
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.358 Vali Acc: 0.324 Test Loss: 1.358 Test Acc: 0.324
Validation loss decreased (inf --> -0.324311).  Saving model ...
Epoch: 2 cost time: 1.333078145980835
Epoch: 2, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.285 Vali Acc: 0.378 Test Loss: 1.285 Test Acc: 0.378
Validation loss decreased (-0.324311 --> -0.378366).  Saving model ...
Epoch: 3 cost time: 1.0878150463104248
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.220 Vali Acc: 0.446 Test Loss: 1.220 Test Acc: 0.446
Validation loss decreased (-0.378366 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.8929228782653809
Epoch: 4, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.155 Vali Acc: 0.459 Test Loss: 1.155 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 0.9607894420623779
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.109 Vali Acc: 0.527 Test Loss: 1.109 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 1.0255382061004639
Epoch: 6, Steps: 10 | Train Loss: 0.689 Vali Loss: 1.080 Vali Acc: 0.554 Test Loss: 1.080 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.073228120803833
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.058 Vali Acc: 0.527 Test Loss: 1.058 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9342174530029297
Epoch: 8, Steps: 10 | Train Loss: 0.446 Vali Loss: 1.059 Vali Acc: 0.554 Test Loss: 1.059 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 9 cost time: 1.1785552501678467
Epoch: 9, Steps: 10 | Train Loss: 0.347 Vali Loss: 1.053 Vali Acc: 0.568 Test Loss: 1.053 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.380638837814331
Epoch: 10, Steps: 10 | Train Loss: 0.262 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.185662031173706
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.085 Vali Acc: 0.595 Test Loss: 1.085 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.958078145980835
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 1.086 Vali Acc: 0.595 Test Loss: 1.086 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9917464256286621
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.126 Vali Acc: 0.554 Test Loss: 1.126 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9508109092712402
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.153 Vali Acc: 0.554 Test Loss: 1.153 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9294803142547607
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.175 Vali Acc: 0.595 Test Loss: 1.175 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1778693199157715
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.211 Vali Acc: 0.595 Test Loss: 1.211 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2543408870697021
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.224 Vali Acc: 0.581 Test Loss: 1.224 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9766356945037842
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.246 Vali Acc: 0.581 Test Loss: 1.246 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9135124683380127
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.266 Vali Acc: 0.595 Test Loss: 1.266 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0266847610473633
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.274 Vali Acc: 0.595 Test Loss: 1.274 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9217507839202881
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.306 Vali Acc: 0.595 Test Loss: 1.306 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm128_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 191844
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9627668857574463
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (inf --> -0.270256).  Saving model ...
Epoch: 2 cost time: 0.6800405979156494
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.320 Vali Acc: 0.419 Test Loss: 1.320 Test Acc: 0.419
Validation loss decreased (-0.270256 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.820667028427124
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.249 Vali Acc: 0.500 Test Loss: 1.249 Test Acc: 0.500
Validation loss decreased (-0.418906 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 0.8282334804534912
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.186 Vali Acc: 0.527 Test Loss: 1.186 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.9424750804901123
Epoch: 5, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.128 Vali Acc: 0.568 Test Loss: 1.128 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.9551897048950195
Epoch: 6, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.099 Vali Acc: 0.568 Test Loss: 1.099 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 1.08668851852417
Epoch: 7, Steps: 10 | Train Loss: 0.596 Vali Loss: 1.062 Vali Acc: 0.608 Test Loss: 1.062 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608097).  Saving model ...
Epoch: 8 cost time: 1.0268502235412598
Epoch: 8, Steps: 10 | Train Loss: 0.474 Vali Loss: 1.040 Vali Acc: 0.635 Test Loss: 1.040 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 9 cost time: 0.9869656562805176
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.067 Vali Acc: 0.608 Test Loss: 1.067 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0896058082580566
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.084 Vali Acc: 0.581 Test Loss: 1.084 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.863365888595581
Epoch: 11, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6505911350250244
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.098 Vali Acc: 0.554 Test Loss: 1.098 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9393539428710938
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.115 Vali Acc: 0.541 Test Loss: 1.115 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9354596138000488
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.159 Vali Acc: 0.527 Test Loss: 1.159 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6506237983703613
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.176 Vali Acc: 0.541 Test Loss: 1.176 Test Acc: 0.541
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7762818336486816
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.200 Vali Acc: 0.541 Test Loss: 1.200 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.684481143951416
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.230 Vali Acc: 0.527 Test Loss: 1.230 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8669095039367676
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.247 Vali Acc: 0.541 Test Loss: 1.247 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 188180
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs134_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.3962881565093994
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.409 Vali Acc: 0.338 Test Loss: 1.409 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.0466790199279785
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.329 Vali Acc: 0.365 Test Loss: 1.329 Test Acc: 0.365
Validation loss decreased (-0.337824 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.8433365821838379
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.364852 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.9429652690887451
Epoch: 4, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.203 Vali Acc: 0.446 Test Loss: 1.203 Test Acc: 0.446
Validation loss decreased (-0.445934 --> -0.445934).  Saving model ...
Epoch: 5 cost time: 0.8363041877746582
Epoch: 5, Steps: 10 | Train Loss: 0.838 Vali Loss: 1.138 Vali Acc: 0.459 Test Loss: 1.138 Test Acc: 0.459
Validation loss decreased (-0.445934 --> -0.459448).  Saving model ...
Epoch: 6 cost time: 0.8616306781768799
Epoch: 6, Steps: 10 | Train Loss: 0.696 Vali Loss: 1.080 Vali Acc: 0.527 Test Loss: 1.080 Test Acc: 0.527
Validation loss decreased (-0.459448 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.0044057369232178
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.074 Vali Acc: 0.500 Test Loss: 1.074 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.951533317565918
Epoch: 8, Steps: 10 | Train Loss: 0.451 Vali Loss: 1.055 Vali Acc: 0.514 Test Loss: 1.055 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8071467876434326
Epoch: 9, Steps: 10 | Train Loss: 0.352 Vali Loss: 1.052 Vali Acc: 0.514 Test Loss: 1.052 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9370629787445068
Epoch: 10, Steps: 10 | Train Loss: 0.266 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.7443563938140869
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 1.050 Vali Acc: 0.595 Test Loss: 1.050 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 12 cost time: 0.8947489261627197
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8296020030975342
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.108 Vali Acc: 0.595 Test Loss: 1.108 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0607554912567139
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.125 Vali Acc: 0.595 Test Loss: 1.125 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8546795845031738
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.122 Vali Acc: 0.608 Test Loss: 1.122 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 16 cost time: 1.0879883766174316
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.145 Vali Acc: 0.608 Test Loss: 1.145 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9100618362426758
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.189 Vali Acc: 0.608 Test Loss: 1.189 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0781826972961426
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.218 Vali Acc: 0.608 Test Loss: 1.218 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8125207424163818
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.234 Vali Acc: 0.608 Test Loss: 1.234 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.978609561920166
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.250 Vali Acc: 0.608 Test Loss: 1.250 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9559032917022705
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.263 Vali Acc: 0.595 Test Loss: 1.263 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.083571195602417
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.274 Vali Acc: 0.608 Test Loss: 1.274 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8493506908416748
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.300 Vali Acc: 0.595 Test Loss: 1.300 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9027888774871826
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.304 Vali Acc: 0.595 Test Loss: 1.304 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0042426586151123
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.318 Vali Acc: 0.608 Test Loss: 1.318 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs134_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 186882
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6115996837615967
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.331 Vali Acc: 0.419 Test Loss: 1.331 Test Acc: 0.419
Validation loss decreased (inf --> -0.418906).  Saving model ...
Epoch: 2 cost time: 1.2232933044433594
Epoch: 2, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.269 Vali Acc: 0.473 Test Loss: 1.269 Test Acc: 0.473
Validation loss decreased (-0.418906 --> -0.472960).  Saving model ...
Epoch: 3 cost time: 1.1353263854980469
Epoch: 3, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.189 Vali Acc: 0.514 Test Loss: 1.189 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 1.0739526748657227
Epoch: 4, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.117 Vali Acc: 0.595 Test Loss: 1.117 Test Acc: 0.595
Validation loss decreased (-0.513502 --> -0.594583).  Saving model ...
Epoch: 5 cost time: 1.092663288116455
Epoch: 5, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.067 Vali Acc: 0.568 Test Loss: 1.067 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3828847408294678
Epoch: 6, Steps: 10 | Train Loss: 0.707 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608098).  Saving model ...
Epoch: 7 cost time: 1.0242176055908203
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.025 Vali Acc: 0.622 Test Loss: 1.025 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621611).  Saving model ...
Epoch: 8 cost time: 0.8990786075592041
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.023 Vali Acc: 0.622 Test Loss: 1.023 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 0.8550214767456055
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 1.013 Vali Acc: 0.608 Test Loss: 1.013 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9324092864990234
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.018 Vali Acc: 0.622 Test Loss: 1.018 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 11 cost time: 0.8864660263061523
Epoch: 11, Steps: 10 | Train Loss: 0.209 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2667949199676514
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.040 Vali Acc: 0.595 Test Loss: 1.040 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0344383716583252
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.052 Vali Acc: 0.581 Test Loss: 1.052 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2829804420471191
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.065 Vali Acc: 0.608 Test Loss: 1.065 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8502340316772461
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.096 Vali Acc: 0.608 Test Loss: 1.096 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8086578845977783
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.127 Vali Acc: 0.622 Test Loss: 1.127 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9735872745513916
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.151 Vali Acc: 0.622 Test Loss: 1.151 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9461236000061035
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.167 Vali Acc: 0.635 Test Loss: 1.167 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635123).  Saving model ...
Epoch: 19 cost time: 1.158632516860962
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.187 Vali Acc: 0.622 Test Loss: 1.187 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1378459930419922
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.203 Vali Acc: 0.635 Test Loss: 1.203 Test Acc: 0.635
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.108499526977539
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.226 Vali Acc: 0.622 Test Loss: 1.226 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.184586524963379
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.243 Vali Acc: 0.622 Test Loss: 1.243 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0334091186523438
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.264 Vali Acc: 0.608 Test Loss: 1.264 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.417924404144287
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.282 Vali Acc: 0.608 Test Loss: 1.282 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4533324241638184
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.302 Vali Acc: 0.595 Test Loss: 1.302 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8869554996490479
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.316 Vali Acc: 0.608 Test Loss: 1.316 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9339098930358887
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.332 Vali Acc: 0.608 Test Loss: 1.332 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0606176853179932
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.347 Vali Acc: 0.608 Test Loss: 1.347 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 185012
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.550426959991455
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.392 Vali Acc: 0.324 Test Loss: 1.392 Test Acc: 0.324
Validation loss decreased (inf --> -0.324310).  Saving model ...
Epoch: 2 cost time: 0.7514777183532715
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.311 Vali Acc: 0.392 Test Loss: 1.311 Test Acc: 0.392
Validation loss decreased (-0.324310 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 1.104865550994873
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.242 Vali Acc: 0.486 Test Loss: 1.242 Test Acc: 0.486
Validation loss decreased (-0.391879 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 1.162095546722412
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.161 Vali Acc: 0.541 Test Loss: 1.161 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.9628932476043701
Epoch: 5, Steps: 10 | Train Loss: 0.854 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8006563186645508
Epoch: 6, Steps: 10 | Train Loss: 0.718 Vali Loss: 1.058 Vali Acc: 0.527 Test Loss: 1.058 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1254465579986572
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.034 Vali Acc: 0.541 Test Loss: 1.034 Test Acc: 0.541
Validation loss decreased (-0.540529 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 1.0167171955108643
Epoch: 8, Steps: 10 | Train Loss: 0.472 Vali Loss: 1.032 Vali Acc: 0.554 Test Loss: 1.032 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 1.2093725204467773
Epoch: 9, Steps: 10 | Train Loss: 0.373 Vali Loss: 1.022 Vali Acc: 0.568 Test Loss: 1.022 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.9708786010742188
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.014 Vali Acc: 0.581 Test Loss: 1.014 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 11 cost time: 0.9779298305511475
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.123180627822876
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.042 Vali Acc: 0.595 Test Loss: 1.042 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 0.962104082107544
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.069 Vali Acc: 0.608 Test Loss: 1.069 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 14 cost time: 1.056462049484253
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.091 Vali Acc: 0.595 Test Loss: 1.091 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0379159450531006
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9576926231384277
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.129 Vali Acc: 0.608 Test Loss: 1.129 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9816434383392334
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.148 Vali Acc: 0.608 Test Loss: 1.148 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9459629058837891
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.171 Vali Acc: 0.622 Test Loss: 1.171 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621610).  Saving model ...
Epoch: 19 cost time: 0.9354193210601807
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.197 Vali Acc: 0.608 Test Loss: 1.197 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1007418632507324
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.219 Vali Acc: 0.608 Test Loss: 1.219 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0602195262908936
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.232 Vali Acc: 0.595 Test Loss: 1.232 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0555050373077393
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.246 Vali Acc: 0.608 Test Loss: 1.246 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9597229957580566
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.269 Vali Acc: 0.595 Test Loss: 1.269 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.916527271270752
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.286 Vali Acc: 0.608 Test Loss: 1.286 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1742441654205322
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.299 Vali Acc: 0.595 Test Loss: 1.299 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9198112487792969
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.317 Vali Acc: 0.595 Test Loss: 1.317 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9800951480865479
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8053677082061768
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.343 Vali Acc: 0.568 Test Loss: 1.343 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 184394
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.779090166091919
Epoch: 1, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.426 Vali Acc: 0.162 Test Loss: 1.426 Test Acc: 0.162
Validation loss decreased (inf --> -0.162148).  Saving model ...
Epoch: 2 cost time: 1.5910921096801758
Epoch: 2, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.336 Vali Acc: 0.419 Test Loss: 1.336 Test Acc: 0.419
Validation loss decreased (-0.162148 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.2970776557922363
Epoch: 3, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.242 Vali Acc: 0.446 Test Loss: 1.242 Test Acc: 0.446
Validation loss decreased (-0.418906 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 1.2244033813476562
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.166 Vali Acc: 0.500 Test Loss: 1.166 Test Acc: 0.500
Validation loss decreased (-0.445934 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.1105148792266846
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.123 Vali Acc: 0.514 Test Loss: 1.123 Test Acc: 0.514
Validation loss decreased (-0.499988 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.2557554244995117
Epoch: 6, Steps: 10 | Train Loss: 0.683 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.0663557052612305
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.078 Vali Acc: 0.527 Test Loss: 1.078 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.9404759407043457
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
Validation loss decreased (-0.527016 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.3738465309143066
Epoch: 9, Steps: 10 | Train Loss: 0.356 Vali Loss: 1.047 Vali Acc: 0.541 Test Loss: 1.047 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8793339729309082
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.19022536277771
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.063 Vali Acc: 0.608 Test Loss: 1.063 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 1.0926129817962646
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4108355045318604
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.097 Vali Acc: 0.581 Test Loss: 1.097 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0108320713043213
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.118 Vali Acc: 0.608 Test Loss: 1.118 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1359643936157227
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1254336833953857
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.154 Vali Acc: 0.595 Test Loss: 1.154 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1460657119750977
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.172 Vali Acc: 0.595 Test Loss: 1.172 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1798653602600098
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.196 Vali Acc: 0.608 Test Loss: 1.196 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1477577686309814
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.228 Vali Acc: 0.608 Test Loss: 1.228 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2566430568695068
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.252 Vali Acc: 0.608 Test Loss: 1.252 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2674977779388428
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.262 Vali Acc: 0.595 Test Loss: 1.262 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 184804
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4592323303222656
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.336 Vali Acc: 0.297 Test Loss: 1.336 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.1228058338165283
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.274 Vali Acc: 0.500 Test Loss: 1.274 Test Acc: 0.500
Validation loss decreased (-0.297284 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 0.8848395347595215
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
Validation loss decreased (-0.499987 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 1.1806294918060303
Epoch: 4, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.140 Vali Acc: 0.554 Test Loss: 1.140 Test Acc: 0.554
Validation loss decreased (-0.554042 --> -0.554043).  Saving model ...
Epoch: 5 cost time: 1.3653326034545898
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.112 Vali Acc: 0.527 Test Loss: 1.112 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9910094738006592
Epoch: 6, Steps: 10 | Train Loss: 0.705 Vali Loss: 1.094 Vali Acc: 0.514 Test Loss: 1.094 Test Acc: 0.514
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0174455642700195
Epoch: 7, Steps: 10 | Train Loss: 0.580 Vali Loss: 1.058 Vali Acc: 0.541 Test Loss: 1.058 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6720499992370605
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
Validation loss decreased (-0.554043 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 1.121445655822754
Epoch: 9, Steps: 10 | Train Loss: 0.359 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4158120155334473
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 1.039 Vali Acc: 0.608 Test Loss: 1.039 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 11 cost time: 1.1651620864868164
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.068 Vali Acc: 0.608 Test Loss: 1.068 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.851057767868042
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.078 Vali Acc: 0.608 Test Loss: 1.078 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1289477348327637
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.123 Vali Acc: 0.595 Test Loss: 1.123 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1286940574645996
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.136 Vali Acc: 0.608 Test Loss: 1.136 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2890946865081787
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.171 Vali Acc: 0.608 Test Loss: 1.171 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9730536937713623
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.176 Vali Acc: 0.608 Test Loss: 1.176 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8068990707397461
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
Validation loss decreased (-0.608098 --> -0.621610).  Saving model ...
Epoch: 18 cost time: 1.019266128540039
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.215 Vali Acc: 0.622 Test Loss: 1.215 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1536986827850342
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.246 Vali Acc: 0.608 Test Loss: 1.246 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4387280941009521
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.256 Vali Acc: 0.622 Test Loss: 1.256 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.262660026550293
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.275 Vali Acc: 0.622 Test Loss: 1.275 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.082610845565796
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.297 Vali Acc: 0.622 Test Loss: 1.297 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.235267162322998
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.313 Vali Acc: 0.622 Test Loss: 1.313 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.345473051071167
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.332 Vali Acc: 0.622 Test Loss: 1.332 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0978567600250244
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3076348304748535
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.370 Vali Acc: 0.622 Test Loss: 1.370 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8681178092956543
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.376 Vali Acc: 0.608 Test Loss: 1.376 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 186146
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.9531867504119873
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.396 Vali Acc: 0.284 Test Loss: 1.396 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7694203853607178
Epoch: 2, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.306 Vali Acc: 0.392 Test Loss: 1.306 Test Acc: 0.392
Validation loss decreased (-0.283770 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.8838028907775879
Epoch: 3, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.231 Vali Acc: 0.459 Test Loss: 1.231 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.8967483043670654
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.150 Vali Acc: 0.486 Test Loss: 1.150 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.9871945381164551
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.108 Vali Acc: 0.568 Test Loss: 1.108 Test Acc: 0.568
Validation loss decreased (-0.486475 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 0.8421595096588135
Epoch: 6, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.095 Vali Acc: 0.581 Test Loss: 1.095 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 7 cost time: 0.9111006259918213
Epoch: 7, Steps: 10 | Train Loss: 0.581 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.854071855545044
Epoch: 8, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.063 Vali Acc: 0.568 Test Loss: 1.063 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8605115413665771
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.045 Vali Acc: 0.568 Test Loss: 1.045 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8923873901367188
Epoch: 10, Steps: 10 | Train Loss: 0.288 Vali Loss: 1.065 Vali Acc: 0.581 Test Loss: 1.065 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0640058517456055
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.079 Vali Acc: 0.568 Test Loss: 1.079 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9580807685852051
Epoch: 12, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.098 Vali Acc: 0.541 Test Loss: 1.098 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8823409080505371
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.067169427871704
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.144 Vali Acc: 0.595 Test Loss: 1.144 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9015457630157471
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.165 Vali Acc: 0.595 Test Loss: 1.165 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.1161503791809082
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.199 Vali Acc: 0.581 Test Loss: 1.199 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9347143173217773
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.228 Vali Acc: 0.568 Test Loss: 1.228 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 183524
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.732527256011963
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.404 Vali Acc: 0.203 Test Loss: 1.404 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.1918139457702637
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.324 Vali Acc: 0.324 Test Loss: 1.324 Test Acc: 0.324
Validation loss decreased (-0.202689 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 1.0309643745422363
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.242 Vali Acc: 0.432 Test Loss: 1.242 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.7974967956542969
Epoch: 4, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.179 Vali Acc: 0.419 Test Loss: 1.179 Test Acc: 0.419
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9543600082397461
Epoch: 5, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.123 Vali Acc: 0.473 Test Loss: 1.123 Test Acc: 0.473
Validation loss decreased (-0.432420 --> -0.472962).  Saving model ...
Epoch: 6 cost time: 1.060837745666504
Epoch: 6, Steps: 10 | Train Loss: 0.726 Vali Loss: 1.099 Vali Acc: 0.514 Test Loss: 1.099 Test Acc: 0.514
Validation loss decreased (-0.472962 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 0.9246492385864258
Epoch: 7, Steps: 10 | Train Loss: 0.594 Vali Loss: 1.071 Vali Acc: 0.554 Test Loss: 1.071 Test Acc: 0.554
Validation loss decreased (-0.513503 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.1489121913909912
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1213936805725098
Epoch: 9, Steps: 10 | Train Loss: 0.374 Vali Loss: 1.089 Vali Acc: 0.541 Test Loss: 1.089 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2908411026000977
Epoch: 10, Steps: 10 | Train Loss: 0.284 Vali Loss: 1.071 Vali Acc: 0.541 Test Loss: 1.071 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.371887445449829
Epoch: 11, Steps: 10 | Train Loss: 0.208 Vali Loss: 1.065 Vali Acc: 0.527 Test Loss: 1.065 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1001217365264893
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.088 Vali Acc: 0.554 Test Loss: 1.088 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0435805320739746
Epoch: 13, Steps: 10 | Train Loss: 0.121 Vali Loss: 1.123 Vali Acc: 0.554 Test Loss: 1.123 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0934717655181885
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.131 Vali Acc: 0.568 Test Loss: 1.131 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 15 cost time: 1.3959310054779053
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.145 Vali Acc: 0.554 Test Loss: 1.145 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.06455659866333
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.157 Vali Acc: 0.554 Test Loss: 1.157 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8657650947570801
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.192 Vali Acc: 0.568 Test Loss: 1.192 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.024709939956665
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.217 Vali Acc: 0.554 Test Loss: 1.217 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0226233005523682
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.228 Vali Acc: 0.581 Test Loss: 1.228 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581069).  Saving model ...
Epoch: 20 cost time: 1.0008502006530762
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.242 Vali Acc: 0.568 Test Loss: 1.242 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.004727840423584
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.257 Vali Acc: 0.568 Test Loss: 1.257 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.96994948387146
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.273 Vali Acc: 0.581 Test Loss: 1.273 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4763588905334473
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.294 Vali Acc: 0.554 Test Loss: 1.294 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9143791198730469
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.317 Vali Acc: 0.568 Test Loss: 1.317 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0939345359802246
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.323 Vali Acc: 0.568 Test Loss: 1.323 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9949564933776855
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.330 Vali Acc: 0.568 Test Loss: 1.330 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0015277862548828
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.345 Vali Acc: 0.568 Test Loss: 1.345 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9823675155639648
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.360 Vali Acc: 0.568 Test Loss: 1.360 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9963583946228027
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.374 Vali Acc: 0.568 Test Loss: 1.374 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 185402
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.17952036857605
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.386 Vali Acc: 0.311 Test Loss: 1.386 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0058131217956543
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.306 Vali Acc: 0.392 Test Loss: 1.306 Test Acc: 0.392
Validation loss decreased (-0.310797 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.8006279468536377
Epoch: 3, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.8388180732727051
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.138 Vali Acc: 0.514 Test Loss: 1.138 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8029255867004395
Epoch: 5, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.091 Vali Acc: 0.568 Test Loss: 1.091 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 1.0180158615112305
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.052 Vali Acc: 0.622 Test Loss: 1.052 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 1.0214896202087402
Epoch: 7, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.033 Vali Acc: 0.581 Test Loss: 1.033 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9010791778564453
Epoch: 8, Steps: 10 | Train Loss: 0.469 Vali Loss: 1.032 Vali Acc: 0.608 Test Loss: 1.032 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9550137519836426
Epoch: 9, Steps: 10 | Train Loss: 0.368 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0592057704925537
Epoch: 10, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8590993881225586
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.030 Vali Acc: 0.595 Test Loss: 1.030 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9380588531494141
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.037 Vali Acc: 0.595 Test Loss: 1.037 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0035700798034668
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.045 Vali Acc: 0.595 Test Loss: 1.045 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8783013820648193
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.070 Vali Acc: 0.568 Test Loss: 1.070 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9634504318237305
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.093 Vali Acc: 0.595 Test Loss: 1.093 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9200677871704102
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.114 Vali Acc: 0.608 Test Loss: 1.114 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 183284
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.217747449874878
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.444 Vali Acc: 0.216 Test Loss: 1.444 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.950192928314209
Epoch: 2, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.343 Vali Acc: 0.338 Test Loss: 1.343 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.6771721839904785
Epoch: 3, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.245 Vali Acc: 0.392 Test Loss: 1.245 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.0212182998657227
Epoch: 4, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.190 Vali Acc: 0.459 Test Loss: 1.190 Test Acc: 0.459
Validation loss decreased (-0.391879 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 1.0901226997375488
Epoch: 5, Steps: 10 | Train Loss: 0.846 Vali Loss: 1.144 Vali Acc: 0.486 Test Loss: 1.144 Test Acc: 0.486
Validation loss decreased (-0.459448 --> -0.486475).  Saving model ...
Epoch: 6 cost time: 0.9989514350891113
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.102 Vali Acc: 0.527 Test Loss: 1.102 Test Acc: 0.527
Validation loss decreased (-0.486475 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.9182801246643066
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 1.068 Vali Acc: 0.514 Test Loss: 1.068 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5404446125030518
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.060 Vali Acc: 0.541 Test Loss: 1.060 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 9 cost time: 1.0550224781036377
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.058 Vali Acc: 0.527 Test Loss: 1.058 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9633920192718506
Epoch: 10, Steps: 10 | Train Loss: 0.287 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0336253643035889
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
Validation loss decreased (-0.540530 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.9479584693908691
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0434396266937256
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.106 Vali Acc: 0.568 Test Loss: 1.106 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.201625108718872
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0725219249725342
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.156 Vali Acc: 0.568 Test Loss: 1.156 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.005429744720459
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.177 Vali Acc: 0.595 Test Loss: 1.177 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594583).  Saving model ...
Epoch: 17 cost time: 0.9934806823730469
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.200 Vali Acc: 0.568 Test Loss: 1.200 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8831555843353271
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.204 Vali Acc: 0.581 Test Loss: 1.204 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.140169620513916
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.243 Vali Acc: 0.595 Test Loss: 1.243 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9476931095123291
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.261 Vali Acc: 0.595 Test Loss: 1.261 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3240606784820557
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.267 Vali Acc: 0.595 Test Loss: 1.267 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9975912570953369
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.284 Vali Acc: 0.581 Test Loss: 1.284 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1650331020355225
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.307 Vali Acc: 0.595 Test Loss: 1.307 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9434535503387451
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.317 Vali Acc: 0.568 Test Loss: 1.317 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1439294815063477
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.335 Vali Acc: 0.595 Test Loss: 1.335 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9859297275543213
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.349 Vali Acc: 0.581 Test Loss: 1.349 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 186034
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.768381357192993
Epoch: 1, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.361 Vali Acc: 0.243 Test Loss: 1.361 Test Acc: 0.243
Validation loss decreased (inf --> -0.243230).  Saving model ...
Epoch: 2 cost time: 1.030292272567749
Epoch: 2, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.284 Vali Acc: 0.405 Test Loss: 1.284 Test Acc: 0.405
Validation loss decreased (-0.243230 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 0.9279906749725342
Epoch: 3, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.191 Vali Acc: 0.514 Test Loss: 1.191 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513502).  Saving model ...
Epoch: 4 cost time: 0.9677078723907471
Epoch: 4, Steps: 10 | Train Loss: 0.961 Vali Loss: 1.134 Vali Acc: 0.568 Test Loss: 1.134 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 1.2102129459381104
Epoch: 5, Steps: 10 | Train Loss: 0.812 Vali Loss: 1.095 Vali Acc: 0.554 Test Loss: 1.095 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2056951522827148
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 1.050 Vali Acc: 0.527 Test Loss: 1.050 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1885895729064941
Epoch: 7, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
Validation loss decreased (-0.567556 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 1.082324504852295
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.024 Vali Acc: 0.568 Test Loss: 1.024 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.1527190208435059
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.996 Vali Acc: 0.568 Test Loss: 0.996 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567558).  Saving model ...
Epoch: 10 cost time: 1.0849227905273438
Epoch: 10, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.039 Vali Acc: 0.514 Test Loss: 1.039 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8806090354919434
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 1.027 Vali Acc: 0.527 Test Loss: 1.027 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1152257919311523
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.040 Vali Acc: 0.581 Test Loss: 1.040 Test Acc: 0.581
Validation loss decreased (-0.567558 --> -0.581071).  Saving model ...
Epoch: 13 cost time: 1.0972046852111816
Epoch: 13, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.074 Vali Acc: 0.554 Test Loss: 1.074 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2700910568237305
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.118 Vali Acc: 0.541 Test Loss: 1.118 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.059689998626709
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.113 Vali Acc: 0.554 Test Loss: 1.113 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4576869010925293
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.125 Vali Acc: 0.554 Test Loss: 1.125 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2082610130310059
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.154 Vali Acc: 0.541 Test Loss: 1.154 Test Acc: 0.541
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.959956169128418
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.187 Vali Acc: 0.527 Test Loss: 1.187 Test Acc: 0.527
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8876800537109375
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.197 Vali Acc: 0.527 Test Loss: 1.197 Test Acc: 0.527
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8437879085540771
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.214 Vali Acc: 0.527 Test Loss: 1.214 Test Acc: 0.527
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.025883436203003
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.233 Vali Acc: 0.527 Test Loss: 1.233 Test Acc: 0.527
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.0139989852905273
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.257 Vali Acc: 0.527 Test Loss: 1.257 Test Acc: 0.527
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 186388
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5860564708709717
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.345 Vali Acc: 0.311 Test Loss: 1.345 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.9312107563018799
Epoch: 2, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.283 Vali Acc: 0.446 Test Loss: 1.283 Test Acc: 0.446
Validation loss decreased (-0.310797 --> -0.445933).  Saving model ...
Epoch: 3 cost time: 0.9045417308807373
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.217 Vali Acc: 0.500 Test Loss: 1.217 Test Acc: 0.500
Validation loss decreased (-0.445933 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1561861038208008
Epoch: 4, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.174 Vali Acc: 0.541 Test Loss: 1.174 Test Acc: 0.541
Validation loss decreased (-0.499988 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.8887202739715576
Epoch: 5, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.114 Vali Acc: 0.581 Test Loss: 1.114 Test Acc: 0.581
Validation loss decreased (-0.540529 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.7827413082122803
Epoch: 6, Steps: 10 | Train Loss: 0.717 Vali Loss: 1.107 Vali Acc: 0.568 Test Loss: 1.107 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9566104412078857
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.084 Vali Acc: 0.500 Test Loss: 1.084 Test Acc: 0.500
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0351197719573975
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.060 Vali Acc: 0.568 Test Loss: 1.060 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0032684803009033
Epoch: 9, Steps: 10 | Train Loss: 0.379 Vali Loss: 1.077 Vali Acc: 0.581 Test Loss: 1.077 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 10 cost time: 1.1288526058197021
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.056 Vali Acc: 0.568 Test Loss: 1.056 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8419568538665771
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.076 Vali Acc: 0.608 Test Loss: 1.076 Test Acc: 0.608
Validation loss decreased (-0.581070 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 0.929509162902832
Epoch: 12, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9237849712371826
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.127 Vali Acc: 0.595 Test Loss: 1.127 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0694091320037842
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.141 Vali Acc: 0.608 Test Loss: 1.141 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.045243501663208
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.171 Vali Acc: 0.608 Test Loss: 1.171 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.139815092086792
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.193 Vali Acc: 0.595 Test Loss: 1.193 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8657326698303223
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.212 Vali Acc: 0.608 Test Loss: 1.212 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4083654880523682
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.232 Vali Acc: 0.608 Test Loss: 1.232 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9714412689208984
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.260 Vali Acc: 0.622 Test Loss: 1.260 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621609).  Saving model ...
Epoch: 20 cost time: 1.1217989921569824
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.281 Vali Acc: 0.622 Test Loss: 1.281 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8255810737609863
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.292 Vali Acc: 0.608 Test Loss: 1.292 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7661876678466797
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.308 Vali Acc: 0.608 Test Loss: 1.308 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1321907043457031
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.322 Vali Acc: 0.622 Test Loss: 1.322 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9746971130371094
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.338 Vali Acc: 0.608 Test Loss: 1.338 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9768989086151123
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.355 Vali Acc: 0.622 Test Loss: 1.355 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0367414951324463
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.372 Vali Acc: 0.622 Test Loss: 1.372 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9912328720092773
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.383 Vali Acc: 0.622 Test Loss: 1.383 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9590673446655273
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.395 Vali Acc: 0.622 Test Loss: 1.395 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9565565586090088
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.413 Vali Acc: 0.622 Test Loss: 1.413 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 184346
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.922255516052246
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.370 Vali Acc: 0.297 Test Loss: 1.370 Test Acc: 0.297
Validation loss decreased (inf --> -0.297284).  Saving model ...
Epoch: 2 cost time: 1.0365002155303955
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.281 Vali Acc: 0.365 Test Loss: 1.281 Test Acc: 0.365
Validation loss decreased (-0.297284 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.9508621692657471
Epoch: 3, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.202 Vali Acc: 0.473 Test Loss: 1.202 Test Acc: 0.473
Validation loss decreased (-0.364852 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.8488965034484863
Epoch: 4, Steps: 10 | Train Loss: 1.000 Vali Loss: 1.151 Vali Acc: 0.500 Test Loss: 1.151 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 1.0023889541625977
Epoch: 5, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.093 Vali Acc: 0.527 Test Loss: 1.093 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.914320707321167
Epoch: 6, Steps: 10 | Train Loss: 0.697 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.9034452438354492
Epoch: 7, Steps: 10 | Train Loss: 0.577 Vali Loss: 1.062 Vali Acc: 0.541 Test Loss: 1.062 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1737699508666992
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 1.044 Vali Acc: 0.568 Test Loss: 1.044 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.9535014629364014
Epoch: 9, Steps: 10 | Train Loss: 0.361 Vali Loss: 1.047 Vali Acc: 0.595 Test Loss: 1.047 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 0.9639153480529785
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.054 Vali Acc: 0.581 Test Loss: 1.054 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.228147029876709
Epoch: 11, Steps: 10 | Train Loss: 0.202 Vali Loss: 1.047 Vali Acc: 0.608 Test Loss: 1.047 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.3675003051757812
Epoch: 12, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.068 Vali Acc: 0.608 Test Loss: 1.068 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9889428615570068
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7585458755493164
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.132 Vali Acc: 0.581 Test Loss: 1.132 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9248344898223877
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.155 Vali Acc: 0.568 Test Loss: 1.155 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9836504459381104
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.165 Vali Acc: 0.581 Test Loss: 1.165 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.929725170135498
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.198 Vali Acc: 0.595 Test Loss: 1.198 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9291996955871582
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.214 Vali Acc: 0.568 Test Loss: 1.214 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.872300386428833
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.244 Vali Acc: 0.568 Test Loss: 1.244 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9387075901031494
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.274 Vali Acc: 0.568 Test Loss: 1.274 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.728501558303833
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.283 Vali Acc: 0.568 Test Loss: 1.283 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 185540
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.630214214324951
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.427 Vali Acc: 0.230 Test Loss: 1.427 Test Acc: 0.230
Validation loss decreased (inf --> -0.229715).  Saving model ...
Epoch: 2 cost time: 0.7903974056243896
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.350 Vali Acc: 0.270 Test Loss: 1.350 Test Acc: 0.270
Validation loss decreased (-0.229715 --> -0.270257).  Saving model ...
Epoch: 3 cost time: 0.7216112613677979
Epoch: 3, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.246 Vali Acc: 0.432 Test Loss: 1.246 Test Acc: 0.432
Validation loss decreased (-0.270257 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 1.1302249431610107
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.161 Vali Acc: 0.527 Test Loss: 1.161 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.6334850788116455
Epoch: 5, Steps: 10 | Train Loss: 0.841 Vali Loss: 1.116 Vali Acc: 0.568 Test Loss: 1.116 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567556).  Saving model ...
Epoch: 6 cost time: 1.0456609725952148
Epoch: 6, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.085 Vali Acc: 0.554 Test Loss: 1.085 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8526122570037842
Epoch: 7, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.066 Vali Acc: 0.581 Test Loss: 1.066 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.7822892665863037
Epoch: 8, Steps: 10 | Train Loss: 0.452 Vali Loss: 1.063 Vali Acc: 0.581 Test Loss: 1.063 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 0.99334716796875
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.067 Vali Acc: 0.595 Test Loss: 1.067 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 10 cost time: 0.8918344974517822
Epoch: 10, Steps: 10 | Train Loss: 0.272 Vali Loss: 1.081 Vali Acc: 0.554 Test Loss: 1.081 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7287001609802246
Epoch: 11, Steps: 10 | Train Loss: 0.198 Vali Loss: 1.066 Vali Acc: 0.608 Test Loss: 1.066 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 12 cost time: 0.837733268737793
Epoch: 12, Steps: 10 | Train Loss: 0.148 Vali Loss: 1.081 Vali Acc: 0.608 Test Loss: 1.081 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9192790985107422
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9702048301696777
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.168 Vali Acc: 0.568 Test Loss: 1.168 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.110748291015625
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.176 Vali Acc: 0.554 Test Loss: 1.176 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0819895267486572
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.187 Vali Acc: 0.554 Test Loss: 1.187 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9331133365631104
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.207 Vali Acc: 0.554 Test Loss: 1.207 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7616558074951172
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.253 Vali Acc: 0.581 Test Loss: 1.253 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7543237209320068
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.273 Vali Acc: 0.595 Test Loss: 1.273 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8547534942626953
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.289 Vali Acc: 0.581 Test Loss: 1.289 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6830384731292725
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.301 Vali Acc: 0.581 Test Loss: 1.301 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 185138
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.2082760334014893
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.465 Vali Acc: 0.176 Test Loss: 1.465 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.0038690567016602
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.384 Vali Acc: 0.230 Test Loss: 1.384 Test Acc: 0.230
Validation loss decreased (-0.175661 --> -0.229716).  Saving model ...
Epoch: 3 cost time: 0.9313695430755615
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.284 Vali Acc: 0.392 Test Loss: 1.284 Test Acc: 0.392
Validation loss decreased (-0.229716 --> -0.391879).  Saving model ...
Epoch: 4 cost time: 1.118622064590454
Epoch: 4, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.216 Vali Acc: 0.473 Test Loss: 1.216 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.8749516010284424
Epoch: 5, Steps: 10 | Train Loss: 0.819 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.0871641635894775
Epoch: 6, Steps: 10 | Train Loss: 0.688 Vali Loss: 1.103 Vali Acc: 0.527 Test Loss: 1.103 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 1.1091067790985107
Epoch: 7, Steps: 10 | Train Loss: 0.560 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 1.026498794555664
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 1.006943941116333
Epoch: 9, Steps: 10 | Train Loss: 0.350 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.7561941146850586
Epoch: 10, Steps: 10 | Train Loss: 0.263 Vali Loss: 1.046 Vali Acc: 0.581 Test Loss: 1.046 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8946468830108643
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
Validation loss decreased (-0.581071 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.013700008392334
Epoch: 12, Steps: 10 | Train Loss: 0.147 Vali Loss: 1.070 Vali Acc: 0.608 Test Loss: 1.070 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9689981937408447
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 1.116 Vali Acc: 0.581 Test Loss: 1.116 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1633567810058594
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.105 Vali Acc: 0.608 Test Loss: 1.105 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9801232814788818
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.111 Vali Acc: 0.581 Test Loss: 1.111 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9096310138702393
Epoch: 16, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.146 Vali Acc: 0.595 Test Loss: 1.146 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0183625221252441
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.178 Vali Acc: 0.581 Test Loss: 1.178 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8368237018585205
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.196 Vali Acc: 0.581 Test Loss: 1.196 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8910403251647949
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0622656345367432
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.220 Vali Acc: 0.581 Test Loss: 1.220 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9043428897857666
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.244 Vali Acc: 0.581 Test Loss: 1.244 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 183140
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.714385747909546
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.373 Vali Acc: 0.284 Test Loss: 1.373 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.3131365776062012
Epoch: 2, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.289 Vali Acc: 0.419 Test Loss: 1.289 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 1.0615742206573486
Epoch: 3, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.214 Vali Acc: 0.432 Test Loss: 1.214 Test Acc: 0.432
Validation loss decreased (-0.418906 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.9205067157745361
Epoch: 4, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.151 Vali Acc: 0.527 Test Loss: 1.151 Test Acc: 0.527
Validation loss decreased (-0.432420 --> -0.527016).  Saving model ...
Epoch: 5 cost time: 1.2569360733032227
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 1.112 Vali Acc: 0.514 Test Loss: 1.112 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0784344673156738
Epoch: 6, Steps: 10 | Train Loss: 0.699 Vali Loss: 1.062 Vali Acc: 0.554 Test Loss: 1.062 Test Acc: 0.554
Validation loss decreased (-0.527016 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 1.0422523021697998
Epoch: 7, Steps: 10 | Train Loss: 0.569 Vali Loss: 1.041 Vali Acc: 0.541 Test Loss: 1.041 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1128888130187988
Epoch: 8, Steps: 10 | Train Loss: 0.462 Vali Loss: 1.033 Vali Acc: 0.541 Test Loss: 1.033 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9435644149780273
Epoch: 9, Steps: 10 | Train Loss: 0.360 Vali Loss: 1.016 Vali Acc: 0.554 Test Loss: 1.016 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554044).  Saving model ...
Epoch: 10 cost time: 1.0383954048156738
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 1.012 Vali Acc: 0.568 Test Loss: 1.012 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 11 cost time: 0.9103748798370361
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.051 Vali Acc: 0.608 Test Loss: 1.051 Test Acc: 0.608
Validation loss decreased (-0.567557 --> -0.608098).  Saving model ...
Epoch: 12 cost time: 1.0464532375335693
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.051 Vali Acc: 0.554 Test Loss: 1.051 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9529533386230469
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.069 Vali Acc: 0.568 Test Loss: 1.069 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8792097568511963
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.092 Vali Acc: 0.568 Test Loss: 1.092 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0721595287322998
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.115 Vali Acc: 0.568 Test Loss: 1.115 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9856359958648682
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0224452018737793
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.160 Vali Acc: 0.568 Test Loss: 1.160 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1750714778900146
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.176 Vali Acc: 0.568 Test Loss: 1.176 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9693939685821533
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.198 Vali Acc: 0.568 Test Loss: 1.198 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9843053817749023
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.219 Vali Acc: 0.581 Test Loss: 1.219 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0627272129058838
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.237 Vali Acc: 0.581 Test Loss: 1.237 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 186378
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.283008575439453
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.367 Vali Acc: 0.311 Test Loss: 1.367 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8432044982910156
Epoch: 2, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.298 Vali Acc: 0.365 Test Loss: 1.298 Test Acc: 0.365
Validation loss decreased (-0.310797 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 0.856820821762085
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.233 Vali Acc: 0.405 Test Loss: 1.233 Test Acc: 0.405
Validation loss decreased (-0.364852 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.8363423347473145
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.172 Vali Acc: 0.514 Test Loss: 1.172 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.8320915699005127
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.8301143646240234
Epoch: 6, Steps: 10 | Train Loss: 0.684 Vali Loss: 1.079 Vali Acc: 0.514 Test Loss: 1.079 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 1.0505552291870117
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 1.065 Vali Acc: 0.527 Test Loss: 1.065 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 8 cost time: 0.8471956253051758
Epoch: 8, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.055 Vali Acc: 0.527 Test Loss: 1.055 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527016).  Saving model ...
Epoch: 9 cost time: 0.7778482437133789
Epoch: 9, Steps: 10 | Train Loss: 0.365 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
Validation loss decreased (-0.527016 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.161224603652954
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 1.029 Vali Acc: 0.554 Test Loss: 1.029 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.802924394607544
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 1.036 Vali Acc: 0.554 Test Loss: 1.036 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1097640991210938
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.066 Vali Acc: 0.541 Test Loss: 1.066 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8822343349456787
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.089 Vali Acc: 0.514 Test Loss: 1.089 Test Acc: 0.514
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0018069744110107
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.090 Vali Acc: 0.554 Test Loss: 1.090 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0664958953857422
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.116 Vali Acc: 0.554 Test Loss: 1.116 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3069519996643066
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0603413581848145
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.173 Vali Acc: 0.541 Test Loss: 1.173 Test Acc: 0.541
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9186999797821045
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.189 Vali Acc: 0.541 Test Loss: 1.189 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8764040470123291
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.203 Vali Acc: 0.581 Test Loss: 1.203 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581069).  Saving model ...
Epoch: 20 cost time: 0.9317460060119629
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.226 Vali Acc: 0.568 Test Loss: 1.226 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0003349781036377
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.243 Vali Acc: 0.568 Test Loss: 1.243 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1054067611694336
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.259 Vali Acc: 0.554 Test Loss: 1.259 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.95263671875
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.279 Vali Acc: 0.568 Test Loss: 1.279 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9923737049102783
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.298 Vali Acc: 0.568 Test Loss: 1.298 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8631162643432617
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.315 Vali Acc: 0.554 Test Loss: 1.315 Test Acc: 0.554
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0133090019226074
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.326 Vali Acc: 0.581 Test Loss: 1.326 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9000961780548096
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.345 Vali Acc: 0.554 Test Loss: 1.345 Test Acc: 0.554
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1157095432281494
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.362 Vali Acc: 0.554 Test Loss: 1.362 Test Acc: 0.554
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0103669166564941
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.376 Vali Acc: 0.554 Test Loss: 1.376 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 188820
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1346702575683594
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.394 Vali Acc: 0.297 Test Loss: 1.394 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 1.030918836593628
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.302 Vali Acc: 0.365 Test Loss: 1.302 Test Acc: 0.365
Validation loss decreased (-0.297283 --> -0.364852).  Saving model ...
Epoch: 3 cost time: 1.158019781112671
Epoch: 3, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.216 Vali Acc: 0.459 Test Loss: 1.216 Test Acc: 0.459
Validation loss decreased (-0.364852 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 1.1152665615081787
Epoch: 4, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.122 Vali Acc: 0.568 Test Loss: 1.122 Test Acc: 0.568
Validation loss decreased (-0.459447 --> -0.567556).  Saving model ...
Epoch: 5 cost time: 0.9727332592010498
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 1.073 Vali Acc: 0.608 Test Loss: 1.073 Test Acc: 0.608
Validation loss decreased (-0.567556 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 0.8501796722412109
Epoch: 6, Steps: 10 | Train Loss: 0.712 Vali Loss: 1.045 Vali Acc: 0.622 Test Loss: 1.045 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 0.9530758857727051
Epoch: 7, Steps: 10 | Train Loss: 0.586 Vali Loss: 1.026 Vali Acc: 0.568 Test Loss: 1.026 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8683412075042725
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.008 Vali Acc: 0.581 Test Loss: 1.008 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8993680477142334
Epoch: 9, Steps: 10 | Train Loss: 0.375 Vali Loss: 1.000 Vali Acc: 0.608 Test Loss: 1.000 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.973569393157959
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 1.004 Vali Acc: 0.595 Test Loss: 1.004 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0557541847229004
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.013 Vali Acc: 0.622 Test Loss: 1.013 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 0.7672939300537109
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.023 Vali Acc: 0.608 Test Loss: 1.023 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0822877883911133
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 1.048 Vali Acc: 0.581 Test Loss: 1.048 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0593023300170898
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.075 Vali Acc: 0.581 Test Loss: 1.075 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9483599662780762
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.091 Vali Acc: 0.581 Test Loss: 1.091 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8696510791778564
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.113 Vali Acc: 0.581 Test Loss: 1.113 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8397536277770996
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.135 Vali Acc: 0.595 Test Loss: 1.135 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.951331377029419
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.155 Vali Acc: 0.595 Test Loss: 1.155 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0880706310272217
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.186 Vali Acc: 0.581 Test Loss: 1.186 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9614615440368652
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.201 Vali Acc: 0.568 Test Loss: 1.201 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1637930870056152
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.221 Vali Acc: 0.608 Test Loss: 1.221 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 190466
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.1003737449645996
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.382 Vali Acc: 0.338 Test Loss: 1.382 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 1.044067621231079
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.304 Vali Acc: 0.392 Test Loss: 1.304 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.7923352718353271
Epoch: 3, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.217 Vali Acc: 0.473 Test Loss: 1.217 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.8871450424194336
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.137 Vali Acc: 0.514 Test Loss: 1.137 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.1628320217132568
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.089 Vali Acc: 0.568 Test Loss: 1.089 Test Acc: 0.568
Validation loss decreased (-0.513502 --> -0.567557).  Saving model ...
Epoch: 6 cost time: 0.7460947036743164
Epoch: 6, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.050 Vali Acc: 0.622 Test Loss: 1.050 Test Acc: 0.622
Validation loss decreased (-0.567557 --> -0.621611).  Saving model ...
Epoch: 7 cost time: 0.825512170791626
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.031 Vali Acc: 0.595 Test Loss: 1.031 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9449894428253174
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.029 Vali Acc: 0.608 Test Loss: 1.029 Test Acc: 0.608
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9370543956756592
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.999 Vali Acc: 0.581 Test Loss: 0.999 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8789548873901367
Epoch: 10, Steps: 10 | Train Loss: 0.278 Vali Loss: 1.017 Vali Acc: 0.568 Test Loss: 1.017 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1705944538116455
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.026 Vali Acc: 0.595 Test Loss: 1.026 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9162285327911377
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.034 Vali Acc: 0.595 Test Loss: 1.034 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9342219829559326
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.041 Vali Acc: 0.608 Test Loss: 1.041 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8444473743438721
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9086332321166992
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.089 Vali Acc: 0.595 Test Loss: 1.089 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7184493541717529
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.110 Vali Acc: 0.608 Test Loss: 1.110 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm64_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 183284
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs200_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.7530195713043213
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.403 Vali Acc: 0.203 Test Loss: 1.403 Test Acc: 0.203
Validation loss decreased (inf --> -0.202689).  Saving model ...
Epoch: 2 cost time: 1.0608229637145996
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.338 Vali Acc: 0.324 Test Loss: 1.338 Test Acc: 0.324
Validation loss decreased (-0.202689 --> -0.324311).  Saving model ...
Epoch: 3 cost time: 0.8580548763275146
Epoch: 3, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.260 Vali Acc: 0.432 Test Loss: 1.260 Test Acc: 0.432
Validation loss decreased (-0.324311 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.9875421524047852
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.198 Vali Acc: 0.459 Test Loss: 1.198 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459447).  Saving model ...
Epoch: 5 cost time: 1.101144552230835
Epoch: 5, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.147 Vali Acc: 0.500 Test Loss: 1.147 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.0646257400512695
Epoch: 6, Steps: 10 | Train Loss: 0.723 Vali Loss: 1.096 Vali Acc: 0.541 Test Loss: 1.096 Test Acc: 0.541
Validation loss decreased (-0.499989 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.9659183025360107
Epoch: 7, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.073 Vali Acc: 0.554 Test Loss: 1.073 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.9341301918029785
Epoch: 8, Steps: 10 | Train Loss: 0.499 Vali Loss: 1.039 Vali Acc: 0.568 Test Loss: 1.039 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 9 cost time: 0.7561683654785156
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.038 Vali Acc: 0.541 Test Loss: 1.038 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.703704833984375
Epoch: 10, Steps: 10 | Train Loss: 0.311 Vali Loss: 1.031 Vali Acc: 0.541 Test Loss: 1.031 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0323615074157715
Epoch: 11, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.039 Vali Acc: 0.581 Test Loss: 1.039 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 0.951303243637085
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 1.028 Vali Acc: 0.568 Test Loss: 1.028 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0481855869293213
Epoch: 13, Steps: 10 | Train Loss: 0.128 Vali Loss: 1.103 Vali Acc: 0.568 Test Loss: 1.103 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2186408042907715
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.110 Vali Acc: 0.595 Test Loss: 1.110 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594583).  Saving model ...
Epoch: 15 cost time: 0.9452481269836426
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.120 Vali Acc: 0.581 Test Loss: 1.120 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1293869018554688
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.148 Vali Acc: 0.595 Test Loss: 1.148 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9192543029785156
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9001064300537109
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0428266525268555
Epoch: 19, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.217 Vali Acc: 0.581 Test Loss: 1.217 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0504264831542969
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8486955165863037
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.258 Vali Acc: 0.595 Test Loss: 1.258 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3059132099151611
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.274 Vali Acc: 0.581 Test Loss: 1.274 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3008105754852295
Epoch: 23, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.295 Vali Acc: 0.581 Test Loss: 1.295 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.0435972213745117
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.307 Vali Acc: 0.581 Test Loss: 1.307 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs200_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 182172
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs134_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6510848999023438
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.439 Vali Acc: 0.203 Test Loss: 1.439 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 0.8461344242095947
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.341 Vali Acc: 0.297 Test Loss: 1.341 Test Acc: 0.297
Validation loss decreased (-0.202688 --> -0.297284).  Saving model ...
Epoch: 3 cost time: 0.7751779556274414
Epoch: 3, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.255 Vali Acc: 0.405 Test Loss: 1.255 Test Acc: 0.405
Validation loss decreased (-0.297284 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.75091552734375
Epoch: 4, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.171 Vali Acc: 0.486 Test Loss: 1.171 Test Acc: 0.486
Validation loss decreased (-0.405393 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.776757001876831
Epoch: 5, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.134 Vali Acc: 0.500 Test Loss: 1.134 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.7528302669525146
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.099 Vali Acc: 0.500 Test Loss: 1.099 Test Acc: 0.500
Validation loss decreased (-0.499989 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.8109292984008789
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
Validation loss decreased (-0.499989 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.7120881080627441
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.050 Vali Acc: 0.527 Test Loss: 1.050 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1864781379699707
Epoch: 9, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.063 Vali Acc: 0.541 Test Loss: 1.063 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.041994333267212
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 1.043 Vali Acc: 0.514 Test Loss: 1.043 Test Acc: 0.514
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.227423906326294
Epoch: 11, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.064 Vali Acc: 0.568 Test Loss: 1.064 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 12 cost time: 0.6663477420806885
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 1.047 Vali Acc: 0.568 Test Loss: 1.047 Test Acc: 0.568
Validation loss decreased (-0.567557 --> -0.567557).  Saving model ...
Epoch: 13 cost time: 0.7264406681060791
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.116 Vali Acc: 0.541 Test Loss: 1.116 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8648865222930908
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.125 Vali Acc: 0.568 Test Loss: 1.125 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8540928363800049
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.146 Vali Acc: 0.541 Test Loss: 1.146 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.843754768371582
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7648298740386963
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.182 Vali Acc: 0.595 Test Loss: 1.182 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594583).  Saving model ...
Epoch: 18 cost time: 0.9671614170074463
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.212 Vali Acc: 0.568 Test Loss: 1.212 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9598870277404785
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.227 Vali Acc: 0.568 Test Loss: 1.227 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1737744808197021
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.247 Vali Acc: 0.581 Test Loss: 1.247 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0007264614105225
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.269 Vali Acc: 0.568 Test Loss: 1.269 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9601216316223145
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.279 Vali Acc: 0.568 Test Loss: 1.279 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1252925395965576
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.299 Vali Acc: 0.581 Test Loss: 1.299 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.002103328704834
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.313 Vali Acc: 0.581 Test Loss: 1.313 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.052868366241455
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.334 Vali Acc: 0.581 Test Loss: 1.334 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2045176029205322
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.342 Vali Acc: 0.581 Test Loss: 1.342 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8181817531585693
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.361 Vali Acc: 0.595 Test Loss: 1.361 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs134_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 181930
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs100_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.863269805908203
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.454 Vali Acc: 0.176 Test Loss: 1.454 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 1.085343837738037
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.350 Vali Acc: 0.338 Test Loss: 1.350 Test Acc: 0.338
Validation loss decreased (-0.175661 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 1.0799860954284668
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.271 Vali Acc: 0.473 Test Loss: 1.271 Test Acc: 0.473
Validation loss decreased (-0.337824 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.8267149925231934
Epoch: 4, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
Validation loss decreased (-0.472960 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9165565967559814
Epoch: 5, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.166 Vali Acc: 0.527 Test Loss: 1.166 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527015).  Saving model ...
Epoch: 6 cost time: 1.2559456825256348
Epoch: 6, Steps: 10 | Train Loss: 0.729 Vali Loss: 1.115 Vali Acc: 0.514 Test Loss: 1.115 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8831222057342529
Epoch: 7, Steps: 10 | Train Loss: 0.597 Vali Loss: 1.095 Vali Acc: 0.486 Test Loss: 1.095 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.031886100769043
Epoch: 8, Steps: 10 | Train Loss: 0.484 Vali Loss: 1.062 Vali Acc: 0.581 Test Loss: 1.062 Test Acc: 0.581
Validation loss decreased (-0.527015 --> -0.581070).  Saving model ...
Epoch: 9 cost time: 1.0395383834838867
Epoch: 9, Steps: 10 | Train Loss: 0.381 Vali Loss: 1.072 Vali Acc: 0.541 Test Loss: 1.072 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0909292697906494
Epoch: 10, Steps: 10 | Train Loss: 0.295 Vali Loss: 1.084 Vali Acc: 0.527 Test Loss: 1.084 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9433088302612305
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 1.056 Vali Acc: 0.581 Test Loss: 1.056 Test Acc: 0.581
Validation loss decreased (-0.581070 --> -0.581071).  Saving model ...
Epoch: 12 cost time: 1.0074117183685303
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 13 cost time: 1.0998334884643555
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 1.120 Vali Acc: 0.595 Test Loss: 1.120 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.010091781616211
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.146 Vali Acc: 0.581 Test Loss: 1.146 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.104325532913208
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.163 Vali Acc: 0.568 Test Loss: 1.163 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1806442737579346
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.172 Vali Acc: 0.581 Test Loss: 1.172 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0818958282470703
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.200 Vali Acc: 0.581 Test Loss: 1.200 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9781007766723633
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.216 Vali Acc: 0.568 Test Loss: 1.216 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0561494827270508
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.253 Vali Acc: 0.581 Test Loss: 1.253 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0896492004394531
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.267 Vali Acc: 0.581 Test Loss: 1.267 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9842250347137451
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.285 Vali Acc: 0.581 Test Loss: 1.285 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7912511825561523
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.306 Vali Acc: 0.581 Test Loss: 1.306 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs100_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 180604
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.4602174758911133
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.352 Vali Acc: 0.284 Test Loss: 1.352 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.8170311450958252
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.287 Vali Acc: 0.405 Test Loss: 1.287 Test Acc: 0.405
Validation loss decreased (-0.283770 --> -0.405393).  Saving model ...
Epoch: 3 cost time: 0.7874503135681152
Epoch: 3, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.215 Vali Acc: 0.514 Test Loss: 1.215 Test Acc: 0.514
Validation loss decreased (-0.405393 --> -0.513501).  Saving model ...
Epoch: 4 cost time: 0.8130314350128174
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.118 Vali Acc: 0.514 Test Loss: 1.118 Test Acc: 0.514
Validation loss decreased (-0.513501 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 0.7241425514221191
Epoch: 5, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.103 Vali Acc: 0.581 Test Loss: 1.103 Test Acc: 0.581
Validation loss decreased (-0.513502 --> -0.581070).  Saving model ...
Epoch: 6 cost time: 0.7447717189788818
Epoch: 6, Steps: 10 | Train Loss: 0.725 Vali Loss: 1.041 Vali Acc: 0.595 Test Loss: 1.041 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.6077125072479248
Epoch: 7, Steps: 10 | Train Loss: 0.605 Vali Loss: 1.016 Vali Acc: 0.595 Test Loss: 1.016 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.7368197441101074
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 1.012 Vali Acc: 0.622 Test Loss: 1.012 Test Acc: 0.622
Validation loss decreased (-0.594584 --> -0.621612).  Saving model ...
Epoch: 9 cost time: 0.8917758464813232
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 1.019 Vali Acc: 0.568 Test Loss: 1.019 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8249120712280273
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 1.019 Vali Acc: 0.554 Test Loss: 1.019 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8617510795593262
Epoch: 11, Steps: 10 | Train Loss: 0.235 Vali Loss: 1.023 Vali Acc: 0.595 Test Loss: 1.023 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7747998237609863
Epoch: 12, Steps: 10 | Train Loss: 0.164 Vali Loss: 1.031 Vali Acc: 0.622 Test Loss: 1.031 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7276749610900879
Epoch: 13, Steps: 10 | Train Loss: 0.125 Vali Loss: 1.037 Vali Acc: 0.608 Test Loss: 1.037 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7189207077026367
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.067 Vali Acc: 0.622 Test Loss: 1.067 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9261841773986816
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.095 Vali Acc: 0.595 Test Loss: 1.095 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8668990135192871
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.122 Vali Acc: 0.622 Test Loss: 1.122 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8797612190246582
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.150 Vali Acc: 0.622 Test Loss: 1.150 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9640684127807617
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.164 Vali Acc: 0.622 Test Loss: 1.164 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 180306
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs67_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2462422847747803
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.427 Vali Acc: 0.216 Test Loss: 1.427 Test Acc: 0.216
Validation loss decreased (inf --> -0.216202).  Saving model ...
Epoch: 2 cost time: 0.8986589908599854
Epoch: 2, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.338 Vali Acc: 0.338 Test Loss: 1.338 Test Acc: 0.338
Validation loss decreased (-0.216202 --> -0.337824).  Saving model ...
Epoch: 3 cost time: 0.9228100776672363
Epoch: 3, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.255 Vali Acc: 0.405 Test Loss: 1.255 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405393).  Saving model ...
Epoch: 4 cost time: 0.9671063423156738
Epoch: 4, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.184 Vali Acc: 0.473 Test Loss: 1.184 Test Acc: 0.473
Validation loss decreased (-0.405393 --> -0.472961).  Saving model ...
Epoch: 5 cost time: 0.9343657493591309
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.128 Vali Acc: 0.459 Test Loss: 1.128 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0164721012115479
Epoch: 6, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.097 Vali Acc: 0.500 Test Loss: 1.097 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499989).  Saving model ...
Epoch: 7 cost time: 0.7192814350128174
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.082 Vali Acc: 0.473 Test Loss: 1.082 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9566750526428223
Epoch: 8, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.061 Vali Acc: 0.514 Test Loss: 1.061 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 9 cost time: 1.0242700576782227
Epoch: 9, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.062 Vali Acc: 0.473 Test Loss: 1.062 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.819136381149292
Epoch: 10, Steps: 10 | Train Loss: 0.270 Vali Loss: 1.047 Vali Acc: 0.514 Test Loss: 1.047 Test Acc: 0.514
Validation loss decreased (-0.513503 --> -0.513503).  Saving model ...
Epoch: 11 cost time: 0.9099793434143066
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 1.088 Vali Acc: 0.527 Test Loss: 1.088 Test Acc: 0.527
Validation loss decreased (-0.513503 --> -0.527016).  Saving model ...
Epoch: 12 cost time: 0.756617546081543
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.093 Vali Acc: 0.541 Test Loss: 1.093 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540530).  Saving model ...
Epoch: 13 cost time: 0.8994760513305664
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 1.116 Vali Acc: 0.527 Test Loss: 1.116 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8839378356933594
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 1.131 Vali Acc: 0.541 Test Loss: 1.131 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9001262187957764
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.163 Vali Acc: 0.527 Test Loss: 1.163 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.915952205657959
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.191 Vali Acc: 0.527 Test Loss: 1.191 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8123931884765625
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.185 Vali Acc: 0.554 Test Loss: 1.185 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554042).  Saving model ...
Epoch: 18 cost time: 1.0093896389007568
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.213 Vali Acc: 0.554 Test Loss: 1.213 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8494524955749512
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.235 Vali Acc: 0.541 Test Loss: 1.235 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.032637357711792
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.258 Vali Acc: 0.541 Test Loss: 1.258 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0445961952209473
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.290 Vali Acc: 0.568 Test Loss: 1.290 Test Acc: 0.568
Validation loss decreased (-0.554042 --> -0.567555).  Saving model ...
Epoch: 22 cost time: 0.9881184101104736
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.292 Vali Acc: 0.541 Test Loss: 1.292 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9560365676879883
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.311 Vali Acc: 0.541 Test Loss: 1.311 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9639720916748047
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.325 Vali Acc: 0.554 Test Loss: 1.325 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.13494873046875
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.335 Vali Acc: 0.568 Test Loss: 1.335 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2954111099243164
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.351 Vali Acc: 0.554 Test Loss: 1.351 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1165359020233154
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0986247062683105
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.379 Vali Acc: 0.581 Test Loss: 1.379 Test Acc: 0.581
Validation loss decreased (-0.567555 --> -0.581067).  Saving model ...
Epoch: 29 cost time: 1.2449822425842285
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.389 Vali Acc: 0.568 Test Loss: 1.389 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9191725254058838
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.412 Vali Acc: 0.568 Test Loss: 1.412 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0543882846832275
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.421 Vali Acc: 0.581 Test Loss: 1.421 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9648897647857666
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.429 Vali Acc: 0.581 Test Loss: 1.429 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0646421909332275
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.447 Vali Acc: 0.581 Test Loss: 1.447 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.2446699142456055
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.459 Vali Acc: 0.581 Test Loss: 1.459 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.074878215789795
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.463 Vali Acc: 0.581 Test Loss: 1.463 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4448151588439941
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.471 Vali Acc: 0.581 Test Loss: 1.471 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1599254608154297
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.486 Vali Acc: 0.581 Test Loss: 1.486 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2221579551696777
Epoch: 38, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.494 Vali Acc: 0.581 Test Loss: 1.494 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs67_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 180924
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs58_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.458235263824463
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.342 Vali Acc: 0.365 Test Loss: 1.342 Test Acc: 0.365
Validation loss decreased (inf --> -0.364851).  Saving model ...
Epoch: 2 cost time: 0.9022579193115234
Epoch: 2, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.313 Vali Acc: 0.432 Test Loss: 1.313 Test Acc: 0.432
Validation loss decreased (-0.364851 --> -0.432419).  Saving model ...
Epoch: 3 cost time: 0.7026252746582031
Epoch: 3, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.259 Vali Acc: 0.473 Test Loss: 1.259 Test Acc: 0.473
Validation loss decreased (-0.432419 --> -0.472960).  Saving model ...
Epoch: 4 cost time: 0.8316693305969238
Epoch: 4, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.166 Vali Acc: 0.514 Test Loss: 1.166 Test Acc: 0.514
Validation loss decreased (-0.472960 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.011056900024414
Epoch: 5, Steps: 10 | Train Loss: 0.835 Vali Loss: 1.136 Vali Acc: 0.514 Test Loss: 1.136 Test Acc: 0.514
Validation loss decreased (-0.513502 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 1.0505409240722656
Epoch: 6, Steps: 10 | Train Loss: 0.694 Vali Loss: 1.128 Vali Acc: 0.527 Test Loss: 1.128 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 7 cost time: 0.9388594627380371
Epoch: 7, Steps: 10 | Train Loss: 0.566 Vali Loss: 1.081 Vali Acc: 0.500 Test Loss: 1.081 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1432771682739258
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
Validation loss decreased (-0.527016 --> -0.540529).  Saving model ...
Epoch: 9 cost time: 1.167572021484375
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.110 Vali Acc: 0.554 Test Loss: 1.110 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 10 cost time: 0.9476251602172852
Epoch: 10, Steps: 10 | Train Loss: 0.271 Vali Loss: 1.107 Vali Acc: 0.541 Test Loss: 1.107 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7827086448669434
Epoch: 11, Steps: 10 | Train Loss: 0.203 Vali Loss: 1.100 Vali Acc: 0.541 Test Loss: 1.100 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8907980918884277
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 1.144 Vali Acc: 0.554 Test Loss: 1.144 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7411468029022217
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.8941483497619629
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.175 Vali Acc: 0.568 Test Loss: 1.175 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1397967338562012
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.212 Vali Acc: 0.568 Test Loss: 1.212 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2338969707489014
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.254 Vali Acc: 0.568 Test Loss: 1.254 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0116806030273438
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.276 Vali Acc: 0.568 Test Loss: 1.276 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1393368244171143
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.282 Vali Acc: 0.568 Test Loss: 1.282 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9790844917297363
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.312 Vali Acc: 0.568 Test Loss: 1.312 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7467265129089355
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.326 Vali Acc: 0.568 Test Loss: 1.326 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9244906902313232
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.348 Vali Acc: 0.568 Test Loss: 1.348 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9385986328125
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.367 Vali Acc: 0.568 Test Loss: 1.367 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.990241527557373
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.390 Vali Acc: 0.568 Test Loss: 1.390 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs58_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5675675675675675
model parameter : 182410
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.929569721221924
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.361 Vali Acc: 0.311 Test Loss: 1.361 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 0.8160884380340576
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.278 Vali Acc: 0.432 Test Loss: 1.278 Test Acc: 0.432
Validation loss decreased (-0.310797 --> -0.432420).  Saving model ...
Epoch: 3 cost time: 0.91141676902771
Epoch: 3, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.193 Vali Acc: 0.459 Test Loss: 1.193 Test Acc: 0.459
Validation loss decreased (-0.432420 --> -0.459448).  Saving model ...
Epoch: 4 cost time: 0.8132305145263672
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.113 Vali Acc: 0.514 Test Loss: 1.113 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 5 cost time: 1.0343599319458008
Epoch: 5, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
Validation loss decreased (-0.513502 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.8805058002471924
Epoch: 6, Steps: 10 | Train Loss: 0.698 Vali Loss: 1.046 Vali Acc: 0.527 Test Loss: 1.046 Test Acc: 0.527
Validation loss decreased (-0.527016 --> -0.527017).  Saving model ...
Epoch: 7 cost time: 0.8978431224822998
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 1.011 Vali Acc: 0.595 Test Loss: 1.011 Test Acc: 0.595
Validation loss decreased (-0.527017 --> -0.594584).  Saving model ...
Epoch: 8 cost time: 0.9663922786712646
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 1.012 Vali Acc: 0.581 Test Loss: 1.012 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8994615077972412
Epoch: 9, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.980 Vali Acc: 0.635 Test Loss: 0.980 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 10 cost time: 1.0491647720336914
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.000 Vali Acc: 0.568 Test Loss: 1.000 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.016350269317627
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.984 Vali Acc: 0.595 Test Loss: 0.984 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8355083465576172
Epoch: 12, Steps: 10 | Train Loss: 0.153 Vali Loss: 1.021 Vali Acc: 0.608 Test Loss: 1.021 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0731825828552246
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.049 Vali Acc: 0.581 Test Loss: 1.049 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.833620548248291
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.048 Vali Acc: 0.595 Test Loss: 1.048 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.940737247467041
Epoch: 15, Steps: 10 | Train Loss: 0.068 Vali Loss: 1.070 Vali Acc: 0.595 Test Loss: 1.070 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3088490962982178
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.092 Vali Acc: 0.608 Test Loss: 1.092 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.084717035293579
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.121 Vali Acc: 0.608 Test Loss: 1.121 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0071463584899902
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.140 Vali Acc: 0.635 Test Loss: 1.140 Test Acc: 0.635
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8300366401672363
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.160 Vali Acc: 0.608 Test Loss: 1.160 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 179916
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs45_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.094386339187622
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.333 Vali Acc: 0.338 Test Loss: 1.333 Test Acc: 0.338
Validation loss decreased (inf --> -0.337825).  Saving model ...
Epoch: 2 cost time: 0.8657889366149902
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.289 Vali Acc: 0.459 Test Loss: 1.289 Test Acc: 0.459
Validation loss decreased (-0.337825 --> -0.459447).  Saving model ...
Epoch: 3 cost time: 1.1269431114196777
Epoch: 3, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.229 Vali Acc: 0.473 Test Loss: 1.229 Test Acc: 0.473
Validation loss decreased (-0.459447 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 1.1149990558624268
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 1.159 Vali Acc: 0.500 Test Loss: 1.159 Test Acc: 0.500
Validation loss decreased (-0.472961 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.814002513885498
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.115 Vali Acc: 0.527 Test Loss: 1.115 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.9607629776000977
Epoch: 6, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.084 Vali Acc: 0.608 Test Loss: 1.084 Test Acc: 0.608
Validation loss decreased (-0.527016 --> -0.608097).  Saving model ...
Epoch: 7 cost time: 0.7907857894897461
Epoch: 7, Steps: 10 | Train Loss: 0.590 Vali Loss: 1.093 Vali Acc: 0.608 Test Loss: 1.093 Test Acc: 0.608
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1476843357086182
Epoch: 8, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
Validation loss decreased (-0.608097 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 0.9492168426513672
Epoch: 9, Steps: 10 | Train Loss: 0.376 Vali Loss: 1.057 Vali Acc: 0.595 Test Loss: 1.057 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.006042242050171
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.061 Vali Acc: 0.622 Test Loss: 1.061 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0217914581298828
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
Validation loss decreased (-0.621611 --> -0.621611).  Saving model ...
Epoch: 12 cost time: 0.813673734664917
Epoch: 12, Steps: 10 | Train Loss: 0.161 Vali Loss: 1.083 Vali Acc: 0.622 Test Loss: 1.083 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8902444839477539
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.104 Vali Acc: 0.635 Test Loss: 1.104 Test Acc: 0.635
Validation loss decreased (-0.621611 --> -0.635124).  Saving model ...
Epoch: 14 cost time: 0.7355659008026123
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.140 Vali Acc: 0.622 Test Loss: 1.140 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8671441078186035
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.156 Vali Acc: 0.622 Test Loss: 1.156 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.880509614944458
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.185 Vali Acc: 0.622 Test Loss: 1.185 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8277440071105957
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.198 Vali Acc: 0.622 Test Loss: 1.198 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7971954345703125
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.217 Vali Acc: 0.622 Test Loss: 1.217 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7128646373748779
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.231 Vali Acc: 0.622 Test Loss: 1.231 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9085502624511719
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.270 Vali Acc: 0.635 Test Loss: 1.270 Test Acc: 0.635
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9214279651641846
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.289 Vali Acc: 0.635 Test Loss: 1.289 Test Acc: 0.635
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8385114669799805
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.302 Vali Acc: 0.622 Test Loss: 1.302 Test Acc: 0.622
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9775819778442383
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.314 Vali Acc: 0.608 Test Loss: 1.314 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs45_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 181874
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6279475688934326
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.487 Vali Acc: 0.203 Test Loss: 1.487 Test Acc: 0.203
Validation loss decreased (inf --> -0.202688).  Saving model ...
Epoch: 2 cost time: 1.0028786659240723
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
Validation loss decreased (-0.202688 --> -0.243229).  Saving model ...
Epoch: 3 cost time: 0.8898305892944336
Epoch: 3, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.283 Vali Acc: 0.351 Test Loss: 1.283 Test Acc: 0.351
Validation loss decreased (-0.243229 --> -0.351339).  Saving model ...
Epoch: 4 cost time: 0.8978970050811768
Epoch: 4, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.198 Vali Acc: 0.419 Test Loss: 1.198 Test Acc: 0.419
Validation loss decreased (-0.351339 --> -0.418907).  Saving model ...
Epoch: 5 cost time: 0.9614832401275635
Epoch: 5, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.159 Vali Acc: 0.473 Test Loss: 1.159 Test Acc: 0.473
Validation loss decreased (-0.418907 --> -0.472961).  Saving model ...
Epoch: 6 cost time: 0.907475471496582
Epoch: 6, Steps: 10 | Train Loss: 0.722 Vali Loss: 1.120 Vali Acc: 0.514 Test Loss: 1.120 Test Acc: 0.514
Validation loss decreased (-0.472961 --> -0.513502).  Saving model ...
Epoch: 7 cost time: 0.9229555130004883
Epoch: 7, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.087 Vali Acc: 0.554 Test Loss: 1.087 Test Acc: 0.554
Validation loss decreased (-0.513502 --> -0.554043).  Saving model ...
Epoch: 8 cost time: 0.7723217010498047
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 1.072 Vali Acc: 0.527 Test Loss: 1.072 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1324217319488525
Epoch: 9, Steps: 10 | Train Loss: 0.380 Vali Loss: 1.062 Vali Acc: 0.568 Test Loss: 1.062 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 1.0039215087890625
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 1.074 Vali Acc: 0.568 Test Loss: 1.074 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7998533248901367
Epoch: 11, Steps: 10 | Train Loss: 0.220 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9998159408569336
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.045497179031372
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.112 Vali Acc: 0.595 Test Loss: 1.112 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 1.1165359020233154
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 1.138 Vali Acc: 0.568 Test Loss: 1.138 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.163644790649414
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.181 Vali Acc: 0.581 Test Loss: 1.181 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9839262962341309
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.206 Vali Acc: 0.581 Test Loss: 1.206 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.771167516708374
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.216 Vali Acc: 0.581 Test Loss: 1.216 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7458219528198242
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.241 Vali Acc: 0.595 Test Loss: 1.241 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7314703464508057
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.257 Vali Acc: 0.595 Test Loss: 1.257 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7880725860595703
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.276 Vali Acc: 0.595 Test Loss: 1.276 Test Acc: 0.595
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.085446834564209
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.288 Vali Acc: 0.581 Test Loss: 1.288 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8927962779998779
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.315 Vali Acc: 0.581 Test Loss: 1.315 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.9916098117828369
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.341 Vali Acc: 0.595 Test Loss: 1.341 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 179836
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.4076435565948486
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.380 Vali Acc: 0.284 Test Loss: 1.380 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 1.1460487842559814
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.323 Vali Acc: 0.378 Test Loss: 1.323 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.9458489418029785
Epoch: 3, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.241 Vali Acc: 0.486 Test Loss: 1.241 Test Acc: 0.486
Validation loss decreased (-0.378365 --> -0.486474).  Saving model ...
Epoch: 4 cost time: 0.9651944637298584
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.163 Vali Acc: 0.541 Test Loss: 1.163 Test Acc: 0.541
Validation loss decreased (-0.486474 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.852989673614502
Epoch: 5, Steps: 10 | Train Loss: 0.829 Vali Loss: 1.090 Vali Acc: 0.608 Test Loss: 1.090 Test Acc: 0.608
Validation loss decreased (-0.540529 --> -0.608097).  Saving model ...
Epoch: 6 cost time: 1.049787998199463
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.077 Vali Acc: 0.554 Test Loss: 1.077 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.865471363067627
Epoch: 7, Steps: 10 | Train Loss: 0.568 Vali Loss: 1.059 Vali Acc: 0.608 Test Loss: 1.059 Test Acc: 0.608
Validation loss decreased (-0.608097 --> -0.608098).  Saving model ...
Epoch: 8 cost time: 0.9179267883300781
Epoch: 8, Steps: 10 | Train Loss: 0.458 Vali Loss: 1.034 Vali Acc: 0.608 Test Loss: 1.034 Test Acc: 0.608
Validation loss decreased (-0.608098 --> -0.608098).  Saving model ...
Epoch: 9 cost time: 0.9003036022186279
Epoch: 9, Steps: 10 | Train Loss: 0.362 Vali Loss: 1.039 Vali Acc: 0.541 Test Loss: 1.039 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1385314464569092
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.029 Vali Acc: 0.581 Test Loss: 1.029 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.032893180847168
Epoch: 11, Steps: 10 | Train Loss: 0.207 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0556271076202393
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.060 Vali Acc: 0.608 Test Loss: 1.060 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9742414951324463
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 1.100 Vali Acc: 0.608 Test Loss: 1.100 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7428014278411865
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.142 Vali Acc: 0.608 Test Loss: 1.142 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8805251121520996
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.152 Vali Acc: 0.608 Test Loss: 1.152 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8470516204833984
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.150 Vali Acc: 0.635 Test Loss: 1.150 Test Acc: 0.635
Validation loss decreased (-0.608098 --> -0.635124).  Saving model ...
Epoch: 17 cost time: 0.6904752254486084
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.204 Vali Acc: 0.581 Test Loss: 1.204 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8193247318267822
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.225 Vali Acc: 0.622 Test Loss: 1.225 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1333508491516113
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.234 Vali Acc: 0.608 Test Loss: 1.234 Test Acc: 0.608
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7553925514221191
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.250 Vali Acc: 0.608 Test Loss: 1.250 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8393878936767578
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.271 Vali Acc: 0.608 Test Loss: 1.271 Test Acc: 0.608
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9885251522064209
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.283 Vali Acc: 0.608 Test Loss: 1.283 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0339677333831787
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.305 Vali Acc: 0.608 Test Loss: 1.305 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.74143385887146
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.322 Vali Acc: 0.608 Test Loss: 1.322 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9247682094573975
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.336 Vali Acc: 0.608 Test Loss: 1.336 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8545281887054443
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.358 Vali Acc: 0.608 Test Loss: 1.358 Test Acc: 0.608
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 182634
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2821195125579834
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.388 Vali Acc: 0.311 Test Loss: 1.388 Test Acc: 0.311
Validation loss decreased (inf --> -0.310797).  Saving model ...
Epoch: 2 cost time: 1.0037312507629395
Epoch: 2, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.299 Vali Acc: 0.459 Test Loss: 1.299 Test Acc: 0.459
Validation loss decreased (-0.310797 --> -0.459446).  Saving model ...
Epoch: 3 cost time: 0.8054726123809814
Epoch: 3, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.228 Vali Acc: 0.459 Test Loss: 1.228 Test Acc: 0.459
Validation loss decreased (-0.459446 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.8362348079681396
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.170 Vali Acc: 0.500 Test Loss: 1.170 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.9637532234191895
Epoch: 5, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.113 Vali Acc: 0.527 Test Loss: 1.113 Test Acc: 0.527
Validation loss decreased (-0.499988 --> -0.527016).  Saving model ...
Epoch: 6 cost time: 0.9780025482177734
Epoch: 6, Steps: 10 | Train Loss: 0.692 Vali Loss: 1.072 Vali Acc: 0.595 Test Loss: 1.072 Test Acc: 0.595
Validation loss decreased (-0.527016 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.813678503036499
Epoch: 7, Steps: 10 | Train Loss: 0.571 Vali Loss: 1.044 Vali Acc: 0.581 Test Loss: 1.044 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7320585250854492
Epoch: 8, Steps: 10 | Train Loss: 0.467 Vali Loss: 1.051 Vali Acc: 0.541 Test Loss: 1.051 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7707986831665039
Epoch: 9, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.056 Vali Acc: 0.554 Test Loss: 1.056 Test Acc: 0.554
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7444348335266113
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.050 Vali Acc: 0.568 Test Loss: 1.050 Test Acc: 0.568
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0806317329406738
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 1.044 Vali Acc: 0.554 Test Loss: 1.044 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9167335033416748
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.056 Vali Acc: 0.514 Test Loss: 1.056 Test Acc: 0.514
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2799134254455566
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.091 Vali Acc: 0.514 Test Loss: 1.091 Test Acc: 0.514
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8860952854156494
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.110 Vali Acc: 0.568 Test Loss: 1.110 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0459465980529785
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.145 Vali Acc: 0.541 Test Loss: 1.145 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8082594871520996
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.161 Vali Acc: 0.568 Test Loss: 1.161 Test Acc: 0.568
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 183036
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5861282348632812
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.391 Vali Acc: 0.284 Test Loss: 1.391 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7608873844146729
Epoch: 2, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.318 Vali Acc: 0.378 Test Loss: 1.318 Test Acc: 0.378
Validation loss decreased (-0.283770 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.8957695960998535
Epoch: 3, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.257 Vali Acc: 0.459 Test Loss: 1.257 Test Acc: 0.459
Validation loss decreased (-0.378365 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.6984477043151855
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.183 Vali Acc: 0.486 Test Loss: 1.183 Test Acc: 0.486
Validation loss decreased (-0.459447 --> -0.486475).  Saving model ...
Epoch: 5 cost time: 0.8546323776245117
Epoch: 5, Steps: 10 | Train Loss: 0.848 Vali Loss: 1.117 Vali Acc: 0.500 Test Loss: 1.117 Test Acc: 0.500
Validation loss decreased (-0.486475 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 0.7987444400787354
Epoch: 6, Steps: 10 | Train Loss: 0.708 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
Validation loss decreased (-0.499989 --> -0.513503).  Saving model ...
Epoch: 7 cost time: 0.8325090408325195
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.087 Vali Acc: 0.541 Test Loss: 1.087 Test Acc: 0.541
Validation loss decreased (-0.513503 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.7037911415100098
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.054 Vali Acc: 0.554 Test Loss: 1.054 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 0.844182014465332
Epoch: 9, Steps: 10 | Train Loss: 0.367 Vali Loss: 1.070 Vali Acc: 0.554 Test Loss: 1.070 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9260103702545166
Epoch: 10, Steps: 10 | Train Loss: 0.285 Vali Loss: 1.065 Vali Acc: 0.554 Test Loss: 1.065 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8962347507476807
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.092 Vali Acc: 0.541 Test Loss: 1.092 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7149522304534912
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 1.113 Vali Acc: 0.568 Test Loss: 1.113 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567556).  Saving model ...
Epoch: 13 cost time: 0.869300127029419
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.119 Vali Acc: 0.595 Test Loss: 1.119 Test Acc: 0.595
Validation loss decreased (-0.567556 --> -0.594583).  Saving model ...
Epoch: 14 cost time: 0.7545239925384521
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 1.144 Vali Acc: 0.581 Test Loss: 1.144 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6498186588287354
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 1.157 Vali Acc: 0.608 Test Loss: 1.157 Test Acc: 0.608
Validation loss decreased (-0.594583 --> -0.608097).  Saving model ...
Epoch: 16 cost time: 0.648601770401001
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.182 Vali Acc: 0.595 Test Loss: 1.182 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8608465194702148
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.216 Vali Acc: 0.595 Test Loss: 1.216 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8869705200195312
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.232 Vali Acc: 0.595 Test Loss: 1.232 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7453916072845459
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.254 Vali Acc: 0.608 Test Loss: 1.254 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7872486114501953
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.270 Vali Acc: 0.595 Test Loss: 1.270 Test Acc: 0.595
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7820746898651123
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.295 Vali Acc: 0.581 Test Loss: 1.295 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8421492576599121
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.319 Vali Acc: 0.581 Test Loss: 1.319 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.774177074432373
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.325 Vali Acc: 0.581 Test Loss: 1.325 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8259341716766357
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7523109912872314
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.361 Vali Acc: 0.581 Test Loss: 1.361 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6081081081081081
model parameter : 181042
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.6293835639953613
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.425 Vali Acc: 0.176 Test Loss: 1.425 Test Acc: 0.176
Validation loss decreased (inf --> -0.175661).  Saving model ...
Epoch: 2 cost time: 0.8045423030853271
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.313 Vali Acc: 0.378 Test Loss: 1.313 Test Acc: 0.378
Validation loss decreased (-0.175661 --> -0.378365).  Saving model ...
Epoch: 3 cost time: 0.7600681781768799
Epoch: 3, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.235 Vali Acc: 0.446 Test Loss: 1.235 Test Acc: 0.446
Validation loss decreased (-0.378365 --> -0.445934).  Saving model ...
Epoch: 4 cost time: 0.7376053333282471
Epoch: 4, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.174 Vali Acc: 0.527 Test Loss: 1.174 Test Acc: 0.527
Validation loss decreased (-0.445934 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.8376188278198242
Epoch: 5, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.108 Vali Acc: 0.514 Test Loss: 1.108 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7651200294494629
Epoch: 6, Steps: 10 | Train Loss: 0.714 Vali Loss: 1.073 Vali Acc: 0.568 Test Loss: 1.073 Test Acc: 0.568
Validation loss decreased (-0.527015 --> -0.567557).  Saving model ...
Epoch: 7 cost time: 0.6990458965301514
Epoch: 7, Steps: 10 | Train Loss: 0.584 Vali Loss: 1.042 Vali Acc: 0.554 Test Loss: 1.042 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8094401359558105
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 1.045 Vali Acc: 0.554 Test Loss: 1.045 Test Acc: 0.554
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6846942901611328
Epoch: 9, Steps: 10 | Train Loss: 0.369 Vali Loss: 1.013 Vali Acc: 0.581 Test Loss: 1.013 Test Acc: 0.581
Validation loss decreased (-0.567557 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.8683264255523682
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 1.014 Vali Acc: 0.595 Test Loss: 1.014 Test Acc: 0.595
Validation loss decreased (-0.581071 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.9096763134002686
Epoch: 11, Steps: 10 | Train Loss: 0.215 Vali Loss: 1.024 Vali Acc: 0.581 Test Loss: 1.024 Test Acc: 0.581
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7444500923156738
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 1.022 Vali Acc: 0.581 Test Loss: 1.022 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8344626426696777
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.051 Vali Acc: 0.581 Test Loss: 1.051 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7132279872894287
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.104 Vali Acc: 0.554 Test Loss: 1.104 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9018385410308838
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.117 Vali Acc: 0.554 Test Loss: 1.117 Test Acc: 0.554
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8781747817993164
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.119 Vali Acc: 0.541 Test Loss: 1.119 Test Acc: 0.541
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.842700719833374
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.149 Vali Acc: 0.554 Test Loss: 1.149 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8192470073699951
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.178 Vali Acc: 0.581 Test Loss: 1.178 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7372844219207764
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.187 Vali Acc: 0.568 Test Loss: 1.187 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9316589832305908
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.202 Vali Acc: 0.554 Test Loss: 1.202 Test Acc: 0.554
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 182268
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs27_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.887941598892212
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.374 Vali Acc: 0.284 Test Loss: 1.374 Test Acc: 0.284
Validation loss decreased (inf --> -0.283770).  Saving model ...
Epoch: 2 cost time: 0.7380492687225342
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.298 Vali Acc: 0.419 Test Loss: 1.298 Test Acc: 0.419
Validation loss decreased (-0.283770 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8574485778808594
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.227 Vali Acc: 0.459 Test Loss: 1.227 Test Acc: 0.459
Validation loss decreased (-0.418906 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.7322359085083008
Epoch: 4, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.185 Vali Acc: 0.459 Test Loss: 1.185 Test Acc: 0.459
Validation loss decreased (-0.459447 --> -0.459448).  Saving model ...
Epoch: 5 cost time: 0.9942312240600586
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 1.121 Vali Acc: 0.514 Test Loss: 1.121 Test Acc: 0.514
Validation loss decreased (-0.459448 --> -0.513502).  Saving model ...
Epoch: 6 cost time: 0.7967696189880371
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.091 Vali Acc: 0.500 Test Loss: 1.091 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7988078594207764
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 1.073 Vali Acc: 0.541 Test Loss: 1.073 Test Acc: 0.541
Validation loss decreased (-0.513502 --> -0.540530).  Saving model ...
Epoch: 8 cost time: 0.733222484588623
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 1.040 Vali Acc: 0.554 Test Loss: 1.040 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554044).  Saving model ...
Epoch: 9 cost time: 0.6267199516296387
Epoch: 9, Steps: 10 | Train Loss: 0.388 Vali Loss: 1.058 Vali Acc: 0.568 Test Loss: 1.058 Test Acc: 0.568
Validation loss decreased (-0.554044 --> -0.567557).  Saving model ...
Epoch: 10 cost time: 0.8292462825775146
Epoch: 10, Steps: 10 | Train Loss: 0.299 Vali Loss: 1.039 Vali Acc: 0.595 Test Loss: 1.039 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 11 cost time: 0.8252966403961182
Epoch: 11, Steps: 10 | Train Loss: 0.224 Vali Loss: 1.059 Vali Acc: 0.541 Test Loss: 1.059 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0272712707519531
Epoch: 12, Steps: 10 | Train Loss: 0.167 Vali Loss: 1.075 Vali Acc: 0.541 Test Loss: 1.075 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8978977203369141
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 1.105 Vali Acc: 0.541 Test Loss: 1.105 Test Acc: 0.541
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0192193984985352
Epoch: 14, Steps: 10 | Train Loss: 0.093 Vali Loss: 1.106 Vali Acc: 0.554 Test Loss: 1.106 Test Acc: 0.554
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1134285926818848
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.135 Vali Acc: 0.581 Test Loss: 1.135 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.000840187072754
Epoch: 16, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.155 Vali Acc: 0.595 Test Loss: 1.155 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8808174133300781
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.201 Vali Acc: 0.554 Test Loss: 1.201 Test Acc: 0.554
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.103205919265747
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.213 Vali Acc: 0.581 Test Loss: 1.213 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1524884700775146
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.229 Vali Acc: 0.541 Test Loss: 1.229 Test Acc: 0.541
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8549308776855469
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.246 Vali Acc: 0.541 Test Loss: 1.246 Test Acc: 0.541
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs27_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.5945945945945946
model parameter : 181898
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs25_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 3.101004123687744
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (inf --> -0.297283).  Saving model ...
Epoch: 2 cost time: 0.9850671291351318
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.331 Vali Acc: 0.351 Test Loss: 1.331 Test Acc: 0.351
Validation loss decreased (-0.297283 --> -0.351338).  Saving model ...
Epoch: 3 cost time: 0.9327795505523682
Epoch: 3, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.258 Vali Acc: 0.432 Test Loss: 1.258 Test Acc: 0.432
Validation loss decreased (-0.351338 --> -0.432420).  Saving model ...
Epoch: 4 cost time: 0.866107702255249
Epoch: 4, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.196 Vali Acc: 0.541 Test Loss: 1.196 Test Acc: 0.541
Validation loss decreased (-0.432420 --> -0.540529).  Saving model ...
Epoch: 5 cost time: 0.7762434482574463
Epoch: 5, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.146 Vali Acc: 0.554 Test Loss: 1.146 Test Acc: 0.554
Validation loss decreased (-0.540529 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.9061615467071533
Epoch: 6, Steps: 10 | Train Loss: 0.716 Vali Loss: 1.120 Vali Acc: 0.554 Test Loss: 1.120 Test Acc: 0.554
Validation loss decreased (-0.554043 --> -0.554043).  Saving model ...
Epoch: 7 cost time: 0.995265007019043
Epoch: 7, Steps: 10 | Train Loss: 0.588 Vali Loss: 1.081 Vali Acc: 0.581 Test Loss: 1.081 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581070).  Saving model ...
Epoch: 8 cost time: 0.7635831832885742
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 1.081 Vali Acc: 0.622 Test Loss: 1.081 Test Acc: 0.622
Validation loss decreased (-0.581070 --> -0.621611).  Saving model ...
Epoch: 9 cost time: 0.77652907371521
Epoch: 9, Steps: 10 | Train Loss: 0.370 Vali Loss: 1.068 Vali Acc: 0.595 Test Loss: 1.068 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9711935520172119
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.087 Vali Acc: 0.622 Test Loss: 1.087 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1223928928375244
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 1.108 Vali Acc: 0.581 Test Loss: 1.108 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.861957311630249
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 1.106 Vali Acc: 0.622 Test Loss: 1.106 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8595268726348877
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.132 Vali Acc: 0.622 Test Loss: 1.132 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.795330286026001
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.156 Vali Acc: 0.622 Test Loss: 1.156 Test Acc: 0.622
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7720263004302979
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.190 Vali Acc: 0.608 Test Loss: 1.190 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7385952472686768
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.219 Vali Acc: 0.622 Test Loss: 1.219 Test Acc: 0.622
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8165426254272461
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.241 Vali Acc: 0.608 Test Loss: 1.241 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6857423782348633
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.247 Vali Acc: 0.622 Test Loss: 1.247 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs25_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6216216216216216
model parameter : 179932
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.5466535091400146
Epoch: 1, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.360 Vali Acc: 0.257 Test Loss: 1.360 Test Acc: 0.257
Validation loss decreased (inf --> -0.256743).  Saving model ...
Epoch: 2 cost time: 0.6577327251434326
Epoch: 2, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.280 Vali Acc: 0.419 Test Loss: 1.280 Test Acc: 0.419
Validation loss decreased (-0.256743 --> -0.418906).  Saving model ...
Epoch: 3 cost time: 0.8154470920562744
Epoch: 3, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.189 Vali Acc: 0.554 Test Loss: 1.189 Test Acc: 0.554
Validation loss decreased (-0.418906 --> -0.554042).  Saving model ...
Epoch: 4 cost time: 0.8426644802093506
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.118 Vali Acc: 0.581 Test Loss: 1.118 Test Acc: 0.581
Validation loss decreased (-0.554042 --> -0.581070).  Saving model ...
Epoch: 5 cost time: 0.7974112033843994
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.095 Vali Acc: 0.486 Test Loss: 1.095 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1139891147613525
Epoch: 6, Steps: 10 | Train Loss: 0.691 Vali Loss: 1.043 Vali Acc: 0.595 Test Loss: 1.043 Test Acc: 0.595
Validation loss decreased (-0.581070 --> -0.594584).  Saving model ...
Epoch: 7 cost time: 0.9906635284423828
Epoch: 7, Steps: 10 | Train Loss: 0.564 Vali Loss: 1.014 Vali Acc: 0.554 Test Loss: 1.014 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1255595684051514
Epoch: 8, Steps: 10 | Train Loss: 0.457 Vali Loss: 1.008 Vali Acc: 0.568 Test Loss: 1.008 Test Acc: 0.568
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.853419303894043
Epoch: 9, Steps: 10 | Train Loss: 0.371 Vali Loss: 1.013 Vali Acc: 0.581 Test Loss: 1.013 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7819440364837646
Epoch: 10, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.976 Vali Acc: 0.581 Test Loss: 0.976 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7456698417663574
Epoch: 11, Steps: 10 | Train Loss: 0.214 Vali Loss: 1.018 Vali Acc: 0.568 Test Loss: 1.018 Test Acc: 0.568
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7479126453399658
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 1.021 Vali Acc: 0.568 Test Loss: 1.021 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9060120582580566
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 1.017 Vali Acc: 0.595 Test Loss: 1.017 Test Acc: 0.595
Validation loss decreased (-0.594584 --> -0.594584).  Saving model ...
Epoch: 14 cost time: 1.1007778644561768
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.055 Vali Acc: 0.635 Test Loss: 1.055 Test Acc: 0.635
Validation loss decreased (-0.594584 --> -0.635125).  Saving model ...
Epoch: 15 cost time: 0.7131962776184082
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.076 Vali Acc: 0.595 Test Loss: 1.076 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8861150741577148
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.100 Vali Acc: 0.595 Test Loss: 1.100 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9257688522338867
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.117 Vali Acc: 0.622 Test Loss: 1.117 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8053536415100098
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.138 Vali Acc: 0.595 Test Loss: 1.138 Test Acc: 0.595
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7439823150634766
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.153 Vali Acc: 0.581 Test Loss: 1.153 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8109951019287109
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.168 Vali Acc: 0.581 Test Loss: 1.168 Test Acc: 0.581
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9023439884185791
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.189 Vali Acc: 0.608 Test Loss: 1.189 Test Acc: 0.608
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7277882099151611
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.204 Vali Acc: 0.608 Test Loss: 1.204 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0211708545684814
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.225 Vali Acc: 0.595 Test Loss: 1.225 Test Acc: 0.595
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9770216941833496
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.238 Vali Acc: 0.595 Test Loss: 1.238 Test Acc: 0.595
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 183186
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.2278690338134766
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.369 Vali Acc: 0.338 Test Loss: 1.369 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8527982234954834
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.300 Vali Acc: 0.392 Test Loss: 1.300 Test Acc: 0.392
Validation loss decreased (-0.337824 --> -0.391879).  Saving model ...
Epoch: 3 cost time: 0.9637370109558105
Epoch: 3, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.223 Vali Acc: 0.473 Test Loss: 1.223 Test Acc: 0.473
Validation loss decreased (-0.391879 --> -0.472961).  Saving model ...
Epoch: 4 cost time: 0.9992246627807617
Epoch: 4, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.164 Vali Acc: 0.527 Test Loss: 1.164 Test Acc: 0.527
Validation loss decreased (-0.472961 --> -0.527015).  Saving model ...
Epoch: 5 cost time: 0.70766282081604
Epoch: 5, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.103 Vali Acc: 0.541 Test Loss: 1.103 Test Acc: 0.541
Validation loss decreased (-0.527015 --> -0.540530).  Saving model ...
Epoch: 6 cost time: 0.6549065113067627
Epoch: 6, Steps: 10 | Train Loss: 0.690 Vali Loss: 1.083 Vali Acc: 0.541 Test Loss: 1.083 Test Acc: 0.541
Validation loss decreased (-0.540530 --> -0.540530).  Saving model ...
Epoch: 7 cost time: 0.7171194553375244
Epoch: 7, Steps: 10 | Train Loss: 0.570 Vali Loss: 1.093 Vali Acc: 0.514 Test Loss: 1.093 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.883277416229248
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 1.042 Vali Acc: 0.527 Test Loss: 1.042 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8281655311584473
Epoch: 9, Steps: 10 | Train Loss: 0.357 Vali Loss: 1.040 Vali Acc: 0.527 Test Loss: 1.040 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8763678073883057
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 1.028 Vali Acc: 0.527 Test Loss: 1.028 Test Acc: 0.527
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8547942638397217
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 1.084 Vali Acc: 0.554 Test Loss: 1.084 Test Acc: 0.554
Validation loss decreased (-0.540530 --> -0.554043).  Saving model ...
Epoch: 12 cost time: 0.7956364154815674
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 1.102 Vali Acc: 0.554 Test Loss: 1.102 Test Acc: 0.554
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7924563884735107
Epoch: 13, Steps: 10 | Train Loss: 0.119 Vali Loss: 1.118 Vali Acc: 0.568 Test Loss: 1.118 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567556).  Saving model ...
Epoch: 14 cost time: 0.8953289985656738
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 1.138 Vali Acc: 0.581 Test Loss: 1.138 Test Acc: 0.581
Validation loss decreased (-0.567556 --> -0.581070).  Saving model ...
Epoch: 15 cost time: 1.2338354587554932
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.167 Vali Acc: 0.568 Test Loss: 1.167 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.04071044921875
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.184 Vali Acc: 0.581 Test Loss: 1.184 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9073994159698486
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.209 Vali Acc: 0.581 Test Loss: 1.209 Test Acc: 0.581
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8417694568634033
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.233 Vali Acc: 0.581 Test Loss: 1.233 Test Acc: 0.581
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.115835189819336
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.255 Vali Acc: 0.581 Test Loss: 1.255 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7653098106384277
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.267 Vali Acc: 0.568 Test Loss: 1.267 Test Acc: 0.568
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8490843772888184
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.293 Vali Acc: 0.568 Test Loss: 1.293 Test Acc: 0.568
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0154659748077393
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.312 Vali Acc: 0.581 Test Loss: 1.312 Test Acc: 0.581
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0258560180664062
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.326 Vali Acc: 0.568 Test Loss: 1.326 Test Acc: 0.568
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.845073938369751
Epoch: 24, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.350 Vali Acc: 0.581 Test Loss: 1.350 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.581081081081081
model parameter : 185644
model size : 0.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.062790870666504
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.437 Vali Acc: 0.311 Test Loss: 1.437 Test Acc: 0.311
Validation loss decreased (inf --> -0.310796).  Saving model ...
Epoch: 2 cost time: 0.7334277629852295
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.348 Vali Acc: 0.405 Test Loss: 1.348 Test Acc: 0.405
Validation loss decreased (-0.310796 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 0.8085904121398926
Epoch: 3, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.270 Vali Acc: 0.500 Test Loss: 1.270 Test Acc: 0.500
Validation loss decreased (-0.405392 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.655315637588501
Epoch: 4, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.241 Vali Acc: 0.514 Test Loss: 1.241 Test Acc: 0.514
Validation loss decreased (-0.499987 --> -0.513501).  Saving model ...
Epoch: 5 cost time: 1.0977084636688232
Epoch: 5, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.133 Vali Acc: 0.554 Test Loss: 1.133 Test Acc: 0.554
Validation loss decreased (-0.513501 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.8467581272125244
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 1.108 Vali Acc: 0.527 Test Loss: 1.108 Test Acc: 0.527
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.94956374168396
Epoch: 7, Steps: 10 | Train Loss: 0.619 Vali Loss: 1.066 Vali Acc: 0.568 Test Loss: 1.066 Test Acc: 0.568
Validation loss decreased (-0.554043 --> -0.567557).  Saving model ...
Epoch: 8 cost time: 0.7385373115539551
Epoch: 8, Steps: 10 | Train Loss: 0.506 Vali Loss: 1.078 Vali Acc: 0.595 Test Loss: 1.078 Test Acc: 0.595
Validation loss decreased (-0.567557 --> -0.594584).  Saving model ...
Epoch: 9 cost time: 0.8942172527313232
Epoch: 9, Steps: 10 | Train Loss: 0.403 Vali Loss: 1.055 Vali Acc: 0.541 Test Loss: 1.055 Test Acc: 0.541
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0124385356903076
Epoch: 10, Steps: 10 | Train Loss: 0.312 Vali Loss: 1.061 Vali Acc: 0.608 Test Loss: 1.061 Test Acc: 0.608
Validation loss decreased (-0.594584 --> -0.608097).  Saving model ...
Epoch: 11 cost time: 0.5811829566955566
Epoch: 11, Steps: 10 | Train Loss: 0.237 Vali Loss: 1.046 Vali Acc: 0.635 Test Loss: 1.046 Test Acc: 0.635
Validation loss decreased (-0.608097 --> -0.635125).  Saving model ...
Epoch: 12 cost time: 0.829242467880249
Epoch: 12, Steps: 10 | Train Loss: 0.174 Vali Loss: 1.075 Vali Acc: 0.622 Test Loss: 1.075 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9086158275604248
Epoch: 13, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.078 Vali Acc: 0.581 Test Loss: 1.078 Test Acc: 0.581
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8007528781890869
Epoch: 14, Steps: 10 | Train Loss: 0.095 Vali Loss: 1.122 Vali Acc: 0.622 Test Loss: 1.122 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8287785053253174
Epoch: 15, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.133 Vali Acc: 0.622 Test Loss: 1.133 Test Acc: 0.622
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9222261905670166
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.153 Vali Acc: 0.622 Test Loss: 1.153 Test Acc: 0.622
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6927375793457031
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.172 Vali Acc: 0.608 Test Loss: 1.172 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.655005931854248
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7871823310852051
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.231 Vali Acc: 0.608 Test Loss: 1.231 Test Acc: 0.608
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0042531490325928
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.252 Vali Acc: 0.608 Test Loss: 1.252 Test Acc: 0.608
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7458846569061279
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.256 Vali Acc: 0.622 Test Loss: 1.256 Test Acc: 0.622
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 187306
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_HandMovementDirectionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/HandMovementDirection
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             10                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

160
74
>>>>>>>start training : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs20_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
160
74
74
Epoch: 1 cost time: 2.77017879486084
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.404 Vali Acc: 0.338 Test Loss: 1.404 Test Acc: 0.338
Validation loss decreased (inf --> -0.337824).  Saving model ...
Epoch: 2 cost time: 0.8434410095214844
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.321 Vali Acc: 0.405 Test Loss: 1.321 Test Acc: 0.405
Validation loss decreased (-0.337824 --> -0.405392).  Saving model ...
Epoch: 3 cost time: 1.1278467178344727
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.234 Vali Acc: 0.459 Test Loss: 1.234 Test Acc: 0.459
Validation loss decreased (-0.405392 --> -0.459447).  Saving model ...
Epoch: 4 cost time: 0.7710554599761963
Epoch: 4, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.171 Vali Acc: 0.500 Test Loss: 1.171 Test Acc: 0.500
Validation loss decreased (-0.459447 --> -0.499988).  Saving model ...
Epoch: 5 cost time: 0.8837332725524902
Epoch: 5, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.105 Vali Acc: 0.554 Test Loss: 1.105 Test Acc: 0.554
Validation loss decreased (-0.499988 --> -0.554043).  Saving model ...
Epoch: 6 cost time: 0.9425973892211914
Epoch: 6, Steps: 10 | Train Loss: 0.713 Vali Loss: 1.078 Vali Acc: 0.514 Test Loss: 1.078 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8344974517822266
Epoch: 7, Steps: 10 | Train Loss: 0.591 Vali Loss: 1.052 Vali Acc: 0.527 Test Loss: 1.052 Test Acc: 0.527
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.04203462600708
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 1.035 Vali Acc: 0.527 Test Loss: 1.035 Test Acc: 0.527
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9342753887176514
Epoch: 9, Steps: 10 | Train Loss: 0.377 Vali Loss: 1.028 Vali Acc: 0.581 Test Loss: 1.028 Test Acc: 0.581
Validation loss decreased (-0.554043 --> -0.581071).  Saving model ...
Epoch: 10 cost time: 0.8872573375701904
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 1.054 Vali Acc: 0.568 Test Loss: 1.054 Test Acc: 0.568
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8377790451049805
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 1.065 Vali Acc: 0.541 Test Loss: 1.065 Test Acc: 0.541
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0964739322662354
Epoch: 12, Steps: 10 | Train Loss: 0.154 Vali Loss: 1.090 Vali Acc: 0.568 Test Loss: 1.090 Test Acc: 0.568
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8844947814941406
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 1.088 Vali Acc: 0.635 Test Loss: 1.088 Test Acc: 0.635
Validation loss decreased (-0.581071 --> -0.635124).  Saving model ...
Epoch: 14 cost time: 0.9608464241027832
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 1.114 Vali Acc: 0.622 Test Loss: 1.114 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9204258918762207
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.155 Vali Acc: 0.595 Test Loss: 1.155 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9902846813201904
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 1.192 Vali Acc: 0.595 Test Loss: 1.192 Test Acc: 0.595
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9159801006317139
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.209 Vali Acc: 0.608 Test Loss: 1.209 Test Acc: 0.608
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8286521434783936
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.222 Vali Acc: 0.581 Test Loss: 1.222 Test Acc: 0.581
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2560536861419678
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.235 Vali Acc: 0.608 Test Loss: 1.235 Test Acc: 0.608
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9092178344726562
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.259 Vali Acc: 0.581 Test Loss: 1.259 Test Acc: 0.581
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9988505840301514
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.286 Vali Acc: 0.568 Test Loss: 1.286 Test Acc: 0.568
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7517266273498535
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.294 Vali Acc: 0.581 Test Loss: 1.294 Test Acc: 0.581
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6942057609558105
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.315 Vali Acc: 0.581 Test Loss: 1.315 Test Acc: 0.581
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_HandMovementDirection_LightTS_UEA_ftM_sl400_ll0_pl0_dm32_cs20_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
74
test shape: torch.Size([74, 4]) torch.Size([74, 1])
accuracy:0.6351351351351351
model parameter : 180156
model size : 0.70MB
