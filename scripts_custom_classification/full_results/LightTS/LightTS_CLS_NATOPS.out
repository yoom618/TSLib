Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8631596565246582
Epoch: 1, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.762 Vali Acc: 0.250 Test Loss: 1.762 Test Acc: 0.250
Validation loss decreased (inf --> -0.249982).  Saving model ...
Epoch: 2 cost time: 0.6339972019195557
Epoch: 2, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.561 Vali Acc: 0.522 Test Loss: 1.561 Test Acc: 0.522
Validation loss decreased (-0.249982 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 0.6369483470916748
Epoch: 3, Steps: 12 | Train Loss: 1.423 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.522207 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.6739897727966309
Epoch: 4, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.057 Vali Acc: 0.706 Test Loss: 1.057 Test Acc: 0.706
Validation loss decreased (-0.666653 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 0.6767988204956055
Epoch: 5, Steps: 12 | Train Loss: 0.885 Vali Loss: 0.791 Vali Acc: 0.728 Test Loss: 0.791 Test Acc: 0.728
Validation loss decreased (-0.705545 --> -0.727770).  Saving model ...
Epoch: 6 cost time: 0.7383954524993896
Epoch: 6, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.570 Vali Acc: 0.772 Test Loss: 0.570 Test Acc: 0.772
Validation loss decreased (-0.727770 --> -0.772217).  Saving model ...
Epoch: 7 cost time: 0.7610378265380859
Epoch: 7, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.418 Vali Acc: 0.844 Test Loss: 0.418 Test Acc: 0.844
Validation loss decreased (-0.772217 --> -0.844440).  Saving model ...
Epoch: 8 cost time: 0.6747446060180664
Epoch: 8, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.345 Vali Acc: 0.833 Test Loss: 0.345 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6919450759887695
Epoch: 9, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861108).  Saving model ...
Epoch: 10 cost time: 0.620093822479248
Epoch: 10, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
Validation loss decreased (-0.861108 --> -0.911109).  Saving model ...
Epoch: 11 cost time: 0.6235568523406982
Epoch: 11, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.208 Vali Acc: 0.906 Test Loss: 0.208 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.744891881942749
Epoch: 12, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
Validation loss decreased (-0.911109 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.7882096767425537
Epoch: 13, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6459360122680664
Epoch: 14, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.189 Vali Acc: 0.911 Test Loss: 0.189 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7944459915161133
Epoch: 15, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.961 Test Loss: 0.172 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7210912704467773
Epoch: 16, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.612147331237793
Epoch: 17, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6396703720092773
Epoch: 18, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6387271881103516
Epoch: 19, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6709914207458496
Epoch: 20, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6714766025543213
Epoch: 21, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6486549377441406
Epoch: 22, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 119842
model size : 0.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2473044395446777
Epoch: 1, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.6851813793182373
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.499 Vali Acc: 0.461 Test Loss: 1.499 Test Acc: 0.461
Validation loss decreased (-0.299984 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.686962366104126
Epoch: 3, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.327 Vali Acc: 0.600 Test Loss: 1.327 Test Acc: 0.600
Validation loss decreased (-0.461096 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.7220044136047363
Epoch: 4, Steps: 12 | Train Loss: 1.230 Vali Loss: 1.145 Vali Acc: 0.678 Test Loss: 1.145 Test Acc: 0.678
Validation loss decreased (-0.599987 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.6750516891479492
Epoch: 5, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.964 Vali Acc: 0.739 Test Loss: 0.964 Test Acc: 0.739
Validation loss decreased (-0.677766 --> -0.738879).  Saving model ...
Epoch: 6 cost time: 0.7954840660095215
Epoch: 6, Steps: 12 | Train Loss: 0.871 Vali Loss: 0.805 Vali Acc: 0.778 Test Loss: 0.805 Test Acc: 0.778
Validation loss decreased (-0.738879 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.7588129043579102
Epoch: 7, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.669 Vali Acc: 0.772 Test Loss: 0.669 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.781463623046875
Epoch: 8, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.548 Vali Acc: 0.817 Test Loss: 0.548 Test Acc: 0.817
Validation loss decreased (-0.777770 --> -0.816661).  Saving model ...
Epoch: 9 cost time: 0.9003276824951172
Epoch: 9, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.816661 --> -0.833329).  Saving model ...
Epoch: 10 cost time: 0.7265846729278564
Epoch: 10, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.406 Vali Acc: 0.850 Test Loss: 0.406 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 11 cost time: 0.579603910446167
Epoch: 11, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.360 Vali Acc: 0.856 Test Loss: 0.360 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 0.6117279529571533
Epoch: 12, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.353 Vali Acc: 0.850 Test Loss: 0.353 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7504394054412842
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
Validation loss decreased (-0.855552 --> -0.883330).  Saving model ...
Epoch: 14 cost time: 0.6546413898468018
Epoch: 14, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.282 Vali Acc: 0.894 Test Loss: 0.282 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 0.6425111293792725
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.253 Vali Acc: 0.894 Test Loss: 0.253 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 16 cost time: 0.5909719467163086
Epoch: 16, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.241 Vali Acc: 0.906 Test Loss: 0.241 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 17 cost time: 0.7114527225494385
Epoch: 17, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.275 Vali Acc: 0.878 Test Loss: 0.275 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7798326015472412
Epoch: 18, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 19 cost time: 0.6633267402648926
Epoch: 19, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.58740234375
Epoch: 20, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6889941692352295
Epoch: 21, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.927776 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.5791459083557129
Epoch: 22, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5986981391906738
Epoch: 23, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.928 Test Loss: 0.221 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6040589809417725
Epoch: 24, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5834462642669678
Epoch: 25, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.726207971572876
Epoch: 26, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.928 Test Loss: 0.268 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6071453094482422
Epoch: 27, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.939 Test Loss: 0.281 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6861999034881592
Epoch: 28, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.644000768661499
Epoch: 29, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7135262489318848
Epoch: 30, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.74367356300354
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 117501
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9370396137237549
Epoch: 1, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.630 Vali Acc: 0.283 Test Loss: 1.630 Test Acc: 0.283
Validation loss decreased (inf --> -0.283317).  Saving model ...
Epoch: 2 cost time: 0.7289812564849854
Epoch: 2, Steps: 12 | Train Loss: 1.535 Vali Loss: 1.451 Vali Acc: 0.500 Test Loss: 1.451 Test Acc: 0.500
Validation loss decreased (-0.283317 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.8009219169616699
Epoch: 3, Steps: 12 | Train Loss: 1.335 Vali Loss: 1.229 Vali Acc: 0.644 Test Loss: 1.229 Test Acc: 0.644
Validation loss decreased (-0.499985 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.7468984127044678
Epoch: 4, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.014 Vali Acc: 0.700 Test Loss: 1.014 Test Acc: 0.700
Validation loss decreased (-0.644432 --> -0.699990).  Saving model ...
Epoch: 5 cost time: 0.76788330078125
Epoch: 5, Steps: 12 | Train Loss: 0.883 Vali Loss: 0.818 Vali Acc: 0.706 Test Loss: 0.818 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 0.7167246341705322
Epoch: 6, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.665 Vali Acc: 0.717 Test Loss: 0.665 Test Acc: 0.717
Validation loss decreased (-0.705547 --> -0.716660).  Saving model ...
Epoch: 7 cost time: 0.7048423290252686
Epoch: 7, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.716660 --> -0.761106).  Saving model ...
Epoch: 8 cost time: 0.751011848449707
Epoch: 8, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.428 Vali Acc: 0.789 Test Loss: 0.428 Test Acc: 0.789
Validation loss decreased (-0.761106 --> -0.788885).  Saving model ...
Epoch: 9 cost time: 0.6223275661468506
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.333 Vali Acc: 0.850 Test Loss: 0.333 Test Acc: 0.850
Validation loss decreased (-0.788885 --> -0.849997).  Saving model ...
Epoch: 10 cost time: 0.8154072761535645
Epoch: 10, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.849997 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.6742711067199707
Epoch: 11, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.250 Vali Acc: 0.906 Test Loss: 0.250 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 12 cost time: 0.5978763103485107
Epoch: 12, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
Validation loss decreased (-0.905553 --> -0.938887).  Saving model ...
Epoch: 13 cost time: 0.8373539447784424
Epoch: 13, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6336400508880615
Epoch: 14, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7760252952575684
Epoch: 15, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6521713733673096
Epoch: 16, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6095514297485352
Epoch: 17, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.688971757888794
Epoch: 18, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7526333332061768
Epoch: 19, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7424194812774658
Epoch: 20, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.247 Vali Acc: 0.939 Test Loss: 0.247 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8193364143371582
Epoch: 21, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.309 Vali Acc: 0.928 Test Loss: 0.309 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6710481643676758
Epoch: 22, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 116546
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.403696060180664
Epoch: 1, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.784 Vali Acc: 0.239 Test Loss: 1.784 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 0.7713406085968018
Epoch: 2, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.568 Vali Acc: 0.517 Test Loss: 1.568 Test Acc: 0.517
Validation loss decreased (-0.238871 --> -0.516651).  Saving model ...
Epoch: 3 cost time: 0.8522112369537354
Epoch: 3, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.329 Vali Acc: 0.667 Test Loss: 1.329 Test Acc: 0.667
Validation loss decreased (-0.516651 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.7092444896697998
Epoch: 4, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.065 Vali Acc: 0.717 Test Loss: 1.065 Test Acc: 0.717
Validation loss decreased (-0.666653 --> -0.716656).  Saving model ...
Epoch: 5 cost time: 0.6662430763244629
Epoch: 5, Steps: 12 | Train Loss: 0.897 Vali Loss: 0.778 Vali Acc: 0.750 Test Loss: 0.778 Test Acc: 0.750
Validation loss decreased (-0.716656 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 0.7378230094909668
Epoch: 6, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.749992 --> -0.822217).  Saving model ...
Epoch: 7 cost time: 0.7897982597351074
Epoch: 7, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.390 Vali Acc: 0.856 Test Loss: 0.390 Test Acc: 0.856
Validation loss decreased (-0.822217 --> -0.855552).  Saving model ...
Epoch: 8 cost time: 0.7926526069641113
Epoch: 8, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 9 cost time: 0.77020263671875
Epoch: 9, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.272 Vali Acc: 0.906 Test Loss: 0.272 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 10 cost time: 0.804173469543457
Epoch: 10, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.905553 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.7427747249603271
Epoch: 11, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.8139588832855225
Epoch: 12, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.205 Vali Acc: 0.928 Test Loss: 0.205 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.694328784942627
Epoch: 13, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9936449527740479
Epoch: 14, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.7572309970855713
Epoch: 15, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.8079876899719238
Epoch: 16, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6808207035064697
Epoch: 17, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6579494476318359
Epoch: 18, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.199 Vali Acc: 0.928 Test Loss: 0.199 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7364509105682373
Epoch: 19, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8142106533050537
Epoch: 20, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8137350082397461
Epoch: 21, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.917 Test Loss: 0.285 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8586153984069824
Epoch: 22, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7173888683319092
Epoch: 23, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7073662281036377
Epoch: 24, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7201220989227295
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.387 Vali Acc: 0.906 Test Loss: 0.387 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 116209
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2179765701293945
Epoch: 1, Steps: 12 | Train Loss: 1.747 Vali Loss: 1.647 Vali Acc: 0.378 Test Loss: 1.647 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.6161849498748779
Epoch: 2, Steps: 12 | Train Loss: 1.591 Vali Loss: 1.464 Vali Acc: 0.528 Test Loss: 1.464 Test Acc: 0.528
Validation loss decreased (-0.377761 --> -0.527763).  Saving model ...
Epoch: 3 cost time: 0.6335461139678955
Epoch: 3, Steps: 12 | Train Loss: 1.334 Vali Loss: 1.246 Vali Acc: 0.644 Test Loss: 1.246 Test Acc: 0.644
Validation loss decreased (-0.527763 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.6668610572814941
Epoch: 4, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.012 Vali Acc: 0.667 Test Loss: 1.012 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.6933188438415527
Epoch: 5, Steps: 12 | Train Loss: 0.882 Vali Loss: 0.753 Vali Acc: 0.761 Test Loss: 0.753 Test Acc: 0.761
Validation loss decreased (-0.666657 --> -0.761104).  Saving model ...
Epoch: 6 cost time: 0.6608970165252686
Epoch: 6, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.533 Vali Acc: 0.822 Test Loss: 0.533 Test Acc: 0.822
Validation loss decreased (-0.761104 --> -0.822217).  Saving model ...
Epoch: 7 cost time: 0.6960375308990479
Epoch: 7, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.390 Vali Acc: 0.850 Test Loss: 0.390 Test Acc: 0.850
Validation loss decreased (-0.822217 --> -0.849996).  Saving model ...
Epoch: 8 cost time: 0.7049710750579834
Epoch: 8, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.292 Vali Acc: 0.906 Test Loss: 0.292 Test Acc: 0.906
Validation loss decreased (-0.849996 --> -0.905553).  Saving model ...
Epoch: 9 cost time: 0.6933205127716064
Epoch: 9, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 10 cost time: 0.8294453620910645
Epoch: 10, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.8187670707702637
Epoch: 11, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7522640228271484
Epoch: 12, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 13 cost time: 0.7432401180267334
Epoch: 13, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.186 Vali Acc: 0.939 Test Loss: 0.186 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7076115608215332
Epoch: 14, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.8732373714447021
Epoch: 15, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7305915355682373
Epoch: 16, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.849315881729126
Epoch: 17, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7970426082611084
Epoch: 18, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9812724590301514
Epoch: 19, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.345 Vali Acc: 0.917 Test Loss: 0.345 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8495240211486816
Epoch: 20, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7950689792633057
Epoch: 21, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8388166427612305
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9200105667114258
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.409 Vali Acc: 0.928 Test Loss: 0.409 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7348732948303223
Epoch: 24, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 115672
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.286958932876587
Epoch: 1, Steps: 12 | Train Loss: 1.742 Vali Loss: 1.676 Vali Acc: 0.294 Test Loss: 1.676 Test Acc: 0.294
Validation loss decreased (inf --> -0.294428).  Saving model ...
Epoch: 2 cost time: 0.5918822288513184
Epoch: 2, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.506 Vali Acc: 0.467 Test Loss: 1.506 Test Acc: 0.467
Validation loss decreased (-0.294428 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 0.8388707637786865
Epoch: 3, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.301 Vali Acc: 0.600 Test Loss: 1.301 Test Acc: 0.600
Validation loss decreased (-0.466652 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.7718043327331543
Epoch: 4, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.085 Vali Acc: 0.656 Test Loss: 1.085 Test Acc: 0.656
Validation loss decreased (-0.599987 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 0.7473008632659912
Epoch: 5, Steps: 12 | Train Loss: 0.954 Vali Loss: 0.859 Vali Acc: 0.717 Test Loss: 0.859 Test Acc: 0.717
Validation loss decreased (-0.655545 --> -0.716658).  Saving model ...
Epoch: 6 cost time: 0.8351781368255615
Epoch: 6, Steps: 12 | Train Loss: 0.688 Vali Loss: 0.671 Vali Acc: 0.678 Test Loss: 0.671 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.793726921081543
Epoch: 7, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.511 Vali Acc: 0.767 Test Loss: 0.511 Test Acc: 0.767
Validation loss decreased (-0.716658 --> -0.766662).  Saving model ...
Epoch: 8 cost time: 0.7406883239746094
Epoch: 8, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.435 Vali Acc: 0.767 Test Loss: 0.435 Test Acc: 0.767
Validation loss decreased (-0.766662 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 0.7808253765106201
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.388 Vali Acc: 0.783 Test Loss: 0.388 Test Acc: 0.783
Validation loss decreased (-0.766662 --> -0.783329).  Saving model ...
Epoch: 10 cost time: 0.7063801288604736
Epoch: 10, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.348 Vali Acc: 0.817 Test Loss: 0.348 Test Acc: 0.817
Validation loss decreased (-0.783329 --> -0.816663).  Saving model ...
Epoch: 11 cost time: 0.7420032024383545
Epoch: 11, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.816663 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 0.8086748123168945
Epoch: 12, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.304 Vali Acc: 0.872 Test Loss: 0.304 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8034243583679199
Epoch: 13, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 0.6184923648834229
Epoch: 14, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.229 Vali Acc: 0.917 Test Loss: 0.229 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.869659423828125
Epoch: 15, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933332).  Saving model ...
Epoch: 16 cost time: 1.0573298931121826
Epoch: 16, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.177 Vali Acc: 0.922 Test Loss: 0.177 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1821932792663574
Epoch: 17, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9212205410003662
Epoch: 18, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.933332 --> -0.949998).  Saving model ...
Epoch: 19 cost time: 0.8916499614715576
Epoch: 19, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9187147617340088
Epoch: 20, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8806056976318359
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8169832229614258
Epoch: 22, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.238 Vali Acc: 0.928 Test Loss: 0.238 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7174692153930664
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.8567519187927246
Epoch: 24, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8381555080413818
Epoch: 25, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6717724800109863
Epoch: 26, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7319145202636719
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.477 Vali Acc: 0.906 Test Loss: 0.477 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7731404304504395
Epoch: 28, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7516617774963379
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.939 Test Loss: 0.280 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6968240737915039
Epoch: 30, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.281 Vali Acc: 0.928 Test Loss: 0.281 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7194075584411621
Epoch: 31, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.289 Vali Acc: 0.928 Test Loss: 0.289 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.824927568435669
Epoch: 32, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7045886516571045
Epoch: 33, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 115548
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.268935203552246
Epoch: 1, Steps: 12 | Train Loss: 1.806 Vali Loss: 1.707 Vali Acc: 0.217 Test Loss: 1.707 Test Acc: 0.217
Validation loss decreased (inf --> -0.216650).  Saving model ...
Epoch: 2 cost time: 0.7512900829315186
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.504 Vali Acc: 0.500 Test Loss: 1.504 Test Acc: 0.500
Validation loss decreased (-0.216650 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.6204135417938232
Epoch: 3, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.264 Vali Acc: 0.644 Test Loss: 1.264 Test Acc: 0.644
Validation loss decreased (-0.499985 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.6334829330444336
Epoch: 4, Steps: 12 | Train Loss: 1.141 Vali Loss: 0.990 Vali Acc: 0.733 Test Loss: 0.990 Test Acc: 0.733
Validation loss decreased (-0.644432 --> -0.733323).  Saving model ...
Epoch: 5 cost time: 0.6627211570739746
Epoch: 5, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.709 Vali Acc: 0.778 Test Loss: 0.709 Test Acc: 0.778
Validation loss decreased (-0.733323 --> -0.777771).  Saving model ...
Epoch: 6 cost time: 0.6741342544555664
Epoch: 6, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.480 Vali Acc: 0.839 Test Loss: 0.480 Test Acc: 0.839
Validation loss decreased (-0.777771 --> -0.838884).  Saving model ...
Epoch: 7 cost time: 0.6906681060791016
Epoch: 7, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
Validation loss decreased (-0.838884 --> -0.883330).  Saving model ...
Epoch: 8 cost time: 0.8372693061828613
Epoch: 8, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.317 Vali Acc: 0.894 Test Loss: 0.317 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 9 cost time: 0.6403532028198242
Epoch: 9, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.313 Vali Acc: 0.856 Test Loss: 0.313 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6791362762451172
Epoch: 10, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.894441 --> -0.922220).  Saving model ...
Epoch: 11 cost time: 0.6720116138458252
Epoch: 11, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6534302234649658
Epoch: 12, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7493064403533936
Epoch: 13, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.267 Vali Acc: 0.911 Test Loss: 0.267 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7038619518280029
Epoch: 14, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.559166431427002
Epoch: 15, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6013433933258057
Epoch: 16, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7870926856994629
Epoch: 17, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.388 Vali Acc: 0.883 Test Loss: 0.388 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6685566902160645
Epoch: 18, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7545626163482666
Epoch: 19, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.299 Vali Acc: 0.928 Test Loss: 0.299 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8152790069580078
Epoch: 20, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.368 Vali Acc: 0.917 Test Loss: 0.368 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7369446754455566
Epoch: 21, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6552066802978516
Epoch: 22, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.362 Vali Acc: 0.928 Test Loss: 0.362 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7755172252655029
Epoch: 23, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.431 Vali Acc: 0.928 Test Loss: 0.431 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6321084499359131
Epoch: 24, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.426 Vali Acc: 0.917 Test Loss: 0.426 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 115326
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2005510330200195
Epoch: 1, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.712 Vali Acc: 0.239 Test Loss: 1.712 Test Acc: 0.239
Validation loss decreased (inf --> -0.238872).  Saving model ...
Epoch: 2 cost time: 0.9921925067901611
Epoch: 2, Steps: 12 | Train Loss: 1.612 Vali Loss: 1.503 Vali Acc: 0.539 Test Loss: 1.503 Test Acc: 0.539
Validation loss decreased (-0.238872 --> -0.538874).  Saving model ...
Epoch: 3 cost time: 0.7736563682556152
Epoch: 3, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.243 Vali Acc: 0.644 Test Loss: 1.243 Test Acc: 0.644
Validation loss decreased (-0.538874 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.7798295021057129
Epoch: 4, Steps: 12 | Train Loss: 1.089 Vali Loss: 0.969 Vali Acc: 0.689 Test Loss: 0.969 Test Acc: 0.689
Validation loss decreased (-0.644432 --> -0.688879).  Saving model ...
Epoch: 5 cost time: 0.7647578716278076
Epoch: 5, Steps: 12 | Train Loss: 0.824 Vali Loss: 0.724 Vali Acc: 0.728 Test Loss: 0.724 Test Acc: 0.728
Validation loss decreased (-0.688879 --> -0.727771).  Saving model ...
Epoch: 6 cost time: 0.7335200309753418
Epoch: 6, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.533 Vali Acc: 0.761 Test Loss: 0.533 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761106).  Saving model ...
Epoch: 7 cost time: 0.680901050567627
Epoch: 7, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799996).  Saving model ...
Epoch: 8 cost time: 0.6761841773986816
Epoch: 8, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.375 Vali Acc: 0.844 Test Loss: 0.375 Test Acc: 0.844
Validation loss decreased (-0.799996 --> -0.844441).  Saving model ...
Epoch: 9 cost time: 0.6726689338684082
Epoch: 9, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.341 Vali Acc: 0.872 Test Loss: 0.341 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 10 cost time: 0.7129001617431641
Epoch: 10, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.290 Vali Acc: 0.894 Test Loss: 0.290 Test Acc: 0.894
Validation loss decreased (-0.872219 --> -0.894442).  Saving model ...
Epoch: 11 cost time: 0.6755509376525879
Epoch: 11, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.339 Vali Acc: 0.844 Test Loss: 0.339 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.669593095779419
Epoch: 12, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.277 Vali Acc: 0.878 Test Loss: 0.277 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7446203231811523
Epoch: 13, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.366 Vali Acc: 0.811 Test Loss: 0.366 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7821054458618164
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.243 Vali Acc: 0.894 Test Loss: 0.243 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 15 cost time: 0.7309093475341797
Epoch: 15, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8543155193328857
Epoch: 16, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.261 Vali Acc: 0.917 Test Loss: 0.261 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.6646053791046143
Epoch: 17, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.7773265838623047
Epoch: 18, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.282 Vali Acc: 0.928 Test Loss: 0.282 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7395250797271729
Epoch: 19, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.256 Vali Acc: 0.917 Test Loss: 0.256 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.878575325012207
Epoch: 20, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7410521507263184
Epoch: 21, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8567955493927002
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.493 Vali Acc: 0.894 Test Loss: 0.493 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7976441383361816
Epoch: 23, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6865544319152832
Epoch: 24, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 25 cost time: 0.8057076930999756
Epoch: 25, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7535545825958252
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.7372035980224609
Epoch: 27, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.330 Vali Acc: 0.917 Test Loss: 0.330 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7260918617248535
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8408787250518799
Epoch: 29, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.407 Vali Acc: 0.939 Test Loss: 0.407 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6690826416015625
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.400 Vali Acc: 0.917 Test Loss: 0.400 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9346463680267334
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.442 Vali Acc: 0.939 Test Loss: 0.442 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7706646919250488
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.489 Vali Acc: 0.922 Test Loss: 0.489 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9030065536499023
Epoch: 33, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.413 Vali Acc: 0.944 Test Loss: 0.413 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9983022212982178
Epoch: 34, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.552 Vali Acc: 0.944 Test Loss: 0.552 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7902853488922119
Epoch: 35, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.552 Vali Acc: 0.917 Test Loss: 0.552 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8697991371154785
Epoch: 36, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.493 Vali Acc: 0.928 Test Loss: 0.493 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 115006
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2391481399536133
Epoch: 1, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.755 Vali Acc: 0.294 Test Loss: 1.755 Test Acc: 0.294
Validation loss decreased (inf --> -0.294427).  Saving model ...
Epoch: 2 cost time: 0.5718295574188232
Epoch: 2, Steps: 12 | Train Loss: 1.643 Vali Loss: 1.564 Vali Acc: 0.461 Test Loss: 1.564 Test Acc: 0.461
Validation loss decreased (-0.294427 --> -0.461095).  Saving model ...
Epoch: 3 cost time: 0.6126523017883301
Epoch: 3, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.336 Vali Acc: 0.578 Test Loss: 1.336 Test Acc: 0.578
Validation loss decreased (-0.461095 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.6527087688446045
Epoch: 4, Steps: 12 | Train Loss: 1.193 Vali Loss: 1.095 Vali Acc: 0.656 Test Loss: 1.095 Test Acc: 0.656
Validation loss decreased (-0.577764 --> -0.655545).  Saving model ...
Epoch: 5 cost time: 0.719789981842041
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.865 Vali Acc: 0.706 Test Loss: 0.865 Test Acc: 0.706
Validation loss decreased (-0.655545 --> -0.705547).  Saving model ...
Epoch: 6 cost time: 0.7070953845977783
Epoch: 6, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.6645858287811279
Epoch: 7, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.503 Vali Acc: 0.756 Test Loss: 0.503 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755551).  Saving model ...
Epoch: 8 cost time: 0.6592645645141602
Epoch: 8, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
Validation loss decreased (-0.755551 --> -0.833329).  Saving model ...
Epoch: 9 cost time: 0.615830659866333
Epoch: 9, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.367 Vali Acc: 0.850 Test Loss: 0.367 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 0.8148207664489746
Epoch: 10, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.358 Vali Acc: 0.839 Test Loss: 0.358 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7452297210693359
Epoch: 11, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.354 Vali Acc: 0.856 Test Loss: 0.354 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 0.7721097469329834
Epoch: 12, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.376 Vali Acc: 0.844 Test Loss: 0.376 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6402218341827393
Epoch: 13, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.333 Vali Acc: 0.889 Test Loss: 0.333 Test Acc: 0.889
Validation loss decreased (-0.855552 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6092185974121094
Epoch: 14, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7065460681915283
Epoch: 15, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.7077105045318604
Epoch: 16, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.7843582630157471
Epoch: 17, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.859992504119873
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.361 Vali Acc: 0.917 Test Loss: 0.361 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8424785137176514
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7674398422241211
Epoch: 20, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8058295249938965
Epoch: 21, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.410 Vali Acc: 0.928 Test Loss: 0.410 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927774).  Saving model ...
Epoch: 22 cost time: 0.9167091846466064
Epoch: 22, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
Validation loss decreased (-0.927774 --> -0.927774).  Saving model ...
Epoch: 23 cost time: 0.7647318840026855
Epoch: 23, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.415 Vali Acc: 0.894 Test Loss: 0.415 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.904289722442627
Epoch: 24, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.538 Vali Acc: 0.911 Test Loss: 0.538 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8178088665008545
Epoch: 25, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.371 Vali Acc: 0.906 Test Loss: 0.371 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7108659744262695
Epoch: 26, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8271732330322266
Epoch: 27, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8070476055145264
Epoch: 28, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.911 Test Loss: 0.516 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.756342887878418
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.394 Vali Acc: 0.906 Test Loss: 0.394 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9044308662414551
Epoch: 30, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.419 Vali Acc: 0.922 Test Loss: 0.419 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8385100364685059
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8722612857818604
Epoch: 32, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.376 Vali Acc: 0.917 Test Loss: 0.376 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 114889
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.002983331680298
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.7324094772338867
Epoch: 2, Steps: 12 | Train Loss: 1.699 Vali Loss: 1.605 Vali Acc: 0.389 Test Loss: 1.605 Test Acc: 0.389
Validation loss decreased (-0.166649 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.6000692844390869
Epoch: 3, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.375 Vali Acc: 0.644 Test Loss: 1.375 Test Acc: 0.644
Validation loss decreased (-0.388873 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 0.6999938488006592
Epoch: 4, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.134 Vali Acc: 0.678 Test Loss: 1.134 Test Acc: 0.678
Validation loss decreased (-0.644431 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.6927962303161621
Epoch: 5, Steps: 12 | Train Loss: 1.001 Vali Loss: 0.918 Vali Acc: 0.722 Test Loss: 0.918 Test Acc: 0.722
Validation loss decreased (-0.677766 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 0.7304666042327881
Epoch: 6, Steps: 12 | Train Loss: 0.774 Vali Loss: 0.710 Vali Acc: 0.756 Test Loss: 0.710 Test Acc: 0.756
Validation loss decreased (-0.722213 --> -0.755548).  Saving model ...
Epoch: 7 cost time: 0.5850574970245361
Epoch: 7, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.517 Vali Acc: 0.800 Test Loss: 0.517 Test Acc: 0.800
Validation loss decreased (-0.755548 --> -0.799995).  Saving model ...
Epoch: 8 cost time: 0.6005966663360596
Epoch: 8, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
Validation loss decreased (-0.799995 --> -0.883330).  Saving model ...
Epoch: 9 cost time: 0.7079522609710693
Epoch: 9, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.318 Vali Acc: 0.861 Test Loss: 0.318 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7987728118896484
Epoch: 10, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 0.8435900211334229
Epoch: 11, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.281 Vali Acc: 0.867 Test Loss: 0.281 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.78916335105896
Epoch: 12, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.287 Vali Acc: 0.856 Test Loss: 0.287 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.83837890625
Epoch: 13, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.309 Vali Acc: 0.861 Test Loss: 0.309 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7070896625518799
Epoch: 14, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.278 Vali Acc: 0.867 Test Loss: 0.278 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8441565036773682
Epoch: 15, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.7587177753448486
Epoch: 16, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.911108 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.8928472995758057
Epoch: 17, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8160183429718018
Epoch: 18, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7562456130981445
Epoch: 19, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9054772853851318
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 21 cost time: 0.9070141315460205
Epoch: 21, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.254 Vali Acc: 0.928 Test Loss: 0.254 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8166604042053223
Epoch: 22, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.318 Vali Acc: 0.928 Test Loss: 0.318 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7582740783691406
Epoch: 23, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8804845809936523
Epoch: 24, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7902219295501709
Epoch: 25, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.317 Vali Acc: 0.939 Test Loss: 0.317 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.726426362991333
Epoch: 26, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7525672912597656
Epoch: 27, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9097695350646973
Epoch: 28, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.707442045211792
Epoch: 29, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.427 Vali Acc: 0.917 Test Loss: 0.427 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8202860355377197
Epoch: 30, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 114584
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.092231512069702
Epoch: 1, Steps: 12 | Train Loss: 1.838 Vali Loss: 1.826 Vali Acc: 0.100 Test Loss: 1.826 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.6711525917053223
Epoch: 2, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.616 Vali Acc: 0.383 Test Loss: 1.616 Test Acc: 0.383
Validation loss decreased (-0.099982 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 0.7329788208007812
Epoch: 3, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.370 Vali Acc: 0.572 Test Loss: 1.370 Test Acc: 0.572
Validation loss decreased (-0.383317 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.7720410823822021
Epoch: 4, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.124 Vali Acc: 0.661 Test Loss: 1.124 Test Acc: 0.661
Validation loss decreased (-0.572209 --> -0.661100).  Saving model ...
Epoch: 5 cost time: 0.7383804321289062
Epoch: 5, Steps: 12 | Train Loss: 0.919 Vali Loss: 0.860 Vali Acc: 0.700 Test Loss: 0.860 Test Acc: 0.700
Validation loss decreased (-0.661100 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 0.6503536701202393
Epoch: 6, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
Validation loss decreased (-0.699991 --> -0.749994).  Saving model ...
Epoch: 7 cost time: 0.619865894317627
Epoch: 7, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.501 Vali Acc: 0.778 Test Loss: 0.501 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 8 cost time: 0.7027246952056885
Epoch: 8, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.484 Vali Acc: 0.767 Test Loss: 0.484 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6216773986816406
Epoch: 9, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.486 Vali Acc: 0.828 Test Loss: 0.486 Test Acc: 0.828
Validation loss decreased (-0.777773 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 0.6631467342376709
Epoch: 10, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.457 Vali Acc: 0.828 Test Loss: 0.457 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827773).  Saving model ...
Epoch: 11 cost time: 0.6892008781433105
Epoch: 11, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.439 Vali Acc: 0.883 Test Loss: 0.439 Test Acc: 0.883
Validation loss decreased (-0.827773 --> -0.883329).  Saving model ...
Epoch: 12 cost time: 0.6717596054077148
Epoch: 12, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.374 Vali Acc: 0.894 Test Loss: 0.374 Test Acc: 0.894
Validation loss decreased (-0.883329 --> -0.894441).  Saving model ...
Epoch: 13 cost time: 0.6166198253631592
Epoch: 13, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7303886413574219
Epoch: 14, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.403 Vali Acc: 0.872 Test Loss: 0.403 Test Acc: 0.872
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7392044067382812
Epoch: 15, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.439 Vali Acc: 0.894 Test Loss: 0.439 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6138110160827637
Epoch: 16, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.533 Vali Acc: 0.839 Test Loss: 0.533 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7460391521453857
Epoch: 17, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.349 Vali Acc: 0.917 Test Loss: 0.349 Test Acc: 0.917
Validation loss decreased (-0.894441 --> -0.916663).  Saving model ...
Epoch: 18 cost time: 0.8959269523620605
Epoch: 18, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.506 Vali Acc: 0.894 Test Loss: 0.506 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7296326160430908
Epoch: 19, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.399 Vali Acc: 0.878 Test Loss: 0.399 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7140343189239502
Epoch: 20, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.376 Vali Acc: 0.917 Test Loss: 0.376 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6986756324768066
Epoch: 21, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6715583801269531
Epoch: 22, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.427 Vali Acc: 0.889 Test Loss: 0.427 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7724308967590332
Epoch: 23, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.513 Vali Acc: 0.906 Test Loss: 0.513 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6204423904418945
Epoch: 24, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.391 Vali Acc: 0.917 Test Loss: 0.391 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7660541534423828
Epoch: 25, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.596 Vali Acc: 0.894 Test Loss: 0.596 Test Acc: 0.894
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7305500507354736
Epoch: 26, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.461 Vali Acc: 0.928 Test Loss: 0.461 Test Acc: 0.928
Validation loss decreased (-0.916663 --> -0.927773).  Saving model ...
Epoch: 27 cost time: 0.6509270668029785
Epoch: 27, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.685 Vali Acc: 0.872 Test Loss: 0.685 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5896480083465576
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7613849639892578
Epoch: 29, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.509 Vali Acc: 0.917 Test Loss: 0.509 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7733252048492432
Epoch: 30, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.516 Vali Acc: 0.928 Test Loss: 0.516 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7559604644775391
Epoch: 31, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.710 Vali Acc: 0.906 Test Loss: 0.710 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7643756866455078
Epoch: 32, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.751 Vali Acc: 0.900 Test Loss: 0.751 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7726781368255615
Epoch: 33, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.944 Vali Acc: 0.889 Test Loss: 0.944 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7389531135559082
Epoch: 34, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.641 Vali Acc: 0.917 Test Loss: 0.641 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6771318912506104
Epoch: 35, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.917 Test Loss: 0.639 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6631948947906494
Epoch: 36, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.606 Vali Acc: 0.917 Test Loss: 0.606 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm512_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 114533
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1483049392700195
Epoch: 1, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.714 Vali Acc: 0.211 Test Loss: 1.714 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.6328563690185547
Epoch: 2, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.528 Vali Acc: 0.428 Test Loss: 1.528 Test Acc: 0.428
Validation loss decreased (-0.211094 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 0.6613998413085938
Epoch: 3, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.302 Vali Acc: 0.667 Test Loss: 1.302 Test Acc: 0.667
Validation loss decreased (-0.427762 --> -0.666654).  Saving model ...
Epoch: 4 cost time: 0.6705279350280762
Epoch: 4, Steps: 12 | Train Loss: 1.176 Vali Loss: 1.087 Vali Acc: 0.706 Test Loss: 1.087 Test Acc: 0.706
Validation loss decreased (-0.666654 --> -0.705545).  Saving model ...
Epoch: 5 cost time: 0.6136813163757324
Epoch: 5, Steps: 12 | Train Loss: 0.965 Vali Loss: 0.903 Vali Acc: 0.722 Test Loss: 0.903 Test Acc: 0.722
Validation loss decreased (-0.705545 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 0.696134090423584
Epoch: 6, Steps: 12 | Train Loss: 0.781 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
Validation loss decreased (-0.722213 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 0.6839203834533691
Epoch: 7, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.7647054195404053
Epoch: 8, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.519 Vali Acc: 0.778 Test Loss: 0.519 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777773).  Saving model ...
Epoch: 9 cost time: 0.6717629432678223
Epoch: 9, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
Validation loss decreased (-0.777773 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 0.5265350341796875
Epoch: 10, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.352 Vali Acc: 0.872 Test Loss: 0.352 Test Acc: 0.872
Validation loss decreased (-0.816662 --> -0.872219).  Saving model ...
Epoch: 11 cost time: 0.5591704845428467
Epoch: 11, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.315 Vali Acc: 0.883 Test Loss: 0.315 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 0.658930778503418
Epoch: 12, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 0.8916499614715576
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.246 Vali Acc: 0.917 Test Loss: 0.246 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.74043869972229
Epoch: 14, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.285 Vali Acc: 0.867 Test Loss: 0.285 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.616356372833252
Epoch: 15, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.242 Vali Acc: 0.961 Test Loss: 0.242 Test Acc: 0.961
Validation loss decreased (-0.916664 --> -0.961109).  Saving model ...
Epoch: 16 cost time: 0.5472557544708252
Epoch: 16, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7291216850280762
Epoch: 17, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7009985446929932
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.273 Vali Acc: 0.900 Test Loss: 0.273 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7442572116851807
Epoch: 19, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7320437431335449
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.278 Vali Acc: 0.928 Test Loss: 0.278 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7078428268432617
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6003596782684326
Epoch: 22, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.278 Vali Acc: 0.939 Test Loss: 0.278 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7503221035003662
Epoch: 23, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6793644428253174
Epoch: 24, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.657078742980957
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 40706
model size : 0.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.159292459487915
Epoch: 1, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.671 Vali Acc: 0.267 Test Loss: 1.671 Test Acc: 0.267
Validation loss decreased (inf --> -0.266650).  Saving model ...
Epoch: 2 cost time: 0.6495904922485352
Epoch: 2, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.508 Vali Acc: 0.467 Test Loss: 1.508 Test Acc: 0.467
Validation loss decreased (-0.266650 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 0.6839175224304199
Epoch: 3, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.316 Vali Acc: 0.583 Test Loss: 1.316 Test Acc: 0.583
Validation loss decreased (-0.466652 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.7394428253173828
Epoch: 4, Steps: 12 | Train Loss: 1.222 Vali Loss: 1.122 Vali Acc: 0.617 Test Loss: 1.122 Test Acc: 0.617
Validation loss decreased (-0.583320 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 0.7673642635345459
Epoch: 5, Steps: 12 | Train Loss: 1.021 Vali Loss: 0.946 Vali Acc: 0.661 Test Loss: 0.946 Test Acc: 0.661
Validation loss decreased (-0.616655 --> -0.661102).  Saving model ...
Epoch: 6 cost time: 0.6997988224029541
Epoch: 6, Steps: 12 | Train Loss: 0.825 Vali Loss: 0.791 Vali Acc: 0.689 Test Loss: 0.791 Test Acc: 0.689
Validation loss decreased (-0.661102 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.6426272392272949
Epoch: 7, Steps: 12 | Train Loss: 0.670 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722216).  Saving model ...
Epoch: 8 cost time: 0.706139087677002
Epoch: 8, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.559 Vali Acc: 0.772 Test Loss: 0.559 Test Acc: 0.772
Validation loss decreased (-0.722216 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 0.6610984802246094
Epoch: 9, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.772217 --> -0.799995).  Saving model ...
Epoch: 10 cost time: 0.8190851211547852
Epoch: 10, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.400 Vali Acc: 0.806 Test Loss: 0.400 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805552).  Saving model ...
Epoch: 11 cost time: 0.5886409282684326
Epoch: 11, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.350 Vali Acc: 0.856 Test Loss: 0.350 Test Acc: 0.856
Validation loss decreased (-0.805552 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 0.625847339630127
Epoch: 12, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.313 Vali Acc: 0.861 Test Loss: 0.313 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 13 cost time: 0.6991736888885498
Epoch: 13, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 0.8889751434326172
Epoch: 14, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.266 Vali Acc: 0.883 Test Loss: 0.266 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7162778377532959
Epoch: 15, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.6953930854797363
Epoch: 16, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.899997 --> -0.927776).  Saving model ...
Epoch: 17 cost time: 0.6719295978546143
Epoch: 17, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.247 Vali Acc: 0.939 Test Loss: 0.247 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938886).  Saving model ...
Epoch: 18 cost time: 0.631941556930542
Epoch: 18, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7107348442077637
Epoch: 19, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938887).  Saving model ...
Epoch: 20 cost time: 0.7267630100250244
Epoch: 20, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7543380260467529
Epoch: 21, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.266 Vali Acc: 0.928 Test Loss: 0.266 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8031032085418701
Epoch: 22, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6870367527008057
Epoch: 23, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.928 Test Loss: 0.274 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7339560985565186
Epoch: 24, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.313 Vali Acc: 0.917 Test Loss: 0.313 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6382935047149658
Epoch: 25, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6983389854431152
Epoch: 26, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6987526416778564
Epoch: 27, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.311 Vali Acc: 0.911 Test Loss: 0.311 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6988749504089355
Epoch: 28, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.370 Vali Acc: 0.906 Test Loss: 0.370 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6690850257873535
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.6553914546966553
Epoch: 30, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 39517
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.124864339828491
Epoch: 1, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.782 Vali Acc: 0.183 Test Loss: 1.782 Test Acc: 0.183
Validation loss decreased (inf --> -0.183316).  Saving model ...
Epoch: 2 cost time: 0.7792870998382568
Epoch: 2, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.585 Vali Acc: 0.422 Test Loss: 1.585 Test Acc: 0.422
Validation loss decreased (-0.183316 --> -0.422206).  Saving model ...
Epoch: 3 cost time: 0.6966860294342041
Epoch: 3, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.361 Vali Acc: 0.644 Test Loss: 1.361 Test Acc: 0.644
Validation loss decreased (-0.422206 --> -0.644431).  Saving model ...
Epoch: 4 cost time: 0.910426139831543
Epoch: 4, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.134 Vali Acc: 0.706 Test Loss: 1.134 Test Acc: 0.706
Validation loss decreased (-0.644431 --> -0.705544).  Saving model ...
Epoch: 5 cost time: 0.6714878082275391
Epoch: 5, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.925 Vali Acc: 0.733 Test Loss: 0.925 Test Acc: 0.733
Validation loss decreased (-0.705544 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 0.6110525131225586
Epoch: 6, Steps: 12 | Train Loss: 0.840 Vali Loss: 0.764 Vali Acc: 0.750 Test Loss: 0.764 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749992).  Saving model ...
Epoch: 7 cost time: 0.5758147239685059
Epoch: 7, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.6670942306518555
Epoch: 8, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.788883).  Saving model ...
Epoch: 9 cost time: 0.7137050628662109
Epoch: 9, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.456 Vali Acc: 0.828 Test Loss: 0.456 Test Acc: 0.828
Validation loss decreased (-0.788883 --> -0.827773).  Saving model ...
Epoch: 10 cost time: 0.7101643085479736
Epoch: 10, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.381 Vali Acc: 0.861 Test Loss: 0.381 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 11 cost time: 0.6366512775421143
Epoch: 11, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.321 Vali Acc: 0.883 Test Loss: 0.321 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 12 cost time: 0.6474614143371582
Epoch: 12, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.281 Vali Acc: 0.883 Test Loss: 0.281 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883331).  Saving model ...
Epoch: 13 cost time: 0.6538734436035156
Epoch: 13, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.265 Vali Acc: 0.872 Test Loss: 0.265 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7582471370697021
Epoch: 14, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.883331 --> -0.927775).  Saving model ...
Epoch: 15 cost time: 0.7186341285705566
Epoch: 15, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.612659215927124
Epoch: 16, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.927775 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.5940651893615723
Epoch: 17, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6112539768218994
Epoch: 18, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.236 Vali Acc: 0.900 Test Loss: 0.236 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.716996431350708
Epoch: 19, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6736252307891846
Epoch: 20, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9236288070678711
Epoch: 21, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7971868515014648
Epoch: 22, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7827112674713135
Epoch: 23, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.271 Vali Acc: 0.928 Test Loss: 0.271 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6846709251403809
Epoch: 24, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.285 Vali Acc: 0.928 Test Loss: 0.285 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6974203586578369
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7280693054199219
Epoch: 26, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.950 Test Loss: 0.281 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 39074
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0376780033111572
Epoch: 1, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.796 Vali Acc: 0.150 Test Loss: 1.796 Test Acc: 0.150
Validation loss decreased (inf --> -0.149982).  Saving model ...
Epoch: 2 cost time: 0.6938934326171875
Epoch: 2, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.620 Vali Acc: 0.400 Test Loss: 1.620 Test Acc: 0.400
Validation loss decreased (-0.149982 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.6774351596832275
Epoch: 3, Steps: 12 | Train Loss: 1.502 Vali Loss: 1.410 Vali Acc: 0.578 Test Loss: 1.410 Test Acc: 0.578
Validation loss decreased (-0.399984 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.7094488143920898
Epoch: 4, Steps: 12 | Train Loss: 1.271 Vali Loss: 1.194 Vali Acc: 0.672 Test Loss: 1.194 Test Acc: 0.672
Validation loss decreased (-0.577764 --> -0.672210).  Saving model ...
Epoch: 5 cost time: 0.6487183570861816
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 0.985 Vali Acc: 0.722 Test Loss: 0.985 Test Acc: 0.722
Validation loss decreased (-0.672210 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.715651273727417
Epoch: 6, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.799 Vali Acc: 0.744 Test Loss: 0.799 Test Acc: 0.744
Validation loss decreased (-0.722212 --> -0.744436).  Saving model ...
Epoch: 7 cost time: 0.6254663467407227
Epoch: 7, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
Validation loss decreased (-0.744436 --> -0.783327).  Saving model ...
Epoch: 8 cost time: 0.7685861587524414
Epoch: 8, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.499 Vali Acc: 0.833 Test Loss: 0.499 Test Acc: 0.833
Validation loss decreased (-0.783327 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.6543786525726318
Epoch: 9, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.413 Vali Acc: 0.839 Test Loss: 0.413 Test Acc: 0.839
Validation loss decreased (-0.833328 --> -0.838885).  Saving model ...
Epoch: 10 cost time: 0.6717743873596191
Epoch: 10, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 11 cost time: 0.7090096473693848
Epoch: 11, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.321 Vali Acc: 0.878 Test Loss: 0.321 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 12 cost time: 0.6074132919311523
Epoch: 12, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
Validation loss decreased (-0.877775 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.6520357131958008
Epoch: 13, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 14 cost time: 0.730097770690918
Epoch: 14, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.268 Vali Acc: 0.900 Test Loss: 0.268 Test Acc: 0.900
Validation loss decreased (-0.894442 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 0.7818019390106201
Epoch: 15, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 16 cost time: 0.7753641605377197
Epoch: 16, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
Validation loss decreased (-0.911109 --> -0.927775).  Saving model ...
Epoch: 17 cost time: 0.6188530921936035
Epoch: 17, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.917 Test Loss: 0.298 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.561366081237793
Epoch: 18, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933330).  Saving model ...
Epoch: 19 cost time: 0.6639478206634521
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.367 Vali Acc: 0.867 Test Loss: 0.367 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.612713098526001
Epoch: 20, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.664536714553833
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6100990772247314
Epoch: 22, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7574234008789062
Epoch: 23, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5456483364105225
Epoch: 24, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.431 Vali Acc: 0.894 Test Loss: 0.431 Test Acc: 0.894
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6580300331115723
Epoch: 25, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6498968601226807
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.405 Vali Acc: 0.883 Test Loss: 0.405 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7516934871673584
Epoch: 27, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6731879711151123
Epoch: 28, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.491 Vali Acc: 0.867 Test Loss: 0.491 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 38993
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8080227375030518
Epoch: 1, Steps: 12 | Train Loss: 1.863 Vali Loss: 1.758 Vali Acc: 0.222 Test Loss: 1.758 Test Acc: 0.222
Validation loss decreased (inf --> -0.222205).  Saving model ...
Epoch: 2 cost time: 0.6587831974029541
Epoch: 2, Steps: 12 | Train Loss: 1.714 Vali Loss: 1.580 Vali Acc: 0.322 Test Loss: 1.580 Test Acc: 0.322
Validation loss decreased (-0.222205 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.7077231407165527
Epoch: 3, Steps: 12 | Train Loss: 1.486 Vali Loss: 1.365 Vali Acc: 0.556 Test Loss: 1.365 Test Acc: 0.556
Validation loss decreased (-0.322206 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 0.7605874538421631
Epoch: 4, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.150 Vali Acc: 0.667 Test Loss: 1.150 Test Acc: 0.667
Validation loss decreased (-0.555542 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.665621280670166
Epoch: 5, Steps: 12 | Train Loss: 1.053 Vali Loss: 0.962 Vali Acc: 0.672 Test Loss: 0.962 Test Acc: 0.672
Validation loss decreased (-0.666655 --> -0.672213).  Saving model ...
Epoch: 6 cost time: 0.6768472194671631
Epoch: 6, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.807 Vali Acc: 0.711 Test Loss: 0.807 Test Acc: 0.711
Validation loss decreased (-0.672213 --> -0.711103).  Saving model ...
Epoch: 7 cost time: 0.6980400085449219
Epoch: 7, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.684 Vali Acc: 0.728 Test Loss: 0.684 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.5999083518981934
Epoch: 8, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.585 Vali Acc: 0.733 Test Loss: 0.585 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.7031946182250977
Epoch: 9, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.499 Vali Acc: 0.772 Test Loss: 0.499 Test Acc: 0.772
Validation loss decreased (-0.733327 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 0.6308515071868896
Epoch: 10, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.435 Vali Acc: 0.806 Test Loss: 0.435 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 0.7064859867095947
Epoch: 11, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.372 Vali Acc: 0.828 Test Loss: 0.372 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 0.7054035663604736
Epoch: 12, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.336 Vali Acc: 0.856 Test Loss: 0.336 Test Acc: 0.856
Validation loss decreased (-0.827774 --> -0.855552).  Saving model ...
Epoch: 13 cost time: 0.7283434867858887
Epoch: 13, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.311 Vali Acc: 0.872 Test Loss: 0.311 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 0.7283978462219238
Epoch: 14, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.291 Vali Acc: 0.917 Test Loss: 0.291 Test Acc: 0.917
Validation loss decreased (-0.872219 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.7201433181762695
Epoch: 15, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.246 Vali Acc: 0.939 Test Loss: 0.246 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938886).  Saving model ...
Epoch: 16 cost time: 0.8068320751190186
Epoch: 16, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.76021409034729
Epoch: 17, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.216 Vali Acc: 0.939 Test Loss: 0.216 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7572546005249023
Epoch: 18, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.7358877658843994
Epoch: 19, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.272 Vali Acc: 0.900 Test Loss: 0.272 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7793724536895752
Epoch: 20, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6244339942932129
Epoch: 21, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6658768653869629
Epoch: 22, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9038479328155518
Epoch: 23, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.272 Vali Acc: 0.928 Test Loss: 0.272 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7440598011016846
Epoch: 24, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.288 Vali Acc: 0.928 Test Loss: 0.288 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6856646537780762
Epoch: 25, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6581475734710693
Epoch: 26, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.300 Vali Acc: 0.928 Test Loss: 0.300 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6675190925598145
Epoch: 27, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.353 Vali Acc: 0.928 Test Loss: 0.353 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7673680782318115
Epoch: 28, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 38712
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.153944969177246
Epoch: 1, Steps: 12 | Train Loss: 1.755 Vali Loss: 1.648 Vali Acc: 0.206 Test Loss: 1.648 Test Acc: 0.206
Validation loss decreased (inf --> -0.205539).  Saving model ...
Epoch: 2 cost time: 0.6265208721160889
Epoch: 2, Steps: 12 | Train Loss: 1.590 Vali Loss: 1.481 Vali Acc: 0.433 Test Loss: 1.481 Test Acc: 0.433
Validation loss decreased (-0.205539 --> -0.433319).  Saving model ...
Epoch: 3 cost time: 0.674389123916626
Epoch: 3, Steps: 12 | Train Loss: 1.374 Vali Loss: 1.271 Vali Acc: 0.583 Test Loss: 1.271 Test Acc: 0.583
Validation loss decreased (-0.433319 --> -0.583321).  Saving model ...
Epoch: 4 cost time: 0.6783919334411621
Epoch: 4, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.062 Vali Acc: 0.689 Test Loss: 1.062 Test Acc: 0.689
Validation loss decreased (-0.583321 --> -0.688878).  Saving model ...
Epoch: 5 cost time: 0.8255195617675781
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.867 Vali Acc: 0.683 Test Loss: 0.867 Test Acc: 0.683
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.688927173614502
Epoch: 6, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.702 Vali Acc: 0.733 Test Loss: 0.702 Test Acc: 0.733
Validation loss decreased (-0.688878 --> -0.733326).  Saving model ...
Epoch: 7 cost time: 0.5872597694396973
Epoch: 7, Steps: 12 | Train Loss: 0.569 Vali Loss: 0.556 Vali Acc: 0.772 Test Loss: 0.556 Test Acc: 0.772
Validation loss decreased (-0.733326 --> -0.772217).  Saving model ...
Epoch: 8 cost time: 0.6455469131469727
Epoch: 8, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.459 Vali Acc: 0.767 Test Loss: 0.459 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6912827491760254
Epoch: 9, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.394 Vali Acc: 0.817 Test Loss: 0.394 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816663).  Saving model ...
Epoch: 10 cost time: 0.7364475727081299
Epoch: 10, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.369 Vali Acc: 0.833 Test Loss: 0.369 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 11 cost time: 0.6743795871734619
Epoch: 11, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.343 Vali Acc: 0.850 Test Loss: 0.343 Test Acc: 0.850
Validation loss decreased (-0.833330 --> -0.849997).  Saving model ...
Epoch: 12 cost time: 0.8837461471557617
Epoch: 12, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.320 Vali Acc: 0.872 Test Loss: 0.320 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 13 cost time: 0.6661257743835449
Epoch: 13, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.308 Vali Acc: 0.917 Test Loss: 0.308 Test Acc: 0.917
Validation loss decreased (-0.872219 --> -0.916664).  Saving model ...
Epoch: 14 cost time: 0.6893012523651123
Epoch: 14, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6950199604034424
Epoch: 15, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.294 Vali Acc: 0.906 Test Loss: 0.294 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7129476070404053
Epoch: 16, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6738078594207764
Epoch: 17, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.6369528770446777
Epoch: 18, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6358373165130615
Epoch: 19, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.420 Vali Acc: 0.917 Test Loss: 0.420 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7420804500579834
Epoch: 20, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5803966522216797
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.417 Vali Acc: 0.883 Test Loss: 0.417 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6190478801727295
Epoch: 22, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.422 Vali Acc: 0.917 Test Loss: 0.422 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6480247974395752
Epoch: 23, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7069664001464844
Epoch: 24, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.623 Vali Acc: 0.867 Test Loss: 0.623 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7378706932067871
Epoch: 25, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.456 Vali Acc: 0.878 Test Loss: 0.456 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6128110885620117
Epoch: 26, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.453 Vali Acc: 0.894 Test Loss: 0.453 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5738396644592285
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.627 Vali Acc: 0.894 Test Loss: 0.627 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 38716
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1062262058258057
Epoch: 1, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.580 Vali Acc: 0.333 Test Loss: 1.580 Test Acc: 0.333
Validation loss decreased (inf --> -0.333318).  Saving model ...
Epoch: 2 cost time: 0.7756590843200684
Epoch: 2, Steps: 12 | Train Loss: 1.534 Vali Loss: 1.430 Vali Acc: 0.472 Test Loss: 1.430 Test Acc: 0.472
Validation loss decreased (-0.333318 --> -0.472208).  Saving model ...
Epoch: 3 cost time: 0.6931931972503662
Epoch: 3, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.240 Vali Acc: 0.561 Test Loss: 1.240 Test Acc: 0.561
Validation loss decreased (-0.472208 --> -0.561099).  Saving model ...
Epoch: 4 cost time: 0.6740632057189941
Epoch: 4, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.048 Vali Acc: 0.694 Test Loss: 1.048 Test Acc: 0.694
Validation loss decreased (-0.561099 --> -0.694434).  Saving model ...
Epoch: 5 cost time: 0.6054682731628418
Epoch: 5, Steps: 12 | Train Loss: 0.914 Vali Loss: 0.875 Vali Acc: 0.756 Test Loss: 0.875 Test Acc: 0.756
Validation loss decreased (-0.694434 --> -0.755547).  Saving model ...
Epoch: 6 cost time: 0.653111457824707
Epoch: 6, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
Validation loss decreased (-0.755547 --> -0.783326).  Saving model ...
Epoch: 7 cost time: 0.7685835361480713
Epoch: 7, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783327).  Saving model ...
Epoch: 8 cost time: 0.7271089553833008
Epoch: 8, Steps: 12 | Train Loss: 0.507 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788884).  Saving model ...
Epoch: 9 cost time: 0.823420524597168
Epoch: 9, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.420 Vali Acc: 0.817 Test Loss: 0.420 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 0.5770144462585449
Epoch: 10, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.373 Vali Acc: 0.839 Test Loss: 0.373 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 11 cost time: 0.9310481548309326
Epoch: 11, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.338 Vali Acc: 0.867 Test Loss: 0.338 Test Acc: 0.867
Validation loss decreased (-0.838885 --> -0.866663).  Saving model ...
Epoch: 12 cost time: 0.652369499206543
Epoch: 12, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888886).  Saving model ...
Epoch: 13 cost time: 0.5904672145843506
Epoch: 13, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 14 cost time: 0.6965882778167725
Epoch: 14, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 15 cost time: 0.6846866607666016
Epoch: 15, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.320 Vali Acc: 0.844 Test Loss: 0.320 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6894271373748779
Epoch: 16, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7948367595672607
Epoch: 17, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.278 Vali Acc: 0.906 Test Loss: 0.278 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6875631809234619
Epoch: 18, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7779221534729004
Epoch: 19, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.6580891609191895
Epoch: 20, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5827765464782715
Epoch: 21, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6884315013885498
Epoch: 22, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.286 Vali Acc: 0.889 Test Loss: 0.286 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8420548439025879
Epoch: 23, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.7378542423248291
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.69927978515625
Epoch: 25, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6150572299957275
Epoch: 26, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5779030323028564
Epoch: 27, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7730631828308105
Epoch: 28, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.6924901008605957
Epoch: 29, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7243785858154297
Epoch: 30, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.569122314453125
Epoch: 31, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.590477705001831
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6623885631561279
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.284 Vali Acc: 0.917 Test Loss: 0.284 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7901206016540527
Epoch: 34, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.635150671005249
Epoch: 35, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6737885475158691
Epoch: 36, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7104263305664062
Epoch: 37, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.295 Vali Acc: 0.928 Test Loss: 0.295 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6732461452484131
Epoch: 38, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.6976170539855957
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.303 Vali Acc: 0.917 Test Loss: 0.303 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6576206684112549
Epoch: 40, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.328 Vali Acc: 0.928 Test Loss: 0.328 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6180377006530762
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6816205978393555
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7219200134277344
Epoch: 43, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.374 Vali Acc: 0.917 Test Loss: 0.374 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7412796020507812
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6576309204101562
Epoch: 45, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6976447105407715
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.444 Vali Acc: 0.917 Test Loss: 0.444 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6036722660064697
Epoch: 47, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.427 Vali Acc: 0.917 Test Loss: 0.427 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.601635217666626
Epoch: 48, Steps: 12 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.911 Test Loss: 0.424 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 38622
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.170956611633301
Epoch: 1, Steps: 12 | Train Loss: 1.745 Vali Loss: 1.681 Vali Acc: 0.322 Test Loss: 1.681 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.613074779510498
Epoch: 2, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.516 Vali Acc: 0.461 Test Loss: 1.516 Test Acc: 0.461
Validation loss decreased (-0.322205 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.6053225994110107
Epoch: 3, Steps: 12 | Train Loss: 1.405 Vali Loss: 1.325 Vali Acc: 0.550 Test Loss: 1.325 Test Acc: 0.550
Validation loss decreased (-0.461096 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.6382796764373779
Epoch: 4, Steps: 12 | Train Loss: 1.211 Vali Loss: 1.126 Vali Acc: 0.594 Test Loss: 1.126 Test Acc: 0.594
Validation loss decreased (-0.549987 --> -0.594433).  Saving model ...
Epoch: 5 cost time: 0.6702613830566406
Epoch: 5, Steps: 12 | Train Loss: 0.993 Vali Loss: 0.946 Vali Acc: 0.683 Test Loss: 0.946 Test Acc: 0.683
Validation loss decreased (-0.594433 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.6947383880615234
Epoch: 6, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.799 Vali Acc: 0.689 Test Loss: 0.799 Test Acc: 0.689
Validation loss decreased (-0.683324 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.6339287757873535
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.689 Vali Acc: 0.722 Test Loss: 0.689 Test Acc: 0.722
Validation loss decreased (-0.688881 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 0.5487015247344971
Epoch: 8, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.599 Vali Acc: 0.756 Test Loss: 0.599 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 0.7125277519226074
Epoch: 9, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.525 Vali Acc: 0.761 Test Loss: 0.525 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 10 cost time: 0.6203279495239258
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.453 Vali Acc: 0.800 Test Loss: 0.453 Test Acc: 0.800
Validation loss decreased (-0.761106 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.5395581722259521
Epoch: 11, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.393 Vali Acc: 0.828 Test Loss: 0.393 Test Acc: 0.828
Validation loss decreased (-0.799995 --> -0.827774).  Saving model ...
Epoch: 12 cost time: 0.614588737487793
Epoch: 12, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.356 Vali Acc: 0.839 Test Loss: 0.356 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 0.5470197200775146
Epoch: 13, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.325 Vali Acc: 0.861 Test Loss: 0.325 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861108).  Saving model ...
Epoch: 14 cost time: 0.5750274658203125
Epoch: 14, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 15 cost time: 0.7384810447692871
Epoch: 15, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.5868375301361084
Epoch: 16, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6248774528503418
Epoch: 17, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.7007296085357666
Epoch: 18, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.211 Vali Acc: 0.906 Test Loss: 0.211 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 0.620826244354248
Epoch: 19, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.229 Vali Acc: 0.900 Test Loss: 0.229 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5512053966522217
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6027376651763916
Epoch: 21, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5860841274261475
Epoch: 22, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.5846495628356934
Epoch: 23, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7632536888122559
Epoch: 24, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5765523910522461
Epoch: 25, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.5175719261169434
Epoch: 26, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.5674693584442139
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5936086177825928
Epoch: 28, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.5634775161743164
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.235 Vali Acc: 0.928 Test Loss: 0.235 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 0.6673028469085693
Epoch: 30, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 31 cost time: 0.6540617942810059
Epoch: 31, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5668723583221436
Epoch: 32, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7282609939575195
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.677128791809082
Epoch: 34, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7000975608825684
Epoch: 35, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6249895095825195
Epoch: 36, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6832854747772217
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6840991973876953
Epoch: 38, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.393 Vali Acc: 0.917 Test Loss: 0.393 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6865825653076172
Epoch: 39, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7421562671661377
Epoch: 40, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.428 Vali Acc: 0.894 Test Loss: 0.428 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 38430
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.998673439025879
Epoch: 1, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.810 Vali Acc: 0.239 Test Loss: 1.810 Test Acc: 0.239
Validation loss decreased (inf --> -0.238871).  Saving model ...
Epoch: 2 cost time: 0.7504057884216309
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.624 Vali Acc: 0.417 Test Loss: 1.624 Test Acc: 0.417
Validation loss decreased (-0.238871 --> -0.416650).  Saving model ...
Epoch: 3 cost time: 0.7009351253509521
Epoch: 3, Steps: 12 | Train Loss: 1.511 Vali Loss: 1.402 Vali Acc: 0.622 Test Loss: 1.402 Test Acc: 0.622
Validation loss decreased (-0.416650 --> -0.622208).  Saving model ...
Epoch: 4 cost time: 0.6742730140686035
Epoch: 4, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.169 Vali Acc: 0.672 Test Loss: 1.169 Test Acc: 0.672
Validation loss decreased (-0.622208 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.6510720252990723
Epoch: 5, Steps: 12 | Train Loss: 1.035 Vali Loss: 0.960 Vali Acc: 0.711 Test Loss: 0.960 Test Acc: 0.711
Validation loss decreased (-0.672211 --> -0.711102).  Saving model ...
Epoch: 6 cost time: 0.61871337890625
Epoch: 6, Steps: 12 | Train Loss: 0.842 Vali Loss: 0.796 Vali Acc: 0.722 Test Loss: 0.796 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.5967185497283936
Epoch: 7, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.683 Vali Acc: 0.750 Test Loss: 0.683 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.6768345832824707
Epoch: 8, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.608 Vali Acc: 0.744 Test Loss: 0.608 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6309909820556641
Epoch: 9, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.547 Vali Acc: 0.778 Test Loss: 0.547 Test Acc: 0.778
Validation loss decreased (-0.749993 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 0.6817605495452881
Epoch: 10, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.494 Vali Acc: 0.772 Test Loss: 0.494 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.752194881439209
Epoch: 11, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.459 Vali Acc: 0.778 Test Loss: 0.459 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777773).  Saving model ...
Epoch: 12 cost time: 0.6314129829406738
Epoch: 12, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.777773 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.5840392112731934
Epoch: 13, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.368 Vali Acc: 0.817 Test Loss: 0.368 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.543159008026123
Epoch: 14, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.324 Vali Acc: 0.856 Test Loss: 0.324 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 0.624230146408081
Epoch: 15, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.290 Vali Acc: 0.878 Test Loss: 0.290 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 0.6310005187988281
Epoch: 16, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 17 cost time: 0.5521366596221924
Epoch: 17, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
Validation loss decreased (-0.899998 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.7489423751831055
Epoch: 18, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6543436050415039
Epoch: 19, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.292 Vali Acc: 0.867 Test Loss: 0.292 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7615387439727783
Epoch: 20, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.258 Vali Acc: 0.883 Test Loss: 0.258 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6422085762023926
Epoch: 21, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 0.7333569526672363
Epoch: 22, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.266 Vali Acc: 0.906 Test Loss: 0.266 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6142067909240723
Epoch: 23, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.313 Vali Acc: 0.906 Test Loss: 0.313 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6859803199768066
Epoch: 24, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.280 Vali Acc: 0.911 Test Loss: 0.280 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6355419158935547
Epoch: 25, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.79795241355896
Epoch: 26, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.453 Vali Acc: 0.894 Test Loss: 0.453 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7688431739807129
Epoch: 27, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.937920331954956
Epoch: 28, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.906 Test Loss: 0.427 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5766029357910156
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7452683448791504
Epoch: 30, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7475690841674805
Epoch: 31, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.906 Test Loss: 0.546 Test Acc: 0.906
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 38441
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.11179518699646
Epoch: 1, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.719 Vali Acc: 0.311 Test Loss: 1.719 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.6271135807037354
Epoch: 2, Steps: 12 | Train Loss: 1.605 Vali Loss: 1.534 Vali Acc: 0.444 Test Loss: 1.534 Test Acc: 0.444
Validation loss decreased (-0.311094 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.5551283359527588
Epoch: 3, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.322 Vali Acc: 0.528 Test Loss: 1.322 Test Acc: 0.528
Validation loss decreased (-0.444429 --> -0.527765).  Saving model ...
Epoch: 4 cost time: 0.6327869892120361
Epoch: 4, Steps: 12 | Train Loss: 1.143 Vali Loss: 1.118 Vali Acc: 0.617 Test Loss: 1.118 Test Acc: 0.617
Validation loss decreased (-0.527765 --> -0.616655).  Saving model ...
Epoch: 5 cost time: 0.7072165012359619
Epoch: 5, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.927 Vali Acc: 0.678 Test Loss: 0.927 Test Acc: 0.678
Validation loss decreased (-0.616655 --> -0.677769).  Saving model ...
Epoch: 6 cost time: 0.7041342258453369
Epoch: 6, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.770 Vali Acc: 0.706 Test Loss: 0.770 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705548).  Saving model ...
Epoch: 7 cost time: 0.7217679023742676
Epoch: 7, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
Validation loss decreased (-0.705548 --> -0.716660).  Saving model ...
Epoch: 8 cost time: 0.6609315872192383
Epoch: 8, Steps: 12 | Train Loss: 0.505 Vali Loss: 0.501 Vali Acc: 0.767 Test Loss: 0.501 Test Acc: 0.767
Validation loss decreased (-0.716660 --> -0.766662).  Saving model ...
Epoch: 9 cost time: 0.6723690032958984
Epoch: 9, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.403 Vali Acc: 0.850 Test Loss: 0.403 Test Acc: 0.850
Validation loss decreased (-0.766662 --> -0.849996).  Saving model ...
Epoch: 10 cost time: 0.6249239444732666
Epoch: 10, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.344 Vali Acc: 0.856 Test Loss: 0.344 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 11 cost time: 0.6461827754974365
Epoch: 11, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.300 Vali Acc: 0.906 Test Loss: 0.300 Test Acc: 0.906
Validation loss decreased (-0.855552 --> -0.905553).  Saving model ...
Epoch: 12 cost time: 0.7758328914642334
Epoch: 12, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.280 Vali Acc: 0.872 Test Loss: 0.280 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7058935165405273
Epoch: 13, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 14 cost time: 0.7191386222839355
Epoch: 14, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.905553 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 0.6438970565795898
Epoch: 15, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.9159409999847412
Epoch: 16, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.164 Vali Acc: 0.950 Test Loss: 0.164 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 17 cost time: 0.7315466403961182
Epoch: 17, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7893927097320557
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.173 Vali Acc: 0.928 Test Loss: 0.173 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8070905208587646
Epoch: 19, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7908756732940674
Epoch: 20, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.215 Vali Acc: 0.928 Test Loss: 0.215 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6109230518341064
Epoch: 21, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.209 Vali Acc: 0.900 Test Loss: 0.209 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.585942268371582
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6626191139221191
Epoch: 23, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.269 Vali Acc: 0.889 Test Loss: 0.269 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6830410957336426
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8717865943908691
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.151 Vali Acc: 0.939 Test Loss: 0.151 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7508969306945801
Epoch: 26, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.944 Test Loss: 0.139 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 38264
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.879150629043579
Epoch: 1, Steps: 12 | Train Loss: 1.736 Vali Loss: 1.652 Vali Acc: 0.272 Test Loss: 1.652 Test Acc: 0.272
Validation loss decreased (inf --> -0.272206).  Saving model ...
Epoch: 2 cost time: 0.6335177421569824
Epoch: 2, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.485 Vali Acc: 0.433 Test Loss: 1.485 Test Acc: 0.433
Validation loss decreased (-0.272206 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 0.6515552997589111
Epoch: 3, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.284 Vali Acc: 0.606 Test Loss: 1.284 Test Acc: 0.606
Validation loss decreased (-0.433318 --> -0.605543).  Saving model ...
Epoch: 4 cost time: 0.6437993049621582
Epoch: 4, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.076 Vali Acc: 0.711 Test Loss: 1.076 Test Acc: 0.711
Validation loss decreased (-0.605543 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 0.8017077445983887
Epoch: 5, Steps: 12 | Train Loss: 0.953 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
Validation loss decreased (-0.711100 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 0.6410098075866699
Epoch: 6, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.741 Vali Acc: 0.739 Test Loss: 0.741 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738881).  Saving model ...
Epoch: 7 cost time: 0.5768871307373047
Epoch: 7, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.627 Vali Acc: 0.750 Test Loss: 0.627 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749994).  Saving model ...
Epoch: 8 cost time: 0.5818893909454346
Epoch: 8, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.532 Vali Acc: 0.772 Test Loss: 0.532 Test Acc: 0.772
Validation loss decreased (-0.749994 --> -0.772217).  Saving model ...
Epoch: 9 cost time: 0.7402210235595703
Epoch: 9, Steps: 12 | Train Loss: 0.425 Vali Loss: 0.454 Vali Acc: 0.817 Test Loss: 0.454 Test Acc: 0.817
Validation loss decreased (-0.772217 --> -0.816662).  Saving model ...
Epoch: 10 cost time: 0.6420798301696777
Epoch: 10, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.401 Vali Acc: 0.828 Test Loss: 0.401 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 11 cost time: 0.6754779815673828
Epoch: 11, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.348 Vali Acc: 0.861 Test Loss: 0.348 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861108).  Saving model ...
Epoch: 12 cost time: 0.6454057693481445
Epoch: 12, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.334 Vali Acc: 0.839 Test Loss: 0.334 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7022383213043213
Epoch: 13, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.326 Vali Acc: 0.872 Test Loss: 0.326 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 0.6268799304962158
Epoch: 14, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 0.8044126033782959
Epoch: 15, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 16 cost time: 0.7312860488891602
Epoch: 16, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.266 Vali Acc: 0.917 Test Loss: 0.266 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 17 cost time: 0.8776538372039795
Epoch: 17, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.338 Vali Acc: 0.894 Test Loss: 0.338 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7068610191345215
Epoch: 18, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.271 Vali Acc: 0.906 Test Loss: 0.271 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7553861141204834
Epoch: 19, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.264 Vali Acc: 0.917 Test Loss: 0.264 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 20 cost time: 0.7022051811218262
Epoch: 20, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.319 Vali Acc: 0.906 Test Loss: 0.319 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6442997455596924
Epoch: 21, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.727834939956665
Epoch: 22, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6765539646148682
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
Validation loss decreased (-0.922219 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.8126680850982666
Epoch: 24, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.6422712802886963
Epoch: 25, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.357 Vali Acc: 0.917 Test Loss: 0.357 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7541177272796631
Epoch: 26, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.287 Vali Acc: 0.928 Test Loss: 0.287 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6728403568267822
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.382 Vali Acc: 0.900 Test Loss: 0.382 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.743647575378418
Epoch: 28, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7757973670959473
Epoch: 29, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.354 Vali Acc: 0.917 Test Loss: 0.354 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7356407642364502
Epoch: 30, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.717714786529541
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8972868919372559
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.834315299987793
Epoch: 33, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.424 Vali Acc: 0.917 Test Loss: 0.424 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7575290203094482
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.521 Vali Acc: 0.911 Test Loss: 0.521 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm256_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 38341
model size : 0.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1174330711364746
Epoch: 1, Steps: 12 | Train Loss: 1.858 Vali Loss: 1.800 Vali Acc: 0.078 Test Loss: 1.800 Test Acc: 0.078
Validation loss decreased (inf --> -0.077760).  Saving model ...
Epoch: 2 cost time: 0.8075087070465088
Epoch: 2, Steps: 12 | Train Loss: 1.696 Vali Loss: 1.607 Vali Acc: 0.328 Test Loss: 1.607 Test Acc: 0.328
Validation loss decreased (-0.077760 --> -0.327762).  Saving model ...
Epoch: 3 cost time: 0.7292053699493408
Epoch: 3, Steps: 12 | Train Loss: 1.488 Vali Loss: 1.381 Vali Acc: 0.578 Test Loss: 1.381 Test Acc: 0.578
Validation loss decreased (-0.327762 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.6910686492919922
Epoch: 4, Steps: 12 | Train Loss: 1.242 Vali Loss: 1.165 Vali Acc: 0.667 Test Loss: 1.165 Test Acc: 0.667
Validation loss decreased (-0.577764 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.789379358291626
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.975 Vali Acc: 0.683 Test Loss: 0.975 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.7730205059051514
Epoch: 6, Steps: 12 | Train Loss: 0.863 Vali Loss: 0.830 Vali Acc: 0.711 Test Loss: 0.830 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711103).  Saving model ...
Epoch: 7 cost time: 0.8146638870239258
Epoch: 7, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.720 Vali Acc: 0.739 Test Loss: 0.720 Test Acc: 0.739
Validation loss decreased (-0.711103 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.7762405872344971
Epoch: 8, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.635 Vali Acc: 0.761 Test Loss: 0.635 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.660078763961792
Epoch: 9, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.570 Vali Acc: 0.767 Test Loss: 0.570 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.7727978229522705
Epoch: 10, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.516 Vali Acc: 0.794 Test Loss: 0.516 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 0.7929964065551758
Epoch: 11, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.471 Vali Acc: 0.822 Test Loss: 0.471 Test Acc: 0.822
Validation loss decreased (-0.794439 --> -0.822218).  Saving model ...
Epoch: 12 cost time: 0.9217839241027832
Epoch: 12, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.429 Vali Acc: 0.822 Test Loss: 0.429 Test Acc: 0.822
Validation loss decreased (-0.822218 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.7719631195068359
Epoch: 13, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.388 Vali Acc: 0.856 Test Loss: 0.388 Test Acc: 0.856
Validation loss decreased (-0.822218 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 0.8637785911560059
Epoch: 14, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
Validation loss decreased (-0.855552 --> -0.861108).  Saving model ...
Epoch: 15 cost time: 0.7177395820617676
Epoch: 15, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.327 Vali Acc: 0.894 Test Loss: 0.327 Test Acc: 0.894
Validation loss decreased (-0.861108 --> -0.894441).  Saving model ...
Epoch: 16 cost time: 0.8414998054504395
Epoch: 16, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6992325782775879
Epoch: 17, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.894441 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 0.7523231506347656
Epoch: 18, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.260 Vali Acc: 0.906 Test Loss: 0.260 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6496760845184326
Epoch: 19, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.235 Vali Acc: 0.906 Test Loss: 0.235 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6953792572021484
Epoch: 20, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.227 Vali Acc: 0.928 Test Loss: 0.227 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927776).  Saving model ...
Epoch: 21 cost time: 0.6310856342315674
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.222 Vali Acc: 0.928 Test Loss: 0.222 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 22 cost time: 0.7051181793212891
Epoch: 22, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.8343939781188965
Epoch: 23, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.863161563873291
Epoch: 24, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.221 Vali Acc: 0.917 Test Loss: 0.221 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6084568500518799
Epoch: 25, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.806044340133667
Epoch: 26, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7566876411437988
Epoch: 27, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7895886898040771
Epoch: 28, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9523282051086426
Epoch: 29, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.303 Vali Acc: 0.906 Test Loss: 0.303 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.81022047996521
Epoch: 30, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7878923416137695
Epoch: 31, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6597309112548828
Epoch: 32, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.270 Vali Acc: 0.928 Test Loss: 0.270 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9333333333333333
model parameter : 19570
model size : 0.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.26713228225708
Epoch: 1, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.675 Vali Acc: 0.244 Test Loss: 1.675 Test Acc: 0.244
Validation loss decreased (inf --> -0.244428).  Saving model ...
Epoch: 2 cost time: 0.9513053894042969
Epoch: 2, Steps: 12 | Train Loss: 1.620 Vali Loss: 1.494 Vali Acc: 0.456 Test Loss: 1.494 Test Acc: 0.456
Validation loss decreased (-0.244428 --> -0.455541).  Saving model ...
Epoch: 3 cost time: 0.6898295879364014
Epoch: 3, Steps: 12 | Train Loss: 1.393 Vali Loss: 1.291 Vali Acc: 0.583 Test Loss: 1.291 Test Acc: 0.583
Validation loss decreased (-0.455541 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.7895517349243164
Epoch: 4, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.092 Vali Acc: 0.672 Test Loss: 1.092 Test Acc: 0.672
Validation loss decreased (-0.583320 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.7962324619293213
Epoch: 5, Steps: 12 | Train Loss: 0.971 Vali Loss: 0.915 Vali Acc: 0.700 Test Loss: 0.915 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 0.7246041297912598
Epoch: 6, Steps: 12 | Train Loss: 0.803 Vali Loss: 0.781 Vali Acc: 0.717 Test Loss: 0.781 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 0.7843759059906006
Epoch: 7, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.675 Vali Acc: 0.761 Test Loss: 0.675 Test Acc: 0.761
Validation loss decreased (-0.716659 --> -0.761104).  Saving model ...
Epoch: 8 cost time: 0.793820858001709
Epoch: 8, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.599 Vali Acc: 0.761 Test Loss: 0.599 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.7369673252105713
Epoch: 9, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.529 Vali Acc: 0.772 Test Loss: 0.529 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 10 cost time: 0.7053914070129395
Epoch: 10, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.474 Vali Acc: 0.806 Test Loss: 0.474 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805551).  Saving model ...
Epoch: 11 cost time: 0.7533290386199951
Epoch: 11, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.430 Vali Acc: 0.833 Test Loss: 0.430 Test Acc: 0.833
Validation loss decreased (-0.805551 --> -0.833329).  Saving model ...
Epoch: 12 cost time: 0.7324321269989014
Epoch: 12, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.385 Vali Acc: 0.833 Test Loss: 0.385 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 13 cost time: 0.8910706043243408
Epoch: 13, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.357 Vali Acc: 0.872 Test Loss: 0.357 Test Acc: 0.872
Validation loss decreased (-0.833329 --> -0.872219).  Saving model ...
Epoch: 14 cost time: 0.6813812255859375
Epoch: 14, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.313 Vali Acc: 0.900 Test Loss: 0.313 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 0.8602972030639648
Epoch: 15, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.286 Vali Acc: 0.917 Test Loss: 0.286 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.6356148719787598
Epoch: 16, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 17 cost time: 0.8799610137939453
Epoch: 17, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.260 Vali Acc: 0.917 Test Loss: 0.260 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8552420139312744
Epoch: 18, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 19 cost time: 0.8480143547058105
Epoch: 19, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.232 Vali Acc: 0.900 Test Loss: 0.232 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8599774837493896
Epoch: 20, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.927775 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.652599573135376
Epoch: 21, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6970698833465576
Epoch: 22, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.292 Vali Acc: 0.894 Test Loss: 0.292 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.898280143737793
Epoch: 23, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9409103393554688
Epoch: 24, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8113343715667725
Epoch: 25, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.211 Vali Acc: 0.928 Test Loss: 0.211 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6870682239532471
Epoch: 26, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7239127159118652
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.323 Vali Acc: 0.894 Test Loss: 0.323 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7296051979064941
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.257 Vali Acc: 0.917 Test Loss: 0.257 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8524336814880371
Epoch: 29, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8186466693878174
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 18957
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8449912071228027
Epoch: 1, Steps: 12 | Train Loss: 1.720 Vali Loss: 1.630 Vali Acc: 0.378 Test Loss: 1.630 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.6714584827423096
Epoch: 2, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.462 Vali Acc: 0.461 Test Loss: 1.462 Test Acc: 0.461
Validation loss decreased (-0.377761 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.6936469078063965
Epoch: 3, Steps: 12 | Train Loss: 1.388 Vali Loss: 1.269 Vali Acc: 0.583 Test Loss: 1.269 Test Acc: 0.583
Validation loss decreased (-0.461096 --> -0.583321).  Saving model ...
Epoch: 4 cost time: 0.6450695991516113
Epoch: 4, Steps: 12 | Train Loss: 1.171 Vali Loss: 1.077 Vali Acc: 0.661 Test Loss: 1.077 Test Acc: 0.661
Validation loss decreased (-0.583321 --> -0.661100).  Saving model ...
Epoch: 5 cost time: 0.7408998012542725
Epoch: 5, Steps: 12 | Train Loss: 0.959 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
Validation loss decreased (-0.661100 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.5722053050994873
Epoch: 6, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.789 Vali Acc: 0.733 Test Loss: 0.789 Test Acc: 0.733
Validation loss decreased (-0.694435 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 0.7322282791137695
Epoch: 7, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.688 Vali Acc: 0.711 Test Loss: 0.688 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8435003757476807
Epoch: 8, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.615 Vali Acc: 0.756 Test Loss: 0.615 Test Acc: 0.756
Validation loss decreased (-0.733325 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.8363957405090332
Epoch: 9, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.563 Vali Acc: 0.756 Test Loss: 0.563 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.7157950401306152
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.516 Vali Acc: 0.750 Test Loss: 0.516 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8069159984588623
Epoch: 11, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.485 Vali Acc: 0.750 Test Loss: 0.485 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7001914978027344
Epoch: 12, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.452 Vali Acc: 0.806 Test Loss: 0.452 Test Acc: 0.806
Validation loss decreased (-0.755550 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 0.6870560646057129
Epoch: 13, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.426 Vali Acc: 0.811 Test Loss: 0.426 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.703728199005127
Epoch: 14, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.401 Vali Acc: 0.822 Test Loss: 0.401 Test Acc: 0.822
Validation loss decreased (-0.811107 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 0.7929136753082275
Epoch: 15, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.382 Vali Acc: 0.844 Test Loss: 0.382 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844441).  Saving model ...
Epoch: 16 cost time: 0.7830345630645752
Epoch: 16, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.368 Vali Acc: 0.839 Test Loss: 0.368 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8264305591583252
Epoch: 17, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.353 Vali Acc: 0.844 Test Loss: 0.353 Test Acc: 0.844
Validation loss decreased (-0.844441 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 0.7022855281829834
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.329 Vali Acc: 0.850 Test Loss: 0.329 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 19 cost time: 0.6956362724304199
Epoch: 19, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.313 Vali Acc: 0.850 Test Loss: 0.313 Test Acc: 0.850
Validation loss decreased (-0.849997 --> -0.849997).  Saving model ...
Epoch: 20 cost time: 0.8846423625946045
Epoch: 20, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.305 Vali Acc: 0.861 Test Loss: 0.305 Test Acc: 0.861
Validation loss decreased (-0.849997 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 0.8663346767425537
Epoch: 21, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.308 Vali Acc: 0.856 Test Loss: 0.308 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8373386859893799
Epoch: 22, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.276 Vali Acc: 0.856 Test Loss: 0.276 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7337832450866699
Epoch: 23, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.272 Vali Acc: 0.878 Test Loss: 0.272 Test Acc: 0.878
Validation loss decreased (-0.861108 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 0.6929357051849365
Epoch: 24, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.238 Vali Acc: 0.900 Test Loss: 0.238 Test Acc: 0.900
Validation loss decreased (-0.877775 --> -0.899998).  Saving model ...
Epoch: 25 cost time: 0.6247513294219971
Epoch: 25, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.241 Vali Acc: 0.883 Test Loss: 0.241 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7787704467773438
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.894 Test Loss: 0.246 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7591404914855957
Epoch: 27, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
Validation loss decreased (-0.899998 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 0.8487167358398438
Epoch: 28, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8426187038421631
Epoch: 29, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9365065097808838
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7415308952331543
Epoch: 31, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.346 Vali Acc: 0.894 Test Loss: 0.346 Test Acc: 0.894
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7019295692443848
Epoch: 32, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.291 Vali Acc: 0.928 Test Loss: 0.291 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7296302318572998
Epoch: 33, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7571401596069336
Epoch: 34, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.318 Vali Acc: 0.928 Test Loss: 0.318 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6998214721679688
Epoch: 35, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.928 Test Loss: 0.347 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8282248973846436
Epoch: 36, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.369 Vali Acc: 0.922 Test Loss: 0.369 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7132761478424072
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.390 Vali Acc: 0.928 Test Loss: 0.390 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9277777777777778
model parameter : 18770
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0065724849700928
Epoch: 1, Steps: 12 | Train Loss: 1.701 Vali Loss: 1.638 Vali Acc: 0.250 Test Loss: 1.638 Test Acc: 0.250
Validation loss decreased (inf --> -0.249984).  Saving model ...
Epoch: 2 cost time: 0.7116038799285889
Epoch: 2, Steps: 12 | Train Loss: 1.565 Vali Loss: 1.477 Vali Acc: 0.467 Test Loss: 1.477 Test Acc: 0.467
Validation loss decreased (-0.249984 --> -0.466652).  Saving model ...
Epoch: 3 cost time: 1.0892090797424316
Epoch: 3, Steps: 12 | Train Loss: 1.367 Vali Loss: 1.290 Vali Acc: 0.617 Test Loss: 1.290 Test Acc: 0.617
Validation loss decreased (-0.466652 --> -0.616654).  Saving model ...
Epoch: 4 cost time: 0.797283411026001
Epoch: 4, Steps: 12 | Train Loss: 1.181 Vali Loss: 1.106 Vali Acc: 0.678 Test Loss: 1.106 Test Acc: 0.678
Validation loss decreased (-0.616654 --> -0.677767).  Saving model ...
Epoch: 5 cost time: 0.7066726684570312
Epoch: 5, Steps: 12 | Train Loss: 0.995 Vali Loss: 0.940 Vali Acc: 0.694 Test Loss: 0.940 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.780536413192749
Epoch: 6, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.814 Vali Acc: 0.700 Test Loss: 0.814 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699992).  Saving model ...
Epoch: 7 cost time: 0.6704561710357666
Epoch: 7, Steps: 12 | Train Loss: 0.707 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
Validation loss decreased (-0.699992 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 0.6204442977905273
Epoch: 8, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.635 Vali Acc: 0.733 Test Loss: 0.635 Test Acc: 0.733
Validation loss decreased (-0.711104 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.6813781261444092
Epoch: 9, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.578 Vali Acc: 0.739 Test Loss: 0.578 Test Acc: 0.739
Validation loss decreased (-0.733327 --> -0.738883).  Saving model ...
Epoch: 10 cost time: 0.8694875240325928
Epoch: 10, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.520 Vali Acc: 0.794 Test Loss: 0.520 Test Acc: 0.794
Validation loss decreased (-0.738883 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 0.6104474067687988
Epoch: 11, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.475 Vali Acc: 0.817 Test Loss: 0.475 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 0.6852502822875977
Epoch: 12, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.436 Vali Acc: 0.817 Test Loss: 0.436 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.7134897708892822
Epoch: 13, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.406 Vali Acc: 0.828 Test Loss: 0.406 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 0.6290311813354492
Epoch: 14, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.375 Vali Acc: 0.817 Test Loss: 0.375 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7443552017211914
Epoch: 15, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.332 Vali Acc: 0.878 Test Loss: 0.332 Test Acc: 0.878
Validation loss decreased (-0.827774 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 0.7029571533203125
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.306 Vali Acc: 0.883 Test Loss: 0.306 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.6426236629486084
Epoch: 17, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 18 cost time: 0.8136343955993652
Epoch: 18, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.259 Vali Acc: 0.906 Test Loss: 0.259 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 19 cost time: 0.9652612209320068
Epoch: 19, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.246 Vali Acc: 0.900 Test Loss: 0.246 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8060469627380371
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.250 Vali Acc: 0.889 Test Loss: 0.250 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7583396434783936
Epoch: 21, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.282 Vali Acc: 0.883 Test Loss: 0.282 Test Acc: 0.883
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8673348426818848
Epoch: 22, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.237 Vali Acc: 0.917 Test Loss: 0.237 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7894694805145264
Epoch: 23, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.7991108894348145
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7571287155151367
Epoch: 25, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.342 Vali Acc: 0.906 Test Loss: 0.342 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6580281257629395
Epoch: 26, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6586527824401855
Epoch: 27, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.382 Vali Acc: 0.883 Test Loss: 0.382 Test Acc: 0.883
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6317830085754395
Epoch: 28, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6507043838500977
Epoch: 29, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.375 Vali Acc: 0.883 Test Loss: 0.375 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.771561861038208
Epoch: 30, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6750922203063965
Epoch: 31, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.506 Vali Acc: 0.883 Test Loss: 0.506 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6851940155029297
Epoch: 32, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.383 Vali Acc: 0.894 Test Loss: 0.383 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6482274532318115
Epoch: 33, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.527 Vali Acc: 0.889 Test Loss: 0.527 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 18817
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4803600311279297
Epoch: 1, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.596 Vali Acc: 0.311 Test Loss: 1.596 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.7719688415527344
Epoch: 2, Steps: 12 | Train Loss: 1.589 Vali Loss: 1.444 Vali Acc: 0.428 Test Loss: 1.444 Test Acc: 0.428
Validation loss decreased (-0.311095 --> -0.427763).  Saving model ...
Epoch: 3 cost time: 0.7635998725891113
Epoch: 3, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.263 Vali Acc: 0.567 Test Loss: 1.263 Test Acc: 0.567
Validation loss decreased (-0.427763 --> -0.566654).  Saving model ...
Epoch: 4 cost time: 0.6759226322174072
Epoch: 4, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.086 Vali Acc: 0.622 Test Loss: 1.086 Test Acc: 0.622
Validation loss decreased (-0.566654 --> -0.622211).  Saving model ...
Epoch: 5 cost time: 0.7561676502227783
Epoch: 5, Steps: 12 | Train Loss: 0.985 Vali Loss: 0.937 Vali Acc: 0.650 Test Loss: 0.937 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649991).  Saving model ...
Epoch: 6 cost time: 0.878220796585083
Epoch: 6, Steps: 12 | Train Loss: 0.873 Vali Loss: 0.821 Vali Acc: 0.656 Test Loss: 0.821 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655547).  Saving model ...
Epoch: 7 cost time: 0.8388025760650635
Epoch: 7, Steps: 12 | Train Loss: 0.743 Vali Loss: 0.729 Vali Acc: 0.711 Test Loss: 0.729 Test Acc: 0.711
Validation loss decreased (-0.655547 --> -0.711104).  Saving model ...
Epoch: 8 cost time: 0.6974055767059326
Epoch: 8, Steps: 12 | Train Loss: 0.601 Vali Loss: 0.659 Vali Acc: 0.744 Test Loss: 0.659 Test Acc: 0.744
Validation loss decreased (-0.711104 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.6014981269836426
Epoch: 9, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.595 Vali Acc: 0.733 Test Loss: 0.595 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7791018486022949
Epoch: 10, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.545 Vali Acc: 0.778 Test Loss: 0.545 Test Acc: 0.778
Validation loss decreased (-0.744438 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 0.6960325241088867
Epoch: 11, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.505 Vali Acc: 0.789 Test Loss: 0.505 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 0.7411048412322998
Epoch: 12, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.473 Vali Acc: 0.806 Test Loss: 0.473 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 0.7726686000823975
Epoch: 13, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.439 Vali Acc: 0.828 Test Loss: 0.439 Test Acc: 0.828
Validation loss decreased (-0.805551 --> -0.827773).  Saving model ...
Epoch: 14 cost time: 0.7679738998413086
Epoch: 14, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.408 Vali Acc: 0.817 Test Loss: 0.408 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7132158279418945
Epoch: 15, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.382 Vali Acc: 0.861 Test Loss: 0.382 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 0.704521656036377
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.356 Vali Acc: 0.861 Test Loss: 0.356 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 0.7176980972290039
Epoch: 17, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
Validation loss decreased (-0.861108 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.8355293273925781
Epoch: 18, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.304 Vali Acc: 0.867 Test Loss: 0.304 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8035399913787842
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 20 cost time: 0.8248767852783203
Epoch: 20, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.260 Vali Acc: 0.883 Test Loss: 0.260 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.767533540725708
Epoch: 21, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.240 Vali Acc: 0.928 Test Loss: 0.240 Test Acc: 0.928
Validation loss decreased (-0.894442 --> -0.927775).  Saving model ...
Epoch: 22 cost time: 0.7844035625457764
Epoch: 22, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.882448673248291
Epoch: 23, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8496720790863037
Epoch: 24, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.227 Vali Acc: 0.889 Test Loss: 0.227 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8199613094329834
Epoch: 25, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.196 Vali Acc: 0.917 Test Loss: 0.196 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8570554256439209
Epoch: 26, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 27 cost time: 0.8235893249511719
Epoch: 27, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8754837512969971
Epoch: 28, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.205 Vali Acc: 0.939 Test Loss: 0.205 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8415060043334961
Epoch: 29, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7425737380981445
Epoch: 30, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7104265689849854
Epoch: 31, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.928 Test Loss: 0.219 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6733536720275879
Epoch: 32, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.232 Vali Acc: 0.906 Test Loss: 0.232 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7162144184112549
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.329 Vali Acc: 0.906 Test Loss: 0.329 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6728956699371338
Epoch: 34, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7620043754577637
Epoch: 35, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6674017906188965
Epoch: 36, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18664
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0642054080963135
Epoch: 1, Steps: 12 | Train Loss: 1.728 Vali Loss: 1.710 Vali Acc: 0.244 Test Loss: 1.710 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.6034567356109619
Epoch: 2, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.544 Vali Acc: 0.444 Test Loss: 1.544 Test Acc: 0.444
Validation loss decreased (-0.244427 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.5824146270751953
Epoch: 3, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.343 Vali Acc: 0.561 Test Loss: 1.343 Test Acc: 0.561
Validation loss decreased (-0.444429 --> -0.561098).  Saving model ...
Epoch: 4 cost time: 0.6592202186584473
Epoch: 4, Steps: 12 | Train Loss: 1.206 Vali Loss: 1.147 Vali Acc: 0.639 Test Loss: 1.147 Test Acc: 0.639
Validation loss decreased (-0.561098 --> -0.638877).  Saving model ...
Epoch: 5 cost time: 0.6749439239501953
Epoch: 5, Steps: 12 | Train Loss: 1.025 Vali Loss: 0.981 Vali Acc: 0.650 Test Loss: 0.981 Test Acc: 0.650
Validation loss decreased (-0.638877 --> -0.649990).  Saving model ...
Epoch: 6 cost time: 0.7165324687957764
Epoch: 6, Steps: 12 | Train Loss: 0.847 Vali Loss: 0.841 Vali Acc: 0.711 Test Loss: 0.841 Test Acc: 0.711
Validation loss decreased (-0.649990 --> -0.711103).  Saving model ...
Epoch: 7 cost time: 0.6897342205047607
Epoch: 7, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.737 Vali Acc: 0.722 Test Loss: 0.737 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 0.6068639755249023
Epoch: 8, Steps: 12 | Train Loss: 0.593 Vali Loss: 0.656 Vali Acc: 0.744 Test Loss: 0.656 Test Acc: 0.744
Validation loss decreased (-0.722215 --> -0.744438).  Saving model ...
Epoch: 9 cost time: 0.5610654354095459
Epoch: 9, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.593 Vali Acc: 0.756 Test Loss: 0.593 Test Acc: 0.756
Validation loss decreased (-0.744438 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.6976900100708008
Epoch: 10, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.541 Vali Acc: 0.772 Test Loss: 0.541 Test Acc: 0.772
Validation loss decreased (-0.755550 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 0.7706766128540039
Epoch: 11, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.501 Vali Acc: 0.794 Test Loss: 0.501 Test Acc: 0.794
Validation loss decreased (-0.772217 --> -0.794439).  Saving model ...
Epoch: 12 cost time: 0.6350793838500977
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.461 Vali Acc: 0.817 Test Loss: 0.461 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.6711275577545166
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.429 Vali Acc: 0.828 Test Loss: 0.429 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 14 cost time: 0.6774115562438965
Epoch: 14, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.396 Vali Acc: 0.861 Test Loss: 0.396 Test Acc: 0.861
Validation loss decreased (-0.827773 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.7000491619110107
Epoch: 15, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.371 Vali Acc: 0.850 Test Loss: 0.371 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7670092582702637
Epoch: 16, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.335 Vali Acc: 0.872 Test Loss: 0.335 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872219).  Saving model ...
Epoch: 17 cost time: 0.7466473579406738
Epoch: 17, Steps: 12 | Train Loss: 0.242 Vali Loss: 0.306 Vali Acc: 0.872 Test Loss: 0.306 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 0.6111350059509277
Epoch: 18, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.288 Vali Acc: 0.872 Test Loss: 0.288 Test Acc: 0.872
Validation loss decreased (-0.872219 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 0.8145525455474854
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.259 Vali Acc: 0.900 Test Loss: 0.259 Test Acc: 0.900
Validation loss decreased (-0.872219 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.7687668800354004
Epoch: 20, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.251 Vali Acc: 0.906 Test Loss: 0.251 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.7633399963378906
Epoch: 21, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.6783499717712402
Epoch: 22, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.222 Vali Acc: 0.917 Test Loss: 0.222 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6802487373352051
Epoch: 23, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938887).  Saving model ...
Epoch: 24 cost time: 0.7256600856781006
Epoch: 24, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8141047954559326
Epoch: 25, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 26 cost time: 0.6690096855163574
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.911 Test Loss: 0.193 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7136847972869873
Epoch: 27, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.187 Vali Acc: 0.922 Test Loss: 0.187 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7440247535705566
Epoch: 28, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.911 Test Loss: 0.220 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7853496074676514
Epoch: 29, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8175241947174072
Epoch: 30, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.269 Vali Acc: 0.906 Test Loss: 0.269 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7103686332702637
Epoch: 31, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.928 Test Loss: 0.218 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7077608108520508
Epoch: 32, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.254 Vali Acc: 0.917 Test Loss: 0.254 Test Acc: 0.917
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7188284397125244
Epoch: 33, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7228684425354004
Epoch: 34, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6809089183807373
Epoch: 35, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18732
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0988144874572754
Epoch: 1, Steps: 12 | Train Loss: 1.716 Vali Loss: 1.647 Vali Acc: 0.272 Test Loss: 1.647 Test Acc: 0.272
Validation loss decreased (inf --> -0.272206).  Saving model ...
Epoch: 2 cost time: 0.7085790634155273
Epoch: 2, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.485 Vali Acc: 0.583 Test Loss: 1.485 Test Acc: 0.583
Validation loss decreased (-0.272206 --> -0.583318).  Saving model ...
Epoch: 3 cost time: 0.76247239112854
Epoch: 3, Steps: 12 | Train Loss: 1.376 Vali Loss: 1.283 Vali Acc: 0.650 Test Loss: 1.283 Test Acc: 0.650
Validation loss decreased (-0.583318 --> -0.649987).  Saving model ...
Epoch: 4 cost time: 0.5982038974761963
Epoch: 4, Steps: 12 | Train Loss: 1.186 Vali Loss: 1.106 Vali Acc: 0.672 Test Loss: 1.106 Test Acc: 0.672
Validation loss decreased (-0.649987 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.6489036083221436
Epoch: 5, Steps: 12 | Train Loss: 0.958 Vali Loss: 0.941 Vali Acc: 0.700 Test Loss: 0.941 Test Acc: 0.700
Validation loss decreased (-0.672211 --> -0.699991).  Saving model ...
Epoch: 6 cost time: 0.6434860229492188
Epoch: 6, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.803 Vali Acc: 0.717 Test Loss: 0.803 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716659).  Saving model ...
Epoch: 7 cost time: 0.6421723365783691
Epoch: 7, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.696 Vali Acc: 0.728 Test Loss: 0.696 Test Acc: 0.728
Validation loss decreased (-0.716659 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.7505152225494385
Epoch: 8, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.614 Vali Acc: 0.733 Test Loss: 0.614 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 9 cost time: 0.6793673038482666
Epoch: 9, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.546 Vali Acc: 0.756 Test Loss: 0.546 Test Acc: 0.756
Validation loss decreased (-0.733327 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.7022483348846436
Epoch: 10, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.486 Vali Acc: 0.767 Test Loss: 0.486 Test Acc: 0.767
Validation loss decreased (-0.755550 --> -0.766662).  Saving model ...
Epoch: 11 cost time: 0.8133144378662109
Epoch: 11, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.444 Vali Acc: 0.806 Test Loss: 0.444 Test Acc: 0.806
Validation loss decreased (-0.766662 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.7101709842681885
Epoch: 12, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.407 Vali Acc: 0.844 Test Loss: 0.407 Test Acc: 0.844
Validation loss decreased (-0.805551 --> -0.844440).  Saving model ...
Epoch: 13 cost time: 0.5724270343780518
Epoch: 13, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.368 Vali Acc: 0.844 Test Loss: 0.368 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 14 cost time: 0.6625754833221436
Epoch: 14, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.334 Vali Acc: 0.850 Test Loss: 0.334 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849997).  Saving model ...
Epoch: 15 cost time: 0.6766564846038818
Epoch: 15, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.321 Vali Acc: 0.872 Test Loss: 0.321 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 0.6731259822845459
Epoch: 16, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.297 Vali Acc: 0.883 Test Loss: 0.297 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.7421174049377441
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 18 cost time: 0.6525695323944092
Epoch: 18, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911109).  Saving model ...
Epoch: 19 cost time: 0.569439172744751
Epoch: 19, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.6426060199737549
Epoch: 20, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5852522850036621
Epoch: 21, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6612348556518555
Epoch: 22, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6408307552337646
Epoch: 23, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.7776672840118408
Epoch: 24, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7237515449523926
Epoch: 25, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6517846584320068
Epoch: 26, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.257 Vali Acc: 0.939 Test Loss: 0.257 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9161717891693115
Epoch: 27, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.305 Vali Acc: 0.928 Test Loss: 0.305 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7450799942016602
Epoch: 28, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8635165691375732
Epoch: 29, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7766902446746826
Epoch: 30, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.335 Vali Acc: 0.928 Test Loss: 0.335 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7071361541748047
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.928 Test Loss: 0.344 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.658738374710083
Epoch: 32, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.413 Vali Acc: 0.933 Test Loss: 0.413 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7717602252960205
Epoch: 33, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.392 Vali Acc: 0.939 Test Loss: 0.392 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 18702
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5184426307678223
Epoch: 1, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.693 Vali Acc: 0.250 Test Loss: 1.693 Test Acc: 0.250
Validation loss decreased (inf --> -0.249983).  Saving model ...
Epoch: 2 cost time: 0.8097100257873535
Epoch: 2, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.503 Vali Acc: 0.472 Test Loss: 1.503 Test Acc: 0.472
Validation loss decreased (-0.249983 --> -0.472207).  Saving model ...
Epoch: 3 cost time: 0.6423976421356201
Epoch: 3, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.287 Vali Acc: 0.678 Test Loss: 1.287 Test Acc: 0.678
Validation loss decreased (-0.472207 --> -0.677765).  Saving model ...
Epoch: 4 cost time: 0.6632626056671143
Epoch: 4, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.090 Vali Acc: 0.700 Test Loss: 1.090 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.8349113464355469
Epoch: 5, Steps: 12 | Train Loss: 0.960 Vali Loss: 0.919 Vali Acc: 0.728 Test Loss: 0.919 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727769).  Saving model ...
Epoch: 6 cost time: 0.7073147296905518
Epoch: 6, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.794 Vali Acc: 0.733 Test Loss: 0.794 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 0.8978722095489502
Epoch: 7, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.701 Vali Acc: 0.772 Test Loss: 0.701 Test Acc: 0.772
Validation loss decreased (-0.733325 --> -0.772215).  Saving model ...
Epoch: 8 cost time: 0.8385312557220459
Epoch: 8, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.622 Vali Acc: 0.772 Test Loss: 0.622 Test Acc: 0.772
Validation loss decreased (-0.772215 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 0.7623114585876465
Epoch: 9, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.566 Vali Acc: 0.778 Test Loss: 0.566 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 0.6868982315063477
Epoch: 10, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.515 Vali Acc: 0.800 Test Loss: 0.515 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.7609302997589111
Epoch: 11, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6712925434112549
Epoch: 12, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.426 Vali Acc: 0.839 Test Loss: 0.426 Test Acc: 0.839
Validation loss decreased (-0.799995 --> -0.838885).  Saving model ...
Epoch: 13 cost time: 0.853968620300293
Epoch: 13, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
Validation loss decreased (-0.838885 --> -0.849996).  Saving model ...
Epoch: 14 cost time: 0.7013232707977295
Epoch: 14, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.338 Vali Acc: 0.872 Test Loss: 0.338 Test Acc: 0.872
Validation loss decreased (-0.849996 --> -0.872219).  Saving model ...
Epoch: 15 cost time: 0.749610185623169
Epoch: 15, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 0.6309971809387207
Epoch: 16, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.267 Vali Acc: 0.889 Test Loss: 0.267 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.692680835723877
Epoch: 17, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.237 Vali Acc: 0.939 Test Loss: 0.237 Test Acc: 0.939
Validation loss decreased (-0.888886 --> -0.938887).  Saving model ...
Epoch: 18 cost time: 0.73514723777771
Epoch: 18, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 19 cost time: 0.7131071090698242
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8160743713378906
Epoch: 20, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.211 Vali Acc: 0.911 Test Loss: 0.211 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7895076274871826
Epoch: 21, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7625682353973389
Epoch: 22, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8317050933837891
Epoch: 23, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
Validation loss decreased (-0.944442 --> -0.961109).  Saving model ...
Epoch: 24 cost time: 0.7195310592651367
Epoch: 24, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7450337409973145
Epoch: 25, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6450209617614746
Epoch: 26, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.234 Vali Acc: 0.950 Test Loss: 0.234 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7146496772766113
Epoch: 27, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.283 Vali Acc: 0.917 Test Loss: 0.283 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6921994686126709
Epoch: 28, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6975884437561035
Epoch: 29, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6479611396789551
Epoch: 30, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7575085163116455
Epoch: 31, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.305 Vali Acc: 0.906 Test Loss: 0.305 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6297619342803955
Epoch: 32, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6603777408599854
Epoch: 33, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 18574
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0877931118011475
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.718 Vali Acc: 0.211 Test Loss: 1.718 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.7017021179199219
Epoch: 2, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.541 Vali Acc: 0.417 Test Loss: 1.541 Test Acc: 0.417
Validation loss decreased (-0.211094 --> -0.416651).  Saving model ...
Epoch: 3 cost time: 0.5845129489898682
Epoch: 3, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.345 Vali Acc: 0.583 Test Loss: 1.345 Test Acc: 0.583
Validation loss decreased (-0.416651 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.6376593112945557
Epoch: 4, Steps: 12 | Train Loss: 1.241 Vali Loss: 1.158 Vali Acc: 0.650 Test Loss: 1.158 Test Acc: 0.650
Validation loss decreased (-0.583320 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.6590631008148193
Epoch: 5, Steps: 12 | Train Loss: 1.017 Vali Loss: 0.993 Vali Acc: 0.694 Test Loss: 0.993 Test Acc: 0.694
Validation loss decreased (-0.649988 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.6856029033660889
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.850 Vali Acc: 0.722 Test Loss: 0.850 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.670731782913208
Epoch: 7, Steps: 12 | Train Loss: 0.719 Vali Loss: 0.746 Vali Acc: 0.750 Test Loss: 0.746 Test Acc: 0.750
Validation loss decreased (-0.722214 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.6609375476837158
Epoch: 8, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.7682094573974609
Epoch: 9, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.602 Vali Acc: 0.756 Test Loss: 0.602 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.8811256885528564
Epoch: 10, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.549 Vali Acc: 0.778 Test Loss: 0.549 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 0.803699254989624
Epoch: 11, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.505 Vali Acc: 0.806 Test Loss: 0.505 Test Acc: 0.806
Validation loss decreased (-0.777772 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.9311950206756592
Epoch: 12, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.469 Vali Acc: 0.822 Test Loss: 0.469 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.8723845481872559
Epoch: 13, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8351459503173828
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.413 Vali Acc: 0.833 Test Loss: 0.413 Test Acc: 0.833
Validation loss decreased (-0.822218 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.8230102062225342
Epoch: 15, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.388 Vali Acc: 0.850 Test Loss: 0.388 Test Acc: 0.850
Validation loss decreased (-0.833329 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.7504715919494629
Epoch: 16, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.369 Vali Acc: 0.811 Test Loss: 0.369 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9006330966949463
Epoch: 17, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.342 Vali Acc: 0.850 Test Loss: 0.342 Test Acc: 0.850
Validation loss decreased (-0.849996 --> -0.849997).  Saving model ...
Epoch: 18 cost time: 0.845118522644043
Epoch: 18, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.327 Vali Acc: 0.872 Test Loss: 0.327 Test Acc: 0.872
Validation loss decreased (-0.849997 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 0.7570817470550537
Epoch: 19, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.291 Vali Acc: 0.878 Test Loss: 0.291 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 20 cost time: 0.735720157623291
Epoch: 20, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.275 Vali Acc: 0.872 Test Loss: 0.275 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.638864278793335
Epoch: 21, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.260 Vali Acc: 0.894 Test Loss: 0.260 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894442).  Saving model ...
Epoch: 22 cost time: 0.6477828025817871
Epoch: 22, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8182177543640137
Epoch: 23, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.228 Vali Acc: 0.906 Test Loss: 0.228 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 0.7233331203460693
Epoch: 24, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.223 Vali Acc: 0.917 Test Loss: 0.223 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6706275939941406
Epoch: 25, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.195 Vali Acc: 0.911 Test Loss: 0.195 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7079553604125977
Epoch: 26, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5765862464904785
Epoch: 27, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.6545567512512207
Epoch: 28, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8319785594940186
Epoch: 29, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.7496547698974609
Epoch: 30, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7551732063293457
Epoch: 31, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.223 Vali Acc: 0.928 Test Loss: 0.223 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8232975006103516
Epoch: 32, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.208 Vali Acc: 0.950 Test Loss: 0.208 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 33 cost time: 0.6691806316375732
Epoch: 33, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9941098690032959
Epoch: 34, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.765716552734375
Epoch: 35, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8052663803100586
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8292820453643799
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.8051538467407227
Epoch: 38, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8081016540527344
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8436243534088135
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.7515435218811035
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.270 Vali Acc: 0.950 Test Loss: 0.270 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7135059833526611
Epoch: 42, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 18649
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.156139373779297
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.688 Vali Acc: 0.339 Test Loss: 1.688 Test Acc: 0.339
Validation loss decreased (inf --> -0.338872).  Saving model ...
Epoch: 2 cost time: 0.632277250289917
Epoch: 2, Steps: 12 | Train Loss: 1.602 Vali Loss: 1.517 Vali Acc: 0.506 Test Loss: 1.517 Test Acc: 0.506
Validation loss decreased (-0.338872 --> -0.505540).  Saving model ...
Epoch: 3 cost time: 0.6962206363677979
Epoch: 3, Steps: 12 | Train Loss: 1.420 Vali Loss: 1.313 Vali Acc: 0.633 Test Loss: 1.313 Test Acc: 0.633
Validation loss decreased (-0.505540 --> -0.633320).  Saving model ...
Epoch: 4 cost time: 0.7206137180328369
Epoch: 4, Steps: 12 | Train Loss: 1.218 Vali Loss: 1.116 Vali Acc: 0.672 Test Loss: 1.116 Test Acc: 0.672
Validation loss decreased (-0.633320 --> -0.672211).  Saving model ...
Epoch: 5 cost time: 0.7741994857788086
Epoch: 5, Steps: 12 | Train Loss: 1.018 Vali Loss: 0.946 Vali Acc: 0.728 Test Loss: 0.946 Test Acc: 0.728
Validation loss decreased (-0.672211 --> -0.727768).  Saving model ...
Epoch: 6 cost time: 0.7152204513549805
Epoch: 6, Steps: 12 | Train Loss: 0.830 Vali Loss: 0.814 Vali Acc: 0.733 Test Loss: 0.814 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 0.6202666759490967
Epoch: 7, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
Validation loss decreased (-0.733325 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.7212963104248047
Epoch: 8, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.629 Vali Acc: 0.767 Test Loss: 0.629 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 9 cost time: 0.8931639194488525
Epoch: 9, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.562 Vali Acc: 0.778 Test Loss: 0.562 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 0.7798349857330322
Epoch: 10, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.507 Vali Acc: 0.794 Test Loss: 0.507 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794439).  Saving model ...
Epoch: 11 cost time: 0.7549612522125244
Epoch: 11, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.459 Vali Acc: 0.811 Test Loss: 0.459 Test Acc: 0.811
Validation loss decreased (-0.794439 --> -0.811107).  Saving model ...
Epoch: 12 cost time: 0.7066450119018555
Epoch: 12, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.422 Vali Acc: 0.811 Test Loss: 0.422 Test Acc: 0.811
Validation loss decreased (-0.811107 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 0.6541388034820557
Epoch: 13, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.385 Vali Acc: 0.856 Test Loss: 0.385 Test Acc: 0.856
Validation loss decreased (-0.811107 --> -0.855552).  Saving model ...
Epoch: 14 cost time: 0.7164437770843506
Epoch: 14, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.346 Vali Acc: 0.850 Test Loss: 0.346 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8114326000213623
Epoch: 15, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.315 Vali Acc: 0.872 Test Loss: 0.315 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 16 cost time: 0.7736313343048096
Epoch: 16, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
Validation loss decreased (-0.872219 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.6529452800750732
Epoch: 17, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905553).  Saving model ...
Epoch: 18 cost time: 0.6288201808929443
Epoch: 18, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 19 cost time: 0.5355205535888672
Epoch: 19, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.250 Vali Acc: 0.883 Test Loss: 0.250 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5981621742248535
Epoch: 20, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6477108001708984
Epoch: 21, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.234 Vali Acc: 0.906 Test Loss: 0.234 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8258438110351562
Epoch: 22, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7071781158447266
Epoch: 23, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.928 Test Loss: 0.246 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 24 cost time: 0.7003123760223389
Epoch: 24, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.339 Vali Acc: 0.906 Test Loss: 0.339 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6032283306121826
Epoch: 25, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.650015115737915
Epoch: 26, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7125599384307861
Epoch: 27, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7631418704986572
Epoch: 28, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.231 Vali Acc: 0.928 Test Loss: 0.231 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.7382597923278809
Epoch: 29, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7601678371429443
Epoch: 30, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.6976048946380615
Epoch: 31, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.284 Vali Acc: 0.939 Test Loss: 0.284 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 32 cost time: 0.7213160991668701
Epoch: 32, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.305 Vali Acc: 0.917 Test Loss: 0.305 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8983564376831055
Epoch: 33, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9251885414123535
Epoch: 34, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7524173259735107
Epoch: 35, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7281169891357422
Epoch: 36, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.352 Vali Acc: 0.928 Test Loss: 0.352 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6308302879333496
Epoch: 37, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6060559749603271
Epoch: 38, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7736945152282715
Epoch: 39, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.401 Vali Acc: 0.906 Test Loss: 0.401 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.645352840423584
Epoch: 40, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.466 Vali Acc: 0.917 Test Loss: 0.466 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7547049522399902
Epoch: 41, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 18536
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8452577590942383
Epoch: 1, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.636 Vali Acc: 0.378 Test Loss: 1.636 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.733206033706665
Epoch: 2, Steps: 12 | Train Loss: 1.551 Vali Loss: 1.475 Vali Acc: 0.544 Test Loss: 1.475 Test Acc: 0.544
Validation loss decreased (-0.377761 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.7081446647644043
Epoch: 3, Steps: 12 | Train Loss: 1.360 Vali Loss: 1.280 Vali Acc: 0.661 Test Loss: 1.280 Test Acc: 0.661
Validation loss decreased (-0.544430 --> -0.661098).  Saving model ...
Epoch: 4 cost time: 0.9817125797271729
Epoch: 4, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.089 Vali Acc: 0.722 Test Loss: 1.089 Test Acc: 0.722
Validation loss decreased (-0.661098 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 1.0230672359466553
Epoch: 5, Steps: 12 | Train Loss: 0.957 Vali Loss: 0.919 Vali Acc: 0.722 Test Loss: 0.919 Test Acc: 0.722
Validation loss decreased (-0.722211 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 0.8283085823059082
Epoch: 6, Steps: 12 | Train Loss: 0.819 Vali Loss: 0.784 Vali Acc: 0.717 Test Loss: 0.784 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7162880897521973
Epoch: 7, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.674 Vali Acc: 0.739 Test Loss: 0.674 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.6863424777984619
Epoch: 8, Steps: 12 | Train Loss: 0.535 Vali Loss: 0.589 Vali Acc: 0.756 Test Loss: 0.589 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 9 cost time: 0.6967113018035889
Epoch: 9, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.511 Vali Acc: 0.778 Test Loss: 0.511 Test Acc: 0.778
Validation loss decreased (-0.755550 --> -0.777773).  Saving model ...
Epoch: 10 cost time: 0.7754039764404297
Epoch: 10, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.449 Vali Acc: 0.794 Test Loss: 0.449 Test Acc: 0.794
Validation loss decreased (-0.777773 --> -0.794440).  Saving model ...
Epoch: 11 cost time: 0.66739821434021
Epoch: 11, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.393 Vali Acc: 0.856 Test Loss: 0.393 Test Acc: 0.856
Validation loss decreased (-0.794440 --> -0.855552).  Saving model ...
Epoch: 12 cost time: 0.6322691440582275
Epoch: 12, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.352 Vali Acc: 0.867 Test Loss: 0.352 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 13 cost time: 0.6549475193023682
Epoch: 13, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.321 Vali Acc: 0.850 Test Loss: 0.321 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6306717395782471
Epoch: 14, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.330 Vali Acc: 0.894 Test Loss: 0.330 Test Acc: 0.894
Validation loss decreased (-0.866663 --> -0.894441).  Saving model ...
Epoch: 15 cost time: 0.7847349643707275
Epoch: 15, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.268 Vali Acc: 0.917 Test Loss: 0.268 Test Acc: 0.917
Validation loss decreased (-0.894441 --> -0.916664).  Saving model ...
Epoch: 16 cost time: 0.7828483581542969
Epoch: 16, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.279 Vali Acc: 0.894 Test Loss: 0.279 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7968170642852783
Epoch: 17, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6688520908355713
Epoch: 18, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 19 cost time: 0.6589634418487549
Epoch: 19, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.6900067329406738
Epoch: 20, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.6913659572601318
Epoch: 21, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.599360466003418
Epoch: 22, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.244 Vali Acc: 0.917 Test Loss: 0.244 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.728792667388916
Epoch: 23, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.764686107635498
Epoch: 24, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7164187431335449
Epoch: 25, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6961028575897217
Epoch: 26, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6356136798858643
Epoch: 27, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7823669910430908
Epoch: 28, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.977963924407959
Epoch: 29, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7659351825714111
Epoch: 30, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.284 Vali Acc: 0.928 Test Loss: 0.284 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8426446914672852
Epoch: 31, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7212743759155273
Epoch: 32, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7820520401000977
Epoch: 33, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6586906909942627
Epoch: 34, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.8844900131225586
Epoch: 35, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7569453716278076
Epoch: 36, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.297 Vali Acc: 0.928 Test Loss: 0.297 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6572957038879395
Epoch: 37, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8576173782348633
Epoch: 38, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.379 Vali Acc: 0.928 Test Loss: 0.379 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7146003246307373
Epoch: 39, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.337 Vali Acc: 0.928 Test Loss: 0.337 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9218478202819824
Epoch: 40, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.933 Test Loss: 0.364 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8603098392486572
Epoch: 41, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.366 Vali Acc: 0.928 Test Loss: 0.366 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7753639221191406
Epoch: 42, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7592594623565674
Epoch: 43, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.439 Vali Acc: 0.933 Test Loss: 0.439 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8310201168060303
Epoch: 44, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.703 Vali Acc: 0.878 Test Loss: 0.703 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm128_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 18677
model size : 0.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3647513389587402
Epoch: 1, Steps: 12 | Train Loss: 1.815 Vali Loss: 1.753 Vali Acc: 0.217 Test Loss: 1.753 Test Acc: 0.217
Validation loss decreased (inf --> -0.216649).  Saving model ...
Epoch: 2 cost time: 0.7230241298675537
Epoch: 2, Steps: 12 | Train Loss: 1.654 Vali Loss: 1.564 Vali Acc: 0.383 Test Loss: 1.564 Test Acc: 0.383
Validation loss decreased (-0.216649 --> -0.383318).  Saving model ...
Epoch: 3 cost time: 0.7518513202667236
Epoch: 3, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.340 Vali Acc: 0.572 Test Loss: 1.340 Test Acc: 0.572
Validation loss decreased (-0.383318 --> -0.572209).  Saving model ...
Epoch: 4 cost time: 0.8282463550567627
Epoch: 4, Steps: 12 | Train Loss: 1.223 Vali Loss: 1.132 Vali Acc: 0.606 Test Loss: 1.132 Test Acc: 0.606
Validation loss decreased (-0.572209 --> -0.605544).  Saving model ...
Epoch: 5 cost time: 0.8193554878234863
Epoch: 5, Steps: 12 | Train Loss: 1.034 Vali Loss: 0.964 Vali Acc: 0.678 Test Loss: 0.964 Test Acc: 0.678
Validation loss decreased (-0.605544 --> -0.677768).  Saving model ...
Epoch: 6 cost time: 0.7846617698669434
Epoch: 6, Steps: 12 | Train Loss: 0.860 Vali Loss: 0.824 Vali Acc: 0.722 Test Loss: 0.824 Test Acc: 0.722
Validation loss decreased (-0.677768 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.927736759185791
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.720 Vali Acc: 0.733 Test Loss: 0.720 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.6582098007202148
Epoch: 8, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.644 Vali Acc: 0.756 Test Loss: 0.644 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 1.1060750484466553
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.583 Vali Acc: 0.744 Test Loss: 0.583 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7994444370269775
Epoch: 10, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.543 Vali Acc: 0.756 Test Loss: 0.543 Test Acc: 0.756
Validation loss decreased (-0.755549 --> -0.755550).  Saving model ...
Epoch: 11 cost time: 0.7520606517791748
Epoch: 11, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
Validation loss decreased (-0.755550 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 0.813298225402832
Epoch: 12, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.469 Vali Acc: 0.800 Test Loss: 0.469 Test Acc: 0.800
Validation loss decreased (-0.788884 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 0.7207729816436768
Epoch: 13, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.446 Vali Acc: 0.811 Test Loss: 0.446 Test Acc: 0.811
Validation loss decreased (-0.799995 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.8992984294891357
Epoch: 14, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.424 Vali Acc: 0.817 Test Loss: 0.424 Test Acc: 0.817
Validation loss decreased (-0.811107 --> -0.816662).  Saving model ...
Epoch: 15 cost time: 0.7836909294128418
Epoch: 15, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.404 Vali Acc: 0.828 Test Loss: 0.404 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827774).  Saving model ...
Epoch: 16 cost time: 0.9178330898284912
Epoch: 16, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.389 Vali Acc: 0.828 Test Loss: 0.389 Test Acc: 0.828
Validation loss decreased (-0.827774 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 0.6503958702087402
Epoch: 17, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.368 Vali Acc: 0.861 Test Loss: 0.368 Test Acc: 0.861
Validation loss decreased (-0.827774 --> -0.861107).  Saving model ...
Epoch: 18 cost time: 0.6369788646697998
Epoch: 18, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.360 Vali Acc: 0.833 Test Loss: 0.360 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5497961044311523
Epoch: 19, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.343 Vali Acc: 0.844 Test Loss: 0.343 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6194126605987549
Epoch: 20, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.330 Vali Acc: 0.878 Test Loss: 0.330 Test Acc: 0.878
Validation loss decreased (-0.861107 --> -0.877774).  Saving model ...
Epoch: 21 cost time: 0.630000114440918
Epoch: 21, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.314 Vali Acc: 0.850 Test Loss: 0.314 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.821892261505127
Epoch: 22, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7241456508636475
Epoch: 23, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.7559089660644531
Epoch: 24, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.286 Vali Acc: 0.867 Test Loss: 0.286 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5674021244049072
Epoch: 25, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.269 Vali Acc: 0.917 Test Loss: 0.269 Test Acc: 0.917
Validation loss decreased (-0.888886 --> -0.916664).  Saving model ...
Epoch: 26 cost time: 0.6290948390960693
Epoch: 26, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.259 Vali Acc: 0.878 Test Loss: 0.259 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7698280811309814
Epoch: 27, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.8477573394775391
Epoch: 28, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.233 Vali Acc: 0.889 Test Loss: 0.233 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7806880474090576
Epoch: 29, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.7900402545928955
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.7786111831665039
Epoch: 31, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.210 Vali Acc: 0.906 Test Loss: 0.210 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6966996192932129
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.189 Vali Acc: 0.939 Test Loss: 0.189 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 33 cost time: 0.8456130027770996
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
Validation loss decreased (-0.938887 --> -0.972220).  Saving model ...
Epoch: 34 cost time: 0.8020138740539551
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6618530750274658
Epoch: 35, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7942566871643066
Epoch: 36, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.586402177810669
Epoch: 37, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
Validation loss decreased (-0.972220 --> -0.972220).  Saving model ...
Epoch: 38 cost time: 0.683307409286499
Epoch: 38, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7292084693908691
Epoch: 39, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9120309352874756
Epoch: 40, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.740612268447876
Epoch: 41, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.950 Test Loss: 0.191 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9216523170471191
Epoch: 42, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.939 Test Loss: 0.226 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.655616283416748
Epoch: 43, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.217 Vali Acc: 0.950 Test Loss: 0.217 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5801246166229248
Epoch: 44, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7888593673706055
Epoch: 45, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6087853908538818
Epoch: 46, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.950 Test Loss: 0.261 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.7409148216247559
Epoch: 47, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.271 Vali Acc: 0.961 Test Loss: 0.271 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9722222222222222
model parameter : 13610
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9472248554229736
Epoch: 1, Steps: 12 | Train Loss: 1.785 Vali Loss: 1.722 Vali Acc: 0.267 Test Loss: 1.722 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.6626226902008057
Epoch: 2, Steps: 12 | Train Loss: 1.651 Vali Loss: 1.547 Vali Acc: 0.444 Test Loss: 1.547 Test Acc: 0.444
Validation loss decreased (-0.266649 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.706345796585083
Epoch: 3, Steps: 12 | Train Loss: 1.439 Vali Loss: 1.338 Vali Acc: 0.550 Test Loss: 1.338 Test Acc: 0.550
Validation loss decreased (-0.444429 --> -0.549987).  Saving model ...
Epoch: 4 cost time: 0.7773122787475586
Epoch: 4, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.133 Vali Acc: 0.656 Test Loss: 1.133 Test Acc: 0.656
Validation loss decreased (-0.549987 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.6961450576782227
Epoch: 5, Steps: 12 | Train Loss: 1.012 Vali Loss: 0.956 Vali Acc: 0.694 Test Loss: 0.956 Test Acc: 0.694
Validation loss decreased (-0.655544 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.6856601238250732
Epoch: 6, Steps: 12 | Train Loss: 0.855 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.7248847484588623
Epoch: 7, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.710 Vali Acc: 0.733 Test Loss: 0.710 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.699181318283081
Epoch: 8, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.630 Vali Acc: 0.761 Test Loss: 0.630 Test Acc: 0.761
Validation loss decreased (-0.733326 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.6018779277801514
Epoch: 9, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.568 Vali Acc: 0.756 Test Loss: 0.568 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7940826416015625
Epoch: 10, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.521 Vali Acc: 0.772 Test Loss: 0.521 Test Acc: 0.772
Validation loss decreased (-0.761105 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 0.6659989356994629
Epoch: 11, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
Validation loss decreased (-0.772217 --> -0.783328).  Saving model ...
Epoch: 12 cost time: 0.6736385822296143
Epoch: 12, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.450 Vali Acc: 0.811 Test Loss: 0.450 Test Acc: 0.811
Validation loss decreased (-0.783328 --> -0.811107).  Saving model ...
Epoch: 13 cost time: 0.6145920753479004
Epoch: 13, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.422 Vali Acc: 0.828 Test Loss: 0.422 Test Acc: 0.828
Validation loss decreased (-0.811107 --> -0.827774).  Saving model ...
Epoch: 14 cost time: 0.6054668426513672
Epoch: 14, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.397 Vali Acc: 0.822 Test Loss: 0.397 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6518876552581787
Epoch: 15, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.376 Vali Acc: 0.850 Test Loss: 0.376 Test Acc: 0.850
Validation loss decreased (-0.827774 --> -0.849996).  Saving model ...
Epoch: 16 cost time: 0.7959113121032715
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.359 Vali Acc: 0.861 Test Loss: 0.359 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861108).  Saving model ...
Epoch: 17 cost time: 0.6482820510864258
Epoch: 17, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.333 Vali Acc: 0.872 Test Loss: 0.333 Test Acc: 0.872
Validation loss decreased (-0.861108 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 0.7870373725891113
Epoch: 18, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
Validation loss decreased (-0.872219 --> -0.877775).  Saving model ...
Epoch: 19 cost time: 0.7433023452758789
Epoch: 19, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.306 Vali Acc: 0.894 Test Loss: 0.306 Test Acc: 0.894
Validation loss decreased (-0.877775 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 0.6367237567901611
Epoch: 20, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.281 Vali Acc: 0.906 Test Loss: 0.281 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905553).  Saving model ...
Epoch: 21 cost time: 0.6601712703704834
Epoch: 21, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.278 Vali Acc: 0.889 Test Loss: 0.278 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7514076232910156
Epoch: 22, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.276 Vali Acc: 0.917 Test Loss: 0.276 Test Acc: 0.917
Validation loss decreased (-0.905553 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.7071535587310791
Epoch: 23, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.273 Vali Acc: 0.894 Test Loss: 0.273 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6230721473693848
Epoch: 24, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7319626808166504
Epoch: 25, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.271 Vali Acc: 0.894 Test Loss: 0.271 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7463788986206055
Epoch: 26, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.8058829307556152
Epoch: 27, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.272 Vali Acc: 0.917 Test Loss: 0.272 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8014578819274902
Epoch: 28, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7030291557312012
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.301 Vali Acc: 0.917 Test Loss: 0.301 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5979259014129639
Epoch: 30, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
Validation loss decreased (-0.922220 --> -0.938886).  Saving model ...
Epoch: 31 cost time: 0.6619699001312256
Epoch: 31, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.322 Vali Acc: 0.906 Test Loss: 0.322 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.568610429763794
Epoch: 32, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6279046535491943
Epoch: 33, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.359 Vali Acc: 0.900 Test Loss: 0.359 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6556901931762695
Epoch: 34, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6625685691833496
Epoch: 35, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6327147483825684
Epoch: 36, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.324 Vali Acc: 0.928 Test Loss: 0.324 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7391722202301025
Epoch: 37, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7699098587036133
Epoch: 38, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.367 Vali Acc: 0.917 Test Loss: 0.367 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5941040515899658
Epoch: 39, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.321 Vali Acc: 0.917 Test Loss: 0.321 Test Acc: 0.917
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7168483734130859
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.552 Vali Acc: 0.894 Test Loss: 0.552 Test Acc: 0.894
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9388888888888889
model parameter : 13285
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1190366744995117
Epoch: 1, Steps: 12 | Train Loss: 1.773 Vali Loss: 1.699 Vali Acc: 0.178 Test Loss: 1.699 Test Acc: 0.178
Validation loss decreased (inf --> -0.177761).  Saving model ...
Epoch: 2 cost time: 0.8690650463104248
Epoch: 2, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.525 Vali Acc: 0.350 Test Loss: 1.525 Test Acc: 0.350
Validation loss decreased (-0.177761 --> -0.349985).  Saving model ...
Epoch: 3 cost time: 0.6856017112731934
Epoch: 3, Steps: 12 | Train Loss: 1.426 Vali Loss: 1.324 Vali Acc: 0.556 Test Loss: 1.324 Test Acc: 0.556
Validation loss decreased (-0.349985 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 0.7566609382629395
Epoch: 4, Steps: 12 | Train Loss: 1.215 Vali Loss: 1.134 Vali Acc: 0.639 Test Loss: 1.134 Test Acc: 0.639
Validation loss decreased (-0.555542 --> -0.638878).  Saving model ...
Epoch: 5 cost time: 0.65814208984375
Epoch: 5, Steps: 12 | Train Loss: 1.059 Vali Loss: 0.971 Vali Acc: 0.683 Test Loss: 0.971 Test Acc: 0.683
Validation loss decreased (-0.638878 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.7305078506469727
Epoch: 6, Steps: 12 | Train Loss: 0.857 Vali Loss: 0.837 Vali Acc: 0.672 Test Loss: 0.837 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7328372001647949
Epoch: 7, Steps: 12 | Train Loss: 0.757 Vali Loss: 0.734 Vali Acc: 0.739 Test Loss: 0.734 Test Acc: 0.739
Validation loss decreased (-0.683324 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.5756063461303711
Epoch: 8, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.657 Vali Acc: 0.711 Test Loss: 0.657 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8346586227416992
Epoch: 9, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.600 Vali Acc: 0.767 Test Loss: 0.600 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.6163942813873291
Epoch: 10, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.557 Vali Acc: 0.767 Test Loss: 0.557 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 0.7141289710998535
Epoch: 11, Steps: 12 | Train Loss: 0.484 Vali Loss: 0.515 Vali Acc: 0.794 Test Loss: 0.515 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 12 cost time: 0.6969811916351318
Epoch: 12, Steps: 12 | Train Loss: 0.422 Vali Loss: 0.478 Vali Acc: 0.806 Test Loss: 0.478 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 0.7024095058441162
Epoch: 13, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.455 Vali Acc: 0.794 Test Loss: 0.455 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.666489839553833
Epoch: 14, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.431 Vali Acc: 0.839 Test Loss: 0.431 Test Acc: 0.839
Validation loss decreased (-0.805551 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 0.6891546249389648
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.418 Vali Acc: 0.839 Test Loss: 0.418 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.7173149585723877
Epoch: 16, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.387 Vali Acc: 0.856 Test Loss: 0.387 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 17 cost time: 0.8223977088928223
Epoch: 17, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 0.6682846546173096
Epoch: 18, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.359 Vali Acc: 0.856 Test Loss: 0.359 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7941575050354004
Epoch: 19, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.343 Vali Acc: 0.883 Test Loss: 0.343 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 0.7458546161651611
Epoch: 20, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.330 Vali Acc: 0.883 Test Loss: 0.330 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 21 cost time: 0.6917238235473633
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7693066596984863
Epoch: 22, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 23 cost time: 0.8007035255432129
Epoch: 23, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.6724948883056641
Epoch: 24, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.263 Vali Acc: 0.878 Test Loss: 0.263 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7500870227813721
Epoch: 25, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.250 Vali Acc: 0.928 Test Loss: 0.250 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 26 cost time: 0.7162177562713623
Epoch: 26, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7656972408294678
Epoch: 27, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 28 cost time: 0.684281587600708
Epoch: 28, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.6785690784454346
Epoch: 29, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.7022747993469238
Epoch: 30, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6272437572479248
Epoch: 31, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 32 cost time: 0.7715799808502197
Epoch: 32, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6486446857452393
Epoch: 33, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7816853523254395
Epoch: 34, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.175 Vali Acc: 0.950 Test Loss: 0.175 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 35 cost time: 0.6548802852630615
Epoch: 35, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961109).  Saving model ...
Epoch: 36 cost time: 0.6122722625732422
Epoch: 36, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6551005840301514
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.717287540435791
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.939 Test Loss: 0.218 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6934959888458252
Epoch: 39, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7795050144195557
Epoch: 40, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.240 Vali Acc: 0.939 Test Loss: 0.240 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6328854560852051
Epoch: 41, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.1372692584991455
Epoch: 42, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8283195495605469
Epoch: 43, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.961 Test Loss: 0.236 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8117704391479492
Epoch: 44, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.272 Vali Acc: 0.939 Test Loss: 0.272 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7115905284881592
Epoch: 45, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 13226
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9767253398895264
Epoch: 1, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.742 Vali Acc: 0.261 Test Loss: 1.742 Test Acc: 0.261
Validation loss decreased (inf --> -0.261094).  Saving model ...
Epoch: 2 cost time: 0.6831424236297607
Epoch: 2, Steps: 12 | Train Loss: 1.665 Vali Loss: 1.577 Vali Acc: 0.394 Test Loss: 1.577 Test Acc: 0.394
Validation loss decreased (-0.261094 --> -0.394429).  Saving model ...
Epoch: 3 cost time: 0.6503088474273682
Epoch: 3, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.379 Vali Acc: 0.533 Test Loss: 1.379 Test Acc: 0.533
Validation loss decreased (-0.394429 --> -0.533320).  Saving model ...
Epoch: 4 cost time: 0.9046404361724854
Epoch: 4, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.182 Vali Acc: 0.650 Test Loss: 1.182 Test Acc: 0.650
Validation loss decreased (-0.533320 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.7364785671234131
Epoch: 5, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.013 Vali Acc: 0.667 Test Loss: 1.013 Test Acc: 0.667
Validation loss decreased (-0.649988 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.7742464542388916
Epoch: 6, Steps: 12 | Train Loss: 0.879 Vali Loss: 0.874 Vali Acc: 0.706 Test Loss: 0.874 Test Acc: 0.706
Validation loss decreased (-0.666657 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 0.7257680892944336
Epoch: 7, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.762 Vali Acc: 0.700 Test Loss: 0.762 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6441960334777832
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.683 Vali Acc: 0.733 Test Loss: 0.683 Test Acc: 0.733
Validation loss decreased (-0.705547 --> -0.733326).  Saving model ...
Epoch: 9 cost time: 0.6341063976287842
Epoch: 9, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.621 Vali Acc: 0.744 Test Loss: 0.621 Test Acc: 0.744
Validation loss decreased (-0.733326 --> -0.744438).  Saving model ...
Epoch: 10 cost time: 0.5911805629730225
Epoch: 10, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.573 Vali Acc: 0.767 Test Loss: 0.573 Test Acc: 0.767
Validation loss decreased (-0.744438 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 0.6958651542663574
Epoch: 11, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.536 Vali Acc: 0.750 Test Loss: 0.536 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6597986221313477
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.503 Vali Acc: 0.800 Test Loss: 0.503 Test Acc: 0.800
Validation loss decreased (-0.766661 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 0.7370991706848145
Epoch: 13, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.476 Vali Acc: 0.800 Test Loss: 0.476 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799995).  Saving model ...
Epoch: 14 cost time: 0.8330025672912598
Epoch: 14, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.446 Vali Acc: 0.822 Test Loss: 0.446 Test Acc: 0.822
Validation loss decreased (-0.799995 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 0.7226881980895996
Epoch: 15, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.423 Vali Acc: 0.817 Test Loss: 0.423 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6179249286651611
Epoch: 16, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.407 Vali Acc: 0.839 Test Loss: 0.407 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 17 cost time: 0.6891524791717529
Epoch: 17, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.393 Vali Acc: 0.833 Test Loss: 0.393 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6867575645446777
Epoch: 18, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.374 Vali Acc: 0.844 Test Loss: 0.374 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 19 cost time: 0.7039096355438232
Epoch: 19, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.353 Vali Acc: 0.889 Test Loss: 0.353 Test Acc: 0.889
Validation loss decreased (-0.844441 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.7843499183654785
Epoch: 20, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.341 Vali Acc: 0.883 Test Loss: 0.341 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5917303562164307
Epoch: 21, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6480669975280762
Epoch: 22, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.319 Vali Acc: 0.900 Test Loss: 0.319 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.654411792755127
Epoch: 23, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.6428897380828857
Epoch: 24, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6261045932769775
Epoch: 25, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.290 Vali Acc: 0.906 Test Loss: 0.290 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 26 cost time: 0.9713373184204102
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.283 Vali Acc: 0.878 Test Loss: 0.283 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7162399291992188
Epoch: 27, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6602249145507812
Epoch: 28, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 0.6537227630615234
Epoch: 29, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.249 Vali Acc: 0.906 Test Loss: 0.249 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6734745502471924
Epoch: 30, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 31 cost time: 0.7442800998687744
Epoch: 31, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7908754348754883
Epoch: 32, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.7431228160858154
Epoch: 33, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.224 Vali Acc: 0.928 Test Loss: 0.224 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 34 cost time: 0.6442279815673828
Epoch: 34, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.220 Vali Acc: 0.939 Test Loss: 0.220 Test Acc: 0.939
Validation loss decreased (-0.927776 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 0.6958153247833252
Epoch: 35, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 0.7454400062561035
Epoch: 36, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6648979187011719
Epoch: 37, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6438648700714111
Epoch: 38, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.6620032787322998
Epoch: 39, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.199 Vali Acc: 0.950 Test Loss: 0.199 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6601734161376953
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6738474369049072
Epoch: 41, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.6740505695343018
Epoch: 42, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6167342662811279
Epoch: 43, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6327753067016602
Epoch: 44, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.707261323928833
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6938533782958984
Epoch: 46, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7464113235473633
Epoch: 47, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7187550067901611
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.5520246028900146
Epoch: 49, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7398853302001953
Epoch: 50, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.939 Test Loss: 0.281 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.768455982208252
Epoch: 51, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.281 Vali Acc: 0.939 Test Loss: 0.281 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 13337
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.069888114929199
Epoch: 1, Steps: 12 | Train Loss: 1.865 Vali Loss: 1.778 Vali Acc: 0.161 Test Loss: 1.778 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.5636224746704102
Epoch: 2, Steps: 12 | Train Loss: 1.717 Vali Loss: 1.610 Vali Acc: 0.439 Test Loss: 1.610 Test Acc: 0.439
Validation loss decreased (-0.161093 --> -0.438873).  Saving model ...
Epoch: 3 cost time: 0.6598594188690186
Epoch: 3, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.406 Vali Acc: 0.639 Test Loss: 1.406 Test Acc: 0.639
Validation loss decreased (-0.438873 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 0.6255714893341064
Epoch: 4, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.207 Vali Acc: 0.694 Test Loss: 1.207 Test Acc: 0.694
Validation loss decreased (-0.638875 --> -0.694432).  Saving model ...
Epoch: 5 cost time: 0.6294529438018799
Epoch: 5, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.013 Vali Acc: 0.722 Test Loss: 1.013 Test Acc: 0.722
Validation loss decreased (-0.694432 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.5776605606079102
Epoch: 6, Steps: 12 | Train Loss: 0.920 Vali Loss: 0.859 Vali Acc: 0.722 Test Loss: 0.859 Test Acc: 0.722
Validation loss decreased (-0.722212 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.6789872646331787
Epoch: 7, Steps: 12 | Train Loss: 0.726 Vali Loss: 0.746 Vali Acc: 0.728 Test Loss: 0.746 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 0.6560776233673096
Epoch: 8, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.6829941272735596
Epoch: 9, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.597 Vali Acc: 0.744 Test Loss: 0.597 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6775054931640625
Epoch: 10, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 0.6547412872314453
Epoch: 11, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
Validation loss decreased (-0.783328 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 0.6381313800811768
Epoch: 12, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.479 Vali Acc: 0.778 Test Loss: 0.479 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7034556865692139
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.452 Vali Acc: 0.806 Test Loss: 0.452 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 14 cost time: 0.620835542678833
Epoch: 14, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.430 Vali Acc: 0.822 Test Loss: 0.430 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 0.6175727844238281
Epoch: 15, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.411 Vali Acc: 0.811 Test Loss: 0.411 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.700042724609375
Epoch: 16, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.389 Vali Acc: 0.850 Test Loss: 0.389 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 17 cost time: 0.6313049793243408
Epoch: 17, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.374 Vali Acc: 0.856 Test Loss: 0.374 Test Acc: 0.856
Validation loss decreased (-0.849996 --> -0.855552).  Saving model ...
Epoch: 18 cost time: 0.7180137634277344
Epoch: 18, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.358 Vali Acc: 0.867 Test Loss: 0.358 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 19 cost time: 1.0647797584533691
Epoch: 19, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 20 cost time: 0.6958024501800537
Epoch: 20, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.333 Vali Acc: 0.867 Test Loss: 0.333 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7161755561828613
Epoch: 21, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.6034469604492188
Epoch: 22, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.303 Vali Acc: 0.883 Test Loss: 0.303 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6252110004425049
Epoch: 23, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.294 Vali Acc: 0.883 Test Loss: 0.294 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7559301853179932
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.277 Vali Acc: 0.894 Test Loss: 0.277 Test Acc: 0.894
Validation loss decreased (-0.888886 --> -0.894442).  Saving model ...
Epoch: 25 cost time: 0.8956880569458008
Epoch: 25, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.269 Vali Acc: 0.878 Test Loss: 0.269 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6930172443389893
Epoch: 26, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.258 Vali Acc: 0.889 Test Loss: 0.258 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7255392074584961
Epoch: 27, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.243 Vali Acc: 0.917 Test Loss: 0.243 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 28 cost time: 0.693063497543335
Epoch: 28, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.240 Vali Acc: 0.900 Test Loss: 0.240 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7295339107513428
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.233 Vali Acc: 0.906 Test Loss: 0.233 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6979482173919678
Epoch: 30, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.916664 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8505628108978271
Epoch: 31, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7870664596557617
Epoch: 32, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.191 Vali Acc: 0.939 Test Loss: 0.191 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7246489524841309
Epoch: 33, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.183 Vali Acc: 0.928 Test Loss: 0.183 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6894807815551758
Epoch: 34, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5071408748626709
Epoch: 35, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.188 Vali Acc: 0.928 Test Loss: 0.188 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7790515422821045
Epoch: 36, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.204 Vali Acc: 0.906 Test Loss: 0.204 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7067310810089111
Epoch: 37, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6466701030731201
Epoch: 38, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.182 Vali Acc: 0.928 Test Loss: 0.182 Test Acc: 0.928
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6368176937103271
Epoch: 39, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.894 Test Loss: 0.213 Test Acc: 0.894
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6964914798736572
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9444444444444444
model parameter : 13248
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9091742038726807
Epoch: 1, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.777 Vali Acc: 0.350 Test Loss: 1.777 Test Acc: 0.350
Validation loss decreased (inf --> -0.349982).  Saving model ...
Epoch: 2 cost time: 0.7650854587554932
Epoch: 2, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.594 Vali Acc: 0.494 Test Loss: 1.594 Test Acc: 0.494
Validation loss decreased (-0.349982 --> -0.494429).  Saving model ...
Epoch: 3 cost time: 0.6918845176696777
Epoch: 3, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.372 Vali Acc: 0.639 Test Loss: 1.372 Test Acc: 0.639
Validation loss decreased (-0.494429 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 0.6796581745147705
Epoch: 4, Steps: 12 | Train Loss: 1.238 Vali Loss: 1.156 Vali Acc: 0.694 Test Loss: 1.156 Test Acc: 0.694
Validation loss decreased (-0.638875 --> -0.694433).  Saving model ...
Epoch: 5 cost time: 0.5807585716247559
Epoch: 5, Steps: 12 | Train Loss: 1.037 Vali Loss: 0.954 Vali Acc: 0.761 Test Loss: 0.954 Test Acc: 0.761
Validation loss decreased (-0.694433 --> -0.761102).  Saving model ...
Epoch: 6 cost time: 0.6421735286712646
Epoch: 6, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7279765605926514
Epoch: 7, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7586357593536377
Epoch: 8, Steps: 12 | Train Loss: 0.620 Vali Loss: 0.612 Vali Acc: 0.778 Test Loss: 0.612 Test Acc: 0.778
Validation loss decreased (-0.761102 --> -0.777772).  Saving model ...
Epoch: 9 cost time: 0.9252820014953613
Epoch: 9, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 0.702592134475708
Epoch: 10, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.513 Vali Acc: 0.778 Test Loss: 0.513 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7443010807037354
Epoch: 11, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.479 Vali Acc: 0.811 Test Loss: 0.479 Test Acc: 0.811
Validation loss decreased (-0.788883 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.636986494064331
Epoch: 12, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.453 Vali Acc: 0.828 Test Loss: 0.453 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827773).  Saving model ...
Epoch: 13 cost time: 0.7626636028289795
Epoch: 13, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.427 Vali Acc: 0.833 Test Loss: 0.427 Test Acc: 0.833
Validation loss decreased (-0.827773 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 0.8355801105499268
Epoch: 14, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
Validation loss decreased (-0.833329 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 0.75333571434021
Epoch: 15, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.382 Vali Acc: 0.872 Test Loss: 0.382 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.7177395820617676
Epoch: 16, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.364 Vali Acc: 0.861 Test Loss: 0.364 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.682403564453125
Epoch: 17, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.342 Vali Acc: 0.872 Test Loss: 0.342 Test Acc: 0.872
Validation loss decreased (-0.872218 --> -0.872219).  Saving model ...
Epoch: 18 cost time: 0.7072861194610596
Epoch: 18, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 0.6443407535552979
Epoch: 19, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.312 Vali Acc: 0.906 Test Loss: 0.312 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905552).  Saving model ...
Epoch: 20 cost time: 0.638045072555542
Epoch: 20, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.296 Vali Acc: 0.917 Test Loss: 0.296 Test Acc: 0.917
Validation loss decreased (-0.905552 --> -0.916664).  Saving model ...
Epoch: 21 cost time: 0.6936790943145752
Epoch: 21, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.284 Vali Acc: 0.906 Test Loss: 0.284 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6263833045959473
Epoch: 22, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.265 Vali Acc: 0.917 Test Loss: 0.265 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.6687526702880859
Epoch: 23, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7276945114135742
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.237 Vali Acc: 0.900 Test Loss: 0.237 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6248600482940674
Epoch: 25, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.219 Vali Acc: 0.911 Test Loss: 0.219 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5921492576599121
Epoch: 26, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927776).  Saving model ...
Epoch: 27 cost time: 0.69437575340271
Epoch: 27, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 0.6659936904907227
Epoch: 28, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 29 cost time: 0.7056381702423096
Epoch: 29, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7594470977783203
Epoch: 30, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.220 Vali Acc: 0.906 Test Loss: 0.220 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6342344284057617
Epoch: 31, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.151 Vali Acc: 0.933 Test Loss: 0.151 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 32 cost time: 0.6044738292694092
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
Validation loss decreased (-0.933332 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.6380293369293213
Epoch: 33, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6789259910583496
Epoch: 34, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6178064346313477
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6408302783966064
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.140 Vali Acc: 0.939 Test Loss: 0.140 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6734111309051514
Epoch: 37, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7369554042816162
Epoch: 38, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5762629508972168
Epoch: 39, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.7149257659912109
Epoch: 40, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.939 Test Loss: 0.157 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6324520111083984
Epoch: 41, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.911 Test Loss: 0.197 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8337974548339844
Epoch: 42, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.147 Vali Acc: 0.939 Test Loss: 0.147 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 13348
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9117672443389893
Epoch: 1, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.734 Vali Acc: 0.306 Test Loss: 1.734 Test Acc: 0.306
Validation loss decreased (inf --> -0.305538).  Saving model ...
Epoch: 2 cost time: 0.6557769775390625
Epoch: 2, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.554 Vali Acc: 0.522 Test Loss: 1.554 Test Acc: 0.522
Validation loss decreased (-0.305538 --> -0.522207).  Saving model ...
Epoch: 3 cost time: 0.6877841949462891
Epoch: 3, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.337 Vali Acc: 0.667 Test Loss: 1.337 Test Acc: 0.667
Validation loss decreased (-0.522207 --> -0.666653).  Saving model ...
Epoch: 4 cost time: 0.8783252239227295
Epoch: 4, Steps: 12 | Train Loss: 1.224 Vali Loss: 1.120 Vali Acc: 0.717 Test Loss: 1.120 Test Acc: 0.717
Validation loss decreased (-0.666653 --> -0.716655).  Saving model ...
Epoch: 5 cost time: 0.7152259349822998
Epoch: 5, Steps: 12 | Train Loss: 1.026 Vali Loss: 0.929 Vali Acc: 0.756 Test Loss: 0.929 Test Acc: 0.756
Validation loss decreased (-0.716655 --> -0.755546).  Saving model ...
Epoch: 6 cost time: 0.6359632015228271
Epoch: 6, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.784 Vali Acc: 0.794 Test Loss: 0.784 Test Acc: 0.794
Validation loss decreased (-0.755546 --> -0.794437).  Saving model ...
Epoch: 7 cost time: 0.6824579238891602
Epoch: 7, Steps: 12 | Train Loss: 0.663 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8217298984527588
Epoch: 8, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6486742496490479
Epoch: 9, Steps: 12 | Train Loss: 0.498 Vali Loss: 0.546 Vali Acc: 0.794 Test Loss: 0.546 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794439).  Saving model ...
Epoch: 10 cost time: 0.9093480110168457
Epoch: 10, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.504 Vali Acc: 0.800 Test Loss: 0.504 Test Acc: 0.800
Validation loss decreased (-0.794439 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.6493048667907715
Epoch: 11, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.472 Vali Acc: 0.806 Test Loss: 0.472 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.7400476932525635
Epoch: 12, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.440 Vali Acc: 0.822 Test Loss: 0.440 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 13 cost time: 0.8616294860839844
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.413 Vali Acc: 0.844 Test Loss: 0.413 Test Acc: 0.844
Validation loss decreased (-0.822218 --> -0.844440).  Saving model ...
Epoch: 14 cost time: 0.7746868133544922
Epoch: 14, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.386 Vali Acc: 0.872 Test Loss: 0.386 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 15 cost time: 0.7221930027008057
Epoch: 15, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.369 Vali Acc: 0.883 Test Loss: 0.369 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 16 cost time: 0.9006271362304688
Epoch: 16, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.353 Vali Acc: 0.822 Test Loss: 0.353 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7431797981262207
Epoch: 17, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 18 cost time: 0.7898855209350586
Epoch: 18, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
Validation loss decreased (-0.888886 --> -0.905552).  Saving model ...
Epoch: 19 cost time: 0.6726911067962646
Epoch: 19, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 0.7894608974456787
Epoch: 20, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.256 Vali Acc: 0.928 Test Loss: 0.256 Test Acc: 0.928
Validation loss decreased (-0.911108 --> -0.927775).  Saving model ...
Epoch: 21 cost time: 0.6976120471954346
Epoch: 21, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.232 Vali Acc: 0.950 Test Loss: 0.232 Test Acc: 0.950
Validation loss decreased (-0.927775 --> -0.949998).  Saving model ...
Epoch: 22 cost time: 0.7554230690002441
Epoch: 22, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6375517845153809
Epoch: 23, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6857898235321045
Epoch: 24, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.702110767364502
Epoch: 25, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6485199928283691
Epoch: 26, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5891563892364502
Epoch: 27, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.168 Vali Acc: 0.939 Test Loss: 0.168 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7247443199157715
Epoch: 28, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.939 Test Loss: 0.152 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6449899673461914
Epoch: 29, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7214422225952148
Epoch: 30, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5854606628417969
Epoch: 31, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.139 Vali Acc: 0.950 Test Loss: 0.139 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949999).  Saving model ...
Epoch: 32 cost time: 0.7467446327209473
Epoch: 32, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.169 Vali Acc: 0.939 Test Loss: 0.169 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6063573360443115
Epoch: 33, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.939 Test Loss: 0.155 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7180242538452148
Epoch: 34, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.956 Test Loss: 0.139 Test Acc: 0.956
Validation loss decreased (-0.949999 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.609243631362915
Epoch: 35, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.933 Test Loss: 0.171 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8115372657775879
Epoch: 36, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.933 Test Loss: 0.165 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5899808406829834
Epoch: 37, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7633991241455078
Epoch: 38, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8353331089019775
Epoch: 39, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8584375381469727
Epoch: 40, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7777040004730225
Epoch: 41, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7125096321105957
Epoch: 42, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6346359252929688
Epoch: 43, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7161474227905273
Epoch: 44, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 13350
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1422672271728516
Epoch: 1, Steps: 12 | Train Loss: 1.829 Vali Loss: 1.741 Vali Acc: 0.272 Test Loss: 1.741 Test Acc: 0.272
Validation loss decreased (inf --> -0.272205).  Saving model ...
Epoch: 2 cost time: 0.5849504470825195
Epoch: 2, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.571 Vali Acc: 0.406 Test Loss: 1.571 Test Acc: 0.406
Validation loss decreased (-0.272205 --> -0.405540).  Saving model ...
Epoch: 3 cost time: 0.6042876243591309
Epoch: 3, Steps: 12 | Train Loss: 1.485 Vali Loss: 1.367 Vali Acc: 0.583 Test Loss: 1.367 Test Acc: 0.583
Validation loss decreased (-0.405540 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.6760871410369873
Epoch: 4, Steps: 12 | Train Loss: 1.287 Vali Loss: 1.167 Vali Acc: 0.656 Test Loss: 1.167 Test Acc: 0.656
Validation loss decreased (-0.583320 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.6623551845550537
Epoch: 5, Steps: 12 | Train Loss: 1.080 Vali Loss: 0.983 Vali Acc: 0.661 Test Loss: 0.983 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661101).  Saving model ...
Epoch: 6 cost time: 0.6798322200775146
Epoch: 6, Steps: 12 | Train Loss: 0.868 Vali Loss: 0.838 Vali Acc: 0.689 Test Loss: 0.838 Test Acc: 0.689
Validation loss decreased (-0.661101 --> -0.688881).  Saving model ...
Epoch: 7 cost time: 0.6418659687042236
Epoch: 7, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.719 Vali Acc: 0.706 Test Loss: 0.719 Test Acc: 0.706
Validation loss decreased (-0.688881 --> -0.705548).  Saving model ...
Epoch: 8 cost time: 0.8489334583282471
Epoch: 8, Steps: 12 | Train Loss: 0.626 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
Validation loss decreased (-0.705548 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 0.6562795639038086
Epoch: 9, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.571 Vali Acc: 0.744 Test Loss: 0.571 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8287456035614014
Epoch: 10, Steps: 12 | Train Loss: 0.464 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 0.6752240657806396
Epoch: 11, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.481 Vali Acc: 0.750 Test Loss: 0.481 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6332626342773438
Epoch: 12, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.442 Vali Acc: 0.817 Test Loss: 0.442 Test Acc: 0.817
Validation loss decreased (-0.783328 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.6103179454803467
Epoch: 13, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.403 Vali Acc: 0.839 Test Loss: 0.403 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 14 cost time: 0.7762718200683594
Epoch: 14, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.366 Vali Acc: 0.856 Test Loss: 0.366 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 15 cost time: 0.6107268333435059
Epoch: 15, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.326 Vali Acc: 0.878 Test Loss: 0.326 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877775).  Saving model ...
Epoch: 16 cost time: 0.5864436626434326
Epoch: 16, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.295 Vali Acc: 0.883 Test Loss: 0.295 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.6436364650726318
Epoch: 17, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 0.5951220989227295
Epoch: 18, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.248 Vali Acc: 0.906 Test Loss: 0.248 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6760087013244629
Epoch: 19, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.222 Vali Acc: 0.961 Test Loss: 0.222 Test Acc: 0.961
Validation loss decreased (-0.911108 --> -0.961109).  Saving model ...
Epoch: 20 cost time: 0.6157348155975342
Epoch: 20, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5737509727478027
Epoch: 21, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5402755737304688
Epoch: 22, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5713629722595215
Epoch: 23, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.187 Vali Acc: 0.950 Test Loss: 0.187 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6711010932922363
Epoch: 24, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.224 Vali Acc: 0.911 Test Loss: 0.224 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7577438354492188
Epoch: 25, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6100168228149414
Epoch: 26, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.768169641494751
Epoch: 27, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6957008838653564
Epoch: 28, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6334013938903809
Epoch: 29, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9611111111111111
model parameter : 13254
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2403788566589355
Epoch: 1, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.715 Vali Acc: 0.311 Test Loss: 1.715 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.7062804698944092
Epoch: 2, Steps: 12 | Train Loss: 1.686 Vali Loss: 1.554 Vali Acc: 0.489 Test Loss: 1.554 Test Acc: 0.489
Validation loss decreased (-0.311094 --> -0.488873).  Saving model ...
Epoch: 3 cost time: 0.5771172046661377
Epoch: 3, Steps: 12 | Train Loss: 1.480 Vali Loss: 1.361 Vali Acc: 0.656 Test Loss: 1.361 Test Acc: 0.656
Validation loss decreased (-0.488873 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 0.6257359981536865
Epoch: 4, Steps: 12 | Train Loss: 1.265 Vali Loss: 1.157 Vali Acc: 0.711 Test Loss: 1.157 Test Acc: 0.711
Validation loss decreased (-0.655542 --> -0.711100).  Saving model ...
Epoch: 5 cost time: 0.6593010425567627
Epoch: 5, Steps: 12 | Train Loss: 1.078 Vali Loss: 0.970 Vali Acc: 0.722 Test Loss: 0.970 Test Acc: 0.722
Validation loss decreased (-0.711100 --> -0.722213).  Saving model ...
Epoch: 6 cost time: 0.682220458984375
Epoch: 6, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.823 Vali Acc: 0.733 Test Loss: 0.823 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733325).  Saving model ...
Epoch: 7 cost time: 0.7752223014831543
Epoch: 7, Steps: 12 | Train Loss: 0.713 Vali Loss: 0.719 Vali Acc: 0.739 Test Loss: 0.719 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738882).  Saving model ...
Epoch: 8 cost time: 0.6692328453063965
Epoch: 8, Steps: 12 | Train Loss: 0.608 Vali Loss: 0.643 Vali Acc: 0.722 Test Loss: 0.643 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6349012851715088
Epoch: 9, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.585 Vali Acc: 0.756 Test Loss: 0.585 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.6369433403015137
Epoch: 10, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.537 Vali Acc: 0.761 Test Loss: 0.537 Test Acc: 0.761
Validation loss decreased (-0.755550 --> -0.761106).  Saving model ...
Epoch: 11 cost time: 0.6261923313140869
Epoch: 11, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.492 Vali Acc: 0.811 Test Loss: 0.492 Test Acc: 0.811
Validation loss decreased (-0.761106 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.6454761028289795
Epoch: 12, Steps: 12 | Train Loss: 0.421 Vali Loss: 0.460 Vali Acc: 0.806 Test Loss: 0.460 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6594343185424805
Epoch: 13, Steps: 12 | Train Loss: 0.398 Vali Loss: 0.433 Vali Acc: 0.811 Test Loss: 0.433 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811107).  Saving model ...
Epoch: 14 cost time: 0.6176669597625732
Epoch: 14, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.411 Vali Acc: 0.833 Test Loss: 0.411 Test Acc: 0.833
Validation loss decreased (-0.811107 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.6168088912963867
Epoch: 15, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.386 Vali Acc: 0.861 Test Loss: 0.386 Test Acc: 0.861
Validation loss decreased (-0.833329 --> -0.861107).  Saving model ...
Epoch: 16 cost time: 0.6035830974578857
Epoch: 16, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.356 Vali Acc: 0.883 Test Loss: 0.356 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.6669552326202393
Epoch: 17, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.336 Vali Acc: 0.894 Test Loss: 0.336 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894441).  Saving model ...
Epoch: 18 cost time: 0.5477011203765869
Epoch: 18, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.325 Vali Acc: 0.872 Test Loss: 0.325 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6614053249359131
Epoch: 19, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5679292678833008
Epoch: 20, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
Validation loss decreased (-0.894441 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.606830358505249
Epoch: 21, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.270 Vali Acc: 0.894 Test Loss: 0.270 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4986836910247803
Epoch: 22, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.279 Vali Acc: 0.917 Test Loss: 0.279 Test Acc: 0.917
Validation loss decreased (-0.899997 --> -0.916664).  Saving model ...
Epoch: 23 cost time: 0.5474483966827393
Epoch: 23, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5906953811645508
Epoch: 24, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.257 Vali Acc: 0.906 Test Loss: 0.257 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5755541324615479
Epoch: 25, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.294 Vali Acc: 0.917 Test Loss: 0.294 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6880950927734375
Epoch: 26, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.247 Vali Acc: 0.917 Test Loss: 0.247 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.659510612487793
Epoch: 27, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.272 Vali Acc: 0.894 Test Loss: 0.272 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6327252388000488
Epoch: 28, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.7325839996337891
Epoch: 29, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.6860630512237549
Epoch: 30, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.289 Vali Acc: 0.917 Test Loss: 0.289 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6300690174102783
Epoch: 31, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6238274574279785
Epoch: 32, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.306 Vali Acc: 0.917 Test Loss: 0.306 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5741462707519531
Epoch: 33, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.729081392288208
Epoch: 34, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.6035690307617188
Epoch: 35, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6419835090637207
Epoch: 36, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.276 Vali Acc: 0.939 Test Loss: 0.276 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 37 cost time: 0.6058087348937988
Epoch: 37, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.321 Vali Acc: 0.928 Test Loss: 0.321 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6730599403381348
Epoch: 38, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5846261978149414
Epoch: 39, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7181546688079834
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.371 Vali Acc: 0.917 Test Loss: 0.371 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7312972545623779
Epoch: 41, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.378 Vali Acc: 0.894 Test Loss: 0.378 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7288317680358887
Epoch: 42, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6141037940979004
Epoch: 43, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6890554428100586
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.7462308406829834
Epoch: 45, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.6157364845275879
Epoch: 46, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.387 Vali Acc: 0.939 Test Loss: 0.387 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.671595573425293
Epoch: 47, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.364 Vali Acc: 0.933 Test Loss: 0.364 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6514461040496826
Epoch: 48, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7034447193145752
Epoch: 49, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6965956687927246
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7753431797027588
Epoch: 51, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6730000972747803
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.391 Vali Acc: 0.950 Test Loss: 0.391 Test Acc: 0.950
Validation loss decreased (-0.944441 --> -0.949996).  Saving model ...
Epoch: 53 cost time: 0.708263635635376
Epoch: 53, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6421082019805908
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.391 Vali Acc: 0.939 Test Loss: 0.391 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6059978008270264
Epoch: 55, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.396 Vali Acc: 0.944 Test Loss: 0.396 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.605872631072998
Epoch: 56, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.404 Vali Acc: 0.939 Test Loss: 0.404 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6364872455596924
Epoch: 57, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.409 Vali Acc: 0.939 Test Loss: 0.409 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.622347354888916
Epoch: 58, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.419 Vali Acc: 0.933 Test Loss: 0.419 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8566422462463379
Epoch: 59, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6254222393035889
Epoch: 60, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.944 Test Loss: 0.432 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.6364238262176514
Epoch: 61, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.432 Vali Acc: 0.939 Test Loss: 0.432 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6260623931884766
Epoch: 62, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.437 Vali Acc: 0.939 Test Loss: 0.437 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 13361
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8958163261413574
Epoch: 1, Steps: 12 | Train Loss: 1.790 Vali Loss: 1.717 Vali Acc: 0.317 Test Loss: 1.717 Test Acc: 0.317
Validation loss decreased (inf --> -0.316649).  Saving model ...
Epoch: 2 cost time: 0.7808020114898682
Epoch: 2, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.549 Vali Acc: 0.467 Test Loss: 1.549 Test Acc: 0.467
Validation loss decreased (-0.316649 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.6823084354400635
Epoch: 3, Steps: 12 | Train Loss: 1.407 Vali Loss: 1.352 Vali Acc: 0.628 Test Loss: 1.352 Test Acc: 0.628
Validation loss decreased (-0.466651 --> -0.627764).  Saving model ...
Epoch: 4 cost time: 0.5988378524780273
Epoch: 4, Steps: 12 | Train Loss: 1.219 Vali Loss: 1.161 Vali Acc: 0.678 Test Loss: 1.161 Test Acc: 0.678
Validation loss decreased (-0.627764 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.717167854309082
Epoch: 5, Steps: 12 | Train Loss: 1.058 Vali Loss: 0.991 Vali Acc: 0.694 Test Loss: 0.991 Test Acc: 0.694
Validation loss decreased (-0.677766 --> -0.694435).  Saving model ...
Epoch: 6 cost time: 0.6952564716339111
Epoch: 6, Steps: 12 | Train Loss: 0.852 Vali Loss: 0.855 Vali Acc: 0.728 Test Loss: 0.855 Test Acc: 0.728
Validation loss decreased (-0.694435 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 0.823584794998169
Epoch: 7, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.750 Vali Acc: 0.728 Test Loss: 0.750 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 8 cost time: 0.7682909965515137
Epoch: 8, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.671 Vali Acc: 0.711 Test Loss: 0.671 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.747258186340332
Epoch: 9, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.610 Vali Acc: 0.767 Test Loss: 0.610 Test Acc: 0.767
Validation loss decreased (-0.727770 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.6832280158996582
Epoch: 10, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6888904571533203
Epoch: 11, Steps: 12 | Train Loss: 0.443 Vali Loss: 0.523 Vali Acc: 0.750 Test Loss: 0.523 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6685681343078613
Epoch: 12, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
Validation loss decreased (-0.766661 --> -0.788884).  Saving model ...
Epoch: 13 cost time: 0.5940911769866943
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.459 Vali Acc: 0.817 Test Loss: 0.459 Test Acc: 0.817
Validation loss decreased (-0.788884 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.5720758438110352
Epoch: 14, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.434 Vali Acc: 0.833 Test Loss: 0.434 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.6178984642028809
Epoch: 15, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.417 Vali Acc: 0.844 Test Loss: 0.417 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 16 cost time: 0.6293978691101074
Epoch: 16, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.394 Vali Acc: 0.839 Test Loss: 0.394 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6800339221954346
Epoch: 17, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.375 Vali Acc: 0.878 Test Loss: 0.375 Test Acc: 0.878
Validation loss decreased (-0.844440 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 0.6223809719085693
Epoch: 18, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 0.6152801513671875
Epoch: 19, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.332 Vali Acc: 0.861 Test Loss: 0.332 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5852842330932617
Epoch: 20, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.306 Vali Acc: 0.900 Test Loss: 0.306 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.689124345779419
Epoch: 21, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.288 Vali Acc: 0.878 Test Loss: 0.288 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.701141357421875
Epoch: 22, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.6146492958068848
Epoch: 23, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 24 cost time: 0.6905500888824463
Epoch: 24, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.248 Vali Acc: 0.889 Test Loss: 0.248 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6126742362976074
Epoch: 25, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 0.6540369987487793
Epoch: 26, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5185182094573975
Epoch: 27, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.195 Vali Acc: 0.928 Test Loss: 0.195 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6174643039703369
Epoch: 28, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.933331 --> -0.949998).  Saving model ...
Epoch: 29 cost time: 0.7987945079803467
Epoch: 29, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 30 cost time: 0.6583573818206787
Epoch: 30, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6461734771728516
Epoch: 31, Steps: 12 | Train Loss: 0.080 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.6773636341094971
Epoch: 32, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.188 Vali Acc: 0.911 Test Loss: 0.188 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5894644260406494
Epoch: 33, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.165 Vali Acc: 0.939 Test Loss: 0.165 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5885164737701416
Epoch: 34, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7414860725402832
Epoch: 35, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.939 Test Loss: 0.151 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6657459735870361
Epoch: 36, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.179 Vali Acc: 0.928 Test Loss: 0.179 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6545851230621338
Epoch: 37, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.188 Vali Acc: 0.939 Test Loss: 0.188 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6696233749389648
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.170 Vali Acc: 0.922 Test Loss: 0.170 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6323146820068359
Epoch: 39, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.950 Test Loss: 0.162 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6351137161254883
Epoch: 40, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7989785671234131
Epoch: 41, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 13280
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9182939529418945
Epoch: 1, Steps: 12 | Train Loss: 1.767 Vali Loss: 1.713 Vali Acc: 0.200 Test Loss: 1.713 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.6125149726867676
Epoch: 2, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.530 Vali Acc: 0.439 Test Loss: 1.530 Test Acc: 0.439
Validation loss decreased (-0.199983 --> -0.438874).  Saving model ...
Epoch: 3 cost time: 0.695206880569458
Epoch: 3, Steps: 12 | Train Loss: 1.395 Vali Loss: 1.321 Vali Acc: 0.594 Test Loss: 1.321 Test Acc: 0.594
Validation loss decreased (-0.438874 --> -0.594431).  Saving model ...
Epoch: 4 cost time: 0.6719987392425537
Epoch: 4, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.125 Vali Acc: 0.661 Test Loss: 1.125 Test Acc: 0.661
Validation loss decreased (-0.594431 --> -0.661100).  Saving model ...
Epoch: 5 cost time: 0.6285614967346191
Epoch: 5, Steps: 12 | Train Loss: 0.984 Vali Loss: 0.953 Vali Acc: 0.683 Test Loss: 0.953 Test Acc: 0.683
Validation loss decreased (-0.661100 --> -0.683324).  Saving model ...
Epoch: 6 cost time: 0.7975130081176758
Epoch: 6, Steps: 12 | Train Loss: 0.856 Vali Loss: 0.814 Vali Acc: 0.694 Test Loss: 0.814 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 7 cost time: 0.6631488800048828
Epoch: 7, Steps: 12 | Train Loss: 0.696 Vali Loss: 0.713 Vali Acc: 0.728 Test Loss: 0.713 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727771).  Saving model ...
Epoch: 8 cost time: 0.6473805904388428
Epoch: 8, Steps: 12 | Train Loss: 0.604 Vali Loss: 0.631 Vali Acc: 0.761 Test Loss: 0.631 Test Acc: 0.761
Validation loss decreased (-0.727771 --> -0.761105).  Saving model ...
Epoch: 9 cost time: 0.6209611892700195
Epoch: 9, Steps: 12 | Train Loss: 0.525 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
Validation loss decreased (-0.761105 --> -0.788883).  Saving model ...
Epoch: 10 cost time: 0.6362524032592773
Epoch: 10, Steps: 12 | Train Loss: 0.478 Vali Loss: 0.528 Vali Acc: 0.800 Test Loss: 0.528 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799995).  Saving model ...
Epoch: 11 cost time: 0.60943603515625
Epoch: 11, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.495 Vali Acc: 0.806 Test Loss: 0.495 Test Acc: 0.806
Validation loss decreased (-0.799995 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.6420037746429443
Epoch: 12, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.463 Vali Acc: 0.817 Test Loss: 0.463 Test Acc: 0.817
Validation loss decreased (-0.805551 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.5883984565734863
Epoch: 13, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.436 Vali Acc: 0.817 Test Loss: 0.436 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.6034548282623291
Epoch: 14, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.410 Vali Acc: 0.861 Test Loss: 0.410 Test Acc: 0.861
Validation loss decreased (-0.816662 --> -0.861107).  Saving model ...
Epoch: 15 cost time: 0.5813729763031006
Epoch: 15, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.391 Vali Acc: 0.856 Test Loss: 0.391 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5875422954559326
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.371 Vali Acc: 0.867 Test Loss: 0.371 Test Acc: 0.867
Validation loss decreased (-0.861107 --> -0.866663).  Saving model ...
Epoch: 17 cost time: 0.510430097579956
Epoch: 17, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.357 Vali Acc: 0.856 Test Loss: 0.357 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6065301895141602
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.341 Vali Acc: 0.878 Test Loss: 0.341 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 19 cost time: 0.5876302719116211
Epoch: 19, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.328 Vali Acc: 0.894 Test Loss: 0.328 Test Acc: 0.894
Validation loss decreased (-0.877774 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 0.6794602870941162
Epoch: 20, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.311 Vali Acc: 0.878 Test Loss: 0.311 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5502209663391113
Epoch: 21, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.300 Vali Acc: 0.878 Test Loss: 0.300 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6139578819274902
Epoch: 22, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 0.5988836288452148
Epoch: 23, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.284 Vali Acc: 0.883 Test Loss: 0.284 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6465713977813721
Epoch: 24, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.274 Vali Acc: 0.917 Test Loss: 0.274 Test Acc: 0.917
Validation loss decreased (-0.894442 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.6516907215118408
Epoch: 25, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.261 Vali Acc: 0.894 Test Loss: 0.261 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6313526630401611
Epoch: 26, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6877570152282715
Epoch: 27, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6668553352355957
Epoch: 28, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 29 cost time: 0.5649905204772949
Epoch: 29, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7294297218322754
Epoch: 30, Steps: 12 | Train Loss: 0.128 Vali Loss: 0.216 Vali Acc: 0.928 Test Loss: 0.216 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927776).  Saving model ...
Epoch: 31 cost time: 0.6288495063781738
Epoch: 31, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.201 Vali Acc: 0.928 Test Loss: 0.201 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 32 cost time: 0.6744611263275146
Epoch: 32, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.6077852249145508
Epoch: 33, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.6760947704315186
Epoch: 34, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.213 Vali Acc: 0.911 Test Loss: 0.213 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6156656742095947
Epoch: 35, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.206 Vali Acc: 0.917 Test Loss: 0.206 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.586817741394043
Epoch: 36, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6304745674133301
Epoch: 37, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.161 Vali Acc: 0.933 Test Loss: 0.161 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 38 cost time: 0.6479687690734863
Epoch: 38, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.166 Vali Acc: 0.950 Test Loss: 0.166 Test Acc: 0.950
Validation loss decreased (-0.933332 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.7741024494171143
Epoch: 39, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 40 cost time: 0.6881754398345947
Epoch: 40, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6173913478851318
Epoch: 41, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6583983898162842
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6604235172271729
Epoch: 43, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6181800365447998
Epoch: 44, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.917 Test Loss: 0.240 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.612128734588623
Epoch: 45, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7111110687255859
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5900144577026367
Epoch: 47, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5643002986907959
Epoch: 48, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.950 Test Loss: 0.206 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5703554153442383
Epoch: 49, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.939 Test Loss: 0.229 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm64_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 13453
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8151013851165771
Epoch: 1, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.820 Vali Acc: 0.200 Test Loss: 1.820 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.5567619800567627
Epoch: 2, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.653 Vali Acc: 0.344 Test Loss: 1.653 Test Acc: 0.344
Validation loss decreased (-0.199982 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.5740785598754883
Epoch: 3, Steps: 12 | Train Loss: 1.528 Vali Loss: 1.460 Vali Acc: 0.550 Test Loss: 1.460 Test Acc: 0.550
Validation loss decreased (-0.344428 --> -0.549985).  Saving model ...
Epoch: 4 cost time: 0.5920107364654541
Epoch: 4, Steps: 12 | Train Loss: 1.311 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.549985 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 0.5043187141418457
Epoch: 5, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.086 Vali Acc: 0.656 Test Loss: 1.086 Test Acc: 0.656
Validation loss decreased (-0.622210 --> -0.655545).  Saving model ...
Epoch: 6 cost time: 0.5313060283660889
Epoch: 6, Steps: 12 | Train Loss: 0.923 Vali Loss: 0.932 Vali Acc: 0.689 Test Loss: 0.932 Test Acc: 0.689
Validation loss decreased (-0.655545 --> -0.688880).  Saving model ...
Epoch: 7 cost time: 0.5643103122711182
Epoch: 7, Steps: 12 | Train Loss: 0.816 Vali Loss: 0.812 Vali Acc: 0.706 Test Loss: 0.812 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705547).  Saving model ...
Epoch: 8 cost time: 0.511023998260498
Epoch: 8, Steps: 12 | Train Loss: 0.676 Vali Loss: 0.716 Vali Acc: 0.728 Test Loss: 0.716 Test Acc: 0.728
Validation loss decreased (-0.705547 --> -0.727771).  Saving model ...
Epoch: 9 cost time: 0.5863802433013916
Epoch: 9, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.633 Vali Acc: 0.756 Test Loss: 0.633 Test Acc: 0.756
Validation loss decreased (-0.727771 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 0.5905551910400391
Epoch: 10, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.580 Vali Acc: 0.767 Test Loss: 0.580 Test Acc: 0.767
Validation loss decreased (-0.755549 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 0.5293855667114258
Epoch: 11, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.536 Vali Acc: 0.750 Test Loss: 0.536 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5657699108123779
Epoch: 12, Steps: 12 | Train Loss: 0.440 Vali Loss: 0.497 Vali Acc: 0.772 Test Loss: 0.497 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 13 cost time: 0.613339900970459
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.471 Vali Acc: 0.811 Test Loss: 0.471 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811106).  Saving model ...
Epoch: 14 cost time: 0.5188806056976318
Epoch: 14, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.443 Vali Acc: 0.800 Test Loss: 0.443 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6093592643737793
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.416 Vali Acc: 0.822 Test Loss: 0.416 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 16 cost time: 0.7088637351989746
Epoch: 16, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.393 Vali Acc: 0.878 Test Loss: 0.393 Test Acc: 0.878
Validation loss decreased (-0.822218 --> -0.877774).  Saving model ...
Epoch: 17 cost time: 0.5436737537384033
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.381 Vali Acc: 0.850 Test Loss: 0.381 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.651707649230957
Epoch: 18, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.366 Vali Acc: 0.844 Test Loss: 0.366 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5913801193237305
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.350 Vali Acc: 0.850 Test Loss: 0.350 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6125898361206055
Epoch: 20, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.335 Vali Acc: 0.850 Test Loss: 0.335 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6095077991485596
Epoch: 21, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.320 Vali Acc: 0.883 Test Loss: 0.320 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 22 cost time: 0.721865177154541
Epoch: 22, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.310 Vali Acc: 0.856 Test Loss: 0.310 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6702375411987305
Epoch: 23, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.633202314376831
Epoch: 24, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.289 Vali Acc: 0.861 Test Loss: 0.289 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7284877300262451
Epoch: 25, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.888886 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 0.6027934551239014
Epoch: 26, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6859495639801025
Epoch: 27, Steps: 12 | Train Loss: 0.184 Vali Loss: 0.258 Vali Acc: 0.878 Test Loss: 0.258 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8411083221435547
Epoch: 28, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.242 Vali Acc: 0.917 Test Loss: 0.242 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 29 cost time: 0.7591915130615234
Epoch: 29, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6132111549377441
Epoch: 30, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.251 Vali Acc: 0.894 Test Loss: 0.251 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6496407985687256
Epoch: 31, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.5472984313964844
Epoch: 32, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.5845532417297363
Epoch: 33, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.6525149345397949
Epoch: 34, Steps: 12 | Train Loss: 0.086 Vali Loss: 0.212 Vali Acc: 0.928 Test Loss: 0.212 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 35 cost time: 0.7188930511474609
Epoch: 35, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6092894077301025
Epoch: 36, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5627834796905518
Epoch: 37, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5366098880767822
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.200 Vali Acc: 0.917 Test Loss: 0.200 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5509731769561768
Epoch: 39, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 0.5320873260498047
Epoch: 40, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5929603576660156
Epoch: 41, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6035449504852295
Epoch: 42, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5897080898284912
Epoch: 43, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.5629317760467529
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5678277015686035
Epoch: 45, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5489976406097412
Epoch: 46, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
Validation loss decreased (-0.944442 --> -0.949998).  Saving model ...
Epoch: 47 cost time: 0.609785795211792
Epoch: 47, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5826015472412109
Epoch: 48, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7643697261810303
Epoch: 49, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6294682025909424
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5657122135162354
Epoch: 51, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6229076385498047
Epoch: 52, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6006565093994141
Epoch: 53, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.956 Test Loss: 0.236 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955553).  Saving model ...
Epoch: 54 cost time: 0.6958506107330322
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.738745927810669
Epoch: 55, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6558592319488525
Epoch: 56, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6131932735443115
Epoch: 57, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6437516212463379
Epoch: 58, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5919826030731201
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7640397548675537
Epoch: 60, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.7526521682739258
Epoch: 61, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.7393507957458496
Epoch: 62, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.6309165954589844
Epoch: 63, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11782
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9483554363250732
Epoch: 1, Steps: 12 | Train Loss: 1.940 Vali Loss: 1.851 Vali Acc: 0.161 Test Loss: 1.851 Test Acc: 0.161
Validation loss decreased (inf --> -0.161093).  Saving model ...
Epoch: 2 cost time: 0.5488500595092773
Epoch: 2, Steps: 12 | Train Loss: 1.799 Vali Loss: 1.689 Vali Acc: 0.311 Test Loss: 1.689 Test Acc: 0.311
Validation loss decreased (-0.161093 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.5949282646179199
Epoch: 3, Steps: 12 | Train Loss: 1.598 Vali Loss: 1.509 Vali Acc: 0.494 Test Loss: 1.509 Test Acc: 0.494
Validation loss decreased (-0.311094 --> -0.494429).  Saving model ...
Epoch: 4 cost time: 0.5975658893585205
Epoch: 4, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.312 Vali Acc: 0.650 Test Loss: 1.312 Test Acc: 0.650
Validation loss decreased (-0.494429 --> -0.649987).  Saving model ...
Epoch: 5 cost time: 0.602426290512085
Epoch: 5, Steps: 12 | Train Loss: 1.169 Vali Loss: 1.127 Vali Acc: 0.678 Test Loss: 1.127 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.6056139469146729
Epoch: 6, Steps: 12 | Train Loss: 1.000 Vali Loss: 0.957 Vali Acc: 0.711 Test Loss: 0.957 Test Acc: 0.711
Validation loss decreased (-0.677767 --> -0.711102).  Saving model ...
Epoch: 7 cost time: 0.568683385848999
Epoch: 7, Steps: 12 | Train Loss: 0.845 Vali Loss: 0.821 Vali Acc: 0.722 Test Loss: 0.821 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 8 cost time: 0.6379752159118652
Epoch: 8, Steps: 12 | Train Loss: 0.694 Vali Loss: 0.716 Vali Acc: 0.756 Test Loss: 0.716 Test Acc: 0.756
Validation loss decreased (-0.722214 --> -0.755548).  Saving model ...
Epoch: 9 cost time: 0.5751466751098633
Epoch: 9, Steps: 12 | Train Loss: 0.579 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761105).  Saving model ...
Epoch: 10 cost time: 0.5933763980865479
Epoch: 10, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.579 Vali Acc: 0.767 Test Loss: 0.579 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766661).  Saving model ...
Epoch: 11 cost time: 0.581784725189209
Epoch: 11, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.534 Vali Acc: 0.767 Test Loss: 0.534 Test Acc: 0.767
Validation loss decreased (-0.766661 --> -0.766661).  Saving model ...
Epoch: 12 cost time: 0.5923135280609131
Epoch: 12, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.499 Vali Acc: 0.794 Test Loss: 0.499 Test Acc: 0.794
Validation loss decreased (-0.766661 --> -0.794439).  Saving model ...
Epoch: 13 cost time: 0.5441503524780273
Epoch: 13, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.467 Vali Acc: 0.817 Test Loss: 0.467 Test Acc: 0.817
Validation loss decreased (-0.794439 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.5104472637176514
Epoch: 14, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.441 Vali Acc: 0.806 Test Loss: 0.441 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5997037887573242
Epoch: 15, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.429 Vali Acc: 0.800 Test Loss: 0.429 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7179660797119141
Epoch: 16, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.408 Vali Acc: 0.844 Test Loss: 0.408 Test Acc: 0.844
Validation loss decreased (-0.816662 --> -0.844440).  Saving model ...
Epoch: 17 cost time: 0.7895886898040771
Epoch: 17, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.388 Vali Acc: 0.844 Test Loss: 0.388 Test Acc: 0.844
Validation loss decreased (-0.844440 --> -0.844441).  Saving model ...
Epoch: 18 cost time: 0.7121140956878662
Epoch: 18, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.368 Vali Acc: 0.872 Test Loss: 0.368 Test Acc: 0.872
Validation loss decreased (-0.844441 --> -0.872219).  Saving model ...
Epoch: 19 cost time: 0.6699159145355225
Epoch: 19, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.355 Vali Acc: 0.883 Test Loss: 0.355 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 0.7177631855010986
Epoch: 20, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6780300140380859
Epoch: 21, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.332 Vali Acc: 0.856 Test Loss: 0.332 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7942020893096924
Epoch: 22, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.313 Vali Acc: 0.883 Test Loss: 0.313 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 0.6232826709747314
Epoch: 23, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.305 Vali Acc: 0.872 Test Loss: 0.305 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6789934635162354
Epoch: 24, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.293 Vali Acc: 0.906 Test Loss: 0.293 Test Acc: 0.906
Validation loss decreased (-0.883330 --> -0.905553).  Saving model ...
Epoch: 25 cost time: 0.6248016357421875
Epoch: 25, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.282 Vali Acc: 0.889 Test Loss: 0.282 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6718549728393555
Epoch: 26, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.278 Vali Acc: 0.883 Test Loss: 0.278 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7071692943572998
Epoch: 27, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.265 Vali Acc: 0.894 Test Loss: 0.265 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.685650110244751
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.260 Vali Acc: 0.900 Test Loss: 0.260 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6176931858062744
Epoch: 29, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.252 Vali Acc: 0.911 Test Loss: 0.252 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 30 cost time: 0.6896846294403076
Epoch: 30, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.242 Vali Acc: 0.911 Test Loss: 0.242 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 31 cost time: 0.602168083190918
Epoch: 31, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6620156764984131
Epoch: 32, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.236 Vali Acc: 0.917 Test Loss: 0.236 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 33 cost time: 0.7105944156646729
Epoch: 33, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6034712791442871
Epoch: 34, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.6768815517425537
Epoch: 35, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7051515579223633
Epoch: 36, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6711325645446777
Epoch: 37, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.214 Vali Acc: 0.917 Test Loss: 0.214 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 38 cost time: 0.7939221858978271
Epoch: 38, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.916665 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 0.759699821472168
Epoch: 39, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 0.6508643627166748
Epoch: 40, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.209 Vali Acc: 0.917 Test Loss: 0.209 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6263077259063721
Epoch: 41, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5109753608703613
Epoch: 42, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.198 Vali Acc: 0.917 Test Loss: 0.198 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5042805671691895
Epoch: 43, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.928 Test Loss: 0.208 Test Acc: 0.928
Validation loss decreased (-0.922220 --> -0.927776).  Saving model ...
Epoch: 44 cost time: 0.6921615600585938
Epoch: 44, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.699995756149292
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
Validation loss decreased (-0.927776 --> -0.927776).  Saving model ...
Epoch: 46 cost time: 0.541400671005249
Epoch: 46, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5158576965332031
Epoch: 47, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.927776 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.4844698905944824
Epoch: 48, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.5161440372467041
Epoch: 49, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.671363353729248
Epoch: 50, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 51 cost time: 0.548363208770752
Epoch: 51, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 52 cost time: 0.5719733238220215
Epoch: 52, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.928 Test Loss: 0.213 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5602555274963379
Epoch: 53, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.5397253036499023
Epoch: 54, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 55 cost time: 0.5774505138397217
Epoch: 55, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.928 Test Loss: 0.253 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7109165191650391
Epoch: 56, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.950 Test Loss: 0.218 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 57 cost time: 0.606844425201416
Epoch: 57, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.950 Test Loss: 0.201 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.6501543521881104
Epoch: 58, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.950 Test Loss: 0.224 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.61910080909729
Epoch: 59, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.939 Test Loss: 0.203 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.674748420715332
Epoch: 60, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.939 Test Loss: 0.231 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5925743579864502
Epoch: 61, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955553).  Saving model ...
Epoch: 62 cost time: 0.6312704086303711
Epoch: 62, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.261 Vali Acc: 0.928 Test Loss: 0.261 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6324028968811035
Epoch: 63, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.950 Test Loss: 0.225 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6176447868347168
Epoch: 64, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5893194675445557
Epoch: 65, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5248701572418213
Epoch: 66, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.956 Test Loss: 0.224 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 67 cost time: 0.5845348834991455
Epoch: 67, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7538206577301025
Epoch: 68, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6270627975463867
Epoch: 69, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.939 Test Loss: 0.266 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.625922441482544
Epoch: 70, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6679718494415283
Epoch: 71, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.243 Vali Acc: 0.950 Test Loss: 0.243 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7466506958007812
Epoch: 72, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.956 Test Loss: 0.252 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5918850898742676
Epoch: 73, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.252 Vali Acc: 0.956 Test Loss: 0.252 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7148385047912598
Epoch: 74, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.5722479820251465
Epoch: 75, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6419534683227539
Epoch: 76, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.956 Test Loss: 0.259 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11601
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.729372501373291
Epoch: 1, Steps: 12 | Train Loss: 1.770 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.5885937213897705
Epoch: 2, Steps: 12 | Train Loss: 1.634 Vali Loss: 1.538 Vali Acc: 0.428 Test Loss: 1.538 Test Acc: 0.428
Validation loss decreased (-0.277761 --> -0.427762).  Saving model ...
Epoch: 3 cost time: 0.5734622478485107
Epoch: 3, Steps: 12 | Train Loss: 1.495 Vali Loss: 1.353 Vali Acc: 0.583 Test Loss: 1.353 Test Acc: 0.583
Validation loss decreased (-0.427762 --> -0.583320).  Saving model ...
Epoch: 4 cost time: 0.49497246742248535
Epoch: 4, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.174 Vali Acc: 0.633 Test Loss: 1.174 Test Acc: 0.633
Validation loss decreased (-0.583320 --> -0.633322).  Saving model ...
Epoch: 5 cost time: 0.4878695011138916
Epoch: 5, Steps: 12 | Train Loss: 1.085 Vali Loss: 1.006 Vali Acc: 0.694 Test Loss: 1.006 Test Acc: 0.694
Validation loss decreased (-0.633322 --> -0.694434).  Saving model ...
Epoch: 6 cost time: 0.553699254989624
Epoch: 6, Steps: 12 | Train Loss: 0.876 Vali Loss: 0.860 Vali Acc: 0.706 Test Loss: 0.860 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705547).  Saving model ...
Epoch: 7 cost time: 0.615170955657959
Epoch: 7, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
Validation loss decreased (-0.705547 --> -0.738881).  Saving model ...
Epoch: 8 cost time: 0.5073575973510742
Epoch: 8, Steps: 12 | Train Loss: 0.671 Vali Loss: 0.667 Vali Acc: 0.722 Test Loss: 0.667 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6323575973510742
Epoch: 9, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.610 Vali Acc: 0.756 Test Loss: 0.610 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755549).  Saving model ...
Epoch: 10 cost time: 0.46246337890625
Epoch: 10, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.566 Vali Acc: 0.761 Test Loss: 0.566 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 11 cost time: 0.5395889282226562
Epoch: 11, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.530 Vali Acc: 0.778 Test Loss: 0.530 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 0.6509215831756592
Epoch: 12, Steps: 12 | Train Loss: 0.435 Vali Loss: 0.493 Vali Acc: 0.794 Test Loss: 0.493 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794440).  Saving model ...
Epoch: 13 cost time: 0.6345593929290771
Epoch: 13, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.465 Vali Acc: 0.817 Test Loss: 0.465 Test Acc: 0.817
Validation loss decreased (-0.794440 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.5714917182922363
Epoch: 14, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.450 Vali Acc: 0.822 Test Loss: 0.450 Test Acc: 0.822
Validation loss decreased (-0.816662 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 0.5355730056762695
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.430 Vali Acc: 0.828 Test Loss: 0.430 Test Acc: 0.828
Validation loss decreased (-0.822218 --> -0.827773).  Saving model ...
Epoch: 16 cost time: 0.5914850234985352
Epoch: 16, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.407 Vali Acc: 0.828 Test Loss: 0.407 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827774).  Saving model ...
Epoch: 17 cost time: 0.6089451313018799
Epoch: 17, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.390 Vali Acc: 0.839 Test Loss: 0.390 Test Acc: 0.839
Validation loss decreased (-0.827774 --> -0.838885).  Saving model ...
Epoch: 18 cost time: 0.5495185852050781
Epoch: 18, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.375 Vali Acc: 0.822 Test Loss: 0.375 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6033999919891357
Epoch: 19, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 20 cost time: 0.670433759689331
Epoch: 20, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.350 Vali Acc: 0.839 Test Loss: 0.350 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5901072025299072
Epoch: 21, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.336 Vali Acc: 0.872 Test Loss: 0.336 Test Acc: 0.872
Validation loss decreased (-0.855552 --> -0.872219).  Saving model ...
Epoch: 22 cost time: 0.5735318660736084
Epoch: 22, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.326 Vali Acc: 0.883 Test Loss: 0.326 Test Acc: 0.883
Validation loss decreased (-0.872219 --> -0.883330).  Saving model ...
Epoch: 23 cost time: 0.5836164951324463
Epoch: 23, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.314 Vali Acc: 0.867 Test Loss: 0.314 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5512082576751709
Epoch: 24, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.309 Vali Acc: 0.856 Test Loss: 0.309 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.545975923538208
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6012582778930664
Epoch: 26, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.285 Vali Acc: 0.878 Test Loss: 0.285 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5984466075897217
Epoch: 27, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.883330 --> -0.899997).  Saving model ...
Epoch: 28 cost time: 0.4956488609313965
Epoch: 28, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.267 Vali Acc: 0.894 Test Loss: 0.267 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4706757068634033
Epoch: 29, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.257 Vali Acc: 0.889 Test Loss: 0.257 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.578993558883667
Epoch: 30, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.253 Vali Acc: 0.906 Test Loss: 0.253 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 31 cost time: 0.5532817840576172
Epoch: 31, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.244 Vali Acc: 0.900 Test Loss: 0.244 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.593456506729126
Epoch: 32, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.241 Vali Acc: 0.900 Test Loss: 0.241 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.628192663192749
Epoch: 33, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 34 cost time: 0.5599589347839355
Epoch: 34, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.235 Vali Acc: 0.917 Test Loss: 0.235 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 35 cost time: 0.641843318939209
Epoch: 35, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.238 Vali Acc: 0.906 Test Loss: 0.238 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6134092807769775
Epoch: 36, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.916664 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5492565631866455
Epoch: 37, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.214 Vali Acc: 0.928 Test Loss: 0.214 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5881924629211426
Epoch: 38, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.210 Vali Acc: 0.928 Test Loss: 0.210 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6085910797119141
Epoch: 39, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5872995853424072
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5709755420684814
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.204 Vali Acc: 0.928 Test Loss: 0.204 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5832316875457764
Epoch: 42, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6122231483459473
Epoch: 43, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6322596073150635
Epoch: 44, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.6779227256774902
Epoch: 45, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6261329650878906
Epoch: 46, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.928 Test Loss: 0.198 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6654331684112549
Epoch: 47, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944443).  Saving model ...
Epoch: 48 cost time: 0.5775890350341797
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6043002605438232
Epoch: 49, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6098434925079346
Epoch: 50, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7000620365142822
Epoch: 51, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.950 Test Loss: 0.197 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 52 cost time: 0.6552190780639648
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5884296894073486
Epoch: 53, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.928 Test Loss: 0.230 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6861858367919922
Epoch: 54, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5834321975708008
Epoch: 55, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.939 Test Loss: 0.214 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5594851970672607
Epoch: 56, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.63958740234375
Epoch: 57, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5657315254211426
Epoch: 58, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6394028663635254
Epoch: 59, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.6161832809448242
Epoch: 60, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.5792670249938965
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.950 Test Loss: 0.258 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 11606
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7249171733856201
Epoch: 1, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.722 Vali Acc: 0.322 Test Loss: 1.722 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.5591573715209961
Epoch: 2, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.586 Vali Acc: 0.444 Test Loss: 1.586 Test Acc: 0.444
Validation loss decreased (-0.322205 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.6589047908782959
Epoch: 3, Steps: 12 | Train Loss: 1.467 Vali Loss: 1.415 Vali Acc: 0.589 Test Loss: 1.415 Test Acc: 0.589
Validation loss decreased (-0.444429 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.7441263198852539
Epoch: 4, Steps: 12 | Train Loss: 1.299 Vali Loss: 1.235 Vali Acc: 0.650 Test Loss: 1.235 Test Acc: 0.650
Validation loss decreased (-0.588875 --> -0.649988).  Saving model ...
Epoch: 5 cost time: 0.6145045757293701
Epoch: 5, Steps: 12 | Train Loss: 1.081 Vali Loss: 1.066 Vali Acc: 0.678 Test Loss: 1.066 Test Acc: 0.678
Validation loss decreased (-0.649988 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.5612578392028809
Epoch: 6, Steps: 12 | Train Loss: 0.939 Vali Loss: 0.919 Vali Acc: 0.656 Test Loss: 0.919 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5758507251739502
Epoch: 7, Steps: 12 | Train Loss: 0.807 Vali Loss: 0.798 Vali Acc: 0.689 Test Loss: 0.798 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688881).  Saving model ...
Epoch: 8 cost time: 0.610609769821167
Epoch: 8, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.711 Vali Acc: 0.700 Test Loss: 0.711 Test Acc: 0.700
Validation loss decreased (-0.688881 --> -0.699993).  Saving model ...
Epoch: 9 cost time: 0.6501374244689941
Epoch: 9, Steps: 12 | Train Loss: 0.583 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
Validation loss decreased (-0.699993 --> -0.738882).  Saving model ...
Epoch: 10 cost time: 0.6413638591766357
Epoch: 10, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.584 Vali Acc: 0.733 Test Loss: 0.584 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6689493656158447
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.543 Vali Acc: 0.761 Test Loss: 0.543 Test Acc: 0.761
Validation loss decreased (-0.738882 --> -0.761106).  Saving model ...
Epoch: 12 cost time: 0.628878116607666
Epoch: 12, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.510 Vali Acc: 0.744 Test Loss: 0.510 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6275041103363037
Epoch: 13, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.480 Vali Acc: 0.783 Test Loss: 0.480 Test Acc: 0.783
Validation loss decreased (-0.761106 --> -0.783329).  Saving model ...
Epoch: 14 cost time: 0.6703402996063232
Epoch: 14, Steps: 12 | Train Loss: 0.371 Vali Loss: 0.457 Vali Acc: 0.800 Test Loss: 0.457 Test Acc: 0.800
Validation loss decreased (-0.783329 --> -0.799995).  Saving model ...
Epoch: 15 cost time: 0.6442222595214844
Epoch: 15, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.438 Vali Acc: 0.800 Test Loss: 0.438 Test Acc: 0.800
Validation loss decreased (-0.799995 --> -0.799996).  Saving model ...
Epoch: 16 cost time: 0.6742477416992188
Epoch: 16, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.422 Vali Acc: 0.817 Test Loss: 0.422 Test Acc: 0.817
Validation loss decreased (-0.799996 --> -0.816662).  Saving model ...
Epoch: 17 cost time: 0.7136824131011963
Epoch: 17, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.397 Vali Acc: 0.817 Test Loss: 0.397 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816663).  Saving model ...
Epoch: 18 cost time: 0.5407896041870117
Epoch: 18, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.381 Vali Acc: 0.833 Test Loss: 0.381 Test Acc: 0.833
Validation loss decreased (-0.816663 --> -0.833330).  Saving model ...
Epoch: 19 cost time: 0.5449674129486084
Epoch: 19, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.364 Vali Acc: 0.839 Test Loss: 0.364 Test Acc: 0.839
Validation loss decreased (-0.833330 --> -0.838885).  Saving model ...
Epoch: 20 cost time: 0.6366546154022217
Epoch: 20, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.347 Vali Acc: 0.856 Test Loss: 0.347 Test Acc: 0.856
Validation loss decreased (-0.838885 --> -0.855552).  Saving model ...
Epoch: 21 cost time: 0.6253025531768799
Epoch: 21, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
Validation loss decreased (-0.855552 --> -0.877774).  Saving model ...
Epoch: 22 cost time: 0.6834316253662109
Epoch: 22, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.325 Vali Acc: 0.856 Test Loss: 0.325 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6536858081817627
Epoch: 23, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.312 Vali Acc: 0.878 Test Loss: 0.312 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877775).  Saving model ...
Epoch: 24 cost time: 0.5662097930908203
Epoch: 24, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.301 Vali Acc: 0.883 Test Loss: 0.301 Test Acc: 0.883
Validation loss decreased (-0.877775 --> -0.883330).  Saving model ...
Epoch: 25 cost time: 0.5793159008026123
Epoch: 25, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.291 Vali Acc: 0.867 Test Loss: 0.291 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7297968864440918
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.280 Vali Acc: 0.894 Test Loss: 0.280 Test Acc: 0.894
Validation loss decreased (-0.883330 --> -0.894442).  Saving model ...
Epoch: 27 cost time: 0.6495411396026611
Epoch: 27, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.271 Vali Acc: 0.883 Test Loss: 0.271 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6251766681671143
Epoch: 28, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.264 Vali Acc: 0.883 Test Loss: 0.264 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6384899616241455
Epoch: 29, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.263 Vali Acc: 0.894 Test Loss: 0.263 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 30 cost time: 0.6074385643005371
Epoch: 30, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.252 Vali Acc: 0.894 Test Loss: 0.252 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 31 cost time: 0.6058096885681152
Epoch: 31, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.242 Vali Acc: 0.894 Test Loss: 0.242 Test Acc: 0.894
Validation loss decreased (-0.894442 --> -0.894442).  Saving model ...
Epoch: 32 cost time: 0.6506392955780029
Epoch: 32, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.237 Vali Acc: 0.906 Test Loss: 0.237 Test Acc: 0.906
Validation loss decreased (-0.894442 --> -0.905553).  Saving model ...
Epoch: 33 cost time: 0.6543266773223877
Epoch: 33, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.234 Vali Acc: 0.900 Test Loss: 0.234 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6223390102386475
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.231 Vali Acc: 0.906 Test Loss: 0.231 Test Acc: 0.906
Validation loss decreased (-0.905553 --> -0.905553).  Saving model ...
Epoch: 35 cost time: 0.5737643241882324
Epoch: 35, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.222 Vali Acc: 0.911 Test Loss: 0.222 Test Acc: 0.911
Validation loss decreased (-0.905553 --> -0.911109).  Saving model ...
Epoch: 36 cost time: 0.5932595729827881
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.911109 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.6122846603393555
Epoch: 37, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.7685256004333496
Epoch: 38, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.207 Vali Acc: 0.917 Test Loss: 0.207 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6377537250518799
Epoch: 39, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6159913539886475
Epoch: 40, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6164143085479736
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.195 Vali Acc: 0.939 Test Loss: 0.195 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 42 cost time: 0.5638115406036377
Epoch: 42, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6338338851928711
Epoch: 43, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.194 Vali Acc: 0.928 Test Loss: 0.194 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8008735179901123
Epoch: 44, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6375160217285156
Epoch: 45, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.196 Vali Acc: 0.928 Test Loss: 0.196 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7108569145202637
Epoch: 46, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6545312404632568
Epoch: 47, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.191 Vali Acc: 0.928 Test Loss: 0.191 Test Acc: 0.928
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6644589900970459
Epoch: 48, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.189 Vali Acc: 0.922 Test Loss: 0.189 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7113323211669922
Epoch: 49, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7447476387023926
Epoch: 50, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 51 cost time: 0.7215018272399902
Epoch: 51, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.180 Vali Acc: 0.939 Test Loss: 0.180 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 52 cost time: 0.6411523818969727
Epoch: 52, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.917 Test Loss: 0.188 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6269941329956055
Epoch: 53, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 54 cost time: 0.5700476169586182
Epoch: 54, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.939 Test Loss: 0.175 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7627813816070557
Epoch: 55, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7009522914886475
Epoch: 56, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 57 cost time: 0.7990009784698486
Epoch: 57, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.667194128036499
Epoch: 58, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7274067401885986
Epoch: 59, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8496594429016113
Epoch: 60, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.194 Vali Acc: 0.917 Test Loss: 0.194 Test Acc: 0.917
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8448483943939209
Epoch: 61, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.174 Vali Acc: 0.939 Test Loss: 0.174 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.860914945602417
Epoch: 62, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.731684684753418
Epoch: 63, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.171 Vali Acc: 0.950 Test Loss: 0.171 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 64 cost time: 0.7351720333099365
Epoch: 64, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.922 Test Loss: 0.188 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8098080158233643
Epoch: 65, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.78729248046875
Epoch: 66, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.939 Test Loss: 0.177 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.7562191486358643
Epoch: 67, Steps: 12 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7551021575927734
Epoch: 68, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 69 cost time: 0.7487931251525879
Epoch: 69, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.933 Test Loss: 0.167 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6433966159820557
Epoch: 70, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.171 Vali Acc: 0.928 Test Loss: 0.171 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.7804856300354004
Epoch: 71, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.928 Test Loss: 0.184 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7565648555755615
Epoch: 72, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6675834655761719
Epoch: 73, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.939 Test Loss: 0.179 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.7482724189758301
Epoch: 74, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.8133959770202637
Epoch: 75, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.8683905601501465
Epoch: 76, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.939 Test Loss: 0.192 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.8624203205108643
Epoch: 77, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.7592687606811523
Epoch: 78, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.95
model parameter : 11749
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9242520332336426
Epoch: 1, Steps: 12 | Train Loss: 1.726 Vali Loss: 1.596 Vali Acc: 0.322 Test Loss: 1.596 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 0.72969651222229
Epoch: 2, Steps: 12 | Train Loss: 1.592 Vali Loss: 1.453 Vali Acc: 0.500 Test Loss: 1.453 Test Acc: 0.500
Validation loss decreased (-0.322206 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.5740094184875488
Epoch: 3, Steps: 12 | Train Loss: 1.446 Vali Loss: 1.288 Vali Acc: 0.661 Test Loss: 1.288 Test Acc: 0.661
Validation loss decreased (-0.499985 --> -0.661098).  Saving model ...
Epoch: 4 cost time: 0.5746798515319824
Epoch: 4, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.120 Vali Acc: 0.700 Test Loss: 1.120 Test Acc: 0.700
Validation loss decreased (-0.661098 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.5650997161865234
Epoch: 5, Steps: 12 | Train Loss: 1.056 Vali Loss: 0.964 Vali Acc: 0.717 Test Loss: 0.964 Test Acc: 0.717
Validation loss decreased (-0.699989 --> -0.716657).  Saving model ...
Epoch: 6 cost time: 0.6406576633453369
Epoch: 6, Steps: 12 | Train Loss: 0.890 Vali Loss: 0.831 Vali Acc: 0.728 Test Loss: 0.831 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727769).  Saving model ...
Epoch: 7 cost time: 0.580416202545166
Epoch: 7, Steps: 12 | Train Loss: 0.752 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
Validation loss decreased (-0.727769 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 0.5445659160614014
Epoch: 8, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48674631118774414
Epoch: 9, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.579 Vali Acc: 0.756 Test Loss: 0.579 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755550).  Saving model ...
Epoch: 10 cost time: 0.6900589466094971
Epoch: 10, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.755550 --> -0.783328).  Saving model ...
Epoch: 11 cost time: 0.5747783184051514
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.497 Vali Acc: 0.806 Test Loss: 0.497 Test Acc: 0.806
Validation loss decreased (-0.783328 --> -0.805551).  Saving model ...
Epoch: 12 cost time: 0.5307943820953369
Epoch: 12, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.464 Vali Acc: 0.811 Test Loss: 0.464 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 13 cost time: 0.5304343700408936
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.438 Vali Acc: 0.822 Test Loss: 0.438 Test Acc: 0.822
Validation loss decreased (-0.811106 --> -0.822218).  Saving model ...
Epoch: 14 cost time: 0.510657548904419
Epoch: 14, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.412 Vali Acc: 0.850 Test Loss: 0.412 Test Acc: 0.850
Validation loss decreased (-0.822218 --> -0.849996).  Saving model ...
Epoch: 15 cost time: 0.6371994018554688
Epoch: 15, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.392 Vali Acc: 0.833 Test Loss: 0.392 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6398637294769287
Epoch: 16, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.374 Vali Acc: 0.883 Test Loss: 0.374 Test Acc: 0.883
Validation loss decreased (-0.849996 --> -0.883330).  Saving model ...
Epoch: 17 cost time: 0.8342366218566895
Epoch: 17, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.6033167839050293
Epoch: 18, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.344 Vali Acc: 0.850 Test Loss: 0.344 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5160942077636719
Epoch: 19, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.331 Vali Acc: 0.867 Test Loss: 0.331 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6032185554504395
Epoch: 20, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.313 Vali Acc: 0.894 Test Loss: 0.313 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 21 cost time: 0.5862264633178711
Epoch: 21, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.304 Vali Acc: 0.883 Test Loss: 0.304 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6300506591796875
Epoch: 22, Steps: 12 | Train Loss: 0.215 Vali Loss: 0.288 Vali Acc: 0.894 Test Loss: 0.288 Test Acc: 0.894
Validation loss decreased (-0.894441 --> -0.894442).  Saving model ...
Epoch: 23 cost time: 0.5614216327667236
Epoch: 23, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.275 Vali Acc: 0.911 Test Loss: 0.275 Test Acc: 0.911
Validation loss decreased (-0.894442 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.7076578140258789
Epoch: 24, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.262 Vali Acc: 0.917 Test Loss: 0.262 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5954940319061279
Epoch: 25, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.257 Vali Acc: 0.900 Test Loss: 0.257 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6352622509002686
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.241 Vali Acc: 0.917 Test Loss: 0.241 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6739292144775391
Epoch: 27, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.230 Vali Acc: 0.939 Test Loss: 0.230 Test Acc: 0.939
Validation loss decreased (-0.916664 --> -0.938887).  Saving model ...
Epoch: 28 cost time: 0.6683206558227539
Epoch: 28, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.220 Vali Acc: 0.928 Test Loss: 0.220 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7634084224700928
Epoch: 29, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.213 Vali Acc: 0.900 Test Loss: 0.213 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.616724967956543
Epoch: 30, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.938887 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.6497695446014404
Epoch: 31, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6819531917572021
Epoch: 32, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.620520830154419
Epoch: 33, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5995914936065674
Epoch: 34, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.166 Vali Acc: 0.939 Test Loss: 0.166 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6379237174987793
Epoch: 35, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6407203674316406
Epoch: 36, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6561582088470459
Epoch: 37, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.171 Vali Acc: 0.922 Test Loss: 0.171 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5905375480651855
Epoch: 38, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6203258037567139
Epoch: 39, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.5650980472564697
Epoch: 40, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11692
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.5718872547149658
Epoch: 1, Steps: 12 | Train Loss: 1.754 Vali Loss: 1.750 Vali Acc: 0.206 Test Loss: 1.750 Test Acc: 0.206
Validation loss decreased (inf --> -0.205538).  Saving model ...
Epoch: 2 cost time: 0.5674786567687988
Epoch: 2, Steps: 12 | Train Loss: 1.618 Vali Loss: 1.589 Vali Acc: 0.389 Test Loss: 1.589 Test Acc: 0.389
Validation loss decreased (-0.205538 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.6289770603179932
Epoch: 3, Steps: 12 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.589 Test Loss: 1.395 Test Acc: 0.589
Validation loss decreased (-0.388873 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.5338864326477051
Epoch: 4, Steps: 12 | Train Loss: 1.256 Vali Loss: 1.202 Vali Acc: 0.683 Test Loss: 1.202 Test Acc: 0.683
Validation loss decreased (-0.588875 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 0.5229160785675049
Epoch: 5, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.028 Vali Acc: 0.717 Test Loss: 1.028 Test Acc: 0.717
Validation loss decreased (-0.683321 --> -0.716656).  Saving model ...
Epoch: 6 cost time: 0.4534626007080078
Epoch: 6, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.878 Vali Acc: 0.711 Test Loss: 0.878 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.46123194694519043
Epoch: 7, Steps: 12 | Train Loss: 0.738 Vali Loss: 0.770 Vali Acc: 0.722 Test Loss: 0.770 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722215).  Saving model ...
Epoch: 8 cost time: 0.6535446643829346
Epoch: 8, Steps: 12 | Train Loss: 0.641 Vali Loss: 0.679 Vali Acc: 0.756 Test Loss: 0.679 Test Acc: 0.756
Validation loss decreased (-0.722215 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.5621483325958252
Epoch: 9, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5989773273468018
Epoch: 10, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.561 Vali Acc: 0.778 Test Loss: 0.561 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777772).  Saving model ...
Epoch: 11 cost time: 0.46826744079589844
Epoch: 11, Steps: 12 | Train Loss: 0.495 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 12 cost time: 0.4774003028869629
Epoch: 12, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.484 Vali Acc: 0.806 Test Loss: 0.484 Test Acc: 0.806
Validation loss decreased (-0.788884 --> -0.805551).  Saving model ...
Epoch: 13 cost time: 0.5307173728942871
Epoch: 13, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.459 Vali Acc: 0.789 Test Loss: 0.459 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.604245662689209
Epoch: 14, Steps: 12 | Train Loss: 0.360 Vali Loss: 0.436 Vali Acc: 0.822 Test Loss: 0.436 Test Acc: 0.822
Validation loss decreased (-0.805551 --> -0.822218).  Saving model ...
Epoch: 15 cost time: 0.5961573123931885
Epoch: 15, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.411 Vali Acc: 0.839 Test Loss: 0.411 Test Acc: 0.839
Validation loss decreased (-0.822218 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.6129815578460693
Epoch: 16, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.387 Vali Acc: 0.844 Test Loss: 0.387 Test Acc: 0.844
Validation loss decreased (-0.838885 --> -0.844441).  Saving model ...
Epoch: 17 cost time: 0.5320980548858643
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.373 Vali Acc: 0.850 Test Loss: 0.373 Test Acc: 0.850
Validation loss decreased (-0.844441 --> -0.849996).  Saving model ...
Epoch: 18 cost time: 0.5502252578735352
Epoch: 18, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.361 Vali Acc: 0.861 Test Loss: 0.361 Test Acc: 0.861
Validation loss decreased (-0.849996 --> -0.861107).  Saving model ...
Epoch: 19 cost time: 0.6001265048980713
Epoch: 19, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.345 Vali Acc: 0.861 Test Loss: 0.345 Test Acc: 0.861
Validation loss decreased (-0.861107 --> -0.861108).  Saving model ...
Epoch: 20 cost time: 0.5432994365692139
Epoch: 20, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.344 Vali Acc: 0.861 Test Loss: 0.344 Test Acc: 0.861
Validation loss decreased (-0.861108 --> -0.861108).  Saving model ...
Epoch: 21 cost time: 0.6590540409088135
Epoch: 21, Steps: 12 | Train Loss: 0.261 Vali Loss: 0.323 Vali Acc: 0.900 Test Loss: 0.323 Test Acc: 0.900
Validation loss decreased (-0.861108 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.516455888748169
Epoch: 22, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.316 Vali Acc: 0.856 Test Loss: 0.316 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4688866138458252
Epoch: 23, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.304 Vali Acc: 0.894 Test Loss: 0.304 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5323560237884521
Epoch: 24, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 0.5453965663909912
Epoch: 25, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.294 Vali Acc: 0.872 Test Loss: 0.294 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5694611072540283
Epoch: 26, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.280 Vali Acc: 0.889 Test Loss: 0.280 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5656311511993408
Epoch: 27, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.276 Vali Acc: 0.900 Test Loss: 0.276 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5315432548522949
Epoch: 28, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.259 Vali Acc: 0.889 Test Loss: 0.259 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5583672523498535
Epoch: 29, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.259 Vali Acc: 0.894 Test Loss: 0.259 Test Acc: 0.894
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6053712368011475
Epoch: 30, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.249 Vali Acc: 0.900 Test Loss: 0.249 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5365803241729736
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.239 Vali Acc: 0.894 Test Loss: 0.239 Test Acc: 0.894
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5732696056365967
Epoch: 32, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.239 Vali Acc: 0.906 Test Loss: 0.239 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6416513919830322
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.230 Vali Acc: 0.917 Test Loss: 0.230 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 34 cost time: 0.5737776756286621
Epoch: 34, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.232 Vali Acc: 0.889 Test Loss: 0.232 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5353116989135742
Epoch: 35, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.225 Vali Acc: 0.917 Test Loss: 0.225 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916664).  Saving model ...
Epoch: 36 cost time: 0.6010339260101318
Epoch: 36, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.225 Vali Acc: 0.900 Test Loss: 0.225 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4804980754852295
Epoch: 37, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.215 Vali Acc: 0.911 Test Loss: 0.215 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.570974588394165
Epoch: 38, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.208 Vali Acc: 0.917 Test Loss: 0.208 Test Acc: 0.917
Validation loss decreased (-0.916664 --> -0.916665).  Saving model ...
Epoch: 39 cost time: 0.46917200088500977
Epoch: 39, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.916665 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5203845500946045
Epoch: 40, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.192 Vali Acc: 0.928 Test Loss: 0.192 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5291390419006348
Epoch: 41, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.472867488861084
Epoch: 42, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.197 Vali Acc: 0.928 Test Loss: 0.197 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5564863681793213
Epoch: 43, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.45369982719421387
Epoch: 44, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.193 Vali Acc: 0.928 Test Loss: 0.193 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.44791507720947266
Epoch: 45, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5597727298736572
Epoch: 46, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.5448105335235596
Epoch: 47, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.187 Vali Acc: 0.939 Test Loss: 0.187 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 48 cost time: 0.5570707321166992
Epoch: 48, Steps: 12 | Train Loss: 0.066 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.49708008766174316
Epoch: 49, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5787420272827148
Epoch: 50, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 51 cost time: 0.5924661159515381
Epoch: 51, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6424698829650879
Epoch: 52, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5620536804199219
Epoch: 53, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.189 Vali Acc: 0.928 Test Loss: 0.189 Test Acc: 0.928
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6401042938232422
Epoch: 54, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5016586780548096
Epoch: 55, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.176 Vali Acc: 0.950 Test Loss: 0.176 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 56 cost time: 0.610306978225708
Epoch: 56, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5844893455505371
Epoch: 57, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 58 cost time: 0.5433688163757324
Epoch: 58, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6125662326812744
Epoch: 59, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6371634006500244
Epoch: 60, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5405442714691162
Epoch: 61, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5468442440032959
Epoch: 62, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955554).  Saving model ...
Epoch: 63 cost time: 0.6761167049407959
Epoch: 63, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5929460525512695
Epoch: 64, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.571211576461792
Epoch: 65, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6169693470001221
Epoch: 66, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.955554 --> -0.966665).  Saving model ...
Epoch: 67 cost time: 0.5605220794677734
Epoch: 67, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.950 Test Loss: 0.204 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5169880390167236
Epoch: 68, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5675399303436279
Epoch: 69, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.956 Test Loss: 0.217 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5560398101806641
Epoch: 70, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6335711479187012
Epoch: 71, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5532541275024414
Epoch: 72, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5616278648376465
Epoch: 73, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.566256046295166
Epoch: 74, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.950 Test Loss: 0.277 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6195158958435059
Epoch: 75, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.950 Test Loss: 0.276 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.5557801723480225
Epoch: 76, Steps: 12 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.950 Test Loss: 0.286 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 11808
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8920371532440186
Epoch: 1, Steps: 12 | Train Loss: 1.839 Vali Loss: 1.758 Vali Acc: 0.267 Test Loss: 1.758 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.5444653034210205
Epoch: 2, Steps: 12 | Train Loss: 1.711 Vali Loss: 1.584 Vali Acc: 0.383 Test Loss: 1.584 Test Acc: 0.383
Validation loss decreased (-0.266649 --> -0.383317).  Saving model ...
Epoch: 3 cost time: 0.5630059242248535
Epoch: 3, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.384 Vali Acc: 0.633 Test Loss: 1.384 Test Acc: 0.633
Validation loss decreased (-0.383317 --> -0.633319).  Saving model ...
Epoch: 4 cost time: 0.5232102870941162
Epoch: 4, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.187 Vali Acc: 0.700 Test Loss: 1.187 Test Acc: 0.700
Validation loss decreased (-0.633319 --> -0.699988).  Saving model ...
Epoch: 5 cost time: 0.5279984474182129
Epoch: 5, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.016 Vali Acc: 0.744 Test Loss: 1.016 Test Acc: 0.744
Validation loss decreased (-0.699988 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 0.5699954032897949
Epoch: 6, Steps: 12 | Train Loss: 0.948 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6396400928497314
Epoch: 7, Steps: 12 | Train Loss: 0.741 Vali Loss: 0.752 Vali Acc: 0.767 Test Loss: 0.752 Test Acc: 0.767
Validation loss decreased (-0.744434 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 0.5778336524963379
Epoch: 8, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.664 Vali Acc: 0.772 Test Loss: 0.664 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772216).  Saving model ...
Epoch: 9 cost time: 0.5547370910644531
Epoch: 9, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
Validation loss decreased (-0.772216 --> -0.783327).  Saving model ...
Epoch: 10 cost time: 0.5949220657348633
Epoch: 10, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.543 Vali Acc: 0.817 Test Loss: 0.543 Test Acc: 0.817
Validation loss decreased (-0.783327 --> -0.816661).  Saving model ...
Epoch: 11 cost time: 0.720311164855957
Epoch: 11, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.503 Vali Acc: 0.817 Test Loss: 0.503 Test Acc: 0.817
Validation loss decreased (-0.816661 --> -0.816662).  Saving model ...
Epoch: 12 cost time: 0.6023459434509277
Epoch: 12, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.472 Vali Acc: 0.817 Test Loss: 0.472 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.614494800567627
Epoch: 13, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.442 Vali Acc: 0.833 Test Loss: 0.442 Test Acc: 0.833
Validation loss decreased (-0.816662 --> -0.833329).  Saving model ...
Epoch: 14 cost time: 0.6506528854370117
Epoch: 14, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.420 Vali Acc: 0.833 Test Loss: 0.420 Test Acc: 0.833
Validation loss decreased (-0.833329 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.5243115425109863
Epoch: 15, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.399 Vali Acc: 0.844 Test Loss: 0.399 Test Acc: 0.844
Validation loss decreased (-0.833329 --> -0.844440).  Saving model ...
Epoch: 16 cost time: 0.575838565826416
Epoch: 16, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.379 Vali Acc: 0.861 Test Loss: 0.379 Test Acc: 0.861
Validation loss decreased (-0.844440 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.6116108894348145
Epoch: 17, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.365 Vali Acc: 0.828 Test Loss: 0.365 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6402463912963867
Epoch: 18, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.342 Vali Acc: 0.883 Test Loss: 0.342 Test Acc: 0.883
Validation loss decreased (-0.861107 --> -0.883330).  Saving model ...
Epoch: 19 cost time: 0.7115254402160645
Epoch: 19, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.327 Vali Acc: 0.889 Test Loss: 0.327 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 20 cost time: 0.5576372146606445
Epoch: 20, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.5928823947906494
Epoch: 21, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.298 Vali Acc: 0.894 Test Loss: 0.298 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6686689853668213
Epoch: 22, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5773108005523682
Epoch: 23, Steps: 12 | Train Loss: 0.222 Vali Loss: 0.279 Vali Acc: 0.906 Test Loss: 0.279 Test Acc: 0.906
Validation loss decreased (-0.899997 --> -0.905553).  Saving model ...
Epoch: 24 cost time: 0.4890120029449463
Epoch: 24, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.262 Vali Acc: 0.928 Test Loss: 0.262 Test Acc: 0.928
Validation loss decreased (-0.905553 --> -0.927775).  Saving model ...
Epoch: 25 cost time: 0.5402789115905762
Epoch: 25, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.257 Vali Acc: 0.911 Test Loss: 0.257 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5091631412506104
Epoch: 26, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.57940673828125
Epoch: 27, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.237 Vali Acc: 0.928 Test Loss: 0.237 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 28 cost time: 0.5268023014068604
Epoch: 28, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.224 Vali Acc: 0.917 Test Loss: 0.224 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4957587718963623
Epoch: 29, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6601724624633789
Epoch: 30, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.221 Vali Acc: 0.911 Test Loss: 0.221 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5130236148834229
Epoch: 31, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.199 Vali Acc: 0.939 Test Loss: 0.199 Test Acc: 0.939
Validation loss decreased (-0.927775 --> -0.938887).  Saving model ...
Epoch: 32 cost time: 0.5922586917877197
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.204 Vali Acc: 0.917 Test Loss: 0.204 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.60367751121521
Epoch: 33, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5447139739990234
Epoch: 34, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.180 Vali Acc: 0.939 Test Loss: 0.180 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 35 cost time: 0.6220767498016357
Epoch: 35, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.186 Vali Acc: 0.928 Test Loss: 0.186 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.47853779792785645
Epoch: 36, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5457274913787842
Epoch: 37, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6515359878540039
Epoch: 38, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6910343170166016
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.939 Test Loss: 0.153 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 0.6818704605102539
Epoch: 40, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.172 Vali Acc: 0.928 Test Loss: 0.172 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5905132293701172
Epoch: 41, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.145 Vali Acc: 0.944 Test Loss: 0.145 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.6096224784851074
Epoch: 42, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.154 Vali Acc: 0.944 Test Loss: 0.154 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6064114570617676
Epoch: 43, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.939 Test Loss: 0.142 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6447827816009521
Epoch: 44, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.956 Test Loss: 0.148 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 45 cost time: 0.6710402965545654
Epoch: 45, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.950 Test Loss: 0.138 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6592342853546143
Epoch: 46, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.148 Vali Acc: 0.939 Test Loss: 0.148 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6754474639892578
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.131 Vali Acc: 0.950 Test Loss: 0.131 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6503214836120605
Epoch: 48, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.933 Test Loss: 0.144 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6935336589813232
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.933 Test Loss: 0.152 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7173202037811279
Epoch: 50, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.950 Test Loss: 0.134 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6450998783111572
Epoch: 51, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.922 Test Loss: 0.181 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6241400241851807
Epoch: 52, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.944 Test Loss: 0.133 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6086406707763672
Epoch: 53, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.939 Test Loss: 0.139 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.8672611713409424
Epoch: 54, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.149 Vali Acc: 0.950 Test Loss: 0.149 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11826
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.7183785438537598
Epoch: 1, Steps: 12 | Train Loss: 1.792 Vali Loss: 1.673 Vali Acc: 0.200 Test Loss: 1.673 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.4953911304473877
Epoch: 2, Steps: 12 | Train Loss: 1.640 Vali Loss: 1.513 Vali Acc: 0.389 Test Loss: 1.513 Test Acc: 0.389
Validation loss decreased (-0.199983 --> -0.388874).  Saving model ...
Epoch: 3 cost time: 0.6521048545837402
Epoch: 3, Steps: 12 | Train Loss: 1.465 Vali Loss: 1.333 Vali Acc: 0.600 Test Loss: 1.333 Test Acc: 0.600
Validation loss decreased (-0.388874 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.5285019874572754
Epoch: 4, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.155 Vali Acc: 0.678 Test Loss: 1.155 Test Acc: 0.678
Validation loss decreased (-0.599987 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.558211088180542
Epoch: 5, Steps: 12 | Train Loss: 1.067 Vali Loss: 0.987 Vali Acc: 0.689 Test Loss: 0.987 Test Acc: 0.689
Validation loss decreased (-0.677766 --> -0.688879).  Saving model ...
Epoch: 6 cost time: 0.5477957725524902
Epoch: 6, Steps: 12 | Train Loss: 0.889 Vali Loss: 0.842 Vali Acc: 0.739 Test Loss: 0.842 Test Acc: 0.739
Validation loss decreased (-0.688879 --> -0.738880).  Saving model ...
Epoch: 7 cost time: 0.5310835838317871
Epoch: 7, Steps: 12 | Train Loss: 0.747 Vali Loss: 0.728 Vali Acc: 0.744 Test Loss: 0.728 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 0.5976362228393555
Epoch: 8, Steps: 12 | Train Loss: 0.635 Vali Loss: 0.645 Vali Acc: 0.756 Test Loss: 0.645 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 9 cost time: 0.6149857044219971
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.583 Vali Acc: 0.778 Test Loss: 0.583 Test Acc: 0.778
Validation loss decreased (-0.755549 --> -0.777772).  Saving model ...
Epoch: 10 cost time: 0.44515109062194824
Epoch: 10, Steps: 12 | Train Loss: 0.501 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
Validation loss decreased (-0.777772 --> -0.788884).  Saving model ...
Epoch: 11 cost time: 0.5219063758850098
Epoch: 11, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.489 Vali Acc: 0.822 Test Loss: 0.489 Test Acc: 0.822
Validation loss decreased (-0.788884 --> -0.822217).  Saving model ...
Epoch: 12 cost time: 0.6711301803588867
Epoch: 12, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.455 Vali Acc: 0.817 Test Loss: 0.455 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5601711273193359
Epoch: 13, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.426 Vali Acc: 0.817 Test Loss: 0.426 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6671802997589111
Epoch: 14, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.399 Vali Acc: 0.833 Test Loss: 0.399 Test Acc: 0.833
Validation loss decreased (-0.822217 --> -0.833329).  Saving model ...
Epoch: 15 cost time: 0.596888542175293
Epoch: 15, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
Validation loss decreased (-0.833329 --> -0.866663).  Saving model ...
Epoch: 16 cost time: 0.5475833415985107
Epoch: 16, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5248024463653564
Epoch: 17, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.336 Vali Acc: 0.878 Test Loss: 0.336 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 18 cost time: 0.6118569374084473
Epoch: 18, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.320 Vali Acc: 0.861 Test Loss: 0.320 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6120126247406006
Epoch: 19, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.300 Vali Acc: 0.883 Test Loss: 0.300 Test Acc: 0.883
Validation loss decreased (-0.877774 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 0.6636731624603271
Epoch: 20, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.293 Vali Acc: 0.867 Test Loss: 0.293 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5658807754516602
Epoch: 21, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.285 Vali Acc: 0.889 Test Loss: 0.285 Test Acc: 0.889
Validation loss decreased (-0.883330 --> -0.888886).  Saving model ...
Epoch: 22 cost time: 0.5475871562957764
Epoch: 22, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.274 Vali Acc: 0.878 Test Loss: 0.274 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6249709129333496
Epoch: 23, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.255 Vali Acc: 0.900 Test Loss: 0.255 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.551668643951416
Epoch: 24, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.254 Vali Acc: 0.883 Test Loss: 0.254 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6505007743835449
Epoch: 25, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
Validation loss decreased (-0.899997 --> -0.911109).  Saving model ...
Epoch: 26 cost time: 0.6896913051605225
Epoch: 26, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.231 Vali Acc: 0.917 Test Loss: 0.231 Test Acc: 0.917
Validation loss decreased (-0.911109 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.6445281505584717
Epoch: 27, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.240 Vali Acc: 0.894 Test Loss: 0.240 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5141510963439941
Epoch: 28, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9837181568145752
Epoch: 29, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5647106170654297
Epoch: 30, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.906 Test Loss: 0.246 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5192673206329346
Epoch: 31, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.253 Vali Acc: 0.917 Test Loss: 0.253 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5665597915649414
Epoch: 32, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.270 Vali Acc: 0.906 Test Loss: 0.270 Test Acc: 0.906
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5367312431335449
Epoch: 33, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.49147868156433105
Epoch: 34, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4969785213470459
Epoch: 35, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.340 Vali Acc: 0.917 Test Loss: 0.340 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5397641658782959
Epoch: 36, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4626951217651367
Epoch: 37, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.47974538803100586
Epoch: 38, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.307 Vali Acc: 0.906 Test Loss: 0.307 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.578369140625
Epoch: 39, Steps: 12 | Train Loss: 0.034 Vali Loss: 0.322 Vali Acc: 0.883 Test Loss: 0.322 Test Acc: 0.883
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5657989978790283
Epoch: 40, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.320 Vali Acc: 0.906 Test Loss: 0.320 Test Acc: 0.906
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6014437675476074
Epoch: 41, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.314 Vali Acc: 0.911 Test Loss: 0.314 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.43714094161987305
Epoch: 42, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.48499107360839844
Epoch: 43, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9222222222222223
model parameter : 11746
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.774848222732544
Epoch: 1, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.772 Vali Acc: 0.156 Test Loss: 1.772 Test Acc: 0.156
Validation loss decreased (inf --> -0.155538).  Saving model ...
Epoch: 2 cost time: 0.4924600124359131
Epoch: 2, Steps: 12 | Train Loss: 1.697 Vali Loss: 1.603 Vali Acc: 0.478 Test Loss: 1.603 Test Acc: 0.478
Validation loss decreased (-0.155538 --> -0.477762).  Saving model ...
Epoch: 3 cost time: 0.5166943073272705
Epoch: 3, Steps: 12 | Train Loss: 1.506 Vali Loss: 1.400 Vali Acc: 0.639 Test Loss: 1.400 Test Acc: 0.639
Validation loss decreased (-0.477762 --> -0.638875).  Saving model ...
Epoch: 4 cost time: 0.5556936264038086
Epoch: 4, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.199 Vali Acc: 0.683 Test Loss: 1.199 Test Acc: 0.683
Validation loss decreased (-0.638875 --> -0.683321).  Saving model ...
Epoch: 5 cost time: 0.6134083271026611
Epoch: 5, Steps: 12 | Train Loss: 1.083 Vali Loss: 1.018 Vali Acc: 0.711 Test Loss: 1.018 Test Acc: 0.711
Validation loss decreased (-0.683321 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 0.5737593173980713
Epoch: 6, Steps: 12 | Train Loss: 0.943 Vali Loss: 0.874 Vali Acc: 0.717 Test Loss: 0.874 Test Acc: 0.717
Validation loss decreased (-0.711101 --> -0.716658).  Saving model ...
Epoch: 7 cost time: 0.6275036334991455
Epoch: 7, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.761 Vali Acc: 0.689 Test Loss: 0.761 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5019686222076416
Epoch: 8, Steps: 12 | Train Loss: 0.662 Vali Loss: 0.670 Vali Acc: 0.750 Test Loss: 0.670 Test Acc: 0.750
Validation loss decreased (-0.716658 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 0.5091490745544434
Epoch: 9, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.603 Vali Acc: 0.767 Test Loss: 0.603 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.543731689453125
Epoch: 10, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.548 Vali Acc: 0.761 Test Loss: 0.548 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5884764194488525
Epoch: 11, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.504 Vali Acc: 0.811 Test Loss: 0.504 Test Acc: 0.811
Validation loss decreased (-0.766661 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.5385222434997559
Epoch: 12, Steps: 12 | Train Loss: 0.415 Vali Loss: 0.474 Vali Acc: 0.811 Test Loss: 0.474 Test Acc: 0.811
Validation loss decreased (-0.811106 --> -0.811106).  Saving model ...
Epoch: 13 cost time: 0.606086254119873
Epoch: 13, Steps: 12 | Train Loss: 0.380 Vali Loss: 0.441 Vali Acc: 0.828 Test Loss: 0.441 Test Acc: 0.828
Validation loss decreased (-0.811106 --> -0.827773).  Saving model ...
Epoch: 14 cost time: 0.4747745990753174
Epoch: 14, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.422 Vali Acc: 0.844 Test Loss: 0.422 Test Acc: 0.844
Validation loss decreased (-0.827773 --> -0.844440).  Saving model ...
Epoch: 15 cost time: 0.5643846988677979
Epoch: 15, Steps: 12 | Train Loss: 0.329 Vali Loss: 0.395 Vali Acc: 0.872 Test Loss: 0.395 Test Acc: 0.872
Validation loss decreased (-0.844440 --> -0.872218).  Saving model ...
Epoch: 16 cost time: 0.5430252552032471
Epoch: 16, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.375 Vali Acc: 0.867 Test Loss: 0.375 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.47199130058288574
Epoch: 17, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.872218 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.5771362781524658
Epoch: 18, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.5431075096130371
Epoch: 19, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5046837329864502
Epoch: 20, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.5974166393280029
Epoch: 21, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 22 cost time: 0.517319917678833
Epoch: 22, Steps: 12 | Train Loss: 0.236 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5644903182983398
Epoch: 23, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.5607402324676514
Epoch: 24, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.899997 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.5093204975128174
Epoch: 25, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.46657299995422363
Epoch: 26, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938886).  Saving model ...
Epoch: 27 cost time: 0.5650677680969238
Epoch: 27, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.245 Vali Acc: 0.917 Test Loss: 0.245 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5080482959747314
Epoch: 28, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.239 Vali Acc: 0.939 Test Loss: 0.239 Test Acc: 0.939
Validation loss decreased (-0.938886 --> -0.938886).  Saving model ...
Epoch: 29 cost time: 0.5200684070587158
Epoch: 29, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5780587196350098
Epoch: 30, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5520296096801758
Epoch: 31, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.566326379776001
Epoch: 32, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.938886 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.5593326091766357
Epoch: 33, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5776786804199219
Epoch: 34, Steps: 12 | Train Loss: 0.121 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6032459735870361
Epoch: 35, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.204 Vali Acc: 0.939 Test Loss: 0.204 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6015803813934326
Epoch: 36, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.4967224597930908
Epoch: 37, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5575528144836426
Epoch: 38, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.184 Vali Acc: 0.950 Test Loss: 0.184 Test Acc: 0.950
Validation loss decreased (-0.944443 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.5094833374023438
Epoch: 39, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5189597606658936
Epoch: 40, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 41 cost time: 0.5969228744506836
Epoch: 41, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.939 Test Loss: 0.178 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5822591781616211
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.174 Vali Acc: 0.950 Test Loss: 0.174 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 43 cost time: 0.47825121879577637
Epoch: 43, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.545764684677124
Epoch: 44, Steps: 12 | Train Loss: 0.069 Vali Loss: 0.176 Vali Acc: 0.939 Test Loss: 0.176 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.509758472442627
Epoch: 45, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5608203411102295
Epoch: 46, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.170 Vali Acc: 0.928 Test Loss: 0.170 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5854051113128662
Epoch: 47, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.917 Test Loss: 0.187 Test Acc: 0.917
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5562279224395752
Epoch: 48, Steps: 12 | Train Loss: 0.059 Vali Loss: 0.161 Vali Acc: 0.950 Test Loss: 0.161 Test Acc: 0.950
Validation loss decreased (-0.949998 --> -0.949998).  Saving model ...
Epoch: 49 cost time: 0.5590488910675049
Epoch: 49, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.922 Test Loss: 0.174 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5213241577148438
Epoch: 50, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.949998 --> -0.961110).  Saving model ...
Epoch: 51 cost time: 0.5171301364898682
Epoch: 51, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.48120570182800293
Epoch: 52, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.146 Vali Acc: 0.961 Test Loss: 0.146 Test Acc: 0.961
Validation loss decreased (-0.961110 --> -0.961110).  Saving model ...
Epoch: 53 cost time: 0.534290075302124
Epoch: 53, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5239038467407227
Epoch: 54, Steps: 12 | Train Loss: 0.032 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
Validation loss decreased (-0.961110 --> -0.966665).  Saving model ...
Epoch: 55 cost time: 0.48713040351867676
Epoch: 55, Steps: 12 | Train Loss: 0.030 Vali Loss: 0.166 Vali Acc: 0.933 Test Loss: 0.166 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5123271942138672
Epoch: 56, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4124479293823242
Epoch: 57, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.158 Vali Acc: 0.950 Test Loss: 0.158 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.4914224147796631
Epoch: 58, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5219841003417969
Epoch: 59, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.5820965766906738
Epoch: 60, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.4999661445617676
Epoch: 61, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.42505812644958496
Epoch: 62, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.4134645462036133
Epoch: 63, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.4525580406188965
Epoch: 64, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9666666666666667
model parameter : 11869
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.8664271831512451
Epoch: 1, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.878 Vali Acc: 0.167 Test Loss: 1.878 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.5482320785522461
Epoch: 2, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.689 Vali Acc: 0.328 Test Loss: 1.689 Test Acc: 0.328
Validation loss decreased (-0.166648 --> -0.327761).  Saving model ...
Epoch: 3 cost time: 0.6342740058898926
Epoch: 3, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.478 Vali Acc: 0.533 Test Loss: 1.478 Test Acc: 0.533
Validation loss decreased (-0.327761 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.5571894645690918
Epoch: 4, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.260 Vali Acc: 0.639 Test Loss: 1.260 Test Acc: 0.639
Validation loss decreased (-0.533319 --> -0.638876).  Saving model ...
Epoch: 5 cost time: 0.5144984722137451
Epoch: 5, Steps: 12 | Train Loss: 1.108 Vali Loss: 1.065 Vali Acc: 0.683 Test Loss: 1.065 Test Acc: 0.683
Validation loss decreased (-0.638876 --> -0.683323).  Saving model ...
Epoch: 6 cost time: 0.6435427665710449
Epoch: 6, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.899 Vali Acc: 0.694 Test Loss: 0.899 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694435).  Saving model ...
Epoch: 7 cost time: 0.6439299583435059
Epoch: 7, Steps: 12 | Train Loss: 0.793 Vali Loss: 0.774 Vali Acc: 0.700 Test Loss: 0.774 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699992).  Saving model ...
Epoch: 8 cost time: 0.6119060516357422
Epoch: 8, Steps: 12 | Train Loss: 0.648 Vali Loss: 0.680 Vali Acc: 0.739 Test Loss: 0.680 Test Acc: 0.739
Validation loss decreased (-0.699992 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.6031765937805176
Epoch: 9, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.605 Vali Acc: 0.772 Test Loss: 0.605 Test Acc: 0.772
Validation loss decreased (-0.738882 --> -0.772216).  Saving model ...
Epoch: 10 cost time: 0.6239261627197266
Epoch: 10, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.554 Vali Acc: 0.772 Test Loss: 0.554 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 0.6419565677642822
Epoch: 11, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.509 Vali Acc: 0.806 Test Loss: 0.509 Test Acc: 0.806
Validation loss decreased (-0.772217 --> -0.805550).  Saving model ...
Epoch: 12 cost time: 0.5915002822875977
Epoch: 12, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.476 Vali Acc: 0.817 Test Loss: 0.476 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 13 cost time: 0.6298956871032715
Epoch: 13, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.447 Vali Acc: 0.817 Test Loss: 0.447 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 14 cost time: 0.631943941116333
Epoch: 14, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.425 Vali Acc: 0.839 Test Loss: 0.425 Test Acc: 0.839
Validation loss decreased (-0.816662 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 0.6897084712982178
Epoch: 15, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.403 Vali Acc: 0.833 Test Loss: 0.403 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5065293312072754
Epoch: 16, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.382 Vali Acc: 0.872 Test Loss: 0.382 Test Acc: 0.872
Validation loss decreased (-0.838885 --> -0.872218).  Saving model ...
Epoch: 17 cost time: 0.47246384620666504
Epoch: 17, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.365 Vali Acc: 0.883 Test Loss: 0.365 Test Acc: 0.883
Validation loss decreased (-0.872218 --> -0.883330).  Saving model ...
Epoch: 18 cost time: 0.6272830963134766
Epoch: 18, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.356 Vali Acc: 0.850 Test Loss: 0.356 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.610133171081543
Epoch: 19, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.339 Vali Acc: 0.883 Test Loss: 0.339 Test Acc: 0.883
Validation loss decreased (-0.883330 --> -0.883330).  Saving model ...
Epoch: 20 cost time: 0.6113817691802979
Epoch: 20, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
Validation loss decreased (-0.883330 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.5119197368621826
Epoch: 21, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.309 Vali Acc: 0.894 Test Loss: 0.309 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.48824143409729004
Epoch: 22, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.296 Vali Acc: 0.906 Test Loss: 0.296 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5048880577087402
Epoch: 23, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.291 Vali Acc: 0.894 Test Loss: 0.291 Test Acc: 0.894
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6428225040435791
Epoch: 24, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6122117042541504
Epoch: 25, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.263 Vali Acc: 0.906 Test Loss: 0.263 Test Acc: 0.906
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.544086217880249
Epoch: 26, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.259 Vali Acc: 0.917 Test Loss: 0.259 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 27 cost time: 0.4870882034301758
Epoch: 27, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5346274375915527
Epoch: 28, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.249 Vali Acc: 0.894 Test Loss: 0.249 Test Acc: 0.894
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5712869167327881
Epoch: 29, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.916664 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.6141657829284668
Epoch: 30, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.6211748123168945
Epoch: 31, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.5393526554107666
Epoch: 32, Steps: 12 | Train Loss: 0.100 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6091458797454834
Epoch: 33, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 34 cost time: 0.6112704277038574
Epoch: 34, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.223 Vali Acc: 0.906 Test Loss: 0.223 Test Acc: 0.906
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6476790904998779
Epoch: 35, Steps: 12 | Train Loss: 0.073 Vali Loss: 0.194 Vali Acc: 0.939 Test Loss: 0.194 Test Acc: 0.939
Validation loss decreased (-0.938887 --> -0.938887).  Saving model ...
Epoch: 36 cost time: 0.6226835250854492
Epoch: 36, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5902881622314453
Epoch: 37, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.217 Vali Acc: 0.911 Test Loss: 0.217 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5810229778289795
Epoch: 38, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.950 Test Loss: 0.186 Test Acc: 0.950
Validation loss decreased (-0.938887 --> -0.949998).  Saving model ...
Epoch: 39 cost time: 0.7076737880706787
Epoch: 39, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.939 Test Loss: 0.201 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5703959465026855
Epoch: 40, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6676011085510254
Epoch: 41, Steps: 12 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.939 Test Loss: 0.198 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5930840969085693
Epoch: 42, Steps: 12 | Train Loss: 0.019 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5419414043426514
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.939 Test Loss: 0.190 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6984653472900391
Epoch: 44, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6879887580871582
Epoch: 45, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6604263782501221
Epoch: 46, Steps: 12 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.939 Test Loss: 0.209 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6409869194030762
Epoch: 47, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.949998 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.6762762069702148
Epoch: 48, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.950 Test Loss: 0.213 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6077330112457275
Epoch: 49, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.956 Test Loss: 0.216 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 50 cost time: 0.6002154350280762
Epoch: 50, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5536952018737793
Epoch: 51, Steps: 12 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4995725154876709
Epoch: 52, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5780472755432129
Epoch: 53, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5317916870117188
Epoch: 54, Steps: 12 | Train Loss: 0.002 Vali Loss: 0.249 Vali Acc: 0.939 Test Loss: 0.249 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5524711608886719
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5650861263275146
Epoch: 56, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.950 Test Loss: 0.253 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5586919784545898
Epoch: 57, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.343 Vali Acc: 0.917 Test Loss: 0.343 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.5403010845184326
Epoch: 58, Steps: 12 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6000537872314453
Epoch: 59, Steps: 12 | Train Loss: 0.003 Vali Loss: 0.323 Vali Acc: 0.928 Test Loss: 0.323 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11804
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_NATOPS          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/NATOPS
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             24                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9931378364562988
Epoch: 1, Steps: 12 | Train Loss: 1.794 Vali Loss: 1.698 Vali Acc: 0.317 Test Loss: 1.698 Test Acc: 0.317
Validation loss decreased (inf --> -0.316650).  Saving model ...
Epoch: 2 cost time: 0.6668703556060791
Epoch: 2, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.536 Vali Acc: 0.461 Test Loss: 1.536 Test Acc: 0.461
Validation loss decreased (-0.316650 --> -0.461096).  Saving model ...
Epoch: 3 cost time: 0.5901939868927002
Epoch: 3, Steps: 12 | Train Loss: 1.474 Vali Loss: 1.345 Vali Acc: 0.567 Test Loss: 1.345 Test Acc: 0.567
Validation loss decreased (-0.461096 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 0.5866429805755615
Epoch: 4, Steps: 12 | Train Loss: 1.262 Vali Loss: 1.152 Vali Acc: 0.656 Test Loss: 1.152 Test Acc: 0.656
Validation loss decreased (-0.566653 --> -0.655544).  Saving model ...
Epoch: 5 cost time: 0.6624634265899658
Epoch: 5, Steps: 12 | Train Loss: 1.031 Vali Loss: 0.978 Vali Acc: 0.711 Test Loss: 0.978 Test Acc: 0.711
Validation loss decreased (-0.655544 --> -0.711101).  Saving model ...
Epoch: 6 cost time: 0.6080770492553711
Epoch: 6, Steps: 12 | Train Loss: 0.904 Vali Loss: 0.834 Vali Acc: 0.722 Test Loss: 0.834 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722214).  Saving model ...
Epoch: 7 cost time: 0.598365306854248
Epoch: 7, Steps: 12 | Train Loss: 0.754 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733326).  Saving model ...
Epoch: 8 cost time: 0.6056382656097412
Epoch: 8, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.642 Vali Acc: 0.739 Test Loss: 0.642 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738882).  Saving model ...
Epoch: 9 cost time: 0.6193339824676514
Epoch: 9, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.580 Vali Acc: 0.767 Test Loss: 0.580 Test Acc: 0.767
Validation loss decreased (-0.738882 --> -0.766661).  Saving model ...
Epoch: 10 cost time: 0.5902783870697021
Epoch: 10, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.532 Vali Acc: 0.772 Test Loss: 0.532 Test Acc: 0.772
Validation loss decreased (-0.766661 --> -0.772217).  Saving model ...
Epoch: 11 cost time: 0.5556075572967529
Epoch: 11, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.488 Vali Acc: 0.811 Test Loss: 0.488 Test Acc: 0.811
Validation loss decreased (-0.772217 --> -0.811106).  Saving model ...
Epoch: 12 cost time: 0.588266134262085
Epoch: 12, Steps: 12 | Train Loss: 0.423 Vali Loss: 0.460 Vali Acc: 0.800 Test Loss: 0.460 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5849909782409668
Epoch: 13, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.435 Vali Acc: 0.800 Test Loss: 0.435 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5765666961669922
Epoch: 14, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.404 Vali Acc: 0.839 Test Loss: 0.404 Test Acc: 0.839
Validation loss decreased (-0.811106 --> -0.838885).  Saving model ...
Epoch: 15 cost time: 0.521751880645752
Epoch: 15, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.388 Vali Acc: 0.839 Test Loss: 0.388 Test Acc: 0.839
Validation loss decreased (-0.838885 --> -0.838885).  Saving model ...
Epoch: 16 cost time: 0.5230503082275391
Epoch: 16, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.375 Vali Acc: 0.861 Test Loss: 0.375 Test Acc: 0.861
Validation loss decreased (-0.838885 --> -0.861107).  Saving model ...
Epoch: 17 cost time: 0.5185661315917969
Epoch: 17, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
Validation loss decreased (-0.861107 --> -0.888885).  Saving model ...
Epoch: 18 cost time: 0.5952918529510498
Epoch: 18, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.341 Vali Acc: 0.889 Test Loss: 0.341 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 19 cost time: 0.5373644828796387
Epoch: 19, Steps: 12 | Train Loss: 0.273 Vali Loss: 0.331 Vali Acc: 0.894 Test Loss: 0.331 Test Acc: 0.894
Validation loss decreased (-0.888885 --> -0.894441).  Saving model ...
Epoch: 20 cost time: 0.539677619934082
Epoch: 20, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.322 Vali Acc: 0.878 Test Loss: 0.322 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6662230491638184
Epoch: 21, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.308 Vali Acc: 0.906 Test Loss: 0.308 Test Acc: 0.906
Validation loss decreased (-0.894441 --> -0.905552).  Saving model ...
Epoch: 22 cost time: 0.5121190547943115
Epoch: 22, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
Validation loss decreased (-0.905552 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.4946863651275635
Epoch: 23, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.5634078979492188
Epoch: 24, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.281 Vali Acc: 0.917 Test Loss: 0.281 Test Acc: 0.917
Validation loss decreased (-0.911108 --> -0.916664).  Saving model ...
Epoch: 25 cost time: 0.5623834133148193
Epoch: 25, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6766049861907959
Epoch: 26, Steps: 12 | Train Loss: 0.169 Vali Loss: 0.269 Vali Acc: 0.883 Test Loss: 0.269 Test Acc: 0.883
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6638615131378174
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.252 Vali Acc: 0.906 Test Loss: 0.252 Test Acc: 0.906
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5161030292510986
Epoch: 28, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5477473735809326
Epoch: 29, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.236 Vali Acc: 0.928 Test Loss: 0.236 Test Acc: 0.928
Validation loss decreased (-0.916664 --> -0.927775).  Saving model ...
Epoch: 30 cost time: 0.5450608730316162
Epoch: 30, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.229 Vali Acc: 0.928 Test Loss: 0.229 Test Acc: 0.928
Validation loss decreased (-0.927775 --> -0.927775).  Saving model ...
Epoch: 31 cost time: 0.5095751285552979
Epoch: 31, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5416433811187744
Epoch: 32, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.927775 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.5274820327758789
Epoch: 33, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.202 Vali Acc: 0.928 Test Loss: 0.202 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.489854097366333
Epoch: 34, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.218 Vali Acc: 0.917 Test Loss: 0.218 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5179183483123779
Epoch: 35, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5534741878509521
Epoch: 36, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.202 Vali Acc: 0.906 Test Loss: 0.202 Test Acc: 0.906
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6452391147613525
Epoch: 37, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.6381649971008301
Epoch: 38, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.228 Vali Acc: 0.900 Test Loss: 0.228 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6045737266540527
Epoch: 39, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.170 Vali Acc: 0.939 Test Loss: 0.170 Test Acc: 0.939
Validation loss decreased (-0.933331 --> -0.938887).  Saving model ...
Epoch: 40 cost time: 0.7028782367706299
Epoch: 40, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6064610481262207
Epoch: 41, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.182 Vali Acc: 0.917 Test Loss: 0.182 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5521085262298584
Epoch: 42, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.158 Vali Acc: 0.933 Test Loss: 0.158 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.545135498046875
Epoch: 43, Steps: 12 | Train Loss: 0.054 Vali Loss: 0.177 Vali Acc: 0.928 Test Loss: 0.177 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5605998039245605
Epoch: 44, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.938887 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.6565585136413574
Epoch: 45, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.911 Test Loss: 0.209 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5891473293304443
Epoch: 46, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6408562660217285
Epoch: 47, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.140 Vali Acc: 0.939 Test Loss: 0.140 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6446487903594971
Epoch: 48, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5819580554962158
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.928 Test Loss: 0.160 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.569011926651001
Epoch: 50, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 51 cost time: 0.703418493270874
Epoch: 51, Steps: 12 | Train Loss: 0.042 Vali Loss: 0.183 Vali Acc: 0.917 Test Loss: 0.183 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5663783550262451
Epoch: 52, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.956 Test Loss: 0.134 Test Acc: 0.956
Validation loss decreased (-0.944443 --> -0.955554).  Saving model ...
Epoch: 53 cost time: 0.6505467891693115
Epoch: 53, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.157 Vali Acc: 0.950 Test Loss: 0.157 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.583453893661499
Epoch: 54, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.205 Vali Acc: 0.906 Test Loss: 0.205 Test Acc: 0.906
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5302474498748779
Epoch: 55, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.944 Test Loss: 0.128 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5330822467803955
Epoch: 56, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.928 Test Loss: 0.157 Test Acc: 0.928
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5134594440460205
Epoch: 57, Steps: 12 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.944 Test Loss: 0.136 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6550371646881104
Epoch: 58, Steps: 12 | Train Loss: 0.014 Vali Loss: 0.162 Vali Acc: 0.917 Test Loss: 0.162 Test Acc: 0.917
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6584749221801758
Epoch: 59, Steps: 12 | Train Loss: 0.013 Vali Loss: 0.146 Vali Acc: 0.933 Test Loss: 0.146 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.4820213317871094
Epoch: 60, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.147 Vali Acc: 0.939 Test Loss: 0.147 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.6885199546813965
Epoch: 61, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.950 Test Loss: 0.119 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.4632112979888916
Epoch: 62, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.939 Test Loss: 0.150 Test Acc: 0.939
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_NATOPS_LightTS_UEA_ftM_sl51_ll0_pl0_dm32_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 6]) torch.Size([180, 1])
accuracy:0.9555555555555556
model parameter : 11993
model size : 0.06MB
