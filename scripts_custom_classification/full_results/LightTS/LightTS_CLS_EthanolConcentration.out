Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8584372997283936
Epoch: 1, Steps: 17 | Train Loss: 3.902 Vali Loss: 4.381 Vali Acc: 0.255 Test Loss: 4.381 Test Acc: 0.255
Validation loss decreased (inf --> -0.254709).  Saving model ...
Epoch: 2 cost time: 0.7558436393737793
Epoch: 2, Steps: 17 | Train Loss: 3.802 Vali Loss: 5.432 Vali Acc: 0.266 Test Loss: 5.432 Test Acc: 0.266
Validation loss decreased (-0.254709 --> -0.266105).  Saving model ...
Epoch: 3 cost time: 0.7245657444000244
Epoch: 3, Steps: 17 | Train Loss: 5.039 Vali Loss: 4.121 Vali Acc: 0.236 Test Loss: 4.121 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9166202545166016
Epoch: 4, Steps: 17 | Train Loss: 6.637 Vali Loss: 15.351 Vali Acc: 0.255 Test Loss: 15.351 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8513448238372803
Epoch: 5, Steps: 17 | Train Loss: 9.107 Vali Loss: 16.853 Vali Acc: 0.270 Test Loss: 16.853 Test Acc: 0.270
Validation loss decreased (-0.266105 --> -0.269793).  Saving model ...
Epoch: 6 cost time: 0.730595588684082
Epoch: 6, Steps: 17 | Train Loss: 9.068 Vali Loss: 9.850 Vali Acc: 0.266 Test Loss: 9.850 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7160143852233887
Epoch: 7, Steps: 17 | Train Loss: 5.287 Vali Loss: 7.667 Vali Acc: 0.270 Test Loss: 7.667 Test Acc: 0.270
Validation loss decreased (-0.269793 --> -0.269885).  Saving model ...
Epoch: 8 cost time: 0.8402683734893799
Epoch: 8, Steps: 17 | Train Loss: 5.814 Vali Loss: 9.096 Vali Acc: 0.274 Test Loss: 9.096 Test Acc: 0.274
Validation loss decreased (-0.269885 --> -0.273673).  Saving model ...
Epoch: 9 cost time: 0.7693061828613281
Epoch: 9, Steps: 17 | Train Loss: 7.384 Vali Loss: 8.390 Vali Acc: 0.259 Test Loss: 8.390 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8300292491912842
Epoch: 10, Steps: 17 | Train Loss: 6.274 Vali Loss: 7.171 Vali Acc: 0.270 Test Loss: 7.171 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.739337682723999
Epoch: 11, Steps: 17 | Train Loss: 3.370 Vali Loss: 5.981 Vali Acc: 0.259 Test Loss: 5.981 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8692197799682617
Epoch: 12, Steps: 17 | Train Loss: 4.547 Vali Loss: 7.974 Vali Acc: 0.236 Test Loss: 7.974 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6313133239746094
Epoch: 13, Steps: 17 | Train Loss: 2.830 Vali Loss: 5.367 Vali Acc: 0.278 Test Loss: 5.367 Test Acc: 0.278
Validation loss decreased (-0.273673 --> -0.277513).  Saving model ...
Epoch: 14 cost time: 0.8000528812408447
Epoch: 14, Steps: 17 | Train Loss: 3.117 Vali Loss: 9.535 Vali Acc: 0.243 Test Loss: 9.535 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7685403823852539
Epoch: 15, Steps: 17 | Train Loss: 3.228 Vali Loss: 7.798 Vali Acc: 0.274 Test Loss: 7.798 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7862966060638428
Epoch: 16, Steps: 17 | Train Loss: 2.891 Vali Loss: 6.929 Vali Acc: 0.266 Test Loss: 6.929 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6900768280029297
Epoch: 17, Steps: 17 | Train Loss: 2.448 Vali Loss: 5.623 Vali Acc: 0.262 Test Loss: 5.623 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6852025985717773
Epoch: 18, Steps: 17 | Train Loss: 2.052 Vali Loss: 5.027 Vali Acc: 0.259 Test Loss: 5.027 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8588457107543945
Epoch: 19, Steps: 17 | Train Loss: 1.992 Vali Loss: 6.313 Vali Acc: 0.266 Test Loss: 6.313 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6966803073883057
Epoch: 20, Steps: 17 | Train Loss: 2.700 Vali Loss: 4.762 Vali Acc: 0.285 Test Loss: 4.762 Test Acc: 0.285
Validation loss decreased (-0.277513 --> -0.285123).  Saving model ...
Epoch: 21 cost time: 0.7918574810028076
Epoch: 21, Steps: 17 | Train Loss: 2.455 Vali Loss: 9.035 Vali Acc: 0.259 Test Loss: 9.035 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7141046524047852
Epoch: 22, Steps: 17 | Train Loss: 2.718 Vali Loss: 6.794 Vali Acc: 0.243 Test Loss: 6.794 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7814133167266846
Epoch: 23, Steps: 17 | Train Loss: 3.509 Vali Loss: 6.069 Vali Acc: 0.228 Test Loss: 6.069 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6814591884613037
Epoch: 24, Steps: 17 | Train Loss: 3.232 Vali Loss: 6.313 Vali Acc: 0.247 Test Loss: 6.313 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7186710834503174
Epoch: 25, Steps: 17 | Train Loss: 2.894 Vali Loss: 7.554 Vali Acc: 0.236 Test Loss: 7.554 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6899838447570801
Epoch: 26, Steps: 17 | Train Loss: 2.892 Vali Loss: 9.009 Vali Acc: 0.247 Test Loss: 9.009 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7600345611572266
Epoch: 27, Steps: 17 | Train Loss: 3.690 Vali Loss: 6.935 Vali Acc: 0.270 Test Loss: 6.935 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.760371208190918
Epoch: 28, Steps: 17 | Train Loss: 3.514 Vali Loss: 8.265 Vali Acc: 0.251 Test Loss: 8.265 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7431483268737793
Epoch: 29, Steps: 17 | Train Loss: 3.677 Vali Loss: 6.246 Vali Acc: 0.262 Test Loss: 6.246 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7372426986694336
Epoch: 30, Steps: 17 | Train Loss: 2.589 Vali Loss: 7.699 Vali Acc: 0.236 Test Loss: 7.699 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3527820
model size : 13.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs584_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2629199028015137
Epoch: 1, Steps: 17 | Train Loss: 4.904 Vali Loss: 7.844 Vali Acc: 0.259 Test Loss: 7.844 Test Acc: 0.259
Validation loss decreased (inf --> -0.258477).  Saving model ...
Epoch: 2 cost time: 0.7479617595672607
Epoch: 2, Steps: 17 | Train Loss: 5.286 Vali Loss: 7.805 Vali Acc: 0.266 Test Loss: 7.805 Test Acc: 0.266
Validation loss decreased (-0.258477 --> -0.266082).  Saving model ...
Epoch: 3 cost time: 0.788428783416748
Epoch: 3, Steps: 17 | Train Loss: 5.053 Vali Loss: 13.072 Vali Acc: 0.251 Test Loss: 13.072 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8212642669677734
Epoch: 4, Steps: 17 | Train Loss: 8.701 Vali Loss: 6.029 Vali Acc: 0.289 Test Loss: 6.029 Test Acc: 0.289
Validation loss decreased (-0.266082 --> -0.288913).  Saving model ...
Epoch: 5 cost time: 0.7521193027496338
Epoch: 5, Steps: 17 | Train Loss: 7.671 Vali Loss: 18.514 Vali Acc: 0.247 Test Loss: 18.514 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7744390964508057
Epoch: 6, Steps: 17 | Train Loss: 9.974 Vali Loss: 12.660 Vali Acc: 0.228 Test Loss: 12.660 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.8875265121459961
Epoch: 7, Steps: 17 | Train Loss: 7.435 Vali Loss: 10.800 Vali Acc: 0.228 Test Loss: 10.800 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6697149276733398
Epoch: 8, Steps: 17 | Train Loss: 5.738 Vali Loss: 7.433 Vali Acc: 0.266 Test Loss: 7.433 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8022153377532959
Epoch: 9, Steps: 17 | Train Loss: 5.750 Vali Loss: 10.543 Vali Acc: 0.243 Test Loss: 10.543 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6763010025024414
Epoch: 10, Steps: 17 | Train Loss: 5.963 Vali Loss: 5.801 Vali Acc: 0.247 Test Loss: 5.801 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7507889270782471
Epoch: 11, Steps: 17 | Train Loss: 3.574 Vali Loss: 9.322 Vali Acc: 0.274 Test Loss: 9.322 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.929802417755127
Epoch: 12, Steps: 17 | Train Loss: 3.941 Vali Loss: 6.396 Vali Acc: 0.255 Test Loss: 6.396 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8624601364135742
Epoch: 13, Steps: 17 | Train Loss: 2.507 Vali Loss: 5.237 Vali Acc: 0.228 Test Loss: 5.237 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9010872840881348
Epoch: 14, Steps: 17 | Train Loss: 4.355 Vali Loss: 6.095 Vali Acc: 0.281 Test Loss: 6.095 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs584_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3453082
model size : 13.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs438_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.203721046447754
Epoch: 1, Steps: 17 | Train Loss: 5.980 Vali Loss: 9.772 Vali Acc: 0.247 Test Loss: 9.772 Test Acc: 0.247
Validation loss decreased (inf --> -0.247051).  Saving model ...
Epoch: 2 cost time: 0.799126386642456
Epoch: 2, Steps: 17 | Train Loss: 5.240 Vali Loss: 8.417 Vali Acc: 0.262 Test Loss: 8.417 Test Acc: 0.262
Validation loss decreased (-0.247051 --> -0.262273).  Saving model ...
Epoch: 3 cost time: 0.6947200298309326
Epoch: 3, Steps: 17 | Train Loss: 4.694 Vali Loss: 14.079 Vali Acc: 0.278 Test Loss: 14.079 Test Acc: 0.278
Validation loss decreased (-0.262273 --> -0.277426).  Saving model ...
Epoch: 4 cost time: 0.9177629947662354
Epoch: 4, Steps: 17 | Train Loss: 7.970 Vali Loss: 11.512 Vali Acc: 0.243 Test Loss: 11.512 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.765977144241333
Epoch: 5, Steps: 17 | Train Loss: 6.424 Vali Loss: 14.243 Vali Acc: 0.243 Test Loss: 14.243 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.825047492980957
Epoch: 6, Steps: 17 | Train Loss: 6.311 Vali Loss: 10.211 Vali Acc: 0.240 Test Loss: 10.211 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.796654224395752
Epoch: 7, Steps: 17 | Train Loss: 4.955 Vali Loss: 10.793 Vali Acc: 0.251 Test Loss: 10.793 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.811272144317627
Epoch: 8, Steps: 17 | Train Loss: 5.463 Vali Loss: 22.666 Vali Acc: 0.251 Test Loss: 22.666 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0560171604156494
Epoch: 9, Steps: 17 | Train Loss: 9.130 Vali Loss: 11.743 Vali Acc: 0.240 Test Loss: 11.743 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7838625907897949
Epoch: 10, Steps: 17 | Train Loss: 5.524 Vali Loss: 6.495 Vali Acc: 0.278 Test Loss: 6.495 Test Acc: 0.278
Validation loss decreased (-0.277426 --> -0.277502).  Saving model ...
Epoch: 11 cost time: 0.9283895492553711
Epoch: 11, Steps: 17 | Train Loss: 3.021 Vali Loss: 7.227 Vali Acc: 0.259 Test Loss: 7.227 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7309219837188721
Epoch: 12, Steps: 17 | Train Loss: 3.330 Vali Loss: 6.845 Vali Acc: 0.251 Test Loss: 6.845 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9261603355407715
Epoch: 13, Steps: 17 | Train Loss: 3.394 Vali Loss: 8.814 Vali Acc: 0.240 Test Loss: 8.814 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7401862144470215
Epoch: 14, Steps: 17 | Train Loss: 3.429 Vali Loss: 5.893 Vali Acc: 0.255 Test Loss: 5.893 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7878334522247314
Epoch: 15, Steps: 17 | Train Loss: 2.705 Vali Loss: 6.665 Vali Acc: 0.236 Test Loss: 6.665 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7902827262878418
Epoch: 16, Steps: 17 | Train Loss: 3.242 Vali Loss: 7.816 Vali Acc: 0.247 Test Loss: 7.816 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.892448902130127
Epoch: 17, Steps: 17 | Train Loss: 3.378 Vali Loss: 7.266 Vali Acc: 0.247 Test Loss: 7.266 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9356212615966797
Epoch: 18, Steps: 17 | Train Loss: 2.868 Vali Loss: 4.706 Vali Acc: 0.251 Test Loss: 4.706 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9346556663513184
Epoch: 19, Steps: 17 | Train Loss: 2.084 Vali Loss: 6.878 Vali Acc: 0.285 Test Loss: 6.878 Test Acc: 0.285
Validation loss decreased (-0.277502 --> -0.285102).  Saving model ...
Epoch: 20 cost time: 0.8673648834228516
Epoch: 20, Steps: 17 | Train Loss: 3.302 Vali Loss: 6.766 Vali Acc: 0.247 Test Loss: 6.766 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7822508811950684
Epoch: 21, Steps: 17 | Train Loss: 2.013 Vali Loss: 7.169 Vali Acc: 0.270 Test Loss: 7.169 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.847907304763794
Epoch: 22, Steps: 17 | Train Loss: 3.466 Vali Loss: 6.490 Vali Acc: 0.243 Test Loss: 6.490 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8786110877990723
Epoch: 23, Steps: 17 | Train Loss: 2.317 Vali Loss: 7.633 Vali Acc: 0.217 Test Loss: 7.633 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9661977291107178
Epoch: 24, Steps: 17 | Train Loss: 2.955 Vali Loss: 8.775 Vali Acc: 0.232 Test Loss: 8.775 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8966989517211914
Epoch: 25, Steps: 17 | Train Loss: 3.004 Vali Loss: 7.877 Vali Acc: 0.247 Test Loss: 7.877 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7757220268249512
Epoch: 26, Steps: 17 | Train Loss: 2.521 Vali Loss: 5.963 Vali Acc: 0.262 Test Loss: 5.963 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8741919994354248
Epoch: 27, Steps: 17 | Train Loss: 2.001 Vali Loss: 6.320 Vali Acc: 0.243 Test Loss: 6.320 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.913238525390625
Epoch: 28, Steps: 17 | Train Loss: 3.347 Vali Loss: 5.504 Vali Acc: 0.255 Test Loss: 5.504 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8560752868652344
Epoch: 29, Steps: 17 | Train Loss: 2.551 Vali Loss: 7.120 Vali Acc: 0.251 Test Loss: 7.120 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs438_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3415724
model size : 13.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9636554718017578
Epoch: 1, Steps: 17 | Train Loss: 5.753 Vali Loss: 4.871 Vali Acc: 0.251 Test Loss: 4.871 Test Acc: 0.251
Validation loss decreased (inf --> -0.250902).  Saving model ...
Epoch: 2 cost time: 0.7755811214447021
Epoch: 2, Steps: 17 | Train Loss: 4.465 Vali Loss: 6.303 Vali Acc: 0.266 Test Loss: 6.303 Test Acc: 0.266
Validation loss decreased (-0.250902 --> -0.266097).  Saving model ...
Epoch: 3 cost time: 0.8402597904205322
Epoch: 3, Steps: 17 | Train Loss: 5.102 Vali Loss: 13.708 Vali Acc: 0.259 Test Loss: 13.708 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9781267642974854
Epoch: 4, Steps: 17 | Train Loss: 6.018 Vali Loss: 6.815 Vali Acc: 0.224 Test Loss: 6.815 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8207290172576904
Epoch: 5, Steps: 17 | Train Loss: 6.285 Vali Loss: 12.837 Vali Acc: 0.266 Test Loss: 12.837 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7229371070861816
Epoch: 6, Steps: 17 | Train Loss: 5.969 Vali Loss: 15.328 Vali Acc: 0.251 Test Loss: 15.328 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.763197660446167
Epoch: 7, Steps: 17 | Train Loss: 8.660 Vali Loss: 16.368 Vali Acc: 0.243 Test Loss: 16.368 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8242158889770508
Epoch: 8, Steps: 17 | Train Loss: 5.822 Vali Loss: 11.014 Vali Acc: 0.243 Test Loss: 11.014 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.642113208770752
Epoch: 9, Steps: 17 | Train Loss: 4.588 Vali Loss: 14.551 Vali Acc: 0.236 Test Loss: 14.551 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.676048994064331
Epoch: 10, Steps: 17 | Train Loss: 5.995 Vali Loss: 6.572 Vali Acc: 0.266 Test Loss: 6.572 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7390806674957275
Epoch: 11, Steps: 17 | Train Loss: 3.236 Vali Loss: 6.947 Vali Acc: 0.232 Test Loss: 6.947 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8078651428222656
Epoch: 12, Steps: 17 | Train Loss: 3.278 Vali Loss: 6.192 Vali Acc: 0.259 Test Loss: 6.192 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 3398727
model size : 12.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.452577590942383
Epoch: 1, Steps: 17 | Train Loss: 4.924 Vali Loss: 6.446 Vali Acc: 0.259 Test Loss: 6.446 Test Acc: 0.259
Validation loss decreased (inf --> -0.258491).  Saving model ...
Epoch: 2 cost time: 0.8385105133056641
Epoch: 2, Steps: 17 | Train Loss: 5.291 Vali Loss: 4.789 Vali Acc: 0.243 Test Loss: 4.789 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7617597579956055
Epoch: 3, Steps: 17 | Train Loss: 4.019 Vali Loss: 4.561 Vali Acc: 0.285 Test Loss: 4.561 Test Acc: 0.285
Validation loss decreased (-0.258491 --> -0.285125).  Saving model ...
Epoch: 4 cost time: 0.8438661098480225
Epoch: 4, Steps: 17 | Train Loss: 3.529 Vali Loss: 5.731 Vali Acc: 0.259 Test Loss: 5.731 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6665806770324707
Epoch: 5, Steps: 17 | Train Loss: 6.166 Vali Loss: 10.126 Vali Acc: 0.274 Test Loss: 10.126 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.082207202911377
Epoch: 6, Steps: 17 | Train Loss: 4.563 Vali Loss: 9.568 Vali Acc: 0.262 Test Loss: 9.568 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7603645324707031
Epoch: 7, Steps: 17 | Train Loss: 6.092 Vali Loss: 11.649 Vali Acc: 0.251 Test Loss: 11.649 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7012701034545898
Epoch: 8, Steps: 17 | Train Loss: 3.746 Vali Loss: 12.092 Vali Acc: 0.274 Test Loss: 12.092 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7751049995422363
Epoch: 9, Steps: 17 | Train Loss: 7.078 Vali Loss: 15.866 Vali Acc: 0.243 Test Loss: 15.866 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7623436450958252
Epoch: 10, Steps: 17 | Train Loss: 4.846 Vali Loss: 12.471 Vali Acc: 0.259 Test Loss: 12.471 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6493778228759766
Epoch: 11, Steps: 17 | Train Loss: 7.146 Vali Loss: 6.643 Vali Acc: 0.240 Test Loss: 6.643 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7920122146606445
Epoch: 12, Steps: 17 | Train Loss: 5.535 Vali Loss: 5.837 Vali Acc: 0.255 Test Loss: 5.837 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8973627090454102
Epoch: 13, Steps: 17 | Train Loss: 2.954 Vali Loss: 7.754 Vali Acc: 0.232 Test Loss: 7.754 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3378396
model size : 12.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0189309120178223
Epoch: 1, Steps: 17 | Train Loss: 4.979 Vali Loss: 8.139 Vali Acc: 0.224 Test Loss: 8.139 Test Acc: 0.224
Validation loss decreased (inf --> -0.224253).  Saving model ...
Epoch: 2 cost time: 0.7747273445129395
Epoch: 2, Steps: 17 | Train Loss: 6.078 Vali Loss: 4.439 Vali Acc: 0.255 Test Loss: 4.439 Test Acc: 0.255
Validation loss decreased (-0.224253 --> -0.254708).  Saving model ...
Epoch: 3 cost time: 0.6979765892028809
Epoch: 3, Steps: 17 | Train Loss: 5.812 Vali Loss: 16.069 Vali Acc: 0.259 Test Loss: 16.069 Test Acc: 0.259
Validation loss decreased (-0.254708 --> -0.258394).  Saving model ...
Epoch: 4 cost time: 0.6987335681915283
Epoch: 4, Steps: 17 | Train Loss: 9.369 Vali Loss: 6.342 Vali Acc: 0.297 Test Loss: 6.342 Test Acc: 0.297
Validation loss decreased (-0.258394 --> -0.296515).  Saving model ...
Epoch: 5 cost time: 0.7991840839385986
Epoch: 5, Steps: 17 | Train Loss: 7.010 Vali Loss: 9.916 Vali Acc: 0.278 Test Loss: 9.916 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7641026973724365
Epoch: 6, Steps: 17 | Train Loss: 5.229 Vali Loss: 11.154 Vali Acc: 0.262 Test Loss: 11.154 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7107412815093994
Epoch: 7, Steps: 17 | Train Loss: 5.069 Vali Loss: 7.214 Vali Acc: 0.224 Test Loss: 7.214 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6633801460266113
Epoch: 8, Steps: 17 | Train Loss: 5.380 Vali Loss: 6.699 Vali Acc: 0.243 Test Loss: 6.699 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7575008869171143
Epoch: 9, Steps: 17 | Train Loss: 5.151 Vali Loss: 12.499 Vali Acc: 0.243 Test Loss: 12.499 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7310638427734375
Epoch: 10, Steps: 17 | Train Loss: 6.366 Vali Loss: 9.667 Vali Acc: 0.243 Test Loss: 9.667 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8597009181976318
Epoch: 11, Steps: 17 | Train Loss: 4.327 Vali Loss: 6.511 Vali Acc: 0.259 Test Loss: 6.511 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6411676406860352
Epoch: 12, Steps: 17 | Train Loss: 2.790 Vali Loss: 5.272 Vali Acc: 0.274 Test Loss: 5.272 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.935676097869873
Epoch: 13, Steps: 17 | Train Loss: 2.867 Vali Loss: 9.723 Vali Acc: 0.240 Test Loss: 9.723 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7907118797302246
Epoch: 14, Steps: 17 | Train Loss: 3.162 Vali Loss: 7.324 Vali Acc: 0.255 Test Loss: 7.324 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3376685
model size : 12.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.155129909515381
Epoch: 1, Steps: 17 | Train Loss: 3.700 Vali Loss: 3.138 Vali Acc: 0.278 Test Loss: 3.138 Test Acc: 0.278
Validation loss decreased (inf --> -0.277535).  Saving model ...
Epoch: 2 cost time: 0.8811192512512207
Epoch: 2, Steps: 17 | Train Loss: 4.801 Vali Loss: 7.401 Vali Acc: 0.247 Test Loss: 7.401 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7105119228363037
Epoch: 3, Steps: 17 | Train Loss: 5.434 Vali Loss: 7.033 Vali Acc: 0.270 Test Loss: 7.033 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7979714870452881
Epoch: 4, Steps: 17 | Train Loss: 6.003 Vali Loss: 5.846 Vali Acc: 0.274 Test Loss: 5.846 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7942395210266113
Epoch: 5, Steps: 17 | Train Loss: 6.079 Vali Loss: 7.212 Vali Acc: 0.281 Test Loss: 7.212 Test Acc: 0.281
Validation loss decreased (-0.277535 --> -0.281297).  Saving model ...
Epoch: 6 cost time: 0.7043490409851074
Epoch: 6, Steps: 17 | Train Loss: 7.692 Vali Loss: 8.745 Vali Acc: 0.266 Test Loss: 8.745 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7390146255493164
Epoch: 7, Steps: 17 | Train Loss: 6.890 Vali Loss: 12.886 Vali Acc: 0.262 Test Loss: 12.886 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7764737606048584
Epoch: 8, Steps: 17 | Train Loss: 6.985 Vali Loss: 7.479 Vali Acc: 0.251 Test Loss: 7.479 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8066151142120361
Epoch: 9, Steps: 17 | Train Loss: 6.436 Vali Loss: 8.789 Vali Acc: 0.255 Test Loss: 8.789 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7544946670532227
Epoch: 10, Steps: 17 | Train Loss: 3.435 Vali Loss: 11.845 Vali Acc: 0.232 Test Loss: 11.845 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.794003963470459
Epoch: 11, Steps: 17 | Train Loss: 6.722 Vali Loss: 12.165 Vali Acc: 0.243 Test Loss: 12.165 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8058700561523438
Epoch: 12, Steps: 17 | Train Loss: 5.002 Vali Loss: 7.606 Vali Acc: 0.266 Test Loss: 7.606 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7784900665283203
Epoch: 13, Steps: 17 | Train Loss: 3.226 Vali Loss: 5.717 Vali Acc: 0.259 Test Loss: 5.717 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7493507862091064
Epoch: 14, Steps: 17 | Train Loss: 2.315 Vali Loss: 6.214 Vali Acc: 0.259 Test Loss: 6.214 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7394766807556152
Epoch: 15, Steps: 17 | Train Loss: 2.428 Vali Loss: 6.573 Vali Acc: 0.228 Test Loss: 6.573 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3359772
model size : 12.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.071603298187256
Epoch: 1, Steps: 17 | Train Loss: 5.629 Vali Loss: 4.419 Vali Acc: 0.243 Test Loss: 4.419 Test Acc: 0.243
Validation loss decreased (inf --> -0.243302).  Saving model ...
Epoch: 2 cost time: 0.7586126327514648
Epoch: 2, Steps: 17 | Train Loss: 4.528 Vali Loss: 5.427 Vali Acc: 0.259 Test Loss: 5.427 Test Acc: 0.259
Validation loss decreased (-0.243302 --> -0.258501).  Saving model ...
Epoch: 3 cost time: 0.7303109169006348
Epoch: 3, Steps: 17 | Train Loss: 4.132 Vali Loss: 5.076 Vali Acc: 0.274 Test Loss: 5.076 Test Acc: 0.274
Validation loss decreased (-0.258501 --> -0.273713).  Saving model ...
Epoch: 4 cost time: 0.785520076751709
Epoch: 4, Steps: 17 | Train Loss: 6.604 Vali Loss: 15.218 Vali Acc: 0.266 Test Loss: 15.218 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7258234024047852
Epoch: 5, Steps: 17 | Train Loss: 7.397 Vali Loss: 10.168 Vali Acc: 0.255 Test Loss: 10.168 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9729905128479004
Epoch: 6, Steps: 17 | Train Loss: 6.779 Vali Loss: 17.735 Vali Acc: 0.266 Test Loss: 17.735 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9078810214996338
Epoch: 7, Steps: 17 | Train Loss: 9.898 Vali Loss: 14.515 Vali Acc: 0.278 Test Loss: 14.515 Test Acc: 0.278
Validation loss decreased (-0.273713 --> -0.277421).  Saving model ...
Epoch: 8 cost time: 0.671990156173706
Epoch: 8, Steps: 17 | Train Loss: 4.584 Vali Loss: 10.606 Vali Acc: 0.266 Test Loss: 10.606 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8053886890411377
Epoch: 9, Steps: 17 | Train Loss: 5.360 Vali Loss: 7.495 Vali Acc: 0.289 Test Loss: 7.495 Test Acc: 0.289
Validation loss decreased (-0.277421 --> -0.288898).  Saving model ...
Epoch: 10 cost time: 0.7623679637908936
Epoch: 10, Steps: 17 | Train Loss: 4.923 Vali Loss: 6.258 Vali Acc: 0.228 Test Loss: 6.258 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8364005088806152
Epoch: 11, Steps: 17 | Train Loss: 3.109 Vali Loss: 6.614 Vali Acc: 0.236 Test Loss: 6.614 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7602758407592773
Epoch: 12, Steps: 17 | Train Loss: 3.401 Vali Loss: 4.277 Vali Acc: 0.251 Test Loss: 4.277 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7251160144805908
Epoch: 13, Steps: 17 | Train Loss: 2.018 Vali Loss: 7.900 Vali Acc: 0.224 Test Loss: 7.900 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6665704250335693
Epoch: 14, Steps: 17 | Train Loss: 3.572 Vali Loss: 5.047 Vali Acc: 0.247 Test Loss: 5.047 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7137823104858398
Epoch: 15, Steps: 17 | Train Loss: 2.218 Vali Loss: 6.209 Vali Acc: 0.259 Test Loss: 6.209 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.840059757232666
Epoch: 16, Steps: 17 | Train Loss: 2.895 Vali Loss: 4.878 Vali Acc: 0.224 Test Loss: 4.878 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7738463878631592
Epoch: 17, Steps: 17 | Train Loss: 2.145 Vali Loss: 4.197 Vali Acc: 0.243 Test Loss: 4.197 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7673509120941162
Epoch: 18, Steps: 17 | Train Loss: 2.959 Vali Loss: 7.906 Vali Acc: 0.255 Test Loss: 7.906 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8981108665466309
Epoch: 19, Steps: 17 | Train Loss: 3.035 Vali Loss: 7.654 Vali Acc: 0.266 Test Loss: 7.654 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3358919
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1686720848083496
Epoch: 1, Steps: 17 | Train Loss: 6.331 Vali Loss: 4.761 Vali Acc: 0.278 Test Loss: 4.761 Test Acc: 0.278
Validation loss decreased (inf --> -0.277519).  Saving model ...
Epoch: 2 cost time: 0.7229435443878174
Epoch: 2, Steps: 17 | Train Loss: 4.206 Vali Loss: 5.466 Vali Acc: 0.289 Test Loss: 5.466 Test Acc: 0.289
Validation loss decreased (-0.277519 --> -0.288919).  Saving model ...
Epoch: 3 cost time: 0.9157805442810059
Epoch: 3, Steps: 17 | Train Loss: 5.703 Vali Loss: 9.633 Vali Acc: 0.266 Test Loss: 9.633 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.697730541229248
Epoch: 4, Steps: 17 | Train Loss: 6.982 Vali Loss: 12.082 Vali Acc: 0.285 Test Loss: 12.082 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8975734710693359
Epoch: 5, Steps: 17 | Train Loss: 8.088 Vali Loss: 8.518 Vali Acc: 0.262 Test Loss: 8.518 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8763365745544434
Epoch: 6, Steps: 17 | Train Loss: 5.618 Vali Loss: 8.033 Vali Acc: 0.262 Test Loss: 8.033 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7202589511871338
Epoch: 7, Steps: 17 | Train Loss: 5.697 Vali Loss: 11.168 Vali Acc: 0.274 Test Loss: 11.168 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7567949295043945
Epoch: 8, Steps: 17 | Train Loss: 7.024 Vali Loss: 6.521 Vali Acc: 0.251 Test Loss: 6.521 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7768919467926025
Epoch: 9, Steps: 17 | Train Loss: 4.501 Vali Loss: 8.380 Vali Acc: 0.247 Test Loss: 8.380 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9611203670501709
Epoch: 10, Steps: 17 | Train Loss: 5.708 Vali Loss: 15.835 Vali Acc: 0.247 Test Loss: 15.835 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7907297611236572
Epoch: 11, Steps: 17 | Train Loss: 6.659 Vali Loss: 8.438 Vali Acc: 0.259 Test Loss: 8.438 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8159158229827881
Epoch: 12, Steps: 17 | Train Loss: 3.693 Vali Loss: 7.508 Vali Acc: 0.255 Test Loss: 7.508 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3362852
model size : 12.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.141957998275757
Epoch: 1, Steps: 17 | Train Loss: 4.205 Vali Loss: 5.405 Vali Acc: 0.278 Test Loss: 5.405 Test Acc: 0.278
Validation loss decreased (inf --> -0.277512).  Saving model ...
Epoch: 2 cost time: 0.7880611419677734
Epoch: 2, Steps: 17 | Train Loss: 5.613 Vali Loss: 4.146 Vali Acc: 0.281 Test Loss: 4.146 Test Acc: 0.281
Validation loss decreased (-0.277512 --> -0.281327).  Saving model ...
Epoch: 3 cost time: 0.8966107368469238
Epoch: 3, Steps: 17 | Train Loss: 4.543 Vali Loss: 9.866 Vali Acc: 0.262 Test Loss: 9.866 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7428252696990967
Epoch: 4, Steps: 17 | Train Loss: 5.363 Vali Loss: 6.836 Vali Acc: 0.240 Test Loss: 6.836 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8029775619506836
Epoch: 5, Steps: 17 | Train Loss: 7.458 Vali Loss: 8.421 Vali Acc: 0.278 Test Loss: 8.421 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7429893016815186
Epoch: 6, Steps: 17 | Train Loss: 10.825 Vali Loss: 9.398 Vali Acc: 0.285 Test Loss: 9.398 Test Acc: 0.285
Validation loss decreased (-0.281327 --> -0.285077).  Saving model ...
Epoch: 7 cost time: 0.8769023418426514
Epoch: 7, Steps: 17 | Train Loss: 6.660 Vali Loss: 8.214 Vali Acc: 0.243 Test Loss: 8.214 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7150111198425293
Epoch: 8, Steps: 17 | Train Loss: 6.648 Vali Loss: 18.551 Vali Acc: 0.251 Test Loss: 18.551 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7635996341705322
Epoch: 9, Steps: 17 | Train Loss: 8.218 Vali Loss: 10.768 Vali Acc: 0.251 Test Loss: 10.768 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8679611682891846
Epoch: 10, Steps: 17 | Train Loss: 4.701 Vali Loss: 8.311 Vali Acc: 0.259 Test Loss: 8.311 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.717423677444458
Epoch: 11, Steps: 17 | Train Loss: 3.701 Vali Loss: 11.247 Vali Acc: 0.255 Test Loss: 11.247 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7682230472564697
Epoch: 12, Steps: 17 | Train Loss: 4.429 Vali Loss: 8.779 Vali Acc: 0.259 Test Loss: 8.779 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8411252498626709
Epoch: 13, Steps: 17 | Train Loss: 3.436 Vali Loss: 6.988 Vali Acc: 0.217 Test Loss: 6.988 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7173423767089844
Epoch: 14, Steps: 17 | Train Loss: 2.938 Vali Loss: 5.260 Vali Acc: 0.243 Test Loss: 5.260 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7432847023010254
Epoch: 15, Steps: 17 | Train Loss: 2.260 Vali Loss: 5.115 Vali Acc: 0.251 Test Loss: 5.115 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.779233455657959
Epoch: 16, Steps: 17 | Train Loss: 2.605 Vali Loss: 5.491 Vali Acc: 0.251 Test Loss: 5.491 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3358802
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1546549797058105
Epoch: 1, Steps: 17 | Train Loss: 3.653 Vali Loss: 8.057 Vali Acc: 0.259 Test Loss: 8.057 Test Acc: 0.259
Validation loss decreased (inf --> -0.258475).  Saving model ...
Epoch: 2 cost time: 0.7924084663391113
Epoch: 2, Steps: 17 | Train Loss: 5.102 Vali Loss: 5.286 Vali Acc: 0.266 Test Loss: 5.286 Test Acc: 0.266
Validation loss decreased (-0.258475 --> -0.266107).  Saving model ...
Epoch: 3 cost time: 0.7644462585449219
Epoch: 3, Steps: 17 | Train Loss: 4.313 Vali Loss: 8.641 Vali Acc: 0.266 Test Loss: 8.641 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7446086406707764
Epoch: 4, Steps: 17 | Train Loss: 4.695 Vali Loss: 8.778 Vali Acc: 0.232 Test Loss: 8.778 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8314564228057861
Epoch: 5, Steps: 17 | Train Loss: 7.824 Vali Loss: 9.913 Vali Acc: 0.240 Test Loss: 9.913 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7973055839538574
Epoch: 6, Steps: 17 | Train Loss: 7.515 Vali Loss: 12.603 Vali Acc: 0.289 Test Loss: 12.603 Test Acc: 0.289
Validation loss decreased (-0.266107 --> -0.288847).  Saving model ...
Epoch: 7 cost time: 0.6393933296203613
Epoch: 7, Steps: 17 | Train Loss: 4.341 Vali Loss: 9.020 Vali Acc: 0.255 Test Loss: 9.020 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7683656215667725
Epoch: 8, Steps: 17 | Train Loss: 4.913 Vali Loss: 14.657 Vali Acc: 0.243 Test Loss: 14.657 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7720370292663574
Epoch: 9, Steps: 17 | Train Loss: 4.910 Vali Loss: 7.273 Vali Acc: 0.266 Test Loss: 7.273 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7376301288604736
Epoch: 10, Steps: 17 | Train Loss: 6.490 Vali Loss: 8.373 Vali Acc: 0.224 Test Loss: 8.373 Test Acc: 0.224
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.836789608001709
Epoch: 11, Steps: 17 | Train Loss: 7.255 Vali Loss: 9.467 Vali Acc: 0.236 Test Loss: 9.467 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8464643955230713
Epoch: 12, Steps: 17 | Train Loss: 3.399 Vali Loss: 5.540 Vali Acc: 0.270 Test Loss: 5.540 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.763068437576294
Epoch: 13, Steps: 17 | Train Loss: 2.108 Vali Loss: 5.882 Vali Acc: 0.270 Test Loss: 5.882 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7548794746398926
Epoch: 14, Steps: 17 | Train Loss: 2.936 Vali Loss: 9.177 Vali Acc: 0.259 Test Loss: 9.177 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8506741523742676
Epoch: 15, Steps: 17 | Train Loss: 3.523 Vali Loss: 5.357 Vali Acc: 0.247 Test Loss: 5.357 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7283313274383545
Epoch: 16, Steps: 17 | Train Loss: 2.327 Vali Loss: 5.000 Vali Acc: 0.270 Test Loss: 5.000 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3341260
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.7777798175811768
Epoch: 1, Steps: 17 | Train Loss: 4.059 Vali Loss: 5.353 Vali Acc: 0.270 Test Loss: 5.353 Test Acc: 0.270
Validation loss decreased (inf --> -0.269908).  Saving model ...
Epoch: 2 cost time: 0.7883570194244385
Epoch: 2, Steps: 17 | Train Loss: 3.584 Vali Loss: 5.499 Vali Acc: 0.251 Test Loss: 5.499 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6613147258758545
Epoch: 3, Steps: 17 | Train Loss: 4.206 Vali Loss: 11.738 Vali Acc: 0.251 Test Loss: 11.738 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7405209541320801
Epoch: 4, Steps: 17 | Train Loss: 8.733 Vali Loss: 10.135 Vali Acc: 0.255 Test Loss: 10.135 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8020148277282715
Epoch: 5, Steps: 17 | Train Loss: 6.260 Vali Loss: 11.708 Vali Acc: 0.251 Test Loss: 11.708 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7650594711303711
Epoch: 6, Steps: 17 | Train Loss: 5.165 Vali Loss: 12.695 Vali Acc: 0.255 Test Loss: 12.695 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7747671604156494
Epoch: 7, Steps: 17 | Train Loss: 8.135 Vali Loss: 13.871 Vali Acc: 0.270 Test Loss: 13.871 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7480409145355225
Epoch: 8, Steps: 17 | Train Loss: 6.076 Vali Loss: 7.515 Vali Acc: 0.293 Test Loss: 7.515 Test Acc: 0.293
Validation loss decreased (-0.269908 --> -0.292701).  Saving model ...
Epoch: 9 cost time: 0.6507461071014404
Epoch: 9, Steps: 17 | Train Loss: 6.349 Vali Loss: 13.158 Vali Acc: 0.270 Test Loss: 13.158 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7359030246734619
Epoch: 10, Steps: 17 | Train Loss: 4.541 Vali Loss: 9.973 Vali Acc: 0.247 Test Loss: 9.973 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7519657611846924
Epoch: 11, Steps: 17 | Train Loss: 4.515 Vali Loss: 6.342 Vali Acc: 0.221 Test Loss: 6.342 Test Acc: 0.221
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8302545547485352
Epoch: 12, Steps: 17 | Train Loss: 3.573 Vali Loss: 9.226 Vali Acc: 0.251 Test Loss: 9.226 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7257518768310547
Epoch: 13, Steps: 17 | Train Loss: 5.314 Vali Loss: 9.278 Vali Acc: 0.247 Test Loss: 9.278 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6734423637390137
Epoch: 14, Steps: 17 | Train Loss: 3.149 Vali Loss: 5.511 Vali Acc: 0.243 Test Loss: 5.511 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6684801578521729
Epoch: 15, Steps: 17 | Train Loss: 3.014 Vali Loss: 5.085 Vali Acc: 0.243 Test Loss: 5.085 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7497727870941162
Epoch: 16, Steps: 17 | Train Loss: 2.102 Vali Loss: 6.206 Vali Acc: 0.232 Test Loss: 6.206 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7956538200378418
Epoch: 17, Steps: 17 | Train Loss: 2.392 Vali Loss: 5.020 Vali Acc: 0.270 Test Loss: 5.020 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9966099262237549
Epoch: 18, Steps: 17 | Train Loss: 2.800 Vali Loss: 8.844 Vali Acc: 0.251 Test Loss: 8.844 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3343751
model size : 12.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8433198928833008
Epoch: 1, Steps: 17 | Train Loss: 3.839 Vali Loss: 6.604 Vali Acc: 0.232 Test Loss: 6.604 Test Acc: 0.232
Validation loss decreased (inf --> -0.231873).  Saving model ...
Epoch: 2 cost time: 0.6507773399353027
Epoch: 2, Steps: 17 | Train Loss: 6.054 Vali Loss: 11.122 Vali Acc: 0.255 Test Loss: 11.122 Test Acc: 0.255
Validation loss decreased (-0.231873 --> -0.254642).  Saving model ...
Epoch: 3 cost time: 0.7850501537322998
Epoch: 3, Steps: 17 | Train Loss: 6.375 Vali Loss: 12.235 Vali Acc: 0.255 Test Loss: 12.235 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6814382076263428
Epoch: 4, Steps: 17 | Train Loss: 6.584 Vali Loss: 8.828 Vali Acc: 0.262 Test Loss: 8.828 Test Acc: 0.262
Validation loss decreased (-0.254642 --> -0.262269).  Saving model ...
Epoch: 5 cost time: 0.6904726028442383
Epoch: 5, Steps: 17 | Train Loss: 5.961 Vali Loss: 10.503 Vali Acc: 0.255 Test Loss: 10.503 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6996691226959229
Epoch: 6, Steps: 17 | Train Loss: 5.591 Vali Loss: 9.078 Vali Acc: 0.247 Test Loss: 9.078 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6833350658416748
Epoch: 7, Steps: 17 | Train Loss: 5.791 Vali Loss: 13.343 Vali Acc: 0.251 Test Loss: 13.343 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8578343391418457
Epoch: 8, Steps: 17 | Train Loss: 6.604 Vali Loss: 19.834 Vali Acc: 0.251 Test Loss: 19.834 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8465983867645264
Epoch: 9, Steps: 17 | Train Loss: 7.064 Vali Loss: 10.395 Vali Acc: 0.224 Test Loss: 10.395 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6803874969482422
Epoch: 10, Steps: 17 | Train Loss: 5.440 Vali Loss: 18.924 Vali Acc: 0.255 Test Loss: 18.924 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7365529537200928
Epoch: 11, Steps: 17 | Train Loss: 5.897 Vali Loss: 7.162 Vali Acc: 0.221 Test Loss: 7.162 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7797996997833252
Epoch: 12, Steps: 17 | Train Loss: 3.476 Vali Loss: 6.830 Vali Acc: 0.247 Test Loss: 6.830 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.722722053527832
Epoch: 13, Steps: 17 | Train Loss: 2.616 Vali Loss: 8.941 Vali Acc: 0.243 Test Loss: 8.941 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7727174758911133
Epoch: 14, Steps: 17 | Train Loss: 3.778 Vali Loss: 5.780 Vali Acc: 0.285 Test Loss: 5.780 Test Acc: 0.285
Validation loss decreased (-0.262269 --> -0.285113).  Saving model ...
Epoch: 15 cost time: 0.692211389541626
Epoch: 15, Steps: 17 | Train Loss: 2.719 Vali Loss: 4.924 Vali Acc: 0.247 Test Loss: 4.924 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6466171741485596
Epoch: 16, Steps: 17 | Train Loss: 3.225 Vali Loss: 6.575 Vali Acc: 0.259 Test Loss: 6.575 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7802486419677734
Epoch: 17, Steps: 17 | Train Loss: 2.785 Vali Loss: 4.601 Vali Acc: 0.308 Test Loss: 4.601 Test Acc: 0.308
Validation loss decreased (-0.285113 --> -0.307939).  Saving model ...
Epoch: 18 cost time: 0.7605657577514648
Epoch: 18, Steps: 17 | Train Loss: 2.679 Vali Loss: 5.696 Vali Acc: 0.243 Test Loss: 5.696 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7069523334503174
Epoch: 19, Steps: 17 | Train Loss: 2.971 Vali Loss: 5.144 Vali Acc: 0.217 Test Loss: 5.144 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6687257289886475
Epoch: 20, Steps: 17 | Train Loss: 2.912 Vali Loss: 5.100 Vali Acc: 0.259 Test Loss: 5.100 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7684798240661621
Epoch: 21, Steps: 17 | Train Loss: 2.856 Vali Loss: 8.795 Vali Acc: 0.247 Test Loss: 8.795 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8128788471221924
Epoch: 22, Steps: 17 | Train Loss: 3.181 Vali Loss: 7.556 Vali Acc: 0.266 Test Loss: 7.556 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6645917892456055
Epoch: 23, Steps: 17 | Train Loss: 3.016 Vali Loss: 6.770 Vali Acc: 0.232 Test Loss: 6.770 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7757594585418701
Epoch: 24, Steps: 17 | Train Loss: 1.768 Vali Loss: 5.013 Vali Acc: 0.259 Test Loss: 5.013 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7923617362976074
Epoch: 25, Steps: 17 | Train Loss: 2.199 Vali Loss: 8.115 Vali Acc: 0.251 Test Loss: 8.115 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6986265182495117
Epoch: 26, Steps: 17 | Train Loss: 2.786 Vali Loss: 4.862 Vali Acc: 0.259 Test Loss: 4.862 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7151856422424316
Epoch: 27, Steps: 17 | Train Loss: 2.128 Vali Loss: 7.033 Vali Acc: 0.281 Test Loss: 7.033 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 3357264
model size : 12.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9673311710357666
Epoch: 1, Steps: 17 | Train Loss: 4.210 Vali Loss: 5.266 Vali Acc: 0.255 Test Loss: 5.266 Test Acc: 0.255
Validation loss decreased (inf --> -0.254700).  Saving model ...
Epoch: 2 cost time: 0.8672816753387451
Epoch: 2, Steps: 17 | Train Loss: 4.279 Vali Loss: 4.911 Vali Acc: 0.262 Test Loss: 4.911 Test Acc: 0.262
Validation loss decreased (-0.254700 --> -0.262308).  Saving model ...
Epoch: 3 cost time: 0.7121984958648682
Epoch: 3, Steps: 17 | Train Loss: 6.498 Vali Loss: 8.778 Vali Acc: 0.259 Test Loss: 8.778 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7239842414855957
Epoch: 4, Steps: 17 | Train Loss: 5.215 Vali Loss: 7.979 Vali Acc: 0.259 Test Loss: 7.979 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7441177368164062
Epoch: 5, Steps: 17 | Train Loss: 5.711 Vali Loss: 7.968 Vali Acc: 0.240 Test Loss: 7.968 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7804222106933594
Epoch: 6, Steps: 17 | Train Loss: 4.418 Vali Loss: 8.442 Vali Acc: 0.259 Test Loss: 8.442 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7946126461029053
Epoch: 7, Steps: 17 | Train Loss: 6.276 Vali Loss: 12.801 Vali Acc: 0.228 Test Loss: 12.801 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7184748649597168
Epoch: 8, Steps: 17 | Train Loss: 5.362 Vali Loss: 21.073 Vali Acc: 0.251 Test Loss: 21.073 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.839895486831665
Epoch: 9, Steps: 17 | Train Loss: 11.545 Vali Loss: 8.471 Vali Acc: 0.251 Test Loss: 8.471 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8224570751190186
Epoch: 10, Steps: 17 | Train Loss: 5.839 Vali Loss: 10.919 Vali Acc: 0.262 Test Loss: 10.919 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7778794765472412
Epoch: 11, Steps: 17 | Train Loss: 3.949 Vali Loss: 6.874 Vali Acc: 0.266 Test Loss: 6.874 Test Acc: 0.266
Validation loss decreased (-0.262308 --> -0.266091).  Saving model ...
Epoch: 12 cost time: 0.8486306667327881
Epoch: 12, Steps: 17 | Train Loss: 3.566 Vali Loss: 9.326 Vali Acc: 0.259 Test Loss: 9.326 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7039055824279785
Epoch: 13, Steps: 17 | Train Loss: 3.234 Vali Loss: 8.179 Vali Acc: 0.274 Test Loss: 8.179 Test Acc: 0.274
Validation loss decreased (-0.266091 --> -0.273682).  Saving model ...
Epoch: 14 cost time: 0.7811980247497559
Epoch: 14, Steps: 17 | Train Loss: 3.787 Vali Loss: 6.215 Vali Acc: 0.240 Test Loss: 6.215 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7588019371032715
Epoch: 15, Steps: 17 | Train Loss: 2.623 Vali Loss: 4.239 Vali Acc: 0.289 Test Loss: 4.239 Test Acc: 0.289
Validation loss decreased (-0.273682 --> -0.288931).  Saving model ...
Epoch: 16 cost time: 0.7667536735534668
Epoch: 16, Steps: 17 | Train Loss: 2.228 Vali Loss: 4.713 Vali Acc: 0.243 Test Loss: 4.713 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6728441715240479
Epoch: 17, Steps: 17 | Train Loss: 2.842 Vali Loss: 8.795 Vali Acc: 0.278 Test Loss: 8.795 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7061214447021484
Epoch: 18, Steps: 17 | Train Loss: 3.349 Vali Loss: 6.982 Vali Acc: 0.285 Test Loss: 6.982 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8006763458251953
Epoch: 19, Steps: 17 | Train Loss: 2.618 Vali Loss: 9.866 Vali Acc: 0.243 Test Loss: 9.866 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7194945812225342
Epoch: 20, Steps: 17 | Train Loss: 2.939 Vali Loss: 5.048 Vali Acc: 0.293 Test Loss: 5.048 Test Acc: 0.293
Validation loss decreased (-0.288931 --> -0.292725).  Saving model ...
Epoch: 21 cost time: 0.7705492973327637
Epoch: 21, Steps: 17 | Train Loss: 2.529 Vali Loss: 5.641 Vali Acc: 0.228 Test Loss: 5.641 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8183884620666504
Epoch: 22, Steps: 17 | Train Loss: 2.182 Vali Loss: 6.459 Vali Acc: 0.266 Test Loss: 6.459 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7505381107330322
Epoch: 23, Steps: 17 | Train Loss: 2.302 Vali Loss: 8.991 Vali Acc: 0.259 Test Loss: 8.991 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6660456657409668
Epoch: 24, Steps: 17 | Train Loss: 3.031 Vali Loss: 6.263 Vali Acc: 0.274 Test Loss: 6.263 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7156639099121094
Epoch: 25, Steps: 17 | Train Loss: 2.058 Vali Loss: 8.228 Vali Acc: 0.266 Test Loss: 8.228 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.691969633102417
Epoch: 26, Steps: 17 | Train Loss: 3.161 Vali Loss: 6.703 Vali Acc: 0.251 Test Loss: 6.703 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7118580341339111
Epoch: 27, Steps: 17 | Train Loss: 2.086 Vali Loss: 8.893 Vali Acc: 0.255 Test Loss: 8.893 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.751213788986206
Epoch: 28, Steps: 17 | Train Loss: 3.460 Vali Loss: 6.278 Vali Acc: 0.243 Test Loss: 6.278 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7308237552642822
Epoch: 29, Steps: 17 | Train Loss: 3.729 Vali Loss: 10.384 Vali Acc: 0.251 Test Loss: 10.384 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7765557765960693
Epoch: 30, Steps: 17 | Train Loss: 3.425 Vali Loss: 11.155 Vali Acc: 0.224 Test Loss: 11.155 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3339263
model size : 12.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3505585193634033
Epoch: 1, Steps: 17 | Train Loss: 5.117 Vali Loss: 6.962 Vali Acc: 0.247 Test Loss: 6.962 Test Acc: 0.247
Validation loss decreased (inf --> -0.247079).  Saving model ...
Epoch: 2 cost time: 0.8590834140777588
Epoch: 2, Steps: 17 | Train Loss: 8.389 Vali Loss: 15.480 Vali Acc: 0.266 Test Loss: 15.480 Test Acc: 0.266
Validation loss decreased (-0.247079 --> -0.266005).  Saving model ...
Epoch: 3 cost time: 0.7576923370361328
Epoch: 3, Steps: 17 | Train Loss: 9.772 Vali Loss: 15.749 Vali Acc: 0.259 Test Loss: 15.749 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7736804485321045
Epoch: 4, Steps: 17 | Train Loss: 9.677 Vali Loss: 11.477 Vali Acc: 0.251 Test Loss: 11.477 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7937910556793213
Epoch: 5, Steps: 17 | Train Loss: 9.303 Vali Loss: 12.434 Vali Acc: 0.236 Test Loss: 12.434 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7275617122650146
Epoch: 6, Steps: 17 | Train Loss: 4.782 Vali Loss: 8.036 Vali Acc: 0.247 Test Loss: 8.036 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7632160186767578
Epoch: 7, Steps: 17 | Train Loss: 6.941 Vali Loss: 13.490 Vali Acc: 0.285 Test Loss: 13.490 Test Acc: 0.285
Validation loss decreased (-0.266005 --> -0.285036).  Saving model ...
Epoch: 8 cost time: 0.823162317276001
Epoch: 8, Steps: 17 | Train Loss: 6.414 Vali Loss: 12.916 Vali Acc: 0.281 Test Loss: 12.916 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8870384693145752
Epoch: 9, Steps: 17 | Train Loss: 7.503 Vali Loss: 10.409 Vali Acc: 0.240 Test Loss: 10.409 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7502694129943848
Epoch: 10, Steps: 17 | Train Loss: 2.953 Vali Loss: 8.519 Vali Acc: 0.240 Test Loss: 8.519 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8128042221069336
Epoch: 11, Steps: 17 | Train Loss: 3.044 Vali Loss: 6.485 Vali Acc: 0.281 Test Loss: 6.485 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8985733985900879
Epoch: 12, Steps: 17 | Train Loss: 3.448 Vali Loss: 4.956 Vali Acc: 0.221 Test Loss: 4.956 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8198816776275635
Epoch: 13, Steps: 17 | Train Loss: 2.970 Vali Loss: 4.685 Vali Acc: 0.243 Test Loss: 4.685 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8095786571502686
Epoch: 14, Steps: 17 | Train Loss: 3.032 Vali Loss: 5.822 Vali Acc: 0.278 Test Loss: 5.822 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.757714033126831
Epoch: 15, Steps: 17 | Train Loss: 2.651 Vali Loss: 4.233 Vali Acc: 0.240 Test Loss: 4.233 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.87776780128479
Epoch: 16, Steps: 17 | Train Loss: 1.967 Vali Loss: 7.446 Vali Acc: 0.251 Test Loss: 7.446 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8487930297851562
Epoch: 17, Steps: 17 | Train Loss: 2.313 Vali Loss: 4.217 Vali Acc: 0.270 Test Loss: 4.217 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3346292
model size : 12.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2198500633239746
Epoch: 1, Steps: 17 | Train Loss: 3.636 Vali Loss: 4.416 Vali Acc: 0.262 Test Loss: 4.416 Test Acc: 0.262
Validation loss decreased (inf --> -0.262313).  Saving model ...
Epoch: 2 cost time: 0.8310737609863281
Epoch: 2, Steps: 17 | Train Loss: 5.005 Vali Loss: 5.641 Vali Acc: 0.251 Test Loss: 5.641 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.846581220626831
Epoch: 3, Steps: 17 | Train Loss: 6.151 Vali Loss: 8.404 Vali Acc: 0.255 Test Loss: 8.404 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7647194862365723
Epoch: 4, Steps: 17 | Train Loss: 6.217 Vali Loss: 5.678 Vali Acc: 0.259 Test Loss: 5.678 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8269071578979492
Epoch: 5, Steps: 17 | Train Loss: 5.821 Vali Loss: 7.675 Vali Acc: 0.259 Test Loss: 7.675 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6807479858398438
Epoch: 6, Steps: 17 | Train Loss: 8.036 Vali Loss: 10.875 Vali Acc: 0.243 Test Loss: 10.875 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8040721416473389
Epoch: 7, Steps: 17 | Train Loss: 6.871 Vali Loss: 7.860 Vali Acc: 0.240 Test Loss: 7.860 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7421486377716064
Epoch: 8, Steps: 17 | Train Loss: 4.538 Vali Loss: 13.971 Vali Acc: 0.240 Test Loss: 13.971 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7627170085906982
Epoch: 9, Steps: 17 | Train Loss: 5.408 Vali Loss: 13.053 Vali Acc: 0.274 Test Loss: 13.053 Test Acc: 0.274
Validation loss decreased (-0.262313 --> -0.273634).  Saving model ...
Epoch: 10 cost time: 0.733576774597168
Epoch: 10, Steps: 17 | Train Loss: 4.730 Vali Loss: 9.118 Vali Acc: 0.217 Test Loss: 9.118 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5766799449920654
Epoch: 11, Steps: 17 | Train Loss: 3.046 Vali Loss: 7.427 Vali Acc: 0.232 Test Loss: 7.427 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8759753704071045
Epoch: 12, Steps: 17 | Train Loss: 4.029 Vali Loss: 7.147 Vali Acc: 0.255 Test Loss: 7.147 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7044179439544678
Epoch: 13, Steps: 17 | Train Loss: 3.891 Vali Loss: 8.555 Vali Acc: 0.262 Test Loss: 8.555 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.969963550567627
Epoch: 14, Steps: 17 | Train Loss: 2.955 Vali Loss: 7.919 Vali Acc: 0.259 Test Loss: 7.919 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.740424633026123
Epoch: 15, Steps: 17 | Train Loss: 3.910 Vali Loss: 6.987 Vali Acc: 0.236 Test Loss: 6.987 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7769572734832764
Epoch: 16, Steps: 17 | Train Loss: 3.793 Vali Loss: 9.085 Vali Acc: 0.308 Test Loss: 9.085 Test Acc: 0.308
Validation loss decreased (-0.273634 --> -0.307894).  Saving model ...
Epoch: 17 cost time: 0.88637375831604
Epoch: 17, Steps: 17 | Train Loss: 3.583 Vali Loss: 5.425 Vali Acc: 0.236 Test Loss: 5.425 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8678603172302246
Epoch: 18, Steps: 17 | Train Loss: 2.141 Vali Loss: 5.428 Vali Acc: 0.251 Test Loss: 5.428 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7592933177947998
Epoch: 19, Steps: 17 | Train Loss: 3.205 Vali Loss: 7.105 Vali Acc: 0.281 Test Loss: 7.105 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.808527946472168
Epoch: 20, Steps: 17 | Train Loss: 3.663 Vali Loss: 7.114 Vali Acc: 0.217 Test Loss: 7.114 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7139801979064941
Epoch: 21, Steps: 17 | Train Loss: 2.213 Vali Loss: 5.477 Vali Acc: 0.221 Test Loss: 5.477 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7404098510742188
Epoch: 22, Steps: 17 | Train Loss: 1.691 Vali Loss: 6.383 Vali Acc: 0.251 Test Loss: 6.383 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7538812160491943
Epoch: 23, Steps: 17 | Train Loss: 2.749 Vali Loss: 5.542 Vali Acc: 0.251 Test Loss: 5.542 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8515815734863281
Epoch: 24, Steps: 17 | Train Loss: 1.311 Vali Loss: 6.394 Vali Acc: 0.255 Test Loss: 6.394 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7745914459228516
Epoch: 25, Steps: 17 | Train Loss: 1.879 Vali Loss: 10.603 Vali Acc: 0.240 Test Loss: 10.603 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.754737377166748
Epoch: 26, Steps: 17 | Train Loss: 2.618 Vali Loss: 10.721 Vali Acc: 0.278 Test Loss: 10.721 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 3328811
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.416295051574707
Epoch: 1, Steps: 17 | Train Loss: 8.074 Vali Loss: 9.256 Vali Acc: 0.262 Test Loss: 9.256 Test Acc: 0.262
Validation loss decreased (inf --> -0.262265).  Saving model ...
Epoch: 2 cost time: 0.9408748149871826
Epoch: 2, Steps: 17 | Train Loss: 5.953 Vali Loss: 7.663 Vali Acc: 0.251 Test Loss: 7.663 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6612355709075928
Epoch: 3, Steps: 17 | Train Loss: 6.867 Vali Loss: 8.071 Vali Acc: 0.255 Test Loss: 8.071 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8166098594665527
Epoch: 4, Steps: 17 | Train Loss: 7.453 Vali Loss: 10.511 Vali Acc: 0.266 Test Loss: 10.511 Test Acc: 0.266
Validation loss decreased (-0.262265 --> -0.266055).  Saving model ...
Epoch: 5 cost time: 0.6459178924560547
Epoch: 5, Steps: 17 | Train Loss: 6.318 Vali Loss: 10.082 Vali Acc: 0.190 Test Loss: 10.082 Test Acc: 0.190
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7454075813293457
Epoch: 6, Steps: 17 | Train Loss: 4.995 Vali Loss: 7.798 Vali Acc: 0.289 Test Loss: 7.798 Test Acc: 0.289
Validation loss decreased (-0.266055 --> -0.288895).  Saving model ...
Epoch: 7 cost time: 0.7263133525848389
Epoch: 7, Steps: 17 | Train Loss: 4.969 Vali Loss: 10.475 Vali Acc: 0.270 Test Loss: 10.475 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.715712308883667
Epoch: 8, Steps: 17 | Train Loss: 3.766 Vali Loss: 16.415 Vali Acc: 0.247 Test Loss: 16.415 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7187526226043701
Epoch: 9, Steps: 17 | Train Loss: 6.700 Vali Loss: 5.747 Vali Acc: 0.259 Test Loss: 5.747 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7650384902954102
Epoch: 10, Steps: 17 | Train Loss: 3.755 Vali Loss: 7.087 Vali Acc: 0.228 Test Loss: 7.087 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6942713260650635
Epoch: 11, Steps: 17 | Train Loss: 5.230 Vali Loss: 9.806 Vali Acc: 0.266 Test Loss: 9.806 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6864950656890869
Epoch: 12, Steps: 17 | Train Loss: 3.510 Vali Loss: 5.558 Vali Acc: 0.255 Test Loss: 5.558 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.865074872970581
Epoch: 13, Steps: 17 | Train Loss: 2.597 Vali Loss: 6.903 Vali Acc: 0.243 Test Loss: 6.903 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7194051742553711
Epoch: 14, Steps: 17 | Train Loss: 2.359 Vali Loss: 5.194 Vali Acc: 0.278 Test Loss: 5.194 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6770446300506592
Epoch: 15, Steps: 17 | Train Loss: 1.935 Vali Loss: 5.700 Vali Acc: 0.281 Test Loss: 5.700 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.765650749206543
Epoch: 16, Steps: 17 | Train Loss: 3.128 Vali Loss: 4.974 Vali Acc: 0.262 Test Loss: 4.974 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3350368
model size : 12.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9830024242401123
Epoch: 1, Steps: 17 | Train Loss: 4.137 Vali Loss: 3.083 Vali Acc: 0.266 Test Loss: 3.083 Test Acc: 0.266
Validation loss decreased (inf --> -0.266129).  Saving model ...
Epoch: 2 cost time: 0.7861454486846924
Epoch: 2, Steps: 17 | Train Loss: 4.575 Vali Loss: 9.802 Vali Acc: 0.270 Test Loss: 9.802 Test Acc: 0.270
Validation loss decreased (-0.266129 --> -0.269864).  Saving model ...
Epoch: 3 cost time: 0.7478549480438232
Epoch: 3, Steps: 17 | Train Loss: 8.049 Vali Loss: 7.539 Vali Acc: 0.255 Test Loss: 7.539 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7649316787719727
Epoch: 4, Steps: 17 | Train Loss: 8.352 Vali Loss: 12.873 Vali Acc: 0.251 Test Loss: 12.873 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7275099754333496
Epoch: 5, Steps: 17 | Train Loss: 8.287 Vali Loss: 7.633 Vali Acc: 0.251 Test Loss: 7.633 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7763500213623047
Epoch: 6, Steps: 17 | Train Loss: 4.990 Vali Loss: 6.219 Vali Acc: 0.278 Test Loss: 6.219 Test Acc: 0.278
Validation loss decreased (-0.269864 --> -0.277504).  Saving model ...
Epoch: 7 cost time: 0.7661008834838867
Epoch: 7, Steps: 17 | Train Loss: 4.462 Vali Loss: 15.278 Vali Acc: 0.251 Test Loss: 15.278 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7931859493255615
Epoch: 8, Steps: 17 | Train Loss: 7.181 Vali Loss: 15.024 Vali Acc: 0.247 Test Loss: 15.024 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8745832443237305
Epoch: 9, Steps: 17 | Train Loss: 5.544 Vali Loss: 8.346 Vali Acc: 0.240 Test Loss: 8.346 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7353720664978027
Epoch: 10, Steps: 17 | Train Loss: 7.377 Vali Loss: 7.138 Vali Acc: 0.274 Test Loss: 7.138 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8760652542114258
Epoch: 11, Steps: 17 | Train Loss: 5.612 Vali Loss: 7.071 Vali Acc: 0.243 Test Loss: 7.071 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6740849018096924
Epoch: 12, Steps: 17 | Train Loss: 3.607 Vali Loss: 4.960 Vali Acc: 0.274 Test Loss: 4.960 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8493525981903076
Epoch: 13, Steps: 17 | Train Loss: 2.347 Vali Loss: 6.527 Vali Acc: 0.228 Test Loss: 6.527 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7264163494110107
Epoch: 14, Steps: 17 | Train Loss: 3.193 Vali Loss: 5.274 Vali Acc: 0.270 Test Loss: 5.274 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.845618724822998
Epoch: 15, Steps: 17 | Train Loss: 2.441 Vali Loss: 6.108 Vali Acc: 0.255 Test Loss: 6.108 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6592023372650146
Epoch: 16, Steps: 17 | Train Loss: 2.119 Vali Loss: 5.230 Vali Acc: 0.243 Test Loss: 5.230 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3354419
model size : 12.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.001483678817749
Epoch: 1, Steps: 17 | Train Loss: 4.948 Vali Loss: 8.161 Vali Acc: 0.259 Test Loss: 8.161 Test Acc: 0.259
Validation loss decreased (inf --> -0.258474).  Saving model ...
Epoch: 2 cost time: 0.9213905334472656
Epoch: 2, Steps: 17 | Train Loss: 4.928 Vali Loss: 7.009 Vali Acc: 0.278 Test Loss: 7.009 Test Acc: 0.278
Validation loss decreased (-0.258474 --> -0.277496).  Saving model ...
Epoch: 3 cost time: 0.7515869140625
Epoch: 3, Steps: 17 | Train Loss: 6.255 Vali Loss: 5.943 Vali Acc: 0.259 Test Loss: 5.943 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7142176628112793
Epoch: 4, Steps: 17 | Train Loss: 5.048 Vali Loss: 9.829 Vali Acc: 0.255 Test Loss: 9.829 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8689444065093994
Epoch: 5, Steps: 17 | Train Loss: 6.016 Vali Loss: 9.132 Vali Acc: 0.266 Test Loss: 9.132 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8704032897949219
Epoch: 6, Steps: 17 | Train Loss: 5.752 Vali Loss: 8.242 Vali Acc: 0.243 Test Loss: 8.242 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.813788890838623
Epoch: 7, Steps: 17 | Train Loss: 8.054 Vali Loss: 6.270 Vali Acc: 0.194 Test Loss: 6.270 Test Acc: 0.194
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7693448066711426
Epoch: 8, Steps: 17 | Train Loss: 3.218 Vali Loss: 10.146 Vali Acc: 0.255 Test Loss: 10.146 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8356695175170898
Epoch: 9, Steps: 17 | Train Loss: 5.252 Vali Loss: 6.700 Vali Acc: 0.255 Test Loss: 6.700 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7725512981414795
Epoch: 10, Steps: 17 | Train Loss: 7.327 Vali Loss: 14.766 Vali Acc: 0.247 Test Loss: 14.766 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8471970558166504
Epoch: 11, Steps: 17 | Train Loss: 4.697 Vali Loss: 13.518 Vali Acc: 0.247 Test Loss: 13.518 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8472099304199219
Epoch: 12, Steps: 17 | Train Loss: 4.821 Vali Loss: 5.389 Vali Acc: 0.236 Test Loss: 5.389 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3340964
model size : 12.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0651252269744873
Epoch: 1, Steps: 17 | Train Loss: 4.661 Vali Loss: 5.515 Vali Acc: 0.255 Test Loss: 5.515 Test Acc: 0.255
Validation loss decreased (inf --> -0.254698).  Saving model ...
Epoch: 2 cost time: 0.6658408641815186
Epoch: 2, Steps: 17 | Train Loss: 4.054 Vali Loss: 6.818 Vali Acc: 0.224 Test Loss: 6.818 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7352597713470459
Epoch: 3, Steps: 17 | Train Loss: 3.610 Vali Loss: 7.035 Vali Acc: 0.259 Test Loss: 7.035 Test Acc: 0.259
Validation loss decreased (-0.254698 --> -0.258485).  Saving model ...
Epoch: 4 cost time: 0.7650332450866699
Epoch: 4, Steps: 17 | Train Loss: 7.079 Vali Loss: 12.230 Vali Acc: 0.228 Test Loss: 12.230 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8935606479644775
Epoch: 5, Steps: 17 | Train Loss: 6.956 Vali Loss: 8.608 Vali Acc: 0.274 Test Loss: 8.608 Test Acc: 0.274
Validation loss decreased (-0.258485 --> -0.273678).  Saving model ...
Epoch: 6 cost time: 0.6908111572265625
Epoch: 6, Steps: 17 | Train Loss: 6.516 Vali Loss: 12.782 Vali Acc: 0.247 Test Loss: 12.782 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7678678035736084
Epoch: 7, Steps: 17 | Train Loss: 5.521 Vali Loss: 8.224 Vali Acc: 0.281 Test Loss: 8.224 Test Acc: 0.281
Validation loss decreased (-0.273678 --> -0.281287).  Saving model ...
Epoch: 8 cost time: 0.687415361404419
Epoch: 8, Steps: 17 | Train Loss: 8.710 Vali Loss: 9.191 Vali Acc: 0.255 Test Loss: 9.191 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7804975509643555
Epoch: 9, Steps: 17 | Train Loss: 5.275 Vali Loss: 14.797 Vali Acc: 0.240 Test Loss: 14.797 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9753599166870117
Epoch: 10, Steps: 17 | Train Loss: 4.953 Vali Loss: 8.044 Vali Acc: 0.262 Test Loss: 8.044 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.793358325958252
Epoch: 11, Steps: 17 | Train Loss: 3.302 Vali Loss: 6.006 Vali Acc: 0.259 Test Loss: 6.006 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7899343967437744
Epoch: 12, Steps: 17 | Train Loss: 2.912 Vali Loss: 8.705 Vali Acc: 0.255 Test Loss: 8.705 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6947739124298096
Epoch: 13, Steps: 17 | Train Loss: 2.785 Vali Loss: 4.688 Vali Acc: 0.266 Test Loss: 4.688 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6880278587341309
Epoch: 14, Steps: 17 | Train Loss: 3.021 Vali Loss: 8.880 Vali Acc: 0.232 Test Loss: 8.880 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6711952686309814
Epoch: 15, Steps: 17 | Train Loss: 3.772 Vali Loss: 7.701 Vali Acc: 0.255 Test Loss: 7.701 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6139430999755859
Epoch: 16, Steps: 17 | Train Loss: 3.975 Vali Loss: 9.852 Vali Acc: 0.247 Test Loss: 9.852 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6990885734558105
Epoch: 17, Steps: 17 | Train Loss: 3.143 Vali Loss: 7.660 Vali Acc: 0.270 Test Loss: 7.660 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm512_cs84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3347030
model size : 12.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9437999725341797
Epoch: 1, Steps: 17 | Train Loss: 4.717 Vali Loss: 5.572 Vali Acc: 0.255 Test Loss: 5.572 Test Acc: 0.255
Validation loss decreased (inf --> -0.254697).  Saving model ...
Epoch: 2 cost time: 0.6072070598602295
Epoch: 2, Steps: 17 | Train Loss: 7.047 Vali Loss: 7.649 Vali Acc: 0.278 Test Loss: 7.649 Test Acc: 0.278
Validation loss decreased (-0.254697 --> -0.277490).  Saving model ...
Epoch: 3 cost time: 0.6852500438690186
Epoch: 3, Steps: 17 | Train Loss: 4.594 Vali Loss: 12.118 Vali Acc: 0.262 Test Loss: 12.118 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7055413722991943
Epoch: 4, Steps: 17 | Train Loss: 6.802 Vali Loss: 21.063 Vali Acc: 0.255 Test Loss: 21.063 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.722468376159668
Epoch: 5, Steps: 17 | Train Loss: 12.486 Vali Loss: 15.327 Vali Acc: 0.255 Test Loss: 15.327 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7201316356658936
Epoch: 6, Steps: 17 | Train Loss: 6.291 Vali Loss: 6.281 Vali Acc: 0.228 Test Loss: 6.281 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7328693866729736
Epoch: 7, Steps: 17 | Train Loss: 4.170 Vali Loss: 13.293 Vali Acc: 0.274 Test Loss: 13.293 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7474455833435059
Epoch: 8, Steps: 17 | Train Loss: 7.197 Vali Loss: 8.447 Vali Acc: 0.266 Test Loss: 8.447 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7418932914733887
Epoch: 9, Steps: 17 | Train Loss: 4.788 Vali Loss: 9.159 Vali Acc: 0.266 Test Loss: 9.159 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.6182167530059814
Epoch: 10, Steps: 17 | Train Loss: 5.564 Vali Loss: 9.049 Vali Acc: 0.224 Test Loss: 9.049 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.933246374130249
Epoch: 11, Steps: 17 | Train Loss: 4.650 Vali Loss: 10.703 Vali Acc: 0.266 Test Loss: 10.703 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7815415859222412
Epoch: 12, Steps: 17 | Train Loss: 4.691 Vali Loss: 9.387 Vali Acc: 0.262 Test Loss: 9.387 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3285484
model size : 12.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs584_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1958138942718506
Epoch: 1, Steps: 17 | Train Loss: 4.256 Vali Loss: 4.041 Vali Acc: 0.274 Test Loss: 4.041 Test Acc: 0.274
Validation loss decreased (inf --> -0.273724).  Saving model ...
Epoch: 2 cost time: 0.6543376445770264
Epoch: 2, Steps: 17 | Train Loss: 5.244 Vali Loss: 8.559 Vali Acc: 0.255 Test Loss: 8.559 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7728588581085205
Epoch: 3, Steps: 17 | Train Loss: 6.207 Vali Loss: 9.585 Vali Acc: 0.262 Test Loss: 9.585 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7954549789428711
Epoch: 4, Steps: 17 | Train Loss: 10.373 Vali Loss: 16.635 Vali Acc: 0.217 Test Loss: 16.635 Test Acc: 0.217
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8419971466064453
Epoch: 5, Steps: 17 | Train Loss: 11.298 Vali Loss: 17.988 Vali Acc: 0.274 Test Loss: 17.988 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6853926181793213
Epoch: 6, Steps: 17 | Train Loss: 8.079 Vali Loss: 11.955 Vali Acc: 0.259 Test Loss: 11.955 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7233128547668457
Epoch: 7, Steps: 17 | Train Loss: 5.693 Vali Loss: 7.088 Vali Acc: 0.247 Test Loss: 7.088 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.88572096824646
Epoch: 8, Steps: 17 | Train Loss: 5.370 Vali Loss: 12.123 Vali Acc: 0.247 Test Loss: 12.123 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7847659587860107
Epoch: 9, Steps: 17 | Train Loss: 4.871 Vali Loss: 7.736 Vali Acc: 0.289 Test Loss: 7.736 Test Acc: 0.289
Validation loss decreased (-0.273724 --> -0.288896).  Saving model ...
Epoch: 10 cost time: 0.7822864055633545
Epoch: 10, Steps: 17 | Train Loss: 3.879 Vali Loss: 7.308 Vali Acc: 0.274 Test Loss: 7.308 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.655188798904419
Epoch: 11, Steps: 17 | Train Loss: 3.307 Vali Loss: 5.074 Vali Acc: 0.259 Test Loss: 5.074 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7420699596405029
Epoch: 12, Steps: 17 | Train Loss: 2.636 Vali Loss: 7.273 Vali Acc: 0.274 Test Loss: 7.273 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7824606895446777
Epoch: 13, Steps: 17 | Train Loss: 2.825 Vali Loss: 5.820 Vali Acc: 0.247 Test Loss: 5.820 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6668996810913086
Epoch: 14, Steps: 17 | Train Loss: 2.815 Vali Loss: 4.074 Vali Acc: 0.221 Test Loss: 4.074 Test Acc: 0.221
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6998617649078369
Epoch: 15, Steps: 17 | Train Loss: 2.789 Vali Loss: 4.351 Vali Acc: 0.224 Test Loss: 4.351 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6505885124206543
Epoch: 16, Steps: 17 | Train Loss: 3.132 Vali Loss: 9.398 Vali Acc: 0.243 Test Loss: 9.398 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6769704818725586
Epoch: 17, Steps: 17 | Train Loss: 2.586 Vali Loss: 4.697 Vali Acc: 0.259 Test Loss: 4.697 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7165837287902832
Epoch: 18, Steps: 17 | Train Loss: 2.108 Vali Loss: 6.989 Vali Acc: 0.243 Test Loss: 6.989 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.675262451171875
Epoch: 19, Steps: 17 | Train Loss: 3.843 Vali Loss: 10.620 Vali Acc: 0.278 Test Loss: 10.620 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs584_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3248122
model size : 12.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs438_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0392355918884277
Epoch: 1, Steps: 17 | Train Loss: 3.874 Vali Loss: 4.554 Vali Acc: 0.251 Test Loss: 4.554 Test Acc: 0.251
Validation loss decreased (inf --> -0.250905).  Saving model ...
Epoch: 2 cost time: 0.6837091445922852
Epoch: 2, Steps: 17 | Train Loss: 5.277 Vali Loss: 5.305 Vali Acc: 0.300 Test Loss: 5.305 Test Acc: 0.300
Validation loss decreased (-0.250905 --> -0.300327).  Saving model ...
Epoch: 3 cost time: 0.7137458324432373
Epoch: 3, Steps: 17 | Train Loss: 4.620 Vali Loss: 12.755 Vali Acc: 0.266 Test Loss: 12.755 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.746514081954956
Epoch: 4, Steps: 17 | Train Loss: 9.997 Vali Loss: 12.443 Vali Acc: 0.297 Test Loss: 12.443 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6590242385864258
Epoch: 5, Steps: 17 | Train Loss: 7.974 Vali Loss: 10.356 Vali Acc: 0.243 Test Loss: 10.356 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8214364051818848
Epoch: 6, Steps: 17 | Train Loss: 5.538 Vali Loss: 10.118 Vali Acc: 0.240 Test Loss: 10.118 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6987900733947754
Epoch: 7, Steps: 17 | Train Loss: 5.696 Vali Loss: 11.312 Vali Acc: 0.266 Test Loss: 11.312 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7540979385375977
Epoch: 8, Steps: 17 | Train Loss: 7.551 Vali Loss: 11.478 Vali Acc: 0.243 Test Loss: 11.478 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8373997211456299
Epoch: 9, Steps: 17 | Train Loss: 5.318 Vali Loss: 6.432 Vali Acc: 0.274 Test Loss: 6.432 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.788823127746582
Epoch: 10, Steps: 17 | Train Loss: 4.041 Vali Loss: 7.763 Vali Acc: 0.278 Test Loss: 7.763 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7514693737030029
Epoch: 11, Steps: 17 | Train Loss: 3.769 Vali Loss: 5.556 Vali Acc: 0.289 Test Loss: 5.556 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.721724271774292
Epoch: 12, Steps: 17 | Train Loss: 4.651 Vali Loss: 4.841 Vali Acc: 0.255 Test Loss: 4.841 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs438_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3229452
model size : 12.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.339172601699829
Epoch: 1, Steps: 17 | Train Loss: 3.994 Vali Loss: 4.171 Vali Acc: 0.278 Test Loss: 4.171 Test Acc: 0.278
Validation loss decreased (inf --> -0.277525).  Saving model ...
Epoch: 2 cost time: 0.855022668838501
Epoch: 2, Steps: 17 | Train Loss: 5.880 Vali Loss: 10.730 Vali Acc: 0.259 Test Loss: 10.730 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9515681266784668
Epoch: 3, Steps: 17 | Train Loss: 7.800 Vali Loss: 9.982 Vali Acc: 0.289 Test Loss: 9.982 Test Acc: 0.289
Validation loss decreased (-0.277525 --> -0.288874).  Saving model ...
Epoch: 4 cost time: 0.8091118335723877
Epoch: 4, Steps: 17 | Train Loss: 5.648 Vali Loss: 8.790 Vali Acc: 0.251 Test Loss: 8.790 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8954877853393555
Epoch: 5, Steps: 17 | Train Loss: 6.935 Vali Loss: 12.538 Vali Acc: 0.247 Test Loss: 12.538 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7090039253234863
Epoch: 6, Steps: 17 | Train Loss: 9.284 Vali Loss: 11.724 Vali Acc: 0.236 Test Loss: 11.724 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7479283809661865
Epoch: 7, Steps: 17 | Train Loss: 5.721 Vali Loss: 13.140 Vali Acc: 0.243 Test Loss: 13.140 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8211050033569336
Epoch: 8, Steps: 17 | Train Loss: 4.977 Vali Loss: 11.302 Vali Acc: 0.243 Test Loss: 11.302 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7436470985412598
Epoch: 9, Steps: 17 | Train Loss: 6.894 Vali Loss: 9.117 Vali Acc: 0.285 Test Loss: 9.117 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7753117084503174
Epoch: 10, Steps: 17 | Train Loss: 4.511 Vali Loss: 12.056 Vali Acc: 0.251 Test Loss: 12.056 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8117928504943848
Epoch: 11, Steps: 17 | Train Loss: 5.828 Vali Loss: 4.805 Vali Acc: 0.240 Test Loss: 4.805 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8840374946594238
Epoch: 12, Steps: 17 | Train Loss: 4.432 Vali Loss: 6.944 Vali Acc: 0.270 Test Loss: 6.944 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8008317947387695
Epoch: 13, Steps: 17 | Train Loss: 3.926 Vali Loss: 6.917 Vali Acc: 0.224 Test Loss: 6.917 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3223591
model size : 12.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.273742914199829
Epoch: 1, Steps: 17 | Train Loss: 4.361 Vali Loss: 9.951 Vali Acc: 0.251 Test Loss: 9.951 Test Acc: 0.251
Validation loss decreased (inf --> -0.250851).  Saving model ...
Epoch: 2 cost time: 0.6611490249633789
Epoch: 2, Steps: 17 | Train Loss: 5.822 Vali Loss: 9.922 Vali Acc: 0.255 Test Loss: 9.922 Test Acc: 0.255
Validation loss decreased (-0.250851 --> -0.254654).  Saving model ...
Epoch: 3 cost time: 0.7652368545532227
Epoch: 3, Steps: 17 | Train Loss: 6.429 Vali Loss: 9.456 Vali Acc: 0.243 Test Loss: 9.456 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6702713966369629
Epoch: 4, Steps: 17 | Train Loss: 5.698 Vali Loss: 10.223 Vali Acc: 0.243 Test Loss: 10.223 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8044426441192627
Epoch: 5, Steps: 17 | Train Loss: 10.234 Vali Loss: 13.647 Vali Acc: 0.259 Test Loss: 13.647 Test Acc: 0.259
Validation loss decreased (-0.254654 --> -0.258419).  Saving model ...
Epoch: 6 cost time: 0.7779092788696289
Epoch: 6, Steps: 17 | Train Loss: 6.031 Vali Loss: 13.202 Vali Acc: 0.251 Test Loss: 13.202 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7750475406646729
Epoch: 7, Steps: 17 | Train Loss: 8.348 Vali Loss: 11.112 Vali Acc: 0.251 Test Loss: 11.112 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7998082637786865
Epoch: 8, Steps: 17 | Train Loss: 8.124 Vali Loss: 18.601 Vali Acc: 0.243 Test Loss: 18.601 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6492257118225098
Epoch: 9, Steps: 17 | Train Loss: 6.938 Vali Loss: 10.122 Vali Acc: 0.240 Test Loss: 10.122 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6992232799530029
Epoch: 10, Steps: 17 | Train Loss: 4.192 Vali Loss: 9.046 Vali Acc: 0.228 Test Loss: 9.046 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.824364423751831
Epoch: 11, Steps: 17 | Train Loss: 4.239 Vali Loss: 10.381 Vali Acc: 0.266 Test Loss: 10.381 Test Acc: 0.266
Validation loss decreased (-0.258419 --> -0.266056).  Saving model ...
Epoch: 12 cost time: 0.696831464767456
Epoch: 12, Steps: 17 | Train Loss: 3.909 Vali Loss: 5.530 Vali Acc: 0.259 Test Loss: 5.530 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7118320465087891
Epoch: 13, Steps: 17 | Train Loss: 2.480 Vali Loss: 4.090 Vali Acc: 0.243 Test Loss: 4.090 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6910068988800049
Epoch: 14, Steps: 17 | Train Loss: 2.232 Vali Loss: 5.124 Vali Acc: 0.274 Test Loss: 5.124 Test Acc: 0.274
Validation loss decreased (-0.266056 --> -0.273713).  Saving model ...
Epoch: 15 cost time: 0.7619888782501221
Epoch: 15, Steps: 17 | Train Loss: 2.094 Vali Loss: 5.706 Vali Acc: 0.266 Test Loss: 5.706 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7486376762390137
Epoch: 16, Steps: 17 | Train Loss: 2.610 Vali Loss: 6.721 Vali Acc: 0.243 Test Loss: 6.721 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6857118606567383
Epoch: 17, Steps: 17 | Train Loss: 2.208 Vali Loss: 4.302 Vali Acc: 0.270 Test Loss: 4.302 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7719371318817139
Epoch: 18, Steps: 17 | Train Loss: 2.711 Vali Loss: 3.814 Vali Acc: 0.262 Test Loss: 3.814 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7816288471221924
Epoch: 19, Steps: 17 | Train Loss: 2.067 Vali Loss: 4.793 Vali Acc: 0.281 Test Loss: 4.793 Test Acc: 0.281
Validation loss decreased (-0.273713 --> -0.281321).  Saving model ...
Epoch: 20 cost time: 0.8339247703552246
Epoch: 20, Steps: 17 | Train Loss: 2.040 Vali Loss: 5.720 Vali Acc: 0.278 Test Loss: 5.720 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.715975284576416
Epoch: 21, Steps: 17 | Train Loss: 2.466 Vali Loss: 6.445 Vali Acc: 0.224 Test Loss: 6.445 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8371584415435791
Epoch: 22, Steps: 17 | Train Loss: 3.536 Vali Loss: 6.300 Vali Acc: 0.247 Test Loss: 6.300 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.690800666809082
Epoch: 23, Steps: 17 | Train Loss: 2.313 Vali Loss: 5.089 Vali Acc: 0.262 Test Loss: 5.089 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6529452800750732
Epoch: 24, Steps: 17 | Train Loss: 2.851 Vali Loss: 7.657 Vali Acc: 0.232 Test Loss: 7.657 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7947721481323242
Epoch: 25, Steps: 17 | Train Loss: 3.891 Vali Loss: 6.083 Vali Acc: 0.262 Test Loss: 6.083 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7297942638397217
Epoch: 26, Steps: 17 | Train Loss: 4.621 Vali Loss: 10.352 Vali Acc: 0.255 Test Loss: 10.352 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6676976680755615
Epoch: 27, Steps: 17 | Train Loss: 3.586 Vali Loss: 9.166 Vali Acc: 0.270 Test Loss: 9.166 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7842426300048828
Epoch: 28, Steps: 17 | Train Loss: 2.427 Vali Loss: 6.731 Vali Acc: 0.266 Test Loss: 6.731 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6853220462799072
Epoch: 29, Steps: 17 | Train Loss: 3.277 Vali Loss: 6.626 Vali Acc: 0.266 Test Loss: 6.626 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3210812
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.200718879699707
Epoch: 1, Steps: 17 | Train Loss: 7.243 Vali Loss: 6.552 Vali Acc: 0.247 Test Loss: 6.552 Test Acc: 0.247
Validation loss decreased (inf --> -0.247083).  Saving model ...
Epoch: 2 cost time: 0.6656911373138428
Epoch: 2, Steps: 17 | Train Loss: 4.922 Vali Loss: 7.377 Vali Acc: 0.274 Test Loss: 7.377 Test Acc: 0.274
Validation loss decreased (-0.247083 --> -0.273690).  Saving model ...
Epoch: 3 cost time: 0.7154717445373535
Epoch: 3, Steps: 17 | Train Loss: 6.608 Vali Loss: 7.266 Vali Acc: 0.289 Test Loss: 7.266 Test Acc: 0.289
Validation loss decreased (-0.273690 --> -0.288901).  Saving model ...
Epoch: 4 cost time: 0.690040111541748
Epoch: 4, Steps: 17 | Train Loss: 6.505 Vali Loss: 7.918 Vali Acc: 0.270 Test Loss: 7.918 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6833460330963135
Epoch: 5, Steps: 17 | Train Loss: 5.545 Vali Loss: 10.245 Vali Acc: 0.217 Test Loss: 10.245 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8119838237762451
Epoch: 6, Steps: 17 | Train Loss: 4.392 Vali Loss: 14.026 Vali Acc: 0.240 Test Loss: 14.026 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6782236099243164
Epoch: 7, Steps: 17 | Train Loss: 5.968 Vali Loss: 8.076 Vali Acc: 0.247 Test Loss: 8.076 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.708146333694458
Epoch: 8, Steps: 17 | Train Loss: 4.790 Vali Loss: 7.161 Vali Acc: 0.259 Test Loss: 7.161 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.6718485355377197
Epoch: 9, Steps: 17 | Train Loss: 5.418 Vali Loss: 13.785 Vali Acc: 0.259 Test Loss: 13.785 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8975234031677246
Epoch: 10, Steps: 17 | Train Loss: 5.738 Vali Loss: 7.928 Vali Acc: 0.259 Test Loss: 7.928 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8070499897003174
Epoch: 11, Steps: 17 | Train Loss: 2.875 Vali Loss: 6.505 Vali Acc: 0.228 Test Loss: 6.505 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.88291335105896
Epoch: 12, Steps: 17 | Train Loss: 2.922 Vali Loss: 5.062 Vali Acc: 0.255 Test Loss: 5.062 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7608060836791992
Epoch: 13, Steps: 17 | Train Loss: 2.646 Vali Loss: 5.778 Vali Acc: 0.281 Test Loss: 5.778 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3214349
model size : 12.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.036914110183716
Epoch: 1, Steps: 17 | Train Loss: 4.486 Vali Loss: 3.717 Vali Acc: 0.278 Test Loss: 3.717 Test Acc: 0.278
Validation loss decreased (inf --> -0.277529).  Saving model ...
Epoch: 2 cost time: 0.6306090354919434
Epoch: 2, Steps: 17 | Train Loss: 4.622 Vali Loss: 11.019 Vali Acc: 0.266 Test Loss: 11.019 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.739809513092041
Epoch: 3, Steps: 17 | Train Loss: 7.670 Vali Loss: 5.504 Vali Acc: 0.247 Test Loss: 5.504 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7292220592498779
Epoch: 4, Steps: 17 | Train Loss: 5.375 Vali Loss: 9.714 Vali Acc: 0.266 Test Loss: 9.714 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8306524753570557
Epoch: 5, Steps: 17 | Train Loss: 5.337 Vali Loss: 8.305 Vali Acc: 0.236 Test Loss: 8.305 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8406951427459717
Epoch: 6, Steps: 17 | Train Loss: 4.965 Vali Loss: 6.167 Vali Acc: 0.297 Test Loss: 6.167 Test Acc: 0.297
Validation loss decreased (-0.277529 --> -0.296516).  Saving model ...
Epoch: 7 cost time: 0.8885996341705322
Epoch: 7, Steps: 17 | Train Loss: 6.732 Vali Loss: 13.702 Vali Acc: 0.255 Test Loss: 13.702 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8079907894134521
Epoch: 8, Steps: 17 | Train Loss: 5.912 Vali Loss: 8.398 Vali Acc: 0.221 Test Loss: 8.398 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8853757381439209
Epoch: 9, Steps: 17 | Train Loss: 4.669 Vali Loss: 6.652 Vali Acc: 0.281 Test Loss: 6.652 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8753714561462402
Epoch: 10, Steps: 17 | Train Loss: 5.508 Vali Loss: 12.028 Vali Acc: 0.243 Test Loss: 12.028 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8653767108917236
Epoch: 11, Steps: 17 | Train Loss: 5.925 Vali Loss: 8.499 Vali Acc: 0.270 Test Loss: 8.499 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8850150108337402
Epoch: 12, Steps: 17 | Train Loss: 4.014 Vali Loss: 7.277 Vali Acc: 0.274 Test Loss: 7.277 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.907543420791626
Epoch: 13, Steps: 17 | Train Loss: 3.461 Vali Loss: 8.754 Vali Acc: 0.274 Test Loss: 8.754 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8376119136810303
Epoch: 14, Steps: 17 | Train Loss: 3.856 Vali Loss: 4.963 Vali Acc: 0.262 Test Loss: 4.963 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8304917812347412
Epoch: 15, Steps: 17 | Train Loss: 2.713 Vali Loss: 6.292 Vali Acc: 0.232 Test Loss: 6.292 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.9949460029602051
Epoch: 16, Steps: 17 | Train Loss: 2.835 Vali Loss: 5.636 Vali Acc: 0.281 Test Loss: 5.636 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3201532
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.970933437347412
Epoch: 1, Steps: 17 | Train Loss: 6.377 Vali Loss: 8.879 Vali Acc: 0.251 Test Loss: 8.879 Test Acc: 0.251
Validation loss decreased (inf --> -0.250862).  Saving model ...
Epoch: 2 cost time: 0.7043962478637695
Epoch: 2, Steps: 17 | Train Loss: 6.522 Vali Loss: 6.045 Vali Acc: 0.221 Test Loss: 6.045 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7626931667327881
Epoch: 3, Steps: 17 | Train Loss: 4.257 Vali Loss: 8.137 Vali Acc: 0.274 Test Loss: 8.137 Test Acc: 0.274
Validation loss decreased (-0.250862 --> -0.273683).  Saving model ...
Epoch: 4 cost time: 0.6501476764678955
Epoch: 4, Steps: 17 | Train Loss: 4.748 Vali Loss: 6.620 Vali Acc: 0.259 Test Loss: 6.620 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.745922327041626
Epoch: 5, Steps: 17 | Train Loss: 6.404 Vali Loss: 6.650 Vali Acc: 0.240 Test Loss: 6.650 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.693361759185791
Epoch: 6, Steps: 17 | Train Loss: 6.845 Vali Loss: 10.894 Vali Acc: 0.236 Test Loss: 10.894 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8064393997192383
Epoch: 7, Steps: 17 | Train Loss: 6.366 Vali Loss: 13.052 Vali Acc: 0.266 Test Loss: 13.052 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7036328315734863
Epoch: 8, Steps: 17 | Train Loss: 9.190 Vali Loss: 16.703 Vali Acc: 0.266 Test Loss: 16.703 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8058137893676758
Epoch: 9, Steps: 17 | Train Loss: 7.338 Vali Loss: 12.285 Vali Acc: 0.289 Test Loss: 12.285 Test Acc: 0.289
Validation loss decreased (-0.273683 --> -0.288851).  Saving model ...
Epoch: 10 cost time: 0.7434365749359131
Epoch: 10, Steps: 17 | Train Loss: 7.186 Vali Loss: 7.321 Vali Acc: 0.266 Test Loss: 7.321 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.851125955581665
Epoch: 11, Steps: 17 | Train Loss: 3.445 Vali Loss: 10.498 Vali Acc: 0.259 Test Loss: 10.498 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7760763168334961
Epoch: 12, Steps: 17 | Train Loss: 4.573 Vali Loss: 6.031 Vali Acc: 0.278 Test Loss: 6.031 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6685774326324463
Epoch: 13, Steps: 17 | Train Loss: 3.152 Vali Loss: 4.693 Vali Acc: 0.262 Test Loss: 4.693 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6108913421630859
Epoch: 14, Steps: 17 | Train Loss: 2.612 Vali Loss: 5.343 Vali Acc: 0.224 Test Loss: 5.343 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6653761863708496
Epoch: 15, Steps: 17 | Train Loss: 2.519 Vali Loss: 7.977 Vali Acc: 0.270 Test Loss: 7.977 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6000893115997314
Epoch: 16, Steps: 17 | Train Loss: 3.513 Vali Loss: 5.332 Vali Acc: 0.259 Test Loss: 5.332 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7565274238586426
Epoch: 17, Steps: 17 | Train Loss: 2.835 Vali Loss: 5.627 Vali Acc: 0.255 Test Loss: 5.627 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.794562578201294
Epoch: 18, Steps: 17 | Train Loss: 2.225 Vali Loss: 5.475 Vali Acc: 0.255 Test Loss: 5.475 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7730879783630371
Epoch: 19, Steps: 17 | Train Loss: 2.542 Vali Loss: 7.761 Vali Acc: 0.243 Test Loss: 7.761 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3203751
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.228468656539917
Epoch: 1, Steps: 17 | Train Loss: 3.700 Vali Loss: 3.672 Vali Acc: 0.293 Test Loss: 3.672 Test Acc: 0.293
Validation loss decreased (inf --> -0.292739).  Saving model ...
Epoch: 2 cost time: 0.8194429874420166
Epoch: 2, Steps: 17 | Train Loss: 4.529 Vali Loss: 6.947 Vali Acc: 0.221 Test Loss: 6.947 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7971785068511963
Epoch: 3, Steps: 17 | Train Loss: 4.649 Vali Loss: 6.583 Vali Acc: 0.293 Test Loss: 6.583 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8700528144836426
Epoch: 4, Steps: 17 | Train Loss: 6.188 Vali Loss: 8.151 Vali Acc: 0.278 Test Loss: 8.151 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6935489177703857
Epoch: 5, Steps: 17 | Train Loss: 4.885 Vali Loss: 12.760 Vali Acc: 0.262 Test Loss: 12.760 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7062792778015137
Epoch: 6, Steps: 17 | Train Loss: 6.072 Vali Loss: 13.972 Vali Acc: 0.243 Test Loss: 13.972 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.803992748260498
Epoch: 7, Steps: 17 | Train Loss: 7.114 Vali Loss: 16.059 Vali Acc: 0.266 Test Loss: 16.059 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7089493274688721
Epoch: 8, Steps: 17 | Train Loss: 6.492 Vali Loss: 7.288 Vali Acc: 0.221 Test Loss: 7.288 Test Acc: 0.221
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.735238790512085
Epoch: 9, Steps: 17 | Train Loss: 3.960 Vali Loss: 7.401 Vali Acc: 0.232 Test Loss: 7.401 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6986455917358398
Epoch: 10, Steps: 17 | Train Loss: 6.125 Vali Loss: 12.376 Vali Acc: 0.266 Test Loss: 12.376 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6424031257629395
Epoch: 11, Steps: 17 | Train Loss: 5.760 Vali Loss: 13.560 Vali Acc: 0.255 Test Loss: 13.560 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3210116
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.162426471710205
Epoch: 1, Steps: 17 | Train Loss: 5.897 Vali Loss: 4.679 Vali Acc: 0.251 Test Loss: 4.679 Test Acc: 0.251
Validation loss decreased (inf --> -0.250904).  Saving model ...
Epoch: 2 cost time: 0.7405941486358643
Epoch: 2, Steps: 17 | Train Loss: 5.767 Vali Loss: 8.490 Vali Acc: 0.255 Test Loss: 8.490 Test Acc: 0.255
Validation loss decreased (-0.250904 --> -0.254668).  Saving model ...
Epoch: 3 cost time: 0.8049285411834717
Epoch: 3, Steps: 17 | Train Loss: 6.520 Vali Loss: 12.699 Vali Acc: 0.255 Test Loss: 12.699 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7598986625671387
Epoch: 4, Steps: 17 | Train Loss: 6.293 Vali Loss: 11.977 Vali Acc: 0.240 Test Loss: 11.977 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7326233386993408
Epoch: 5, Steps: 17 | Train Loss: 8.088 Vali Loss: 6.729 Vali Acc: 0.289 Test Loss: 6.729 Test Acc: 0.289
Validation loss decreased (-0.254668 --> -0.288906).  Saving model ...
Epoch: 6 cost time: 0.7033059597015381
Epoch: 6, Steps: 17 | Train Loss: 3.628 Vali Loss: 6.980 Vali Acc: 0.278 Test Loss: 6.980 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7366452217102051
Epoch: 7, Steps: 17 | Train Loss: 4.155 Vali Loss: 9.358 Vali Acc: 0.243 Test Loss: 9.358 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9402816295623779
Epoch: 8, Steps: 17 | Train Loss: 5.727 Vali Loss: 12.909 Vali Acc: 0.255 Test Loss: 12.909 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8032755851745605
Epoch: 9, Steps: 17 | Train Loss: 5.866 Vali Loss: 9.387 Vali Acc: 0.236 Test Loss: 9.387 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7171595096588135
Epoch: 10, Steps: 17 | Train Loss: 4.675 Vali Loss: 16.622 Vali Acc: 0.262 Test Loss: 16.622 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7868819236755371
Epoch: 11, Steps: 17 | Train Loss: 7.087 Vali Loss: 7.612 Vali Acc: 0.266 Test Loss: 7.612 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8194277286529541
Epoch: 12, Steps: 17 | Train Loss: 4.195 Vali Loss: 6.513 Vali Acc: 0.255 Test Loss: 6.513 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7389044761657715
Epoch: 13, Steps: 17 | Train Loss: 3.277 Vali Loss: 6.689 Vali Acc: 0.224 Test Loss: 6.689 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.69134521484375
Epoch: 14, Steps: 17 | Train Loss: 3.800 Vali Loss: 5.918 Vali Acc: 0.259 Test Loss: 5.918 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8869400024414062
Epoch: 15, Steps: 17 | Train Loss: 2.881 Vali Loss: 4.384 Vali Acc: 0.228 Test Loss: 4.384 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3208114
model size : 12.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9800610542297363
Epoch: 1, Steps: 17 | Train Loss: 4.314 Vali Loss: 4.400 Vali Acc: 0.255 Test Loss: 4.400 Test Acc: 0.255
Validation loss decreased (inf --> -0.254709).  Saving model ...
Epoch: 2 cost time: 0.6881222724914551
Epoch: 2, Steps: 17 | Train Loss: 4.409 Vali Loss: 5.992 Vali Acc: 0.266 Test Loss: 5.992 Test Acc: 0.266
Validation loss decreased (-0.254709 --> -0.266100).  Saving model ...
Epoch: 3 cost time: 0.6770482063293457
Epoch: 3, Steps: 17 | Train Loss: 4.177 Vali Loss: 4.163 Vali Acc: 0.243 Test Loss: 4.163 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7622666358947754
Epoch: 4, Steps: 17 | Train Loss: 5.181 Vali Loss: 14.578 Vali Acc: 0.251 Test Loss: 14.578 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5949928760528564
Epoch: 5, Steps: 17 | Train Loss: 8.188 Vali Loss: 13.637 Vali Acc: 0.240 Test Loss: 13.637 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7659444808959961
Epoch: 6, Steps: 17 | Train Loss: 7.873 Vali Loss: 9.412 Vali Acc: 0.259 Test Loss: 9.412 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7148232460021973
Epoch: 7, Steps: 17 | Train Loss: 7.271 Vali Loss: 9.970 Vali Acc: 0.255 Test Loss: 9.970 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7959647178649902
Epoch: 8, Steps: 17 | Train Loss: 8.004 Vali Loss: 14.432 Vali Acc: 0.266 Test Loss: 14.432 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8130350112915039
Epoch: 9, Steps: 17 | Train Loss: 6.805 Vali Loss: 14.256 Vali Acc: 0.240 Test Loss: 14.256 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7481729984283447
Epoch: 10, Steps: 17 | Train Loss: 5.310 Vali Loss: 14.245 Vali Acc: 0.255 Test Loss: 14.245 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.774183988571167
Epoch: 11, Steps: 17 | Train Loss: 6.234 Vali Loss: 10.288 Vali Acc: 0.274 Test Loss: 10.288 Test Acc: 0.274
Validation loss decreased (-0.266100 --> -0.273661).  Saving model ...
Epoch: 12 cost time: 0.7729573249816895
Epoch: 12, Steps: 17 | Train Loss: 4.271 Vali Loss: 5.041 Vali Acc: 0.255 Test Loss: 5.041 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7809658050537109
Epoch: 13, Steps: 17 | Train Loss: 2.570 Vali Loss: 4.227 Vali Acc: 0.221 Test Loss: 4.227 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7054152488708496
Epoch: 14, Steps: 17 | Train Loss: 2.464 Vali Loss: 6.317 Vali Acc: 0.255 Test Loss: 6.317 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7363054752349854
Epoch: 15, Steps: 17 | Train Loss: 4.796 Vali Loss: 6.079 Vali Acc: 0.247 Test Loss: 6.079 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8138906955718994
Epoch: 16, Steps: 17 | Train Loss: 2.934 Vali Loss: 6.137 Vali Acc: 0.274 Test Loss: 6.137 Test Acc: 0.274
Validation loss decreased (-0.273661 --> -0.273703).  Saving model ...
Epoch: 17 cost time: 0.753596305847168
Epoch: 17, Steps: 17 | Train Loss: 2.984 Vali Loss: 5.096 Vali Acc: 0.274 Test Loss: 5.096 Test Acc: 0.274
Validation loss decreased (-0.273703 --> -0.273713).  Saving model ...
Epoch: 18 cost time: 0.7380774021148682
Epoch: 18, Steps: 17 | Train Loss: 4.790 Vali Loss: 5.038 Vali Acc: 0.266 Test Loss: 5.038 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9979827404022217
Epoch: 19, Steps: 17 | Train Loss: 2.564 Vali Loss: 7.733 Vali Acc: 0.247 Test Loss: 7.733 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7517595291137695
Epoch: 20, Steps: 17 | Train Loss: 2.708 Vali Loss: 5.623 Vali Acc: 0.259 Test Loss: 5.623 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7439112663269043
Epoch: 21, Steps: 17 | Train Loss: 2.922 Vali Loss: 5.937 Vali Acc: 0.243 Test Loss: 5.937 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7162766456604004
Epoch: 22, Steps: 17 | Train Loss: 2.737 Vali Loss: 6.422 Vali Acc: 0.266 Test Loss: 6.422 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6659553050994873
Epoch: 23, Steps: 17 | Train Loss: 2.912 Vali Loss: 4.936 Vali Acc: 0.274 Test Loss: 4.936 Test Acc: 0.274
Validation loss decreased (-0.273713 --> -0.273715).  Saving model ...
Epoch: 24 cost time: 0.802180290222168
Epoch: 24, Steps: 17 | Train Loss: 3.031 Vali Loss: 9.774 Vali Acc: 0.266 Test Loss: 9.774 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7437360286712646
Epoch: 25, Steps: 17 | Train Loss: 4.323 Vali Loss: 7.518 Vali Acc: 0.266 Test Loss: 7.518 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7405967712402344
Epoch: 26, Steps: 17 | Train Loss: 2.600 Vali Loss: 7.948 Vali Acc: 0.270 Test Loss: 7.948 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6882667541503906
Epoch: 27, Steps: 17 | Train Loss: 3.795 Vali Loss: 7.981 Vali Acc: 0.262 Test Loss: 7.981 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7250826358795166
Epoch: 28, Steps: 17 | Train Loss: 3.191 Vali Loss: 8.232 Vali Acc: 0.278 Test Loss: 8.232 Test Acc: 0.278
Validation loss decreased (-0.273715 --> -0.277484).  Saving model ...
Epoch: 29 cost time: 0.6804122924804688
Epoch: 29, Steps: 17 | Train Loss: 2.363 Vali Loss: 7.813 Vali Acc: 0.243 Test Loss: 7.813 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6830732822418213
Epoch: 30, Steps: 17 | Train Loss: 2.405 Vali Loss: 9.245 Vali Acc: 0.240 Test Loss: 9.245 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7367901802062988
Epoch: 31, Steps: 17 | Train Loss: 2.873 Vali Loss: 6.790 Vali Acc: 0.274 Test Loss: 6.790 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7648718357086182
Epoch: 32, Steps: 17 | Train Loss: 2.336 Vali Loss: 9.675 Vali Acc: 0.262 Test Loss: 9.675 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7690999507904053
Epoch: 33, Steps: 17 | Train Loss: 2.894 Vali Loss: 7.355 Vali Acc: 0.278 Test Loss: 7.355 Test Acc: 0.278
Validation loss decreased (-0.277484 --> -0.277493).  Saving model ...
Epoch: 34 cost time: 0.7314488887786865
Epoch: 34, Steps: 17 | Train Loss: 3.410 Vali Loss: 11.297 Vali Acc: 0.232 Test Loss: 11.297 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.809065580368042
Epoch: 35, Steps: 17 | Train Loss: 3.728 Vali Loss: 10.256 Vali Acc: 0.285 Test Loss: 10.256 Test Acc: 0.285
Validation loss decreased (-0.277493 --> -0.285069).  Saving model ...
Epoch: 36 cost time: 0.7303128242492676
Epoch: 36, Steps: 17 | Train Loss: 2.547 Vali Loss: 8.422 Vali Acc: 0.262 Test Loss: 8.422 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.823340654373169
Epoch: 37, Steps: 17 | Train Loss: 2.227 Vali Loss: 12.678 Vali Acc: 0.251 Test Loss: 12.678 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7296695709228516
Epoch: 38, Steps: 17 | Train Loss: 3.490 Vali Loss: 7.721 Vali Acc: 0.247 Test Loss: 7.721 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.748284101486206
Epoch: 39, Steps: 17 | Train Loss: 1.925 Vali Loss: 10.277 Vali Acc: 0.232 Test Loss: 10.277 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6842324733734131
Epoch: 40, Steps: 17 | Train Loss: 2.581 Vali Loss: 11.577 Vali Acc: 0.240 Test Loss: 11.577 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7225170135498047
Epoch: 41, Steps: 17 | Train Loss: 4.102 Vali Loss: 11.597 Vali Acc: 0.232 Test Loss: 11.597 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7158424854278564
Epoch: 42, Steps: 17 | Train Loss: 3.074 Vali Loss: 12.724 Vali Acc: 0.232 Test Loss: 12.724 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8249638080596924
Epoch: 43, Steps: 17 | Train Loss: 2.807 Vali Loss: 8.212 Vali Acc: 0.262 Test Loss: 8.212 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.7454969882965088
Epoch: 44, Steps: 17 | Train Loss: 2.305 Vali Loss: 20.187 Vali Acc: 0.251 Test Loss: 20.187 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7621526718139648
Epoch: 45, Steps: 17 | Train Loss: 4.518 Vali Loss: 19.136 Vali Acc: 0.259 Test Loss: 19.136 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3192364
model size : 12.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.161118984222412
Epoch: 1, Steps: 17 | Train Loss: 4.729 Vali Loss: 6.078 Vali Acc: 0.262 Test Loss: 6.078 Test Acc: 0.262
Validation loss decreased (inf --> -0.262297).  Saving model ...
Epoch: 2 cost time: 0.7448306083679199
Epoch: 2, Steps: 17 | Train Loss: 5.005 Vali Loss: 3.414 Vali Acc: 0.285 Test Loss: 3.414 Test Acc: 0.285
Validation loss decreased (-0.262297 --> -0.285137).  Saving model ...
Epoch: 3 cost time: 0.8333649635314941
Epoch: 3, Steps: 17 | Train Loss: 5.599 Vali Loss: 9.846 Vali Acc: 0.247 Test Loss: 9.846 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6578867435455322
Epoch: 4, Steps: 17 | Train Loss: 7.215 Vali Loss: 6.825 Vali Acc: 0.262 Test Loss: 6.825 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7120950222015381
Epoch: 5, Steps: 17 | Train Loss: 4.245 Vali Loss: 5.045 Vali Acc: 0.255 Test Loss: 5.045 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8066294193267822
Epoch: 6, Steps: 17 | Train Loss: 5.289 Vali Loss: 6.846 Vali Acc: 0.270 Test Loss: 6.846 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7094821929931641
Epoch: 7, Steps: 17 | Train Loss: 6.642 Vali Loss: 14.786 Vali Acc: 0.255 Test Loss: 14.786 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7909376621246338
Epoch: 8, Steps: 17 | Train Loss: 9.471 Vali Loss: 17.057 Vali Acc: 0.251 Test Loss: 17.057 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7139713764190674
Epoch: 9, Steps: 17 | Train Loss: 7.288 Vali Loss: 6.936 Vali Acc: 0.236 Test Loss: 6.936 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.8522932529449463
Epoch: 10, Steps: 17 | Train Loss: 4.052 Vali Loss: 8.762 Vali Acc: 0.228 Test Loss: 8.762 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7619273662567139
Epoch: 11, Steps: 17 | Train Loss: 4.848 Vali Loss: 6.768 Vali Acc: 0.285 Test Loss: 6.768 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8260319232940674
Epoch: 12, Steps: 17 | Train Loss: 4.368 Vali Loss: 6.948 Vali Acc: 0.228 Test Loss: 6.948 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3196263
model size : 12.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.073198080062866
Epoch: 1, Steps: 17 | Train Loss: 5.840 Vali Loss: 7.625 Vali Acc: 0.240 Test Loss: 7.625 Test Acc: 0.240
Validation loss decreased (inf --> -0.239467).  Saving model ...
Epoch: 2 cost time: 0.6859755516052246
Epoch: 2, Steps: 17 | Train Loss: 4.485 Vali Loss: 6.932 Vali Acc: 0.224 Test Loss: 6.932 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8878579139709473
Epoch: 3, Steps: 17 | Train Loss: 4.802 Vali Loss: 5.506 Vali Acc: 0.285 Test Loss: 5.506 Test Acc: 0.285
Validation loss decreased (-0.239467 --> -0.285116).  Saving model ...
Epoch: 4 cost time: 0.6903457641601562
Epoch: 4, Steps: 17 | Train Loss: 6.207 Vali Loss: 11.608 Vali Acc: 0.255 Test Loss: 11.608 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7358949184417725
Epoch: 5, Steps: 17 | Train Loss: 6.051 Vali Loss: 11.775 Vali Acc: 0.247 Test Loss: 11.775 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.810161828994751
Epoch: 6, Steps: 17 | Train Loss: 10.128 Vali Loss: 11.117 Vali Acc: 0.240 Test Loss: 11.117 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7813935279846191
Epoch: 7, Steps: 17 | Train Loss: 5.373 Vali Loss: 8.622 Vali Acc: 0.198 Test Loss: 8.622 Test Acc: 0.198
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0304296016693115
Epoch: 8, Steps: 17 | Train Loss: 4.375 Vali Loss: 10.810 Vali Acc: 0.278 Test Loss: 10.810 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7352094650268555
Epoch: 9, Steps: 17 | Train Loss: 6.268 Vali Loss: 6.728 Vali Acc: 0.278 Test Loss: 6.728 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.8979730606079102
Epoch: 10, Steps: 17 | Train Loss: 3.209 Vali Loss: 7.249 Vali Acc: 0.240 Test Loss: 7.249 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8455889225006104
Epoch: 11, Steps: 17 | Train Loss: 3.582 Vali Loss: 5.450 Vali Acc: 0.243 Test Loss: 5.450 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.839972972869873
Epoch: 12, Steps: 17 | Train Loss: 2.726 Vali Loss: 6.535 Vali Acc: 0.259 Test Loss: 6.535 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.8740923404693604
Epoch: 13, Steps: 17 | Train Loss: 3.708 Vali Loss: 5.603 Vali Acc: 0.247 Test Loss: 5.603 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3210928
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0791871547698975
Epoch: 1, Steps: 17 | Train Loss: 3.953 Vali Loss: 5.950 Vali Acc: 0.300 Test Loss: 5.950 Test Acc: 0.300
Validation loss decreased (inf --> -0.300321).  Saving model ...
Epoch: 2 cost time: 0.7795460224151611
Epoch: 2, Steps: 17 | Train Loss: 6.228 Vali Loss: 9.420 Vali Acc: 0.262 Test Loss: 9.420 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5798134803771973
Epoch: 3, Steps: 17 | Train Loss: 8.023 Vali Loss: 10.630 Vali Acc: 0.270 Test Loss: 10.630 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8754968643188477
Epoch: 4, Steps: 17 | Train Loss: 6.307 Vali Loss: 12.930 Vali Acc: 0.266 Test Loss: 12.930 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9269218444824219
Epoch: 5, Steps: 17 | Train Loss: 5.858 Vali Loss: 7.971 Vali Acc: 0.274 Test Loss: 7.971 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8625307083129883
Epoch: 6, Steps: 17 | Train Loss: 6.373 Vali Loss: 12.606 Vali Acc: 0.274 Test Loss: 12.606 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8233902454376221
Epoch: 7, Steps: 17 | Train Loss: 8.570 Vali Loss: 11.516 Vali Acc: 0.247 Test Loss: 11.516 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7819311618804932
Epoch: 8, Steps: 17 | Train Loss: 8.932 Vali Loss: 13.917 Vali Acc: 0.262 Test Loss: 13.917 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9720938205718994
Epoch: 9, Steps: 17 | Train Loss: 6.896 Vali Loss: 8.556 Vali Acc: 0.259 Test Loss: 8.556 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6444721221923828
Epoch: 10, Steps: 17 | Train Loss: 3.413 Vali Loss: 8.741 Vali Acc: 0.270 Test Loss: 8.741 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.8573029041290283
Epoch: 11, Steps: 17 | Train Loss: 3.270 Vali Loss: 6.562 Vali Acc: 0.259 Test Loss: 6.562 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3194079
model size : 12.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9915101528167725
Epoch: 1, Steps: 17 | Train Loss: 4.686 Vali Loss: 7.527 Vali Acc: 0.262 Test Loss: 7.527 Test Acc: 0.262
Validation loss decreased (inf --> -0.262282).  Saving model ...
Epoch: 2 cost time: 0.8633770942687988
Epoch: 2, Steps: 17 | Train Loss: 5.252 Vali Loss: 7.700 Vali Acc: 0.251 Test Loss: 7.700 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7467427253723145
Epoch: 3, Steps: 17 | Train Loss: 5.804 Vali Loss: 7.992 Vali Acc: 0.274 Test Loss: 7.992 Test Acc: 0.274
Validation loss decreased (-0.262282 --> -0.273684).  Saving model ...
Epoch: 4 cost time: 0.8513996601104736
Epoch: 4, Steps: 17 | Train Loss: 4.015 Vali Loss: 7.352 Vali Acc: 0.266 Test Loss: 7.352 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7077770233154297
Epoch: 5, Steps: 17 | Train Loss: 5.226 Vali Loss: 11.742 Vali Acc: 0.251 Test Loss: 11.742 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.902543306350708
Epoch: 6, Steps: 17 | Train Loss: 4.847 Vali Loss: 13.659 Vali Acc: 0.259 Test Loss: 13.659 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8101718425750732
Epoch: 7, Steps: 17 | Train Loss: 7.926 Vali Loss: 12.760 Vali Acc: 0.262 Test Loss: 12.760 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.843986988067627
Epoch: 8, Steps: 17 | Train Loss: 7.746 Vali Loss: 8.975 Vali Acc: 0.209 Test Loss: 8.975 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8272910118103027
Epoch: 9, Steps: 17 | Train Loss: 5.094 Vali Loss: 9.368 Vali Acc: 0.251 Test Loss: 9.368 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7826406955718994
Epoch: 10, Steps: 17 | Train Loss: 6.527 Vali Loss: 8.860 Vali Acc: 0.262 Test Loss: 8.860 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8332769870758057
Epoch: 11, Steps: 17 | Train Loss: 5.081 Vali Loss: 10.264 Vali Acc: 0.224 Test Loss: 10.264 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7426595687866211
Epoch: 12, Steps: 17 | Train Loss: 5.146 Vali Loss: 7.589 Vali Acc: 0.274 Test Loss: 7.589 Test Acc: 0.274
Validation loss decreased (-0.273684 --> -0.273688).  Saving model ...
Epoch: 13 cost time: 0.8475236892700195
Epoch: 13, Steps: 17 | Train Loss: 3.208 Vali Loss: 7.161 Vali Acc: 0.236 Test Loss: 7.161 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7438678741455078
Epoch: 14, Steps: 17 | Train Loss: 3.378 Vali Loss: 5.592 Vali Acc: 0.247 Test Loss: 5.592 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8393797874450684
Epoch: 15, Steps: 17 | Train Loss: 2.530 Vali Loss: 10.268 Vali Acc: 0.319 Test Loss: 10.268 Test Acc: 0.319
Validation loss decreased (-0.273688 --> -0.319289).  Saving model ...
Epoch: 16 cost time: 0.7835326194763184
Epoch: 16, Steps: 17 | Train Loss: 4.340 Vali Loss: 7.604 Vali Acc: 0.255 Test Loss: 7.604 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8394417762756348
Epoch: 17, Steps: 17 | Train Loss: 3.755 Vali Loss: 7.737 Vali Acc: 0.243 Test Loss: 7.737 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8297839164733887
Epoch: 18, Steps: 17 | Train Loss: 3.411 Vali Loss: 6.896 Vali Acc: 0.259 Test Loss: 6.896 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7583372592926025
Epoch: 19, Steps: 17 | Train Loss: 2.512 Vali Loss: 6.662 Vali Acc: 0.251 Test Loss: 6.662 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9004764556884766
Epoch: 20, Steps: 17 | Train Loss: 3.206 Vali Loss: 9.664 Vali Acc: 0.247 Test Loss: 9.664 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8750677108764648
Epoch: 21, Steps: 17 | Train Loss: 3.209 Vali Loss: 7.866 Vali Acc: 0.243 Test Loss: 7.866 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7623839378356934
Epoch: 22, Steps: 17 | Train Loss: 3.954 Vali Loss: 6.884 Vali Acc: 0.270 Test Loss: 6.884 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8719451427459717
Epoch: 23, Steps: 17 | Train Loss: 3.301 Vali Loss: 6.777 Vali Acc: 0.278 Test Loss: 6.777 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7520387172698975
Epoch: 24, Steps: 17 | Train Loss: 2.468 Vali Loss: 5.212 Vali Acc: 0.236 Test Loss: 5.212 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8773698806762695
Epoch: 25, Steps: 17 | Train Loss: 3.760 Vali Loss: 7.433 Vali Acc: 0.247 Test Loss: 7.433 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 3202004
model size : 12.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9314556121826172
Epoch: 1, Steps: 17 | Train Loss: 4.230 Vali Loss: 4.465 Vali Acc: 0.240 Test Loss: 4.465 Test Acc: 0.240
Validation loss decreased (inf --> -0.239499).  Saving model ...
Epoch: 2 cost time: 0.7121131420135498
Epoch: 2, Steps: 17 | Train Loss: 5.417 Vali Loss: 9.858 Vali Acc: 0.266 Test Loss: 9.858 Test Acc: 0.266
Validation loss decreased (-0.239499 --> -0.266061).  Saving model ...
Epoch: 3 cost time: 0.812793493270874
Epoch: 3, Steps: 17 | Train Loss: 4.747 Vali Loss: 9.874 Vali Acc: 0.247 Test Loss: 9.874 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7963030338287354
Epoch: 4, Steps: 17 | Train Loss: 8.537 Vali Loss: 18.198 Vali Acc: 0.247 Test Loss: 18.198 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6649763584136963
Epoch: 5, Steps: 17 | Train Loss: 9.584 Vali Loss: 21.666 Vali Acc: 0.251 Test Loss: 21.666 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7156510353088379
Epoch: 6, Steps: 17 | Train Loss: 10.885 Vali Loss: 9.816 Vali Acc: 0.262 Test Loss: 9.816 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7395117282867432
Epoch: 7, Steps: 17 | Train Loss: 6.047 Vali Loss: 14.423 Vali Acc: 0.259 Test Loss: 14.423 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8686175346374512
Epoch: 8, Steps: 17 | Train Loss: 5.806 Vali Loss: 9.836 Vali Acc: 0.232 Test Loss: 9.836 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6468203067779541
Epoch: 9, Steps: 17 | Train Loss: 5.177 Vali Loss: 7.333 Vali Acc: 0.209 Test Loss: 7.333 Test Acc: 0.209
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7977397441864014
Epoch: 10, Steps: 17 | Train Loss: 4.394 Vali Loss: 7.017 Vali Acc: 0.278 Test Loss: 7.017 Test Acc: 0.278
Validation loss decreased (-0.266061 --> -0.277496).  Saving model ...
Epoch: 11 cost time: 0.732741117477417
Epoch: 11, Steps: 17 | Train Loss: 4.188 Vali Loss: 6.669 Vali Acc: 0.259 Test Loss: 6.669 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.865877628326416
Epoch: 12, Steps: 17 | Train Loss: 3.626 Vali Loss: 4.571 Vali Acc: 0.281 Test Loss: 4.571 Test Acc: 0.281
Validation loss decreased (-0.277496 --> -0.281323).  Saving model ...
Epoch: 13 cost time: 0.7943189144134521
Epoch: 13, Steps: 17 | Train Loss: 3.785 Vali Loss: 4.595 Vali Acc: 0.247 Test Loss: 4.595 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6770751476287842
Epoch: 14, Steps: 17 | Train Loss: 2.763 Vali Loss: 5.529 Vali Acc: 0.285 Test Loss: 5.529 Test Acc: 0.285
Validation loss decreased (-0.281323 --> -0.285116).  Saving model ...
Epoch: 15 cost time: 0.8029677867889404
Epoch: 15, Steps: 17 | Train Loss: 2.611 Vali Loss: 4.609 Vali Acc: 0.255 Test Loss: 4.609 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8394732475280762
Epoch: 16, Steps: 17 | Train Loss: 2.029 Vali Loss: 5.704 Vali Acc: 0.285 Test Loss: 5.704 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8999307155609131
Epoch: 17, Steps: 17 | Train Loss: 2.969 Vali Loss: 8.115 Vali Acc: 0.255 Test Loss: 8.115 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7370009422302246
Epoch: 18, Steps: 17 | Train Loss: 3.259 Vali Loss: 6.846 Vali Acc: 0.281 Test Loss: 6.846 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7380959987640381
Epoch: 19, Steps: 17 | Train Loss: 2.219 Vali Loss: 4.170 Vali Acc: 0.217 Test Loss: 4.170 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.822009801864624
Epoch: 20, Steps: 17 | Train Loss: 2.070 Vali Loss: 4.584 Vali Acc: 0.240 Test Loss: 4.584 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7641158103942871
Epoch: 21, Steps: 17 | Train Loss: 1.960 Vali Loss: 9.741 Vali Acc: 0.228 Test Loss: 9.741 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8080105781555176
Epoch: 22, Steps: 17 | Train Loss: 2.581 Vali Loss: 5.419 Vali Acc: 0.251 Test Loss: 5.419 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8191468715667725
Epoch: 23, Steps: 17 | Train Loss: 2.141 Vali Loss: 8.399 Vali Acc: 0.266 Test Loss: 8.399 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7826752662658691
Epoch: 24, Steps: 17 | Train Loss: 3.704 Vali Loss: 7.497 Vali Acc: 0.232 Test Loss: 7.497 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3185419
model size : 12.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.397663116455078
Epoch: 1, Steps: 17 | Train Loss: 6.406 Vali Loss: 13.421 Vali Acc: 0.247 Test Loss: 13.421 Test Acc: 0.247
Validation loss decreased (inf --> -0.247014).  Saving model ...
Epoch: 2 cost time: 0.738823652267456
Epoch: 2, Steps: 17 | Train Loss: 7.824 Vali Loss: 8.875 Vali Acc: 0.232 Test Loss: 8.875 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7488806247711182
Epoch: 3, Steps: 17 | Train Loss: 5.639 Vali Loss: 7.077 Vali Acc: 0.224 Test Loss: 7.077 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6601443290710449
Epoch: 4, Steps: 17 | Train Loss: 6.375 Vali Loss: 6.413 Vali Acc: 0.285 Test Loss: 6.413 Test Acc: 0.285
Validation loss decreased (-0.247014 --> -0.285107).  Saving model ...
Epoch: 5 cost time: 0.8812534809112549
Epoch: 5, Steps: 17 | Train Loss: 8.413 Vali Loss: 9.975 Vali Acc: 0.243 Test Loss: 9.975 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7199583053588867
Epoch: 6, Steps: 17 | Train Loss: 8.975 Vali Loss: 10.396 Vali Acc: 0.228 Test Loss: 10.396 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7330365180969238
Epoch: 7, Steps: 17 | Train Loss: 5.873 Vali Loss: 8.270 Vali Acc: 0.312 Test Loss: 8.270 Test Acc: 0.312
Validation loss decreased (-0.285107 --> -0.311704).  Saving model ...
Epoch: 8 cost time: 0.7493839263916016
Epoch: 8, Steps: 17 | Train Loss: 4.545 Vali Loss: 6.213 Vali Acc: 0.278 Test Loss: 6.213 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8174498081207275
Epoch: 9, Steps: 17 | Train Loss: 3.953 Vali Loss: 5.787 Vali Acc: 0.293 Test Loss: 5.787 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8619077205657959
Epoch: 10, Steps: 17 | Train Loss: 3.271 Vali Loss: 5.092 Vali Acc: 0.281 Test Loss: 5.092 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8029005527496338
Epoch: 11, Steps: 17 | Train Loss: 3.416 Vali Loss: 10.163 Vali Acc: 0.247 Test Loss: 10.163 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.8591945171356201
Epoch: 12, Steps: 17 | Train Loss: 2.898 Vali Loss: 5.743 Vali Acc: 0.262 Test Loss: 5.743 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6926736831665039
Epoch: 13, Steps: 17 | Train Loss: 3.807 Vali Loss: 8.961 Vali Acc: 0.255 Test Loss: 8.961 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6636505126953125
Epoch: 14, Steps: 17 | Train Loss: 2.248 Vali Loss: 7.795 Vali Acc: 0.266 Test Loss: 7.795 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.715461015701294
Epoch: 15, Steps: 17 | Train Loss: 4.172 Vali Loss: 8.424 Vali Acc: 0.236 Test Loss: 8.424 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.741417407989502
Epoch: 16, Steps: 17 | Train Loss: 2.950 Vali Loss: 5.397 Vali Acc: 0.274 Test Loss: 5.397 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.765404224395752
Epoch: 17, Steps: 17 | Train Loss: 2.157 Vali Loss: 5.650 Vali Acc: 0.300 Test Loss: 5.650 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 3207616
model size : 12.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.163452386856079
Epoch: 1, Steps: 17 | Train Loss: 4.114 Vali Loss: 5.954 Vali Acc: 0.262 Test Loss: 5.954 Test Acc: 0.262
Validation loss decreased (inf --> -0.262298).  Saving model ...
Epoch: 2 cost time: 0.8428761959075928
Epoch: 2, Steps: 17 | Train Loss: 4.633 Vali Loss: 9.695 Vali Acc: 0.289 Test Loss: 9.695 Test Acc: 0.289
Validation loss decreased (-0.262298 --> -0.288876).  Saving model ...
Epoch: 3 cost time: 0.7260217666625977
Epoch: 3, Steps: 17 | Train Loss: 5.627 Vali Loss: 7.628 Vali Acc: 0.266 Test Loss: 7.628 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7702372074127197
Epoch: 4, Steps: 17 | Train Loss: 3.961 Vali Loss: 7.804 Vali Acc: 0.259 Test Loss: 7.804 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7584545612335205
Epoch: 5, Steps: 17 | Train Loss: 5.360 Vali Loss: 8.739 Vali Acc: 0.251 Test Loss: 8.739 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7276744842529297
Epoch: 6, Steps: 17 | Train Loss: 6.313 Vali Loss: 13.930 Vali Acc: 0.270 Test Loss: 13.930 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7707827091217041
Epoch: 7, Steps: 17 | Train Loss: 6.469 Vali Loss: 13.543 Vali Acc: 0.270 Test Loss: 13.543 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7171812057495117
Epoch: 8, Steps: 17 | Train Loss: 6.107 Vali Loss: 17.292 Vali Acc: 0.251 Test Loss: 17.292 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6934866905212402
Epoch: 9, Steps: 17 | Train Loss: 5.403 Vali Loss: 6.954 Vali Acc: 0.312 Test Loss: 6.954 Test Acc: 0.312
Validation loss decreased (-0.288876 --> -0.311718).  Saving model ...
Epoch: 10 cost time: 0.6786646842956543
Epoch: 10, Steps: 17 | Train Loss: 3.749 Vali Loss: 7.227 Vali Acc: 0.270 Test Loss: 7.227 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8113052845001221
Epoch: 11, Steps: 17 | Train Loss: 4.029 Vali Loss: 8.499 Vali Acc: 0.255 Test Loss: 8.499 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6547222137451172
Epoch: 12, Steps: 17 | Train Loss: 6.963 Vali Loss: 9.056 Vali Acc: 0.232 Test Loss: 9.056 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.761061429977417
Epoch: 13, Steps: 17 | Train Loss: 6.282 Vali Loss: 9.386 Vali Acc: 0.270 Test Loss: 9.386 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9706544876098633
Epoch: 14, Steps: 17 | Train Loss: 3.259 Vali Loss: 5.385 Vali Acc: 0.259 Test Loss: 5.385 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6390810012817383
Epoch: 15, Steps: 17 | Train Loss: 4.034 Vali Loss: 11.288 Vali Acc: 0.240 Test Loss: 11.288 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7279491424560547
Epoch: 16, Steps: 17 | Train Loss: 4.839 Vali Loss: 6.046 Vali Acc: 0.224 Test Loss: 6.046 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7735939025878906
Epoch: 17, Steps: 17 | Train Loss: 3.548 Vali Loss: 5.275 Vali Acc: 0.228 Test Loss: 5.275 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7167136669158936
Epoch: 18, Steps: 17 | Train Loss: 2.185 Vali Loss: 8.111 Vali Acc: 0.259 Test Loss: 8.111 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.688971996307373
Epoch: 19, Steps: 17 | Train Loss: 3.883 Vali Loss: 6.415 Vali Acc: 0.236 Test Loss: 6.415 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 3212307
model size : 12.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0469179153442383
Epoch: 1, Steps: 17 | Train Loss: 4.996 Vali Loss: 4.106 Vali Acc: 0.251 Test Loss: 4.106 Test Acc: 0.251
Validation loss decreased (inf --> -0.250910).  Saving model ...
Epoch: 2 cost time: 0.8277335166931152
Epoch: 2, Steps: 17 | Train Loss: 3.652 Vali Loss: 5.504 Vali Acc: 0.270 Test Loss: 5.504 Test Acc: 0.270
Validation loss decreased (-0.250910 --> -0.269907).  Saving model ...
Epoch: 3 cost time: 0.7956104278564453
Epoch: 3, Steps: 17 | Train Loss: 3.394 Vali Loss: 5.457 Vali Acc: 0.289 Test Loss: 5.457 Test Acc: 0.289
Validation loss decreased (-0.269907 --> -0.288919).  Saving model ...
Epoch: 4 cost time: 0.7900879383087158
Epoch: 4, Steps: 17 | Train Loss: 6.166 Vali Loss: 8.552 Vali Acc: 0.255 Test Loss: 8.552 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.672147274017334
Epoch: 5, Steps: 17 | Train Loss: 5.801 Vali Loss: 11.371 Vali Acc: 0.236 Test Loss: 11.371 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7781484127044678
Epoch: 6, Steps: 17 | Train Loss: 6.426 Vali Loss: 12.585 Vali Acc: 0.266 Test Loss: 12.585 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7129085063934326
Epoch: 7, Steps: 17 | Train Loss: 8.954 Vali Loss: 10.176 Vali Acc: 0.262 Test Loss: 10.176 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7329492568969727
Epoch: 8, Steps: 17 | Train Loss: 5.451 Vali Loss: 8.127 Vali Acc: 0.259 Test Loss: 8.127 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.671642541885376
Epoch: 9, Steps: 17 | Train Loss: 4.304 Vali Loss: 10.369 Vali Acc: 0.255 Test Loss: 10.369 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.9302167892456055
Epoch: 10, Steps: 17 | Train Loss: 5.503 Vali Loss: 7.516 Vali Acc: 0.281 Test Loss: 7.516 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7864136695861816
Epoch: 11, Steps: 17 | Train Loss: 4.615 Vali Loss: 6.315 Vali Acc: 0.240 Test Loss: 6.315 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7500088214874268
Epoch: 12, Steps: 17 | Train Loss: 5.955 Vali Loss: 10.376 Vali Acc: 0.266 Test Loss: 10.376 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7812554836273193
Epoch: 13, Steps: 17 | Train Loss: 4.529 Vali Loss: 8.100 Vali Acc: 0.262 Test Loss: 8.100 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3199492
model size : 12.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.161954879760742
Epoch: 1, Steps: 17 | Train Loss: 6.573 Vali Loss: 5.436 Vali Acc: 0.262 Test Loss: 5.436 Test Acc: 0.262
Validation loss decreased (inf --> -0.262303).  Saving model ...
Epoch: 2 cost time: 0.772376298904419
Epoch: 2, Steps: 17 | Train Loss: 4.406 Vali Loss: 7.333 Vali Acc: 0.259 Test Loss: 7.333 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.852968692779541
Epoch: 3, Steps: 17 | Train Loss: 4.663 Vali Loss: 5.956 Vali Acc: 0.266 Test Loss: 5.956 Test Acc: 0.266
Validation loss decreased (-0.262303 --> -0.266100).  Saving model ...
Epoch: 4 cost time: 0.7196390628814697
Epoch: 4, Steps: 17 | Train Loss: 3.760 Vali Loss: 9.756 Vali Acc: 0.243 Test Loss: 9.756 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8000431060791016
Epoch: 5, Steps: 17 | Train Loss: 7.024 Vali Loss: 16.007 Vali Acc: 0.259 Test Loss: 16.007 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8246750831604004
Epoch: 6, Steps: 17 | Train Loss: 10.320 Vali Loss: 8.687 Vali Acc: 0.255 Test Loss: 8.687 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6862492561340332
Epoch: 7, Steps: 17 | Train Loss: 3.619 Vali Loss: 11.391 Vali Acc: 0.274 Test Loss: 11.391 Test Acc: 0.274
Validation loss decreased (-0.266100 --> -0.273650).  Saving model ...
Epoch: 8 cost time: 0.8495774269104004
Epoch: 8, Steps: 17 | Train Loss: 6.987 Vali Loss: 12.946 Vali Acc: 0.262 Test Loss: 12.946 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7631475925445557
Epoch: 9, Steps: 17 | Train Loss: 4.960 Vali Loss: 8.398 Vali Acc: 0.240 Test Loss: 8.398 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7304928302764893
Epoch: 10, Steps: 17 | Train Loss: 7.988 Vali Loss: 11.156 Vali Acc: 0.251 Test Loss: 11.156 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8012673854827881
Epoch: 11, Steps: 17 | Train Loss: 5.614 Vali Loss: 11.384 Vali Acc: 0.259 Test Loss: 11.384 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7089653015136719
Epoch: 12, Steps: 17 | Train Loss: 3.964 Vali Loss: 5.717 Vali Acc: 0.262 Test Loss: 5.717 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.827171802520752
Epoch: 13, Steps: 17 | Train Loss: 3.453 Vali Loss: 4.485 Vali Acc: 0.228 Test Loss: 4.485 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7722716331481934
Epoch: 14, Steps: 17 | Train Loss: 2.448 Vali Loss: 5.672 Vali Acc: 0.274 Test Loss: 5.672 Test Acc: 0.274
Validation loss decreased (-0.273650 --> -0.273708).  Saving model ...
Epoch: 15 cost time: 0.7045938968658447
Epoch: 15, Steps: 17 | Train Loss: 3.254 Vali Loss: 7.354 Vali Acc: 0.274 Test Loss: 7.354 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6428790092468262
Epoch: 16, Steps: 17 | Train Loss: 4.219 Vali Loss: 4.387 Vali Acc: 0.278 Test Loss: 4.387 Test Acc: 0.278
Validation loss decreased (-0.273708 --> -0.277523).  Saving model ...
Epoch: 17 cost time: 0.7016301155090332
Epoch: 17, Steps: 17 | Train Loss: 3.260 Vali Loss: 5.716 Vali Acc: 0.232 Test Loss: 5.716 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7045323848724365
Epoch: 18, Steps: 17 | Train Loss: 2.352 Vali Loss: 6.099 Vali Acc: 0.259 Test Loss: 6.099 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6222898960113525
Epoch: 19, Steps: 17 | Train Loss: 2.540 Vali Loss: 7.517 Vali Acc: 0.240 Test Loss: 7.517 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.735802412033081
Epoch: 20, Steps: 17 | Train Loss: 2.780 Vali Loss: 6.850 Vali Acc: 0.255 Test Loss: 6.850 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8209774494171143
Epoch: 21, Steps: 17 | Train Loss: 3.548 Vali Loss: 5.603 Vali Acc: 0.247 Test Loss: 5.603 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8502693176269531
Epoch: 22, Steps: 17 | Train Loss: 2.778 Vali Loss: 5.674 Vali Acc: 0.289 Test Loss: 5.674 Test Acc: 0.289
Validation loss decreased (-0.277523 --> -0.288917).  Saving model ...
Epoch: 23 cost time: 0.747969388961792
Epoch: 23, Steps: 17 | Train Loss: 2.838 Vali Loss: 8.140 Vali Acc: 0.285 Test Loss: 8.140 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7719447612762451
Epoch: 24, Steps: 17 | Train Loss: 2.218 Vali Loss: 6.669 Vali Acc: 0.247 Test Loss: 6.669 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8669552803039551
Epoch: 25, Steps: 17 | Train Loss: 2.835 Vali Loss: 7.671 Vali Acc: 0.240 Test Loss: 7.671 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8176915645599365
Epoch: 26, Steps: 17 | Train Loss: 3.831 Vali Loss: 7.499 Vali Acc: 0.209 Test Loss: 7.499 Test Acc: 0.209
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8410563468933105
Epoch: 27, Steps: 17 | Train Loss: 2.894 Vali Loss: 6.957 Vali Acc: 0.228 Test Loss: 6.957 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7216513156890869
Epoch: 28, Steps: 17 | Train Loss: 4.139 Vali Loss: 8.414 Vali Acc: 0.278 Test Loss: 8.414 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8753931522369385
Epoch: 29, Steps: 17 | Train Loss: 4.125 Vali Loss: 6.062 Vali Acc: 0.217 Test Loss: 6.062 Test Acc: 0.217
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7318274974822998
Epoch: 30, Steps: 17 | Train Loss: 3.613 Vali Loss: 7.727 Vali Acc: 0.213 Test Loss: 7.727 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7567830085754395
Epoch: 31, Steps: 17 | Train Loss: 3.406 Vali Loss: 6.919 Vali Acc: 0.247 Test Loss: 6.919 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8762667179107666
Epoch: 32, Steps: 17 | Train Loss: 4.391 Vali Loss: 7.142 Vali Acc: 0.300 Test Loss: 7.142 Test Acc: 0.300
Validation loss decreased (-0.288917 --> -0.300309).  Saving model ...
Epoch: 33 cost time: 0.9275658130645752
Epoch: 33, Steps: 17 | Train Loss: 2.564 Vali Loss: 7.048 Vali Acc: 0.274 Test Loss: 7.048 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7732276916503906
Epoch: 34, Steps: 17 | Train Loss: 2.103 Vali Loss: 9.008 Vali Acc: 0.270 Test Loss: 9.008 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8543000221252441
Epoch: 35, Steps: 17 | Train Loss: 3.937 Vali Loss: 6.453 Vali Acc: 0.281 Test Loss: 6.453 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8789761066436768
Epoch: 36, Steps: 17 | Train Loss: 3.076 Vali Loss: 7.842 Vali Acc: 0.247 Test Loss: 7.842 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8177783489227295
Epoch: 37, Steps: 17 | Train Loss: 3.997 Vali Loss: 11.440 Vali Acc: 0.266 Test Loss: 11.440 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7700788974761963
Epoch: 38, Steps: 17 | Train Loss: 4.039 Vali Loss: 9.447 Vali Acc: 0.259 Test Loss: 9.447 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8022236824035645
Epoch: 39, Steps: 17 | Train Loss: 5.232 Vali Loss: 11.905 Vali Acc: 0.243 Test Loss: 11.905 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8601667881011963
Epoch: 40, Steps: 17 | Train Loss: 3.254 Vali Loss: 7.319 Vali Acc: 0.274 Test Loss: 7.319 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8222818374633789
Epoch: 41, Steps: 17 | Train Loss: 2.548 Vali Loss: 9.656 Vali Acc: 0.259 Test Loss: 9.656 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8138110637664795
Epoch: 42, Steps: 17 | Train Loss: 3.358 Vali Loss: 12.896 Vali Acc: 0.293 Test Loss: 12.896 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm256_cs84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3206070
model size : 12.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9108378887176514
Epoch: 1, Steps: 17 | Train Loss: 3.137 Vali Loss: 3.604 Vali Acc: 0.243 Test Loss: 3.604 Test Acc: 0.243
Validation loss decreased (inf --> -0.243310).  Saving model ...
Epoch: 2 cost time: 0.8061177730560303
Epoch: 2, Steps: 17 | Train Loss: 4.735 Vali Loss: 4.712 Vali Acc: 0.240 Test Loss: 4.712 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7725272178649902
Epoch: 3, Steps: 17 | Train Loss: 5.008 Vali Loss: 10.043 Vali Acc: 0.259 Test Loss: 10.043 Test Acc: 0.259
Validation loss decreased (-0.243310 --> -0.258455).  Saving model ...
Epoch: 4 cost time: 0.8601045608520508
Epoch: 4, Steps: 17 | Train Loss: 6.558 Vali Loss: 7.794 Vali Acc: 0.251 Test Loss: 7.794 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6496341228485107
Epoch: 5, Steps: 17 | Train Loss: 3.933 Vali Loss: 7.443 Vali Acc: 0.251 Test Loss: 7.443 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6495120525360107
Epoch: 6, Steps: 17 | Train Loss: 6.257 Vali Loss: 12.909 Vali Acc: 0.262 Test Loss: 12.909 Test Acc: 0.262
Validation loss decreased (-0.258455 --> -0.262228).  Saving model ...
Epoch: 7 cost time: 0.7108883857727051
Epoch: 7, Steps: 17 | Train Loss: 5.588 Vali Loss: 10.532 Vali Acc: 0.236 Test Loss: 10.532 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7966198921203613
Epoch: 8, Steps: 17 | Train Loss: 5.821 Vali Loss: 9.488 Vali Acc: 0.243 Test Loss: 9.488 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7120304107666016
Epoch: 9, Steps: 17 | Train Loss: 6.505 Vali Loss: 13.821 Vali Acc: 0.243 Test Loss: 13.821 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.845426082611084
Epoch: 10, Steps: 17 | Train Loss: 6.674 Vali Loss: 11.361 Vali Acc: 0.270 Test Loss: 11.361 Test Acc: 0.270
Validation loss decreased (-0.262228 --> -0.269848).  Saving model ...
Epoch: 11 cost time: 0.8464608192443848
Epoch: 11, Steps: 17 | Train Loss: 4.191 Vali Loss: 8.575 Vali Acc: 0.255 Test Loss: 8.575 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8129456043243408
Epoch: 12, Steps: 17 | Train Loss: 3.990 Vali Loss: 6.232 Vali Acc: 0.262 Test Loss: 6.232 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7369871139526367
Epoch: 13, Steps: 17 | Train Loss: 4.878 Vali Loss: 8.126 Vali Acc: 0.202 Test Loss: 8.126 Test Acc: 0.202
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8462188243865967
Epoch: 14, Steps: 17 | Train Loss: 2.987 Vali Loss: 5.599 Vali Acc: 0.266 Test Loss: 5.599 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7575485706329346
Epoch: 15, Steps: 17 | Train Loss: 4.047 Vali Loss: 6.118 Vali Acc: 0.243 Test Loss: 6.118 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.711003303527832
Epoch: 16, Steps: 17 | Train Loss: 3.281 Vali Loss: 4.463 Vali Acc: 0.255 Test Loss: 4.463 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6911206245422363
Epoch: 17, Steps: 17 | Train Loss: 1.995 Vali Loss: 4.639 Vali Acc: 0.255 Test Loss: 4.639 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7444095611572266
Epoch: 18, Steps: 17 | Train Loss: 1.907 Vali Loss: 6.809 Vali Acc: 0.228 Test Loss: 6.809 Test Acc: 0.228
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8521664142608643
Epoch: 19, Steps: 17 | Train Loss: 3.734 Vali Loss: 5.828 Vali Acc: 0.274 Test Loss: 5.828 Test Acc: 0.274
Validation loss decreased (-0.269848 --> -0.273706).  Saving model ...
Epoch: 20 cost time: 0.9333570003509521
Epoch: 20, Steps: 17 | Train Loss: 3.467 Vali Loss: 6.238 Vali Acc: 0.297 Test Loss: 6.238 Test Acc: 0.297
Validation loss decreased (-0.273706 --> -0.296516).  Saving model ...
Epoch: 21 cost time: 0.7654037475585938
Epoch: 21, Steps: 17 | Train Loss: 2.295 Vali Loss: 8.468 Vali Acc: 0.255 Test Loss: 8.468 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8529698848724365
Epoch: 22, Steps: 17 | Train Loss: 3.133 Vali Loss: 7.677 Vali Acc: 0.232 Test Loss: 7.677 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.914043664932251
Epoch: 23, Steps: 17 | Train Loss: 3.857 Vali Loss: 8.939 Vali Acc: 0.289 Test Loss: 8.939 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7989697456359863
Epoch: 24, Steps: 17 | Train Loss: 3.176 Vali Loss: 6.987 Vali Acc: 0.266 Test Loss: 6.987 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8389205932617188
Epoch: 25, Steps: 17 | Train Loss: 2.328 Vali Loss: 5.370 Vali Acc: 0.266 Test Loss: 5.370 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8348321914672852
Epoch: 26, Steps: 17 | Train Loss: 2.720 Vali Loss: 7.287 Vali Acc: 0.240 Test Loss: 7.287 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8656332492828369
Epoch: 27, Steps: 17 | Train Loss: 2.862 Vali Loss: 7.528 Vali Acc: 0.247 Test Loss: 7.528 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9224324226379395
Epoch: 28, Steps: 17 | Train Loss: 2.955 Vali Loss: 8.575 Vali Acc: 0.236 Test Loss: 8.575 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8073813915252686
Epoch: 29, Steps: 17 | Train Loss: 2.247 Vali Loss: 8.214 Vali Acc: 0.236 Test Loss: 8.214 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8890442848205566
Epoch: 30, Steps: 17 | Train Loss: 1.867 Vali Loss: 7.798 Vali Acc: 0.259 Test Loss: 7.798 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3182748
model size : 12.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs584_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.128260612487793
Epoch: 1, Steps: 17 | Train Loss: 4.889 Vali Loss: 4.643 Vali Acc: 0.240 Test Loss: 4.643 Test Acc: 0.240
Validation loss decreased (inf --> -0.239497).  Saving model ...
Epoch: 2 cost time: 0.82757568359375
Epoch: 2, Steps: 17 | Train Loss: 4.477 Vali Loss: 5.578 Vali Acc: 0.270 Test Loss: 5.578 Test Acc: 0.270
Validation loss decreased (-0.239497 --> -0.269906).  Saving model ...
Epoch: 3 cost time: 0.8708229064941406
Epoch: 3, Steps: 17 | Train Loss: 4.728 Vali Loss: 6.423 Vali Acc: 0.255 Test Loss: 6.423 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8575708866119385
Epoch: 4, Steps: 17 | Train Loss: 3.708 Vali Loss: 5.083 Vali Acc: 0.228 Test Loss: 5.083 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7614600658416748
Epoch: 5, Steps: 17 | Train Loss: 5.125 Vali Loss: 8.410 Vali Acc: 0.247 Test Loss: 8.410 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7193117141723633
Epoch: 6, Steps: 17 | Train Loss: 8.865 Vali Loss: 10.051 Vali Acc: 0.221 Test Loss: 10.051 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7430713176727295
Epoch: 7, Steps: 17 | Train Loss: 6.692 Vali Loss: 9.830 Vali Acc: 0.255 Test Loss: 9.830 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8542156219482422
Epoch: 8, Steps: 17 | Train Loss: 5.673 Vali Loss: 9.605 Vali Acc: 0.247 Test Loss: 9.605 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.791297197341919
Epoch: 9, Steps: 17 | Train Loss: 4.314 Vali Loss: 10.375 Vali Acc: 0.270 Test Loss: 10.375 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7474837303161621
Epoch: 10, Steps: 17 | Train Loss: 6.187 Vali Loss: 14.723 Vali Acc: 0.243 Test Loss: 14.723 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8253576755523682
Epoch: 11, Steps: 17 | Train Loss: 7.256 Vali Loss: 6.648 Vali Acc: 0.240 Test Loss: 6.648 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8199057579040527
Epoch: 12, Steps: 17 | Train Loss: 3.956 Vali Loss: 11.347 Vali Acc: 0.255 Test Loss: 11.347 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs584_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3164074
model size : 12.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs438_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1542623043060303
Epoch: 1, Steps: 17 | Train Loss: 6.093 Vali Loss: 7.203 Vali Acc: 0.247 Test Loss: 7.203 Test Acc: 0.247
Validation loss decreased (inf --> -0.247076).  Saving model ...
Epoch: 2 cost time: 0.7498149871826172
Epoch: 2, Steps: 17 | Train Loss: 4.747 Vali Loss: 4.016 Vali Acc: 0.247 Test Loss: 4.016 Test Acc: 0.247
Validation loss decreased (-0.247076 --> -0.247108).  Saving model ...
Epoch: 3 cost time: 0.7898635864257812
Epoch: 3, Steps: 17 | Train Loss: 6.047 Vali Loss: 9.899 Vali Acc: 0.259 Test Loss: 9.899 Test Acc: 0.259
Validation loss decreased (-0.247108 --> -0.258456).  Saving model ...
Epoch: 4 cost time: 0.7929263114929199
Epoch: 4, Steps: 17 | Train Loss: 8.283 Vali Loss: 5.860 Vali Acc: 0.240 Test Loss: 5.860 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8651206493377686
Epoch: 5, Steps: 17 | Train Loss: 7.078 Vali Loss: 5.955 Vali Acc: 0.262 Test Loss: 5.955 Test Acc: 0.262
Validation loss decreased (-0.258456 --> -0.262298).  Saving model ...
Epoch: 6 cost time: 0.8645741939544678
Epoch: 6, Steps: 17 | Train Loss: 7.937 Vali Loss: 10.987 Vali Acc: 0.259 Test Loss: 10.987 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7806637287139893
Epoch: 7, Steps: 17 | Train Loss: 6.017 Vali Loss: 10.285 Vali Acc: 0.251 Test Loss: 10.285 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.840583324432373
Epoch: 8, Steps: 17 | Train Loss: 6.124 Vali Loss: 10.859 Vali Acc: 0.262 Test Loss: 10.859 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7897293567657471
Epoch: 9, Steps: 17 | Train Loss: 6.603 Vali Loss: 6.622 Vali Acc: 0.240 Test Loss: 6.622 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7223186492919922
Epoch: 10, Steps: 17 | Train Loss: 3.146 Vali Loss: 11.016 Vali Acc: 0.259 Test Loss: 11.016 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.870840311050415
Epoch: 11, Steps: 17 | Train Loss: 5.004 Vali Loss: 6.203 Vali Acc: 0.247 Test Loss: 6.203 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7452125549316406
Epoch: 12, Steps: 17 | Train Loss: 3.940 Vali Loss: 6.969 Vali Acc: 0.266 Test Loss: 6.969 Test Acc: 0.266
Validation loss decreased (-0.262298 --> -0.266090).  Saving model ...
Epoch: 13 cost time: 0.8080906867980957
Epoch: 13, Steps: 17 | Train Loss: 3.634 Vali Loss: 5.220 Vali Acc: 0.281 Test Loss: 5.220 Test Acc: 0.281
Validation loss decreased (-0.266090 --> -0.281317).  Saving model ...
Epoch: 14 cost time: 0.6733016967773438
Epoch: 14, Steps: 17 | Train Loss: 3.534 Vali Loss: 6.674 Vali Acc: 0.247 Test Loss: 6.674 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7389817237854004
Epoch: 15, Steps: 17 | Train Loss: 2.605 Vali Loss: 5.885 Vali Acc: 0.251 Test Loss: 5.885 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7715158462524414
Epoch: 16, Steps: 17 | Train Loss: 2.358 Vali Loss: 5.106 Vali Acc: 0.243 Test Loss: 5.106 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7915897369384766
Epoch: 17, Steps: 17 | Train Loss: 3.933 Vali Loss: 4.780 Vali Acc: 0.270 Test Loss: 4.780 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7523257732391357
Epoch: 18, Steps: 17 | Train Loss: 2.557 Vali Loss: 6.133 Vali Acc: 0.240 Test Loss: 6.133 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7585878372192383
Epoch: 19, Steps: 17 | Train Loss: 3.434 Vali Loss: 8.122 Vali Acc: 0.293 Test Loss: 8.122 Test Acc: 0.293
Validation loss decreased (-0.281317 --> -0.292694).  Saving model ...
Epoch: 20 cost time: 0.7959415912628174
Epoch: 20, Steps: 17 | Train Loss: 3.117 Vali Loss: 9.044 Vali Acc: 0.228 Test Loss: 9.044 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8176083564758301
Epoch: 21, Steps: 17 | Train Loss: 4.120 Vali Loss: 4.663 Vali Acc: 0.270 Test Loss: 4.663 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7540853023529053
Epoch: 22, Steps: 17 | Train Loss: 2.607 Vali Loss: 7.197 Vali Acc: 0.251 Test Loss: 7.197 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6851973533630371
Epoch: 23, Steps: 17 | Train Loss: 2.323 Vali Loss: 6.226 Vali Acc: 0.232 Test Loss: 6.226 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7290651798248291
Epoch: 24, Steps: 17 | Train Loss: 2.920 Vali Loss: 7.029 Vali Acc: 0.232 Test Loss: 7.029 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.784714937210083
Epoch: 25, Steps: 17 | Train Loss: 2.325 Vali Loss: 11.943 Vali Acc: 0.224 Test Loss: 11.943 Test Acc: 0.224
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7151753902435303
Epoch: 26, Steps: 17 | Train Loss: 3.690 Vali Loss: 7.649 Vali Acc: 0.240 Test Loss: 7.649 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8284521102905273
Epoch: 27, Steps: 17 | Train Loss: 2.801 Vali Loss: 7.440 Vali Acc: 0.274 Test Loss: 7.440 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7986767292022705
Epoch: 28, Steps: 17 | Train Loss: 2.659 Vali Loss: 8.934 Vali Acc: 0.243 Test Loss: 8.934 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8517041206359863
Epoch: 29, Steps: 17 | Train Loss: 3.876 Vali Loss: 8.103 Vali Acc: 0.262 Test Loss: 8.103 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs438_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3154748
model size : 12.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2003870010375977
Epoch: 1, Steps: 17 | Train Loss: 4.183 Vali Loss: 5.373 Vali Acc: 0.217 Test Loss: 5.373 Test Acc: 0.217
Validation loss decreased (inf --> -0.216676).  Saving model ...
Epoch: 2 cost time: 0.668339729309082
Epoch: 2, Steps: 17 | Train Loss: 4.935 Vali Loss: 6.777 Vali Acc: 0.274 Test Loss: 6.777 Test Acc: 0.274
Validation loss decreased (-0.216676 --> -0.273696).  Saving model ...
Epoch: 3 cost time: 0.7377455234527588
Epoch: 3, Steps: 17 | Train Loss: 7.546 Vali Loss: 8.374 Vali Acc: 0.247 Test Loss: 8.374 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6711196899414062
Epoch: 4, Steps: 17 | Train Loss: 4.463 Vali Loss: 6.207 Vali Acc: 0.266 Test Loss: 6.207 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7861058712005615
Epoch: 5, Steps: 17 | Train Loss: 5.376 Vali Loss: 11.678 Vali Acc: 0.236 Test Loss: 11.678 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8400735855102539
Epoch: 6, Steps: 17 | Train Loss: 4.728 Vali Loss: 14.261 Vali Acc: 0.259 Test Loss: 14.261 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8096761703491211
Epoch: 7, Steps: 17 | Train Loss: 7.165 Vali Loss: 14.320 Vali Acc: 0.266 Test Loss: 14.320 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8316740989685059
Epoch: 8, Steps: 17 | Train Loss: 4.991 Vali Loss: 10.154 Vali Acc: 0.262 Test Loss: 10.154 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8324408531188965
Epoch: 9, Steps: 17 | Train Loss: 5.279 Vali Loss: 14.995 Vali Acc: 0.236 Test Loss: 14.995 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0092387199401855
Epoch: 10, Steps: 17 | Train Loss: 6.072 Vali Loss: 9.316 Vali Acc: 0.281 Test Loss: 9.316 Test Acc: 0.281
Validation loss decreased (-0.273696 --> -0.281276).  Saving model ...
Epoch: 11 cost time: 0.8510231971740723
Epoch: 11, Steps: 17 | Train Loss: 5.001 Vali Loss: 4.529 Vali Acc: 0.221 Test Loss: 4.529 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8063559532165527
Epoch: 12, Steps: 17 | Train Loss: 4.786 Vali Loss: 6.618 Vali Acc: 0.251 Test Loss: 6.618 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9892687797546387
Epoch: 13, Steps: 17 | Train Loss: 2.930 Vali Loss: 9.355 Vali Acc: 0.243 Test Loss: 9.355 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7805478572845459
Epoch: 14, Steps: 17 | Train Loss: 3.856 Vali Loss: 7.141 Vali Acc: 0.247 Test Loss: 7.141 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9933416843414307
Epoch: 15, Steps: 17 | Train Loss: 3.504 Vali Loss: 6.059 Vali Acc: 0.236 Test Loss: 6.059 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.733220100402832
Epoch: 16, Steps: 17 | Train Loss: 2.133 Vali Loss: 3.965 Vali Acc: 0.266 Test Loss: 3.965 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9084794521331787
Epoch: 17, Steps: 17 | Train Loss: 2.789 Vali Loss: 4.696 Vali Acc: 0.251 Test Loss: 4.696 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6198275089263916
Epoch: 18, Steps: 17 | Train Loss: 2.173 Vali Loss: 6.846 Vali Acc: 0.247 Test Loss: 6.846 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7287693023681641
Epoch: 19, Steps: 17 | Train Loss: 3.507 Vali Loss: 11.098 Vali Acc: 0.217 Test Loss: 11.098 Test Acc: 0.217
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6510133743286133
Epoch: 20, Steps: 17 | Train Loss: 3.318 Vali Loss: 7.315 Vali Acc: 0.255 Test Loss: 7.315 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3154455
model size : 12.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.132133722305298
Epoch: 1, Steps: 17 | Train Loss: 4.041 Vali Loss: 3.644 Vali Acc: 0.247 Test Loss: 3.644 Test Acc: 0.247
Validation loss decreased (inf --> -0.247112).  Saving model ...
Epoch: 2 cost time: 0.8631587028503418
Epoch: 2, Steps: 17 | Train Loss: 4.565 Vali Loss: 8.839 Vali Acc: 0.262 Test Loss: 8.839 Test Acc: 0.262
Validation loss decreased (-0.247112 --> -0.262269).  Saving model ...
Epoch: 3 cost time: 0.7402853965759277
Epoch: 3, Steps: 17 | Train Loss: 6.227 Vali Loss: 8.880 Vali Acc: 0.243 Test Loss: 8.880 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.766808032989502
Epoch: 4, Steps: 17 | Train Loss: 6.792 Vali Loss: 15.494 Vali Acc: 0.247 Test Loss: 15.494 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6636757850646973
Epoch: 5, Steps: 17 | Train Loss: 9.971 Vali Loss: 16.691 Vali Acc: 0.251 Test Loss: 16.691 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7540576457977295
Epoch: 6, Steps: 17 | Train Loss: 7.170 Vali Loss: 8.537 Vali Acc: 0.262 Test Loss: 8.537 Test Acc: 0.262
Validation loss decreased (-0.262269 --> -0.262272).  Saving model ...
Epoch: 7 cost time: 0.876171350479126
Epoch: 7, Steps: 17 | Train Loss: 3.801 Vali Loss: 11.017 Vali Acc: 0.217 Test Loss: 11.017 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7423043251037598
Epoch: 8, Steps: 17 | Train Loss: 5.788 Vali Loss: 5.991 Vali Acc: 0.243 Test Loss: 5.991 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7822082042694092
Epoch: 9, Steps: 17 | Train Loss: 4.681 Vali Loss: 8.874 Vali Acc: 0.232 Test Loss: 8.874 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6473948955535889
Epoch: 10, Steps: 17 | Train Loss: 4.940 Vali Loss: 7.888 Vali Acc: 0.247 Test Loss: 7.888 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8401257991790771
Epoch: 11, Steps: 17 | Train Loss: 4.409 Vali Loss: 8.656 Vali Acc: 0.232 Test Loss: 8.656 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6938803195953369
Epoch: 12, Steps: 17 | Train Loss: 4.516 Vali Loss: 7.504 Vali Acc: 0.266 Test Loss: 7.504 Test Acc: 0.266
Validation loss decreased (-0.262272 --> -0.266085).  Saving model ...
Epoch: 13 cost time: 0.7402102947235107
Epoch: 13, Steps: 17 | Train Loss: 3.551 Vali Loss: 7.136 Vali Acc: 0.247 Test Loss: 7.136 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7788350582122803
Epoch: 14, Steps: 17 | Train Loss: 2.512 Vali Loss: 4.742 Vali Acc: 0.300 Test Loss: 4.742 Test Acc: 0.300
Validation loss decreased (-0.266085 --> -0.300333).  Saving model ...
Epoch: 15 cost time: 0.7840657234191895
Epoch: 15, Steps: 17 | Train Loss: 2.959 Vali Loss: 6.395 Vali Acc: 0.240 Test Loss: 6.395 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8357584476470947
Epoch: 16, Steps: 17 | Train Loss: 2.201 Vali Loss: 4.882 Vali Acc: 0.262 Test Loss: 4.882 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7631511688232422
Epoch: 17, Steps: 17 | Train Loss: 2.338 Vali Loss: 7.204 Vali Acc: 0.243 Test Loss: 7.204 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8332958221435547
Epoch: 18, Steps: 17 | Train Loss: 3.094 Vali Loss: 7.874 Vali Acc: 0.228 Test Loss: 7.874 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7529211044311523
Epoch: 19, Steps: 17 | Train Loss: 3.146 Vali Loss: 7.967 Vali Acc: 0.236 Test Loss: 7.967 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7009718418121338
Epoch: 20, Steps: 17 | Train Loss: 2.515 Vali Loss: 6.306 Vali Acc: 0.262 Test Loss: 6.306 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8404240608215332
Epoch: 21, Steps: 17 | Train Loss: 1.861 Vali Loss: 5.807 Vali Acc: 0.232 Test Loss: 5.807 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6642909049987793
Epoch: 22, Steps: 17 | Train Loss: 2.549 Vali Loss: 6.030 Vali Acc: 0.243 Test Loss: 6.030 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8407325744628906
Epoch: 23, Steps: 17 | Train Loss: 2.702 Vali Loss: 8.223 Vali Acc: 0.236 Test Loss: 8.223 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7511873245239258
Epoch: 24, Steps: 17 | Train Loss: 2.633 Vali Loss: 5.725 Vali Acc: 0.270 Test Loss: 5.725 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3145452
model size : 12.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.024096727371216
Epoch: 1, Steps: 17 | Train Loss: 2.967 Vali Loss: 3.684 Vali Acc: 0.274 Test Loss: 3.684 Test Acc: 0.274
Validation loss decreased (inf --> -0.273727).  Saving model ...
Epoch: 2 cost time: 0.6775999069213867
Epoch: 2, Steps: 17 | Train Loss: 3.558 Vali Loss: 5.433 Vali Acc: 0.289 Test Loss: 5.433 Test Acc: 0.289
Validation loss decreased (-0.273727 --> -0.288919).  Saving model ...
Epoch: 3 cost time: 0.7096531391143799
Epoch: 3, Steps: 17 | Train Loss: 4.237 Vali Loss: 5.972 Vali Acc: 0.259 Test Loss: 5.972 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8150017261505127
Epoch: 4, Steps: 17 | Train Loss: 5.622 Vali Loss: 6.419 Vali Acc: 0.259 Test Loss: 6.419 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7179100513458252
Epoch: 5, Steps: 17 | Train Loss: 5.965 Vali Loss: 7.601 Vali Acc: 0.247 Test Loss: 7.601 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7491848468780518
Epoch: 6, Steps: 17 | Train Loss: 5.178 Vali Loss: 8.459 Vali Acc: 0.266 Test Loss: 8.459 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7435142993927002
Epoch: 7, Steps: 17 | Train Loss: 6.520 Vali Loss: 13.121 Vali Acc: 0.243 Test Loss: 13.121 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.763991117477417
Epoch: 8, Steps: 17 | Train Loss: 6.484 Vali Loss: 14.938 Vali Acc: 0.251 Test Loss: 14.938 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9837400913238525
Epoch: 9, Steps: 17 | Train Loss: 11.533 Vali Loss: 17.509 Vali Acc: 0.251 Test Loss: 17.509 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7701902389526367
Epoch: 10, Steps: 17 | Train Loss: 9.215 Vali Loss: 12.066 Vali Acc: 0.259 Test Loss: 12.066 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7523820400238037
Epoch: 11, Steps: 17 | Train Loss: 4.415 Vali Loss: 5.415 Vali Acc: 0.270 Test Loss: 5.415 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7979795932769775
Epoch: 12, Steps: 17 | Train Loss: 2.502 Vali Loss: 7.457 Vali Acc: 0.243 Test Loss: 7.457 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3151613
model size : 12.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3306689262390137
Epoch: 1, Steps: 17 | Train Loss: 6.283 Vali Loss: 10.700 Vali Acc: 0.262 Test Loss: 10.700 Test Acc: 0.262
Validation loss decreased (inf --> -0.262250).  Saving model ...
Epoch: 2 cost time: 0.7560207843780518
Epoch: 2, Steps: 17 | Train Loss: 6.689 Vali Loss: 7.849 Vali Acc: 0.281 Test Loss: 7.849 Test Acc: 0.281
Validation loss decreased (-0.262250 --> -0.281290).  Saving model ...
Epoch: 3 cost time: 0.6908655166625977
Epoch: 3, Steps: 17 | Train Loss: 6.234 Vali Loss: 7.954 Vali Acc: 0.274 Test Loss: 7.954 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7177984714508057
Epoch: 4, Steps: 17 | Train Loss: 5.527 Vali Loss: 15.363 Vali Acc: 0.251 Test Loss: 15.363 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6950411796569824
Epoch: 5, Steps: 17 | Train Loss: 7.234 Vali Loss: 5.267 Vali Acc: 0.266 Test Loss: 5.267 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7386646270751953
Epoch: 6, Steps: 17 | Train Loss: 4.158 Vali Loss: 6.882 Vali Acc: 0.236 Test Loss: 6.882 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8298525810241699
Epoch: 7, Steps: 17 | Train Loss: 7.532 Vali Loss: 9.276 Vali Acc: 0.270 Test Loss: 9.276 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7806422710418701
Epoch: 8, Steps: 17 | Train Loss: 5.236 Vali Loss: 13.331 Vali Acc: 0.243 Test Loss: 13.331 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7584824562072754
Epoch: 9, Steps: 17 | Train Loss: 8.074 Vali Loss: 14.810 Vali Acc: 0.243 Test Loss: 14.810 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7929079532623291
Epoch: 10, Steps: 17 | Train Loss: 7.911 Vali Loss: 10.619 Vali Acc: 0.312 Test Loss: 10.619 Test Acc: 0.312
Validation loss decreased (-0.281290 --> -0.311681).  Saving model ...
Epoch: 11 cost time: 0.8742530345916748
Epoch: 11, Steps: 17 | Train Loss: 5.182 Vali Loss: 6.203 Vali Acc: 0.228 Test Loss: 6.203 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8246634006500244
Epoch: 12, Steps: 17 | Train Loss: 4.326 Vali Loss: 6.097 Vali Acc: 0.274 Test Loss: 6.097 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6343553066253662
Epoch: 13, Steps: 17 | Train Loss: 3.479 Vali Loss: 6.863 Vali Acc: 0.247 Test Loss: 6.863 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8319835662841797
Epoch: 14, Steps: 17 | Train Loss: 2.987 Vali Loss: 5.800 Vali Acc: 0.278 Test Loss: 5.800 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7807979583740234
Epoch: 15, Steps: 17 | Train Loss: 3.148 Vali Loss: 4.899 Vali Acc: 0.240 Test Loss: 4.899 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8805346488952637
Epoch: 16, Steps: 17 | Train Loss: 3.196 Vali Loss: 5.760 Vali Acc: 0.259 Test Loss: 5.760 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8779704570770264
Epoch: 17, Steps: 17 | Train Loss: 2.992 Vali Loss: 4.552 Vali Acc: 0.262 Test Loss: 4.552 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8507041931152344
Epoch: 18, Steps: 17 | Train Loss: 3.480 Vali Loss: 4.886 Vali Acc: 0.209 Test Loss: 4.886 Test Acc: 0.209
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7678735256195068
Epoch: 19, Steps: 17 | Train Loss: 2.262 Vali Loss: 7.237 Vali Acc: 0.262 Test Loss: 7.237 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8231627941131592
Epoch: 20, Steps: 17 | Train Loss: 2.542 Vali Loss: 5.358 Vali Acc: 0.262 Test Loss: 5.358 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 3140844
model size : 11.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.419083595275879
Epoch: 1, Steps: 17 | Train Loss: 4.027 Vali Loss: 5.727 Vali Acc: 0.281 Test Loss: 5.727 Test Acc: 0.281
Validation loss decreased (inf --> -0.281312).  Saving model ...
Epoch: 2 cost time: 0.8800742626190186
Epoch: 2, Steps: 17 | Train Loss: 4.183 Vali Loss: 8.614 Vali Acc: 0.266 Test Loss: 8.614 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8054044246673584
Epoch: 3, Steps: 17 | Train Loss: 5.960 Vali Loss: 8.309 Vali Acc: 0.251 Test Loss: 8.309 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7805323600769043
Epoch: 4, Steps: 17 | Train Loss: 9.273 Vali Loss: 13.280 Vali Acc: 0.243 Test Loss: 13.280 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7236967086791992
Epoch: 5, Steps: 17 | Train Loss: 7.338 Vali Loss: 14.652 Vali Acc: 0.274 Test Loss: 14.652 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8748226165771484
Epoch: 6, Steps: 17 | Train Loss: 7.519 Vali Loss: 7.482 Vali Acc: 0.255 Test Loss: 7.482 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.803809642791748
Epoch: 7, Steps: 17 | Train Loss: 4.316 Vali Loss: 9.479 Vali Acc: 0.213 Test Loss: 9.479 Test Acc: 0.213
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7242183685302734
Epoch: 8, Steps: 17 | Train Loss: 6.300 Vali Loss: 13.213 Vali Acc: 0.236 Test Loss: 13.213 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7524535655975342
Epoch: 9, Steps: 17 | Train Loss: 5.007 Vali Loss: 7.789 Vali Acc: 0.243 Test Loss: 7.789 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8158245086669922
Epoch: 10, Steps: 17 | Train Loss: 3.753 Vali Loss: 8.922 Vali Acc: 0.255 Test Loss: 8.922 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.732398271560669
Epoch: 11, Steps: 17 | Train Loss: 6.703 Vali Loss: 10.620 Vali Acc: 0.262 Test Loss: 10.620 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3144599
model size : 12.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1365528106689453
Epoch: 1, Steps: 17 | Train Loss: 5.828 Vali Loss: 6.102 Vali Acc: 0.236 Test Loss: 6.102 Test Acc: 0.236
Validation loss decreased (inf --> -0.235680).  Saving model ...
Epoch: 2 cost time: 0.833409309387207
Epoch: 2, Steps: 17 | Train Loss: 4.234 Vali Loss: 5.091 Vali Acc: 0.255 Test Loss: 5.091 Test Acc: 0.255
Validation loss decreased (-0.235680 --> -0.254702).  Saving model ...
Epoch: 3 cost time: 0.669884204864502
Epoch: 3, Steps: 17 | Train Loss: 5.029 Vali Loss: 7.298 Vali Acc: 0.262 Test Loss: 7.298 Test Acc: 0.262
Validation loss decreased (-0.254702 --> -0.262284).  Saving model ...
Epoch: 4 cost time: 0.689094066619873
Epoch: 4, Steps: 17 | Train Loss: 4.905 Vali Loss: 8.735 Vali Acc: 0.270 Test Loss: 8.735 Test Acc: 0.270
Validation loss decreased (-0.262284 --> -0.269875).  Saving model ...
Epoch: 5 cost time: 0.7184810638427734
Epoch: 5, Steps: 17 | Train Loss: 6.636 Vali Loss: 5.729 Vali Acc: 0.243 Test Loss: 5.729 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8191559314727783
Epoch: 6, Steps: 17 | Train Loss: 7.889 Vali Loss: 8.317 Vali Acc: 0.243 Test Loss: 8.317 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7484545707702637
Epoch: 7, Steps: 17 | Train Loss: 5.137 Vali Loss: 14.495 Vali Acc: 0.259 Test Loss: 14.495 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7990100383758545
Epoch: 8, Steps: 17 | Train Loss: 7.475 Vali Loss: 16.741 Vali Acc: 0.262 Test Loss: 16.741 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6474401950836182
Epoch: 9, Steps: 17 | Train Loss: 8.393 Vali Loss: 15.018 Vali Acc: 0.262 Test Loss: 15.018 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8911895751953125
Epoch: 10, Steps: 17 | Train Loss: 4.761 Vali Loss: 9.381 Vali Acc: 0.274 Test Loss: 9.381 Test Acc: 0.274
Validation loss decreased (-0.269875 --> -0.273670).  Saving model ...
Epoch: 11 cost time: 0.7589716911315918
Epoch: 11, Steps: 17 | Train Loss: 4.729 Vali Loss: 5.964 Vali Acc: 0.289 Test Loss: 5.964 Test Acc: 0.289
Validation loss decreased (-0.273670 --> -0.288914).  Saving model ...
Epoch: 12 cost time: 0.8641197681427002
Epoch: 12, Steps: 17 | Train Loss: 3.538 Vali Loss: 4.581 Vali Acc: 0.266 Test Loss: 4.581 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9159917831420898
Epoch: 13, Steps: 17 | Train Loss: 2.940 Vali Loss: 4.945 Vali Acc: 0.274 Test Loss: 4.945 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7531883716583252
Epoch: 14, Steps: 17 | Train Loss: 3.070 Vali Loss: 6.191 Vali Acc: 0.266 Test Loss: 6.191 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8693339824676514
Epoch: 15, Steps: 17 | Train Loss: 2.521 Vali Loss: 4.308 Vali Acc: 0.289 Test Loss: 4.308 Test Acc: 0.289
Validation loss decreased (-0.288914 --> -0.288930).  Saving model ...
Epoch: 16 cost time: 0.6973254680633545
Epoch: 16, Steps: 17 | Train Loss: 2.697 Vali Loss: 4.667 Vali Acc: 0.255 Test Loss: 4.667 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7852096557617188
Epoch: 17, Steps: 17 | Train Loss: 2.646 Vali Loss: 5.556 Vali Acc: 0.255 Test Loss: 5.556 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7733359336853027
Epoch: 18, Steps: 17 | Train Loss: 1.978 Vali Loss: 3.846 Vali Acc: 0.262 Test Loss: 3.846 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7106683254241943
Epoch: 19, Steps: 17 | Train Loss: 2.753 Vali Loss: 7.073 Vali Acc: 0.278 Test Loss: 7.073 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8183560371398926
Epoch: 20, Steps: 17 | Train Loss: 3.201 Vali Loss: 4.141 Vali Acc: 0.232 Test Loss: 4.141 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7496297359466553
Epoch: 21, Steps: 17 | Train Loss: 3.105 Vali Loss: 9.402 Vali Acc: 0.259 Test Loss: 9.402 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8572096824645996
Epoch: 22, Steps: 17 | Train Loss: 3.493 Vali Loss: 8.373 Vali Acc: 0.243 Test Loss: 8.373 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6744306087493896
Epoch: 23, Steps: 17 | Train Loss: 3.599 Vali Loss: 4.720 Vali Acc: 0.285 Test Loss: 4.720 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6748924255371094
Epoch: 24, Steps: 17 | Train Loss: 3.763 Vali Loss: 5.066 Vali Acc: 0.274 Test Loss: 5.066 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7754383087158203
Epoch: 25, Steps: 17 | Train Loss: 3.354 Vali Loss: 7.241 Vali Acc: 0.308 Test Loss: 7.241 Test Acc: 0.308
Validation loss decreased (-0.288930 --> -0.307912).  Saving model ...
Epoch: 26 cost time: 0.885016679763794
Epoch: 26, Steps: 17 | Train Loss: 3.586 Vali Loss: 9.162 Vali Acc: 0.274 Test Loss: 9.162 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7313976287841797
Epoch: 27, Steps: 17 | Train Loss: 2.503 Vali Loss: 5.543 Vali Acc: 0.228 Test Loss: 5.543 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7375190258026123
Epoch: 28, Steps: 17 | Train Loss: 3.219 Vali Loss: 5.446 Vali Acc: 0.266 Test Loss: 5.446 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6583402156829834
Epoch: 29, Steps: 17 | Train Loss: 2.653 Vali Loss: 6.595 Vali Acc: 0.262 Test Loss: 6.595 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7752656936645508
Epoch: 30, Steps: 17 | Train Loss: 3.204 Vali Loss: 5.926 Vali Acc: 0.274 Test Loss: 5.926 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6552338600158691
Epoch: 31, Steps: 17 | Train Loss: 2.461 Vali Loss: 8.237 Vali Acc: 0.285 Test Loss: 8.237 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7463281154632568
Epoch: 32, Steps: 17 | Train Loss: 3.194 Vali Loss: 6.331 Vali Acc: 0.247 Test Loss: 6.331 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7979946136474609
Epoch: 33, Steps: 17 | Train Loss: 3.420 Vali Loss: 7.324 Vali Acc: 0.274 Test Loss: 7.324 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7118031978607178
Epoch: 34, Steps: 17 | Train Loss: 3.423 Vali Loss: 8.360 Vali Acc: 0.278 Test Loss: 8.360 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7766165733337402
Epoch: 35, Steps: 17 | Train Loss: 3.378 Vali Loss: 9.347 Vali Acc: 0.255 Test Loss: 9.347 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 3152180
model size : 12.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.114307165145874
Epoch: 1, Steps: 17 | Train Loss: 5.084 Vali Loss: 5.067 Vali Acc: 0.251 Test Loss: 5.067 Test Acc: 0.251
Validation loss decreased (inf --> -0.250900).  Saving model ...
Epoch: 2 cost time: 0.6615619659423828
Epoch: 2, Steps: 17 | Train Loss: 4.149 Vali Loss: 7.644 Vali Acc: 0.266 Test Loss: 7.644 Test Acc: 0.266
Validation loss decreased (-0.250900 --> -0.266083).  Saving model ...
Epoch: 3 cost time: 0.7897555828094482
Epoch: 3, Steps: 17 | Train Loss: 5.025 Vali Loss: 6.066 Vali Acc: 0.217 Test Loss: 6.066 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7920188903808594
Epoch: 4, Steps: 17 | Train Loss: 6.250 Vali Loss: 9.433 Vali Acc: 0.228 Test Loss: 9.433 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7842082977294922
Epoch: 5, Steps: 17 | Train Loss: 5.634 Vali Loss: 8.377 Vali Acc: 0.262 Test Loss: 8.377 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7372779846191406
Epoch: 6, Steps: 17 | Train Loss: 8.076 Vali Loss: 11.623 Vali Acc: 0.247 Test Loss: 11.623 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7568764686584473
Epoch: 7, Steps: 17 | Train Loss: 7.308 Vali Loss: 11.226 Vali Acc: 0.243 Test Loss: 11.226 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6937949657440186
Epoch: 8, Steps: 17 | Train Loss: 4.831 Vali Loss: 11.398 Vali Acc: 0.274 Test Loss: 11.398 Test Acc: 0.274
Validation loss decreased (-0.266083 --> -0.273650).  Saving model ...
Epoch: 9 cost time: 0.6118965148925781
Epoch: 9, Steps: 17 | Train Loss: 7.288 Vali Loss: 9.859 Vali Acc: 0.255 Test Loss: 9.859 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7206130027770996
Epoch: 10, Steps: 17 | Train Loss: 7.081 Vali Loss: 11.783 Vali Acc: 0.240 Test Loss: 11.783 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6363434791564941
Epoch: 11, Steps: 17 | Train Loss: 4.927 Vali Loss: 12.558 Vali Acc: 0.255 Test Loss: 12.558 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6703498363494873
Epoch: 12, Steps: 17 | Train Loss: 4.447 Vali Loss: 5.586 Vali Acc: 0.262 Test Loss: 5.586 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6777403354644775
Epoch: 13, Steps: 17 | Train Loss: 2.794 Vali Loss: 4.944 Vali Acc: 0.251 Test Loss: 4.944 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6994409561157227
Epoch: 14, Steps: 17 | Train Loss: 4.473 Vali Loss: 4.088 Vali Acc: 0.240 Test Loss: 4.088 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6771886348724365
Epoch: 15, Steps: 17 | Train Loss: 2.388 Vali Loss: 4.354 Vali Acc: 0.251 Test Loss: 4.354 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7158069610595703
Epoch: 16, Steps: 17 | Train Loss: 3.220 Vali Loss: 4.737 Vali Acc: 0.240 Test Loss: 4.737 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7930917739868164
Epoch: 17, Steps: 17 | Train Loss: 1.839 Vali Loss: 4.534 Vali Acc: 0.300 Test Loss: 4.534 Test Acc: 0.300
Validation loss decreased (-0.273650 --> -0.300335).  Saving model ...
Epoch: 18 cost time: 0.725499153137207
Epoch: 18, Steps: 17 | Train Loss: 2.320 Vali Loss: 9.095 Vali Acc: 0.232 Test Loss: 9.095 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7325518131256104
Epoch: 19, Steps: 17 | Train Loss: 5.353 Vali Loss: 13.097 Vali Acc: 0.274 Test Loss: 13.097 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8453633785247803
Epoch: 20, Steps: 17 | Train Loss: 5.477 Vali Loss: 8.399 Vali Acc: 0.243 Test Loss: 8.399 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6535470485687256
Epoch: 21, Steps: 17 | Train Loss: 4.743 Vali Loss: 10.494 Vali Acc: 0.228 Test Loss: 10.494 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8124828338623047
Epoch: 22, Steps: 17 | Train Loss: 4.164 Vali Loss: 8.572 Vali Acc: 0.236 Test Loss: 8.572 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6873834133148193
Epoch: 23, Steps: 17 | Train Loss: 3.080 Vali Loss: 6.684 Vali Acc: 0.232 Test Loss: 6.684 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7585363388061523
Epoch: 24, Steps: 17 | Train Loss: 2.986 Vali Loss: 8.419 Vali Acc: 0.251 Test Loss: 8.419 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7082600593566895
Epoch: 25, Steps: 17 | Train Loss: 2.252 Vali Loss: 4.551 Vali Acc: 0.293 Test Loss: 4.551 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6599199771881104
Epoch: 26, Steps: 17 | Train Loss: 3.339 Vali Loss: 8.486 Vali Acc: 0.266 Test Loss: 8.486 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8246121406555176
Epoch: 27, Steps: 17 | Train Loss: 2.498 Vali Loss: 6.307 Vali Acc: 0.243 Test Loss: 6.307 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3151202
model size : 12.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9907996654510498
Epoch: 1, Steps: 17 | Train Loss: 3.556 Vali Loss: 4.054 Vali Acc: 0.266 Test Loss: 4.054 Test Acc: 0.266
Validation loss decreased (inf --> -0.266119).  Saving model ...
Epoch: 2 cost time: 0.7699205875396729
Epoch: 2, Steps: 17 | Train Loss: 4.335 Vali Loss: 7.514 Vali Acc: 0.251 Test Loss: 7.514 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7805294990539551
Epoch: 3, Steps: 17 | Train Loss: 4.714 Vali Loss: 4.630 Vali Acc: 0.266 Test Loss: 4.630 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7789337635040283
Epoch: 4, Steps: 17 | Train Loss: 6.996 Vali Loss: 10.235 Vali Acc: 0.247 Test Loss: 10.235 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7275352478027344
Epoch: 5, Steps: 17 | Train Loss: 10.407 Vali Loss: 11.354 Vali Acc: 0.251 Test Loss: 11.354 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8846104145050049
Epoch: 6, Steps: 17 | Train Loss: 6.212 Vali Loss: 9.891 Vali Acc: 0.289 Test Loss: 9.891 Test Acc: 0.289
Validation loss decreased (-0.266119 --> -0.288874).  Saving model ...
Epoch: 7 cost time: 0.7469613552093506
Epoch: 7, Steps: 17 | Train Loss: 5.829 Vali Loss: 11.096 Vali Acc: 0.255 Test Loss: 11.096 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9114174842834473
Epoch: 8, Steps: 17 | Train Loss: 10.260 Vali Loss: 8.001 Vali Acc: 0.247 Test Loss: 8.001 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7564852237701416
Epoch: 9, Steps: 17 | Train Loss: 4.194 Vali Loss: 8.226 Vali Acc: 0.281 Test Loss: 8.226 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8048079013824463
Epoch: 10, Steps: 17 | Train Loss: 4.820 Vali Loss: 9.382 Vali Acc: 0.255 Test Loss: 9.382 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7449226379394531
Epoch: 11, Steps: 17 | Train Loss: 3.351 Vali Loss: 5.425 Vali Acc: 0.236 Test Loss: 5.425 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6812880039215088
Epoch: 12, Steps: 17 | Train Loss: 4.588 Vali Loss: 5.288 Vali Acc: 0.274 Test Loss: 5.288 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6796786785125732
Epoch: 13, Steps: 17 | Train Loss: 3.174 Vali Loss: 6.780 Vali Acc: 0.224 Test Loss: 6.780 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6480543613433838
Epoch: 14, Steps: 17 | Train Loss: 1.869 Vali Loss: 6.845 Vali Acc: 0.251 Test Loss: 6.845 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7355096340179443
Epoch: 15, Steps: 17 | Train Loss: 3.331 Vali Loss: 6.785 Vali Acc: 0.270 Test Loss: 6.785 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7644760608673096
Epoch: 16, Steps: 17 | Train Loss: 3.320 Vali Loss: 5.931 Vali Acc: 0.243 Test Loss: 5.931 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3136348
model size : 11.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.005246162414551
Epoch: 1, Steps: 17 | Train Loss: 7.662 Vali Loss: 11.635 Vali Acc: 0.259 Test Loss: 11.635 Test Acc: 0.259
Validation loss decreased (inf --> -0.258439).  Saving model ...
Epoch: 2 cost time: 0.7523462772369385
Epoch: 2, Steps: 17 | Train Loss: 4.608 Vali Loss: 6.209 Vali Acc: 0.240 Test Loss: 6.209 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6607475280761719
Epoch: 3, Steps: 17 | Train Loss: 5.827 Vali Loss: 13.869 Vali Acc: 0.247 Test Loss: 13.869 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7831661701202393
Epoch: 4, Steps: 17 | Train Loss: 7.451 Vali Loss: 13.873 Vali Acc: 0.259 Test Loss: 13.873 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6578946113586426
Epoch: 5, Steps: 17 | Train Loss: 9.157 Vali Loss: 7.919 Vali Acc: 0.293 Test Loss: 7.919 Test Acc: 0.293
Validation loss decreased (-0.258439 --> -0.292696).  Saving model ...
Epoch: 6 cost time: 0.7574944496154785
Epoch: 6, Steps: 17 | Train Loss: 8.508 Vali Loss: 7.102 Vali Acc: 0.266 Test Loss: 7.102 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8596060276031494
Epoch: 7, Steps: 17 | Train Loss: 5.402 Vali Loss: 12.200 Vali Acc: 0.228 Test Loss: 12.200 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8545866012573242
Epoch: 8, Steps: 17 | Train Loss: 4.538 Vali Loss: 6.399 Vali Acc: 0.274 Test Loss: 6.399 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8920943737030029
Epoch: 9, Steps: 17 | Train Loss: 5.952 Vali Loss: 8.154 Vali Acc: 0.259 Test Loss: 8.154 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8623790740966797
Epoch: 10, Steps: 17 | Train Loss: 4.970 Vali Loss: 5.820 Vali Acc: 0.266 Test Loss: 5.820 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7548606395721436
Epoch: 11, Steps: 17 | Train Loss: 3.297 Vali Loss: 6.179 Vali Acc: 0.266 Test Loss: 6.179 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7623882293701172
Epoch: 12, Steps: 17 | Train Loss: 3.364 Vali Loss: 5.024 Vali Acc: 0.266 Test Loss: 5.024 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8211236000061035
Epoch: 13, Steps: 17 | Train Loss: 2.550 Vali Loss: 4.968 Vali Acc: 0.213 Test Loss: 4.968 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8631677627563477
Epoch: 14, Steps: 17 | Train Loss: 2.760 Vali Loss: 5.985 Vali Acc: 0.240 Test Loss: 5.985 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7571558952331543
Epoch: 15, Steps: 17 | Train Loss: 2.508 Vali Loss: 3.945 Vali Acc: 0.228 Test Loss: 3.945 Test Acc: 0.228
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3140951
model size : 11.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0535507202148438
Epoch: 1, Steps: 17 | Train Loss: 4.098 Vali Loss: 6.531 Vali Acc: 0.247 Test Loss: 6.531 Test Acc: 0.247
Validation loss decreased (inf --> -0.247083).  Saving model ...
Epoch: 2 cost time: 0.6573030948638916
Epoch: 2, Steps: 17 | Train Loss: 3.705 Vali Loss: 4.714 Vali Acc: 0.274 Test Loss: 4.714 Test Acc: 0.274
Validation loss decreased (-0.247083 --> -0.273717).  Saving model ...
Epoch: 3 cost time: 0.8594274520874023
Epoch: 3, Steps: 17 | Train Loss: 4.300 Vali Loss: 9.119 Vali Acc: 0.251 Test Loss: 9.119 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6940248012542725
Epoch: 4, Steps: 17 | Train Loss: 5.814 Vali Loss: 6.440 Vali Acc: 0.247 Test Loss: 6.440 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7282965183258057
Epoch: 5, Steps: 17 | Train Loss: 5.042 Vali Loss: 13.729 Vali Acc: 0.243 Test Loss: 13.729 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.6474361419677734
Epoch: 6, Steps: 17 | Train Loss: 5.887 Vali Loss: 10.883 Vali Acc: 0.247 Test Loss: 10.883 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7193968296051025
Epoch: 7, Steps: 17 | Train Loss: 6.586 Vali Loss: 14.555 Vali Acc: 0.236 Test Loss: 14.555 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.910818338394165
Epoch: 8, Steps: 17 | Train Loss: 8.538 Vali Loss: 20.806 Vali Acc: 0.251 Test Loss: 20.806 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8277897834777832
Epoch: 9, Steps: 17 | Train Loss: 7.930 Vali Loss: 10.711 Vali Acc: 0.247 Test Loss: 10.711 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9036462306976318
Epoch: 10, Steps: 17 | Train Loss: 8.369 Vali Loss: 13.261 Vali Acc: 0.247 Test Loss: 13.261 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.8867518901824951
Epoch: 11, Steps: 17 | Train Loss: 5.572 Vali Loss: 7.776 Vali Acc: 0.236 Test Loss: 7.776 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.7688748836517334
Epoch: 12, Steps: 17 | Train Loss: 3.051 Vali Loss: 5.498 Vali Acc: 0.251 Test Loss: 5.498 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3156192
model size : 12.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9198331832885742
Epoch: 1, Steps: 17 | Train Loss: 5.604 Vali Loss: 5.705 Vali Acc: 0.270 Test Loss: 5.705 Test Acc: 0.270
Validation loss decreased (inf --> -0.269905).  Saving model ...
Epoch: 2 cost time: 0.8553197383880615
Epoch: 2, Steps: 17 | Train Loss: 6.857 Vali Loss: 10.566 Vali Acc: 0.262 Test Loss: 10.566 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6454782485961914
Epoch: 3, Steps: 17 | Train Loss: 8.167 Vali Loss: 15.569 Vali Acc: 0.247 Test Loss: 15.569 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6863534450531006
Epoch: 4, Steps: 17 | Train Loss: 10.040 Vali Loss: 14.982 Vali Acc: 0.259 Test Loss: 14.982 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7434906959533691
Epoch: 5, Steps: 17 | Train Loss: 11.837 Vali Loss: 30.766 Vali Acc: 0.255 Test Loss: 30.766 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8718295097351074
Epoch: 6, Steps: 17 | Train Loss: 13.817 Vali Loss: 12.186 Vali Acc: 0.266 Test Loss: 12.186 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.792036771774292
Epoch: 7, Steps: 17 | Train Loss: 6.828 Vali Loss: 12.101 Vali Acc: 0.274 Test Loss: 12.101 Test Acc: 0.274
Validation loss decreased (-0.269905 --> -0.273643).  Saving model ...
Epoch: 8 cost time: 0.6913092136383057
Epoch: 8, Steps: 17 | Train Loss: 6.097 Vali Loss: 12.122 Vali Acc: 0.251 Test Loss: 12.122 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7712647914886475
Epoch: 9, Steps: 17 | Train Loss: 5.816 Vali Loss: 6.061 Vali Acc: 0.236 Test Loss: 6.061 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7492015361785889
Epoch: 10, Steps: 17 | Train Loss: 3.950 Vali Loss: 6.264 Vali Acc: 0.247 Test Loss: 6.264 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7833371162414551
Epoch: 11, Steps: 17 | Train Loss: 3.992 Vali Loss: 6.255 Vali Acc: 0.259 Test Loss: 6.255 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7577106952667236
Epoch: 12, Steps: 17 | Train Loss: 3.416 Vali Loss: 7.297 Vali Acc: 0.247 Test Loss: 7.297 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.770282506942749
Epoch: 13, Steps: 17 | Train Loss: 2.316 Vali Loss: 4.626 Vali Acc: 0.251 Test Loss: 4.626 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7065074443817139
Epoch: 14, Steps: 17 | Train Loss: 2.494 Vali Loss: 5.107 Vali Acc: 0.213 Test Loss: 5.107 Test Acc: 0.213
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7525432109832764
Epoch: 15, Steps: 17 | Train Loss: 2.707 Vali Loss: 6.299 Vali Acc: 0.251 Test Loss: 6.299 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7697899341583252
Epoch: 16, Steps: 17 | Train Loss: 2.365 Vali Loss: 6.469 Vali Acc: 0.228 Test Loss: 6.469 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6673829555511475
Epoch: 17, Steps: 17 | Train Loss: 4.203 Vali Loss: 6.889 Vali Acc: 0.232 Test Loss: 6.889 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3139919
model size : 11.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.087563991546631
Epoch: 1, Steps: 17 | Train Loss: 4.263 Vali Loss: 5.938 Vali Acc: 0.266 Test Loss: 5.938 Test Acc: 0.266
Validation loss decreased (inf --> -0.266100).  Saving model ...
Epoch: 2 cost time: 0.8720123767852783
Epoch: 2, Steps: 17 | Train Loss: 4.079 Vali Loss: 9.431 Vali Acc: 0.259 Test Loss: 9.431 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7638111114501953
Epoch: 3, Steps: 17 | Train Loss: 6.953 Vali Loss: 7.100 Vali Acc: 0.274 Test Loss: 7.100 Test Acc: 0.274
Validation loss decreased (-0.266100 --> -0.273693).  Saving model ...
Epoch: 4 cost time: 0.7171826362609863
Epoch: 4, Steps: 17 | Train Loss: 5.482 Vali Loss: 12.004 Vali Acc: 0.251 Test Loss: 12.004 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6873383522033691
Epoch: 5, Steps: 17 | Train Loss: 5.068 Vali Loss: 11.283 Vali Acc: 0.285 Test Loss: 11.283 Test Acc: 0.285
Validation loss decreased (-0.273693 --> -0.285058).  Saving model ...
Epoch: 6 cost time: 0.7429862022399902
Epoch: 6, Steps: 17 | Train Loss: 6.713 Vali Loss: 6.851 Vali Acc: 0.278 Test Loss: 6.851 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6734991073608398
Epoch: 7, Steps: 17 | Train Loss: 6.566 Vali Loss: 9.510 Vali Acc: 0.236 Test Loss: 9.510 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9033923149108887
Epoch: 8, Steps: 17 | Train Loss: 4.905 Vali Loss: 14.047 Vali Acc: 0.293 Test Loss: 14.047 Test Acc: 0.293
Validation loss decreased (-0.285058 --> -0.292635).  Saving model ...
Epoch: 9 cost time: 0.8065071105957031
Epoch: 9, Steps: 17 | Train Loss: 5.762 Vali Loss: 9.666 Vali Acc: 0.270 Test Loss: 9.666 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7385246753692627
Epoch: 10, Steps: 17 | Train Loss: 6.364 Vali Loss: 12.221 Vali Acc: 0.289 Test Loss: 12.221 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8157975673675537
Epoch: 11, Steps: 17 | Train Loss: 5.835 Vali Loss: 7.870 Vali Acc: 0.266 Test Loss: 7.870 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8209431171417236
Epoch: 12, Steps: 17 | Train Loss: 4.301 Vali Loss: 9.510 Vali Acc: 0.236 Test Loss: 9.510 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7506303787231445
Epoch: 13, Steps: 17 | Train Loss: 2.847 Vali Loss: 4.739 Vali Acc: 0.270 Test Loss: 4.739 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6607711315155029
Epoch: 14, Steps: 17 | Train Loss: 3.263 Vali Loss: 7.767 Vali Acc: 0.259 Test Loss: 7.767 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.8977241516113281
Epoch: 15, Steps: 17 | Train Loss: 3.442 Vali Loss: 6.357 Vali Acc: 0.247 Test Loss: 6.357 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8067715167999268
Epoch: 16, Steps: 17 | Train Loss: 2.631 Vali Loss: 5.613 Vali Acc: 0.259 Test Loss: 5.613 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.848524808883667
Epoch: 17, Steps: 17 | Train Loss: 3.424 Vali Loss: 7.494 Vali Acc: 0.247 Test Loss: 7.494 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6777088642120361
Epoch: 18, Steps: 17 | Train Loss: 2.756 Vali Loss: 5.788 Vali Acc: 0.232 Test Loss: 5.788 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3148292
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0348541736602783
Epoch: 1, Steps: 17 | Train Loss: 4.282 Vali Loss: 7.974 Vali Acc: 0.247 Test Loss: 7.974 Test Acc: 0.247
Validation loss decreased (inf --> -0.247069).  Saving model ...
Epoch: 2 cost time: 0.563817024230957
Epoch: 2, Steps: 17 | Train Loss: 5.037 Vali Loss: 4.183 Vali Acc: 0.281 Test Loss: 4.183 Test Acc: 0.281
Validation loss decreased (-0.247069 --> -0.281327).  Saving model ...
Epoch: 3 cost time: 0.685511589050293
Epoch: 3, Steps: 17 | Train Loss: 5.218 Vali Loss: 10.534 Vali Acc: 0.247 Test Loss: 10.534 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6299920082092285
Epoch: 4, Steps: 17 | Train Loss: 7.129 Vali Loss: 7.838 Vali Acc: 0.255 Test Loss: 7.838 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8167932033538818
Epoch: 5, Steps: 17 | Train Loss: 6.497 Vali Loss: 10.023 Vali Acc: 0.266 Test Loss: 10.023 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8236055374145508
Epoch: 6, Steps: 17 | Train Loss: 6.951 Vali Loss: 11.320 Vali Acc: 0.278 Test Loss: 11.320 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7526895999908447
Epoch: 7, Steps: 17 | Train Loss: 4.542 Vali Loss: 14.441 Vali Acc: 0.232 Test Loss: 14.441 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7676210403442383
Epoch: 8, Steps: 17 | Train Loss: 8.109 Vali Loss: 11.494 Vali Acc: 0.266 Test Loss: 11.494 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7875645160675049
Epoch: 9, Steps: 17 | Train Loss: 5.235 Vali Loss: 11.440 Vali Acc: 0.266 Test Loss: 11.440 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7395458221435547
Epoch: 10, Steps: 17 | Train Loss: 5.933 Vali Loss: 11.525 Vali Acc: 0.251 Test Loss: 11.525 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6975445747375488
Epoch: 11, Steps: 17 | Train Loss: 5.784 Vali Loss: 7.569 Vali Acc: 0.228 Test Loss: 7.569 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9289712905883789
Epoch: 12, Steps: 17 | Train Loss: 3.474 Vali Loss: 4.456 Vali Acc: 0.251 Test Loss: 4.456 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3132155
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.266657829284668
Epoch: 1, Steps: 17 | Train Loss: 3.221 Vali Loss: 3.986 Vali Acc: 0.243 Test Loss: 3.986 Test Acc: 0.243
Validation loss decreased (inf --> -0.243306).  Saving model ...
Epoch: 2 cost time: 0.6305160522460938
Epoch: 2, Steps: 17 | Train Loss: 3.848 Vali Loss: 6.216 Vali Acc: 0.262 Test Loss: 6.216 Test Acc: 0.262
Validation loss decreased (-0.243306 --> -0.262295).  Saving model ...
Epoch: 3 cost time: 0.8473649024963379
Epoch: 3, Steps: 17 | Train Loss: 6.683 Vali Loss: 10.200 Vali Acc: 0.270 Test Loss: 10.200 Test Acc: 0.270
Validation loss decreased (-0.262295 --> -0.269860).  Saving model ...
Epoch: 4 cost time: 0.6414816379547119
Epoch: 4, Steps: 17 | Train Loss: 7.172 Vali Loss: 9.362 Vali Acc: 0.236 Test Loss: 9.362 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.939528226852417
Epoch: 5, Steps: 17 | Train Loss: 9.316 Vali Loss: 11.596 Vali Acc: 0.266 Test Loss: 11.596 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.836669921875
Epoch: 6, Steps: 17 | Train Loss: 10.852 Vali Loss: 14.607 Vali Acc: 0.251 Test Loss: 14.607 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7987887859344482
Epoch: 7, Steps: 17 | Train Loss: 7.017 Vali Loss: 10.587 Vali Acc: 0.251 Test Loss: 10.587 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8715357780456543
Epoch: 8, Steps: 17 | Train Loss: 6.822 Vali Loss: 11.651 Vali Acc: 0.240 Test Loss: 11.651 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7574973106384277
Epoch: 9, Steps: 17 | Train Loss: 6.083 Vali Loss: 8.201 Vali Acc: 0.236 Test Loss: 8.201 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7701327800750732
Epoch: 10, Steps: 17 | Train Loss: 3.789 Vali Loss: 7.377 Vali Acc: 0.259 Test Loss: 7.377 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6519134044647217
Epoch: 11, Steps: 17 | Train Loss: 2.953 Vali Loss: 5.129 Vali Acc: 0.262 Test Loss: 5.129 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7574915885925293
Epoch: 12, Steps: 17 | Train Loss: 3.362 Vali Loss: 9.880 Vali Acc: 0.251 Test Loss: 9.880 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6730408668518066
Epoch: 13, Steps: 17 | Train Loss: 4.502 Vali Loss: 9.123 Vali Acc: 0.255 Test Loss: 9.123 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3154672
model size : 12.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.081782341003418
Epoch: 1, Steps: 17 | Train Loss: 3.881 Vali Loss: 6.432 Vali Acc: 0.240 Test Loss: 6.432 Test Acc: 0.240
Validation loss decreased (inf --> -0.239479).  Saving model ...
Epoch: 2 cost time: 0.7067182064056396
Epoch: 2, Steps: 17 | Train Loss: 6.140 Vali Loss: 5.616 Vali Acc: 0.270 Test Loss: 5.616 Test Acc: 0.270
Validation loss decreased (-0.239479 --> -0.269906).  Saving model ...
Epoch: 3 cost time: 0.6804864406585693
Epoch: 3, Steps: 17 | Train Loss: 4.581 Vali Loss: 9.475 Vali Acc: 0.251 Test Loss: 9.475 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7086942195892334
Epoch: 4, Steps: 17 | Train Loss: 5.542 Vali Loss: 6.120 Vali Acc: 0.259 Test Loss: 6.120 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6716930866241455
Epoch: 5, Steps: 17 | Train Loss: 8.062 Vali Loss: 16.945 Vali Acc: 0.281 Test Loss: 16.945 Test Acc: 0.281
Validation loss decreased (-0.269906 --> -0.281199).  Saving model ...
Epoch: 6 cost time: 0.6662452220916748
Epoch: 6, Steps: 17 | Train Loss: 10.074 Vali Loss: 5.978 Vali Acc: 0.285 Test Loss: 5.978 Test Acc: 0.285
Validation loss decreased (-0.281199 --> -0.285111).  Saving model ...
Epoch: 7 cost time: 0.8432812690734863
Epoch: 7, Steps: 17 | Train Loss: 4.383 Vali Loss: 8.719 Vali Acc: 0.236 Test Loss: 8.719 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6119644641876221
Epoch: 8, Steps: 17 | Train Loss: 5.706 Vali Loss: 11.862 Vali Acc: 0.243 Test Loss: 11.862 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.730097770690918
Epoch: 9, Steps: 17 | Train Loss: 7.872 Vali Loss: 13.416 Vali Acc: 0.209 Test Loss: 13.416 Test Acc: 0.209
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.6037805080413818
Epoch: 10, Steps: 17 | Train Loss: 3.818 Vali Loss: 5.730 Vali Acc: 0.236 Test Loss: 5.730 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6870253086090088
Epoch: 11, Steps: 17 | Train Loss: 3.204 Vali Loss: 5.766 Vali Acc: 0.262 Test Loss: 5.766 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5529656410217285
Epoch: 12, Steps: 17 | Train Loss: 3.242 Vali Loss: 6.812 Vali Acc: 0.278 Test Loss: 6.812 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7351951599121094
Epoch: 13, Steps: 17 | Train Loss: 4.297 Vali Loss: 8.577 Vali Acc: 0.281 Test Loss: 8.577 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7406110763549805
Epoch: 14, Steps: 17 | Train Loss: 3.127 Vali Loss: 5.540 Vali Acc: 0.213 Test Loss: 5.540 Test Acc: 0.213
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7508547306060791
Epoch: 15, Steps: 17 | Train Loss: 2.438 Vali Loss: 5.469 Vali Acc: 0.266 Test Loss: 5.469 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6171407699584961
Epoch: 16, Steps: 17 | Train Loss: 3.204 Vali Loss: 10.105 Vali Acc: 0.240 Test Loss: 10.105 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3159683
model size : 12.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2680466175079346
Epoch: 1, Steps: 17 | Train Loss: 3.798 Vali Loss: 5.642 Vali Acc: 0.259 Test Loss: 5.642 Test Acc: 0.259
Validation loss decreased (inf --> -0.258499).  Saving model ...
Epoch: 2 cost time: 1.0259156227111816
Epoch: 2, Steps: 17 | Train Loss: 5.518 Vali Loss: 4.718 Vali Acc: 0.281 Test Loss: 4.718 Test Acc: 0.281
Validation loss decreased (-0.258499 --> -0.281322).  Saving model ...
Epoch: 3 cost time: 0.8568658828735352
Epoch: 3, Steps: 17 | Train Loss: 3.506 Vali Loss: 8.377 Vali Acc: 0.247 Test Loss: 8.377 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.790919303894043
Epoch: 4, Steps: 17 | Train Loss: 6.404 Vali Loss: 9.330 Vali Acc: 0.270 Test Loss: 9.330 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.82539963722229
Epoch: 5, Steps: 17 | Train Loss: 8.504 Vali Loss: 24.331 Vali Acc: 0.251 Test Loss: 24.331 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8170549869537354
Epoch: 6, Steps: 17 | Train Loss: 10.048 Vali Loss: 14.025 Vali Acc: 0.259 Test Loss: 14.025 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7883610725402832
Epoch: 7, Steps: 17 | Train Loss: 6.833 Vali Loss: 9.384 Vali Acc: 0.274 Test Loss: 9.384 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6819746494293213
Epoch: 8, Steps: 17 | Train Loss: 6.018 Vali Loss: 8.116 Vali Acc: 0.251 Test Loss: 8.116 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9573376178741455
Epoch: 9, Steps: 17 | Train Loss: 6.410 Vali Loss: 6.178 Vali Acc: 0.285 Test Loss: 6.178 Test Acc: 0.285
Validation loss decreased (-0.281322 --> -0.285109).  Saving model ...
Epoch: 10 cost time: 0.8888647556304932
Epoch: 10, Steps: 17 | Train Loss: 3.298 Vali Loss: 8.160 Vali Acc: 0.236 Test Loss: 8.160 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9528677463531494
Epoch: 11, Steps: 17 | Train Loss: 3.450 Vali Loss: 9.990 Vali Acc: 0.262 Test Loss: 9.990 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8886723518371582
Epoch: 12, Steps: 17 | Train Loss: 5.083 Vali Loss: 7.338 Vali Acc: 0.285 Test Loss: 7.338 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7417905330657959
Epoch: 13, Steps: 17 | Train Loss: 3.461 Vali Loss: 5.245 Vali Acc: 0.270 Test Loss: 5.245 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8674132823944092
Epoch: 14, Steps: 17 | Train Loss: 3.070 Vali Loss: 6.994 Vali Acc: 0.251 Test Loss: 6.994 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7908658981323242
Epoch: 15, Steps: 17 | Train Loss: 2.438 Vali Loss: 4.932 Vali Acc: 0.259 Test Loss: 4.932 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0249600410461426
Epoch: 16, Steps: 17 | Train Loss: 3.067 Vali Loss: 5.392 Vali Acc: 0.243 Test Loss: 5.392 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8038363456726074
Epoch: 17, Steps: 17 | Train Loss: 2.542 Vali Loss: 10.587 Vali Acc: 0.224 Test Loss: 10.587 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8006002902984619
Epoch: 18, Steps: 17 | Train Loss: 2.855 Vali Loss: 5.409 Vali Acc: 0.221 Test Loss: 5.409 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8469464778900146
Epoch: 19, Steps: 17 | Train Loss: 1.951 Vali Loss: 5.037 Vali Acc: 0.240 Test Loss: 5.037 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3147188
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9755711555480957
Epoch: 1, Steps: 17 | Train Loss: 4.772 Vali Loss: 7.794 Vali Acc: 0.259 Test Loss: 7.794 Test Acc: 0.259
Validation loss decreased (inf --> -0.258477).  Saving model ...
Epoch: 2 cost time: 0.9207489490509033
Epoch: 2, Steps: 17 | Train Loss: 7.767 Vali Loss: 5.827 Vali Acc: 0.266 Test Loss: 5.827 Test Acc: 0.266
Validation loss decreased (-0.258477 --> -0.266101).  Saving model ...
Epoch: 3 cost time: 0.9097819328308105
Epoch: 3, Steps: 17 | Train Loss: 6.807 Vali Loss: 8.202 Vali Acc: 0.266 Test Loss: 8.202 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8404080867767334
Epoch: 4, Steps: 17 | Train Loss: 4.910 Vali Loss: 6.222 Vali Acc: 0.247 Test Loss: 6.222 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7066032886505127
Epoch: 5, Steps: 17 | Train Loss: 4.568 Vali Loss: 10.295 Vali Acc: 0.281 Test Loss: 10.295 Test Acc: 0.281
Validation loss decreased (-0.266101 --> -0.281266).  Saving model ...
Epoch: 6 cost time: 0.8562076091766357
Epoch: 6, Steps: 17 | Train Loss: 6.114 Vali Loss: 8.720 Vali Acc: 0.278 Test Loss: 8.720 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7302732467651367
Epoch: 7, Steps: 17 | Train Loss: 6.070 Vali Loss: 13.591 Vali Acc: 0.266 Test Loss: 13.591 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6776974201202393
Epoch: 8, Steps: 17 | Train Loss: 7.791 Vali Loss: 11.988 Vali Acc: 0.274 Test Loss: 11.988 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7713091373443604
Epoch: 9, Steps: 17 | Train Loss: 6.923 Vali Loss: 8.772 Vali Acc: 0.247 Test Loss: 8.772 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7620260715484619
Epoch: 10, Steps: 17 | Train Loss: 5.655 Vali Loss: 8.062 Vali Acc: 0.251 Test Loss: 8.062 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7525491714477539
Epoch: 11, Steps: 17 | Train Loss: 5.565 Vali Loss: 6.801 Vali Acc: 0.247 Test Loss: 6.801 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8268976211547852
Epoch: 12, Steps: 17 | Train Loss: 3.908 Vali Loss: 7.348 Vali Acc: 0.262 Test Loss: 7.348 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7085459232330322
Epoch: 13, Steps: 17 | Train Loss: 4.236 Vali Loss: 6.302 Vali Acc: 0.270 Test Loss: 6.302 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8704209327697754
Epoch: 14, Steps: 17 | Train Loss: 2.780 Vali Loss: 4.726 Vali Acc: 0.259 Test Loss: 4.726 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7283833026885986
Epoch: 15, Steps: 17 | Train Loss: 2.769 Vali Loss: 5.928 Vali Acc: 0.247 Test Loss: 5.928 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm128_cs84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3154022
model size : 12.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.137866973876953
Epoch: 1, Steps: 17 | Train Loss: 7.889 Vali Loss: 8.189 Vali Acc: 0.262 Test Loss: 8.189 Test Acc: 0.262
Validation loss decreased (inf --> -0.262276).  Saving model ...
Epoch: 2 cost time: 0.8392395973205566
Epoch: 2, Steps: 17 | Train Loss: 8.094 Vali Loss: 8.494 Vali Acc: 0.259 Test Loss: 8.494 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6852185726165771
Epoch: 3, Steps: 17 | Train Loss: 5.516 Vali Loss: 7.901 Vali Acc: 0.281 Test Loss: 7.901 Test Acc: 0.281
Validation loss decreased (-0.262276 --> -0.281290).  Saving model ...
Epoch: 4 cost time: 0.9038276672363281
Epoch: 4, Steps: 17 | Train Loss: 7.856 Vali Loss: 6.232 Vali Acc: 0.255 Test Loss: 6.232 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8114795684814453
Epoch: 5, Steps: 17 | Train Loss: 6.964 Vali Loss: 10.974 Vali Acc: 0.228 Test Loss: 10.974 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7407188415527344
Epoch: 6, Steps: 17 | Train Loss: 7.804 Vali Loss: 11.758 Vali Acc: 0.255 Test Loss: 11.758 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8292243480682373
Epoch: 7, Steps: 17 | Train Loss: 6.056 Vali Loss: 17.023 Vali Acc: 0.247 Test Loss: 17.023 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8470797538757324
Epoch: 8, Steps: 17 | Train Loss: 4.825 Vali Loss: 7.736 Vali Acc: 0.274 Test Loss: 7.736 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8086583614349365
Epoch: 9, Steps: 17 | Train Loss: 3.826 Vali Loss: 8.058 Vali Acc: 0.228 Test Loss: 8.058 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7211222648620605
Epoch: 10, Steps: 17 | Train Loss: 3.828 Vali Loss: 8.642 Vali Acc: 0.251 Test Loss: 8.642 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8513600826263428
Epoch: 11, Steps: 17 | Train Loss: 5.120 Vali Loss: 8.648 Vali Acc: 0.232 Test Loss: 8.648 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7732107639312744
Epoch: 12, Steps: 17 | Train Loss: 3.331 Vali Loss: 9.023 Vali Acc: 0.274 Test Loss: 9.023 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7870619297027588
Epoch: 13, Steps: 17 | Train Loss: 3.457 Vali Loss: 5.486 Vali Acc: 0.255 Test Loss: 5.486 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3135988
model size : 11.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs584_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0830979347229004
Epoch: 1, Steps: 17 | Train Loss: 4.594 Vali Loss: 3.957 Vali Acc: 0.259 Test Loss: 3.957 Test Acc: 0.259
Validation loss decreased (inf --> -0.258516).  Saving model ...
Epoch: 2 cost time: 0.7713603973388672
Epoch: 2, Steps: 17 | Train Loss: 4.913 Vali Loss: 7.517 Vali Acc: 0.232 Test Loss: 7.517 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7114460468292236
Epoch: 3, Steps: 17 | Train Loss: 4.646 Vali Loss: 8.883 Vali Acc: 0.217 Test Loss: 8.883 Test Acc: 0.217
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.79986572265625
Epoch: 4, Steps: 17 | Train Loss: 5.653 Vali Loss: 4.585 Vali Acc: 0.255 Test Loss: 4.585 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7856392860412598
Epoch: 5, Steps: 17 | Train Loss: 6.457 Vali Loss: 8.358 Vali Acc: 0.266 Test Loss: 8.358 Test Acc: 0.266
Validation loss decreased (-0.258516 --> -0.266076).  Saving model ...
Epoch: 6 cost time: 0.7757163047790527
Epoch: 6, Steps: 17 | Train Loss: 9.293 Vali Loss: 14.288 Vali Acc: 0.240 Test Loss: 14.288 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8783013820648193
Epoch: 7, Steps: 17 | Train Loss: 8.430 Vali Loss: 9.967 Vali Acc: 0.247 Test Loss: 9.967 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7723653316497803
Epoch: 8, Steps: 17 | Train Loss: 6.316 Vali Loss: 12.994 Vali Acc: 0.255 Test Loss: 12.994 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7079758644104004
Epoch: 9, Steps: 17 | Train Loss: 10.293 Vali Loss: 13.226 Vali Acc: 0.259 Test Loss: 13.226 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.786480188369751
Epoch: 10, Steps: 17 | Train Loss: 5.006 Vali Loss: 8.810 Vali Acc: 0.266 Test Loss: 8.810 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7722272872924805
Epoch: 11, Steps: 17 | Train Loss: 4.467 Vali Loss: 6.631 Vali Acc: 0.236 Test Loss: 6.631 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6743016242980957
Epoch: 12, Steps: 17 | Train Loss: 5.777 Vali Loss: 7.622 Vali Acc: 0.262 Test Loss: 7.622 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.708503246307373
Epoch: 13, Steps: 17 | Train Loss: 3.610 Vali Loss: 5.940 Vali Acc: 0.285 Test Loss: 5.940 Test Acc: 0.285
Validation loss decreased (-0.266076 --> -0.285112).  Saving model ...
Epoch: 14 cost time: 0.6715939044952393
Epoch: 14, Steps: 17 | Train Loss: 3.132 Vali Loss: 4.999 Vali Acc: 0.255 Test Loss: 4.999 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8438682556152344
Epoch: 15, Steps: 17 | Train Loss: 2.326 Vali Loss: 4.346 Vali Acc: 0.262 Test Loss: 4.346 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6701316833496094
Epoch: 16, Steps: 17 | Train Loss: 2.185 Vali Loss: 4.817 Vali Acc: 0.255 Test Loss: 4.817 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7807817459106445
Epoch: 17, Steps: 17 | Train Loss: 3.079 Vali Loss: 5.539 Vali Acc: 0.297 Test Loss: 5.539 Test Acc: 0.297
Validation loss decreased (-0.285112 --> -0.296523).  Saving model ...
Epoch: 18 cost time: 0.7532668113708496
Epoch: 18, Steps: 17 | Train Loss: 2.757 Vali Loss: 5.174 Vali Acc: 0.247 Test Loss: 5.174 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.765204668045044
Epoch: 19, Steps: 17 | Train Loss: 2.509 Vali Loss: 5.957 Vali Acc: 0.259 Test Loss: 5.957 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8089029788970947
Epoch: 20, Steps: 17 | Train Loss: 1.965 Vali Loss: 7.681 Vali Acc: 0.236 Test Loss: 7.681 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7229318618774414
Epoch: 21, Steps: 17 | Train Loss: 3.381 Vali Loss: 8.329 Vali Acc: 0.251 Test Loss: 8.329 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.737748384475708
Epoch: 22, Steps: 17 | Train Loss: 4.608 Vali Loss: 6.122 Vali Acc: 0.247 Test Loss: 6.122 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.838986873626709
Epoch: 23, Steps: 17 | Train Loss: 3.342 Vali Loss: 7.722 Vali Acc: 0.236 Test Loss: 7.722 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.78000807762146
Epoch: 24, Steps: 17 | Train Loss: 3.263 Vali Loss: 6.569 Vali Acc: 0.285 Test Loss: 6.569 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7637052536010742
Epoch: 25, Steps: 17 | Train Loss: 4.296 Vali Loss: 18.766 Vali Acc: 0.247 Test Loss: 18.766 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7437324523925781
Epoch: 26, Steps: 17 | Train Loss: 3.616 Vali Loss: 5.220 Vali Acc: 0.274 Test Loss: 5.220 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8347272872924805
Epoch: 27, Steps: 17 | Train Loss: 2.779 Vali Loss: 4.742 Vali Acc: 0.274 Test Loss: 4.742 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs584_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3126658
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs438_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.258840560913086
Epoch: 1, Steps: 17 | Train Loss: 3.736 Vali Loss: 7.069 Vali Acc: 0.251 Test Loss: 7.069 Test Acc: 0.251
Validation loss decreased (inf --> -0.250880).  Saving model ...
Epoch: 2 cost time: 0.7585151195526123
Epoch: 2, Steps: 17 | Train Loss: 6.261 Vali Loss: 12.762 Vali Acc: 0.243 Test Loss: 12.762 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.94549560546875
Epoch: 3, Steps: 17 | Train Loss: 7.366 Vali Loss: 7.812 Vali Acc: 0.270 Test Loss: 7.812 Test Acc: 0.270
Validation loss decreased (-0.250880 --> -0.269884).  Saving model ...
Epoch: 4 cost time: 0.7889389991760254
Epoch: 4, Steps: 17 | Train Loss: 6.399 Vali Loss: 4.986 Vali Acc: 0.266 Test Loss: 4.986 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9037375450134277
Epoch: 5, Steps: 17 | Train Loss: 7.856 Vali Loss: 11.513 Vali Acc: 0.259 Test Loss: 11.513 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7825767993927002
Epoch: 6, Steps: 17 | Train Loss: 8.486 Vali Loss: 11.010 Vali Acc: 0.285 Test Loss: 11.010 Test Acc: 0.285
Validation loss decreased (-0.269884 --> -0.285061).  Saving model ...
Epoch: 7 cost time: 0.732433557510376
Epoch: 7, Steps: 17 | Train Loss: 8.909 Vali Loss: 5.564 Vali Acc: 0.255 Test Loss: 5.564 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7594492435455322
Epoch: 8, Steps: 17 | Train Loss: 4.637 Vali Loss: 8.842 Vali Acc: 0.262 Test Loss: 8.842 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7701969146728516
Epoch: 9, Steps: 17 | Train Loss: 5.640 Vali Loss: 16.318 Vali Acc: 0.274 Test Loss: 16.318 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7667140960693359
Epoch: 10, Steps: 17 | Train Loss: 7.129 Vali Loss: 7.558 Vali Acc: 0.240 Test Loss: 7.558 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7114174365997314
Epoch: 11, Steps: 17 | Train Loss: 3.108 Vali Loss: 6.296 Vali Acc: 0.266 Test Loss: 6.296 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7335398197174072
Epoch: 12, Steps: 17 | Train Loss: 2.698 Vali Loss: 6.693 Vali Acc: 0.270 Test Loss: 6.693 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6419472694396973
Epoch: 13, Steps: 17 | Train Loss: 2.514 Vali Loss: 5.430 Vali Acc: 0.270 Test Loss: 5.430 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7455861568450928
Epoch: 14, Steps: 17 | Train Loss: 2.896 Vali Loss: 5.173 Vali Acc: 0.232 Test Loss: 5.173 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7242581844329834
Epoch: 15, Steps: 17 | Train Loss: 3.064 Vali Loss: 6.394 Vali Acc: 0.270 Test Loss: 6.394 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8394036293029785
Epoch: 16, Steps: 17 | Train Loss: 2.289 Vali Loss: 3.730 Vali Acc: 0.247 Test Loss: 3.730 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs438_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3122004
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1787214279174805
Epoch: 1, Steps: 17 | Train Loss: 4.265 Vali Loss: 6.616 Vali Acc: 0.266 Test Loss: 6.616 Test Acc: 0.266
Validation loss decreased (inf --> -0.266094).  Saving model ...
Epoch: 2 cost time: 0.6829807758331299
Epoch: 2, Steps: 17 | Train Loss: 5.822 Vali Loss: 8.475 Vali Acc: 0.259 Test Loss: 8.475 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.869006872177124
Epoch: 3, Steps: 17 | Train Loss: 7.553 Vali Loss: 12.692 Vali Acc: 0.255 Test Loss: 12.692 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7839469909667969
Epoch: 4, Steps: 17 | Train Loss: 8.716 Vali Loss: 15.640 Vali Acc: 0.289 Test Loss: 15.640 Test Acc: 0.289
Validation loss decreased (-0.266094 --> -0.288817).  Saving model ...
Epoch: 5 cost time: 0.7573444843292236
Epoch: 5, Steps: 17 | Train Loss: 7.815 Vali Loss: 10.429 Vali Acc: 0.255 Test Loss: 10.429 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7677295207977295
Epoch: 6, Steps: 17 | Train Loss: 4.924 Vali Loss: 14.015 Vali Acc: 0.240 Test Loss: 14.015 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7316873073577881
Epoch: 7, Steps: 17 | Train Loss: 6.465 Vali Loss: 14.349 Vali Acc: 0.251 Test Loss: 14.349 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8215339183807373
Epoch: 8, Steps: 17 | Train Loss: 5.118 Vali Loss: 7.026 Vali Acc: 0.232 Test Loss: 7.026 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8530781269073486
Epoch: 9, Steps: 17 | Train Loss: 4.744 Vali Loss: 10.394 Vali Acc: 0.232 Test Loss: 10.394 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7249295711517334
Epoch: 10, Steps: 17 | Train Loss: 3.519 Vali Loss: 6.826 Vali Acc: 0.228 Test Loss: 6.826 Test Acc: 0.228
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.8001060485839844
Epoch: 11, Steps: 17 | Train Loss: 6.063 Vali Loss: 9.923 Vali Acc: 0.236 Test Loss: 9.923 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6799194812774658
Epoch: 12, Steps: 17 | Train Loss: 4.014 Vali Loss: 6.356 Vali Acc: 0.255 Test Loss: 6.356 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.7365539073944092
Epoch: 13, Steps: 17 | Train Loss: 3.411 Vali Loss: 4.869 Vali Acc: 0.232 Test Loss: 4.869 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7752695083618164
Epoch: 14, Steps: 17 | Train Loss: 2.253 Vali Loss: 5.488 Vali Acc: 0.240 Test Loss: 5.488 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3124495
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0453202724456787
Epoch: 1, Steps: 17 | Train Loss: 4.124 Vali Loss: 5.650 Vali Acc: 0.247 Test Loss: 5.650 Test Acc: 0.247
Validation loss decreased (inf --> -0.247092).  Saving model ...
Epoch: 2 cost time: 0.8103864192962646
Epoch: 2, Steps: 17 | Train Loss: 4.923 Vali Loss: 5.898 Vali Acc: 0.278 Test Loss: 5.898 Test Acc: 0.278
Validation loss decreased (-0.247092 --> -0.277508).  Saving model ...
Epoch: 3 cost time: 0.7260017395019531
Epoch: 3, Steps: 17 | Train Loss: 4.340 Vali Loss: 8.212 Vali Acc: 0.266 Test Loss: 8.212 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6911473274230957
Epoch: 4, Steps: 17 | Train Loss: 5.754 Vali Loss: 8.886 Vali Acc: 0.232 Test Loss: 8.886 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8747467994689941
Epoch: 5, Steps: 17 | Train Loss: 6.080 Vali Loss: 7.620 Vali Acc: 0.259 Test Loss: 7.620 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8588345050811768
Epoch: 6, Steps: 17 | Train Loss: 6.998 Vali Loss: 10.484 Vali Acc: 0.293 Test Loss: 10.484 Test Acc: 0.293
Validation loss decreased (-0.277508 --> -0.292671).  Saving model ...
Epoch: 7 cost time: 0.7709019184112549
Epoch: 7, Steps: 17 | Train Loss: 5.726 Vali Loss: 13.527 Vali Acc: 0.251 Test Loss: 13.527 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8479843139648438
Epoch: 8, Steps: 17 | Train Loss: 6.578 Vali Loss: 11.547 Vali Acc: 0.270 Test Loss: 11.547 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.695587158203125
Epoch: 9, Steps: 17 | Train Loss: 6.149 Vali Loss: 14.368 Vali Acc: 0.259 Test Loss: 14.368 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0120127201080322
Epoch: 10, Steps: 17 | Train Loss: 7.363 Vali Loss: 7.400 Vali Acc: 0.232 Test Loss: 7.400 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7104437351226807
Epoch: 11, Steps: 17 | Train Loss: 4.926 Vali Loss: 8.090 Vali Acc: 0.304 Test Loss: 8.090 Test Acc: 0.304
Validation loss decreased (-0.292671 --> -0.304102).  Saving model ...
Epoch: 12 cost time: 0.9069490432739258
Epoch: 12, Steps: 17 | Train Loss: 4.223 Vali Loss: 7.883 Vali Acc: 0.255 Test Loss: 7.883 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9068691730499268
Epoch: 13, Steps: 17 | Train Loss: 3.321 Vali Loss: 5.191 Vali Acc: 0.228 Test Loss: 5.191 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8208503723144531
Epoch: 14, Steps: 17 | Train Loss: 3.545 Vali Loss: 7.778 Vali Acc: 0.270 Test Loss: 7.778 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8653566837310791
Epoch: 15, Steps: 17 | Train Loss: 3.180 Vali Loss: 6.823 Vali Acc: 0.259 Test Loss: 6.823 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9483695030212402
Epoch: 16, Steps: 17 | Train Loss: 2.841 Vali Loss: 5.720 Vali Acc: 0.236 Test Loss: 5.720 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7941763401031494
Epoch: 17, Steps: 17 | Train Loss: 2.769 Vali Loss: 5.984 Vali Acc: 0.251 Test Loss: 5.984 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7740249633789062
Epoch: 18, Steps: 17 | Train Loss: 3.197 Vali Loss: 5.052 Vali Acc: 0.247 Test Loss: 5.052 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7373228073120117
Epoch: 19, Steps: 17 | Train Loss: 2.544 Vali Loss: 6.446 Vali Acc: 0.262 Test Loss: 6.446 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7500166893005371
Epoch: 20, Steps: 17 | Train Loss: 2.363 Vali Loss: 6.019 Vali Acc: 0.270 Test Loss: 6.019 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7746701240539551
Epoch: 21, Steps: 17 | Train Loss: 3.017 Vali Loss: 4.195 Vali Acc: 0.266 Test Loss: 4.195 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 3117380
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.346902847290039
Epoch: 1, Steps: 17 | Train Loss: 4.640 Vali Loss: 5.061 Vali Acc: 0.247 Test Loss: 5.061 Test Acc: 0.247
Validation loss decreased (inf --> -0.247098).  Saving model ...
Epoch: 2 cost time: 0.7081313133239746
Epoch: 2, Steps: 17 | Train Loss: 4.829 Vali Loss: 7.124 Vali Acc: 0.266 Test Loss: 7.124 Test Acc: 0.266
Validation loss decreased (-0.247098 --> -0.266088).  Saving model ...
Epoch: 3 cost time: 0.6426212787628174
Epoch: 3, Steps: 17 | Train Loss: 8.523 Vali Loss: 9.242 Vali Acc: 0.259 Test Loss: 9.242 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9749026298522949
Epoch: 4, Steps: 17 | Train Loss: 5.891 Vali Loss: 6.091 Vali Acc: 0.243 Test Loss: 6.091 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8567249774932861
Epoch: 5, Steps: 17 | Train Loss: 4.458 Vali Loss: 8.737 Vali Acc: 0.243 Test Loss: 8.737 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.831787109375
Epoch: 6, Steps: 17 | Train Loss: 5.250 Vali Loss: 9.840 Vali Acc: 0.251 Test Loss: 9.840 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.794851541519165
Epoch: 7, Steps: 17 | Train Loss: 5.919 Vali Loss: 14.110 Vali Acc: 0.300 Test Loss: 14.110 Test Acc: 0.300
Validation loss decreased (-0.266088 --> -0.300239).  Saving model ...
Epoch: 8 cost time: 0.751859188079834
Epoch: 8, Steps: 17 | Train Loss: 4.967 Vali Loss: 7.273 Vali Acc: 0.247 Test Loss: 7.273 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.86403489112854
Epoch: 9, Steps: 17 | Train Loss: 7.343 Vali Loss: 17.241 Vali Acc: 0.247 Test Loss: 17.241 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7654709815979004
Epoch: 10, Steps: 17 | Train Loss: 7.716 Vali Loss: 10.496 Vali Acc: 0.259 Test Loss: 10.496 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7188682556152344
Epoch: 11, Steps: 17 | Train Loss: 5.856 Vali Loss: 8.158 Vali Acc: 0.255 Test Loss: 8.158 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7618575096130371
Epoch: 12, Steps: 17 | Train Loss: 3.989 Vali Loss: 7.394 Vali Acc: 0.262 Test Loss: 7.394 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7671091556549072
Epoch: 13, Steps: 17 | Train Loss: 4.115 Vali Loss: 6.212 Vali Acc: 0.262 Test Loss: 6.212 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7773663997650146
Epoch: 14, Steps: 17 | Train Loss: 3.706 Vali Loss: 6.207 Vali Acc: 0.285 Test Loss: 6.207 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1604812145233154
Epoch: 15, Steps: 17 | Train Loss: 3.153 Vali Loss: 4.494 Vali Acc: 0.232 Test Loss: 4.494 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9087717533111572
Epoch: 16, Steps: 17 | Train Loss: 3.685 Vali Loss: 5.027 Vali Acc: 0.236 Test Loss: 5.027 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7763159275054932
Epoch: 17, Steps: 17 | Train Loss: 3.512 Vali Loss: 4.456 Vali Acc: 0.232 Test Loss: 4.456 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 3124853
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.450709581375122
Epoch: 1, Steps: 17 | Train Loss: 4.573 Vali Loss: 6.154 Vali Acc: 0.270 Test Loss: 6.154 Test Acc: 0.270
Validation loss decreased (inf --> -0.269900).  Saving model ...
Epoch: 2 cost time: 0.8339698314666748
Epoch: 2, Steps: 17 | Train Loss: 5.698 Vali Loss: 6.076 Vali Acc: 0.266 Test Loss: 6.076 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9256951808929443
Epoch: 3, Steps: 17 | Train Loss: 5.815 Vali Loss: 11.435 Vali Acc: 0.255 Test Loss: 11.435 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7079508304595947
Epoch: 4, Steps: 17 | Train Loss: 6.761 Vali Loss: 9.873 Vali Acc: 0.255 Test Loss: 9.873 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7545304298400879
Epoch: 5, Steps: 17 | Train Loss: 5.295 Vali Loss: 7.726 Vali Acc: 0.240 Test Loss: 7.726 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7810490131378174
Epoch: 6, Steps: 17 | Train Loss: 8.275 Vali Loss: 8.203 Vali Acc: 0.274 Test Loss: 8.203 Test Acc: 0.274
Validation loss decreased (-0.269900 --> -0.273682).  Saving model ...
Epoch: 7 cost time: 0.7484066486358643
Epoch: 7, Steps: 17 | Train Loss: 6.718 Vali Loss: 9.342 Vali Acc: 0.240 Test Loss: 9.342 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8614249229431152
Epoch: 8, Steps: 17 | Train Loss: 5.654 Vali Loss: 11.551 Vali Acc: 0.243 Test Loss: 11.551 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.873323917388916
Epoch: 9, Steps: 17 | Train Loss: 5.206 Vali Loss: 13.927 Vali Acc: 0.247 Test Loss: 13.927 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8311145305633545
Epoch: 10, Steps: 17 | Train Loss: 6.432 Vali Loss: 9.332 Vali Acc: 0.251 Test Loss: 9.332 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7907524108886719
Epoch: 11, Steps: 17 | Train Loss: 3.457 Vali Loss: 8.926 Vali Acc: 0.255 Test Loss: 8.926 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9329910278320312
Epoch: 12, Steps: 17 | Train Loss: 3.045 Vali Loss: 5.905 Vali Acc: 0.259 Test Loss: 5.905 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7925629615783691
Epoch: 13, Steps: 17 | Train Loss: 3.030 Vali Loss: 10.042 Vali Acc: 0.240 Test Loss: 10.042 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9221148490905762
Epoch: 14, Steps: 17 | Train Loss: 3.692 Vali Loss: 6.260 Vali Acc: 0.259 Test Loss: 6.260 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.835202693939209
Epoch: 15, Steps: 17 | Train Loss: 3.026 Vali Loss: 7.208 Vali Acc: 0.262 Test Loss: 7.208 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8486051559448242
Epoch: 16, Steps: 17 | Train Loss: 3.162 Vali Loss: 4.994 Vali Acc: 0.262 Test Loss: 4.994 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3115108
model size : 11.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0075902938842773
Epoch: 1, Steps: 17 | Train Loss: 4.015 Vali Loss: 5.723 Vali Acc: 0.278 Test Loss: 5.723 Test Acc: 0.278
Validation loss decreased (inf --> -0.277509).  Saving model ...
Epoch: 2 cost time: 0.6646511554718018
Epoch: 2, Steps: 17 | Train Loss: 4.401 Vali Loss: 6.807 Vali Acc: 0.274 Test Loss: 6.807 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.749539852142334
Epoch: 3, Steps: 17 | Train Loss: 6.545 Vali Loss: 9.135 Vali Acc: 0.293 Test Loss: 9.135 Test Acc: 0.293
Validation loss decreased (-0.277509 --> -0.292684).  Saving model ...
Epoch: 4 cost time: 0.6238512992858887
Epoch: 4, Steps: 17 | Train Loss: 5.605 Vali Loss: 14.712 Vali Acc: 0.259 Test Loss: 14.712 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7703280448913574
Epoch: 5, Steps: 17 | Train Loss: 7.464 Vali Loss: 11.883 Vali Acc: 0.270 Test Loss: 11.883 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7222802639007568
Epoch: 6, Steps: 17 | Train Loss: 8.654 Vali Loss: 10.565 Vali Acc: 0.270 Test Loss: 10.565 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7404801845550537
Epoch: 7, Steps: 17 | Train Loss: 11.307 Vali Loss: 22.319 Vali Acc: 0.259 Test Loss: 22.319 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.7791132926940918
Epoch: 8, Steps: 17 | Train Loss: 7.683 Vali Loss: 14.971 Vali Acc: 0.240 Test Loss: 14.971 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7636430263519287
Epoch: 9, Steps: 17 | Train Loss: 7.302 Vali Loss: 7.402 Vali Acc: 0.232 Test Loss: 7.402 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7056894302368164
Epoch: 10, Steps: 17 | Train Loss: 4.836 Vali Loss: 5.583 Vali Acc: 0.240 Test Loss: 5.583 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.7172157764434814
Epoch: 11, Steps: 17 | Train Loss: 4.083 Vali Loss: 8.441 Vali Acc: 0.240 Test Loss: 8.441 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7953813076019287
Epoch: 12, Steps: 17 | Train Loss: 3.389 Vali Loss: 6.524 Vali Acc: 0.251 Test Loss: 6.524 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7303054332733154
Epoch: 13, Steps: 17 | Train Loss: 3.196 Vali Loss: 8.815 Vali Acc: 0.240 Test Loss: 8.815 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3119631
model size : 11.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9818315505981445
Epoch: 1, Steps: 17 | Train Loss: 3.821 Vali Loss: 4.435 Vali Acc: 0.251 Test Loss: 4.435 Test Acc: 0.251
Validation loss decreased (inf --> -0.250906).  Saving model ...
Epoch: 2 cost time: 0.7080130577087402
Epoch: 2, Steps: 17 | Train Loss: 4.163 Vali Loss: 6.414 Vali Acc: 0.262 Test Loss: 6.414 Test Acc: 0.262
Validation loss decreased (-0.250906 --> -0.262293).  Saving model ...
Epoch: 3 cost time: 0.8155553340911865
Epoch: 3, Steps: 17 | Train Loss: 4.409 Vali Loss: 6.995 Vali Acc: 0.266 Test Loss: 6.995 Test Acc: 0.266
Validation loss decreased (-0.262293 --> -0.266090).  Saving model ...
Epoch: 4 cost time: 0.7299938201904297
Epoch: 4, Steps: 17 | Train Loss: 6.153 Vali Loss: 8.269 Vali Acc: 0.259 Test Loss: 8.269 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8163154125213623
Epoch: 5, Steps: 17 | Train Loss: 5.203 Vali Loss: 8.132 Vali Acc: 0.262 Test Loss: 8.132 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7510807514190674
Epoch: 6, Steps: 17 | Train Loss: 4.712 Vali Loss: 5.502 Vali Acc: 0.293 Test Loss: 5.502 Test Acc: 0.293
Validation loss decreased (-0.266090 --> -0.292721).  Saving model ...
Epoch: 7 cost time: 0.7532777786254883
Epoch: 7, Steps: 17 | Train Loss: 5.590 Vali Loss: 15.853 Vali Acc: 0.262 Test Loss: 15.853 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.711665153503418
Epoch: 8, Steps: 17 | Train Loss: 8.032 Vali Loss: 14.919 Vali Acc: 0.205 Test Loss: 14.919 Test Acc: 0.205
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7495975494384766
Epoch: 9, Steps: 17 | Train Loss: 6.465 Vali Loss: 19.314 Vali Acc: 0.262 Test Loss: 19.314 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8415265083312988
Epoch: 10, Steps: 17 | Train Loss: 6.835 Vali Loss: 10.443 Vali Acc: 0.274 Test Loss: 10.443 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.760772705078125
Epoch: 11, Steps: 17 | Train Loss: 5.066 Vali Loss: 9.416 Vali Acc: 0.243 Test Loss: 9.416 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.932208776473999
Epoch: 12, Steps: 17 | Train Loss: 2.659 Vali Loss: 5.582 Vali Acc: 0.274 Test Loss: 5.582 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8158078193664551
Epoch: 13, Steps: 17 | Train Loss: 2.618 Vali Loss: 5.831 Vali Acc: 0.281 Test Loss: 5.831 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8129489421844482
Epoch: 14, Steps: 17 | Train Loss: 3.084 Vali Loss: 4.989 Vali Acc: 0.236 Test Loss: 4.989 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8552286624908447
Epoch: 15, Steps: 17 | Train Loss: 3.406 Vali Loss: 5.699 Vali Acc: 0.255 Test Loss: 5.699 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8372349739074707
Epoch: 16, Steps: 17 | Train Loss: 2.802 Vali Loss: 5.505 Vali Acc: 0.293 Test Loss: 5.505 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3127820
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.3316407203674316
Epoch: 1, Steps: 17 | Train Loss: 5.021 Vali Loss: 5.320 Vali Acc: 0.274 Test Loss: 5.320 Test Acc: 0.274
Validation loss decreased (inf --> -0.273711).  Saving model ...
Epoch: 2 cost time: 0.9415736198425293
Epoch: 2, Steps: 17 | Train Loss: 5.467 Vali Loss: 3.907 Vali Acc: 0.202 Test Loss: 3.907 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7832326889038086
Epoch: 3, Steps: 17 | Train Loss: 4.580 Vali Loss: 7.396 Vali Acc: 0.274 Test Loss: 7.396 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9240002632141113
Epoch: 4, Steps: 17 | Train Loss: 5.296 Vali Loss: 5.470 Vali Acc: 0.270 Test Loss: 5.470 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8500926494598389
Epoch: 5, Steps: 17 | Train Loss: 4.534 Vali Loss: 10.196 Vali Acc: 0.266 Test Loss: 10.196 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.75368332862854
Epoch: 6, Steps: 17 | Train Loss: 7.061 Vali Loss: 10.733 Vali Acc: 0.259 Test Loss: 10.733 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8316454887390137
Epoch: 7, Steps: 17 | Train Loss: 7.659 Vali Loss: 18.741 Vali Acc: 0.255 Test Loss: 18.741 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8952193260192871
Epoch: 8, Steps: 17 | Train Loss: 7.456 Vali Loss: 7.610 Vali Acc: 0.240 Test Loss: 7.610 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8758459091186523
Epoch: 9, Steps: 17 | Train Loss: 3.448 Vali Loss: 7.150 Vali Acc: 0.221 Test Loss: 7.150 Test Acc: 0.221
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.872065544128418
Epoch: 10, Steps: 17 | Train Loss: 4.213 Vali Loss: 5.675 Vali Acc: 0.281 Test Loss: 5.675 Test Acc: 0.281
Validation loss decreased (-0.273711 --> -0.281312).  Saving model ...
Epoch: 11 cost time: 0.9131114482879639
Epoch: 11, Steps: 17 | Train Loss: 5.590 Vali Loss: 12.239 Vali Acc: 0.259 Test Loss: 12.239 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.894232988357544
Epoch: 12, Steps: 17 | Train Loss: 4.360 Vali Loss: 6.754 Vali Acc: 0.247 Test Loss: 6.754 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8353316783905029
Epoch: 13, Steps: 17 | Train Loss: 3.587 Vali Loss: 9.989 Vali Acc: 0.266 Test Loss: 9.989 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7970538139343262
Epoch: 14, Steps: 17 | Train Loss: 4.910 Vali Loss: 5.450 Vali Acc: 0.274 Test Loss: 5.450 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.863994836807251
Epoch: 15, Steps: 17 | Train Loss: 2.924 Vali Loss: 6.598 Vali Acc: 0.209 Test Loss: 6.598 Test Acc: 0.209
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8188836574554443
Epoch: 16, Steps: 17 | Train Loss: 2.254 Vali Loss: 6.178 Vali Acc: 0.243 Test Loss: 6.178 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8889646530151367
Epoch: 17, Steps: 17 | Train Loss: 2.988 Vali Loss: 4.194 Vali Acc: 0.236 Test Loss: 4.194 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8147096633911133
Epoch: 18, Steps: 17 | Train Loss: 1.939 Vali Loss: 5.117 Vali Acc: 0.270 Test Loss: 5.117 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8100571632385254
Epoch: 19, Steps: 17 | Train Loss: 2.449 Vali Loss: 5.332 Vali Acc: 0.266 Test Loss: 5.332 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9816811084747314
Epoch: 20, Steps: 17 | Train Loss: 2.976 Vali Loss: 4.427 Vali Acc: 0.251 Test Loss: 4.427 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3127354
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1686041355133057
Epoch: 1, Steps: 17 | Train Loss: 3.718 Vali Loss: 3.343 Vali Acc: 0.285 Test Loss: 3.343 Test Acc: 0.285
Validation loss decreased (inf --> -0.285138).  Saving model ...
Epoch: 2 cost time: 0.7399082183837891
Epoch: 2, Steps: 17 | Train Loss: 4.826 Vali Loss: 6.706 Vali Acc: 0.255 Test Loss: 6.706 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7094628810882568
Epoch: 3, Steps: 17 | Train Loss: 5.421 Vali Loss: 5.867 Vali Acc: 0.266 Test Loss: 5.867 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7695982456207275
Epoch: 4, Steps: 17 | Train Loss: 5.092 Vali Loss: 9.369 Vali Acc: 0.243 Test Loss: 9.369 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8052172660827637
Epoch: 5, Steps: 17 | Train Loss: 5.637 Vali Loss: 7.445 Vali Acc: 0.251 Test Loss: 7.445 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8262295722961426
Epoch: 6, Steps: 17 | Train Loss: 7.178 Vali Loss: 11.291 Vali Acc: 0.255 Test Loss: 11.291 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7054510116577148
Epoch: 7, Steps: 17 | Train Loss: 5.552 Vali Loss: 9.310 Vali Acc: 0.232 Test Loss: 9.310 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.8446743488311768
Epoch: 8, Steps: 17 | Train Loss: 6.937 Vali Loss: 14.262 Vali Acc: 0.236 Test Loss: 14.262 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9243383407592773
Epoch: 9, Steps: 17 | Train Loss: 8.492 Vali Loss: 14.737 Vali Acc: 0.270 Test Loss: 14.737 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.768242597579956
Epoch: 10, Steps: 17 | Train Loss: 7.944 Vali Loss: 9.868 Vali Acc: 0.262 Test Loss: 9.868 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7799761295318604
Epoch: 11, Steps: 17 | Train Loss: 6.203 Vali Loss: 8.635 Vali Acc: 0.266 Test Loss: 8.635 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3112948
model size : 11.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.896101951599121
Epoch: 1, Steps: 17 | Train Loss: 4.364 Vali Loss: 8.160 Vali Acc: 0.247 Test Loss: 8.160 Test Acc: 0.247
Validation loss decreased (inf --> -0.247067).  Saving model ...
Epoch: 2 cost time: 0.7953376770019531
Epoch: 2, Steps: 17 | Train Loss: 7.479 Vali Loss: 11.178 Vali Acc: 0.266 Test Loss: 11.178 Test Acc: 0.266
Validation loss decreased (-0.247067 --> -0.266048).  Saving model ...
Epoch: 3 cost time: 0.7741267681121826
Epoch: 3, Steps: 17 | Train Loss: 5.112 Vali Loss: 8.130 Vali Acc: 0.259 Test Loss: 8.130 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8357574939727783
Epoch: 4, Steps: 17 | Train Loss: 3.944 Vali Loss: 15.395 Vali Acc: 0.247 Test Loss: 15.395 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7446715831756592
Epoch: 5, Steps: 17 | Train Loss: 8.639 Vali Loss: 7.528 Vali Acc: 0.285 Test Loss: 7.528 Test Acc: 0.285
Validation loss decreased (-0.266048 --> -0.285096).  Saving model ...
Epoch: 6 cost time: 0.8787353038787842
Epoch: 6, Steps: 17 | Train Loss: 3.930 Vali Loss: 5.135 Vali Acc: 0.270 Test Loss: 5.135 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7748305797576904
Epoch: 7, Steps: 17 | Train Loss: 6.242 Vali Loss: 12.543 Vali Acc: 0.255 Test Loss: 12.543 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7850542068481445
Epoch: 8, Steps: 17 | Train Loss: 6.772 Vali Loss: 8.355 Vali Acc: 0.270 Test Loss: 8.355 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8698194026947021
Epoch: 9, Steps: 17 | Train Loss: 6.944 Vali Loss: 8.357 Vali Acc: 0.266 Test Loss: 8.357 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7537357807159424
Epoch: 10, Steps: 17 | Train Loss: 5.422 Vali Loss: 7.998 Vali Acc: 0.236 Test Loss: 7.998 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7665979862213135
Epoch: 11, Steps: 17 | Train Loss: 4.304 Vali Loss: 9.271 Vali Acc: 0.281 Test Loss: 9.271 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.741020917892456
Epoch: 12, Steps: 17 | Train Loss: 3.711 Vali Loss: 7.593 Vali Acc: 0.224 Test Loss: 7.593 Test Acc: 0.224
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8199968338012695
Epoch: 13, Steps: 17 | Train Loss: 4.429 Vali Loss: 8.461 Vali Acc: 0.255 Test Loss: 8.461 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8170433044433594
Epoch: 14, Steps: 17 | Train Loss: 3.007 Vali Loss: 7.410 Vali Acc: 0.221 Test Loss: 7.410 Test Acc: 0.221
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9519422054290771
Epoch: 15, Steps: 17 | Train Loss: 4.385 Vali Loss: 8.460 Vali Acc: 0.224 Test Loss: 8.460 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3117903
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.106343984603882
Epoch: 1, Steps: 17 | Train Loss: 5.316 Vali Loss: 5.628 Vali Acc: 0.266 Test Loss: 5.628 Test Acc: 0.266
Validation loss decreased (inf --> -0.266103).  Saving model ...
Epoch: 2 cost time: 0.8012166023254395
Epoch: 2, Steps: 17 | Train Loss: 3.834 Vali Loss: 5.945 Vali Acc: 0.262 Test Loss: 5.945 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8360443115234375
Epoch: 3, Steps: 17 | Train Loss: 4.563 Vali Loss: 5.192 Vali Acc: 0.198 Test Loss: 5.192 Test Acc: 0.198
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8089799880981445
Epoch: 4, Steps: 17 | Train Loss: 4.103 Vali Loss: 6.694 Vali Acc: 0.236 Test Loss: 6.694 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7000894546508789
Epoch: 5, Steps: 17 | Train Loss: 6.786 Vali Loss: 16.628 Vali Acc: 0.266 Test Loss: 16.628 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7410624027252197
Epoch: 6, Steps: 17 | Train Loss: 11.798 Vali Loss: 15.074 Vali Acc: 0.270 Test Loss: 15.074 Test Acc: 0.270
Validation loss decreased (-0.266103 --> -0.269811).  Saving model ...
Epoch: 7 cost time: 0.734022855758667
Epoch: 7, Steps: 17 | Train Loss: 7.819 Vali Loss: 12.425 Vali Acc: 0.232 Test Loss: 12.425 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7943768501281738
Epoch: 8, Steps: 17 | Train Loss: 3.840 Vali Loss: 8.033 Vali Acc: 0.251 Test Loss: 8.033 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8254897594451904
Epoch: 9, Steps: 17 | Train Loss: 4.941 Vali Loss: 12.270 Vali Acc: 0.278 Test Loss: 12.270 Test Acc: 0.278
Validation loss decreased (-0.269811 --> -0.277444).  Saving model ...
Epoch: 10 cost time: 0.6853823661804199
Epoch: 10, Steps: 17 | Train Loss: 5.161 Vali Loss: 9.624 Vali Acc: 0.251 Test Loss: 9.624 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7446811199188232
Epoch: 11, Steps: 17 | Train Loss: 3.640 Vali Loss: 6.411 Vali Acc: 0.289 Test Loss: 6.411 Test Acc: 0.289
Validation loss decreased (-0.277444 --> -0.288909).  Saving model ...
Epoch: 12 cost time: 0.7410800457000732
Epoch: 12, Steps: 17 | Train Loss: 3.405 Vali Loss: 4.691 Vali Acc: 0.217 Test Loss: 4.691 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.774054765701294
Epoch: 13, Steps: 17 | Train Loss: 4.839 Vali Loss: 5.898 Vali Acc: 0.270 Test Loss: 5.898 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7547745704650879
Epoch: 14, Steps: 17 | Train Loss: 3.217 Vali Loss: 4.778 Vali Acc: 0.224 Test Loss: 4.778 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7718276977539062
Epoch: 15, Steps: 17 | Train Loss: 2.832 Vali Loss: 6.292 Vali Acc: 0.247 Test Loss: 6.292 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7831318378448486
Epoch: 16, Steps: 17 | Train Loss: 3.188 Vali Loss: 5.383 Vali Acc: 0.278 Test Loss: 5.383 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7504258155822754
Epoch: 17, Steps: 17 | Train Loss: 2.441 Vali Loss: 3.927 Vali Acc: 0.255 Test Loss: 3.927 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7569184303283691
Epoch: 18, Steps: 17 | Train Loss: 1.771 Vali Loss: 6.114 Vali Acc: 0.255 Test Loss: 6.114 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.654181718826294
Epoch: 19, Steps: 17 | Train Loss: 2.477 Vali Loss: 6.383 Vali Acc: 0.255 Test Loss: 6.383 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6937165260314941
Epoch: 20, Steps: 17 | Train Loss: 2.534 Vali Loss: 5.828 Vali Acc: 0.259 Test Loss: 5.828 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7643041610717773
Epoch: 21, Steps: 17 | Train Loss: 2.966 Vali Loss: 5.686 Vali Acc: 0.243 Test Loss: 5.686 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3133432
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1702587604522705
Epoch: 1, Steps: 17 | Train Loss: 5.314 Vali Loss: 8.531 Vali Acc: 0.262 Test Loss: 8.531 Test Acc: 0.262
Validation loss decreased (inf --> -0.262272).  Saving model ...
Epoch: 2 cost time: 0.7121000289916992
Epoch: 2, Steps: 17 | Train Loss: 4.907 Vali Loss: 6.018 Vali Acc: 0.251 Test Loss: 6.018 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7365186214447021
Epoch: 3, Steps: 17 | Train Loss: 5.076 Vali Loss: 4.607 Vali Acc: 0.243 Test Loss: 4.607 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8736827373504639
Epoch: 4, Steps: 17 | Train Loss: 6.660 Vali Loss: 9.241 Vali Acc: 0.262 Test Loss: 9.241 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8032071590423584
Epoch: 5, Steps: 17 | Train Loss: 7.281 Vali Loss: 7.655 Vali Acc: 0.255 Test Loss: 7.655 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8781082630157471
Epoch: 6, Steps: 17 | Train Loss: 7.319 Vali Loss: 10.688 Vali Acc: 0.243 Test Loss: 10.688 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6985912322998047
Epoch: 7, Steps: 17 | Train Loss: 7.867 Vali Loss: 9.417 Vali Acc: 0.255 Test Loss: 9.417 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.7235434055328369
Epoch: 8, Steps: 17 | Train Loss: 4.453 Vali Loss: 7.643 Vali Acc: 0.255 Test Loss: 7.643 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7060744762420654
Epoch: 9, Steps: 17 | Train Loss: 3.392 Vali Loss: 6.799 Vali Acc: 0.240 Test Loss: 6.799 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7646627426147461
Epoch: 10, Steps: 17 | Train Loss: 3.062 Vali Loss: 9.682 Vali Acc: 0.255 Test Loss: 9.682 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6675562858581543
Epoch: 11, Steps: 17 | Train Loss: 4.486 Vali Loss: 8.676 Vali Acc: 0.251 Test Loss: 8.676 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2623574144486692
model parameter : 3117447
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1365909576416016
Epoch: 1, Steps: 17 | Train Loss: 4.213 Vali Loss: 10.488 Vali Acc: 0.255 Test Loss: 10.488 Test Acc: 0.255
Validation loss decreased (inf --> -0.254648).  Saving model ...
Epoch: 2 cost time: 0.8419640064239502
Epoch: 2, Steps: 17 | Train Loss: 4.245 Vali Loss: 6.992 Vali Acc: 0.247 Test Loss: 6.992 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7769005298614502
Epoch: 3, Steps: 17 | Train Loss: 7.814 Vali Loss: 9.249 Vali Acc: 0.236 Test Loss: 9.249 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7970609664916992
Epoch: 4, Steps: 17 | Train Loss: 6.384 Vali Loss: 12.676 Vali Acc: 0.293 Test Loss: 12.676 Test Acc: 0.293
Validation loss decreased (-0.254648 --> -0.292649).  Saving model ...
Epoch: 5 cost time: 0.7331666946411133
Epoch: 5, Steps: 17 | Train Loss: 9.752 Vali Loss: 9.072 Vali Acc: 0.262 Test Loss: 9.072 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6644911766052246
Epoch: 6, Steps: 17 | Train Loss: 7.816 Vali Loss: 10.561 Vali Acc: 0.266 Test Loss: 10.561 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7185044288635254
Epoch: 7, Steps: 17 | Train Loss: 7.884 Vali Loss: 7.499 Vali Acc: 0.232 Test Loss: 7.499 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6637089252471924
Epoch: 8, Steps: 17 | Train Loss: 4.104 Vali Loss: 11.677 Vali Acc: 0.262 Test Loss: 11.677 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7188611030578613
Epoch: 9, Steps: 17 | Train Loss: 5.369 Vali Loss: 7.657 Vali Acc: 0.251 Test Loss: 7.657 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.672978401184082
Epoch: 10, Steps: 17 | Train Loss: 4.986 Vali Loss: 5.775 Vali Acc: 0.232 Test Loss: 5.775 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.6203591823577881
Epoch: 11, Steps: 17 | Train Loss: 4.648 Vali Loss: 9.427 Vali Acc: 0.281 Test Loss: 9.427 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.847968578338623
Epoch: 12, Steps: 17 | Train Loss: 4.438 Vali Loss: 7.053 Vali Acc: 0.247 Test Loss: 7.053 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.820636510848999
Epoch: 13, Steps: 17 | Train Loss: 3.549 Vali Loss: 7.741 Vali Acc: 0.236 Test Loss: 7.741 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.9135024547576904
Epoch: 14, Steps: 17 | Train Loss: 4.554 Vali Loss: 7.537 Vali Acc: 0.297 Test Loss: 7.537 Test Acc: 0.297
Validation loss decreased (-0.292649 --> -0.296503).  Saving model ...
Epoch: 15 cost time: 0.7046942710876465
Epoch: 15, Steps: 17 | Train Loss: 3.437 Vali Loss: 6.803 Vali Acc: 0.232 Test Loss: 6.803 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.743596076965332
Epoch: 16, Steps: 17 | Train Loss: 2.983 Vali Loss: 7.277 Vali Acc: 0.266 Test Loss: 7.277 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7235279083251953
Epoch: 17, Steps: 17 | Train Loss: 2.444 Vali Loss: 4.396 Vali Acc: 0.278 Test Loss: 4.396 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7327899932861328
Epoch: 18, Steps: 17 | Train Loss: 3.131 Vali Loss: 5.166 Vali Acc: 0.274 Test Loss: 5.166 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7447311878204346
Epoch: 19, Steps: 17 | Train Loss: 2.089 Vali Loss: 5.037 Vali Acc: 0.217 Test Loss: 5.037 Test Acc: 0.217
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7065834999084473
Epoch: 20, Steps: 17 | Train Loss: 2.019 Vali Loss: 5.445 Vali Acc: 0.259 Test Loss: 5.445 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9105701446533203
Epoch: 21, Steps: 17 | Train Loss: 2.854 Vali Loss: 6.521 Vali Acc: 0.262 Test Loss: 6.521 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7364890575408936
Epoch: 22, Steps: 17 | Train Loss: 3.662 Vali Loss: 6.283 Vali Acc: 0.259 Test Loss: 6.283 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8219277858734131
Epoch: 23, Steps: 17 | Train Loss: 3.409 Vali Loss: 6.571 Vali Acc: 0.243 Test Loss: 6.571 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7527673244476318
Epoch: 24, Steps: 17 | Train Loss: 2.547 Vali Loss: 8.562 Vali Acc: 0.240 Test Loss: 8.562 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3126044
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9446544647216797
Epoch: 1, Steps: 17 | Train Loss: 4.668 Vali Loss: 5.185 Vali Acc: 0.255 Test Loss: 5.185 Test Acc: 0.255
Validation loss decreased (inf --> -0.254701).  Saving model ...
Epoch: 2 cost time: 0.6522555351257324
Epoch: 2, Steps: 17 | Train Loss: 4.666 Vali Loss: 6.635 Vali Acc: 0.247 Test Loss: 6.635 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7712242603302002
Epoch: 3, Steps: 17 | Train Loss: 5.348 Vali Loss: 9.634 Vali Acc: 0.247 Test Loss: 9.634 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6713240146636963
Epoch: 4, Steps: 17 | Train Loss: 5.451 Vali Loss: 7.213 Vali Acc: 0.266 Test Loss: 7.213 Test Acc: 0.266
Validation loss decreased (-0.254701 --> -0.266088).  Saving model ...
Epoch: 5 cost time: 0.6944582462310791
Epoch: 5, Steps: 17 | Train Loss: 5.905 Vali Loss: 6.436 Vali Acc: 0.278 Test Loss: 6.436 Test Acc: 0.278
Validation loss decreased (-0.266088 --> -0.277502).  Saving model ...
Epoch: 6 cost time: 0.6571571826934814
Epoch: 6, Steps: 17 | Train Loss: 7.200 Vali Loss: 13.846 Vali Acc: 0.259 Test Loss: 13.846 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6133902072906494
Epoch: 7, Steps: 17 | Train Loss: 7.643 Vali Loss: 19.987 Vali Acc: 0.255 Test Loss: 19.987 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7295567989349365
Epoch: 8, Steps: 17 | Train Loss: 6.605 Vali Loss: 8.173 Vali Acc: 0.228 Test Loss: 8.173 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5583856105804443
Epoch: 9, Steps: 17 | Train Loss: 6.076 Vali Loss: 11.223 Vali Acc: 0.285 Test Loss: 11.223 Test Acc: 0.285
Validation loss decreased (-0.277502 --> -0.285059).  Saving model ...
Epoch: 10 cost time: 0.6927685737609863
Epoch: 10, Steps: 17 | Train Loss: 7.582 Vali Loss: 8.476 Vali Acc: 0.297 Test Loss: 8.476 Test Acc: 0.297
Validation loss decreased (-0.285059 --> -0.296493).  Saving model ...
Epoch: 11 cost time: 0.6087098121643066
Epoch: 11, Steps: 17 | Train Loss: 6.505 Vali Loss: 8.101 Vali Acc: 0.255 Test Loss: 8.101 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7140870094299316
Epoch: 12, Steps: 17 | Train Loss: 2.813 Vali Loss: 4.903 Vali Acc: 0.266 Test Loss: 4.903 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7487850189208984
Epoch: 13, Steps: 17 | Train Loss: 2.737 Vali Loss: 6.576 Vali Acc: 0.228 Test Loss: 6.576 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6894874572753906
Epoch: 14, Steps: 17 | Train Loss: 3.641 Vali Loss: 5.559 Vali Acc: 0.255 Test Loss: 5.559 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7942123413085938
Epoch: 15, Steps: 17 | Train Loss: 2.559 Vali Loss: 3.734 Vali Acc: 0.247 Test Loss: 3.734 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.732262134552002
Epoch: 16, Steps: 17 | Train Loss: 2.617 Vali Loss: 4.261 Vali Acc: 0.259 Test Loss: 4.261 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6881017684936523
Epoch: 17, Steps: 17 | Train Loss: 2.792 Vali Loss: 8.699 Vali Acc: 0.259 Test Loss: 8.699 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7346906661987305
Epoch: 18, Steps: 17 | Train Loss: 3.139 Vali Loss: 4.333 Vali Acc: 0.262 Test Loss: 4.333 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6140167713165283
Epoch: 19, Steps: 17 | Train Loss: 2.057 Vali Loss: 11.644 Vali Acc: 0.243 Test Loss: 11.644 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6411819458007812
Epoch: 20, Steps: 17 | Train Loss: 3.587 Vali Loss: 6.270 Vali Acc: 0.274 Test Loss: 6.270 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3110131
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2476119995117188
Epoch: 1, Steps: 17 | Train Loss: 6.110 Vali Loss: 8.997 Vali Acc: 0.251 Test Loss: 8.997 Test Acc: 0.251
Validation loss decreased (inf --> -0.250861).  Saving model ...
Epoch: 2 cost time: 0.8239338397979736
Epoch: 2, Steps: 17 | Train Loss: 5.610 Vali Loss: 4.188 Vali Acc: 0.281 Test Loss: 4.188 Test Acc: 0.281
Validation loss decreased (-0.250861 --> -0.281327).  Saving model ...
Epoch: 3 cost time: 0.8688209056854248
Epoch: 3, Steps: 17 | Train Loss: 3.716 Vali Loss: 6.259 Vali Acc: 0.251 Test Loss: 6.259 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8283915519714355
Epoch: 4, Steps: 17 | Train Loss: 7.185 Vali Loss: 18.085 Vali Acc: 0.247 Test Loss: 18.085 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7245316505432129
Epoch: 5, Steps: 17 | Train Loss: 8.854 Vali Loss: 12.327 Vali Acc: 0.259 Test Loss: 12.327 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7488977909088135
Epoch: 6, Steps: 17 | Train Loss: 9.374 Vali Loss: 16.685 Vali Acc: 0.251 Test Loss: 16.685 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7224628925323486
Epoch: 7, Steps: 17 | Train Loss: 10.457 Vali Loss: 13.409 Vali Acc: 0.251 Test Loss: 13.409 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8632612228393555
Epoch: 8, Steps: 17 | Train Loss: 6.454 Vali Loss: 8.753 Vali Acc: 0.262 Test Loss: 8.753 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6556587219238281
Epoch: 9, Steps: 17 | Train Loss: 3.581 Vali Loss: 4.916 Vali Acc: 0.259 Test Loss: 4.916 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9893918037414551
Epoch: 10, Steps: 17 | Train Loss: 5.784 Vali Loss: 15.964 Vali Acc: 0.240 Test Loss: 15.964 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.7227141857147217
Epoch: 11, Steps: 17 | Train Loss: 6.093 Vali Loss: 8.474 Vali Acc: 0.224 Test Loss: 8.474 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.8662524223327637
Epoch: 12, Steps: 17 | Train Loss: 3.734 Vali Loss: 6.061 Vali Acc: 0.259 Test Loss: 6.061 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3132808
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9395415782928467
Epoch: 1, Steps: 17 | Train Loss: 4.027 Vali Loss: 5.969 Vali Acc: 0.255 Test Loss: 5.969 Test Acc: 0.255
Validation loss decreased (inf --> -0.254693).  Saving model ...
Epoch: 2 cost time: 0.6316282749176025
Epoch: 2, Steps: 17 | Train Loss: 4.992 Vali Loss: 5.665 Vali Acc: 0.224 Test Loss: 5.665 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7134571075439453
Epoch: 3, Steps: 17 | Train Loss: 5.887 Vali Loss: 8.555 Vali Acc: 0.247 Test Loss: 8.555 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7796764373779297
Epoch: 4, Steps: 17 | Train Loss: 9.354 Vali Loss: 16.484 Vali Acc: 0.247 Test Loss: 16.484 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7289035320281982
Epoch: 5, Steps: 17 | Train Loss: 8.563 Vali Loss: 16.332 Vali Acc: 0.270 Test Loss: 16.332 Test Acc: 0.270
Validation loss decreased (-0.254693 --> -0.269799).  Saving model ...
Epoch: 6 cost time: 0.7965056896209717
Epoch: 6, Steps: 17 | Train Loss: 10.503 Vali Loss: 12.878 Vali Acc: 0.247 Test Loss: 12.878 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.740032434463501
Epoch: 7, Steps: 17 | Train Loss: 8.341 Vali Loss: 12.563 Vali Acc: 0.247 Test Loss: 12.563 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7963411808013916
Epoch: 8, Steps: 17 | Train Loss: 4.509 Vali Loss: 8.685 Vali Acc: 0.247 Test Loss: 8.685 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.568770170211792
Epoch: 9, Steps: 17 | Train Loss: 4.903 Vali Loss: 16.950 Vali Acc: 0.255 Test Loss: 16.950 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6416411399841309
Epoch: 10, Steps: 17 | Train Loss: 6.037 Vali Loss: 9.401 Vali Acc: 0.247 Test Loss: 9.401 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7226028442382812
Epoch: 11, Steps: 17 | Train Loss: 4.324 Vali Loss: 8.575 Vali Acc: 0.236 Test Loss: 8.575 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7709543704986572
Epoch: 12, Steps: 17 | Train Loss: 2.639 Vali Loss: 4.166 Vali Acc: 0.262 Test Loss: 4.166 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.757774829864502
Epoch: 13, Steps: 17 | Train Loss: 2.287 Vali Loss: 6.689 Vali Acc: 0.236 Test Loss: 6.689 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7100265026092529
Epoch: 14, Steps: 17 | Train Loss: 3.055 Vali Loss: 8.526 Vali Acc: 0.240 Test Loss: 8.526 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8373992443084717
Epoch: 15, Steps: 17 | Train Loss: 3.693 Vali Loss: 4.454 Vali Acc: 0.262 Test Loss: 4.454 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 3137979
model size : 11.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.939643383026123
Epoch: 1, Steps: 17 | Train Loss: 7.085 Vali Loss: 6.147 Vali Acc: 0.270 Test Loss: 6.147 Test Acc: 0.270
Validation loss decreased (inf --> -0.269901).  Saving model ...
Epoch: 2 cost time: 0.7894618511199951
Epoch: 2, Steps: 17 | Train Loss: 6.204 Vali Loss: 7.665 Vali Acc: 0.236 Test Loss: 7.665 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6996445655822754
Epoch: 3, Steps: 17 | Train Loss: 5.715 Vali Loss: 8.446 Vali Acc: 0.247 Test Loss: 8.446 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8700850009918213
Epoch: 4, Steps: 17 | Train Loss: 7.603 Vali Loss: 10.140 Vali Acc: 0.259 Test Loss: 10.140 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8562068939208984
Epoch: 5, Steps: 17 | Train Loss: 8.886 Vali Loss: 17.007 Vali Acc: 0.274 Test Loss: 17.007 Test Acc: 0.274
Validation loss decreased (-0.269901 --> -0.273594).  Saving model ...
Epoch: 6 cost time: 0.8631045818328857
Epoch: 6, Steps: 17 | Train Loss: 6.169 Vali Loss: 11.906 Vali Acc: 0.251 Test Loss: 11.906 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6233582496643066
Epoch: 7, Steps: 17 | Train Loss: 7.699 Vali Loss: 11.035 Vali Acc: 0.251 Test Loss: 11.035 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7125720977783203
Epoch: 8, Steps: 17 | Train Loss: 6.243 Vali Loss: 12.257 Vali Acc: 0.232 Test Loss: 12.257 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8501951694488525
Epoch: 9, Steps: 17 | Train Loss: 5.687 Vali Loss: 13.780 Vali Acc: 0.251 Test Loss: 13.780 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8209164142608643
Epoch: 10, Steps: 17 | Train Loss: 6.073 Vali Loss: 5.623 Vali Acc: 0.255 Test Loss: 5.623 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7230861186981201
Epoch: 11, Steps: 17 | Train Loss: 4.603 Vali Loss: 11.407 Vali Acc: 0.281 Test Loss: 11.407 Test Acc: 0.281
Validation loss decreased (-0.273594 --> -0.281255).  Saving model ...
Epoch: 12 cost time: 0.8393943309783936
Epoch: 12, Steps: 17 | Train Loss: 4.427 Vali Loss: 5.247 Vali Acc: 0.262 Test Loss: 5.247 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7460675239562988
Epoch: 13, Steps: 17 | Train Loss: 2.716 Vali Loss: 7.909 Vali Acc: 0.262 Test Loss: 7.909 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8350965976715088
Epoch: 14, Steps: 17 | Train Loss: 2.717 Vali Loss: 5.856 Vali Acc: 0.236 Test Loss: 5.856 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7884893417358398
Epoch: 15, Steps: 17 | Train Loss: 2.953 Vali Loss: 6.814 Vali Acc: 0.243 Test Loss: 6.814 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7230994701385498
Epoch: 16, Steps: 17 | Train Loss: 2.946 Vali Loss: 5.368 Vali Acc: 0.255 Test Loss: 5.368 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.734398603439331
Epoch: 17, Steps: 17 | Train Loss: 2.868 Vali Loss: 5.213 Vali Acc: 0.281 Test Loss: 5.213 Test Acc: 0.281
Validation loss decreased (-0.281255 --> -0.281317).  Saving model ...
Epoch: 18 cost time: 0.6729624271392822
Epoch: 18, Steps: 17 | Train Loss: 2.825 Vali Loss: 6.818 Vali Acc: 0.251 Test Loss: 6.818 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7175703048706055
Epoch: 19, Steps: 17 | Train Loss: 2.820 Vali Loss: 6.016 Vali Acc: 0.243 Test Loss: 6.016 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6317493915557861
Epoch: 20, Steps: 17 | Train Loss: 2.793 Vali Loss: 5.637 Vali Acc: 0.236 Test Loss: 5.637 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8504922389984131
Epoch: 21, Steps: 17 | Train Loss: 2.899 Vali Loss: 10.175 Vali Acc: 0.213 Test Loss: 10.175 Test Acc: 0.213
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7632904052734375
Epoch: 22, Steps: 17 | Train Loss: 2.763 Vali Loss: 6.951 Vali Acc: 0.255 Test Loss: 6.951 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8824489116668701
Epoch: 23, Steps: 17 | Train Loss: 2.588 Vali Loss: 8.510 Vali Acc: 0.232 Test Loss: 8.510 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7177023887634277
Epoch: 24, Steps: 17 | Train Loss: 2.853 Vali Loss: 8.511 Vali Acc: 0.232 Test Loss: 8.511 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7018818855285645
Epoch: 25, Steps: 17 | Train Loss: 2.599 Vali Loss: 7.913 Vali Acc: 0.243 Test Loss: 7.913 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7479715347290039
Epoch: 26, Steps: 17 | Train Loss: 2.810 Vali Loss: 5.050 Vali Acc: 0.266 Test Loss: 5.050 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6901061534881592
Epoch: 27, Steps: 17 | Train Loss: 2.793 Vali Loss: 4.953 Vali Acc: 0.308 Test Loss: 4.953 Test Acc: 0.308
Validation loss decreased (-0.281317 --> -0.307935).  Saving model ...
Epoch: 28 cost time: 0.7430951595306396
Epoch: 28, Steps: 17 | Train Loss: 2.770 Vali Loss: 7.565 Vali Acc: 0.270 Test Loss: 7.565 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6877622604370117
Epoch: 29, Steps: 17 | Train Loss: 2.258 Vali Loss: 10.227 Vali Acc: 0.281 Test Loss: 10.227 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7602238655090332
Epoch: 30, Steps: 17 | Train Loss: 3.926 Vali Loss: 8.148 Vali Acc: 0.259 Test Loss: 8.148 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7867481708526611
Epoch: 31, Steps: 17 | Train Loss: 2.364 Vali Loss: 6.930 Vali Acc: 0.243 Test Loss: 6.930 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7609264850616455
Epoch: 32, Steps: 17 | Train Loss: 3.537 Vali Loss: 5.420 Vali Acc: 0.285 Test Loss: 5.420 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7840170860290527
Epoch: 33, Steps: 17 | Train Loss: 2.534 Vali Loss: 10.381 Vali Acc: 0.266 Test Loss: 10.381 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7708077430725098
Epoch: 34, Steps: 17 | Train Loss: 3.270 Vali Loss: 7.626 Vali Acc: 0.251 Test Loss: 7.626 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7181236743927002
Epoch: 35, Steps: 17 | Train Loss: 4.388 Vali Loss: 12.213 Vali Acc: 0.266 Test Loss: 12.213 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8026447296142578
Epoch: 36, Steps: 17 | Train Loss: 3.492 Vali Loss: 7.110 Vali Acc: 0.228 Test Loss: 7.110 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7580151557922363
Epoch: 37, Steps: 17 | Train Loss: 2.874 Vali Loss: 9.873 Vali Acc: 0.236 Test Loss: 9.873 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 3125644
model size : 11.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1031861305236816
Epoch: 1, Steps: 17 | Train Loss: 3.952 Vali Loss: 8.257 Vali Acc: 0.266 Test Loss: 8.257 Test Acc: 0.266
Validation loss decreased (inf --> -0.266077).  Saving model ...
Epoch: 2 cost time: 0.7979650497436523
Epoch: 2, Steps: 17 | Train Loss: 6.991 Vali Loss: 13.235 Vali Acc: 0.266 Test Loss: 13.235 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7208969593048096
Epoch: 3, Steps: 17 | Train Loss: 5.542 Vali Loss: 5.946 Vali Acc: 0.274 Test Loss: 5.946 Test Acc: 0.274
Validation loss decreased (-0.266077 --> -0.273705).  Saving model ...
Epoch: 4 cost time: 0.7699346542358398
Epoch: 4, Steps: 17 | Train Loss: 4.409 Vali Loss: 6.931 Vali Acc: 0.232 Test Loss: 6.931 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7783417701721191
Epoch: 5, Steps: 17 | Train Loss: 5.698 Vali Loss: 6.033 Vali Acc: 0.259 Test Loss: 6.033 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7291958332061768
Epoch: 6, Steps: 17 | Train Loss: 4.250 Vali Loss: 12.064 Vali Acc: 0.266 Test Loss: 12.064 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7506518363952637
Epoch: 7, Steps: 17 | Train Loss: 5.777 Vali Loss: 14.111 Vali Acc: 0.247 Test Loss: 14.111 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6878111362457275
Epoch: 8, Steps: 17 | Train Loss: 13.435 Vali Loss: 9.691 Vali Acc: 0.232 Test Loss: 9.691 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7738780975341797
Epoch: 9, Steps: 17 | Train Loss: 7.488 Vali Loss: 5.912 Vali Acc: 0.262 Test Loss: 5.912 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7877981662750244
Epoch: 10, Steps: 17 | Train Loss: 3.733 Vali Loss: 4.831 Vali Acc: 0.281 Test Loss: 4.831 Test Acc: 0.281
Validation loss decreased (-0.273705 --> -0.281321).  Saving model ...
Epoch: 11 cost time: 0.8737645149230957
Epoch: 11, Steps: 17 | Train Loss: 2.319 Vali Loss: 6.561 Vali Acc: 0.202 Test Loss: 6.561 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6536669731140137
Epoch: 12, Steps: 17 | Train Loss: 3.436 Vali Loss: 8.563 Vali Acc: 0.262 Test Loss: 8.563 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7508280277252197
Epoch: 13, Steps: 17 | Train Loss: 4.563 Vali Loss: 7.114 Vali Acc: 0.247 Test Loss: 7.114 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6889488697052002
Epoch: 14, Steps: 17 | Train Loss: 4.479 Vali Loss: 8.127 Vali Acc: 0.262 Test Loss: 8.127 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6645257472991943
Epoch: 15, Steps: 17 | Train Loss: 4.002 Vali Loss: 4.212 Vali Acc: 0.285 Test Loss: 4.212 Test Acc: 0.285
Validation loss decreased (-0.281321 --> -0.285129).  Saving model ...
Epoch: 16 cost time: 0.7843899726867676
Epoch: 16, Steps: 17 | Train Loss: 2.040 Vali Loss: 6.461 Vali Acc: 0.255 Test Loss: 6.461 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8273911476135254
Epoch: 17, Steps: 17 | Train Loss: 3.063 Vali Loss: 9.416 Vali Acc: 0.236 Test Loss: 9.416 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7756752967834473
Epoch: 18, Steps: 17 | Train Loss: 4.802 Vali Loss: 5.322 Vali Acc: 0.255 Test Loss: 5.322 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7196640968322754
Epoch: 19, Steps: 17 | Train Loss: 2.654 Vali Loss: 8.595 Vali Acc: 0.274 Test Loss: 8.595 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7427034378051758
Epoch: 20, Steps: 17 | Train Loss: 2.129 Vali Loss: 5.445 Vali Acc: 0.247 Test Loss: 5.445 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6861443519592285
Epoch: 21, Steps: 17 | Train Loss: 2.919 Vali Loss: 5.320 Vali Acc: 0.259 Test Loss: 5.320 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6617426872253418
Epoch: 22, Steps: 17 | Train Loss: 2.182 Vali Loss: 5.100 Vali Acc: 0.240 Test Loss: 5.100 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7773916721343994
Epoch: 23, Steps: 17 | Train Loss: 3.039 Vali Loss: 5.262 Vali Acc: 0.224 Test Loss: 5.262 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7629184722900391
Epoch: 24, Steps: 17 | Train Loss: 2.091 Vali Loss: 9.159 Vali Acc: 0.228 Test Loss: 9.159 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6703915596008301
Epoch: 25, Steps: 17 | Train Loss: 3.391 Vali Loss: 5.705 Vali Acc: 0.251 Test Loss: 5.705 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm64_cs84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3132606
model size : 11.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs876_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9512939453125
Epoch: 1, Steps: 17 | Train Loss: 3.726 Vali Loss: 5.511 Vali Acc: 0.285 Test Loss: 5.511 Test Acc: 0.285
Validation loss decreased (inf --> -0.285116).  Saving model ...
Epoch: 2 cost time: 0.8399395942687988
Epoch: 2, Steps: 17 | Train Loss: 5.107 Vali Loss: 9.317 Vali Acc: 0.274 Test Loss: 9.317 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6741375923156738
Epoch: 3, Steps: 17 | Train Loss: 6.182 Vali Loss: 5.155 Vali Acc: 0.266 Test Loss: 5.155 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.722266435623169
Epoch: 4, Steps: 17 | Train Loss: 6.139 Vali Loss: 11.020 Vali Acc: 0.232 Test Loss: 11.020 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5996406078338623
Epoch: 5, Steps: 17 | Train Loss: 6.859 Vali Loss: 8.614 Vali Acc: 0.262 Test Loss: 8.614 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8575305938720703
Epoch: 6, Steps: 17 | Train Loss: 8.940 Vali Loss: 15.609 Vali Acc: 0.232 Test Loss: 15.609 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8603436946868896
Epoch: 7, Steps: 17 | Train Loss: 7.722 Vali Loss: 13.366 Vali Acc: 0.255 Test Loss: 13.366 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.6940932273864746
Epoch: 8, Steps: 17 | Train Loss: 4.852 Vali Loss: 10.114 Vali Acc: 0.278 Test Loss: 10.114 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6446936130523682
Epoch: 9, Steps: 17 | Train Loss: 8.560 Vali Loss: 9.007 Vali Acc: 0.274 Test Loss: 9.007 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.7289788722991943
Epoch: 10, Steps: 17 | Train Loss: 6.002 Vali Loss: 7.427 Vali Acc: 0.274 Test Loss: 7.427 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.6699132919311523
Epoch: 11, Steps: 17 | Train Loss: 4.077 Vali Loss: 7.013 Vali Acc: 0.262 Test Loss: 7.013 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs876_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3113760
model size : 11.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs584_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0670547485351562
Epoch: 1, Steps: 17 | Train Loss: 3.683 Vali Loss: 3.327 Vali Acc: 0.247 Test Loss: 3.327 Test Acc: 0.247
Validation loss decreased (inf --> -0.247115).  Saving model ...
Epoch: 2 cost time: 0.6866681575775146
Epoch: 2, Steps: 17 | Train Loss: 4.137 Vali Loss: 7.888 Vali Acc: 0.259 Test Loss: 7.888 Test Acc: 0.259
Validation loss decreased (-0.247115 --> -0.258476).  Saving model ...
Epoch: 3 cost time: 0.7300198078155518
Epoch: 3, Steps: 17 | Train Loss: 5.736 Vali Loss: 8.073 Vali Acc: 0.262 Test Loss: 8.073 Test Acc: 0.262
Validation loss decreased (-0.258476 --> -0.262277).  Saving model ...
Epoch: 4 cost time: 0.6811800003051758
Epoch: 4, Steps: 17 | Train Loss: 4.948 Vali Loss: 6.953 Vali Acc: 0.285 Test Loss: 6.953 Test Acc: 0.285
Validation loss decreased (-0.262277 --> -0.285102).  Saving model ...
Epoch: 5 cost time: 0.6575222015380859
Epoch: 5, Steps: 17 | Train Loss: 8.298 Vali Loss: 10.069 Vali Acc: 0.266 Test Loss: 10.069 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7795469760894775
Epoch: 6, Steps: 17 | Train Loss: 6.157 Vali Loss: 19.627 Vali Acc: 0.243 Test Loss: 19.627 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6962292194366455
Epoch: 7, Steps: 17 | Train Loss: 8.636 Vali Loss: 11.859 Vali Acc: 0.255 Test Loss: 11.859 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5950720310211182
Epoch: 8, Steps: 17 | Train Loss: 6.693 Vali Loss: 16.029 Vali Acc: 0.255 Test Loss: 16.029 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.7470638751983643
Epoch: 9, Steps: 17 | Train Loss: 4.920 Vali Loss: 12.472 Vali Acc: 0.251 Test Loss: 12.472 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7362761497497559
Epoch: 10, Steps: 17 | Train Loss: 4.509 Vali Loss: 6.190 Vali Acc: 0.236 Test Loss: 6.190 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7719054222106934
Epoch: 11, Steps: 17 | Train Loss: 3.781 Vali Loss: 8.461 Vali Acc: 0.251 Test Loss: 8.461 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.801220178604126
Epoch: 12, Steps: 17 | Train Loss: 3.466 Vali Loss: 7.238 Vali Acc: 0.251 Test Loss: 7.238 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.6657919883728027
Epoch: 13, Steps: 17 | Train Loss: 3.833 Vali Loss: 6.725 Vali Acc: 0.236 Test Loss: 6.725 Test Acc: 0.236
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.7019507884979248
Epoch: 14, Steps: 17 | Train Loss: 3.150 Vali Loss: 5.429 Vali Acc: 0.285 Test Loss: 5.429 Test Acc: 0.285
Validation loss decreased (-0.285102 --> -0.285117).  Saving model ...
Epoch: 15 cost time: 0.7105653285980225
Epoch: 15, Steps: 17 | Train Loss: 3.169 Vali Loss: 8.080 Vali Acc: 0.278 Test Loss: 8.080 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7718920707702637
Epoch: 16, Steps: 17 | Train Loss: 3.250 Vali Loss: 3.219 Vali Acc: 0.323 Test Loss: 3.219 Test Acc: 0.323
Validation loss decreased (-0.285117 --> -0.323162).  Saving model ...
Epoch: 17 cost time: 0.7462258338928223
Epoch: 17, Steps: 17 | Train Loss: 2.069 Vali Loss: 5.570 Vali Acc: 0.266 Test Loss: 5.570 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7646689414978027
Epoch: 18, Steps: 17 | Train Loss: 2.608 Vali Loss: 5.849 Vali Acc: 0.262 Test Loss: 5.849 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8317434787750244
Epoch: 19, Steps: 17 | Train Loss: 1.590 Vali Loss: 8.445 Vali Acc: 0.232 Test Loss: 8.445 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6386849880218506
Epoch: 20, Steps: 17 | Train Loss: 3.511 Vali Loss: 6.652 Vali Acc: 0.247 Test Loss: 6.652 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8531670570373535
Epoch: 21, Steps: 17 | Train Loss: 2.968 Vali Loss: 5.552 Vali Acc: 0.270 Test Loss: 5.552 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9666268825531006
Epoch: 22, Steps: 17 | Train Loss: 2.021 Vali Loss: 6.611 Vali Acc: 0.251 Test Loss: 6.611 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0199956893920898
Epoch: 23, Steps: 17 | Train Loss: 3.031 Vali Loss: 5.865 Vali Acc: 0.274 Test Loss: 5.865 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7137191295623779
Epoch: 24, Steps: 17 | Train Loss: 3.292 Vali Loss: 7.082 Vali Acc: 0.262 Test Loss: 7.082 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8103411197662354
Epoch: 25, Steps: 17 | Train Loss: 2.621 Vali Loss: 11.991 Vali Acc: 0.247 Test Loss: 11.991 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9387791156768799
Epoch: 26, Steps: 17 | Train Loss: 5.050 Vali Loss: 9.624 Vali Acc: 0.259 Test Loss: 9.624 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs584_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 3109102
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs438_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9845514297485352
Epoch: 1, Steps: 17 | Train Loss: 5.330 Vali Loss: 8.565 Vali Acc: 0.255 Test Loss: 8.565 Test Acc: 0.255
Validation loss decreased (inf --> -0.254667).  Saving model ...
Epoch: 2 cost time: 0.859065055847168
Epoch: 2, Steps: 17 | Train Loss: 4.250 Vali Loss: 6.884 Vali Acc: 0.262 Test Loss: 6.884 Test Acc: 0.262
Validation loss decreased (-0.254667 --> -0.262289).  Saving model ...
Epoch: 3 cost time: 0.6732594966888428
Epoch: 3, Steps: 17 | Train Loss: 4.763 Vali Loss: 9.273 Vali Acc: 0.259 Test Loss: 9.273 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8158493041992188
Epoch: 4, Steps: 17 | Train Loss: 5.126 Vali Loss: 10.644 Vali Acc: 0.255 Test Loss: 10.644 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8400418758392334
Epoch: 5, Steps: 17 | Train Loss: 6.887 Vali Loss: 13.267 Vali Acc: 0.251 Test Loss: 13.267 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7572896480560303
Epoch: 6, Steps: 17 | Train Loss: 7.122 Vali Loss: 14.260 Vali Acc: 0.251 Test Loss: 14.260 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.909548282623291
Epoch: 7, Steps: 17 | Train Loss: 7.245 Vali Loss: 7.000 Vali Acc: 0.240 Test Loss: 7.000 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7325043678283691
Epoch: 8, Steps: 17 | Train Loss: 6.298 Vali Loss: 8.873 Vali Acc: 0.236 Test Loss: 8.873 Test Acc: 0.236
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9093561172485352
Epoch: 9, Steps: 17 | Train Loss: 5.484 Vali Loss: 8.255 Vali Acc: 0.285 Test Loss: 8.255 Test Acc: 0.285
Validation loss decreased (-0.262289 --> -0.285089).  Saving model ...
Epoch: 10 cost time: 0.765972375869751
Epoch: 10, Steps: 17 | Train Loss: 5.128 Vali Loss: 9.287 Vali Acc: 0.259 Test Loss: 9.287 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7933766841888428
Epoch: 11, Steps: 17 | Train Loss: 5.196 Vali Loss: 7.716 Vali Acc: 0.262 Test Loss: 7.716 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7716286182403564
Epoch: 12, Steps: 17 | Train Loss: 3.460 Vali Loss: 12.719 Vali Acc: 0.243 Test Loss: 12.719 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7530577182769775
Epoch: 13, Steps: 17 | Train Loss: 3.810 Vali Loss: 6.587 Vali Acc: 0.228 Test Loss: 6.587 Test Acc: 0.228
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8731899261474609
Epoch: 14, Steps: 17 | Train Loss: 3.230 Vali Loss: 4.079 Vali Acc: 0.243 Test Loss: 4.079 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7056353092193604
Epoch: 15, Steps: 17 | Train Loss: 2.755 Vali Loss: 4.224 Vali Acc: 0.247 Test Loss: 4.224 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7640249729156494
Epoch: 16, Steps: 17 | Train Loss: 2.618 Vali Loss: 6.013 Vali Acc: 0.285 Test Loss: 6.013 Test Acc: 0.285
Validation loss decreased (-0.285089 --> -0.285111).  Saving model ...
Epoch: 17 cost time: 0.7688331604003906
Epoch: 17, Steps: 17 | Train Loss: 3.131 Vali Loss: 4.680 Vali Acc: 0.262 Test Loss: 4.680 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7922244071960449
Epoch: 18, Steps: 17 | Train Loss: 2.936 Vali Loss: 3.803 Vali Acc: 0.274 Test Loss: 3.803 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7164695262908936
Epoch: 19, Steps: 17 | Train Loss: 2.421 Vali Loss: 11.350 Vali Acc: 0.255 Test Loss: 11.350 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.781304121017456
Epoch: 20, Steps: 17 | Train Loss: 5.390 Vali Loss: 5.200 Vali Acc: 0.262 Test Loss: 5.200 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7366194725036621
Epoch: 21, Steps: 17 | Train Loss: 2.075 Vali Loss: 7.981 Vali Acc: 0.270 Test Loss: 7.981 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6039576530456543
Epoch: 22, Steps: 17 | Train Loss: 3.447 Vali Loss: 6.535 Vali Acc: 0.243 Test Loss: 6.535 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7856912612915039
Epoch: 23, Steps: 17 | Train Loss: 3.765 Vali Loss: 5.443 Vali Acc: 0.262 Test Loss: 5.443 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.8592228889465332
Epoch: 24, Steps: 17 | Train Loss: 3.494 Vali Loss: 7.848 Vali Acc: 0.247 Test Loss: 7.848 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7898058891296387
Epoch: 25, Steps: 17 | Train Loss: 3.530 Vali Loss: 9.026 Vali Acc: 0.278 Test Loss: 9.026 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7939634323120117
Epoch: 26, Steps: 17 | Train Loss: 2.833 Vali Loss: 8.121 Vali Acc: 0.266 Test Loss: 8.121 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs438_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3106784
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs351_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.085064649581909
Epoch: 1, Steps: 17 | Train Loss: 6.238 Vali Loss: 6.097 Vali Acc: 0.281 Test Loss: 6.097 Test Acc: 0.281
Validation loss decreased (inf --> -0.281308).  Saving model ...
Epoch: 2 cost time: 0.7149801254272461
Epoch: 2, Steps: 17 | Train Loss: 5.347 Vali Loss: 3.969 Vali Acc: 0.255 Test Loss: 3.969 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8704080581665039
Epoch: 3, Steps: 17 | Train Loss: 6.292 Vali Loss: 11.875 Vali Acc: 0.259 Test Loss: 11.875 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8134610652923584
Epoch: 4, Steps: 17 | Train Loss: 5.898 Vali Loss: 8.337 Vali Acc: 0.274 Test Loss: 8.337 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.740394115447998
Epoch: 5, Steps: 17 | Train Loss: 5.386 Vali Loss: 18.225 Vali Acc: 0.251 Test Loss: 18.225 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.8817830085754395
Epoch: 6, Steps: 17 | Train Loss: 7.097 Vali Loss: 5.734 Vali Acc: 0.281 Test Loss: 5.734 Test Acc: 0.281
Validation loss decreased (-0.281308 --> -0.281311).  Saving model ...
Epoch: 7 cost time: 0.779160737991333
Epoch: 7, Steps: 17 | Train Loss: 6.106 Vali Loss: 8.908 Vali Acc: 0.247 Test Loss: 8.908 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7840840816497803
Epoch: 8, Steps: 17 | Train Loss: 4.417 Vali Loss: 15.628 Vali Acc: 0.247 Test Loss: 15.628 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7331314086914062
Epoch: 9, Steps: 17 | Train Loss: 6.954 Vali Loss: 11.378 Vali Acc: 0.262 Test Loss: 11.378 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7721560001373291
Epoch: 10, Steps: 17 | Train Loss: 6.426 Vali Loss: 15.337 Vali Acc: 0.266 Test Loss: 15.337 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7921276092529297
Epoch: 11, Steps: 17 | Train Loss: 6.036 Vali Loss: 9.291 Vali Acc: 0.281 Test Loss: 9.291 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6910073757171631
Epoch: 12, Steps: 17 | Train Loss: 3.674 Vali Loss: 8.442 Vali Acc: 0.262 Test Loss: 8.442 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7506802082061768
Epoch: 13, Steps: 17 | Train Loss: 4.373 Vali Loss: 7.194 Vali Acc: 0.266 Test Loss: 7.194 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7275993824005127
Epoch: 14, Steps: 17 | Train Loss: 2.994 Vali Loss: 6.766 Vali Acc: 0.232 Test Loss: 6.766 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.875373363494873
Epoch: 15, Steps: 17 | Train Loss: 2.844 Vali Loss: 4.603 Vali Acc: 0.240 Test Loss: 4.603 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6136801242828369
Epoch: 16, Steps: 17 | Train Loss: 2.053 Vali Loss: 5.454 Vali Acc: 0.270 Test Loss: 5.454 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs351_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3110667
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs292_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2296578884124756
Epoch: 1, Steps: 17 | Train Loss: 3.395 Vali Loss: 6.112 Vali Acc: 0.243 Test Loss: 6.112 Test Acc: 0.243
Validation loss decreased (inf --> -0.243285).  Saving model ...
Epoch: 2 cost time: 0.6851198673248291
Epoch: 2, Steps: 17 | Train Loss: 5.117 Vali Loss: 5.868 Vali Acc: 0.224 Test Loss: 5.868 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7660140991210938
Epoch: 3, Steps: 17 | Train Loss: 4.926 Vali Loss: 6.444 Vali Acc: 0.259 Test Loss: 6.444 Test Acc: 0.259
Validation loss decreased (-0.243285 --> -0.258491).  Saving model ...
Epoch: 4 cost time: 0.7794444561004639
Epoch: 4, Steps: 17 | Train Loss: 6.782 Vali Loss: 14.782 Vali Acc: 0.266 Test Loss: 14.782 Test Acc: 0.266
Validation loss decreased (-0.258491 --> -0.266012).  Saving model ...
Epoch: 5 cost time: 0.7854664325714111
Epoch: 5, Steps: 17 | Train Loss: 6.994 Vali Loss: 12.164 Vali Acc: 0.251 Test Loss: 12.164 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6938035488128662
Epoch: 6, Steps: 17 | Train Loss: 6.221 Vali Loss: 7.861 Vali Acc: 0.221 Test Loss: 7.861 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7017102241516113
Epoch: 7, Steps: 17 | Train Loss: 8.618 Vali Loss: 15.782 Vali Acc: 0.243 Test Loss: 15.782 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8637609481811523
Epoch: 8, Steps: 17 | Train Loss: 8.989 Vali Loss: 10.183 Vali Acc: 0.251 Test Loss: 10.183 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.6473057270050049
Epoch: 9, Steps: 17 | Train Loss: 5.770 Vali Loss: 13.895 Vali Acc: 0.262 Test Loss: 13.895 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.7004673480987549
Epoch: 10, Steps: 17 | Train Loss: 6.533 Vali Loss: 8.194 Vali Acc: 0.243 Test Loss: 8.194 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7939529418945312
Epoch: 11, Steps: 17 | Train Loss: 4.109 Vali Loss: 8.002 Vali Acc: 0.270 Test Loss: 8.002 Test Acc: 0.270
Validation loss decreased (-0.266012 --> -0.269882).  Saving model ...
Epoch: 12 cost time: 0.7919154167175293
Epoch: 12, Steps: 17 | Train Loss: 4.600 Vali Loss: 6.147 Vali Acc: 0.266 Test Loss: 6.147 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7679455280303955
Epoch: 13, Steps: 17 | Train Loss: 3.287 Vali Loss: 9.704 Vali Acc: 0.251 Test Loss: 9.704 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7497434616088867
Epoch: 14, Steps: 17 | Train Loss: 5.528 Vali Loss: 7.515 Vali Acc: 0.281 Test Loss: 7.515 Test Acc: 0.281
Validation loss decreased (-0.269882 --> -0.281294).  Saving model ...
Epoch: 15 cost time: 0.7776956558227539
Epoch: 15, Steps: 17 | Train Loss: 2.315 Vali Loss: 5.321 Vali Acc: 0.243 Test Loss: 5.321 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7458951473236084
Epoch: 16, Steps: 17 | Train Loss: 2.732 Vali Loss: 6.790 Vali Acc: 0.281 Test Loss: 6.790 Test Acc: 0.281
Validation loss decreased (-0.281294 --> -0.281301).  Saving model ...
Epoch: 17 cost time: 0.7366223335266113
Epoch: 17, Steps: 17 | Train Loss: 2.790 Vali Loss: 7.134 Vali Acc: 0.232 Test Loss: 7.134 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8767602443695068
Epoch: 18, Steps: 17 | Train Loss: 2.781 Vali Loss: 4.577 Vali Acc: 0.251 Test Loss: 4.577 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7885165214538574
Epoch: 19, Steps: 17 | Train Loss: 2.461 Vali Loss: 5.705 Vali Acc: 0.255 Test Loss: 5.705 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8130123615264893
Epoch: 20, Steps: 17 | Train Loss: 2.608 Vali Loss: 5.651 Vali Acc: 0.266 Test Loss: 5.651 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6550662517547607
Epoch: 21, Steps: 17 | Train Loss: 3.302 Vali Loss: 3.964 Vali Acc: 0.236 Test Loss: 3.964 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7691512107849121
Epoch: 22, Steps: 17 | Train Loss: 3.272 Vali Loss: 5.787 Vali Acc: 0.278 Test Loss: 5.787 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7062571048736572
Epoch: 23, Steps: 17 | Train Loss: 2.004 Vali Loss: 6.306 Vali Acc: 0.289 Test Loss: 6.306 Test Acc: 0.289
Validation loss decreased (-0.281301 --> -0.288910).  Saving model ...
Epoch: 24 cost time: 0.7224175930023193
Epoch: 24, Steps: 17 | Train Loss: 2.075 Vali Loss: 6.256 Vali Acc: 0.247 Test Loss: 6.256 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.684497594833374
Epoch: 25, Steps: 17 | Train Loss: 2.750 Vali Loss: 8.415 Vali Acc: 0.247 Test Loss: 8.415 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7465512752532959
Epoch: 26, Steps: 17 | Train Loss: 3.007 Vali Loss: 5.913 Vali Acc: 0.289 Test Loss: 5.913 Test Acc: 0.289
Validation loss decreased (-0.288910 --> -0.288914).  Saving model ...
Epoch: 27 cost time: 0.721625804901123
Epoch: 27, Steps: 17 | Train Loss: 1.978 Vali Loss: 7.760 Vali Acc: 0.228 Test Loss: 7.760 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9408125877380371
Epoch: 28, Steps: 17 | Train Loss: 3.106 Vali Loss: 8.357 Vali Acc: 0.232 Test Loss: 8.357 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0819900035858154
Epoch: 29, Steps: 17 | Train Loss: 2.579 Vali Loss: 7.314 Vali Acc: 0.247 Test Loss: 7.314 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9878630638122559
Epoch: 30, Steps: 17 | Train Loss: 2.824 Vali Loss: 9.030 Vali Acc: 0.316 Test Loss: 9.030 Test Acc: 0.316
Validation loss decreased (-0.288914 --> -0.315499).  Saving model ...
Epoch: 31 cost time: 0.7920522689819336
Epoch: 31, Steps: 17 | Train Loss: 3.944 Vali Loss: 5.630 Vali Acc: 0.251 Test Loss: 5.630 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9441289901733398
Epoch: 32, Steps: 17 | Train Loss: 3.211 Vali Loss: 7.398 Vali Acc: 0.259 Test Loss: 7.398 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9207007884979248
Epoch: 33, Steps: 17 | Train Loss: 5.007 Vali Loss: 9.845 Vali Acc: 0.262 Test Loss: 9.845 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8505845069885254
Epoch: 34, Steps: 17 | Train Loss: 2.887 Vali Loss: 5.023 Vali Acc: 0.300 Test Loss: 5.023 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8013758659362793
Epoch: 35, Steps: 17 | Train Loss: 2.642 Vali Loss: 8.545 Vali Acc: 0.262 Test Loss: 8.545 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9888782501220703
Epoch: 36, Steps: 17 | Train Loss: 2.468 Vali Loss: 7.675 Vali Acc: 0.247 Test Loss: 7.675 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8115425109863281
Epoch: 37, Steps: 17 | Train Loss: 2.736 Vali Loss: 5.625 Vali Acc: 0.289 Test Loss: 5.625 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9481194019317627
Epoch: 38, Steps: 17 | Train Loss: 3.258 Vali Loss: 12.199 Vali Acc: 0.266 Test Loss: 12.199 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9355008602142334
Epoch: 39, Steps: 17 | Train Loss: 2.595 Vali Loss: 9.848 Vali Acc: 0.247 Test Loss: 9.848 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9456543922424316
Epoch: 40, Steps: 17 | Train Loss: 3.951 Vali Loss: 12.271 Vali Acc: 0.262 Test Loss: 12.271 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs292_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 3104496
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs251_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9454891681671143
Epoch: 1, Steps: 17 | Train Loss: 3.824 Vali Loss: 3.900 Vali Acc: 0.304 Test Loss: 3.900 Test Acc: 0.304
Validation loss decreased (inf --> -0.304144).  Saving model ...
Epoch: 2 cost time: 0.7589130401611328
Epoch: 2, Steps: 17 | Train Loss: 4.619 Vali Loss: 8.811 Vali Acc: 0.266 Test Loss: 8.811 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7024261951446533
Epoch: 3, Steps: 17 | Train Loss: 6.530 Vali Loss: 8.828 Vali Acc: 0.259 Test Loss: 8.828 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6858208179473877
Epoch: 4, Steps: 17 | Train Loss: 5.978 Vali Loss: 6.571 Vali Acc: 0.224 Test Loss: 6.571 Test Acc: 0.224
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5793793201446533
Epoch: 5, Steps: 17 | Train Loss: 4.623 Vali Loss: 14.499 Vali Acc: 0.247 Test Loss: 14.499 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.7261195182800293
Epoch: 6, Steps: 17 | Train Loss: 8.245 Vali Loss: 15.830 Vali Acc: 0.247 Test Loss: 15.830 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.6535687446594238
Epoch: 7, Steps: 17 | Train Loss: 9.769 Vali Loss: 19.883 Vali Acc: 0.259 Test Loss: 19.883 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.777848482131958
Epoch: 8, Steps: 17 | Train Loss: 10.840 Vali Loss: 10.150 Vali Acc: 0.262 Test Loss: 10.150 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.7100820541381836
Epoch: 9, Steps: 17 | Train Loss: 6.338 Vali Loss: 15.868 Vali Acc: 0.259 Test Loss: 15.868 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6729738712310791
Epoch: 10, Steps: 17 | Train Loss: 3.830 Vali Loss: 6.352 Vali Acc: 0.278 Test Loss: 6.352 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.673194169998169
Epoch: 11, Steps: 17 | Train Loss: 2.804 Vali Loss: 5.851 Vali Acc: 0.236 Test Loss: 5.851 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs251_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 3112625
model size : 11.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs219_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.307119131088257
Epoch: 1, Steps: 17 | Train Loss: 4.463 Vali Loss: 7.346 Vali Acc: 0.266 Test Loss: 7.346 Test Acc: 0.266
Validation loss decreased (inf --> -0.266086).  Saving model ...
Epoch: 2 cost time: 0.8060438632965088
Epoch: 2, Steps: 17 | Train Loss: 4.409 Vali Loss: 4.378 Vali Acc: 0.247 Test Loss: 4.378 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6646254062652588
Epoch: 3, Steps: 17 | Train Loss: 4.064 Vali Loss: 9.290 Vali Acc: 0.259 Test Loss: 9.290 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7174351215362549
Epoch: 4, Steps: 17 | Train Loss: 5.815 Vali Loss: 11.064 Vali Acc: 0.255 Test Loss: 11.064 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8320784568786621
Epoch: 5, Steps: 17 | Train Loss: 4.585 Vali Loss: 12.351 Vali Acc: 0.232 Test Loss: 12.351 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6828422546386719
Epoch: 6, Steps: 17 | Train Loss: 7.543 Vali Loss: 12.889 Vali Acc: 0.240 Test Loss: 12.889 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.8945178985595703
Epoch: 7, Steps: 17 | Train Loss: 6.627 Vali Loss: 13.278 Vali Acc: 0.255 Test Loss: 13.278 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9596259593963623
Epoch: 8, Steps: 17 | Train Loss: 7.035 Vali Loss: 7.375 Vali Acc: 0.236 Test Loss: 7.375 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.8349056243896484
Epoch: 9, Steps: 17 | Train Loss: 4.723 Vali Loss: 8.454 Vali Acc: 0.251 Test Loss: 8.454 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.8653032779693604
Epoch: 10, Steps: 17 | Train Loss: 3.670 Vali Loss: 8.629 Vali Acc: 0.259 Test Loss: 8.629 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.7148041725158691
Epoch: 11, Steps: 17 | Train Loss: 4.013 Vali Loss: 4.758 Vali Acc: 0.293 Test Loss: 4.758 Test Acc: 0.293
Validation loss decreased (-0.266086 --> -0.292728).  Saving model ...
Epoch: 12 cost time: 0.853351354598999
Epoch: 12, Steps: 17 | Train Loss: 2.783 Vali Loss: 5.258 Vali Acc: 0.262 Test Loss: 5.258 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8862471580505371
Epoch: 13, Steps: 17 | Train Loss: 3.949 Vali Loss: 6.437 Vali Acc: 0.274 Test Loss: 6.437 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7921786308288574
Epoch: 14, Steps: 17 | Train Loss: 3.836 Vali Loss: 5.826 Vali Acc: 0.236 Test Loss: 5.826 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7536077499389648
Epoch: 15, Steps: 17 | Train Loss: 2.937 Vali Loss: 5.814 Vali Acc: 0.247 Test Loss: 5.814 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8287270069122314
Epoch: 16, Steps: 17 | Train Loss: 3.088 Vali Loss: 7.248 Vali Acc: 0.232 Test Loss: 7.248 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.936164379119873
Epoch: 17, Steps: 17 | Train Loss: 4.853 Vali Loss: 7.029 Vali Acc: 0.221 Test Loss: 7.029 Test Acc: 0.221
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7242093086242676
Epoch: 18, Steps: 17 | Train Loss: 2.886 Vali Loss: 6.105 Vali Acc: 0.297 Test Loss: 6.105 Test Acc: 0.297
Validation loss decreased (-0.292728 --> -0.296517).  Saving model ...
Epoch: 19 cost time: 0.7672650814056396
Epoch: 19, Steps: 17 | Train Loss: 3.475 Vali Loss: 4.832 Vali Acc: 0.243 Test Loss: 4.832 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.685927152633667
Epoch: 20, Steps: 17 | Train Loss: 2.786 Vali Loss: 7.021 Vali Acc: 0.240 Test Loss: 7.021 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7661159038543701
Epoch: 21, Steps: 17 | Train Loss: 3.937 Vali Loss: 6.451 Vali Acc: 0.243 Test Loss: 6.451 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6416809558868408
Epoch: 22, Steps: 17 | Train Loss: 3.612 Vali Loss: 8.033 Vali Acc: 0.243 Test Loss: 8.033 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.845573902130127
Epoch: 23, Steps: 17 | Train Loss: 4.035 Vali Loss: 8.489 Vali Acc: 0.274 Test Loss: 8.489 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7313988208770752
Epoch: 24, Steps: 17 | Train Loss: 2.261 Vali Loss: 5.996 Vali Acc: 0.278 Test Loss: 5.996 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8219373226165771
Epoch: 25, Steps: 17 | Train Loss: 2.702 Vali Loss: 8.320 Vali Acc: 0.259 Test Loss: 8.320 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7497613430023193
Epoch: 26, Steps: 17 | Train Loss: 3.344 Vali Loss: 12.525 Vali Acc: 0.281 Test Loss: 12.525 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7531030178070068
Epoch: 27, Steps: 17 | Train Loss: 5.185 Vali Loss: 7.207 Vali Acc: 0.228 Test Loss: 7.207 Test Acc: 0.228
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7496578693389893
Epoch: 28, Steps: 17 | Train Loss: 2.317 Vali Loss: 7.662 Vali Acc: 0.240 Test Loss: 7.662 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs219_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3103392
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs195_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.019254684448242
Epoch: 1, Steps: 17 | Train Loss: 3.646 Vali Loss: 3.894 Vali Acc: 0.236 Test Loss: 3.894 Test Acc: 0.236
Validation loss decreased (inf --> -0.235703).  Saving model ...
Epoch: 2 cost time: 0.6760082244873047
Epoch: 2, Steps: 17 | Train Loss: 4.090 Vali Loss: 5.037 Vali Acc: 0.316 Test Loss: 5.037 Test Acc: 0.316
Validation loss decreased (-0.235703 --> -0.315539).  Saving model ...
Epoch: 3 cost time: 0.7816717624664307
Epoch: 3, Steps: 17 | Train Loss: 5.124 Vali Loss: 6.301 Vali Acc: 0.236 Test Loss: 6.301 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8555872440338135
Epoch: 4, Steps: 17 | Train Loss: 5.357 Vali Loss: 9.245 Vali Acc: 0.259 Test Loss: 9.245 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7045323848724365
Epoch: 5, Steps: 17 | Train Loss: 7.493 Vali Loss: 11.578 Vali Acc: 0.266 Test Loss: 11.578 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9043409824371338
Epoch: 6, Steps: 17 | Train Loss: 11.559 Vali Loss: 13.818 Vali Acc: 0.255 Test Loss: 13.818 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7225809097290039
Epoch: 7, Steps: 17 | Train Loss: 5.960 Vali Loss: 6.971 Vali Acc: 0.319 Test Loss: 6.971 Test Acc: 0.319
Validation loss decreased (-0.315539 --> -0.319322).  Saving model ...
Epoch: 8 cost time: 0.827594518661499
Epoch: 8, Steps: 17 | Train Loss: 4.403 Vali Loss: 16.692 Vali Acc: 0.255 Test Loss: 16.692 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7084858417510986
Epoch: 9, Steps: 17 | Train Loss: 6.988 Vali Loss: 10.855 Vali Acc: 0.255 Test Loss: 10.855 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8146700859069824
Epoch: 10, Steps: 17 | Train Loss: 5.496 Vali Loss: 10.232 Vali Acc: 0.232 Test Loss: 10.232 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7513303756713867
Epoch: 11, Steps: 17 | Train Loss: 5.039 Vali Loss: 8.524 Vali Acc: 0.217 Test Loss: 8.524 Test Acc: 0.217
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7282671928405762
Epoch: 12, Steps: 17 | Train Loss: 2.873 Vali Loss: 7.013 Vali Acc: 0.247 Test Loss: 7.013 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6819765567779541
Epoch: 13, Steps: 17 | Train Loss: 3.271 Vali Loss: 6.725 Vali Acc: 0.266 Test Loss: 6.725 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.8140144348144531
Epoch: 14, Steps: 17 | Train Loss: 2.757 Vali Loss: 5.374 Vali Acc: 0.255 Test Loss: 5.374 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7818379402160645
Epoch: 15, Steps: 17 | Train Loss: 3.486 Vali Loss: 7.264 Vali Acc: 0.281 Test Loss: 7.264 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7653164863586426
Epoch: 16, Steps: 17 | Train Loss: 2.599 Vali Loss: 9.858 Vali Acc: 0.232 Test Loss: 9.858 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.909783124923706
Epoch: 17, Steps: 17 | Train Loss: 3.253 Vali Loss: 7.496 Vali Acc: 0.247 Test Loss: 7.496 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs195_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3193916349809886
model parameter : 3108299
model size : 11.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs176_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.959914207458496
Epoch: 1, Steps: 17 | Train Loss: 5.050 Vali Loss: 3.340 Vali Acc: 0.243 Test Loss: 3.340 Test Acc: 0.243
Validation loss decreased (inf --> -0.243313).  Saving model ...
Epoch: 2 cost time: 0.8394062519073486
Epoch: 2, Steps: 17 | Train Loss: 7.109 Vali Loss: 5.556 Vali Acc: 0.259 Test Loss: 5.556 Test Acc: 0.259
Validation loss decreased (-0.243313 --> -0.258500).  Saving model ...
Epoch: 3 cost time: 0.810314416885376
Epoch: 3, Steps: 17 | Train Loss: 7.658 Vali Loss: 8.010 Vali Acc: 0.281 Test Loss: 8.010 Test Acc: 0.281
Validation loss decreased (-0.258500 --> -0.281289).  Saving model ...
Epoch: 4 cost time: 0.8941135406494141
Epoch: 4, Steps: 17 | Train Loss: 6.979 Vali Loss: 9.535 Vali Acc: 0.255 Test Loss: 9.535 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7579271793365479
Epoch: 5, Steps: 17 | Train Loss: 7.559 Vali Loss: 15.885 Vali Acc: 0.262 Test Loss: 15.885 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9029772281646729
Epoch: 6, Steps: 17 | Train Loss: 9.256 Vali Loss: 10.078 Vali Acc: 0.289 Test Loss: 10.078 Test Acc: 0.289
Validation loss decreased (-0.281289 --> -0.288873).  Saving model ...
Epoch: 7 cost time: 0.7097198963165283
Epoch: 7, Steps: 17 | Train Loss: 6.764 Vali Loss: 14.989 Vali Acc: 0.236 Test Loss: 14.989 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8260481357574463
Epoch: 8, Steps: 17 | Train Loss: 5.150 Vali Loss: 8.441 Vali Acc: 0.243 Test Loss: 8.441 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8381903171539307
Epoch: 9, Steps: 17 | Train Loss: 5.949 Vali Loss: 12.666 Vali Acc: 0.240 Test Loss: 12.666 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8025305271148682
Epoch: 10, Steps: 17 | Train Loss: 5.048 Vali Loss: 5.124 Vali Acc: 0.251 Test Loss: 5.124 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8767387866973877
Epoch: 11, Steps: 17 | Train Loss: 2.575 Vali Loss: 6.873 Vali Acc: 0.232 Test Loss: 6.873 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.913623571395874
Epoch: 12, Steps: 17 | Train Loss: 5.252 Vali Loss: 7.109 Vali Acc: 0.243 Test Loss: 7.109 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8004324436187744
Epoch: 13, Steps: 17 | Train Loss: 2.913 Vali Loss: 6.517 Vali Acc: 0.259 Test Loss: 6.517 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.8673632144927979
Epoch: 14, Steps: 17 | Train Loss: 3.310 Vali Loss: 7.708 Vali Acc: 0.205 Test Loss: 7.708 Test Acc: 0.205
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8333911895751953
Epoch: 15, Steps: 17 | Train Loss: 2.364 Vali Loss: 9.120 Vali Acc: 0.251 Test Loss: 9.120 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7907609939575195
Epoch: 16, Steps: 17 | Train Loss: 3.109 Vali Loss: 6.056 Vali Acc: 0.240 Test Loss: 6.056 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs176_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3116792
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.194528341293335
Epoch: 1, Steps: 17 | Train Loss: 4.483 Vali Loss: 7.786 Vali Acc: 0.251 Test Loss: 7.786 Test Acc: 0.251
Validation loss decreased (inf --> -0.250873).  Saving model ...
Epoch: 2 cost time: 0.7778911590576172
Epoch: 2, Steps: 17 | Train Loss: 5.716 Vali Loss: 5.863 Vali Acc: 0.247 Test Loss: 5.863 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9398984909057617
Epoch: 3, Steps: 17 | Train Loss: 4.242 Vali Loss: 4.797 Vali Acc: 0.247 Test Loss: 4.797 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7997481822967529
Epoch: 4, Steps: 17 | Train Loss: 4.865 Vali Loss: 6.527 Vali Acc: 0.255 Test Loss: 6.527 Test Acc: 0.255
Validation loss decreased (-0.250873 --> -0.254688).  Saving model ...
Epoch: 5 cost time: 1.0813815593719482
Epoch: 5, Steps: 17 | Train Loss: 4.691 Vali Loss: 10.150 Vali Acc: 0.240 Test Loss: 10.150 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9469337463378906
Epoch: 6, Steps: 17 | Train Loss: 7.904 Vali Loss: 12.119 Vali Acc: 0.247 Test Loss: 12.119 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0568604469299316
Epoch: 7, Steps: 17 | Train Loss: 6.957 Vali Loss: 14.342 Vali Acc: 0.262 Test Loss: 14.342 Test Acc: 0.262
Validation loss decreased (-0.254688 --> -0.262214).  Saving model ...
Epoch: 8 cost time: 1.1306827068328857
Epoch: 8, Steps: 17 | Train Loss: 11.075 Vali Loss: 21.118 Vali Acc: 0.251 Test Loss: 21.118 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7793188095092773
Epoch: 9, Steps: 17 | Train Loss: 9.152 Vali Loss: 12.848 Vali Acc: 0.262 Test Loss: 12.848 Test Acc: 0.262
Validation loss decreased (-0.262214 --> -0.262229).  Saving model ...
Epoch: 10 cost time: 0.8384110927581787
Epoch: 10, Steps: 17 | Train Loss: 5.201 Vali Loss: 5.470 Vali Acc: 0.251 Test Loss: 5.470 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0523321628570557
Epoch: 11, Steps: 17 | Train Loss: 2.852 Vali Loss: 8.151 Vali Acc: 0.259 Test Loss: 8.151 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9030840396881104
Epoch: 12, Steps: 17 | Train Loss: 2.903 Vali Loss: 8.604 Vali Acc: 0.289 Test Loss: 8.604 Test Acc: 0.289
Validation loss decreased (-0.262229 --> -0.288887).  Saving model ...
Epoch: 13 cost time: 0.9190056324005127
Epoch: 13, Steps: 17 | Train Loss: 3.720 Vali Loss: 5.848 Vali Acc: 0.240 Test Loss: 5.848 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.03419828414917
Epoch: 14, Steps: 17 | Train Loss: 2.490 Vali Loss: 5.132 Vali Acc: 0.266 Test Loss: 5.132 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9633533954620361
Epoch: 15, Steps: 17 | Train Loss: 3.525 Vali Loss: 4.856 Vali Acc: 0.247 Test Loss: 4.856 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7257294654846191
Epoch: 16, Steps: 17 | Train Loss: 2.154 Vali Loss: 9.082 Vali Acc: 0.240 Test Loss: 9.082 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7710130214691162
Epoch: 17, Steps: 17 | Train Loss: 3.557 Vali Loss: 6.560 Vali Acc: 0.243 Test Loss: 6.560 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8447887897491455
Epoch: 18, Steps: 17 | Train Loss: 2.345 Vali Loss: 4.782 Vali Acc: 0.281 Test Loss: 4.782 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7456557750701904
Epoch: 19, Steps: 17 | Train Loss: 3.877 Vali Loss: 10.405 Vali Acc: 0.247 Test Loss: 10.405 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8119964599609375
Epoch: 20, Steps: 17 | Train Loss: 3.659 Vali Loss: 5.620 Vali Acc: 0.224 Test Loss: 5.620 Test Acc: 0.224
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8900439739227295
Epoch: 21, Steps: 17 | Train Loss: 2.504 Vali Loss: 8.501 Vali Acc: 0.240 Test Loss: 8.501 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8367836475372314
Epoch: 22, Steps: 17 | Train Loss: 2.323 Vali Loss: 6.622 Vali Acc: 0.262 Test Loss: 6.622 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3116582
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs146_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.1347005367279053
Epoch: 1, Steps: 17 | Train Loss: 5.072 Vali Loss: 9.517 Vali Acc: 0.262 Test Loss: 9.517 Test Acc: 0.262
Validation loss decreased (inf --> -0.262262).  Saving model ...
Epoch: 2 cost time: 0.8271105289459229
Epoch: 2, Steps: 17 | Train Loss: 7.635 Vali Loss: 6.357 Vali Acc: 0.262 Test Loss: 6.357 Test Acc: 0.262
Validation loss decreased (-0.262262 --> -0.262294).  Saving model ...
Epoch: 3 cost time: 0.6988589763641357
Epoch: 3, Steps: 17 | Train Loss: 8.968 Vali Loss: 7.394 Vali Acc: 0.289 Test Loss: 7.394 Test Acc: 0.289
Validation loss decreased (-0.262294 --> -0.288899).  Saving model ...
Epoch: 4 cost time: 0.7282841205596924
Epoch: 4, Steps: 17 | Train Loss: 6.413 Vali Loss: 8.230 Vali Acc: 0.232 Test Loss: 8.230 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7130513191223145
Epoch: 5, Steps: 17 | Train Loss: 7.043 Vali Loss: 17.607 Vali Acc: 0.228 Test Loss: 17.607 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.7617592811584473
Epoch: 6, Steps: 17 | Train Loss: 11.490 Vali Loss: 10.619 Vali Acc: 0.247 Test Loss: 10.619 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8154022693634033
Epoch: 7, Steps: 17 | Train Loss: 5.944 Vali Loss: 9.486 Vali Acc: 0.243 Test Loss: 9.486 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8038489818572998
Epoch: 8, Steps: 17 | Train Loss: 3.820 Vali Loss: 9.033 Vali Acc: 0.262 Test Loss: 9.033 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7762975692749023
Epoch: 9, Steps: 17 | Train Loss: 6.870 Vali Loss: 10.798 Vali Acc: 0.259 Test Loss: 10.798 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6863119602203369
Epoch: 10, Steps: 17 | Train Loss: 5.021 Vali Loss: 8.744 Vali Acc: 0.247 Test Loss: 8.744 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.750786542892456
Epoch: 11, Steps: 17 | Train Loss: 3.500 Vali Loss: 5.556 Vali Acc: 0.262 Test Loss: 5.556 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.738847017288208
Epoch: 12, Steps: 17 | Train Loss: 3.061 Vali Loss: 5.331 Vali Acc: 0.232 Test Loss: 5.331 Test Acc: 0.232
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.6411697864532471
Epoch: 13, Steps: 17 | Train Loss: 2.520 Vali Loss: 3.830 Vali Acc: 0.236 Test Loss: 3.830 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs146_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 3102400
model size : 11.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs135_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.2260336875915527
Epoch: 1, Steps: 17 | Train Loss: 4.751 Vali Loss: 5.738 Vali Acc: 0.247 Test Loss: 5.738 Test Acc: 0.247
Validation loss decreased (inf --> -0.247091).  Saving model ...
Epoch: 2 cost time: 0.7359838485717773
Epoch: 2, Steps: 17 | Train Loss: 7.343 Vali Loss: 12.081 Vali Acc: 0.255 Test Loss: 12.081 Test Acc: 0.255
Validation loss decreased (-0.247091 --> -0.254632).  Saving model ...
Epoch: 3 cost time: 0.7865793704986572
Epoch: 3, Steps: 17 | Train Loss: 7.606 Vali Loss: 9.455 Vali Acc: 0.285 Test Loss: 9.455 Test Acc: 0.285
Validation loss decreased (-0.254632 --> -0.285077).  Saving model ...
Epoch: 4 cost time: 0.8695337772369385
Epoch: 4, Steps: 17 | Train Loss: 7.872 Vali Loss: 9.826 Vali Acc: 0.255 Test Loss: 9.826 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7288963794708252
Epoch: 5, Steps: 17 | Train Loss: 7.266 Vali Loss: 12.048 Vali Acc: 0.243 Test Loss: 12.048 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8201315402984619
Epoch: 6, Steps: 17 | Train Loss: 10.779 Vali Loss: 22.239 Vali Acc: 0.262 Test Loss: 22.239 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.7348415851593018
Epoch: 7, Steps: 17 | Train Loss: 7.736 Vali Loss: 12.936 Vali Acc: 0.221 Test Loss: 12.936 Test Acc: 0.221
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8054099082946777
Epoch: 8, Steps: 17 | Train Loss: 4.258 Vali Loss: 7.566 Vali Acc: 0.255 Test Loss: 7.566 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8464477062225342
Epoch: 9, Steps: 17 | Train Loss: 4.579 Vali Loss: 12.341 Vali Acc: 0.247 Test Loss: 12.341 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.6819295883178711
Epoch: 10, Steps: 17 | Train Loss: 5.463 Vali Loss: 11.286 Vali Acc: 0.270 Test Loss: 11.286 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.770442008972168
Epoch: 11, Steps: 17 | Train Loss: 3.975 Vali Loss: 5.145 Vali Acc: 0.262 Test Loss: 5.145 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.8015115261077881
Epoch: 12, Steps: 17 | Train Loss: 3.330 Vali Loss: 6.427 Vali Acc: 0.251 Test Loss: 6.427 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.7169609069824219
Epoch: 13, Steps: 17 | Train Loss: 4.102 Vali Loss: 6.083 Vali Acc: 0.255 Test Loss: 6.083 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs135_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3107531
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs126_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.9046576023101807
Epoch: 1, Steps: 17 | Train Loss: 4.575 Vali Loss: 5.108 Vali Acc: 0.255 Test Loss: 5.108 Test Acc: 0.255
Validation loss decreased (inf --> -0.254702).  Saving model ...
Epoch: 2 cost time: 0.704763650894165
Epoch: 2, Steps: 17 | Train Loss: 5.983 Vali Loss: 5.622 Vali Acc: 0.259 Test Loss: 5.622 Test Acc: 0.259
Validation loss decreased (-0.254702 --> -0.258499).  Saving model ...
Epoch: 3 cost time: 0.6452007293701172
Epoch: 3, Steps: 17 | Train Loss: 6.097 Vali Loss: 8.111 Vali Acc: 0.247 Test Loss: 8.111 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8544003963470459
Epoch: 4, Steps: 17 | Train Loss: 4.611 Vali Loss: 8.665 Vali Acc: 0.251 Test Loss: 8.665 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7688586711883545
Epoch: 5, Steps: 17 | Train Loss: 4.508 Vali Loss: 8.785 Vali Acc: 0.270 Test Loss: 8.785 Test Acc: 0.270
Validation loss decreased (-0.258499 --> -0.269874).  Saving model ...
Epoch: 6 cost time: 0.6193070411682129
Epoch: 6, Steps: 17 | Train Loss: 6.251 Vali Loss: 13.078 Vali Acc: 0.232 Test Loss: 13.078 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8729653358459473
Epoch: 7, Steps: 17 | Train Loss: 4.991 Vali Loss: 19.359 Vali Acc: 0.247 Test Loss: 19.359 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7287635803222656
Epoch: 8, Steps: 17 | Train Loss: 11.457 Vali Loss: 9.337 Vali Acc: 0.228 Test Loss: 9.337 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8454103469848633
Epoch: 9, Steps: 17 | Train Loss: 4.957 Vali Loss: 7.248 Vali Acc: 0.243 Test Loss: 7.248 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8007805347442627
Epoch: 10, Steps: 17 | Train Loss: 5.523 Vali Loss: 9.577 Vali Acc: 0.274 Test Loss: 9.577 Test Acc: 0.274
Validation loss decreased (-0.269874 --> -0.273668).  Saving model ...
Epoch: 11 cost time: 0.7216262817382812
Epoch: 11, Steps: 17 | Train Loss: 4.445 Vali Loss: 4.866 Vali Acc: 0.221 Test Loss: 4.866 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6899394989013672
Epoch: 12, Steps: 17 | Train Loss: 2.925 Vali Loss: 5.486 Vali Acc: 0.289 Test Loss: 5.486 Test Acc: 0.289
Validation loss decreased (-0.273668 --> -0.288919).  Saving model ...
Epoch: 13 cost time: 0.7211854457855225
Epoch: 13, Steps: 17 | Train Loss: 4.109 Vali Loss: 6.639 Vali Acc: 0.247 Test Loss: 6.639 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.735781192779541
Epoch: 14, Steps: 17 | Train Loss: 3.145 Vali Loss: 7.291 Vali Acc: 0.270 Test Loss: 7.291 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6725962162017822
Epoch: 15, Steps: 17 | Train Loss: 3.483 Vali Loss: 5.012 Vali Acc: 0.251 Test Loss: 5.012 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7754459381103516
Epoch: 16, Steps: 17 | Train Loss: 2.217 Vali Loss: 6.036 Vali Acc: 0.259 Test Loss: 6.036 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7801942825317383
Epoch: 17, Steps: 17 | Train Loss: 2.780 Vali Loss: 5.567 Vali Acc: 0.224 Test Loss: 5.567 Test Acc: 0.224
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6984028816223145
Epoch: 18, Steps: 17 | Train Loss: 2.340 Vali Loss: 5.273 Vali Acc: 0.278 Test Loss: 5.273 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7874636650085449
Epoch: 19, Steps: 17 | Train Loss: 2.054 Vali Loss: 4.929 Vali Acc: 0.270 Test Loss: 4.929 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7891092300415039
Epoch: 20, Steps: 17 | Train Loss: 2.575 Vali Loss: 5.345 Vali Acc: 0.232 Test Loss: 5.345 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6907405853271484
Epoch: 21, Steps: 17 | Train Loss: 2.448 Vali Loss: 5.759 Vali Acc: 0.316 Test Loss: 5.759 Test Acc: 0.316
Validation loss decreased (-0.288919 --> -0.315532).  Saving model ...
Epoch: 22 cost time: 0.7152960300445557
Epoch: 22, Steps: 17 | Train Loss: 2.704 Vali Loss: 5.493 Vali Acc: 0.247 Test Loss: 5.493 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8349514007568359
Epoch: 23, Steps: 17 | Train Loss: 2.061 Vali Loss: 5.180 Vali Acc: 0.285 Test Loss: 5.180 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6418852806091309
Epoch: 24, Steps: 17 | Train Loss: 2.359 Vali Loss: 5.628 Vali Acc: 0.270 Test Loss: 5.628 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7282564640045166
Epoch: 25, Steps: 17 | Train Loss: 2.927 Vali Loss: 9.198 Vali Acc: 0.240 Test Loss: 9.198 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7680222988128662
Epoch: 26, Steps: 17 | Train Loss: 2.237 Vali Loss: 6.191 Vali Acc: 0.281 Test Loss: 6.191 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7093946933746338
Epoch: 27, Steps: 17 | Train Loss: 3.762 Vali Loss: 7.151 Vali Acc: 0.232 Test Loss: 7.151 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6623518466949463
Epoch: 28, Steps: 17 | Train Loss: 2.653 Vali Loss: 6.445 Vali Acc: 0.259 Test Loss: 6.445 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6325054168701172
Epoch: 29, Steps: 17 | Train Loss: 3.091 Vali Loss: 7.563 Vali Acc: 0.259 Test Loss: 7.563 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7294282913208008
Epoch: 30, Steps: 17 | Train Loss: 2.639 Vali Loss: 5.470 Vali Acc: 0.262 Test Loss: 5.470 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7531719207763672
Epoch: 31, Steps: 17 | Train Loss: 1.953 Vali Loss: 5.507 Vali Acc: 0.278 Test Loss: 5.507 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs126_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 3123204
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs117_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 1.8627023696899414
Epoch: 1, Steps: 17 | Train Loss: 5.215 Vali Loss: 5.209 Vali Acc: 0.247 Test Loss: 5.209 Test Acc: 0.247
Validation loss decreased (inf --> -0.247096).  Saving model ...
Epoch: 2 cost time: 0.8073306083679199
Epoch: 2, Steps: 17 | Train Loss: 3.812 Vali Loss: 7.204 Vali Acc: 0.270 Test Loss: 7.204 Test Acc: 0.270
Validation loss decreased (-0.247096 --> -0.269890).  Saving model ...
Epoch: 3 cost time: 0.7214157581329346
Epoch: 3, Steps: 17 | Train Loss: 5.241 Vali Loss: 6.026 Vali Acc: 0.247 Test Loss: 6.026 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8452694416046143
Epoch: 4, Steps: 17 | Train Loss: 5.339 Vali Loss: 8.083 Vali Acc: 0.228 Test Loss: 8.083 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8358700275421143
Epoch: 5, Steps: 17 | Train Loss: 8.593 Vali Loss: 12.128 Vali Acc: 0.262 Test Loss: 12.128 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7386548519134521
Epoch: 6, Steps: 17 | Train Loss: 11.965 Vali Loss: 9.805 Vali Acc: 0.262 Test Loss: 9.805 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7138104438781738
Epoch: 7, Steps: 17 | Train Loss: 5.975 Vali Loss: 11.717 Vali Acc: 0.266 Test Loss: 11.717 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.7059094905853271
Epoch: 8, Steps: 17 | Train Loss: 5.734 Vali Loss: 8.503 Vali Acc: 0.255 Test Loss: 8.503 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.7816596031188965
Epoch: 9, Steps: 17 | Train Loss: 5.813 Vali Loss: 8.097 Vali Acc: 0.236 Test Loss: 8.097 Test Acc: 0.236
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.734860897064209
Epoch: 10, Steps: 17 | Train Loss: 7.148 Vali Loss: 8.518 Vali Acc: 0.251 Test Loss: 8.518 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.653846025466919
Epoch: 11, Steps: 17 | Train Loss: 4.402 Vali Loss: 6.273 Vali Acc: 0.281 Test Loss: 6.273 Test Acc: 0.281
Validation loss decreased (-0.269890 --> -0.281306).  Saving model ...
Epoch: 12 cost time: 0.7219679355621338
Epoch: 12, Steps: 17 | Train Loss: 3.225 Vali Loss: 5.450 Vali Acc: 0.262 Test Loss: 5.450 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7076482772827148
Epoch: 13, Steps: 17 | Train Loss: 3.272 Vali Loss: 4.958 Vali Acc: 0.243 Test Loss: 4.958 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8759660720825195
Epoch: 14, Steps: 17 | Train Loss: 2.223 Vali Loss: 3.863 Vali Acc: 0.255 Test Loss: 3.863 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7670948505401611
Epoch: 15, Steps: 17 | Train Loss: 1.936 Vali Loss: 6.591 Vali Acc: 0.255 Test Loss: 6.591 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7649450302124023
Epoch: 16, Steps: 17 | Train Loss: 3.006 Vali Loss: 4.384 Vali Acc: 0.285 Test Loss: 4.384 Test Acc: 0.285
Validation loss decreased (-0.281306 --> -0.285127).  Saving model ...
Epoch: 17 cost time: 0.956911563873291
Epoch: 17, Steps: 17 | Train Loss: 2.020 Vali Loss: 5.041 Vali Acc: 0.270 Test Loss: 5.041 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7630620002746582
Epoch: 18, Steps: 17 | Train Loss: 2.603 Vali Loss: 7.206 Vali Acc: 0.270 Test Loss: 7.206 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.715374231338501
Epoch: 19, Steps: 17 | Train Loss: 3.060 Vali Loss: 4.866 Vali Acc: 0.240 Test Loss: 4.866 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7662458419799805
Epoch: 20, Steps: 17 | Train Loss: 3.187 Vali Loss: 5.391 Vali Acc: 0.262 Test Loss: 5.391 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7328054904937744
Epoch: 21, Steps: 17 | Train Loss: 2.002 Vali Loss: 4.757 Vali Acc: 0.255 Test Loss: 4.757 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7991714477539062
Epoch: 22, Steps: 17 | Train Loss: 2.127 Vali Loss: 6.448 Vali Acc: 0.270 Test Loss: 6.448 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7045559883117676
Epoch: 23, Steps: 17 | Train Loss: 3.486 Vali Loss: 9.719 Vali Acc: 0.232 Test Loss: 9.719 Test Acc: 0.232
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7809579372406006
Epoch: 24, Steps: 17 | Train Loss: 2.974 Vali Loss: 8.176 Vali Acc: 0.255 Test Loss: 8.176 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.661670446395874
Epoch: 25, Steps: 17 | Train Loss: 1.969 Vali Loss: 7.529 Vali Acc: 0.240 Test Loss: 7.529 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8106105327606201
Epoch: 26, Steps: 17 | Train Loss: 2.472 Vali Loss: 9.187 Vali Acc: 0.255 Test Loss: 9.187 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs117_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 3107363
model size : 11.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs110_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0569071769714355
Epoch: 1, Steps: 17 | Train Loss: 4.799 Vali Loss: 3.898 Vali Acc: 0.217 Test Loss: 3.898 Test Acc: 0.217
Validation loss decreased (inf --> -0.216691).  Saving model ...
Epoch: 2 cost time: 0.7626461982727051
Epoch: 2, Steps: 17 | Train Loss: 4.601 Vali Loss: 8.993 Vali Acc: 0.232 Test Loss: 8.993 Test Acc: 0.232
Validation loss decreased (-0.216691 --> -0.231849).  Saving model ...
Epoch: 3 cost time: 0.7118804454803467
Epoch: 3, Steps: 17 | Train Loss: 5.886 Vali Loss: 4.493 Vali Acc: 0.274 Test Loss: 4.493 Test Acc: 0.274
Validation loss decreased (-0.231849 --> -0.273719).  Saving model ...
Epoch: 4 cost time: 0.6285803318023682
Epoch: 4, Steps: 17 | Train Loss: 4.694 Vali Loss: 9.520 Vali Acc: 0.236 Test Loss: 9.520 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6894514560699463
Epoch: 5, Steps: 17 | Train Loss: 5.000 Vali Loss: 9.760 Vali Acc: 0.243 Test Loss: 9.760 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.623953104019165
Epoch: 6, Steps: 17 | Train Loss: 6.002 Vali Loss: 9.541 Vali Acc: 0.266 Test Loss: 9.541 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.6968557834625244
Epoch: 7, Steps: 17 | Train Loss: 5.818 Vali Loss: 17.652 Vali Acc: 0.247 Test Loss: 17.652 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6454670429229736
Epoch: 8, Steps: 17 | Train Loss: 7.467 Vali Loss: 12.404 Vali Acc: 0.247 Test Loss: 12.404 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.751636266708374
Epoch: 9, Steps: 17 | Train Loss: 6.034 Vali Loss: 8.365 Vali Acc: 0.243 Test Loss: 8.365 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.7357203960418701
Epoch: 10, Steps: 17 | Train Loss: 5.809 Vali Loss: 9.184 Vali Acc: 0.243 Test Loss: 9.184 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.8323712348937988
Epoch: 11, Steps: 17 | Train Loss: 3.679 Vali Loss: 10.060 Vali Acc: 0.243 Test Loss: 10.060 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.7679383754730225
Epoch: 12, Steps: 17 | Train Loss: 3.036 Vali Loss: 6.758 Vali Acc: 0.281 Test Loss: 6.758 Test Acc: 0.281
Validation loss decreased (-0.273719 --> -0.281301).  Saving model ...
Epoch: 13 cost time: 0.7264325618743896
Epoch: 13, Steps: 17 | Train Loss: 4.526 Vali Loss: 5.406 Vali Acc: 0.243 Test Loss: 5.406 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7193377017974854
Epoch: 14, Steps: 17 | Train Loss: 3.479 Vali Loss: 4.266 Vali Acc: 0.255 Test Loss: 4.266 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6888206005096436
Epoch: 15, Steps: 17 | Train Loss: 2.229 Vali Loss: 4.644 Vali Acc: 0.255 Test Loss: 4.644 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8026759624481201
Epoch: 16, Steps: 17 | Train Loss: 2.676 Vali Loss: 4.913 Vali Acc: 0.247 Test Loss: 4.913 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.665431022644043
Epoch: 17, Steps: 17 | Train Loss: 2.531 Vali Loss: 5.924 Vali Acc: 0.228 Test Loss: 5.924 Test Acc: 0.228
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9190640449523926
Epoch: 18, Steps: 17 | Train Loss: 2.521 Vali Loss: 7.858 Vali Acc: 0.247 Test Loss: 7.858 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7900080680847168
Epoch: 19, Steps: 17 | Train Loss: 3.828 Vali Loss: 7.534 Vali Acc: 0.228 Test Loss: 7.534 Test Acc: 0.228
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7599489688873291
Epoch: 20, Steps: 17 | Train Loss: 2.842 Vali Loss: 4.737 Vali Acc: 0.278 Test Loss: 4.737 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.760042667388916
Epoch: 21, Steps: 17 | Train Loss: 2.230 Vali Loss: 5.047 Vali Acc: 0.262 Test Loss: 5.047 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6608200073242188
Epoch: 22, Steps: 17 | Train Loss: 2.342 Vali Loss: 5.773 Vali Acc: 0.236 Test Loss: 5.773 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs110_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 3116072
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs103_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.0571279525756836
Epoch: 1, Steps: 17 | Train Loss: 4.663 Vali Loss: 4.500 Vali Acc: 0.240 Test Loss: 4.500 Test Acc: 0.240
Validation loss decreased (inf --> -0.239499).  Saving model ...
Epoch: 2 cost time: 0.8390429019927979
Epoch: 2, Steps: 17 | Train Loss: 3.595 Vali Loss: 6.080 Vali Acc: 0.266 Test Loss: 6.080 Test Acc: 0.266
Validation loss decreased (-0.239499 --> -0.266099).  Saving model ...
Epoch: 3 cost time: 0.8530211448669434
Epoch: 3, Steps: 17 | Train Loss: 4.491 Vali Loss: 6.434 Vali Acc: 0.251 Test Loss: 6.434 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8810639381408691
Epoch: 4, Steps: 17 | Train Loss: 5.966 Vali Loss: 13.278 Vali Acc: 0.236 Test Loss: 13.278 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7930843830108643
Epoch: 5, Steps: 17 | Train Loss: 6.624 Vali Loss: 8.708 Vali Acc: 0.262 Test Loss: 8.708 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8327209949493408
Epoch: 6, Steps: 17 | Train Loss: 9.492 Vali Loss: 9.815 Vali Acc: 0.236 Test Loss: 9.815 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6728365421295166
Epoch: 7, Steps: 17 | Train Loss: 8.463 Vali Loss: 14.650 Vali Acc: 0.266 Test Loss: 14.650 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8498384952545166
Epoch: 8, Steps: 17 | Train Loss: 6.319 Vali Loss: 10.467 Vali Acc: 0.259 Test Loss: 10.467 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.9092204570770264
Epoch: 9, Steps: 17 | Train Loss: 3.626 Vali Loss: 8.834 Vali Acc: 0.274 Test Loss: 8.834 Test Acc: 0.274
Validation loss decreased (-0.266099 --> -0.273676).  Saving model ...
Epoch: 10 cost time: 0.9221749305725098
Epoch: 10, Steps: 17 | Train Loss: 5.966 Vali Loss: 10.784 Vali Acc: 0.247 Test Loss: 10.784 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8115367889404297
Epoch: 11, Steps: 17 | Train Loss: 4.508 Vali Loss: 7.877 Vali Acc: 0.262 Test Loss: 7.877 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7450003623962402
Epoch: 12, Steps: 17 | Train Loss: 3.865 Vali Loss: 5.007 Vali Acc: 0.255 Test Loss: 5.007 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.728318452835083
Epoch: 13, Steps: 17 | Train Loss: 3.517 Vali Loss: 7.268 Vali Acc: 0.255 Test Loss: 7.268 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9101278781890869
Epoch: 14, Steps: 17 | Train Loss: 2.748 Vali Loss: 6.158 Vali Acc: 0.251 Test Loss: 6.158 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.074908971786499
Epoch: 15, Steps: 17 | Train Loss: 3.500 Vali Loss: 9.108 Vali Acc: 0.259 Test Loss: 9.108 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0807874202728271
Epoch: 16, Steps: 17 | Train Loss: 2.813 Vali Loss: 7.649 Vali Acc: 0.293 Test Loss: 7.649 Test Acc: 0.293
Validation loss decreased (-0.273676 --> -0.292699).  Saving model ...
Epoch: 17 cost time: 0.8547601699829102
Epoch: 17, Steps: 17 | Train Loss: 2.545 Vali Loss: 6.578 Vali Acc: 0.251 Test Loss: 6.578 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.041811227798462
Epoch: 18, Steps: 17 | Train Loss: 2.846 Vali Loss: 4.234 Vali Acc: 0.236 Test Loss: 4.234 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0198218822479248
Epoch: 19, Steps: 17 | Train Loss: 2.287 Vali Loss: 5.865 Vali Acc: 0.247 Test Loss: 5.865 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8787901401519775
Epoch: 20, Steps: 17 | Train Loss: 2.584 Vali Loss: 7.391 Vali Acc: 0.270 Test Loss: 7.391 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.018425464630127
Epoch: 21, Steps: 17 | Train Loss: 3.230 Vali Loss: 5.131 Vali Acc: 0.266 Test Loss: 5.131 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0699985027313232
Epoch: 22, Steps: 17 | Train Loss: 2.281 Vali Loss: 7.742 Vali Acc: 0.259 Test Loss: 7.742 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9813399314880371
Epoch: 23, Steps: 17 | Train Loss: 2.532 Vali Loss: 8.028 Vali Acc: 0.251 Test Loss: 8.028 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9913234710693359
Epoch: 24, Steps: 17 | Train Loss: 3.302 Vali Loss: 9.012 Vali Acc: 0.217 Test Loss: 9.012 Test Acc: 0.217
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.886176347732544
Epoch: 25, Steps: 17 | Train Loss: 3.340 Vali Loss: 8.949 Vali Acc: 0.243 Test Loss: 8.949 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8782224655151367
Epoch: 26, Steps: 17 | Train Loss: 3.555 Vali Loss: 7.767 Vali Acc: 0.259 Test Loss: 7.767 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs103_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 3100271
model size : 11.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs98_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.8099167346954346
Epoch: 1, Steps: 17 | Train Loss: 4.219 Vali Loss: 6.332 Vali Acc: 0.255 Test Loss: 6.332 Test Acc: 0.255
Validation loss decreased (inf --> -0.254690).  Saving model ...
Epoch: 2 cost time: 0.8970675468444824
Epoch: 2, Steps: 17 | Train Loss: 4.975 Vali Loss: 4.427 Vali Acc: 0.262 Test Loss: 4.427 Test Acc: 0.262
Validation loss decreased (-0.254690 --> -0.262313).  Saving model ...
Epoch: 3 cost time: 0.9489343166351318
Epoch: 3, Steps: 17 | Train Loss: 4.034 Vali Loss: 8.931 Vali Acc: 0.266 Test Loss: 8.931 Test Acc: 0.266
Validation loss decreased (-0.262313 --> -0.266070).  Saving model ...
Epoch: 4 cost time: 0.9122805595397949
Epoch: 4, Steps: 17 | Train Loss: 6.418 Vali Loss: 8.518 Vali Acc: 0.240 Test Loss: 8.518 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9511117935180664
Epoch: 5, Steps: 17 | Train Loss: 7.054 Vali Loss: 9.737 Vali Acc: 0.274 Test Loss: 9.737 Test Acc: 0.274
Validation loss decreased (-0.266070 --> -0.273667).  Saving model ...
Epoch: 6 cost time: 0.9997773170471191
Epoch: 6, Steps: 17 | Train Loss: 7.900 Vali Loss: 17.128 Vali Acc: 0.236 Test Loss: 17.128 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7208948135375977
Epoch: 7, Steps: 17 | Train Loss: 10.554 Vali Loss: 9.523 Vali Acc: 0.262 Test Loss: 9.523 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.872687816619873
Epoch: 8, Steps: 17 | Train Loss: 4.899 Vali Loss: 12.127 Vali Acc: 0.240 Test Loss: 12.127 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.825068473815918
Epoch: 9, Steps: 17 | Train Loss: 5.820 Vali Loss: 7.174 Vali Acc: 0.251 Test Loss: 7.174 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8864741325378418
Epoch: 10, Steps: 17 | Train Loss: 2.853 Vali Loss: 11.448 Vali Acc: 0.274 Test Loss: 11.448 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8849895000457764
Epoch: 11, Steps: 17 | Train Loss: 5.102 Vali Loss: 6.724 Vali Acc: 0.240 Test Loss: 6.724 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9420442581176758
Epoch: 12, Steps: 17 | Train Loss: 3.733 Vali Loss: 10.807 Vali Acc: 0.247 Test Loss: 10.807 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9835143089294434
Epoch: 13, Steps: 17 | Train Loss: 5.638 Vali Loss: 6.402 Vali Acc: 0.240 Test Loss: 6.402 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9407932758331299
Epoch: 14, Steps: 17 | Train Loss: 3.931 Vali Loss: 9.954 Vali Acc: 0.224 Test Loss: 9.954 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9847204685211182
Epoch: 15, Steps: 17 | Train Loss: 3.311 Vali Loss: 7.833 Vali Acc: 0.266 Test Loss: 7.833 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs98_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 3123028
model size : 11.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs93_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.444608688354492
Epoch: 1, Steps: 17 | Train Loss: 5.849 Vali Loss: 6.011 Vali Acc: 0.240 Test Loss: 6.011 Test Acc: 0.240
Validation loss decreased (inf --> -0.239484).  Saving model ...
Epoch: 2 cost time: 0.8777475357055664
Epoch: 2, Steps: 17 | Train Loss: 4.926 Vali Loss: 10.451 Vali Acc: 0.259 Test Loss: 10.451 Test Acc: 0.259
Validation loss decreased (-0.239484 --> -0.258451).  Saving model ...
Epoch: 3 cost time: 0.8884708881378174
Epoch: 3, Steps: 17 | Train Loss: 6.286 Vali Loss: 3.875 Vali Acc: 0.255 Test Loss: 3.875 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7733790874481201
Epoch: 4, Steps: 17 | Train Loss: 5.133 Vali Loss: 8.226 Vali Acc: 0.243 Test Loss: 8.226 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8857443332672119
Epoch: 5, Steps: 17 | Train Loss: 5.509 Vali Loss: 15.373 Vali Acc: 0.262 Test Loss: 15.373 Test Acc: 0.262
Validation loss decreased (-0.258451 --> -0.262204).  Saving model ...
Epoch: 6 cost time: 0.9269137382507324
Epoch: 6, Steps: 17 | Train Loss: 7.478 Vali Loss: 7.638 Vali Acc: 0.266 Test Loss: 7.638 Test Acc: 0.266
Validation loss decreased (-0.262204 --> -0.266083).  Saving model ...
Epoch: 7 cost time: 0.9116520881652832
Epoch: 7, Steps: 17 | Train Loss: 3.994 Vali Loss: 12.551 Vali Acc: 0.243 Test Loss: 12.551 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.507885456085205
Epoch: 8, Steps: 17 | Train Loss: 8.657 Vali Loss: 18.212 Vali Acc: 0.259 Test Loss: 18.212 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.070108413696289
Epoch: 9, Steps: 17 | Train Loss: 7.879 Vali Loss: 12.866 Vali Acc: 0.259 Test Loss: 12.866 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.103130578994751
Epoch: 10, Steps: 17 | Train Loss: 4.911 Vali Loss: 7.772 Vali Acc: 0.251 Test Loss: 7.772 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8337249755859375
Epoch: 11, Steps: 17 | Train Loss: 3.751 Vali Loss: 14.222 Vali Acc: 0.255 Test Loss: 14.222 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9649808406829834
Epoch: 12, Steps: 17 | Train Loss: 7.470 Vali Loss: 4.606 Vali Acc: 0.240 Test Loss: 4.606 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0879809856414795
Epoch: 13, Steps: 17 | Train Loss: 2.638 Vali Loss: 7.442 Vali Acc: 0.240 Test Loss: 7.442 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9485578536987305
Epoch: 14, Steps: 17 | Train Loss: 2.653 Vali Loss: 7.993 Vali Acc: 0.255 Test Loss: 7.993 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1032640933990479
Epoch: 15, Steps: 17 | Train Loss: 3.178 Vali Loss: 5.255 Vali Acc: 0.259 Test Loss: 5.255 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.110598087310791
Epoch: 16, Steps: 17 | Train Loss: 2.633 Vali Loss: 5.568 Vali Acc: 0.251 Test Loss: 5.568 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs93_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2661596958174905
model parameter : 3128279
model size : 11.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs88_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.798201084136963
Epoch: 1, Steps: 17 | Train Loss: 3.988 Vali Loss: 5.723 Vali Acc: 0.270 Test Loss: 5.723 Test Acc: 0.270
Validation loss decreased (inf --> -0.269905).  Saving model ...
Epoch: 2 cost time: 0.9427094459533691
Epoch: 2, Steps: 17 | Train Loss: 4.736 Vali Loss: 5.851 Vali Acc: 0.274 Test Loss: 5.851 Test Acc: 0.274
Validation loss decreased (-0.269905 --> -0.273706).  Saving model ...
Epoch: 3 cost time: 1.0044596195220947
Epoch: 3, Steps: 17 | Train Loss: 4.631 Vali Loss: 12.479 Vali Acc: 0.262 Test Loss: 12.479 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2671866416931152
Epoch: 4, Steps: 17 | Train Loss: 9.575 Vali Loss: 6.167 Vali Acc: 0.297 Test Loss: 6.167 Test Acc: 0.297
Validation loss decreased (-0.273706 --> -0.296516).  Saving model ...
Epoch: 5 cost time: 1.2715027332305908
Epoch: 5, Steps: 17 | Train Loss: 5.727 Vali Loss: 11.763 Vali Acc: 0.259 Test Loss: 11.763 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2141838073730469
Epoch: 6, Steps: 17 | Train Loss: 7.583 Vali Loss: 12.177 Vali Acc: 0.251 Test Loss: 12.177 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1191892623901367
Epoch: 7, Steps: 17 | Train Loss: 6.015 Vali Loss: 9.941 Vali Acc: 0.270 Test Loss: 9.941 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0896499156951904
Epoch: 8, Steps: 17 | Train Loss: 4.679 Vali Loss: 10.562 Vali Acc: 0.262 Test Loss: 10.562 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1893112659454346
Epoch: 9, Steps: 17 | Train Loss: 5.217 Vali Loss: 10.913 Vali Acc: 0.270 Test Loss: 10.913 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1519601345062256
Epoch: 10, Steps: 17 | Train Loss: 4.144 Vali Loss: 11.193 Vali Acc: 0.247 Test Loss: 11.193 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6276319026947021
Epoch: 11, Steps: 17 | Train Loss: 5.589 Vali Loss: 11.870 Vali Acc: 0.247 Test Loss: 11.870 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0080175399780273
Epoch: 12, Steps: 17 | Train Loss: 3.635 Vali Loss: 5.695 Vali Acc: 0.270 Test Loss: 5.695 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0359747409820557
Epoch: 13, Steps: 17 | Train Loss: 2.874 Vali Loss: 10.491 Vali Acc: 0.224 Test Loss: 10.491 Test Acc: 0.224
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1664938926696777
Epoch: 14, Steps: 17 | Train Loss: 4.158 Vali Loss: 4.976 Vali Acc: 0.224 Test Loss: 4.976 Test Acc: 0.224
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs88_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 3116024
model size : 11.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs84_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2942535877227783
Epoch: 1, Steps: 17 | Train Loss: 3.625 Vali Loss: 4.731 Vali Acc: 0.278 Test Loss: 4.731 Test Acc: 0.278
Validation loss decreased (inf --> -0.277519).  Saving model ...
Epoch: 2 cost time: 1.0410242080688477
Epoch: 2, Steps: 17 | Train Loss: 3.835 Vali Loss: 6.721 Vali Acc: 0.228 Test Loss: 6.721 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1475660800933838
Epoch: 3, Steps: 17 | Train Loss: 3.737 Vali Loss: 9.334 Vali Acc: 0.247 Test Loss: 9.334 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1066944599151611
Epoch: 4, Steps: 17 | Train Loss: 7.384 Vali Loss: 8.741 Vali Acc: 0.251 Test Loss: 8.741 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0957980155944824
Epoch: 5, Steps: 17 | Train Loss: 9.337 Vali Loss: 18.412 Vali Acc: 0.255 Test Loss: 18.412 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9864485263824463
Epoch: 6, Steps: 17 | Train Loss: 10.168 Vali Loss: 7.271 Vali Acc: 0.274 Test Loss: 7.271 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.096034049987793
Epoch: 7, Steps: 17 | Train Loss: 9.459 Vali Loss: 19.874 Vali Acc: 0.278 Test Loss: 19.874 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.885002851486206
Epoch: 8, Steps: 17 | Train Loss: 7.890 Vali Loss: 7.157 Vali Acc: 0.251 Test Loss: 7.157 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1653738021850586
Epoch: 9, Steps: 17 | Train Loss: 3.790 Vali Loss: 4.970 Vali Acc: 0.259 Test Loss: 4.970 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9387309551239014
Epoch: 10, Steps: 17 | Train Loss: 3.419 Vali Loss: 8.297 Vali Acc: 0.266 Test Loss: 8.297 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2861406803131104
Epoch: 11, Steps: 17 | Train Loss: 4.172 Vali Loss: 6.526 Vali Acc: 0.259 Test Loss: 6.526 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_LightTS_UEA_ftM_sl1751_ll0_pl0_dm32_cs84_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 3123050
model size : 11.92MB
