Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6289525032043457
Epoch: 1, Steps: 1 | Train Loss: 1.236 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.30731868743896484
Epoch: 2, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.3631472587585449
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.32637977600097656
Epoch: 4, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.31887173652648926
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.3170294761657715
Epoch: 6, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.3590092658996582
Epoch: 7, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.35716795921325684
Epoch: 8, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3554987907409668
Epoch: 9, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.35091686248779297
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3644087314605713
Epoch: 11, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.362682580947876
Epoch: 12, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.3726227283477783
Epoch: 13, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3866703510284424
Epoch: 14, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.3212127685546875
Epoch: 15, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.34517741203308105
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.33331871032714844
Epoch: 17, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.30404233932495117
Epoch: 18, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.3818390369415283
Epoch: 19, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.32625412940979004
Epoch: 20, Steps: 1 | Train Loss: 0.355 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.3395564556121826
Epoch: 21, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.141 Vali Acc: 0.467 Test Loss: 1.141 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.36042046546936035
Epoch: 22, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.3157806396484375
Epoch: 23, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.32807087898254395
Epoch: 24, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 636827
model size : 2.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs214_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.316300392150879
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.34339451789855957
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.34578394889831543
Epoch: 3, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4774765968322754
Epoch: 4, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3523070812225342
Epoch: 5, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3049345016479492
Epoch: 6, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.3770751953125
Epoch: 7, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.3203568458557129
Epoch: 8, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.333693265914917
Epoch: 9, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.31481003761291504
Epoch: 10, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.3903520107269287
Epoch: 11, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.31039881706237793
Epoch: 12, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.37502503395080566
Epoch: 13, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3908822536468506
Epoch: 14, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.3317985534667969
Epoch: 15, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.178 Vali Acc: 0.467 Test Loss: 1.178 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.31212806701660156
Epoch: 16, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.3502845764160156
Epoch: 17, Steps: 1 | Train Loss: 0.427 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.37708425521850586
Epoch: 18, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.205 Vali Acc: 0.400 Test Loss: 1.205 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.32347893714904785
Epoch: 19, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3681061267852783
Epoch: 20, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.34721899032592773
Epoch: 21, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.232 Vali Acc: 0.467 Test Loss: 1.232 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.32049083709716797
Epoch: 22, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.240 Vali Acc: 0.467 Test Loss: 1.240 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.2870903015136719
Epoch: 23, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.248 Vali Acc: 0.467 Test Loss: 1.248 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.3648405075073242
Epoch: 24, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs214_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 610985
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.3959293365478516
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.43686771392822266
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.37756919860839844
Epoch: 3, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.3215208053588867
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.3820011615753174
Epoch: 5, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4766573905944824
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.42534565925598145
Epoch: 7, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.4087975025177002
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5092291831970215
Epoch: 9, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.41812634468078613
Epoch: 10, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.46495866775512695
Epoch: 11, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4962000846862793
Epoch: 12, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.43583059310913086
Epoch: 13, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.070 Vali Acc: 0.333 Test Loss: 1.070 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4044933319091797
Epoch: 14, Steps: 1 | Train Loss: 0.563 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4347679615020752
Epoch: 15, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.45004749298095703
Epoch: 16, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5813078880310059
Epoch: 17, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.093 Vali Acc: 0.333 Test Loss: 1.093 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4488797187805176
Epoch: 18, Steps: 1 | Train Loss: 0.380 Vali Loss: 1.100 Vali Acc: 0.333 Test Loss: 1.100 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 595899
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6419122219085693
Epoch: 1, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4343116283416748
Epoch: 2, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.36227869987487793
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5575206279754639
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.41138386726379395
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5156795978546143
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4541187286376953
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.454240083694458
Epoch: 8, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49544715881347656
Epoch: 9, Steps: 1 | Train Loss: 0.769 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.44034624099731445
Epoch: 10, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48070812225341797
Epoch: 11, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 587729
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs107_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5485429763793945
Epoch: 1, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.48551344871520996
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4424870014190674
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.264 Vali Acc: 0.333 Test Loss: 1.264 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.45044755935668945
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4420480728149414
Epoch: 5, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4844224452972412
Epoch: 6, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5100083351135254
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5367832183837891
Epoch: 8, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5299994945526123
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5493128299713135
Epoch: 10, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.261 Vali Acc: 0.267 Test Loss: 1.261 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.47139453887939453
Epoch: 11, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5651109218597412
Epoch: 12, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5621523857116699
Epoch: 13, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.474454402923584
Epoch: 14, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6928770542144775
Epoch: 15, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.272 Vali Acc: 0.333 Test Loss: 1.272 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.45937275886535645
Epoch: 16, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5289535522460938
Epoch: 17, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs107_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 583659
model size : 2.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs92_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6388802528381348
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.4731760025024414
Epoch: 2, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.49013781547546387
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5856654644012451
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5420901775360107
Epoch: 5, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4754009246826172
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.47914624214172363
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.6431746482849121
Epoch: 8, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4362642765045166
Epoch: 9, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5404376983642578
Epoch: 10, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.6514410972595215
Epoch: 11, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4867594242095947
Epoch: 12, Steps: 1 | Train Loss: 0.750 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs92_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 581129
model size : 2.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.736008882522583
Epoch: 1, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5358092784881592
Epoch: 2, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6182293891906738
Epoch: 3, Steps: 1 | Train Loss: 1.189 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5053167343139648
Epoch: 4, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5298411846160889
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6292314529418945
Epoch: 6, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4826798439025879
Epoch: 7, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4613008499145508
Epoch: 8, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.6216368675231934
Epoch: 9, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.6140456199645996
Epoch: 10, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5829129219055176
Epoch: 11, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 575531
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.672532081604004
Epoch: 1, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4798407554626465
Epoch: 2, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5003447532653809
Epoch: 3, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5167069435119629
Epoch: 4, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4965095520019531
Epoch: 5, Steps: 1 | Train Loss: 1.100 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5353610515594482
Epoch: 6, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5539844036102295
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.107 Vali Acc: 0.400 Test Loss: 1.107 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.470428466796875
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.48310160636901855
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.6580572128295898
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.460188627243042
Epoch: 11, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.104 Vali Acc: 0.533 Test Loss: 1.104 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.5731632709503174
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5592029094696045
Epoch: 13, Steps: 1 | Train Loss: 0.677 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7033507823944092
Epoch: 14, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5388760566711426
Epoch: 15, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.118 Vali Acc: 0.400 Test Loss: 1.118 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5077342987060547
Epoch: 16, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.125 Vali Acc: 0.400 Test Loss: 1.125 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5414726734161377
Epoch: 17, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.568253755569458
Epoch: 18, Steps: 1 | Train Loss: 0.420 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6279504299163818
Epoch: 19, Steps: 1 | Train Loss: 0.378 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5416312217712402
Epoch: 20, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.160 Vali Acc: 0.267 Test Loss: 1.160 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5081229209899902
Epoch: 21, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 578641
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5192394256591797
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5736982822418213
Epoch: 2, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4596266746520996
Epoch: 3, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.51847243309021
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.390841007232666
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47072720527648926
Epoch: 6, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4909994602203369
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4931793212890625
Epoch: 8, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.5535619258880615
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.405322790145874
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.466754674911499
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 571515
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7636919021606445
Epoch: 1, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5001542568206787
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.205 Vali Acc: 0.200 Test Loss: 1.205 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.460097074508667
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4939444065093994
Epoch: 4, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.40325284004211426
Epoch: 5, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4470844268798828
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.36379098892211914
Epoch: 7, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.482806921005249
Epoch: 8, Steps: 1 | Train Loss: 0.886 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.4900808334350586
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4635801315307617
Epoch: 10, Steps: 1 | Train Loss: 0.783 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.45589351654052734
Epoch: 11, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.203 Vali Acc: 0.133 Test Loss: 1.203 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6091198921203613
Epoch: 12, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5237176418304443
Epoch: 13, Steps: 1 | Train Loss: 0.624 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.46892714500427246
Epoch: 14, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7644948959350586
Epoch: 15, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.221 Vali Acc: 0.200 Test Loss: 1.221 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.43561697006225586
Epoch: 16, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.228 Vali Acc: 0.200 Test Loss: 1.228 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4613957405090332
Epoch: 17, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4908735752105713
Epoch: 18, Steps: 1 | Train Loss: 0.391 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 576041
model size : 2.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7439396381378174
Epoch: 1, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4889402389526367
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.41017913818359375
Epoch: 3, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5152945518493652
Epoch: 4, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4513416290283203
Epoch: 5, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5285511016845703
Epoch: 6, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.43852734565734863
Epoch: 7, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.155 Vali Acc: 0.267 Test Loss: 1.155 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.513683557510376
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5659701824188232
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5228133201599121
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.43164706230163574
Epoch: 11, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.555366039276123
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.44333744049072266
Epoch: 13, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.508446455001831
Epoch: 14, Steps: 1 | Train Loss: 0.592 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5093801021575928
Epoch: 15, Steps: 1 | Train Loss: 0.540 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4753382205963135
Epoch: 16, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 574171
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5050525665283203
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4541501998901367
Epoch: 2, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.45987367630004883
Epoch: 3, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.7419357299804688
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5526654720306396
Epoch: 5, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6708989143371582
Epoch: 6, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.37717151641845703
Epoch: 7, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5014433860778809
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.6000237464904785
Epoch: 9, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.077 Vali Acc: 0.467 Test Loss: 1.077 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4059171676635742
Epoch: 10, Steps: 1 | Train Loss: 0.837 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4146230220794678
Epoch: 11, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 12 cost time: 0.4773440361022949
Epoch: 12, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4895486831665039
Epoch: 13, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.49681806564331055
Epoch: 14, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.48563122749328613
Epoch: 15, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4978773593902588
Epoch: 16, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4099767208099365
Epoch: 17, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5174806118011475
Epoch: 18, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5810117721557617
Epoch: 19, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5738060474395752
Epoch: 20, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.109 Vali Acc: 0.467 Test Loss: 1.109 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5043141841888428
Epoch: 21, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 574481
model size : 2.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6453866958618164
Epoch: 1, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.45021510124206543
Epoch: 2, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5144903659820557
Epoch: 3, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6383256912231445
Epoch: 4, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.41746950149536133
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.43144989013671875
Epoch: 6, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5507886409759521
Epoch: 7, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.3831818103790283
Epoch: 8, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.46643757820129395
Epoch: 9, Steps: 1 | Train Loss: 0.876 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4660365581512451
Epoch: 10, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5300333499908447
Epoch: 11, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 12 cost time: 0.42337727546691895
Epoch: 12, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.49611687660217285
Epoch: 13, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.46752333641052246
Epoch: 14, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.39174532890319824
Epoch: 15, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4307425022125244
Epoch: 16, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.243 Vali Acc: 0.400 Test Loss: 1.243 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4411885738372803
Epoch: 17, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.252 Vali Acc: 0.400 Test Loss: 1.252 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4646937847137451
Epoch: 18, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.263 Vali Acc: 0.333 Test Loss: 1.263 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4044623374938965
Epoch: 19, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4757046699523926
Epoch: 20, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.283 Vali Acc: 0.333 Test Loss: 1.283 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.505441427230835
Epoch: 21, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 569675
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8886983394622803
Epoch: 1, Steps: 1 | Train Loss: 1.176 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.39837145805358887
Epoch: 2, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5074789524078369
Epoch: 3, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5260670185089111
Epoch: 4, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5345232486724854
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4382202625274658
Epoch: 6, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.3833134174346924
Epoch: 7, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.4678075313568115
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.43465399742126465
Epoch: 9, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.37381577491760254
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5032930374145508
Epoch: 11, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4732973575592041
Epoch: 12, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5363788604736328
Epoch: 13, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.179 Vali Acc: 0.133 Test Loss: 1.179 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.3907637596130371
Epoch: 14, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.181 Vali Acc: 0.133 Test Loss: 1.181 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.40887999534606934
Epoch: 15, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.184 Vali Acc: 0.133 Test Loss: 1.184 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.3998575210571289
Epoch: 16, Steps: 1 | Train Loss: 0.507 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5092906951904297
Epoch: 17, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.193 Vali Acc: 0.133 Test Loss: 1.193 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.40360093116760254
Epoch: 18, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.199 Vali Acc: 0.133 Test Loss: 1.199 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 569609
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8452491760253906
Epoch: 1, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5571575164794922
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5391104221343994
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.49332666397094727
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5495505332946777
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.4998805522918701
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5575251579284668
Epoch: 7, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6377696990966797
Epoch: 8, Steps: 1 | Train Loss: 0.826 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5227208137512207
Epoch: 9, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.502469539642334
Epoch: 10, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.396831750869751
Epoch: 11, Steps: 1 | Train Loss: 0.673 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6235551834106445
Epoch: 12, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5203456878662109
Epoch: 13, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4948585033416748
Epoch: 14, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4563415050506592
Epoch: 15, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.183 Vali Acc: 0.200 Test Loss: 1.183 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4991796016693115
Epoch: 16, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.671027660369873
Epoch: 17, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4403049945831299
Epoch: 18, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.195 Vali Acc: 0.133 Test Loss: 1.195 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5268824100494385
Epoch: 19, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5890164375305176
Epoch: 20, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.206 Vali Acc: 0.133 Test Loss: 1.206 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 565707
model size : 2.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5661025047302246
Epoch: 1, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4651341438293457
Epoch: 2, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.42789459228515625
Epoch: 3, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4730055332183838
Epoch: 4, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.524432897567749
Epoch: 5, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4462273120880127
Epoch: 6, Steps: 1 | Train Loss: 1.192 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4339597225189209
Epoch: 7, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.6338553428649902
Epoch: 8, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.43869638442993164
Epoch: 9, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.44980478286743164
Epoch: 10, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 11 cost time: 0.512293815612793
Epoch: 11, Steps: 1 | Train Loss: 0.861 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 12 cost time: 0.4762558937072754
Epoch: 12, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.485095739364624
Epoch: 13, Steps: 1 | Train Loss: 0.719 Vali Loss: 1.199 Vali Acc: 0.400 Test Loss: 1.199 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4595339298248291
Epoch: 14, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4755592346191406
Epoch: 15, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6013157367706299
Epoch: 16, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.40091562271118164
Epoch: 17, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.4617900848388672
Epoch: 18, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5199174880981445
Epoch: 19, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4892899990081787
Epoch: 20, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.233 Vali Acc: 0.400 Test Loss: 1.233 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.42688608169555664
Epoch: 21, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.241 Vali Acc: 0.400 Test Loss: 1.241 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 569105
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5338752269744873
Epoch: 1, Steps: 1 | Train Loss: 1.227 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.507749080657959
Epoch: 2, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5532615184783936
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.45769190788269043
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.39282917976379395
Epoch: 5, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5127463340759277
Epoch: 6, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.41058921813964844
Epoch: 7, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.49663615226745605
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5000274181365967
Epoch: 9, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5618224143981934
Epoch: 10, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5651528835296631
Epoch: 11, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4396698474884033
Epoch: 12, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4610152244567871
Epoch: 13, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.169 Vali Acc: 0.133 Test Loss: 1.169 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6647119522094727
Epoch: 14, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.173 Vali Acc: 0.133 Test Loss: 1.173 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5641322135925293
Epoch: 15, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.178 Vali Acc: 0.133 Test Loss: 1.178 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 569947
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7394740581512451
Epoch: 1, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4889404773712158
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41953420639038086
Epoch: 3, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5620441436767578
Epoch: 4, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.511019229888916
Epoch: 5, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5554375648498535
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5077908039093018
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4600701332092285
Epoch: 8, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.5482814311981201
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5058708190917969
Epoch: 10, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5061779022216797
Epoch: 11, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.128 Vali Acc: 0.533 Test Loss: 1.128 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4221222400665283
Epoch: 12, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.42290377616882324
Epoch: 13, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.465792179107666
Epoch: 14, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4438910484313965
Epoch: 15, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.41641879081726074
Epoch: 16, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5010571479797363
Epoch: 17, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4081721305847168
Epoch: 18, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 568233
model size : 2.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6104419231414795
Epoch: 1, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5596928596496582
Epoch: 2, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5279426574707031
Epoch: 3, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4550511837005615
Epoch: 4, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.5361084938049316
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5435216426849365
Epoch: 6, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.5653152465820312
Epoch: 7, Steps: 1 | Train Loss: 0.842 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5305783748626709
Epoch: 8, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.47847938537597656
Epoch: 9, Steps: 1 | Train Loss: 0.752 Vali Loss: 1.119 Vali Acc: 0.200 Test Loss: 1.119 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4230058193206787
Epoch: 10, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.121 Vali Acc: 0.200 Test Loss: 1.121 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5029139518737793
Epoch: 11, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.124 Vali Acc: 0.200 Test Loss: 1.124 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5100634098052979
Epoch: 12, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4084961414337158
Epoch: 13, Steps: 1 | Train Loss: 0.557 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.43105435371398926
Epoch: 14, Steps: 1 | Train Loss: 0.511 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.42620325088500977
Epoch: 15, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 16 cost time: 0.5218908786773682
Epoch: 16, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.149 Vali Acc: 0.267 Test Loss: 1.149 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5781211853027344
Epoch: 17, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.5765416622161865
Epoch: 18, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.43059539794921875
Epoch: 19, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.45441532135009766
Epoch: 20, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.44072651863098145
Epoch: 21, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.532386064529419
Epoch: 22, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.44585561752319336
Epoch: 23, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4512653350830078
Epoch: 24, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5532350540161133
Epoch: 25, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.4265620708465576
Epoch: 26, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.236 Vali Acc: 0.200 Test Loss: 1.236 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5044286251068115
Epoch: 27, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.245 Vali Acc: 0.200 Test Loss: 1.245 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 563963
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.629319667816162
Epoch: 1, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.475858211517334
Epoch: 2, Steps: 1 | Train Loss: 1.319 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4905073642730713
Epoch: 3, Steps: 1 | Train Loss: 1.292 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.49837207794189453
Epoch: 4, Steps: 1 | Train Loss: 1.266 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4403526782989502
Epoch: 5, Steps: 1 | Train Loss: 1.240 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5430846214294434
Epoch: 6, Steps: 1 | Train Loss: 1.215 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.48554205894470215
Epoch: 7, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.101 Vali Acc: 0.400 Test Loss: 1.101 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5235602855682373
Epoch: 8, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.49637269973754883
Epoch: 9, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.470381498336792
Epoch: 10, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.5450527667999268
Epoch: 11, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm512_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 570833
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5928635597229004
Epoch: 1, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4655013084411621
Epoch: 2, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.3975379467010498
Epoch: 3, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.42838001251220703
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.38081908226013184
Epoch: 5, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.052 Vali Acc: 0.333 Test Loss: 1.052 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4953479766845703
Epoch: 6, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.45441174507141113
Epoch: 7, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.049 Vali Acc: 0.333 Test Loss: 1.049 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.42165565490722656
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 9 cost time: 0.4709467887878418
Epoch: 9, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 10 cost time: 0.4312784671783447
Epoch: 10, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 11 cost time: 0.3517746925354004
Epoch: 11, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.045 Vali Acc: 0.400 Test Loss: 1.045 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 12 cost time: 0.37751007080078125
Epoch: 12, Steps: 1 | Train Loss: 0.636 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4186680316925049
Epoch: 13, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.047 Vali Acc: 0.400 Test Loss: 1.047 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.42865633964538574
Epoch: 14, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.050 Vali Acc: 0.333 Test Loss: 1.050 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.40107154846191406
Epoch: 15, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.053 Vali Acc: 0.333 Test Loss: 1.053 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.37974047660827637
Epoch: 16, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.39207935333251953
Epoch: 17, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.47677135467529297
Epoch: 18, Steps: 1 | Train Loss: 0.377 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.45461082458496094
Epoch: 19, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5711610317230225
Epoch: 20, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.4999988079071045
Epoch: 21, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 501211
model size : 1.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs214_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7182378768920898
Epoch: 1, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.43357372283935547
Epoch: 2, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5331571102142334
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4861135482788086
Epoch: 4, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.497406005859375
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3948535919189453
Epoch: 6, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5241870880126953
Epoch: 7, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.417675256729126
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4541628360748291
Epoch: 9, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5331931114196777
Epoch: 10, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.098 Vali Acc: 0.267 Test Loss: 1.098 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4570732116699219
Epoch: 11, Steps: 1 | Train Loss: 0.713 Vali Loss: 1.101 Vali Acc: 0.200 Test Loss: 1.101 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4788057804107666
Epoch: 12, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.105 Vali Acc: 0.200 Test Loss: 1.105 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5026261806488037
Epoch: 13, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.110 Vali Acc: 0.200 Test Loss: 1.110 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs214_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 488937
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5093297958374023
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.3860280513763428
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.056 Vali Acc: 0.600 Test Loss: 1.056 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.44174742698669434
Epoch: 3, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4188272953033447
Epoch: 4, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4930553436279297
Epoch: 5, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.49925971031188965
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.057 Vali Acc: 0.533 Test Loss: 1.057 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.47259044647216797
Epoch: 7, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5701508522033691
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.37094569206237793
Epoch: 9, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.3920254707336426
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.4480757713317871
Epoch: 11, Steps: 1 | Train Loss: 0.721 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.4093906879425049
Epoch: 12, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 480763
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5606181621551514
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.040 Vali Acc: 0.400 Test Loss: 1.040 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.47841453552246094
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5235195159912109
Epoch: 3, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.5063762664794922
Epoch: 4, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.039 Vali Acc: 0.400 Test Loss: 1.039 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.3707287311553955
Epoch: 5, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.5023674964904785
Epoch: 6, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 7 cost time: 0.43763256072998047
Epoch: 7, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 8 cost time: 0.4970283508300781
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 9 cost time: 0.40442562103271484
Epoch: 9, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 10 cost time: 0.4414529800415039
Epoch: 10, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5687494277954102
Epoch: 11, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5459041595458984
Epoch: 12, Steps: 1 | Train Loss: 0.761 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5065650939941406
Epoch: 13, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5120816230773926
Epoch: 14, Steps: 1 | Train Loss: 0.645 Vali Loss: 1.045 Vali Acc: 0.533 Test Loss: 1.045 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 15 cost time: 0.5165092945098877
Epoch: 15, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.049 Vali Acc: 0.533 Test Loss: 1.049 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4474010467529297
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.055 Vali Acc: 0.533 Test Loss: 1.055 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.45508289337158203
Epoch: 17, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.061 Vali Acc: 0.533 Test Loss: 1.061 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5011210441589355
Epoch: 18, Steps: 1 | Train Loss: 0.441 Vali Loss: 1.069 Vali Acc: 0.600 Test Loss: 1.069 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 19 cost time: 0.3953211307525635
Epoch: 19, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.077 Vali Acc: 0.600 Test Loss: 1.077 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4981684684753418
Epoch: 20, Steps: 1 | Train Loss: 0.357 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5580346584320068
Epoch: 21, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.095 Vali Acc: 0.467 Test Loss: 1.095 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5856122970581055
Epoch: 22, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4576303958892822
Epoch: 23, Steps: 1 | Train Loss: 0.256 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.4630544185638428
Epoch: 24, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6311688423156738
Epoch: 25, Steps: 1 | Train Loss: 0.204 Vali Loss: 1.136 Vali Acc: 0.467 Test Loss: 1.136 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4269218444824219
Epoch: 26, Steps: 1 | Train Loss: 0.182 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5231683254241943
Epoch: 27, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.157 Vali Acc: 0.400 Test Loss: 1.157 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5222265720367432
Epoch: 28, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 476689
model size : 1.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs107_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.805483341217041
Epoch: 1, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4571232795715332
Epoch: 2, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.37101244926452637
Epoch: 3, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.42766284942626953
Epoch: 4, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4866969585418701
Epoch: 5, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4299285411834717
Epoch: 6, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5381617546081543
Epoch: 7, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5201563835144043
Epoch: 8, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.035 Vali Acc: 0.333 Test Loss: 1.035 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5635759830474854
Epoch: 9, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.036 Vali Acc: 0.333 Test Loss: 1.036 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5596685409545898
Epoch: 10, Steps: 1 | Train Loss: 0.710 Vali Loss: 1.038 Vali Acc: 0.333 Test Loss: 1.038 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5082283020019531
Epoch: 11, Steps: 1 | Train Loss: 0.662 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.41717958450317383
Epoch: 12, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5184645652770996
Epoch: 13, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.047 Vali Acc: 0.333 Test Loss: 1.047 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5386180877685547
Epoch: 14, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4111166000366211
Epoch: 15, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.056 Vali Acc: 0.333 Test Loss: 1.056 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs107_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 475307
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs92_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.4329075813293457
Epoch: 1, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5490520000457764
Epoch: 2, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5280725955963135
Epoch: 3, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.4404282569885254
Epoch: 4, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.4254879951477051
Epoch: 5, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5081782341003418
Epoch: 6, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.107 Vali Acc: 0.467 Test Loss: 1.107 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5081703662872314
Epoch: 7, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.47551965713500977
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.4799201488494873
Epoch: 9, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.592273473739624
Epoch: 10, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.111 Vali Acc: 0.533 Test Loss: 1.111 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.570542573928833
Epoch: 11, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4171004295349121
Epoch: 12, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.117 Vali Acc: 0.467 Test Loss: 1.117 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.453021764755249
Epoch: 13, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4570348262786865
Epoch: 14, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4927365779876709
Epoch: 15, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.3827402591705322
Epoch: 16, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4814319610595703
Epoch: 17, Steps: 1 | Train Loss: 0.512 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.524730920791626
Epoch: 18, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.47017669677734375
Epoch: 19, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3999359607696533
Epoch: 20, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs92_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 474697
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5191981792449951
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5999929904937744
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5821070671081543
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.46599864959716797
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.491253137588501
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5443661212921143
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.38674020767211914
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 0.956 Vali Acc: 0.600 Test Loss: 0.956 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4693260192871094
Epoch: 8, Steps: 1 | Train Loss: 1.013 Vali Loss: 0.957 Vali Acc: 0.600 Test Loss: 0.957 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.45763444900512695
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 0.958 Vali Acc: 0.600 Test Loss: 0.958 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5341541767120361
Epoch: 10, Steps: 1 | Train Loss: 0.900 Vali Loss: 0.960 Vali Acc: 0.600 Test Loss: 0.960 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.34535694122314453
Epoch: 11, Steps: 1 | Train Loss: 0.841 Vali Loss: 0.963 Vali Acc: 0.600 Test Loss: 0.963 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 470635
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5396091938018799
Epoch: 1, Steps: 1 | Train Loss: 1.153 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.47814416885375977
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4174313545227051
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5204527378082275
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.466766357421875
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4532191753387451
Epoch: 6, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.055 Vali Acc: 0.400 Test Loss: 1.055 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5552036762237549
Epoch: 7, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.45569944381713867
Epoch: 8, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.060 Vali Acc: 0.333 Test Loss: 1.060 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6107385158538818
Epoch: 9, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7244958877563477
Epoch: 10, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.407529354095459
Epoch: 11, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.38967180252075195
Epoch: 12, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.076 Vali Acc: 0.267 Test Loss: 1.076 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.49755024909973145
Epoch: 13, Steps: 1 | Train Loss: 0.690 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4462881088256836
Epoch: 14, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.3798367977142334
Epoch: 15, Steps: 1 | Train Loss: 0.583 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 474769
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7391636371612549
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.46674466133117676
Epoch: 2, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4618105888366699
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45946598052978516
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.42943787574768066
Epoch: 5, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5536165237426758
Epoch: 6, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5380654335021973
Epoch: 7, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4855809211730957
Epoch: 8, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.47379446029663086
Epoch: 9, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4563717842102051
Epoch: 10, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.197 Vali Acc: 0.400 Test Loss: 1.197 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5148372650146484
Epoch: 11, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4895493984222412
Epoch: 12, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4508476257324219
Epoch: 13, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4039278030395508
Epoch: 14, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4381752014160156
Epoch: 15, Steps: 1 | Train Loss: 0.552 Vali Loss: 1.227 Vali Acc: 0.400 Test Loss: 1.227 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5702927112579346
Epoch: 16, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.44957804679870605
Epoch: 17, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.44533276557922363
Epoch: 18, Steps: 1 | Train Loss: 0.416 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 468667
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.00722336769104
Epoch: 1, Steps: 1 | Train Loss: 1.188 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4685096740722656
Epoch: 2, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.146 Vali Acc: 0.200 Test Loss: 1.146 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.4535388946533203
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.47351670265197754
Epoch: 4, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.4396200180053711
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5157866477966309
Epoch: 6, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.5740220546722412
Epoch: 7, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.39287233352661133
Epoch: 8, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.46932172775268555
Epoch: 9, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.4826664924621582
Epoch: 10, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.4286623001098633
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.43141770362854004
Epoch: 12, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.5344333648681641
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5665457248687744
Epoch: 14, Steps: 1 | Train Loss: 0.617 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.503448486328125
Epoch: 15, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4061896800994873
Epoch: 16, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4947397708892822
Epoch: 17, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.574174165725708
Epoch: 18, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 19 cost time: 0.5236532688140869
Epoch: 19, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.145 Vali Acc: 0.467 Test Loss: 1.145 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.4180788993835449
Epoch: 20, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5551011562347412
Epoch: 21, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.161 Vali Acc: 0.467 Test Loss: 1.161 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49172258377075195
Epoch: 22, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4396350383758545
Epoch: 23, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.42554140090942383
Epoch: 24, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.190 Vali Acc: 0.400 Test Loss: 1.190 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.42894625663757324
Epoch: 25, Steps: 1 | Train Loss: 0.200 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4130220413208008
Epoch: 26, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4078495502471924
Epoch: 27, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.220 Vali Acc: 0.267 Test Loss: 1.220 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.48099255561828613
Epoch: 28, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.44719743728637695
Epoch: 29, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.241 Vali Acc: 0.333 Test Loss: 1.241 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 473833
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6216011047363281
Epoch: 1, Steps: 1 | Train Loss: 1.370 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4490387439727783
Epoch: 2, Steps: 1 | Train Loss: 1.344 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.41272497177124023
Epoch: 3, Steps: 1 | Train Loss: 1.317 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.5113341808319092
Epoch: 4, Steps: 1 | Train Loss: 1.291 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.4691345691680908
Epoch: 5, Steps: 1 | Train Loss: 1.265 Vali Loss: 1.112 Vali Acc: 0.267 Test Loss: 1.112 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5815379619598389
Epoch: 6, Steps: 1 | Train Loss: 1.239 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.468639612197876
Epoch: 7, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.43841075897216797
Epoch: 8, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.45424771308898926
Epoch: 9, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.40578222274780273
Epoch: 10, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5062825679779053
Epoch: 11, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.47381591796875
Epoch: 12, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.41527843475341797
Epoch: 13, Steps: 1 | Train Loss: 0.767 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.3696279525756836
Epoch: 14, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4693763256072998
Epoch: 15, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4487593173980713
Epoch: 16, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.41544032096862793
Epoch: 17, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.120 Vali Acc: 0.333 Test Loss: 1.120 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.48183441162109375
Epoch: 18, Steps: 1 | Train Loss: 0.469 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.46343016624450684
Epoch: 19, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.40172505378723145
Epoch: 20, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6364092826843262
Epoch: 21, Steps: 1 | Train Loss: 0.336 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 472603
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.4170284271240234
Epoch: 1, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
Validation loss decreased (inf --> -0.133320).  Saving model ...
Epoch: 2 cost time: 0.4657585620880127
Epoch: 2, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.301 Vali Acc: 0.133 Test Loss: 1.301 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 3 cost time: 0.4178035259246826
Epoch: 3, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.300 Vali Acc: 0.133 Test Loss: 1.300 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 4 cost time: 0.47453927993774414
Epoch: 4, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.299 Vali Acc: 0.133 Test Loss: 1.299 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 5 cost time: 0.5578429698944092
Epoch: 5, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
Validation loss decreased (-0.133320 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.46539998054504395
Epoch: 6, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.4784576892852783
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.295 Vali Acc: 0.200 Test Loss: 1.295 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 8 cost time: 0.4706745147705078
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.294 Vali Acc: 0.200 Test Loss: 1.294 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.5029656887054443
Epoch: 9, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 10 cost time: 0.4610602855682373
Epoch: 10, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.290 Vali Acc: 0.200 Test Loss: 1.290 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 11 cost time: 0.4210221767425537
Epoch: 11, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 12 cost time: 0.5261518955230713
Epoch: 12, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 13 cost time: 0.45036959648132324
Epoch: 13, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5265681743621826
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.291 Vali Acc: 0.200 Test Loss: 1.291 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.45778632164001465
Epoch: 15, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.293 Vali Acc: 0.267 Test Loss: 1.293 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 16 cost time: 0.5768299102783203
Epoch: 16, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.296 Vali Acc: 0.267 Test Loss: 1.296 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5090377330780029
Epoch: 17, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.300 Vali Acc: 0.267 Test Loss: 1.300 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5261616706848145
Epoch: 18, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.305 Vali Acc: 0.267 Test Loss: 1.305 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4968984127044678
Epoch: 19, Steps: 1 | Train Loss: 0.371 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.40514469146728516
Epoch: 20, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.316 Vali Acc: 0.133 Test Loss: 1.316 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5808157920837402
Epoch: 21, Steps: 1 | Train Loss: 0.302 Vali Loss: 1.323 Vali Acc: 0.133 Test Loss: 1.323 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4091060161590576
Epoch: 22, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.329 Vali Acc: 0.133 Test Loss: 1.329 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5011136531829834
Epoch: 23, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.336 Vali Acc: 0.133 Test Loss: 1.336 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.40950441360473633
Epoch: 24, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.343 Vali Acc: 0.200 Test Loss: 1.343 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.4398634433746338
Epoch: 25, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.351 Vali Acc: 0.200 Test Loss: 1.351 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 473425
model size : 1.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8676965236663818
Epoch: 1, Steps: 1 | Train Loss: 1.169 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5212428569793701
Epoch: 2, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.529198169708252
Epoch: 3, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4145779609680176
Epoch: 4, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48624277114868164
Epoch: 5, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4922306537628174
Epoch: 6, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.39626049995422363
Epoch: 7, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.5282812118530273
Epoch: 8, Steps: 1 | Train Loss: 0.969 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.47930288314819336
Epoch: 9, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.582007884979248
Epoch: 10, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.359011173248291
Epoch: 11, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 469131
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5619158744812012
Epoch: 1, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5471320152282715
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5707674026489258
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4463682174682617
Epoch: 4, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4418768882751465
Epoch: 5, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5194323062896729
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.45839405059814453
Epoch: 7, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.47765541076660156
Epoch: 8, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.6045060157775879
Epoch: 9, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5324256420135498
Epoch: 10, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.49145960807800293
Epoch: 11, Steps: 1 | Train Loss: 0.692 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4951808452606201
Epoch: 12, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5546202659606934
Epoch: 13, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.193 Vali Acc: 0.200 Test Loss: 1.193 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5045115947723389
Epoch: 14, Steps: 1 | Train Loss: 0.549 Vali Loss: 1.197 Vali Acc: 0.200 Test Loss: 1.197 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.48587512969970703
Epoch: 15, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5366437435150146
Epoch: 16, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.553992509841919
Epoch: 17, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5823519229888916
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 19 cost time: 0.45189690589904785
Epoch: 19, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.229 Vali Acc: 0.267 Test Loss: 1.229 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5422298908233643
Epoch: 20, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.4527013301849365
Epoch: 21, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5593557357788086
Epoch: 22, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4766273498535156
Epoch: 23, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6151962280273438
Epoch: 24, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6597926616668701
Epoch: 25, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.280 Vali Acc: 0.200 Test Loss: 1.280 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5647938251495361
Epoch: 26, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.289 Vali Acc: 0.200 Test Loss: 1.289 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5402359962463379
Epoch: 27, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.297 Vali Acc: 0.200 Test Loss: 1.297 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.5418004989624023
Epoch: 28, Steps: 1 | Train Loss: 0.131 Vali Loss: 1.306 Vali Acc: 0.200 Test Loss: 1.306 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 469449
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7868564128875732
Epoch: 1, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.39180874824523926
Epoch: 2, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.486253023147583
Epoch: 3, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.48337435722351074
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5539798736572266
Epoch: 5, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5424957275390625
Epoch: 6, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45442843437194824
Epoch: 7, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.42386531829833984
Epoch: 8, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4140141010284424
Epoch: 9, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4821629524230957
Epoch: 10, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.154 Vali Acc: 0.200 Test Loss: 1.154 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48618364334106445
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.157 Vali Acc: 0.133 Test Loss: 1.157 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 465931
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7049119472503662
Epoch: 1, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.44260120391845703
Epoch: 2, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.43094611167907715
Epoch: 3, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4677853584289551
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.40971803665161133
Epoch: 5, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.058 Vali Acc: 0.267 Test Loss: 1.058 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4446115493774414
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.059 Vali Acc: 0.267 Test Loss: 1.059 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.42311859130859375
Epoch: 7, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.059 Vali Acc: 0.400 Test Loss: 1.059 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.39597177505493164
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.42240357398986816
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6679689884185791
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.4517543315887451
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.3559105396270752
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5385961532592773
Epoch: 13, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.40708470344543457
Epoch: 14, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.49832773208618164
Epoch: 15, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5289549827575684
Epoch: 16, Steps: 1 | Train Loss: 0.519 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5015599727630615
Epoch: 17, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5887532234191895
Epoch: 18, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4676015377044678
Epoch: 19, Steps: 1 | Train Loss: 0.387 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5001480579376221
Epoch: 20, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 469585
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5625429153442383
Epoch: 1, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.105 Vali Acc: 0.333 Test Loss: 1.105 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4947535991668701
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4754519462585449
Epoch: 3, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.534806489944458
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4333052635192871
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5467863082885742
Epoch: 6, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.46381306648254395
Epoch: 7, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.48469114303588867
Epoch: 8, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4913947582244873
Epoch: 9, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.115 Vali Acc: 0.267 Test Loss: 1.115 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5423898696899414
Epoch: 10, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4659616947174072
Epoch: 11, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 470683
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6439800262451172
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4630722999572754
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4866197109222412
Epoch: 3, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.42041611671447754
Epoch: 4, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.4464716911315918
Epoch: 5, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.187 Vali Acc: 0.267 Test Loss: 1.187 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.494110107421875
Epoch: 6, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.43364834785461426
Epoch: 7, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.185 Vali Acc: 0.267 Test Loss: 1.185 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.4824259281158447
Epoch: 8, Steps: 1 | Train Loss: 0.875 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.480074405670166
Epoch: 9, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.5038800239562988
Epoch: 10, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.4817163944244385
Epoch: 11, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5740358829498291
Epoch: 12, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5944743156433105
Epoch: 13, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5240850448608398
Epoch: 14, Steps: 1 | Train Loss: 0.584 Vali Loss: 1.187 Vali Acc: 0.200 Test Loss: 1.187 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5309281349182129
Epoch: 15, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.190 Vali Acc: 0.133 Test Loss: 1.190 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.584296703338623
Epoch: 16, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.194 Vali Acc: 0.133 Test Loss: 1.194 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5611448287963867
Epoch: 17, Steps: 1 | Train Loss: 0.450 Vali Loss: 1.199 Vali Acc: 0.133 Test Loss: 1.199 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5032684803009033
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.204 Vali Acc: 0.133 Test Loss: 1.204 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.47617053985595703
Epoch: 19, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4494154453277588
Epoch: 20, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.217 Vali Acc: 0.200 Test Loss: 1.217 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5669775009155273
Epoch: 21, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 469225
model size : 1.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7302629947662354
Epoch: 1, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5073451995849609
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.44447898864746094
Epoch: 3, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.6375839710235596
Epoch: 4, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.481626033782959
Epoch: 5, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.3799121379852295
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5067338943481445
Epoch: 7, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5880563259124756
Epoch: 8, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5208423137664795
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4512667655944824
Epoch: 10, Steps: 1 | Train Loss: 0.820 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5791060924530029
Epoch: 11, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6078002452850342
Epoch: 12, Steps: 1 | Train Loss: 0.704 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4497833251953125
Epoch: 13, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.49834275245666504
Epoch: 14, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 465211
model size : 1.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7278695106506348
Epoch: 1, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5909154415130615
Epoch: 2, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.45775437355041504
Epoch: 3, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4238169193267822
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5063543319702148
Epoch: 5, Steps: 1 | Train Loss: 1.057 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4851222038269043
Epoch: 6, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.4970676898956299
Epoch: 7, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.4521486759185791
Epoch: 8, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.43787121772766113
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.39673852920532227
Epoch: 10, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.42952537536621094
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.5719342231750488
Epoch: 12, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 13 cost time: 0.49984240531921387
Epoch: 13, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.45495128631591797
Epoch: 14, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7417595386505127
Epoch: 15, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.445082426071167
Epoch: 16, Steps: 1 | Train Loss: 0.518 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.4101908206939697
Epoch: 17, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.48960161209106445
Epoch: 18, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4407358169555664
Epoch: 19, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5635786056518555
Epoch: 20, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.191 Vali Acc: 0.200 Test Loss: 1.191 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5139257907867432
Epoch: 21, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4397244453430176
Epoch: 22, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm256_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 472209
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.665670394897461
Epoch: 1, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.39894771575927734
Epoch: 2, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.075 Vali Acc: 0.533 Test Loss: 1.075 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45960307121276855
Epoch: 3, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5107684135437012
Epoch: 4, Steps: 1 | Train Loss: 1.097 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4257228374481201
Epoch: 5, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5093567371368408
Epoch: 6, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.078 Vali Acc: 0.533 Test Loss: 1.078 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.36156463623046875
Epoch: 7, Steps: 1 | Train Loss: 1.015 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.42584848403930664
Epoch: 8, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.082 Vali Acc: 0.533 Test Loss: 1.082 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.447857141494751
Epoch: 9, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.4315805435180664
Epoch: 10, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48998188972473145
Epoch: 11, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 451835
model size : 1.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs214_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7907695770263672
Epoch: 1, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.597219705581665
Epoch: 2, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.45605039596557617
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.40869784355163574
Epoch: 4, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.4080328941345215
Epoch: 5, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.5149242877960205
Epoch: 6, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.48215222358703613
Epoch: 7, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.39567995071411133
Epoch: 8, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.45118260383605957
Epoch: 9, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5190651416778564
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.061 Vali Acc: 0.467 Test Loss: 1.061 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.47278332710266113
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.062 Vali Acc: 0.400 Test Loss: 1.062 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.40875792503356934
Epoch: 12, Steps: 1 | Train Loss: 0.733 Vali Loss: 1.063 Vali Acc: 0.467 Test Loss: 1.063 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6827511787414551
Epoch: 13, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.510082483291626
Epoch: 14, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.46826744079589844
Epoch: 15, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4996824264526367
Epoch: 16, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.47040271759033203
Epoch: 17, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5773515701293945
Epoch: 18, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5011897087097168
Epoch: 19, Steps: 1 | Train Loss: 0.386 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.444089412689209
Epoch: 20, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs214_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 446345
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5974619388580322
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5569422245025635
Epoch: 2, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5154955387115479
Epoch: 3, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.38083648681640625
Epoch: 4, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.3847653865814209
Epoch: 5, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46064019203186035
Epoch: 6, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.3905000686645508
Epoch: 7, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.108 Vali Acc: 0.267 Test Loss: 1.108 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.3581397533416748
Epoch: 8, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.3756752014160156
Epoch: 9, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5828826427459717
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5117928981781006
Epoch: 11, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5538702011108398
Epoch: 12, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5663177967071533
Epoch: 13, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5220010280609131
Epoch: 14, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4795811176300049
Epoch: 15, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4836392402648926
Epoch: 16, Steps: 1 | Train Loss: 0.537 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6183621883392334
Epoch: 17, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.127 Vali Acc: 0.333 Test Loss: 1.127 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.45746946334838867
Epoch: 18, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5581624507904053
Epoch: 19, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.505469560623169
Epoch: 20, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 441627
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6886000633239746
Epoch: 1, Steps: 1 | Train Loss: 1.247 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5608861446380615
Epoch: 2, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5155808925628662
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.44754910469055176
Epoch: 4, Steps: 1 | Train Loss: 1.175 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5112061500549316
Epoch: 5, Steps: 1 | Train Loss: 1.152 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4195268154144287
Epoch: 6, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.40343308448791504
Epoch: 7, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.5635206699371338
Epoch: 8, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4619417190551758
Epoch: 9, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4225344657897949
Epoch: 10, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4388437271118164
Epoch: 11, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4494190216064453
Epoch: 12, Steps: 1 | Train Loss: 0.800 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.518326997756958
Epoch: 13, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.49147915840148926
Epoch: 14, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.39403629302978516
Epoch: 15, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 16 cost time: 0.46122193336486816
Epoch: 16, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4212791919708252
Epoch: 17, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.45252537727355957
Epoch: 18, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5073347091674805
Epoch: 19, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 20 cost time: 0.5345056056976318
Epoch: 20, Steps: 1 | Train Loss: 0.379 Vali Loss: 1.235 Vali Acc: 0.400 Test Loss: 1.235 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4195106029510498
Epoch: 21, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4619460105895996
Epoch: 22, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.47582411766052246
Epoch: 23, Steps: 1 | Train Loss: 0.273 Vali Loss: 1.265 Vali Acc: 0.333 Test Loss: 1.265 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5643575191497803
Epoch: 24, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5045292377471924
Epoch: 25, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5046823024749756
Epoch: 26, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5421402454376221
Epoch: 27, Steps: 1 | Train Loss: 0.172 Vali Loss: 1.303 Vali Acc: 0.200 Test Loss: 1.303 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5693376064300537
Epoch: 28, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4897172451019287
Epoch: 29, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.321 Vali Acc: 0.200 Test Loss: 1.321 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 439601
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs107_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6888747215270996
Epoch: 1, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.4217543601989746
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.257 Vali Acc: 0.267 Test Loss: 1.257 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5460407733917236
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.5331528186798096
Epoch: 4, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.255 Vali Acc: 0.267 Test Loss: 1.255 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.45410799980163574
Epoch: 5, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.49982166290283203
Epoch: 6, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.252 Vali Acc: 0.267 Test Loss: 1.252 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.4745609760284424
Epoch: 7, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 8 cost time: 0.4564988613128662
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.7481086254119873
Epoch: 9, Steps: 1 | Train Loss: 0.849 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 10 cost time: 0.474193811416626
Epoch: 10, Steps: 1 | Train Loss: 0.795 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.5092928409576416
Epoch: 11, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.247 Vali Acc: 0.333 Test Loss: 1.247 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 12 cost time: 0.4132347106933594
Epoch: 12, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5399141311645508
Epoch: 13, Steps: 1 | Train Loss: 0.633 Vali Loss: 1.249 Vali Acc: 0.333 Test Loss: 1.249 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.536813497543335
Epoch: 14, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.250 Vali Acc: 0.333 Test Loss: 1.250 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46387505531311035
Epoch: 15, Steps: 1 | Train Loss: 0.532 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5645236968994141
Epoch: 16, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.256 Vali Acc: 0.333 Test Loss: 1.256 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4615671634674072
Epoch: 17, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.260 Vali Acc: 0.267 Test Loss: 1.260 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.46149158477783203
Epoch: 18, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5188021659851074
Epoch: 19, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.269 Vali Acc: 0.267 Test Loss: 1.269 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5123493671417236
Epoch: 20, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.275 Vali Acc: 0.267 Test Loss: 1.275 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.43541765213012695
Epoch: 21, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.281 Vali Acc: 0.333 Test Loss: 1.281 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs107_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 439563
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs92_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7789497375488281
Epoch: 1, Steps: 1 | Train Loss: 1.241 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5219361782073975
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5082194805145264
Epoch: 3, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4418625831604004
Epoch: 4, Steps: 1 | Train Loss: 1.167 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.49077677726745605
Epoch: 5, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4380056858062744
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4355809688568115
Epoch: 7, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6214487552642822
Epoch: 8, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4906644821166992
Epoch: 9, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4966471195220947
Epoch: 10, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4818277359008789
Epoch: 11, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5402569770812988
Epoch: 12, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5908560752868652
Epoch: 13, Steps: 1 | Train Loss: 0.717 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.47204041481018066
Epoch: 14, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5984995365142822
Epoch: 15, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.185 Vali Acc: 0.200 Test Loss: 1.185 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5380332469940186
Epoch: 16, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.192 Vali Acc: 0.200 Test Loss: 1.192 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5047566890716553
Epoch: 17, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs92_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 439913
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6583824157714844
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.114 Vali Acc: 0.200 Test Loss: 1.114 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.4779226779937744
Epoch: 2, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.45118188858032227
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5011556148529053
Epoch: 4, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.4770636558532715
Epoch: 5, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.48112964630126953
Epoch: 6, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45376157760620117
Epoch: 7, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.118 Vali Acc: 0.200 Test Loss: 1.118 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4085869789123535
Epoch: 8, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.120 Vali Acc: 0.200 Test Loss: 1.120 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.4574768543243408
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.5157918930053711
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5011422634124756
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5315775871276855
Epoch: 12, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.134 Vali Acc: 0.333 Test Loss: 1.134 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5500659942626953
Epoch: 13, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5198819637298584
Epoch: 14, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 15 cost time: 0.5263972282409668
Epoch: 15, Steps: 1 | Train Loss: 0.587 Vali Loss: 1.151 Vali Acc: 0.467 Test Loss: 1.151 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5285077095031738
Epoch: 16, Steps: 1 | Train Loss: 0.535 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5180983543395996
Epoch: 17, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.49480509757995605
Epoch: 18, Steps: 1 | Train Loss: 0.440 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5959944725036621
Epoch: 19, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.182 Vali Acc: 0.333 Test Loss: 1.182 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.3960120677947998
Epoch: 20, Steps: 1 | Train Loss: 0.358 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5408964157104492
Epoch: 21, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5431504249572754
Epoch: 22, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.401228666305542
Epoch: 23, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5003528594970703
Epoch: 24, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 436619
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6437911987304688
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5150101184844971
Epoch: 2, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.43065810203552246
Epoch: 3, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4070281982421875
Epoch: 4, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5759754180908203
Epoch: 5, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.548133373260498
Epoch: 6, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5440328121185303
Epoch: 7, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.41052746772766113
Epoch: 8, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4152979850769043
Epoch: 9, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5218186378479004
Epoch: 10, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3874516487121582
Epoch: 11, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.087 Vali Acc: 0.467 Test Loss: 1.087 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4918549060821533
Epoch: 12, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5960309505462646
Epoch: 13, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4668731689453125
Epoch: 14, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.44011402130126953
Epoch: 15, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5828638076782227
Epoch: 16, Steps: 1 | Train Loss: 0.551 Vali Loss: 1.110 Vali Acc: 0.467 Test Loss: 1.110 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5281577110290527
Epoch: 17, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 441265
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5899035930633545
Epoch: 1, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4172039031982422
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.4982571601867676
Epoch: 3, Steps: 1 | Train Loss: 1.183 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5231077671051025
Epoch: 4, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.42136502265930176
Epoch: 5, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46213579177856445
Epoch: 6, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.47796010971069336
Epoch: 7, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4078652858734131
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4007303714752197
Epoch: 9, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.167 Vali Acc: 0.400 Test Loss: 1.167 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.40402936935424805
Epoch: 10, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.4735438823699951
Epoch: 11, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.4830636978149414
Epoch: 12, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.32903146743774414
Epoch: 13, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.49494194984436035
Epoch: 14, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 435675
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8010728359222412
Epoch: 1, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.027 Vali Acc: 0.467 Test Loss: 1.027 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5352911949157715
Epoch: 2, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.3976325988769531
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4529438018798828
Epoch: 4, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.025 Vali Acc: 0.533 Test Loss: 1.025 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.43231773376464844
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.024 Vali Acc: 0.600 Test Loss: 1.024 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.46440744400024414
Epoch: 6, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.44431591033935547
Epoch: 7, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.022 Vali Acc: 0.600 Test Loss: 1.022 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.5868411064147949
Epoch: 8, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.021 Vali Acc: 0.667 Test Loss: 1.021 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.4303305149078369
Epoch: 9, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.020 Vali Acc: 0.667 Test Loss: 1.020 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 10 cost time: 0.4522097110748291
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.020 Vali Acc: 0.667 Test Loss: 1.020 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666656).  Saving model ...
Epoch: 11 cost time: 0.44551658630371094
Epoch: 11, Steps: 1 | Train Loss: 0.794 Vali Loss: 1.020 Vali Acc: 0.667 Test Loss: 1.020 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5451149940490723
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.021 Vali Acc: 0.667 Test Loss: 1.021 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4928414821624756
Epoch: 13, Steps: 1 | Train Loss: 0.680 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5067272186279297
Epoch: 14, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.46514892578125
Epoch: 15, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.48569321632385254
Epoch: 16, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.034 Vali Acc: 0.467 Test Loss: 1.034 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4858083724975586
Epoch: 17, Steps: 1 | Train Loss: 0.474 Vali Loss: 1.039 Vali Acc: 0.467 Test Loss: 1.039 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5058422088623047
Epoch: 18, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5095069408416748
Epoch: 19, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.052 Vali Acc: 0.400 Test Loss: 1.052 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5315616130828857
Epoch: 20, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 441161
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.855567455291748
Epoch: 1, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.089 Vali Acc: 0.600 Test Loss: 1.089 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.45582127571105957
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.5231313705444336
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.5793771743774414
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.087 Vali Acc: 0.600 Test Loss: 1.087 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.49675631523132324
Epoch: 5, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 6 cost time: 0.5156111717224121
Epoch: 6, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 7 cost time: 0.509918212890625
Epoch: 7, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.486583948135376
Epoch: 8, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.524116039276123
Epoch: 9, Steps: 1 | Train Loss: 0.811 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.48457884788513184
Epoch: 10, Steps: 1 | Train Loss: 0.760 Vali Loss: 1.085 Vali Acc: 0.600 Test Loss: 1.085 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6402637958526611
Epoch: 11, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.086 Vali Acc: 0.600 Test Loss: 1.086 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6369907855987549
Epoch: 12, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.088 Vali Acc: 0.600 Test Loss: 1.088 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4886610507965088
Epoch: 13, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.090 Vali Acc: 0.667 Test Loss: 1.090 Test Acc: 0.667
Validation loss decreased (-0.599989 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.44484591484069824
Epoch: 14, Steps: 1 | Train Loss: 0.556 Vali Loss: 1.093 Vali Acc: 0.600 Test Loss: 1.093 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.590308666229248
Epoch: 15, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.097 Vali Acc: 0.600 Test Loss: 1.097 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4674532413482666
Epoch: 16, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.102 Vali Acc: 0.600 Test Loss: 1.102 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.49248433113098145
Epoch: 17, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.107 Vali Acc: 0.600 Test Loss: 1.107 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5078697204589844
Epoch: 18, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.112 Vali Acc: 0.533 Test Loss: 1.112 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5203855037689209
Epoch: 19, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.46790122985839844
Epoch: 20, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.126 Vali Acc: 0.467 Test Loss: 1.126 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.4937744140625
Epoch: 21, Steps: 1 | Train Loss: 0.280 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5791580677032471
Epoch: 22, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4647941589355469
Epoch: 23, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.148 Vali Acc: 0.467 Test Loss: 1.148 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 440251
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5501527786254883
Epoch: 1, Steps: 1 | Train Loss: 1.151 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.5588414669036865
Epoch: 2, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.45644354820251465
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.41307687759399414
Epoch: 4, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5828886032104492
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.4560532569885254
Epoch: 6, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4670374393463135
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.458207368850708
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.159 Vali Acc: 0.400 Test Loss: 1.159 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.6015622615814209
Epoch: 9, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5192394256591797
Epoch: 10, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.570091724395752
Epoch: 11, Steps: 1 | Train Loss: 0.796 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5797014236450195
Epoch: 12, Steps: 1 | Train Loss: 0.740 Vali Loss: 1.161 Vali Acc: 0.267 Test Loss: 1.161 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5185484886169434
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.506260871887207
Epoch: 14, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6729137897491455
Epoch: 15, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.533470869064331
Epoch: 16, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.48097801208496094
Epoch: 17, Steps: 1 | Train Loss: 0.479 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5153846740722656
Epoch: 18, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 441329
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7584891319274902
Epoch: 1, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6227312088012695
Epoch: 2, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5747394561767578
Epoch: 3, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.46427369117736816
Epoch: 4, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.451465368270874
Epoch: 5, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5662813186645508
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5306272506713867
Epoch: 7, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.104 Vali Acc: 0.400 Test Loss: 1.104 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4092373847961426
Epoch: 8, Steps: 1 | Train Loss: 0.816 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5120577812194824
Epoch: 9, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4772319793701172
Epoch: 10, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 11 cost time: 0.40610814094543457
Epoch: 11, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.107 Vali Acc: 0.533 Test Loss: 1.107 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4068894386291504
Epoch: 12, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.109 Vali Acc: 0.533 Test Loss: 1.109 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4949061870574951
Epoch: 13, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.509929895401001
Epoch: 14, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.116 Vali Acc: 0.533 Test Loss: 1.116 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.44625353813171387
Epoch: 15, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.121 Vali Acc: 0.600 Test Loss: 1.121 Test Acc: 0.600
Validation loss decreased (-0.533322 --> -0.599989).  Saving model ...
Epoch: 16 cost time: 0.48689818382263184
Epoch: 16, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.126 Vali Acc: 0.600 Test Loss: 1.126 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.590935468673706
Epoch: 17, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.42505955696105957
Epoch: 18, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.140 Vali Acc: 0.533 Test Loss: 1.140 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4412496089935303
Epoch: 19, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.147 Vali Acc: 0.533 Test Loss: 1.147 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.4929037094116211
Epoch: 20, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.155 Vali Acc: 0.533 Test Loss: 1.155 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5324625968933105
Epoch: 21, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5262553691864014
Epoch: 22, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.172 Vali Acc: 0.533 Test Loss: 1.172 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6397285461425781
Epoch: 23, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5417869091033936
Epoch: 24, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.189 Vali Acc: 0.467 Test Loss: 1.189 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.45622730255126953
Epoch: 25, Steps: 1 | Train Loss: 0.175 Vali Loss: 1.198 Vali Acc: 0.400 Test Loss: 1.198 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 437291
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5415277481079102
Epoch: 1, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5400230884552002
Epoch: 2, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4695899486541748
Epoch: 3, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.45058155059814453
Epoch: 4, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.592322826385498
Epoch: 5, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4883568286895752
Epoch: 6, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6722590923309326
Epoch: 7, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6837713718414307
Epoch: 8, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6429531574249268
Epoch: 9, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5074524879455566
Epoch: 10, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4486818313598633
Epoch: 11, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5157320499420166
Epoch: 12, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.4661743640899658
Epoch: 13, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5361008644104004
Epoch: 14, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5178887844085693
Epoch: 15, Steps: 1 | Train Loss: 0.530 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 437801
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.799903392791748
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4730994701385498
Epoch: 2, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.4731736183166504
Epoch: 3, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.42351794242858887
Epoch: 4, Steps: 1 | Train Loss: 1.126 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5284585952758789
Epoch: 5, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4498922824859619
Epoch: 6, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4511868953704834
Epoch: 7, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5205066204071045
Epoch: 8, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.4347538948059082
Epoch: 9, Steps: 1 | Train Loss: 0.927 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.5794887542724609
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.47779369354248047
Epoch: 11, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41826701164245605
Epoch: 12, Steps: 1 | Train Loss: 0.743 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5009572505950928
Epoch: 13, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.171 Vali Acc: 0.467 Test Loss: 1.171 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 14 cost time: 0.4560716152191162
Epoch: 14, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.175 Vali Acc: 0.467 Test Loss: 1.175 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.3869326114654541
Epoch: 15, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.180 Vali Acc: 0.467 Test Loss: 1.180 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.4244511127471924
Epoch: 16, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.4184117317199707
Epoch: 17, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.193 Vali Acc: 0.400 Test Loss: 1.193 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.3945746421813965
Epoch: 18, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.499600887298584
Epoch: 19, Steps: 1 | Train Loss: 0.388 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5643124580383301
Epoch: 20, Steps: 1 | Train Loss: 0.350 Vali Loss: 1.219 Vali Acc: 0.400 Test Loss: 1.219 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6127798557281494
Epoch: 21, Steps: 1 | Train Loss: 0.314 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5207200050354004
Epoch: 22, Steps: 1 | Train Loss: 0.281 Vali Loss: 1.240 Vali Acc: 0.267 Test Loss: 1.240 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.460162878036499
Epoch: 23, Steps: 1 | Train Loss: 0.251 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 434475
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7824738025665283
Epoch: 1, Steps: 1 | Train Loss: 1.161 Vali Loss: 1.155 Vali Acc: 0.400 Test Loss: 1.155 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.35629844665527344
Epoch: 2, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.3541710376739502
Epoch: 3, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.4564530849456787
Epoch: 4, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.44565701484680176
Epoch: 5, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.149 Vali Acc: 0.400 Test Loss: 1.149 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5521068572998047
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.39641284942626953
Epoch: 7, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.43138742446899414
Epoch: 8, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.589740514755249
Epoch: 9, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 10 cost time: 0.5098192691802979
Epoch: 10, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.3806424140930176
Epoch: 11, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.48474860191345215
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.5311813354492188
Epoch: 13, Steps: 1 | Train Loss: 0.674 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5301775932312012
Epoch: 14, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.44179511070251465
Epoch: 15, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.43139100074768066
Epoch: 16, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.45581531524658203
Epoch: 17, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.4928476810455322
Epoch: 18, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5351657867431641
Epoch: 19, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4511260986328125
Epoch: 20, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5070655345916748
Epoch: 21, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6212542057037354
Epoch: 22, Steps: 1 | Train Loss: 0.277 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 438257
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6513431072235107
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.5492188930511475
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.48484134674072266
Epoch: 3, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.38961291313171387
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5615835189819336
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.111 Vali Acc: 0.133 Test Loss: 1.111 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5118129253387451
Epoch: 6, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.112 Vali Acc: 0.133 Test Loss: 1.112 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5213320255279541
Epoch: 7, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.41796422004699707
Epoch: 8, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.113 Vali Acc: 0.200 Test Loss: 1.113 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4511709213256836
Epoch: 9, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.115 Vali Acc: 0.200 Test Loss: 1.115 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5219860076904297
Epoch: 10, Steps: 1 | Train Loss: 0.803 Vali Loss: 1.117 Vali Acc: 0.200 Test Loss: 1.117 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3544292449951172
Epoch: 11, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.119 Vali Acc: 0.267 Test Loss: 1.119 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.45420408248901367
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5741703510284424
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5723211765289307
Epoch: 14, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4805564880371094
Epoch: 15, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.42840147018432617
Epoch: 16, Steps: 1 | Train Loss: 0.492 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 17 cost time: 0.4512348175048828
Epoch: 17, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5352811813354492
Epoch: 18, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.509765625
Epoch: 19, Steps: 1 | Train Loss: 0.367 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5457572937011719
Epoch: 20, Steps: 1 | Train Loss: 0.332 Vali Loss: 1.173 Vali Acc: 0.400 Test Loss: 1.173 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.49338412284851074
Epoch: 21, Steps: 1 | Train Loss: 0.299 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5574510097503662
Epoch: 22, Steps: 1 | Train Loss: 0.268 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.4759364128112793
Epoch: 23, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.4157247543334961
Epoch: 24, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.5380840301513672
Epoch: 25, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.4598112106323242
Epoch: 26, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.226 Vali Acc: 0.267 Test Loss: 1.226 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 439483
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.742382287979126
Epoch: 1, Steps: 1 | Train Loss: 1.410 Vali Loss: 1.105 Vali Acc: 0.533 Test Loss: 1.105 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5200543403625488
Epoch: 2, Steps: 1 | Train Loss: 1.381 Vali Loss: 1.101 Vali Acc: 0.533 Test Loss: 1.101 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.49593520164489746
Epoch: 3, Steps: 1 | Train Loss: 1.353 Vali Loss: 1.098 Vali Acc: 0.533 Test Loss: 1.098 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.4551370143890381
Epoch: 4, Steps: 1 | Train Loss: 1.325 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4473075866699219
Epoch: 5, Steps: 1 | Train Loss: 1.298 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.48212361335754395
Epoch: 6, Steps: 1 | Train Loss: 1.271 Vali Loss: 1.088 Vali Acc: 0.533 Test Loss: 1.088 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.5003857612609863
Epoch: 7, Steps: 1 | Train Loss: 1.223 Vali Loss: 1.084 Vali Acc: 0.533 Test Loss: 1.084 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 8 cost time: 0.45714306831359863
Epoch: 8, Steps: 1 | Train Loss: 1.164 Vali Loss: 1.080 Vali Acc: 0.533 Test Loss: 1.080 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.47672462463378906
Epoch: 9, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.076 Vali Acc: 0.533 Test Loss: 1.076 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5721070766448975
Epoch: 10, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 11 cost time: 0.4792969226837158
Epoch: 11, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.069 Vali Acc: 0.533 Test Loss: 1.069 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 12 cost time: 0.5033714771270752
Epoch: 12, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.066 Vali Acc: 0.533 Test Loss: 1.066 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 13 cost time: 0.602069616317749
Epoch: 13, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4685087203979492
Epoch: 14, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.4655590057373047
Epoch: 15, Steps: 1 | Train Loss: 0.687 Vali Loss: 1.064 Vali Acc: 0.533 Test Loss: 1.064 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 16 cost time: 0.6212127208709717
Epoch: 16, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.065 Vali Acc: 0.533 Test Loss: 1.065 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4509274959564209
Epoch: 17, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.068 Vali Acc: 0.533 Test Loss: 1.068 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.49199819564819336
Epoch: 18, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.461625337600708
Epoch: 19, Steps: 1 | Train Loss: 0.462 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5741398334503174
Epoch: 20, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4408552646636963
Epoch: 21, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6623492240905762
Epoch: 22, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.097 Vali Acc: 0.400 Test Loss: 1.097 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5391006469726562
Epoch: 23, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5708742141723633
Epoch: 24, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5173525810241699
Epoch: 25, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 438153
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7135534286499023
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.3898036479949951
Epoch: 2, Steps: 1 | Train Loss: 1.144 Vali Loss: 1.185 Vali Acc: 0.400 Test Loss: 1.185 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5413103103637695
Epoch: 3, Steps: 1 | Train Loss: 1.120 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.449953556060791
Epoch: 4, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.4362671375274658
Epoch: 5, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49998927116394043
Epoch: 6, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.180 Vali Acc: 0.267 Test Loss: 1.180 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.534477710723877
Epoch: 7, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5411150455474854
Epoch: 8, Steps: 1 | Train Loss: 0.959 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.4766499996185303
Epoch: 9, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5126268863677979
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5897572040557861
Epoch: 11, Steps: 1 | Train Loss: 0.792 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.6852710247039795
Epoch: 12, Steps: 1 | Train Loss: 0.736 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4783363342285156
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4510159492492676
Epoch: 14, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 434267
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6915462017059326
Epoch: 1, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5153801441192627
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4728586673736572
Epoch: 3, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4870922565460205
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.40927815437316895
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5012085437774658
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5649399757385254
Epoch: 7, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6649274826049805
Epoch: 8, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.49431586265563965
Epoch: 9, Steps: 1 | Train Loss: 0.823 Vali Loss: 1.084 Vali Acc: 0.333 Test Loss: 1.084 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5192046165466309
Epoch: 10, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.4693872928619385
Epoch: 11, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.48421621322631836
Epoch: 12, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4268510341644287
Epoch: 13, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm128_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 441329
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5922369956970215
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.40294837951660156
Epoch: 2, Steps: 1 | Train Loss: 1.099 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.45911192893981934
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4594132900238037
Epoch: 4, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.068 Vali Acc: 0.467 Test Loss: 1.068 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5215234756469727
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5466692447662354
Epoch: 6, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.36842823028564453
Epoch: 7, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5122470855712891
Epoch: 8, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.37137866020202637
Epoch: 9, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5122473239898682
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 11 cost time: 0.5010449886322021
Epoch: 11, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5692460536956787
Epoch: 12, Steps: 1 | Train Loss: 0.718 Vali Loss: 1.067 Vali Acc: 0.467 Test Loss: 1.067 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.3862922191619873
Epoch: 13, Steps: 1 | Train Loss: 0.664 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.46337342262268066
Epoch: 14, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.072 Vali Acc: 0.400 Test Loss: 1.072 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.46881914138793945
Epoch: 15, Steps: 1 | Train Loss: 0.561 Vali Loss: 1.076 Vali Acc: 0.400 Test Loss: 1.076 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4038560390472412
Epoch: 16, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.080 Vali Acc: 0.400 Test Loss: 1.080 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5645120143890381
Epoch: 17, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5302755832672119
Epoch: 18, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4609651565551758
Epoch: 19, Steps: 1 | Train Loss: 0.383 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5526015758514404
Epoch: 20, Steps: 1 | Train Loss: 0.346 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 431755
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs214_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7921273708343506
Epoch: 1, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.45671725273132324
Epoch: 2, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5085873603820801
Epoch: 3, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5570359230041504
Epoch: 4, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.451779842376709
Epoch: 5, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.45299315452575684
Epoch: 6, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.48415708541870117
Epoch: 7, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4730527400970459
Epoch: 8, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.167 Vali Acc: 0.467 Test Loss: 1.167 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.4675583839416504
Epoch: 9, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.166 Vali Acc: 0.467 Test Loss: 1.166 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.5175876617431641
Epoch: 10, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.4475078582763672
Epoch: 11, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.165 Vali Acc: 0.400 Test Loss: 1.165 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.43634867668151855
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.166 Vali Acc: 0.400 Test Loss: 1.166 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4822394847869873
Epoch: 13, Steps: 1 | Train Loss: 0.732 Vali Loss: 1.168 Vali Acc: 0.400 Test Loss: 1.168 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5353481769561768
Epoch: 14, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4910404682159424
Epoch: 15, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.521399974822998
Epoch: 16, Steps: 1 | Train Loss: 0.567 Vali Loss: 1.180 Vali Acc: 0.333 Test Loss: 1.180 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6325452327728271
Epoch: 17, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6650640964508057
Epoch: 18, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5248019695281982
Epoch: 19, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5826632976531982
Epoch: 20, Steps: 1 | Train Loss: 0.385 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs214_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 429657
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5380644798278809
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 0.955 Vali Acc: 0.600 Test Loss: 0.955 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5368683338165283
Epoch: 2, Steps: 1 | Train Loss: 1.156 Vali Loss: 0.954 Vali Acc: 0.600 Test Loss: 0.954 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.4164705276489258
Epoch: 3, Steps: 1 | Train Loss: 1.132 Vali Loss: 0.953 Vali Acc: 0.667 Test Loss: 0.953 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.4467489719390869
Epoch: 4, Steps: 1 | Train Loss: 1.109 Vali Loss: 0.953 Vali Acc: 0.733 Test Loss: 0.953 Test Acc: 0.733
Validation loss decreased (-0.666657 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 0.5437183380126953
Epoch: 5, Steps: 1 | Train Loss: 1.087 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 6 cost time: 0.48194169998168945
Epoch: 6, Steps: 1 | Train Loss: 1.065 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 7 cost time: 0.39624691009521484
Epoch: 7, Steps: 1 | Train Loss: 1.024 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 0.4844844341278076
Epoch: 8, Steps: 1 | Train Loss: 0.974 Vali Loss: 0.950 Vali Acc: 0.733 Test Loss: 0.950 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 9 cost time: 0.40323376655578613
Epoch: 9, Steps: 1 | Train Loss: 0.919 Vali Loss: 0.950 Vali Acc: 0.733 Test Loss: 0.950 Test Acc: 0.733
Validation loss decreased (-0.733324 --> -0.733324).  Saving model ...
Epoch: 10 cost time: 0.45219898223876953
Epoch: 10, Steps: 1 | Train Loss: 0.861 Vali Loss: 0.951 Vali Acc: 0.733 Test Loss: 0.951 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4286811351776123
Epoch: 11, Steps: 1 | Train Loss: 0.802 Vali Loss: 0.952 Vali Acc: 0.733 Test Loss: 0.952 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5182301998138428
Epoch: 12, Steps: 1 | Train Loss: 0.743 Vali Loss: 0.954 Vali Acc: 0.733 Test Loss: 0.954 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5157792568206787
Epoch: 13, Steps: 1 | Train Loss: 0.686 Vali Loss: 0.956 Vali Acc: 0.733 Test Loss: 0.956 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.3923351764678955
Epoch: 14, Steps: 1 | Train Loss: 0.632 Vali Loss: 0.960 Vali Acc: 0.667 Test Loss: 0.960 Test Acc: 0.667
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4826657772064209
Epoch: 15, Steps: 1 | Train Loss: 0.579 Vali Loss: 0.965 Vali Acc: 0.667 Test Loss: 0.965 Test Acc: 0.667
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5014293193817139
Epoch: 16, Steps: 1 | Train Loss: 0.529 Vali Loss: 0.970 Vali Acc: 0.667 Test Loss: 0.970 Test Acc: 0.667
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4204981327056885
Epoch: 17, Steps: 1 | Train Loss: 0.483 Vali Loss: 0.977 Vali Acc: 0.667 Test Loss: 0.977 Test Acc: 0.667
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5266463756561279
Epoch: 18, Steps: 1 | Train Loss: 0.439 Vali Loss: 0.984 Vali Acc: 0.600 Test Loss: 0.984 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.4421968460083008
Epoch: 19, Steps: 1 | Train Loss: 0.397 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 426667
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5386829376220703
Epoch: 1, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4920835494995117
Epoch: 2, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4679698944091797
Epoch: 3, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5781660079956055
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.46239376068115234
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.434999942779541
Epoch: 6, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49291205406188965
Epoch: 7, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5682706832885742
Epoch: 8, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4345386028289795
Epoch: 9, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.089 Vali Acc: 0.400 Test Loss: 1.089 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5091402530670166
Epoch: 10, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6422374248504639
Epoch: 11, Steps: 1 | Train Loss: 0.764 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5386021137237549
Epoch: 12, Steps: 1 | Train Loss: 0.706 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.629723310470581
Epoch: 13, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.4974944591522217
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 15 cost time: 0.47493529319763184
Epoch: 15, Steps: 1 | Train Loss: 0.545 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5224640369415283
Epoch: 16, Steps: 1 | Train Loss: 0.497 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.4817464351654053
Epoch: 17, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5747392177581787
Epoch: 18, Steps: 1 | Train Loss: 0.409 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5924301147460938
Epoch: 19, Steps: 1 | Train Loss: 0.370 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.48848867416381836
Epoch: 20, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5467267036437988
Epoch: 21, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5924808979034424
Epoch: 22, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.162 Vali Acc: 0.400 Test Loss: 1.162 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5715434551239014
Epoch: 23, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.172 Vali Acc: 0.400 Test Loss: 1.172 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5959563255310059
Epoch: 24, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 425665
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs107_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.4289004802703857
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.454571008682251
Epoch: 2, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46331262588500977
Epoch: 3, Steps: 1 | Train Loss: 1.036 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.41408467292785645
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.47101736068725586
Epoch: 5, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.4683248996734619
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.3442661762237549
Epoch: 7, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.4174156188964844
Epoch: 8, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5210988521575928
Epoch: 9, Steps: 1 | Train Loss: 0.851 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5026228427886963
Epoch: 10, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.45981669425964355
Epoch: 11, Steps: 1 | Train Loss: 0.749 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6054539680480957
Epoch: 12, Steps: 1 | Train Loss: 0.697 Vali Loss: 1.202 Vali Acc: 0.200 Test Loss: 1.202 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4242575168609619
Epoch: 13, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.204 Vali Acc: 0.200 Test Loss: 1.204 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5924727916717529
Epoch: 14, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.207 Vali Acc: 0.200 Test Loss: 1.207 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.4458506107330322
Epoch: 15, Steps: 1 | Train Loss: 0.547 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4657604694366455
Epoch: 16, Steps: 1 | Train Loss: 0.501 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.4852449893951416
Epoch: 17, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4486055374145508
Epoch: 18, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5220105648040771
Epoch: 19, Steps: 1 | Train Loss: 0.376 Vali Loss: 1.229 Vali Acc: 0.333 Test Loss: 1.229 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs107_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 426299
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs92_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.796996831893921
Epoch: 1, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5873358249664307
Epoch: 2, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.4820990562438965
Epoch: 3, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.509404182434082
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5864558219909668
Epoch: 5, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5779919624328613
Epoch: 6, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.4757373332977295
Epoch: 7, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.43622922897338867
Epoch: 8, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.45496249198913574
Epoch: 9, Steps: 1 | Train Loss: 0.830 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5390400886535645
Epoch: 10, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.48135876655578613
Epoch: 11, Steps: 1 | Train Loss: 0.728 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.42574572563171387
Epoch: 12, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6090433597564697
Epoch: 13, Steps: 1 | Train Loss: 0.625 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5113749504089355
Epoch: 14, Steps: 1 | Train Loss: 0.575 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4914100170135498
Epoch: 15, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.4717142581939697
Epoch: 16, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4567863941192627
Epoch: 17, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5896446704864502
Epoch: 18, Steps: 1 | Train Loss: 0.398 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.4286792278289795
Epoch: 19, Steps: 1 | Train Loss: 0.360 Vali Loss: 1.153 Vali Acc: 0.467 Test Loss: 1.153 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 20 cost time: 0.5069622993469238
Epoch: 20, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5269730091094971
Epoch: 21, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49385762214660645
Epoch: 22, Steps: 1 | Train Loss: 0.264 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4218270778656006
Epoch: 23, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5121254920959473
Epoch: 24, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4125816822052002
Epoch: 25, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.200 Vali Acc: 0.333 Test Loss: 1.200 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.409116268157959
Epoch: 26, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5402605533599854
Epoch: 27, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4610755443572998
Epoch: 28, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.225 Vali Acc: 0.333 Test Loss: 1.225 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5157904624938965
Epoch: 29, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.234 Vali Acc: 0.333 Test Loss: 1.234 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs92_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 427129
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8073644638061523
Epoch: 1, Steps: 1 | Train Loss: 1.200 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5317628383636475
Epoch: 2, Steps: 1 | Train Loss: 1.177 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.6183147430419922
Epoch: 3, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.136 Vali Acc: 0.200 Test Loss: 1.136 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4386019706726074
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.48468518257141113
Epoch: 5, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.135 Vali Acc: 0.200 Test Loss: 1.135 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.4840114116668701
Epoch: 6, Steps: 1 | Train Loss: 1.091 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.47707653045654297
Epoch: 7, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.5581629276275635
Epoch: 8, Steps: 1 | Train Loss: 1.002 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.4721982479095459
Epoch: 9, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.4275383949279785
Epoch: 10, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 11 cost time: 0.4445209503173828
Epoch: 11, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.4593491554260254
Epoch: 12, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5045557022094727
Epoch: 13, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4625551700592041
Epoch: 14, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.38829660415649414
Epoch: 15, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.540001630783081
Epoch: 16, Steps: 1 | Train Loss: 0.553 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 17 cost time: 0.49347567558288574
Epoch: 17, Steps: 1 | Train Loss: 0.504 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.48354506492614746
Epoch: 18, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 19 cost time: 0.5257318019866943
Epoch: 19, Steps: 1 | Train Loss: 0.414 Vali Loss: 1.157 Vali Acc: 0.333 Test Loss: 1.157 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5326206684112549
Epoch: 20, Steps: 1 | Train Loss: 0.374 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5215725898742676
Epoch: 21, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5470778942108154
Epoch: 22, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.46971988677978516
Epoch: 23, Steps: 1 | Train Loss: 0.271 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6616992950439453
Epoch: 24, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.195 Vali Acc: 0.467 Test Loss: 1.195 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 25 cost time: 0.5006017684936523
Epoch: 25, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4769766330718994
Epoch: 26, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.212 Vali Acc: 0.467 Test Loss: 1.212 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5039868354797363
Epoch: 27, Steps: 1 | Train Loss: 0.173 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5240693092346191
Epoch: 28, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.228 Vali Acc: 0.400 Test Loss: 1.228 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4147603511810303
Epoch: 29, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.237 Vali Acc: 0.400 Test Loss: 1.237 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5114445686340332
Epoch: 30, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.245 Vali Acc: 0.400 Test Loss: 1.245 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.4688904285430908
Epoch: 31, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.48445868492126465
Epoch: 32, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.47383689880371094
Epoch: 33, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.269 Vali Acc: 0.400 Test Loss: 1.269 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.45572543144226074
Epoch: 34, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.277 Vali Acc: 0.400 Test Loss: 1.277 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 424219
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8564484119415283
Epoch: 1, Steps: 1 | Train Loss: 1.158 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.45377469062805176
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.47769951820373535
Epoch: 3, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.45968055725097656
Epoch: 4, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.45338940620422363
Epoch: 5, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5817525386810303
Epoch: 6, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.085 Vali Acc: 0.467 Test Loss: 1.085 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5339055061340332
Epoch: 7, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.086 Vali Acc: 0.467 Test Loss: 1.086 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5971946716308594
Epoch: 8, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.5511417388916016
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.087 Vali Acc: 0.533 Test Loss: 1.087 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.487621545791626
Epoch: 10, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.470991849899292
Epoch: 11, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.091 Vali Acc: 0.533 Test Loss: 1.091 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5811038017272949
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.093 Vali Acc: 0.533 Test Loss: 1.093 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.43160200119018555
Epoch: 13, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5243127346038818
Epoch: 14, Steps: 1 | Train Loss: 0.622 Vali Loss: 1.100 Vali Acc: 0.467 Test Loss: 1.100 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5449271202087402
Epoch: 15, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.104 Vali Acc: 0.467 Test Loss: 1.104 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.48622846603393555
Epoch: 16, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5077259540557861
Epoch: 17, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5825200080871582
Epoch: 18, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 429121
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.58390474319458
Epoch: 1, Steps: 1 | Train Loss: 1.240 Vali Loss: 0.963 Vali Acc: 0.667 Test Loss: 0.963 Test Acc: 0.667
Validation loss decreased (inf --> -0.666657).  Saving model ...
Epoch: 2 cost time: 0.5830340385437012
Epoch: 2, Steps: 1 | Train Loss: 1.216 Vali Loss: 0.958 Vali Acc: 0.667 Test Loss: 0.958 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 0.4542050361633301
Epoch: 3, Steps: 1 | Train Loss: 1.192 Vali Loss: 0.954 Vali Acc: 0.667 Test Loss: 0.954 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 4 cost time: 0.4789562225341797
Epoch: 4, Steps: 1 | Train Loss: 1.169 Vali Loss: 0.950 Vali Acc: 0.667 Test Loss: 0.950 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 5 cost time: 0.5023410320281982
Epoch: 5, Steps: 1 | Train Loss: 1.146 Vali Loss: 0.946 Vali Acc: 0.667 Test Loss: 0.946 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 6 cost time: 0.4866023063659668
Epoch: 6, Steps: 1 | Train Loss: 1.124 Vali Loss: 0.944 Vali Acc: 0.667 Test Loss: 0.944 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 7 cost time: 0.49890995025634766
Epoch: 7, Steps: 1 | Train Loss: 1.084 Vali Loss: 0.942 Vali Acc: 0.667 Test Loss: 0.942 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.5121407508850098
Epoch: 8, Steps: 1 | Train Loss: 1.035 Vali Loss: 0.940 Vali Acc: 0.667 Test Loss: 0.940 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 9 cost time: 0.49658203125
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 0.938 Vali Acc: 0.667 Test Loss: 0.938 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 10 cost time: 0.4161248207092285
Epoch: 10, Steps: 1 | Train Loss: 0.921 Vali Loss: 0.936 Vali Acc: 0.667 Test Loss: 0.936 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 11 cost time: 0.47664642333984375
Epoch: 11, Steps: 1 | Train Loss: 0.860 Vali Loss: 0.935 Vali Acc: 0.667 Test Loss: 0.935 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 0.6900508403778076
Epoch: 12, Steps: 1 | Train Loss: 0.797 Vali Loss: 0.935 Vali Acc: 0.667 Test Loss: 0.935 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.46211791038513184
Epoch: 13, Steps: 1 | Train Loss: 0.735 Vali Loss: 0.935 Vali Acc: 0.533 Test Loss: 0.935 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3992793560028076
Epoch: 14, Steps: 1 | Train Loss: 0.674 Vali Loss: 0.937 Vali Acc: 0.600 Test Loss: 0.937 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5589842796325684
Epoch: 15, Steps: 1 | Train Loss: 0.615 Vali Loss: 0.939 Vali Acc: 0.533 Test Loss: 0.939 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4993414878845215
Epoch: 16, Steps: 1 | Train Loss: 0.559 Vali Loss: 0.943 Vali Acc: 0.467 Test Loss: 0.943 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5345730781555176
Epoch: 17, Steps: 1 | Train Loss: 0.507 Vali Loss: 0.947 Vali Acc: 0.533 Test Loss: 0.947 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5429761409759521
Epoch: 18, Steps: 1 | Train Loss: 0.457 Vali Loss: 0.953 Vali Acc: 0.533 Test Loss: 0.953 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.44345855712890625
Epoch: 19, Steps: 1 | Train Loss: 0.412 Vali Loss: 0.959 Vali Acc: 0.533 Test Loss: 0.959 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4795544147491455
Epoch: 20, Steps: 1 | Train Loss: 0.370 Vali Loss: 0.967 Vali Acc: 0.533 Test Loss: 0.967 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4691965579986572
Epoch: 21, Steps: 1 | Train Loss: 0.332 Vali Loss: 0.975 Vali Acc: 0.533 Test Loss: 0.975 Test Acc: 0.533
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5864055156707764
Epoch: 22, Steps: 1 | Train Loss: 0.297 Vali Loss: 0.984 Vali Acc: 0.533 Test Loss: 0.984 Test Acc: 0.533
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 423787
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6469247341156006
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4777207374572754
Epoch: 2, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.39960765838623047
Epoch: 3, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6512634754180908
Epoch: 4, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5066382884979248
Epoch: 5, Steps: 1 | Train Loss: 1.071 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.4133577346801758
Epoch: 6, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.198 Vali Acc: 0.200 Test Loss: 1.198 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.58077073097229
Epoch: 7, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5359447002410889
Epoch: 8, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.199 Vali Acc: 0.200 Test Loss: 1.199 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5907788276672363
Epoch: 9, Steps: 1 | Train Loss: 0.899 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.588752269744873
Epoch: 10, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.453751802444458
Epoch: 11, Steps: 1 | Train Loss: 0.781 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4853050708770752
Epoch: 12, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5332725048065186
Epoch: 13, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.209 Vali Acc: 0.133 Test Loss: 1.209 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.47176432609558105
Epoch: 14, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4509570598602295
Epoch: 15, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 429433
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5747816562652588
Epoch: 1, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.3899669647216797
Epoch: 2, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.37368249893188477
Epoch: 3, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.3994932174682617
Epoch: 4, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.404313325881958
Epoch: 5, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.43635082244873047
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5159344673156738
Epoch: 7, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4547250270843506
Epoch: 8, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.41636180877685547
Epoch: 9, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.3914165496826172
Epoch: 10, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4335019588470459
Epoch: 11, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.45702481269836426
Epoch: 12, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.127 Vali Acc: 0.267 Test Loss: 1.127 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.3743703365325928
Epoch: 13, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.131 Vali Acc: 0.267 Test Loss: 1.131 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5907807350158691
Epoch: 14, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.136 Vali Acc: 0.267 Test Loss: 1.136 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4513969421386719
Epoch: 15, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 428683
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5574862957000732
Epoch: 1, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5019185543060303
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.41596293449401855
Epoch: 3, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.45061802864074707
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49231743812561035
Epoch: 5, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6121068000793457
Epoch: 6, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.104 Vali Acc: 0.200 Test Loss: 1.104 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.428875207901001
Epoch: 7, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.103 Vali Acc: 0.200 Test Loss: 1.103 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.46912360191345215
Epoch: 8, Steps: 1 | Train Loss: 0.947 Vali Loss: 1.103 Vali Acc: 0.133 Test Loss: 1.103 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4742550849914551
Epoch: 9, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.104 Vali Acc: 0.133 Test Loss: 1.104 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5117499828338623
Epoch: 10, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.104 Vali Acc: 0.133 Test Loss: 1.104 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5571858882904053
Epoch: 11, Steps: 1 | Train Loss: 0.787 Vali Loss: 1.106 Vali Acc: 0.200 Test Loss: 1.106 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4493827819824219
Epoch: 12, Steps: 1 | Train Loss: 0.731 Vali Loss: 1.108 Vali Acc: 0.200 Test Loss: 1.108 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5525975227355957
Epoch: 13, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.112 Vali Acc: 0.200 Test Loss: 1.112 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5821905136108398
Epoch: 14, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.116 Vali Acc: 0.200 Test Loss: 1.116 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.41628384590148926
Epoch: 15, Steps: 1 | Train Loss: 0.566 Vali Loss: 1.121 Vali Acc: 0.133 Test Loss: 1.121 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.613274335861206
Epoch: 16, Steps: 1 | Train Loss: 0.516 Vali Loss: 1.127 Vali Acc: 0.133 Test Loss: 1.127 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5884881019592285
Epoch: 17, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.133 Vali Acc: 0.133 Test Loss: 1.133 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 429889
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5294020175933838
Epoch: 1, Steps: 1 | Train Loss: 1.124 Vali Loss: 0.997 Vali Acc: 0.533 Test Loss: 0.997 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5292105674743652
Epoch: 2, Steps: 1 | Train Loss: 1.101 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5938215255737305
Epoch: 3, Steps: 1 | Train Loss: 1.079 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.44417500495910645
Epoch: 4, Steps: 1 | Train Loss: 1.057 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.48301076889038086
Epoch: 5, Steps: 1 | Train Loss: 1.036 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.5066180229187012
Epoch: 6, Steps: 1 | Train Loss: 1.015 Vali Loss: 0.998 Vali Acc: 0.533 Test Loss: 0.998 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.45864176750183105
Epoch: 7, Steps: 1 | Train Loss: 0.977 Vali Loss: 0.999 Vali Acc: 0.600 Test Loss: 0.999 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.4458448886871338
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.000 Vali Acc: 0.600 Test Loss: 1.000 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5687017440795898
Epoch: 9, Steps: 1 | Train Loss: 0.879 Vali Loss: 1.001 Vali Acc: 0.600 Test Loss: 1.001 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6265974044799805
Epoch: 10, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.004 Vali Acc: 0.600 Test Loss: 1.004 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4528660774230957
Epoch: 11, Steps: 1 | Train Loss: 0.768 Vali Loss: 1.006 Vali Acc: 0.533 Test Loss: 1.006 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5288381576538086
Epoch: 12, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.43485069274902344
Epoch: 13, Steps: 1 | Train Loss: 0.656 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4193878173828125
Epoch: 14, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.018 Vali Acc: 0.467 Test Loss: 1.018 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4460408687591553
Epoch: 15, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5215916633605957
Epoch: 16, Steps: 1 | Train Loss: 0.500 Vali Loss: 1.029 Vali Acc: 0.467 Test Loss: 1.029 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6084713935852051
Epoch: 17, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 425979
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6077361106872559
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5104990005493164
Epoch: 2, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.425795316696167
Epoch: 3, Steps: 1 | Train Loss: 1.058 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5256211757659912
Epoch: 4, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.44120359420776367
Epoch: 5, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6063103675842285
Epoch: 6, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5020248889923096
Epoch: 7, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46976661682128906
Epoch: 8, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.42818522453308105
Epoch: 9, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.179 Vali Acc: 0.267 Test Loss: 1.179 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5287058353424072
Epoch: 10, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5584137439727783
Epoch: 11, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.178 Vali Acc: 0.333 Test Loss: 1.178 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.4976487159729004
Epoch: 12, Steps: 1 | Train Loss: 0.702 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4521141052246094
Epoch: 13, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4835958480834961
Epoch: 14, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.45605897903442383
Epoch: 15, Steps: 1 | Train Loss: 0.543 Vali Loss: 1.183 Vali Acc: 0.333 Test Loss: 1.183 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.45147109031677246
Epoch: 16, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 17 cost time: 0.47977733612060547
Epoch: 17, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5000097751617432
Epoch: 18, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5752096176147461
Epoch: 19, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.202 Vali Acc: 0.400 Test Loss: 1.202 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.4077134132385254
Epoch: 20, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4441647529602051
Epoch: 21, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5181810855865479
Epoch: 22, Steps: 1 | Train Loss: 0.266 Vali Loss: 1.222 Vali Acc: 0.467 Test Loss: 1.222 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 23 cost time: 0.3737208843231201
Epoch: 23, Steps: 1 | Train Loss: 0.238 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.4272434711456299
Epoch: 24, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.238 Vali Acc: 0.467 Test Loss: 1.238 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4350738525390625
Epoch: 25, Steps: 1 | Train Loss: 0.190 Vali Loss: 1.245 Vali Acc: 0.467 Test Loss: 1.245 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5039412975311279
Epoch: 26, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.253 Vali Acc: 0.467 Test Loss: 1.253 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5093340873718262
Epoch: 27, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.261 Vali Acc: 0.467 Test Loss: 1.261 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4928278923034668
Epoch: 28, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.269 Vali Acc: 0.467 Test Loss: 1.269 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4850046634674072
Epoch: 29, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.276 Vali Acc: 0.467 Test Loss: 1.276 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.424793004989624
Epoch: 30, Steps: 1 | Train Loss: 0.108 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5350401401519775
Epoch: 31, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.291 Vali Acc: 0.467 Test Loss: 1.291 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5419347286224365
Epoch: 32, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 426585
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7801933288574219
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4455099105834961
Epoch: 2, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.150 Vali Acc: 0.267 Test Loss: 1.150 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5219416618347168
Epoch: 3, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5675194263458252
Epoch: 4, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5601029396057129
Epoch: 5, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5474197864532471
Epoch: 6, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5110759735107422
Epoch: 7, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.4125030040740967
Epoch: 8, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5002031326293945
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 10 cost time: 0.4295463562011719
Epoch: 10, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 11 cost time: 0.4702494144439697
Epoch: 11, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 12 cost time: 0.4368617534637451
Epoch: 12, Steps: 1 | Train Loss: 0.746 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4968757629394531
Epoch: 13, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.142 Vali Acc: 0.267 Test Loss: 1.142 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5022432804107666
Epoch: 14, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.45441126823425293
Epoch: 15, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.49674010276794434
Epoch: 16, Steps: 1 | Train Loss: 0.528 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5473556518554688
Epoch: 17, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.43486857414245605
Epoch: 18, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.46834754943847656
Epoch: 19, Steps: 1 | Train Loss: 0.393 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4360933303833008
Epoch: 20, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.506788969039917
Epoch: 21, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 423355
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.4981341361999512
Epoch: 1, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4156181812286377
Epoch: 2, Steps: 1 | Train Loss: 1.067 Vali Loss: 1.146 Vali Acc: 0.267 Test Loss: 1.146 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.37228846549987793
Epoch: 3, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.47794342041015625
Epoch: 4, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.3805859088897705
Epoch: 5, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.3998720645904541
Epoch: 6, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.46060633659362793
Epoch: 7, Steps: 1 | Train Loss: 0.946 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.6210570335388184
Epoch: 8, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.44857335090637207
Epoch: 9, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.144 Vali Acc: 0.200 Test Loss: 1.144 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5438354015350342
Epoch: 10, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6168324947357178
Epoch: 11, Steps: 1 | Train Loss: 0.742 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.4997978210449219
Epoch: 12, Steps: 1 | Train Loss: 0.688 Vali Loss: 1.150 Vali Acc: 0.200 Test Loss: 1.150 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5262370109558105
Epoch: 13, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 427201
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.511899471282959
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4764103889465332
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.078 Vali Acc: 0.333 Test Loss: 1.078 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.3890116214752197
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.47042131423950195
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.41884827613830566
Epoch: 5, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.49799442291259766
Epoch: 6, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4162712097167969
Epoch: 7, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49170923233032227
Epoch: 8, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.48578333854675293
Epoch: 9, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.46002840995788574
Epoch: 10, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.3727891445159912
Epoch: 11, Steps: 1 | Train Loss: 0.786 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.418900728225708
Epoch: 12, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4941272735595703
Epoch: 13, Steps: 1 | Train Loss: 0.672 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.45354127883911133
Epoch: 14, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4571411609649658
Epoch: 15, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.097 Vali Acc: 0.200 Test Loss: 1.097 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5103023052215576
Epoch: 16, Steps: 1 | Train Loss: 0.515 Vali Loss: 1.103 Vali Acc: 0.267 Test Loss: 1.103 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.47606539726257324
Epoch: 17, Steps: 1 | Train Loss: 0.468 Vali Loss: 1.110 Vali Acc: 0.267 Test Loss: 1.110 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4398777484893799
Epoch: 18, Steps: 1 | Train Loss: 0.424 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 428491
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.713207483291626
Epoch: 1, Steps: 1 | Train Loss: 1.221 Vali Loss: 1.037 Vali Acc: 0.533 Test Loss: 1.037 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5895953178405762
Epoch: 2, Steps: 1 | Train Loss: 1.197 Vali Loss: 1.036 Vali Acc: 0.533 Test Loss: 1.036 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5161716938018799
Epoch: 3, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.034 Vali Acc: 0.533 Test Loss: 1.034 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.4919416904449463
Epoch: 4, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.49598050117492676
Epoch: 5, Steps: 1 | Train Loss: 1.127 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.5580315589904785
Epoch: 6, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.6625638008117676
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 8 cost time: 0.6435394287109375
Epoch: 8, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.030 Vali Acc: 0.600 Test Loss: 1.030 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 9 cost time: 0.5495667457580566
Epoch: 9, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5942325592041016
Epoch: 10, Steps: 1 | Train Loss: 0.896 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4400005340576172
Epoch: 11, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5631494522094727
Epoch: 12, Steps: 1 | Train Loss: 0.774 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5599362850189209
Epoch: 13, Steps: 1 | Train Loss: 0.715 Vali Loss: 1.035 Vali Acc: 0.467 Test Loss: 1.035 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4272348880767822
Epoch: 14, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5997762680053711
Epoch: 15, Steps: 1 | Train Loss: 0.601 Vali Loss: 1.041 Vali Acc: 0.467 Test Loss: 1.041 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5060687065124512
Epoch: 16, Steps: 1 | Train Loss: 0.548 Vali Loss: 1.046 Vali Acc: 0.400 Test Loss: 1.046 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.410552978515625
Epoch: 17, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.051 Vali Acc: 0.333 Test Loss: 1.051 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4648137092590332
Epoch: 18, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 427225
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6965878009796143
Epoch: 1, Steps: 1 | Train Loss: 1.187 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5007758140563965
Epoch: 2, Steps: 1 | Train Loss: 1.163 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6299145221710205
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.425642728805542
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4854741096496582
Epoch: 5, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.47599148750305176
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.49326395988464355
Epoch: 7, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.6035194396972656
Epoch: 8, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.49992871284484863
Epoch: 9, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.6179733276367188
Epoch: 10, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.172 Vali Acc: 0.333 Test Loss: 1.172 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6670711040496826
Epoch: 11, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.46616220474243164
Epoch: 12, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.174 Vali Acc: 0.267 Test Loss: 1.174 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.48659515380859375
Epoch: 13, Steps: 1 | Train Loss: 0.701 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.54691481590271
Epoch: 14, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5443170070648193
Epoch: 15, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.184 Vali Acc: 0.200 Test Loss: 1.184 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5748007297515869
Epoch: 16, Steps: 1 | Train Loss: 0.542 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5076062679290771
Epoch: 17, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.195 Vali Acc: 0.133 Test Loss: 1.195 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5990126132965088
Epoch: 18, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.201 Vali Acc: 0.133 Test Loss: 1.201 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42597222328186035
Epoch: 19, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.208 Vali Acc: 0.133 Test Loss: 1.208 Test Acc: 0.133
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 423403
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7481834888458252
Epoch: 1, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4638183116912842
Epoch: 2, Steps: 1 | Train Loss: 1.094 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4618856906890869
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5505096912384033
Epoch: 4, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5712838172912598
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.091 Vali Acc: 0.267 Test Loss: 1.091 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.47595858573913574
Epoch: 6, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.4423494338989258
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5360701084136963
Epoch: 8, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.087 Vali Acc: 0.267 Test Loss: 1.087 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.4749727249145508
Epoch: 9, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.4312436580657959
Epoch: 10, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.633164644241333
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.5046591758728027
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.44585204124450684
Epoch: 13, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm64_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 430497
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs320_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6920056343078613
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.4703521728515625
Epoch: 2, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.43088221549987793
Epoch: 3, Steps: 1 | Train Loss: 1.156 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.4961817264556885
Epoch: 4, Steps: 1 | Train Loss: 1.133 Vali Loss: 1.012 Vali Acc: 0.600 Test Loss: 1.012 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.3929004669189453
Epoch: 5, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.5218243598937988
Epoch: 6, Steps: 1 | Train Loss: 1.089 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.4619753360748291
Epoch: 7, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.006 Vali Acc: 0.667 Test Loss: 1.006 Test Acc: 0.667
Validation loss decreased (-0.599990 --> -0.666657).  Saving model ...
Epoch: 8 cost time: 0.4902834892272949
Epoch: 8, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.003 Vali Acc: 0.600 Test Loss: 1.003 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6383459568023682
Epoch: 9, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.000 Vali Acc: 0.533 Test Loss: 1.000 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.518101692199707
Epoch: 10, Steps: 1 | Train Loss: 0.880 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4579288959503174
Epoch: 11, Steps: 1 | Train Loss: 0.820 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 12 cost time: 0.4557352066040039
Epoch: 12, Steps: 1 | Train Loss: 0.760 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 13 cost time: 0.36672353744506836
Epoch: 13, Steps: 1 | Train Loss: 0.702 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 14 cost time: 0.6299242973327637
Epoch: 14, Steps: 1 | Train Loss: 0.647 Vali Loss: 0.995 Vali Acc: 0.600 Test Loss: 0.995 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47939491271972656
Epoch: 15, Steps: 1 | Train Loss: 0.593 Vali Loss: 0.996 Vali Acc: 0.600 Test Loss: 0.996 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.39911389350891113
Epoch: 16, Steps: 1 | Train Loss: 0.542 Vali Loss: 0.998 Vali Acc: 0.600 Test Loss: 0.998 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.41881585121154785
Epoch: 17, Steps: 1 | Train Loss: 0.494 Vali Loss: 1.002 Vali Acc: 0.600 Test Loss: 1.002 Test Acc: 0.600
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.4382662773132324
Epoch: 18, Steps: 1 | Train Loss: 0.449 Vali Loss: 1.006 Vali Acc: 0.600 Test Loss: 1.006 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.400937557220459
Epoch: 19, Steps: 1 | Train Loss: 0.406 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5886015892028809
Epoch: 20, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.016 Vali Acc: 0.600 Test Loss: 1.016 Test Acc: 0.600
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.47443485260009766
Epoch: 21, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.023 Vali Acc: 0.600 Test Loss: 1.023 Test Acc: 0.600
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.38440799713134766
Epoch: 22, Steps: 1 | Train Loss: 0.296 Vali Loss: 1.029 Vali Acc: 0.600 Test Loss: 1.029 Test Acc: 0.600
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.4287703037261963
Epoch: 23, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs320_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 422867
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs214_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6988964080810547
Epoch: 1, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.174 Vali Acc: 0.200 Test Loss: 1.174 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.46300530433654785
Epoch: 2, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.46582770347595215
Epoch: 3, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.40763187408447266
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.41582703590393066
Epoch: 5, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.170 Vali Acc: 0.133 Test Loss: 1.170 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4924178123474121
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.4725778102874756
Epoch: 7, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.46391940116882324
Epoch: 8, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5386087894439697
Epoch: 9, Steps: 1 | Train Loss: 0.755 Vali Loss: 1.172 Vali Acc: 0.267 Test Loss: 1.172 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.38391757011413574
Epoch: 10, Steps: 1 | Train Loss: 0.708 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.42856359481811523
Epoch: 11, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.176 Vali Acc: 0.267 Test Loss: 1.176 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4985623359680176
Epoch: 12, Steps: 1 | Train Loss: 0.614 Vali Loss: 1.178 Vali Acc: 0.267 Test Loss: 1.178 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.3391897678375244
Epoch: 13, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4598369598388672
Epoch: 14, Steps: 1 | Train Loss: 0.523 Vali Loss: 1.186 Vali Acc: 0.200 Test Loss: 1.186 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.35579609870910645
Epoch: 15, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.191 Vali Acc: 0.267 Test Loss: 1.191 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.3950355052947998
Epoch: 16, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.37810754776000977
Epoch: 17, Steps: 1 | Train Loss: 0.400 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs214_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 422465
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs160_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.576932430267334
Epoch: 1, Steps: 1 | Train Loss: 1.264 Vali Loss: 1.325 Vali Acc: 0.333 Test Loss: 1.325 Test Acc: 0.333
Validation loss decreased (inf --> -0.333320).  Saving model ...
Epoch: 2 cost time: 0.5258491039276123
Epoch: 2, Steps: 1 | Train Loss: 1.237 Vali Loss: 1.322 Vali Acc: 0.333 Test Loss: 1.322 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 3 cost time: 0.5151920318603516
Epoch: 3, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 4 cost time: 0.40447282791137695
Epoch: 4, Steps: 1 | Train Loss: 1.186 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 5 cost time: 0.5697801113128662
Epoch: 5, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 6 cost time: 0.5614917278289795
Epoch: 6, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 7 cost time: 0.5496053695678711
Epoch: 7, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 8 cost time: 0.4444000720977783
Epoch: 8, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 9 cost time: 0.650118350982666
Epoch: 9, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.308 Vali Acc: 0.333 Test Loss: 1.308 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.5801658630371094
Epoch: 10, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 0.5526885986328125
Epoch: 11, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
Validation loss decreased (-0.333320 --> -0.333320).  Saving model ...
Epoch: 12 cost time: 0.5582630634307861
Epoch: 12, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.307 Vali Acc: 0.333 Test Loss: 1.307 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5460214614868164
Epoch: 13, Steps: 1 | Train Loss: 0.729 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.501051664352417
Epoch: 14, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.310 Vali Acc: 0.267 Test Loss: 1.310 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6303796768188477
Epoch: 15, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.313 Vali Acc: 0.267 Test Loss: 1.313 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.609442949295044
Epoch: 16, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.316 Vali Acc: 0.267 Test Loss: 1.316 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5390541553497314
Epoch: 17, Steps: 1 | Train Loss: 0.513 Vali Loss: 1.320 Vali Acc: 0.267 Test Loss: 1.320 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6709985733032227
Epoch: 18, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.325 Vali Acc: 0.267 Test Loss: 1.325 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.46146702766418457
Epoch: 19, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.330 Vali Acc: 0.267 Test Loss: 1.330 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5711781978607178
Epoch: 20, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.336 Vali Acc: 0.200 Test Loss: 1.336 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.48306870460510254
Epoch: 21, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.343 Vali Acc: 0.200 Test Loss: 1.343 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs160_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 420339
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs128_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8479135036468506
Epoch: 1, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.5935499668121338
Epoch: 2, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.4554734230041504
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.45295190811157227
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.5627017021179199
Epoch: 5, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.47345900535583496
Epoch: 6, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4981119632720947
Epoch: 7, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.4420175552368164
Epoch: 8, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4832446575164795
Epoch: 9, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5513229370117188
Epoch: 10, Steps: 1 | Train Loss: 0.777 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3789098262786865
Epoch: 11, Steps: 1 | Train Loss: 0.723 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4993743896484375
Epoch: 12, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4271109104156494
Epoch: 13, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.457317590713501
Epoch: 14, Steps: 1 | Train Loss: 0.569 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.45430898666381836
Epoch: 15, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4595944881439209
Epoch: 16, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5899007320404053
Epoch: 17, Steps: 1 | Train Loss: 0.434 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs128_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 419849
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs107_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6542878150939941
Epoch: 1, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.48276495933532715
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.095 Vali Acc: 0.400 Test Loss: 1.095 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4694514274597168
Epoch: 3, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5181281566619873
Epoch: 4, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.092 Vali Acc: 0.467 Test Loss: 1.092 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6421966552734375
Epoch: 5, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.091 Vali Acc: 0.467 Test Loss: 1.091 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.41758060455322266
Epoch: 6, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5669963359832764
Epoch: 7, Steps: 1 | Train Loss: 0.874 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5375030040740967
Epoch: 8, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4873955249786377
Epoch: 9, Steps: 1 | Train Loss: 0.789 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5158770084381104
Epoch: 10, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5872704982757568
Epoch: 11, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.092 Vali Acc: 0.400 Test Loss: 1.092 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5065295696258545
Epoch: 12, Steps: 1 | Train Loss: 0.644 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.489901065826416
Epoch: 13, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.096 Vali Acc: 0.467 Test Loss: 1.096 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.46373891830444336
Epoch: 14, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.098 Vali Acc: 0.400 Test Loss: 1.098 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5318231582641602
Epoch: 15, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs107_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 420819
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs92_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.698437213897705
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4825563430786133
Epoch: 2, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4608175754547119
Epoch: 3, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6793124675750732
Epoch: 4, Steps: 1 | Train Loss: 1.118 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.4630107879638672
Epoch: 5, Steps: 1 | Train Loss: 1.096 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4563570022583008
Epoch: 6, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6511962413787842
Epoch: 7, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.4809389114379883
Epoch: 8, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5007092952728271
Epoch: 9, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.3810460567474365
Epoch: 10, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.113 Vali Acc: 0.267 Test Loss: 1.113 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.48586535453796387
Epoch: 11, Steps: 1 | Train Loss: 0.813 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5510401725769043
Epoch: 12, Steps: 1 | Train Loss: 0.756 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.49059510231018066
Epoch: 13, Steps: 1 | Train Loss: 0.700 Vali Loss: 1.118 Vali Acc: 0.267 Test Loss: 1.118 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.4537639617919922
Epoch: 14, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.121 Vali Acc: 0.267 Test Loss: 1.121 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs92_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421889
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs80_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7662944793701172
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5403153896331787
Epoch: 2, Steps: 1 | Train Loss: 1.059 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5195968151092529
Epoch: 3, Steps: 1 | Train Loss: 1.038 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.469346284866333
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.580725908279419
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6222493648529053
Epoch: 6, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.6098313331604004
Epoch: 7, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5200314521789551
Epoch: 8, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.698650598526001
Epoch: 9, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.491823673248291
Epoch: 10, Steps: 1 | Train Loss: 0.801 Vali Loss: 1.163 Vali Acc: 0.467 Test Loss: 1.163 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.5221123695373535
Epoch: 11, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.165 Vali Acc: 0.533 Test Loss: 1.165 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 12 cost time: 0.7399425506591797
Epoch: 12, Steps: 1 | Train Loss: 0.694 Vali Loss: 1.168 Vali Acc: 0.467 Test Loss: 1.168 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5077409744262695
Epoch: 13, Steps: 1 | Train Loss: 0.641 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4979069232940674
Epoch: 14, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.177 Vali Acc: 0.400 Test Loss: 1.177 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7379705905914307
Epoch: 15, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6905772686004639
Epoch: 16, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4417572021484375
Epoch: 17, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.195 Vali Acc: 0.267 Test Loss: 1.195 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.459552526473999
Epoch: 18, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.203 Vali Acc: 0.267 Test Loss: 1.203 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.47735095024108887
Epoch: 19, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6088769435882568
Epoch: 20, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.586418867111206
Epoch: 21, Steps: 1 | Train Loss: 0.295 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs80_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 419171
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5305225849151611
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.033 Vali Acc: 0.533 Test Loss: 1.033 Test Acc: 0.533
Validation loss decreased (inf --> -0.533323).  Saving model ...
Epoch: 2 cost time: 0.4365811347961426
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.4837646484375
Epoch: 3, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5134236812591553
Epoch: 4, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.4171271324157715
Epoch: 5, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.553997278213501
Epoch: 6, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.475139856338501
Epoch: 7, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4013538360595703
Epoch: 8, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.031 Vali Acc: 0.533 Test Loss: 1.031 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4971892833709717
Epoch: 9, Steps: 1 | Train Loss: 0.847 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.43077588081359863
Epoch: 10, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.033 Vali Acc: 0.600 Test Loss: 1.033 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 11 cost time: 0.42481565475463867
Epoch: 11, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.42106175422668457
Epoch: 12, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4421072006225586
Epoch: 13, Steps: 1 | Train Loss: 0.632 Vali Loss: 1.041 Vali Acc: 0.533 Test Loss: 1.041 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5460641384124756
Epoch: 14, Steps: 1 | Train Loss: 0.581 Vali Loss: 1.046 Vali Acc: 0.533 Test Loss: 1.046 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4646942615509033
Epoch: 15, Steps: 1 | Train Loss: 0.533 Vali Loss: 1.051 Vali Acc: 0.533 Test Loss: 1.051 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.43522191047668457
Epoch: 16, Steps: 1 | Train Loss: 0.487 Vali Loss: 1.056 Vali Acc: 0.533 Test Loss: 1.056 Test Acc: 0.533
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.578730583190918
Epoch: 17, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.063 Vali Acc: 0.533 Test Loss: 1.063 Test Acc: 0.533
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4744601249694824
Epoch: 18, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.43819618225097656
Epoch: 19, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5602188110351562
Epoch: 20, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.086 Vali Acc: 0.400 Test Loss: 1.086 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 424201
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs64_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.768489122390747
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5645439624786377
Epoch: 2, Steps: 1 | Train Loss: 1.191 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5030989646911621
Epoch: 3, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4020571708679199
Epoch: 4, Steps: 1 | Train Loss: 1.146 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.5075516700744629
Epoch: 5, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5769460201263428
Epoch: 6, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 7 cost time: 0.5192973613739014
Epoch: 7, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.130 Vali Acc: 0.200 Test Loss: 1.130 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 8 cost time: 0.538532018661499
Epoch: 8, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 9 cost time: 0.41002535820007324
Epoch: 9, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 10 cost time: 0.41582798957824707
Epoch: 10, Steps: 1 | Train Loss: 0.898 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 11 cost time: 0.45661306381225586
Epoch: 11, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.128 Vali Acc: 0.200 Test Loss: 1.128 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.41303157806396484
Epoch: 12, Steps: 1 | Train Loss: 0.773 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5387258529663086
Epoch: 13, Steps: 1 | Train Loss: 0.711 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.450775146484375
Epoch: 14, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.134 Vali Acc: 0.200 Test Loss: 1.134 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4317200183868408
Epoch: 15, Steps: 1 | Train Loss: 0.594 Vali Loss: 1.137 Vali Acc: 0.200 Test Loss: 1.137 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4762442111968994
Epoch: 16, Steps: 1 | Train Loss: 0.541 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4559941291809082
Epoch: 17, Steps: 1 | Train Loss: 0.491 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.46975278854370117
Epoch: 18, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.152 Vali Acc: 0.200 Test Loss: 1.152 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4513416290283203
Epoch: 19, Steps: 1 | Train Loss: 0.402 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.3586452007293701
Epoch: 20, Steps: 1 | Train Loss: 0.363 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs64_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 418995
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs59_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.4725971221923828
Epoch: 1, Steps: 1 | Train Loss: 1.252 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4175417423248291
Epoch: 2, Steps: 1 | Train Loss: 1.225 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.3836183547973633
Epoch: 3, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4543013572692871
Epoch: 4, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4207878112792969
Epoch: 5, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5614335536956787
Epoch: 6, Steps: 1 | Train Loss: 1.123 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.6031560897827148
Epoch: 7, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.158 Vali Acc: 0.200 Test Loss: 1.158 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.4175984859466553
Epoch: 8, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.5864431858062744
Epoch: 9, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.153 Vali Acc: 0.200 Test Loss: 1.153 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 10 cost time: 0.47073936462402344
Epoch: 10, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 11 cost time: 0.5561683177947998
Epoch: 11, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.150 Vali Acc: 0.133 Test Loss: 1.150 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.568734884262085
Epoch: 12, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5830023288726807
Epoch: 13, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.149 Vali Acc: 0.133 Test Loss: 1.149 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.520674467086792
Epoch: 14, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.149 Vali Acc: 0.200 Test Loss: 1.149 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199989).  Saving model ...
Epoch: 15 cost time: 0.5467894077301025
Epoch: 15, Steps: 1 | Train Loss: 0.590 Vali Loss: 1.151 Vali Acc: 0.200 Test Loss: 1.151 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.47065162658691406
Epoch: 16, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.153 Vali Acc: 0.267 Test Loss: 1.153 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 17 cost time: 0.492311954498291
Epoch: 17, Steps: 1 | Train Loss: 0.488 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 18 cost time: 0.5491909980773926
Epoch: 18, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5491781234741211
Epoch: 19, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.165 Vali Acc: 0.333 Test Loss: 1.165 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.4964742660522461
Epoch: 20, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5972228050231934
Epoch: 21, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.4609825611114502
Epoch: 22, Steps: 1 | Train Loss: 0.288 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5006439685821533
Epoch: 23, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.191 Vali Acc: 0.333 Test Loss: 1.191 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.537708044052124
Epoch: 24, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4323310852050781
Epoch: 25, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.206 Vali Acc: 0.467 Test Loss: 1.206 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 26 cost time: 0.5422756671905518
Epoch: 26, Steps: 1 | Train Loss: 0.183 Vali Loss: 1.213 Vali Acc: 0.467 Test Loss: 1.213 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.45262956619262695
Epoch: 27, Steps: 1 | Train Loss: 0.163 Vali Loss: 1.221 Vali Acc: 0.467 Test Loss: 1.221 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5009193420410156
Epoch: 28, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.229 Vali Acc: 0.400 Test Loss: 1.229 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.3969905376434326
Epoch: 29, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.237 Vali Acc: 0.333 Test Loss: 1.237 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5758922100067139
Epoch: 30, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.244 Vali Acc: 0.333 Test Loss: 1.244 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.4035825729370117
Epoch: 31, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5027194023132324
Epoch: 32, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5157108306884766
Epoch: 33, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.3939664363861084
Epoch: 34, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.275 Vali Acc: 0.333 Test Loss: 1.275 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.41509222984313965
Epoch: 35, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs59_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 424721
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs54_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.590627670288086
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.49213504791259766
Epoch: 2, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.39010000228881836
Epoch: 3, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.434345006942749
Epoch: 4, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4998021125793457
Epoch: 5, Steps: 1 | Train Loss: 1.040 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.4982626438140869
Epoch: 6, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.447986364364624
Epoch: 7, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.5444386005401611
Epoch: 8, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5243995189666748
Epoch: 9, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.41145896911621094
Epoch: 10, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.4658088684082031
Epoch: 11, Steps: 1 | Train Loss: 0.744 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5400173664093018
Epoch: 12, Steps: 1 | Train Loss: 0.685 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6851263046264648
Epoch: 13, Steps: 1 | Train Loss: 0.629 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5460379123687744
Epoch: 14, Steps: 1 | Train Loss: 0.577 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4431140422821045
Epoch: 15, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4791245460510254
Epoch: 16, Steps: 1 | Train Loss: 0.481 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5534124374389648
Epoch: 17, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.210 Vali Acc: 0.267 Test Loss: 1.210 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5187890529632568
Epoch: 18, Steps: 1 | Train Loss: 0.397 Vali Loss: 1.215 Vali Acc: 0.267 Test Loss: 1.215 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5628974437713623
Epoch: 19, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5652139186859131
Epoch: 20, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.228 Vali Acc: 0.267 Test Loss: 1.228 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs54_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 424051
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs50_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 2.1068668365478516
Epoch: 1, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.313 Vali Acc: 0.200 Test Loss: 1.313 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5222742557525635
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5474209785461426
Epoch: 3, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.5705857276916504
Epoch: 4, Steps: 1 | Train Loss: 1.073 Vali Loss: 1.311 Vali Acc: 0.200 Test Loss: 1.311 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.3961973190307617
Epoch: 5, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.310 Vali Acc: 0.200 Test Loss: 1.310 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.6803534030914307
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.4364359378814697
Epoch: 7, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.309 Vali Acc: 0.200 Test Loss: 1.309 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 8 cost time: 0.5977253913879395
Epoch: 8, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.45853686332702637
Epoch: 9, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.308 Vali Acc: 0.200 Test Loss: 1.308 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 10 cost time: 0.4703328609466553
Epoch: 10, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.308 Vali Acc: 0.133 Test Loss: 1.308 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5811409950256348
Epoch: 11, Steps: 1 | Train Loss: 0.793 Vali Loss: 1.309 Vali Acc: 0.133 Test Loss: 1.309 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.465073823928833
Epoch: 12, Steps: 1 | Train Loss: 0.737 Vali Loss: 1.311 Vali Acc: 0.133 Test Loss: 1.311 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5581638813018799
Epoch: 13, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.313 Vali Acc: 0.133 Test Loss: 1.313 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5374946594238281
Epoch: 14, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.316 Vali Acc: 0.133 Test Loss: 1.316 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.45120906829833984
Epoch: 15, Steps: 1 | Train Loss: 0.576 Vali Loss: 1.319 Vali Acc: 0.133 Test Loss: 1.319 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.509413480758667
Epoch: 16, Steps: 1 | Train Loss: 0.527 Vali Loss: 1.323 Vali Acc: 0.200 Test Loss: 1.323 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5614950656890869
Epoch: 17, Steps: 1 | Train Loss: 0.480 Vali Loss: 1.328 Vali Acc: 0.133 Test Loss: 1.328 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.537858247756958
Epoch: 18, Steps: 1 | Train Loss: 0.436 Vali Loss: 1.334 Vali Acc: 0.133 Test Loss: 1.334 Test Acc: 0.133
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.42978358268737793
Epoch: 19, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.340 Vali Acc: 0.200 Test Loss: 1.340 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs50_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 425321
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.8853788375854492
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5036263465881348
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.274 Vali Acc: 0.267 Test Loss: 1.274 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.5930595397949219
Epoch: 3, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.408538818359375
Epoch: 4, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.5118844509124756
Epoch: 5, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5938799381256104
Epoch: 6, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5072181224822998
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.4340400695800781
Epoch: 8, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 9 cost time: 0.5293221473693848
Epoch: 9, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.268 Vali Acc: 0.333 Test Loss: 1.268 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5262625217437744
Epoch: 10, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.46085143089294434
Epoch: 11, Steps: 1 | Train Loss: 0.738 Vali Loss: 1.271 Vali Acc: 0.333 Test Loss: 1.271 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4443662166595459
Epoch: 12, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4162735939025879
Epoch: 13, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.276 Vali Acc: 0.333 Test Loss: 1.276 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4332711696624756
Epoch: 14, Steps: 1 | Train Loss: 0.585 Vali Loss: 1.280 Vali Acc: 0.400 Test Loss: 1.280 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399987).  Saving model ...
Epoch: 15 cost time: 0.4174530506134033
Epoch: 15, Steps: 1 | Train Loss: 0.538 Vali Loss: 1.284 Vali Acc: 0.400 Test Loss: 1.284 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4939455986022949
Epoch: 16, Steps: 1 | Train Loss: 0.493 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8069808483123779
Epoch: 17, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.296 Vali Acc: 0.400 Test Loss: 1.296 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.498823881149292
Epoch: 18, Steps: 1 | Train Loss: 0.410 Vali Loss: 1.302 Vali Acc: 0.400 Test Loss: 1.302 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5699098110198975
Epoch: 19, Steps: 1 | Train Loss: 0.372 Vali Loss: 1.310 Vali Acc: 0.400 Test Loss: 1.310 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6027169227600098
Epoch: 20, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.318 Vali Acc: 0.333 Test Loss: 1.318 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.4728426933288574
Epoch: 21, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5494422912597656
Epoch: 22, Steps: 1 | Train Loss: 0.274 Vali Loss: 1.334 Vali Acc: 0.333 Test Loss: 1.334 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5114398002624512
Epoch: 23, Steps: 1 | Train Loss: 0.246 Vali Loss: 1.343 Vali Acc: 0.333 Test Loss: 1.343 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.4068574905395508
Epoch: 24, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 421475
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs43_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7207419872283936
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4758741855621338
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.4199094772338867
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.261 Vali Acc: 0.133 Test Loss: 1.261 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6125574111938477
Epoch: 4, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.5208339691162109
Epoch: 5, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.5036864280700684
Epoch: 6, Steps: 1 | Train Loss: 0.961 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 7 cost time: 0.4785628318786621
Epoch: 7, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 8 cost time: 0.5477728843688965
Epoch: 8, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.260 Vali Acc: 0.200 Test Loss: 1.260 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 9 cost time: 0.4437556266784668
Epoch: 9, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4446725845336914
Epoch: 10, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 11 cost time: 0.47980713844299316
Epoch: 11, Steps: 1 | Train Loss: 0.727 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5911755561828613
Epoch: 12, Steps: 1 | Train Loss: 0.675 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5433957576751709
Epoch: 13, Steps: 1 | Train Loss: 0.623 Vali Loss: 1.271 Vali Acc: 0.267 Test Loss: 1.271 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.45526981353759766
Epoch: 14, Steps: 1 | Train Loss: 0.573 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5364351272583008
Epoch: 15, Steps: 1 | Train Loss: 0.524 Vali Loss: 1.281 Vali Acc: 0.267 Test Loss: 1.281 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5017118453979492
Epoch: 16, Steps: 1 | Train Loss: 0.478 Vali Loss: 1.288 Vali Acc: 0.267 Test Loss: 1.288 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4648449420928955
Epoch: 17, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4290127754211426
Epoch: 18, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.303 Vali Acc: 0.267 Test Loss: 1.303 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5515239238739014
Epoch: 19, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.48288416862487793
Epoch: 20, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.320 Vali Acc: 0.200 Test Loss: 1.320 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs43_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 422129
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs40_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.7340686321258545
Epoch: 1, Steps: 1 | Train Loss: 1.199 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5162885189056396
Epoch: 2, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.166 Vali Acc: 0.333 Test Loss: 1.166 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.43291211128234863
Epoch: 3, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.163 Vali Acc: 0.333 Test Loss: 1.163 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.463698148727417
Epoch: 4, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.48085570335388184
Epoch: 5, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.42124223709106445
Epoch: 6, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.49267101287841797
Epoch: 7, Steps: 1 | Train Loss: 1.031 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5004522800445557
Epoch: 8, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.41136717796325684
Epoch: 9, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4581298828125
Epoch: 10, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.147 Vali Acc: 0.400 Test Loss: 1.147 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 11 cost time: 0.42728567123413086
Epoch: 11, Steps: 1 | Train Loss: 0.797 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 12 cost time: 0.5053517818450928
Epoch: 12, Steps: 1 | Train Loss: 0.735 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 13 cost time: 0.7419614791870117
Epoch: 13, Steps: 1 | Train Loss: 0.676 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.3605616092681885
Epoch: 14, Steps: 1 | Train Loss: 0.619 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.425173282623291
Epoch: 15, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5253210067749023
Epoch: 16, Steps: 1 | Train Loss: 0.514 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5262007713317871
Epoch: 17, Steps: 1 | Train Loss: 0.466 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.3943815231323242
Epoch: 18, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.4383978843688965
Epoch: 19, Steps: 1 | Train Loss: 0.381 Vali Loss: 1.166 Vali Acc: 0.200 Test Loss: 1.166 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.4011702537536621
Epoch: 20, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.414825439453125
Epoch: 21, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.43192172050476074
Epoch: 22, Steps: 1 | Train Loss: 0.276 Vali Loss: 1.189 Vali Acc: 0.200 Test Loss: 1.189 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs40_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 418947
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs38_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6439414024353027
Epoch: 1, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.5141615867614746
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.4942343235015869
Epoch: 3, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.513373613357544
Epoch: 4, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.186 Vali Acc: 0.333 Test Loss: 1.186 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5197312831878662
Epoch: 5, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5951831340789795
Epoch: 6, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.4713785648345947
Epoch: 7, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.48445701599121094
Epoch: 8, Steps: 1 | Train Loss: 0.936 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.54376220703125
Epoch: 9, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 10 cost time: 0.545734167098999
Epoch: 10, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.182 Vali Acc: 0.400 Test Loss: 1.182 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5164954662322998
Epoch: 11, Steps: 1 | Train Loss: 0.772 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.602872371673584
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.49151039123535156
Epoch: 13, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5226104259490967
Epoch: 14, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5913598537445068
Epoch: 15, Steps: 1 | Train Loss: 0.558 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5920698642730713
Epoch: 16, Steps: 1 | Train Loss: 0.510 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5208899974822998
Epoch: 17, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 18 cost time: 0.48517847061157227
Epoch: 18, Steps: 1 | Train Loss: 0.422 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5429716110229492
Epoch: 19, Steps: 1 | Train Loss: 0.382 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5160629749298096
Epoch: 20, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.49124598503112793
Epoch: 21, Steps: 1 | Train Loss: 0.310 Vali Loss: 1.243 Vali Acc: 0.333 Test Loss: 1.243 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.45768070220947266
Epoch: 22, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5281052589416504
Epoch: 23, Steps: 1 | Train Loss: 0.250 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.4989910125732422
Epoch: 24, Steps: 1 | Train Loss: 0.224 Vali Loss: 1.276 Vali Acc: 0.400 Test Loss: 1.276 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.46489858627319336
Epoch: 25, Steps: 1 | Train Loss: 0.201 Vali Loss: 1.287 Vali Acc: 0.400 Test Loss: 1.287 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6633574962615967
Epoch: 26, Steps: 1 | Train Loss: 0.180 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5274345874786377
Epoch: 27, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.310 Vali Acc: 0.333 Test Loss: 1.310 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs38_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 422825
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.547825813293457
Epoch: 1, Steps: 1 | Train Loss: 1.293 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5140495300292969
Epoch: 2, Steps: 1 | Train Loss: 1.267 Vali Loss: 1.110 Vali Acc: 0.333 Test Loss: 1.110 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5576746463775635
Epoch: 3, Steps: 1 | Train Loss: 1.242 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4745297431945801
Epoch: 4, Steps: 1 | Train Loss: 1.218 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4629957675933838
Epoch: 5, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.104 Vali Acc: 0.333 Test Loss: 1.104 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5329563617706299
Epoch: 6, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.469010591506958
Epoch: 7, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4492318630218506
Epoch: 8, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.099 Vali Acc: 0.267 Test Loss: 1.099 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5129454135894775
Epoch: 9, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 10 cost time: 0.4492816925048828
Epoch: 10, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.5993521213531494
Epoch: 11, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 12 cost time: 0.39235544204711914
Epoch: 12, Steps: 1 | Train Loss: 0.828 Vali Loss: 1.097 Vali Acc: 0.333 Test Loss: 1.097 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.38657188415527344
Epoch: 13, Steps: 1 | Train Loss: 0.766 Vali Loss: 1.098 Vali Acc: 0.333 Test Loss: 1.098 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.4848151206970215
Epoch: 14, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.101 Vali Acc: 0.333 Test Loss: 1.101 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.46226000785827637
Epoch: 15, Steps: 1 | Train Loss: 0.647 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.42470812797546387
Epoch: 16, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.4620039463043213
Epoch: 17, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5126569271087646
Epoch: 18, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.442213773727417
Epoch: 19, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.4416487216949463
Epoch: 20, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5257120132446289
Epoch: 21, Steps: 1 | Train Loss: 0.359 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 22 cost time: 0.49771928787231445
Epoch: 22, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.146 Vali Acc: 0.400 Test Loss: 1.146 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.40172553062438965
Epoch: 23, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.154 Vali Acc: 0.400 Test Loss: 1.154 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.47991013526916504
Epoch: 24, Steps: 1 | Train Loss: 0.259 Vali Loss: 1.163 Vali Acc: 0.400 Test Loss: 1.163 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.3973369598388672
Epoch: 25, Steps: 1 | Train Loss: 0.231 Vali Loss: 1.171 Vali Acc: 0.400 Test Loss: 1.171 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.49640560150146484
Epoch: 26, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.48079609870910645
Epoch: 27, Steps: 1 | Train Loss: 0.184 Vali Loss: 1.189 Vali Acc: 0.333 Test Loss: 1.189 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.3710513114929199
Epoch: 28, Steps: 1 | Train Loss: 0.164 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5440170764923096
Epoch: 29, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.206 Vali Acc: 0.333 Test Loss: 1.206 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5744943618774414
Epoch: 30, Steps: 1 | Train Loss: 0.130 Vali Loss: 1.215 Vali Acc: 0.333 Test Loss: 1.215 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.40355992317199707
Epoch: 31, Steps: 1 | Train Loss: 0.116 Vali Loss: 1.223 Vali Acc: 0.333 Test Loss: 1.223 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 424147
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs34_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5358366966247559
Epoch: 1, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4379866123199463
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5113260746002197
Epoch: 3, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.164 Vali Acc: 0.200 Test Loss: 1.164 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.48566603660583496
Epoch: 4, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.46704936027526855
Epoch: 5, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5161819458007812
Epoch: 6, Steps: 1 | Train Loss: 0.977 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4949359893798828
Epoch: 7, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4697587490081787
Epoch: 8, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5700228214263916
Epoch: 9, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4604649543762207
Epoch: 10, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.159 Vali Acc: 0.200 Test Loss: 1.159 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5439374446868896
Epoch: 11, Steps: 1 | Train Loss: 0.724 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4486124515533447
Epoch: 12, Steps: 1 | Train Loss: 0.670 Vali Loss: 1.161 Vali Acc: 0.200 Test Loss: 1.161 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4530975818634033
Epoch: 13, Steps: 1 | Train Loss: 0.618 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.45695924758911133
Epoch: 14, Steps: 1 | Train Loss: 0.568 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.42588019371032715
Epoch: 15, Steps: 1 | Train Loss: 0.522 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.46564817428588867
Epoch: 16, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.172 Vali Acc: 0.200 Test Loss: 1.172 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs34_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 422913
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs32_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.5557317733764648
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.231 Vali Acc: 0.133 Test Loss: 1.231 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5059213638305664
Epoch: 2, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.229 Vali Acc: 0.133 Test Loss: 1.229 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.4786381721496582
Epoch: 3, Steps: 1 | Train Loss: 1.136 Vali Loss: 1.228 Vali Acc: 0.133 Test Loss: 1.228 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.4321737289428711
Epoch: 4, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5811231136322021
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5869741439819336
Epoch: 6, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 7 cost time: 0.434161901473999
Epoch: 7, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 8 cost time: 0.5735893249511719
Epoch: 8, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.6591136455535889
Epoch: 9, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 10 cost time: 0.5074412822723389
Epoch: 10, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 11 cost time: 0.5031886100769043
Epoch: 11, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.53865647315979
Epoch: 12, Steps: 1 | Train Loss: 0.748 Vali Loss: 1.223 Vali Acc: 0.133 Test Loss: 1.223 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5072669982910156
Epoch: 13, Steps: 1 | Train Loss: 0.691 Vali Loss: 1.225 Vali Acc: 0.200 Test Loss: 1.225 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4777257442474365
Epoch: 14, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4825780391693115
Epoch: 15, Steps: 1 | Train Loss: 0.582 Vali Loss: 1.230 Vali Acc: 0.200 Test Loss: 1.230 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.46183013916015625
Epoch: 16, Steps: 1 | Train Loss: 0.531 Vali Loss: 1.234 Vali Acc: 0.200 Test Loss: 1.234 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.4822533130645752
Epoch: 17, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.239 Vali Acc: 0.200 Test Loss: 1.239 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.4146146774291992
Epoch: 18, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.244 Vali Acc: 0.200 Test Loss: 1.244 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.4980504512786865
Epoch: 19, Steps: 1 | Train Loss: 0.395 Vali Loss: 1.250 Vali Acc: 0.200 Test Loss: 1.250 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5302145481109619
Epoch: 20, Steps: 1 | Train Loss: 0.356 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs32_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.2
model parameter : 419123
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_AtrialFibrillationModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/AtrialFibrillation
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

15
15
>>>>>>>start training : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
15
15
15
Epoch: 1 cost time: 1.6450045108795166
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.143 Vali Acc: 0.267 Test Loss: 1.143 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4666283130645752
Epoch: 2, Steps: 1 | Train Loss: 1.135 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.46428871154785156
Epoch: 3, Steps: 1 | Train Loss: 1.111 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.47523927688598633
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.141 Vali Acc: 0.267 Test Loss: 1.141 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5023770332336426
Epoch: 5, Steps: 1 | Train Loss: 1.064 Vali Loss: 1.140 Vali Acc: 0.200 Test Loss: 1.140 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4241063594818115
Epoch: 6, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.139 Vali Acc: 0.200 Test Loss: 1.139 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5664143562316895
Epoch: 7, Steps: 1 | Train Loss: 1.000 Vali Loss: 1.138 Vali Acc: 0.200 Test Loss: 1.138 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.6030876636505127
Epoch: 8, Steps: 1 | Train Loss: 0.949 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.573307991027832
Epoch: 9, Steps: 1 | Train Loss: 0.893 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.6574094295501709
Epoch: 10, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.137 Vali Acc: 0.133 Test Loss: 1.137 Test Acc: 0.133
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5022523403167725
Epoch: 11, Steps: 1 | Train Loss: 0.775 Vali Loss: 1.138 Vali Acc: 0.133 Test Loss: 1.138 Test Acc: 0.133
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5011992454528809
Epoch: 12, Steps: 1 | Train Loss: 0.716 Vali Loss: 1.139 Vali Acc: 0.133 Test Loss: 1.139 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4940011501312256
Epoch: 13, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5271298885345459
Epoch: 14, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_AtrialFibrillation_LightTS_UEA_ftM_sl640_ll0_pl0_dm32_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 426233
model size : 1.64MB
