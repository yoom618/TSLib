Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7574419
	speed: 0.0346s/iter; left time: 1424.1627s
	iters: 200, epoch: 1 | loss: 0.2126302
	speed: 0.0157s/iter; left time: 644.5190s
	iters: 300, epoch: 1 | loss: 0.1374863
	speed: 0.0142s/iter; left time: 581.7987s
	iters: 400, epoch: 1 | loss: 0.0253248
	speed: 0.0178s/iter; left time: 726.3701s
Epoch: 1 cost time: 8.4518141746521
Epoch: 1, Steps: 413 | Train Loss: 0.648 Vali Loss: 0.131 Vali Acc: 0.959 Test Loss: 0.131 Test Acc: 0.959
Validation loss decreased (inf --> -0.958616).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0000648
	speed: 0.0693s/iter; left time: 2827.6077s
	iters: 200, epoch: 2 | loss: 0.0029791
	speed: 0.0151s/iter; left time: 613.6975s
	iters: 300, epoch: 2 | loss: 0.0155248
	speed: 0.0177s/iter; left time: 719.4433s
	iters: 400, epoch: 2 | loss: 0.0055679
	speed: 0.0165s/iter; left time: 669.7087s
Epoch: 2 cost time: 7.202522039413452
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.958616 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0019149
	speed: 0.0738s/iter; left time: 2980.0969s
	iters: 200, epoch: 3 | loss: 0.0195311
	speed: 0.0155s/iter; left time: 626.0638s
	iters: 300, epoch: 3 | loss: 0.0661429
	speed: 0.0189s/iter; left time: 760.3993s
	iters: 400, epoch: 3 | loss: 0.0151648
	speed: 0.0170s/iter; left time: 680.4483s
Epoch: 3 cost time: 7.385708808898926
Epoch: 3, Steps: 413 | Train Loss: 0.097 Vali Loss: 0.075 Vali Acc: 0.974 Test Loss: 0.075 Test Acc: 0.974
Validation loss decreased (-0.962254 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0258667
	speed: 0.0777s/iter; left time: 3106.5254s
	iters: 200, epoch: 4 | loss: 0.2714878
	speed: 0.0184s/iter; left time: 734.1332s
	iters: 300, epoch: 4 | loss: 0.2391084
	speed: 0.0176s/iter; left time: 701.1228s
	iters: 400, epoch: 4 | loss: 0.3495159
	speed: 0.0155s/iter; left time: 614.5603s
Epoch: 4 cost time: 7.741729497909546
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0314821
	speed: 0.0622s/iter; left time: 2461.2426s
	iters: 200, epoch: 5 | loss: 0.0012654
	speed: 0.0136s/iter; left time: 537.4444s
	iters: 300, epoch: 5 | loss: 0.0115968
	speed: 0.0152s/iter; left time: 597.4768s
	iters: 400, epoch: 5 | loss: 0.0081258
	speed: 0.0118s/iter; left time: 464.9370s
Epoch: 5 cost time: 5.93581485748291
Epoch: 5, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0061351
	speed: 0.0583s/iter; left time: 2280.8444s
	iters: 200, epoch: 6 | loss: 0.0412738
	speed: 0.0143s/iter; left time: 559.6500s
	iters: 300, epoch: 6 | loss: 0.0223920
	speed: 0.0137s/iter; left time: 533.2241s
	iters: 400, epoch: 6 | loss: 0.0022290
	speed: 0.0156s/iter; left time: 605.8225s
Epoch: 6 cost time: 6.466634035110474
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0133191
	speed: 0.0660s/iter; left time: 2554.3809s
	iters: 200, epoch: 7 | loss: 0.0106116
	speed: 0.0170s/iter; left time: 658.2798s
	iters: 300, epoch: 7 | loss: 0.0299482
	speed: 0.0164s/iter; left time: 630.3431s
	iters: 400, epoch: 7 | loss: 0.0022256
	speed: 0.0176s/iter; left time: 674.4314s
Epoch: 7 cost time: 7.218315839767456
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0255222
	speed: 0.0773s/iter; left time: 2960.9081s
	iters: 200, epoch: 8 | loss: 0.0062491
	speed: 0.0146s/iter; left time: 556.8892s
	iters: 300, epoch: 8 | loss: 0.0258807
	speed: 0.0153s/iter; left time: 582.3247s
	iters: 400, epoch: 8 | loss: 0.0409155
	speed: 0.0141s/iter; left time: 536.0196s
Epoch: 8 cost time: 6.577120780944824
Epoch: 8, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0003194
	speed: 0.0701s/iter; left time: 2658.0854s
	iters: 200, epoch: 9 | loss: 0.0001048
	speed: 0.0166s/iter; left time: 629.0398s
	iters: 300, epoch: 9 | loss: 0.0018901
	speed: 0.0170s/iter; left time: 639.9119s
	iters: 400, epoch: 9 | loss: 0.0003608
	speed: 0.0151s/iter; left time: 567.9937s
Epoch: 9 cost time: 6.990082502365112
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.973 Test Loss: 0.109 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0268119
	speed: 0.0767s/iter; left time: 2876.4275s
	iters: 200, epoch: 10 | loss: 0.0050157
	speed: 0.0177s/iter; left time: 662.6740s
	iters: 300, epoch: 10 | loss: 0.0005331
	speed: 0.0168s/iter; left time: 625.3115s
	iters: 400, epoch: 10 | loss: 0.1936062
	speed: 0.0163s/iter; left time: 607.5806s
Epoch: 10 cost time: 7.2335381507873535
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0015716
	speed: 0.0628s/iter; left time: 2327.2724s
	iters: 200, epoch: 11 | loss: 0.0418156
	speed: 0.0158s/iter; left time: 584.7638s
	iters: 300, epoch: 11 | loss: 0.0050807
	speed: 0.0155s/iter; left time: 571.7959s
	iters: 400, epoch: 11 | loss: 0.0005718
	speed: 0.0165s/iter; left time: 605.7222s
Epoch: 11 cost time: 7.082827091217041
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000221
	speed: 0.0635s/iter; left time: 2329.3638s
	iters: 200, epoch: 12 | loss: 0.0002808
	speed: 0.0132s/iter; left time: 483.0351s
	iters: 300, epoch: 12 | loss: 0.0010240
	speed: 0.0140s/iter; left time: 508.6415s
	iters: 400, epoch: 12 | loss: 0.0000251
	speed: 0.0128s/iter; left time: 465.3008s
Epoch: 12 cost time: 6.037999629974365
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0032337
	speed: 0.0715s/iter; left time: 2592.7624s
	iters: 200, epoch: 13 | loss: 0.0260916
	speed: 0.0154s/iter; left time: 557.9991s
	iters: 300, epoch: 13 | loss: 0.0013322
	speed: 0.0140s/iter; left time: 505.6756s
	iters: 400, epoch: 13 | loss: 0.0005336
	speed: 0.0150s/iter; left time: 540.0191s
Epoch: 13 cost time: 6.748971700668335
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.956 Test Loss: 0.200 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 138412
model size : 0.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1911479
	speed: 0.0334s/iter; left time: 1375.4158s
	iters: 200, epoch: 1 | loss: 0.0905084
	speed: 0.0200s/iter; left time: 820.9912s
	iters: 300, epoch: 1 | loss: 0.4130419
	speed: 0.0169s/iter; left time: 692.5716s
	iters: 400, epoch: 1 | loss: 0.0497266
	speed: 0.0194s/iter; left time: 792.9438s
Epoch: 1 cost time: 9.24561333656311
Epoch: 1, Steps: 413 | Train Loss: 0.661 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
Validation loss decreased (inf --> -0.939062).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1005966
	speed: 0.0696s/iter; left time: 2838.0483s
	iters: 200, epoch: 2 | loss: 0.0128718
	speed: 0.0152s/iter; left time: 619.4621s
	iters: 300, epoch: 2 | loss: 0.2826086
	speed: 0.0161s/iter; left time: 653.0161s
	iters: 400, epoch: 2 | loss: 0.0158366
	speed: 0.0146s/iter; left time: 589.1948s
Epoch: 2 cost time: 6.88571834564209
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.108 Vali Acc: 0.960 Test Loss: 0.108 Test Acc: 0.960
Validation loss decreased (-0.939062 --> -0.959981).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0019486
	speed: 0.0627s/iter; left time: 2533.2009s
	iters: 200, epoch: 3 | loss: 0.1867082
	speed: 0.0166s/iter; left time: 669.6533s
	iters: 300, epoch: 3 | loss: 0.1037079
	speed: 0.0128s/iter; left time: 513.8606s
	iters: 400, epoch: 3 | loss: 0.0391424
	speed: 0.0121s/iter; left time: 484.4825s
Epoch: 3 cost time: 6.091120958328247
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
Validation loss decreased (-0.959981 --> -0.965892).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.3504431
	speed: 0.0615s/iter; left time: 2456.8933s
	iters: 200, epoch: 4 | loss: 0.0120302
	speed: 0.0153s/iter; left time: 610.3181s
	iters: 300, epoch: 4 | loss: 0.3815495
	speed: 0.0156s/iter; left time: 621.5701s
	iters: 400, epoch: 4 | loss: 0.0019688
	speed: 0.0154s/iter; left time: 611.8584s
Epoch: 4 cost time: 6.967287302017212
Epoch: 4, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.107 Vali Acc: 0.960 Test Loss: 0.107 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0007999
	speed: 0.0865s/iter; left time: 3421.6472s
	iters: 200, epoch: 5 | loss: 0.0018141
	speed: 0.0175s/iter; left time: 688.9226s
	iters: 300, epoch: 5 | loss: 0.0792746
	speed: 0.0159s/iter; left time: 624.7208s
	iters: 400, epoch: 5 | loss: 0.0051017
	speed: 0.0160s/iter; left time: 628.8435s
Epoch: 5 cost time: 7.559030294418335
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.110 Vali Acc: 0.967 Test Loss: 0.110 Test Acc: 0.967
Validation loss decreased (-0.965892 --> -0.967257).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0014713
	speed: 0.0775s/iter; left time: 3033.4550s
	iters: 200, epoch: 6 | loss: 0.0001895
	speed: 0.0194s/iter; left time: 755.8625s
	iters: 300, epoch: 6 | loss: 0.0029699
	speed: 0.0167s/iter; left time: 651.4929s
	iters: 400, epoch: 6 | loss: 0.0022889
	speed: 0.0185s/iter; left time: 720.2642s
Epoch: 6 cost time: 7.4601149559021
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
Validation loss decreased (-0.967257 --> -0.967711).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0011098
	speed: 0.0807s/iter; left time: 3123.8671s
	iters: 200, epoch: 7 | loss: 0.0000110
	speed: 0.0169s/iter; left time: 650.9970s
	iters: 300, epoch: 7 | loss: 0.0002012
	speed: 0.0160s/iter; left time: 617.9424s
	iters: 400, epoch: 7 | loss: 0.0055796
	speed: 0.0171s/iter; left time: 655.4535s
Epoch: 7 cost time: 7.2978127002716064
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.2517048
	speed: 0.0649s/iter; left time: 2485.6956s
	iters: 200, epoch: 8 | loss: 0.0372706
	speed: 0.0147s/iter; left time: 563.1420s
	iters: 300, epoch: 8 | loss: 0.0156036
	speed: 0.0148s/iter; left time: 562.6202s
	iters: 400, epoch: 8 | loss: 0.2047982
	speed: 0.0145s/iter; left time: 551.4496s
Epoch: 8 cost time: 6.552401781082153
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.083 Vali Acc: 0.977 Test Loss: 0.083 Test Acc: 0.977
Validation loss decreased (-0.967711 --> -0.976807).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0003319
	speed: 0.0560s/iter; left time: 2121.3758s
	iters: 200, epoch: 9 | loss: 0.0388670
	speed: 0.0142s/iter; left time: 536.1324s
	iters: 300, epoch: 9 | loss: 0.4347370
	speed: 0.0149s/iter; left time: 563.0583s
	iters: 400, epoch: 9 | loss: 0.1791512
	speed: 0.0126s/iter; left time: 472.3710s
Epoch: 9 cost time: 6.133469581604004
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0429172
	speed: 0.0516s/iter; left time: 1933.5362s
	iters: 200, epoch: 10 | loss: 0.0122143
	speed: 0.0150s/iter; left time: 561.8083s
	iters: 300, epoch: 10 | loss: 0.0050400
	speed: 0.0164s/iter; left time: 613.3157s
	iters: 400, epoch: 10 | loss: 0.0394930
	speed: 0.0192s/iter; left time: 712.1098s
Epoch: 10 cost time: 7.495781421661377
Epoch: 10, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0001409
	speed: 0.0930s/iter; left time: 3446.1326s
	iters: 200, epoch: 11 | loss: 0.0231098
	speed: 0.0168s/iter; left time: 619.8167s
	iters: 300, epoch: 11 | loss: 0.0219977
	speed: 0.0187s/iter; left time: 688.6093s
	iters: 400, epoch: 11 | loss: 0.0000592
	speed: 0.0197s/iter; left time: 725.0459s
Epoch: 11 cost time: 8.35563850402832
Epoch: 11, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.172 Vali Acc: 0.962 Test Loss: 0.172 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0024739
	speed: 0.0797s/iter; left time: 2921.8500s
	iters: 200, epoch: 12 | loss: 0.0119236
	speed: 0.0213s/iter; left time: 778.4039s
	iters: 300, epoch: 12 | loss: 0.0002512
	speed: 0.0202s/iter; left time: 736.3754s
	iters: 400, epoch: 12 | loss: 0.0108994
	speed: 0.0158s/iter; left time: 575.6491s
Epoch: 12 cost time: 8.056320190429688
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0023437
	speed: 0.0775s/iter; left time: 2808.5412s
	iters: 200, epoch: 13 | loss: 0.0139944
	speed: 0.0211s/iter; left time: 762.6751s
	iters: 300, epoch: 13 | loss: 0.0000137
	speed: 0.0186s/iter; left time: 670.7096s
	iters: 400, epoch: 13 | loss: 0.0000046
	speed: 0.0188s/iter; left time: 676.2029s
Epoch: 13 cost time: 8.317414283752441
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000178
	speed: 0.0691s/iter; left time: 2474.6722s
	iters: 200, epoch: 14 | loss: 0.0341868
	speed: 0.0147s/iter; left time: 525.9736s
	iters: 300, epoch: 14 | loss: 0.0065301
	speed: 0.0158s/iter; left time: 563.8981s
	iters: 400, epoch: 14 | loss: 0.0009521
	speed: 0.0135s/iter; left time: 478.3604s
Epoch: 14 cost time: 6.641947031021118
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0034483
	speed: 0.0707s/iter; left time: 2503.5404s
	iters: 200, epoch: 15 | loss: 0.0000370
	speed: 0.0161s/iter; left time: 567.0709s
	iters: 300, epoch: 15 | loss: 0.0000315
	speed: 0.0141s/iter; left time: 495.5965s
	iters: 400, epoch: 15 | loss: 0.0006113
	speed: 0.0140s/iter; left time: 490.6609s
Epoch: 15 cost time: 6.7430572509765625
Epoch: 15, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0564949
	speed: 0.0688s/iter; left time: 2408.7648s
	iters: 200, epoch: 16 | loss: 0.0372613
	speed: 0.0151s/iter; left time: 527.8388s
	iters: 300, epoch: 16 | loss: 0.0015298
	speed: 0.0154s/iter; left time: 536.9909s
	iters: 400, epoch: 16 | loss: 0.0000060
	speed: 0.0166s/iter; left time: 576.4666s
Epoch: 16 cost time: 7.136664152145386
Epoch: 16, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0005075
	speed: 0.0782s/iter; left time: 2705.6999s
	iters: 200, epoch: 17 | loss: 0.0000142
	speed: 0.0139s/iter; left time: 478.3494s
	iters: 300, epoch: 17 | loss: 0.0000013
	speed: 0.0152s/iter; left time: 521.1857s
	iters: 400, epoch: 17 | loss: 0.0003218
	speed: 0.0180s/iter; left time: 618.6559s
Epoch: 17 cost time: 6.964499473571777
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0003641
	speed: 0.0793s/iter; left time: 2711.8445s
	iters: 200, epoch: 18 | loss: 0.0100641
	speed: 0.0171s/iter; left time: 583.6853s
	iters: 300, epoch: 18 | loss: 0.0000855
	speed: 0.0174s/iter; left time: 590.9211s
	iters: 400, epoch: 18 | loss: 0.2991360
	speed: 0.0155s/iter; left time: 523.9637s
Epoch: 18 cost time: 7.038099527359009
Epoch: 18, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 134237
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8483297
	speed: 0.0288s/iter; left time: 1188.4250s
	iters: 200, epoch: 1 | loss: 0.3827811
	speed: 0.0139s/iter; left time: 571.3841s
	iters: 300, epoch: 1 | loss: 0.1253780
	speed: 0.0138s/iter; left time: 564.4860s
	iters: 400, epoch: 1 | loss: 0.2138762
	speed: 0.0154s/iter; left time: 630.2827s
Epoch: 1 cost time: 7.417003631591797
Epoch: 1, Steps: 413 | Train Loss: 0.671 Vali Loss: 0.142 Vali Acc: 0.955 Test Loss: 0.142 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2781607
	speed: 0.0589s/iter; left time: 2400.9755s
	iters: 200, epoch: 2 | loss: 0.0867815
	speed: 0.0144s/iter; left time: 584.9315s
	iters: 300, epoch: 2 | loss: 0.2033305
	speed: 0.0157s/iter; left time: 638.1410s
	iters: 400, epoch: 2 | loss: 0.0109438
	speed: 0.0148s/iter; left time: 599.6144s
Epoch: 2 cost time: 6.438255071640015
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
Validation loss decreased (-0.954978 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0153793
	speed: 0.0787s/iter; left time: 3176.7909s
	iters: 200, epoch: 3 | loss: 0.2579368
	speed: 0.0177s/iter; left time: 713.8117s
	iters: 300, epoch: 3 | loss: 0.0554872
	speed: 0.0162s/iter; left time: 650.4195s
	iters: 400, epoch: 3 | loss: 0.0138383
	speed: 0.0147s/iter; left time: 591.0649s
Epoch: 3 cost time: 7.2704689502716064
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.067 Vali Acc: 0.975 Test Loss: 0.067 Test Acc: 0.975
Validation loss decreased (-0.966802 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0311924
	speed: 0.0673s/iter; left time: 2688.5393s
	iters: 200, epoch: 4 | loss: 0.0147868
	speed: 0.0172s/iter; left time: 686.0994s
	iters: 300, epoch: 4 | loss: 0.0062750
	speed: 0.0154s/iter; left time: 611.0213s
	iters: 400, epoch: 4 | loss: 0.0098581
	speed: 0.0140s/iter; left time: 556.5209s
Epoch: 4 cost time: 6.682499408721924
Epoch: 4, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.975897).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0063680
	speed: 0.0758s/iter; left time: 2997.0684s
	iters: 200, epoch: 5 | loss: 0.0011649
	speed: 0.0140s/iter; left time: 553.2249s
	iters: 300, epoch: 5 | loss: 0.0365060
	speed: 0.0142s/iter; left time: 559.9717s
	iters: 400, epoch: 5 | loss: 0.0049590
	speed: 0.0162s/iter; left time: 637.2641s
Epoch: 5 cost time: 6.617863416671753
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.122 Vali Acc: 0.960 Test Loss: 0.122 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1344009
	speed: 0.0761s/iter; left time: 2980.0602s
	iters: 200, epoch: 6 | loss: 0.0267020
	speed: 0.0141s/iter; left time: 551.2709s
	iters: 300, epoch: 6 | loss: 0.0081503
	speed: 0.0144s/iter; left time: 562.5124s
	iters: 400, epoch: 6 | loss: 0.0003595
	speed: 0.0153s/iter; left time: 592.4626s
Epoch: 6 cost time: 6.512062072753906
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.085 Vali Acc: 0.970 Test Loss: 0.085 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0008158
	speed: 0.0656s/iter; left time: 2541.0985s
	iters: 200, epoch: 7 | loss: 0.1593159
	speed: 0.0149s/iter; left time: 576.0310s
	iters: 300, epoch: 7 | loss: 0.1535993
	speed: 0.0141s/iter; left time: 544.1477s
	iters: 400, epoch: 7 | loss: 0.1166929
	speed: 0.0136s/iter; left time: 524.0428s
Epoch: 7 cost time: 6.1987433433532715
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0041225
	speed: 0.0617s/iter; left time: 2365.3933s
	iters: 200, epoch: 8 | loss: 0.0109351
	speed: 0.0145s/iter; left time: 553.8163s
	iters: 300, epoch: 8 | loss: 0.0097906
	speed: 0.0140s/iter; left time: 532.2977s
	iters: 400, epoch: 8 | loss: 0.0108823
	speed: 0.0176s/iter; left time: 668.6342s
Epoch: 8 cost time: 6.622874975204468
Epoch: 8, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.082 Vali Acc: 0.978 Test Loss: 0.082 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.977716).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0024291
	speed: 0.0771s/iter; left time: 2922.8218s
	iters: 200, epoch: 9 | loss: 0.0000365
	speed: 0.0177s/iter; left time: 668.3086s
	iters: 300, epoch: 9 | loss: 0.0448794
	speed: 0.0191s/iter; left time: 719.2786s
	iters: 400, epoch: 9 | loss: 0.0011958
	speed: 0.0147s/iter; left time: 554.4431s
Epoch: 9 cost time: 7.475471019744873
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0758592
	speed: 0.0666s/iter; left time: 2498.2551s
	iters: 200, epoch: 10 | loss: 0.0003266
	speed: 0.0142s/iter; left time: 529.4018s
	iters: 300, epoch: 10 | loss: 0.0012322
	speed: 0.0184s/iter; left time: 685.9099s
	iters: 400, epoch: 10 | loss: 0.0116784
	speed: 0.0139s/iter; left time: 517.5064s
Epoch: 10 cost time: 6.817684173583984
Epoch: 10, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0003793
	speed: 0.0718s/iter; left time: 2661.2936s
	iters: 200, epoch: 11 | loss: 0.0125914
	speed: 0.0175s/iter; left time: 648.0473s
	iters: 300, epoch: 11 | loss: 0.0001562
	speed: 0.0165s/iter; left time: 608.2842s
	iters: 400, epoch: 11 | loss: 0.0096329
	speed: 0.0136s/iter; left time: 499.8411s
Epoch: 11 cost time: 7.0870068073272705
Epoch: 11, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000155
	speed: 0.0745s/iter; left time: 2731.6888s
	iters: 200, epoch: 12 | loss: 0.0007716
	speed: 0.0133s/iter; left time: 486.8740s
	iters: 300, epoch: 12 | loss: 0.0000067
	speed: 0.0132s/iter; left time: 481.3807s
	iters: 400, epoch: 12 | loss: 0.0000169
	speed: 0.0146s/iter; left time: 529.4016s
Epoch: 12 cost time: 6.12063193321228
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000755
	speed: 0.0704s/iter; left time: 2552.3874s
	iters: 200, epoch: 13 | loss: 0.0029351
	speed: 0.0129s/iter; left time: 467.2738s
	iters: 300, epoch: 13 | loss: 0.0000245
	speed: 0.0156s/iter; left time: 563.3346s
	iters: 400, epoch: 13 | loss: 0.0000589
	speed: 0.0149s/iter; left time: 537.1354s
Epoch: 13 cost time: 6.4097700119018555
Epoch: 13, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0010596
	speed: 0.0589s/iter; left time: 2112.2304s
	iters: 200, epoch: 14 | loss: 0.0928482
	speed: 0.0143s/iter; left time: 509.3025s
	iters: 300, epoch: 14 | loss: 0.0000011
	speed: 0.0194s/iter; left time: 690.9507s
	iters: 400, epoch: 14 | loss: 0.0000609
	speed: 0.0171s/iter; left time: 607.0379s
Epoch: 14 cost time: 7.104943037033081
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000063
	speed: 0.0736s/iter; left time: 2608.3748s
	iters: 200, epoch: 15 | loss: 0.0453704
	speed: 0.0156s/iter; left time: 549.2812s
	iters: 300, epoch: 15 | loss: 0.0007539
	speed: 0.0182s/iter; left time: 641.4808s
	iters: 400, epoch: 15 | loss: 0.0047413
	speed: 0.0173s/iter; left time: 609.3103s
Epoch: 15 cost time: 7.264307975769043
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0001722
	speed: 0.0812s/iter; left time: 2841.6450s
	iters: 200, epoch: 16 | loss: 0.0000385
	speed: 0.0203s/iter; left time: 709.3193s
	iters: 300, epoch: 16 | loss: 0.0010972
	speed: 0.0190s/iter; left time: 660.0239s
	iters: 400, epoch: 16 | loss: 0.0000598
	speed: 0.0182s/iter; left time: 631.5893s
Epoch: 16 cost time: 8.09879469871521
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.965 Test Loss: 0.140 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000004
	speed: 0.0770s/iter; left time: 2663.4086s
	iters: 200, epoch: 17 | loss: 0.0002129
	speed: 0.0161s/iter; left time: 555.3955s
	iters: 300, epoch: 17 | loss: 0.0285311
	speed: 0.0181s/iter; left time: 621.3872s
	iters: 400, epoch: 17 | loss: 0.0000001
	speed: 0.0189s/iter; left time: 647.9990s
Epoch: 17 cost time: 7.6475913524627686
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.1349093
	speed: 0.0717s/iter; left time: 2451.1774s
	iters: 200, epoch: 18 | loss: 0.0000438
	speed: 0.0186s/iter; left time: 632.2248s
	iters: 300, epoch: 18 | loss: 0.0107650
	speed: 0.0149s/iter; left time: 504.8534s
	iters: 400, epoch: 18 | loss: 0.0860465
	speed: 0.0139s/iter; left time: 471.2982s
Epoch: 18 cost time: 6.745645999908447
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 132742
model size : 0.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.4733236
	speed: 0.0304s/iter; left time: 1253.8872s
	iters: 200, epoch: 1 | loss: 0.5177271
	speed: 0.0185s/iter; left time: 761.4405s
	iters: 300, epoch: 1 | loss: 0.1706061
	speed: 0.0153s/iter; left time: 626.4522s
	iters: 400, epoch: 1 | loss: 0.1170014
	speed: 0.0163s/iter; left time: 666.7819s
Epoch: 1 cost time: 8.259919881820679
Epoch: 1, Steps: 413 | Train Loss: 0.672 Vali Loss: 0.227 Vali Acc: 0.932 Test Loss: 0.227 Test Acc: 0.932
Validation loss decreased (inf --> -0.931785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0513785
	speed: 0.0574s/iter; left time: 2343.2209s
	iters: 200, epoch: 2 | loss: 0.1945228
	speed: 0.0133s/iter; left time: 539.4515s
	iters: 300, epoch: 2 | loss: 0.0282538
	speed: 0.0135s/iter; left time: 548.6028s
	iters: 400, epoch: 2 | loss: 0.0154032
	speed: 0.0127s/iter; left time: 515.0178s
Epoch: 2 cost time: 5.8032026290893555
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (-0.931785 --> -0.940881).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0079163
	speed: 0.0715s/iter; left time: 2888.0251s
	iters: 200, epoch: 3 | loss: 0.6907544
	speed: 0.0157s/iter; left time: 631.7853s
	iters: 300, epoch: 3 | loss: 0.0057167
	speed: 0.0169s/iter; left time: 677.5098s
	iters: 400, epoch: 3 | loss: 0.0967204
	speed: 0.0145s/iter; left time: 579.7393s
Epoch: 3 cost time: 7.2738871574401855
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
Validation loss decreased (-0.940881 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1308417
	speed: 0.0874s/iter; left time: 3492.3966s
	iters: 200, epoch: 4 | loss: 0.0207588
	speed: 0.0198s/iter; left time: 789.5114s
	iters: 300, epoch: 4 | loss: 0.0051244
	speed: 0.0187s/iter; left time: 741.6117s
	iters: 400, epoch: 4 | loss: 0.0905342
	speed: 0.0179s/iter; left time: 708.5794s
Epoch: 4 cost time: 8.080562353134155
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.088 Vali Acc: 0.971 Test Loss: 0.088 Test Acc: 0.971
Validation loss decreased (-0.969985 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1485119
	speed: 0.0818s/iter; left time: 3233.1861s
	iters: 200, epoch: 5 | loss: 0.0531563
	speed: 0.0163s/iter; left time: 641.1306s
	iters: 300, epoch: 5 | loss: 0.0302214
	speed: 0.0148s/iter; left time: 584.2467s
	iters: 400, epoch: 5 | loss: 0.0087087
	speed: 0.0136s/iter; left time: 533.8577s
Epoch: 5 cost time: 6.756068468093872
Epoch: 5, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0083830
	speed: 0.0805s/iter; left time: 3152.0811s
	iters: 200, epoch: 6 | loss: 0.1067485
	speed: 0.0163s/iter; left time: 636.9480s
	iters: 300, epoch: 6 | loss: 0.0002215
	speed: 0.0154s/iter; left time: 600.6960s
	iters: 400, epoch: 6 | loss: 0.2610511
	speed: 0.0155s/iter; left time: 601.0757s
Epoch: 6 cost time: 7.117914915084839
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.963 Test Loss: 0.104 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1512656
	speed: 0.0849s/iter; left time: 3288.7872s
	iters: 200, epoch: 7 | loss: 0.0002064
	speed: 0.0146s/iter; left time: 563.8465s
	iters: 300, epoch: 7 | loss: 0.0398872
	speed: 0.0139s/iter; left time: 533.7387s
	iters: 400, epoch: 7 | loss: 0.3041039
	speed: 0.0140s/iter; left time: 537.5037s
Epoch: 7 cost time: 6.539193630218506
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0045631
	speed: 0.0678s/iter; left time: 2595.9691s
	iters: 200, epoch: 8 | loss: 0.0002730
	speed: 0.0147s/iter; left time: 559.9068s
	iters: 300, epoch: 8 | loss: 0.0106043
	speed: 0.0126s/iter; left time: 479.7917s
	iters: 400, epoch: 8 | loss: 0.0012014
	speed: 0.0178s/iter; left time: 675.3888s
Epoch: 8 cost time: 6.522272348403931
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
Validation loss decreased (-0.970895 --> -0.971804).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0114462
	speed: 0.0656s/iter; left time: 2487.2263s
	iters: 200, epoch: 9 | loss: 0.0004024
	speed: 0.0124s/iter; left time: 470.4393s
	iters: 300, epoch: 9 | loss: 0.0121258
	speed: 0.0140s/iter; left time: 528.9301s
	iters: 400, epoch: 9 | loss: 0.0003422
	speed: 0.0162s/iter; left time: 610.4190s
Epoch: 9 cost time: 6.098010540008545
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0009681
	speed: 0.0760s/iter; left time: 2848.9333s
	iters: 200, epoch: 10 | loss: 0.0453437
	speed: 0.0155s/iter; left time: 578.7602s
	iters: 300, epoch: 10 | loss: 0.0002347
	speed: 0.0151s/iter; left time: 563.7751s
	iters: 400, epoch: 10 | loss: 0.0131178
	speed: 0.0180s/iter; left time: 669.7373s
Epoch: 10 cost time: 7.081628322601318
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.973623).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0267791
	speed: 0.0844s/iter; left time: 3128.4095s
	iters: 200, epoch: 11 | loss: 0.0032906
	speed: 0.0145s/iter; left time: 536.6268s
	iters: 300, epoch: 11 | loss: 0.0224622
	speed: 0.0172s/iter; left time: 635.6759s
	iters: 400, epoch: 11 | loss: 0.0238641
	speed: 0.0168s/iter; left time: 618.2749s
Epoch: 11 cost time: 6.950897455215454
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.070 Vali Acc: 0.975 Test Loss: 0.070 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.975443).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0000547
	speed: 0.0752s/iter; left time: 2756.1873s
	iters: 200, epoch: 12 | loss: 0.0000423
	speed: 0.0166s/iter; left time: 606.3266s
	iters: 300, epoch: 12 | loss: 0.0958606
	speed: 0.0167s/iter; left time: 607.1037s
	iters: 400, epoch: 12 | loss: 0.0008789
	speed: 0.0174s/iter; left time: 632.2646s
Epoch: 12 cost time: 7.399798393249512
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0075130
	speed: 0.0709s/iter; left time: 2569.5746s
	iters: 200, epoch: 13 | loss: 0.1986604
	speed: 0.0143s/iter; left time: 516.0308s
	iters: 300, epoch: 13 | loss: 0.0061182
	speed: 0.0173s/iter; left time: 623.3945s
	iters: 400, epoch: 13 | loss: 0.0540182
	speed: 0.0176s/iter; left time: 633.5474s
Epoch: 13 cost time: 6.788713455200195
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.164 Vali Acc: 0.964 Test Loss: 0.164 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0037558
	speed: 0.0788s/iter; left time: 2824.9508s
	iters: 200, epoch: 14 | loss: 0.0000211
	speed: 0.0195s/iter; left time: 697.3842s
	iters: 300, epoch: 14 | loss: 0.1041639
	speed: 0.0177s/iter; left time: 630.2407s
	iters: 400, epoch: 14 | loss: 0.0213103
	speed: 0.0183s/iter; left time: 649.2933s
Epoch: 14 cost time: 8.116923093795776
Epoch: 14, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.964 Test Loss: 0.130 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0002172
	speed: 0.0903s/iter; left time: 3197.5397s
	iters: 200, epoch: 15 | loss: 0.0000125
	speed: 0.0241s/iter; left time: 850.3600s
	iters: 300, epoch: 15 | loss: 0.0005504
	speed: 0.0230s/iter; left time: 809.4694s
	iters: 400, epoch: 15 | loss: 0.0000057
	speed: 0.0225s/iter; left time: 791.6772s
Epoch: 15 cost time: 10.055653095245361
Epoch: 15, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0001093
	speed: 0.0955s/iter; left time: 3341.3726s
	iters: 200, epoch: 16 | loss: 0.0006498
	speed: 0.0231s/iter; left time: 805.3919s
	iters: 300, epoch: 16 | loss: 0.0000240
	speed: 0.0195s/iter; left time: 679.2402s
	iters: 400, epoch: 16 | loss: 0.0000103
	speed: 0.0208s/iter; left time: 722.0556s
Epoch: 16 cost time: 9.207001686096191
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0078514
	speed: 0.0854s/iter; left time: 2953.6472s
	iters: 200, epoch: 17 | loss: 0.0000084
	speed: 0.0177s/iter; left time: 611.8438s
	iters: 300, epoch: 17 | loss: 0.0000001
	speed: 0.0158s/iter; left time: 542.2314s
	iters: 400, epoch: 17 | loss: 0.0000158
	speed: 0.0212s/iter; left time: 727.5733s
Epoch: 17 cost time: 7.737954378128052
Epoch: 17, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000007
	speed: 0.0941s/iter; left time: 3217.5646s
	iters: 200, epoch: 18 | loss: 0.0000048
	speed: 0.0215s/iter; left time: 733.8997s
	iters: 300, epoch: 18 | loss: 0.0000002
	speed: 0.0210s/iter; left time: 715.1867s
	iters: 400, epoch: 18 | loss: 0.0000932
	speed: 0.0187s/iter; left time: 634.1433s
Epoch: 18 cost time: 8.74125623703003
Epoch: 18, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000095
	speed: 0.0942s/iter; left time: 3181.4715s
	iters: 200, epoch: 19 | loss: 0.0000016
	speed: 0.0177s/iter; left time: 594.5470s
	iters: 300, epoch: 19 | loss: 0.0000004
	speed: 0.0185s/iter; left time: 622.5000s
	iters: 400, epoch: 19 | loss: 0.0000038
	speed: 0.0200s/iter; left time: 669.5925s
Epoch: 19 cost time: 8.069231748580933
Epoch: 19, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000225
	speed: 0.0870s/iter; left time: 2900.4489s
	iters: 200, epoch: 20 | loss: 0.0000023
	speed: 0.0187s/iter; left time: 620.9911s
	iters: 300, epoch: 20 | loss: 0.0000098
	speed: 0.0187s/iter; left time: 619.0070s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0192s/iter; left time: 633.5573s
Epoch: 20 cost time: 8.355127334594727
Epoch: 20, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000060
	speed: 0.0830s/iter; left time: 2734.9630s
	iters: 200, epoch: 21 | loss: 0.0001545
	speed: 0.0213s/iter; left time: 698.1847s
	iters: 300, epoch: 21 | loss: 0.0000001
	speed: 0.0221s/iter; left time: 723.5714s
	iters: 400, epoch: 21 | loss: 0.0000017
	speed: 0.0190s/iter; left time: 619.6586s
Epoch: 21 cost time: 8.785232543945312
Epoch: 21, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 131391
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8930951
	speed: 0.0374s/iter; left time: 1542.2982s
	iters: 200, epoch: 1 | loss: 0.4059668
	speed: 0.0211s/iter; left time: 867.0052s
	iters: 300, epoch: 1 | loss: 0.1329979
	speed: 0.0223s/iter; left time: 914.4411s
	iters: 400, epoch: 1 | loss: 0.0822642
	speed: 0.0203s/iter; left time: 829.0430s
Epoch: 1 cost time: 10.443041801452637
Epoch: 1, Steps: 413 | Train Loss: 0.620 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0167939
	speed: 0.0922s/iter; left time: 3760.6312s
	iters: 200, epoch: 2 | loss: 0.1516536
	speed: 0.0191s/iter; left time: 778.9282s
	iters: 300, epoch: 2 | loss: 0.0019403
	speed: 0.0182s/iter; left time: 737.6695s
	iters: 400, epoch: 2 | loss: 0.0739066
	speed: 0.0173s/iter; left time: 702.0077s
Epoch: 2 cost time: 8.13499140739441
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.954069 --> -0.970440).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0840373
	speed: 0.0901s/iter; left time: 3639.4304s
	iters: 200, epoch: 3 | loss: 0.0035392
	speed: 0.0173s/iter; left time: 698.6012s
	iters: 300, epoch: 3 | loss: 0.1023554
	speed: 0.0179s/iter; left time: 720.0539s
	iters: 400, epoch: 3 | loss: 0.1187993
	speed: 0.0155s/iter; left time: 621.7246s
Epoch: 3 cost time: 7.67882513999939
Epoch: 3, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0004278
	speed: 0.0815s/iter; left time: 3255.0482s
	iters: 200, epoch: 4 | loss: 0.0858755
	speed: 0.0169s/iter; left time: 675.0262s
	iters: 300, epoch: 4 | loss: 0.0034938
	speed: 0.0144s/iter; left time: 573.6688s
	iters: 400, epoch: 4 | loss: 0.2569257
	speed: 0.0157s/iter; left time: 623.2809s
Epoch: 4 cost time: 7.0894622802734375
Epoch: 4, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.970440 --> -0.974078).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0000347
	speed: 0.0753s/iter; left time: 2977.1618s
	iters: 200, epoch: 5 | loss: 0.0043919
	speed: 0.0185s/iter; left time: 729.1078s
	iters: 300, epoch: 5 | loss: 0.2477642
	speed: 0.0155s/iter; left time: 609.7906s
	iters: 400, epoch: 5 | loss: 0.0046711
	speed: 0.0167s/iter; left time: 657.3107s
Epoch: 5 cost time: 7.425410985946655
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0043777
	speed: 0.1000s/iter; left time: 3913.9855s
	iters: 200, epoch: 6 | loss: 0.0730138
	speed: 0.0168s/iter; left time: 654.4464s
	iters: 300, epoch: 6 | loss: 0.0494219
	speed: 0.0168s/iter; left time: 655.4874s
	iters: 400, epoch: 6 | loss: 0.0020226
	speed: 0.0173s/iter; left time: 671.8519s
Epoch: 6 cost time: 7.911231279373169
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.069 Vali Acc: 0.980 Test Loss: 0.069 Test Acc: 0.980
Validation loss decreased (-0.974078 --> -0.980445).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0242412
	speed: 0.0964s/iter; left time: 3732.1633s
	iters: 200, epoch: 7 | loss: 0.0063563
	speed: 0.0189s/iter; left time: 728.8293s
	iters: 300, epoch: 7 | loss: 0.0000282
	speed: 0.0180s/iter; left time: 695.1566s
	iters: 400, epoch: 7 | loss: 0.0022674
	speed: 0.0183s/iter; left time: 701.3295s
Epoch: 7 cost time: 8.3138906955719
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0000134
	speed: 0.0975s/iter; left time: 3733.4682s
	iters: 200, epoch: 8 | loss: 0.0009764
	speed: 0.0165s/iter; left time: 630.5391s
	iters: 300, epoch: 8 | loss: 0.0017523
	speed: 0.0173s/iter; left time: 659.7033s
	iters: 400, epoch: 8 | loss: 0.0056540
	speed: 0.0204s/iter; left time: 775.0619s
Epoch: 8 cost time: 7.98001503944397
Epoch: 8, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.119 Vali Acc: 0.964 Test Loss: 0.119 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0002037
	speed: 0.0974s/iter; left time: 3689.3122s
	iters: 200, epoch: 9 | loss: 0.0773388
	speed: 0.0183s/iter; left time: 692.6085s
	iters: 300, epoch: 9 | loss: 0.0013373
	speed: 0.0186s/iter; left time: 699.9758s
	iters: 400, epoch: 9 | loss: 0.0008210
	speed: 0.0185s/iter; left time: 694.4263s
Epoch: 9 cost time: 8.111998558044434
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.093 Vali Acc: 0.973 Test Loss: 0.093 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0209087
	speed: 0.0924s/iter; left time: 3464.4092s
	iters: 200, epoch: 10 | loss: 0.0420434
	speed: 0.0156s/iter; left time: 584.1652s
	iters: 300, epoch: 10 | loss: 0.0001376
	speed: 0.0196s/iter; left time: 731.8681s
	iters: 400, epoch: 10 | loss: 0.1372734
	speed: 0.0179s/iter; left time: 666.6865s
Epoch: 10 cost time: 7.9352638721466064
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.968 Test Loss: 0.121 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0000599
	speed: 0.0880s/iter; left time: 3262.0083s
	iters: 200, epoch: 11 | loss: 0.3663926
	speed: 0.0181s/iter; left time: 670.4977s
	iters: 300, epoch: 11 | loss: 0.0677280
	speed: 0.0182s/iter; left time: 670.1868s
	iters: 400, epoch: 11 | loss: 0.0004967
	speed: 0.0183s/iter; left time: 674.1144s
Epoch: 11 cost time: 7.840927362442017
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0000306
	speed: 0.0846s/iter; left time: 3102.2718s
	iters: 200, epoch: 12 | loss: 0.0000005
	speed: 0.0178s/iter; left time: 652.0884s
	iters: 300, epoch: 12 | loss: 0.0000110
	speed: 0.0177s/iter; left time: 644.9327s
	iters: 400, epoch: 12 | loss: 0.0002388
	speed: 0.0170s/iter; left time: 616.4764s
Epoch: 12 cost time: 7.9176061153411865
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.1870020
	speed: 0.0800s/iter; left time: 2900.6871s
	iters: 200, epoch: 13 | loss: 0.0924463
	speed: 0.0178s/iter; left time: 644.5788s
	iters: 300, epoch: 13 | loss: 0.0011065
	speed: 0.0175s/iter; left time: 631.2206s
	iters: 400, epoch: 13 | loss: 0.0000112
	speed: 0.0172s/iter; left time: 619.8414s
Epoch: 13 cost time: 7.9793360233306885
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0002005
	speed: 0.0849s/iter; left time: 3043.4926s
	iters: 200, epoch: 14 | loss: 0.0002817
	speed: 0.0203s/iter; left time: 726.2919s
	iters: 300, epoch: 14 | loss: 0.0000074
	speed: 0.0185s/iter; left time: 659.3477s
	iters: 400, epoch: 14 | loss: 0.0000004
	speed: 0.0197s/iter; left time: 700.9879s
Epoch: 14 cost time: 8.557063102722168
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000503
	speed: 0.0977s/iter; left time: 3460.6585s
	iters: 200, epoch: 15 | loss: 0.0000149
	speed: 0.0212s/iter; left time: 748.1401s
	iters: 300, epoch: 15 | loss: 0.0011251
	speed: 0.0191s/iter; left time: 673.5361s
	iters: 400, epoch: 15 | loss: 0.0000011
	speed: 0.0170s/iter; left time: 595.5553s
Epoch: 15 cost time: 8.575812816619873
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000219
	speed: 0.0870s/iter; left time: 3045.7909s
	iters: 200, epoch: 16 | loss: 0.0000002
	speed: 0.0185s/iter; left time: 644.8449s
	iters: 300, epoch: 16 | loss: 0.0003756
	speed: 0.0155s/iter; left time: 538.7050s
	iters: 400, epoch: 16 | loss: 0.0142320
	speed: 0.0169s/iter; left time: 587.4797s
Epoch: 16 cost time: 7.684316396713257
Epoch: 16, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9804456571168713
model parameter : 130742
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7036808
	speed: 0.0349s/iter; left time: 1437.7524s
	iters: 200, epoch: 1 | loss: 0.6760337
	speed: 0.0203s/iter; left time: 833.1426s
	iters: 300, epoch: 1 | loss: 0.2602070
	speed: 0.0205s/iter; left time: 839.4666s
	iters: 400, epoch: 1 | loss: 0.3258900
	speed: 0.0226s/iter; left time: 924.6028s
Epoch: 1 cost time: 10.141433000564575
Epoch: 1, Steps: 413 | Train Loss: 0.670 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0374542
	speed: 0.0982s/iter; left time: 4004.6904s
	iters: 200, epoch: 2 | loss: 0.0005603
	speed: 0.0210s/iter; left time: 853.3689s
	iters: 300, epoch: 2 | loss: 0.0291678
	speed: 0.0177s/iter; left time: 720.4202s
	iters: 400, epoch: 2 | loss: 0.1907093
	speed: 0.0181s/iter; left time: 733.9178s
Epoch: 2 cost time: 8.409152269363403
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
Validation loss decreased (-0.945883 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0285137
	speed: 0.0816s/iter; left time: 3293.4099s
	iters: 200, epoch: 3 | loss: 0.2717087
	speed: 0.0187s/iter; left time: 754.9948s
	iters: 300, epoch: 3 | loss: 0.0158330
	speed: 0.0177s/iter; left time: 712.4974s
	iters: 400, epoch: 3 | loss: 0.1614227
	speed: 0.0163s/iter; left time: 655.1478s
Epoch: 3 cost time: 7.833984375
Epoch: 3, Steps: 413 | Train Loss: 0.093 Vali Loss: 0.119 Vali Acc: 0.966 Test Loss: 0.119 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0017464
	speed: 0.0785s/iter; left time: 3137.8736s
	iters: 200, epoch: 4 | loss: 0.0801991
	speed: 0.0189s/iter; left time: 753.1542s
	iters: 300, epoch: 4 | loss: 0.0506559
	speed: 0.0187s/iter; left time: 743.0299s
	iters: 400, epoch: 4 | loss: 0.0015028
	speed: 0.0175s/iter; left time: 693.0675s
Epoch: 4 cost time: 8.074198246002197
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0018091
	speed: 0.0797s/iter; left time: 3153.0118s
	iters: 200, epoch: 5 | loss: 0.0057109
	speed: 0.0197s/iter; left time: 776.3999s
	iters: 300, epoch: 5 | loss: 0.0766623
	speed: 0.0182s/iter; left time: 717.9191s
	iters: 400, epoch: 5 | loss: 0.0008084
	speed: 0.0176s/iter; left time: 692.2307s
Epoch: 5 cost time: 8.07359504699707
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0563303
	speed: 0.0898s/iter; left time: 3513.3724s
	iters: 200, epoch: 6 | loss: 0.0010619
	speed: 0.0176s/iter; left time: 688.3918s
	iters: 300, epoch: 6 | loss: 0.0052732
	speed: 0.0191s/iter; left time: 743.7681s
	iters: 400, epoch: 6 | loss: 0.0972383
	speed: 0.0182s/iter; left time: 707.3846s
Epoch: 6 cost time: 7.972588300704956
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0020617
	speed: 0.0859s/iter; left time: 3327.9310s
	iters: 200, epoch: 7 | loss: 0.0010263
	speed: 0.0182s/iter; left time: 703.5964s
	iters: 300, epoch: 7 | loss: 0.0000771
	speed: 0.0189s/iter; left time: 727.5988s
	iters: 400, epoch: 7 | loss: 0.0004024
	speed: 0.0188s/iter; left time: 721.6628s
Epoch: 7 cost time: 8.115669965744019
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.179 Vali Acc: 0.960 Test Loss: 0.179 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0688767
	speed: 0.0839s/iter; left time: 3212.7623s
	iters: 200, epoch: 8 | loss: 0.0002627
	speed: 0.0188s/iter; left time: 717.7499s
	iters: 300, epoch: 8 | loss: 0.0012476
	speed: 0.0190s/iter; left time: 725.5905s
	iters: 400, epoch: 8 | loss: 0.0028206
	speed: 0.0182s/iter; left time: 691.9453s
Epoch: 8 cost time: 7.88422155380249
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.965 Test Loss: 0.115 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0005704
	speed: 0.0846s/iter; left time: 3206.9951s
	iters: 200, epoch: 9 | loss: 0.0001799
	speed: 0.0200s/iter; left time: 757.6979s
	iters: 300, epoch: 9 | loss: 0.0500362
	speed: 0.0181s/iter; left time: 680.6875s
	iters: 400, epoch: 9 | loss: 0.0001876
	speed: 0.0168s/iter; left time: 630.9884s
Epoch: 9 cost time: 8.012728929519653
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.966802 --> -0.967711).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0071554
	speed: 0.0863s/iter; left time: 3236.6953s
	iters: 200, epoch: 10 | loss: 0.0038089
	speed: 0.0180s/iter; left time: 672.3528s
	iters: 300, epoch: 10 | loss: 0.0004375
	speed: 0.0175s/iter; left time: 650.6455s
	iters: 400, epoch: 10 | loss: 0.1290440
	speed: 0.0191s/iter; left time: 708.3938s
Epoch: 10 cost time: 8.065460681915283
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000392
	speed: 0.0855s/iter; left time: 3168.8913s
	iters: 200, epoch: 11 | loss: 0.2052582
	speed: 0.0191s/iter; left time: 705.4424s
	iters: 300, epoch: 11 | loss: 0.0000103
	speed: 0.0177s/iter; left time: 652.0659s
	iters: 400, epoch: 11 | loss: 0.0032732
	speed: 0.0187s/iter; left time: 687.6102s
Epoch: 11 cost time: 8.059066534042358
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.314 Vali Acc: 0.950 Test Loss: 0.314 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0238859
	speed: 0.0830s/iter; left time: 3041.6425s
	iters: 200, epoch: 12 | loss: 0.0017066
	speed: 0.0194s/iter; left time: 708.2427s
	iters: 300, epoch: 12 | loss: 0.0000031
	speed: 0.0208s/iter; left time: 758.7717s
	iters: 400, epoch: 12 | loss: 0.1403269
	speed: 0.0184s/iter; left time: 668.6397s
Epoch: 12 cost time: 8.511474609375
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969985).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0018127
	speed: 0.0872s/iter; left time: 3160.8063s
	iters: 200, epoch: 13 | loss: 0.0029905
	speed: 0.0205s/iter; left time: 740.8754s
	iters: 300, epoch: 13 | loss: 0.0025528
	speed: 0.0190s/iter; left time: 685.5558s
	iters: 400, epoch: 13 | loss: 0.0471596
	speed: 0.0184s/iter; left time: 662.3915s
Epoch: 13 cost time: 8.693302631378174
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0204891
	speed: 0.0887s/iter; left time: 3178.4656s
	iters: 200, epoch: 14 | loss: 0.0000211
	speed: 0.0201s/iter; left time: 716.9666s
	iters: 300, epoch: 14 | loss: 0.0001075
	speed: 0.0180s/iter; left time: 640.5433s
	iters: 400, epoch: 14 | loss: 0.0000146
	speed: 0.0183s/iter; left time: 649.3511s
Epoch: 14 cost time: 8.108019351959229
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0008619
	speed: 0.0887s/iter; left time: 3140.4416s
	iters: 200, epoch: 15 | loss: 0.7802473
	speed: 0.0186s/iter; left time: 655.8831s
	iters: 300, epoch: 15 | loss: 0.0000001
	speed: 0.0177s/iter; left time: 624.3968s
	iters: 400, epoch: 15 | loss: 0.0967104
	speed: 0.0192s/iter; left time: 673.3218s
Epoch: 15 cost time: 8.470762729644775
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.961 Test Loss: 0.251 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0010243
	speed: 0.1019s/iter; left time: 3565.4031s
	iters: 200, epoch: 16 | loss: 0.0000413
	speed: 0.0211s/iter; left time: 735.8435s
	iters: 300, epoch: 16 | loss: 0.0000015
	speed: 0.0200s/iter; left time: 694.8415s
	iters: 400, epoch: 16 | loss: 0.1092048
	speed: 0.0173s/iter; left time: 600.1028s
Epoch: 16 cost time: 8.738457202911377
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.310 Vali Acc: 0.951 Test Loss: 0.310 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0018580
	speed: 0.0925s/iter; left time: 3199.5407s
	iters: 200, epoch: 17 | loss: 0.0000019
	speed: 0.0151s/iter; left time: 519.3820s
	iters: 300, epoch: 17 | loss: 0.0027806
	speed: 0.0147s/iter; left time: 505.8243s
	iters: 400, epoch: 17 | loss: 0.0000023
	speed: 0.0166s/iter; left time: 568.6949s
Epoch: 17 cost time: 7.1942524909973145
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0066630
	speed: 0.0828s/iter; left time: 2829.3832s
	iters: 200, epoch: 18 | loss: 0.0000585
	speed: 0.0138s/iter; left time: 471.2312s
	iters: 300, epoch: 18 | loss: 0.0072072
	speed: 0.0154s/iter; left time: 523.2179s
	iters: 400, epoch: 18 | loss: 0.0000029
	speed: 0.0167s/iter; left time: 564.8476s
Epoch: 18 cost time: 6.942641496658325
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.240 Vali Acc: 0.965 Test Loss: 0.240 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000060
	speed: 0.0834s/iter; left time: 2815.1486s
	iters: 200, epoch: 19 | loss: 0.0001382
	speed: 0.0177s/iter; left time: 595.0899s
	iters: 300, epoch: 19 | loss: 0.0000812
	speed: 0.0196s/iter; left time: 657.2422s
	iters: 400, epoch: 19 | loss: 0.0080138
	speed: 0.0190s/iter; left time: 635.8493s
Epoch: 19 cost time: 7.846111536026001
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0002486
	speed: 0.0825s/iter; left time: 2750.6512s
	iters: 200, epoch: 20 | loss: 0.2343745
	speed: 0.0171s/iter; left time: 568.3379s
	iters: 300, epoch: 20 | loss: 0.0258752
	speed: 0.0201s/iter; left time: 666.4200s
	iters: 400, epoch: 20 | loss: 0.0589620
	speed: 0.0194s/iter; left time: 640.1022s
Epoch: 20 cost time: 8.142277479171753
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.965 Test Loss: 0.177 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.1414854
	speed: 0.0842s/iter; left time: 2774.4599s
	iters: 200, epoch: 21 | loss: 0.0000050
	speed: 0.0185s/iter; left time: 608.9668s
	iters: 300, epoch: 21 | loss: 0.0472442
	speed: 0.0207s/iter; left time: 678.8723s
	iters: 400, epoch: 21 | loss: 0.0013273
	speed: 0.0199s/iter; left time: 650.8986s
Epoch: 21 cost time: 8.362438440322876
Epoch: 21, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.955 Test Loss: 0.229 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0000339
	speed: 0.0916s/iter; left time: 2978.6460s
	iters: 200, epoch: 22 | loss: 0.0000037
	speed: 0.0208s/iter; left time: 675.2674s
	iters: 300, epoch: 22 | loss: 0.0000380
	speed: 0.0204s/iter; left time: 660.4641s
	iters: 400, epoch: 22 | loss: 0.0000000
	speed: 0.0212s/iter; left time: 681.8639s
Epoch: 22 cost time: 8.712708711624146
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9699863574351978
model parameter : 130446
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2156975
	speed: 0.0353s/iter; left time: 1453.5196s
	iters: 200, epoch: 1 | loss: 0.5444115
	speed: 0.0182s/iter; left time: 747.3608s
	iters: 300, epoch: 1 | loss: 0.0246893
	speed: 0.0177s/iter; left time: 727.2065s
	iters: 400, epoch: 1 | loss: 0.4048516
	speed: 0.0153s/iter; left time: 624.5042s
Epoch: 1 cost time: 8.956485509872437
Epoch: 1, Steps: 413 | Train Loss: 0.675 Vali Loss: 0.168 Vali Acc: 0.950 Test Loss: 0.168 Test Acc: 0.950
Validation loss decreased (inf --> -0.950430).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3200582
	speed: 0.0827s/iter; left time: 3374.4579s
	iters: 200, epoch: 2 | loss: 0.1429818
	speed: 0.0151s/iter; left time: 616.3647s
	iters: 300, epoch: 2 | loss: 0.1160615
	speed: 0.0155s/iter; left time: 631.0011s
	iters: 400, epoch: 2 | loss: 0.0187031
	speed: 0.0148s/iter; left time: 600.8775s
Epoch: 2 cost time: 6.940126180648804
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.110 Vali Acc: 0.961 Test Loss: 0.110 Test Acc: 0.961
Validation loss decreased (-0.950430 --> -0.960890).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0783301
	speed: 0.0937s/iter; left time: 3782.0574s
	iters: 200, epoch: 3 | loss: 0.0577120
	speed: 0.0160s/iter; left time: 643.3187s
	iters: 300, epoch: 3 | loss: 0.0050603
	speed: 0.0189s/iter; left time: 760.7783s
	iters: 400, epoch: 3 | loss: 0.0969477
	speed: 0.0194s/iter; left time: 776.0455s
Epoch: 3 cost time: 8.380245685577393
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.085 Vali Acc: 0.971 Test Loss: 0.085 Test Acc: 0.971
Validation loss decreased (-0.960890 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0628232
	speed: 0.0930s/iter; left time: 3716.5313s
	iters: 200, epoch: 4 | loss: 0.0973270
	speed: 0.0186s/iter; left time: 743.2245s
	iters: 300, epoch: 4 | loss: 0.2029329
	speed: 0.0198s/iter; left time: 786.4715s
	iters: 400, epoch: 4 | loss: 0.0037277
	speed: 0.0219s/iter; left time: 867.9800s
Epoch: 4 cost time: 8.764809846878052
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.073 Vali Acc: 0.979 Test Loss: 0.073 Test Acc: 0.979
Validation loss decreased (-0.971350 --> -0.979081).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0013352
	speed: 0.1004s/iter; left time: 3969.7213s
	iters: 200, epoch: 5 | loss: 0.0006233
	speed: 0.0193s/iter; left time: 762.3803s
	iters: 300, epoch: 5 | loss: 0.0070573
	speed: 0.0185s/iter; left time: 727.1243s
	iters: 400, epoch: 5 | loss: 0.0977507
	speed: 0.0197s/iter; left time: 772.3521s
Epoch: 5 cost time: 8.465903282165527
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.060 Vali Acc: 0.980 Test Loss: 0.060 Test Acc: 0.980
Validation loss decreased (-0.979081 --> -0.979990).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0019821
	speed: 0.0936s/iter; left time: 3663.1284s
	iters: 200, epoch: 6 | loss: 0.0025624
	speed: 0.0168s/iter; left time: 654.0206s
	iters: 300, epoch: 6 | loss: 0.0036822
	speed: 0.0202s/iter; left time: 785.7050s
	iters: 400, epoch: 6 | loss: 0.0010622
	speed: 0.0181s/iter; left time: 704.1704s
Epoch: 6 cost time: 8.160337448120117
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.971 Test Loss: 0.084 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0557128
	speed: 0.0848s/iter; left time: 3281.9655s
	iters: 200, epoch: 7 | loss: 0.0001683
	speed: 0.0193s/iter; left time: 746.1357s
	iters: 300, epoch: 7 | loss: 0.3411769
	speed: 0.0184s/iter; left time: 707.4900s
	iters: 400, epoch: 7 | loss: 0.0502032
	speed: 0.0189s/iter; left time: 724.4786s
Epoch: 7 cost time: 8.350329160690308
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.065 Vali Acc: 0.982 Test Loss: 0.065 Test Acc: 0.982
Validation loss decreased (-0.979990 --> -0.982264).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0003977
	speed: 0.0850s/iter; left time: 3255.0039s
	iters: 200, epoch: 8 | loss: 0.0024825
	speed: 0.0182s/iter; left time: 693.9148s
	iters: 300, epoch: 8 | loss: 0.0005620
	speed: 0.0184s/iter; left time: 701.6977s
	iters: 400, epoch: 8 | loss: 0.0001531
	speed: 0.0153s/iter; left time: 582.1057s
Epoch: 8 cost time: 7.584641695022583
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0029700
	speed: 0.0817s/iter; left time: 3095.3804s
	iters: 200, epoch: 9 | loss: 0.0015580
	speed: 0.0172s/iter; left time: 649.2145s
	iters: 300, epoch: 9 | loss: 0.0090518
	speed: 0.0174s/iter; left time: 656.0491s
	iters: 400, epoch: 9 | loss: 0.0105864
	speed: 0.0171s/iter; left time: 644.1795s
Epoch: 9 cost time: 7.527958869934082
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.073 Vali Acc: 0.976 Test Loss: 0.073 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0114231
	speed: 0.0849s/iter; left time: 3180.8981s
	iters: 200, epoch: 10 | loss: 0.0138068
	speed: 0.0191s/iter; left time: 715.7637s
	iters: 300, epoch: 10 | loss: 0.0006030
	speed: 0.0197s/iter; left time: 734.1600s
	iters: 400, epoch: 10 | loss: 0.0000878
	speed: 0.0177s/iter; left time: 657.9207s
Epoch: 10 cost time: 8.4458909034729
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0007245
	speed: 0.0856s/iter; left time: 3173.2155s
	iters: 200, epoch: 11 | loss: 0.0044658
	speed: 0.0180s/iter; left time: 665.4246s
	iters: 300, epoch: 11 | loss: 0.0011825
	speed: 0.0185s/iter; left time: 683.0899s
	iters: 400, epoch: 11 | loss: 0.0035538
	speed: 0.0197s/iter; left time: 724.3830s
Epoch: 11 cost time: 8.199231386184692
Epoch: 11, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0015857
	speed: 0.0958s/iter; left time: 3510.4603s
	iters: 200, epoch: 12 | loss: 0.0000943
	speed: 0.0200s/iter; left time: 732.8692s
	iters: 300, epoch: 12 | loss: 0.0000714
	speed: 0.0188s/iter; left time: 685.6214s
	iters: 400, epoch: 12 | loss: 0.0001856
	speed: 0.0184s/iter; left time: 669.4964s
Epoch: 12 cost time: 8.624844551086426
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0004637
	speed: 0.0918s/iter; left time: 3328.6012s
	iters: 200, epoch: 13 | loss: 0.0003713
	speed: 0.0165s/iter; left time: 597.6921s
	iters: 300, epoch: 13 | loss: 0.0012417
	speed: 0.0185s/iter; left time: 666.0020s
	iters: 400, epoch: 13 | loss: 0.0016292
	speed: 0.0188s/iter; left time: 676.5931s
Epoch: 13 cost time: 8.230321645736694
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0018019
	speed: 0.0884s/iter; left time: 3168.1882s
	iters: 200, epoch: 14 | loss: 0.0000187
	speed: 0.0174s/iter; left time: 623.1323s
	iters: 300, epoch: 14 | loss: 0.0001058
	speed: 0.0187s/iter; left time: 666.5238s
	iters: 400, epoch: 14 | loss: 0.0000228
	speed: 0.0178s/iter; left time: 632.7824s
Epoch: 14 cost time: 7.800617694854736
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000102
	speed: 0.0865s/iter; left time: 3062.3693s
	iters: 200, epoch: 15 | loss: 0.0015212
	speed: 0.0169s/iter; left time: 598.0655s
	iters: 300, epoch: 15 | loss: 0.0003974
	speed: 0.0163s/iter; left time: 574.0816s
	iters: 400, epoch: 15 | loss: 0.0048842
	speed: 0.0175s/iter; left time: 614.0292s
Epoch: 15 cost time: 7.436397552490234
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0001165
	speed: 0.0855s/iter; left time: 2991.6291s
	iters: 200, epoch: 16 | loss: 0.0000095
	speed: 0.0159s/iter; left time: 556.4643s
	iters: 300, epoch: 16 | loss: 0.0015408
	speed: 0.0176s/iter; left time: 613.3796s
	iters: 400, epoch: 16 | loss: 0.0002717
	speed: 0.0163s/iter; left time: 567.3206s
Epoch: 16 cost time: 7.2562408447265625
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0000003
	speed: 0.0814s/iter; left time: 2814.1823s
	iters: 200, epoch: 17 | loss: 0.0000459
	speed: 0.0186s/iter; left time: 643.1472s
	iters: 300, epoch: 17 | loss: 0.0038955
	speed: 0.0173s/iter; left time: 596.1225s
	iters: 400, epoch: 17 | loss: 0.0042760
	speed: 0.0178s/iter; left time: 611.1729s
Epoch: 17 cost time: 7.750786304473877
Epoch: 17, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9822646657571623
model parameter : 129782
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0749682
	speed: 0.0411s/iter; left time: 1693.8522s
	iters: 200, epoch: 1 | loss: 0.1208795
	speed: 0.0177s/iter; left time: 728.4459s
	iters: 300, epoch: 1 | loss: 0.2812834
	speed: 0.0175s/iter; left time: 717.0433s
	iters: 400, epoch: 1 | loss: 0.1118810
	speed: 0.0192s/iter; left time: 784.9620s
Epoch: 1 cost time: 9.799669027328491
Epoch: 1, Steps: 413 | Train Loss: 0.693 Vali Loss: 0.163 Vali Acc: 0.945 Test Loss: 0.163 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0827059
	speed: 0.0851s/iter; left time: 3471.2704s
	iters: 200, epoch: 2 | loss: 0.2562004
	speed: 0.0161s/iter; left time: 656.9148s
	iters: 300, epoch: 2 | loss: 0.1269626
	speed: 0.0166s/iter; left time: 674.2340s
	iters: 400, epoch: 2 | loss: 0.0342451
	speed: 0.0175s/iter; left time: 709.1844s
Epoch: 2 cost time: 7.716896295547485
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.124 Vali Acc: 0.957 Test Loss: 0.124 Test Acc: 0.957
Validation loss decreased (-0.944973 --> -0.957252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3465532
	speed: 0.0885s/iter; left time: 3573.5130s
	iters: 200, epoch: 3 | loss: 0.0080307
	speed: 0.0170s/iter; left time: 685.7061s
	iters: 300, epoch: 3 | loss: 0.0501409
	speed: 0.0169s/iter; left time: 680.5323s
	iters: 400, epoch: 3 | loss: 0.0013398
	speed: 0.0204s/iter; left time: 818.0830s
Epoch: 3 cost time: 8.200477361679077
Epoch: 3, Steps: 413 | Train Loss: 0.094 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
Validation loss decreased (-0.957252 --> -0.958616).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0203976
	speed: 0.0885s/iter; left time: 3535.7371s
	iters: 200, epoch: 4 | loss: 0.0695231
	speed: 0.0175s/iter; left time: 698.9043s
	iters: 300, epoch: 4 | loss: 0.0050715
	speed: 0.0173s/iter; left time: 686.9256s
	iters: 400, epoch: 4 | loss: 0.3157004
	speed: 0.0204s/iter; left time: 807.4326s
Epoch: 4 cost time: 8.058956861495972
Epoch: 4, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0077324
	speed: 0.0828s/iter; left time: 3273.9260s
	iters: 200, epoch: 5 | loss: 0.0058492
	speed: 0.0175s/iter; left time: 691.4303s
	iters: 300, epoch: 5 | loss: 0.0019519
	speed: 0.0173s/iter; left time: 679.6287s
	iters: 400, epoch: 5 | loss: 0.0089993
	speed: 0.0184s/iter; left time: 723.3433s
Epoch: 5 cost time: 7.726323843002319
Epoch: 5, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.140 Vali Acc: 0.963 Test Loss: 0.140 Test Acc: 0.963
Validation loss decreased (-0.958616 --> -0.962709).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0013130
	speed: 0.0908s/iter; left time: 3552.4717s
	iters: 200, epoch: 6 | loss: 0.0093839
	speed: 0.0177s/iter; left time: 692.8334s
	iters: 300, epoch: 6 | loss: 0.0324268
	speed: 0.0175s/iter; left time: 680.4842s
	iters: 400, epoch: 6 | loss: 0.0266239
	speed: 0.0167s/iter; left time: 649.9938s
Epoch: 6 cost time: 7.888402938842773
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.962709 --> -0.969985).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0002957
	speed: 0.0861s/iter; left time: 3335.0500s
	iters: 200, epoch: 7 | loss: 0.0053921
	speed: 0.0163s/iter; left time: 628.2784s
	iters: 300, epoch: 7 | loss: 0.6278760
	speed: 0.0143s/iter; left time: 550.0328s
	iters: 400, epoch: 7 | loss: 0.3082561
	speed: 0.0136s/iter; left time: 523.7633s
Epoch: 7 cost time: 6.685967922210693
Epoch: 7, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0485941
	speed: 0.0737s/iter; left time: 2824.7879s
	iters: 200, epoch: 8 | loss: 0.0035522
	speed: 0.0169s/iter; left time: 644.5737s
	iters: 300, epoch: 8 | loss: 0.0001614
	speed: 0.0176s/iter; left time: 670.3973s
	iters: 400, epoch: 8 | loss: 0.1032397
	speed: 0.0172s/iter; left time: 651.9385s
Epoch: 8 cost time: 7.378292083740234
Epoch: 8, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.961 Test Loss: 0.130 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0131997
	speed: 0.0823s/iter; left time: 3117.1601s
	iters: 200, epoch: 9 | loss: 0.0003273
	speed: 0.0191s/iter; left time: 722.5611s
	iters: 300, epoch: 9 | loss: 0.0404129
	speed: 0.0170s/iter; left time: 639.3936s
	iters: 400, epoch: 9 | loss: 0.0037286
	speed: 0.0178s/iter; left time: 669.3674s
Epoch: 9 cost time: 7.6970226764678955
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0010666
	speed: 0.0901s/iter; left time: 3377.0662s
	iters: 200, epoch: 10 | loss: 0.0031440
	speed: 0.0181s/iter; left time: 677.4537s
	iters: 300, epoch: 10 | loss: 0.0175453
	speed: 0.0200s/iter; left time: 745.1677s
	iters: 400, epoch: 10 | loss: 0.0001510
	speed: 0.0186s/iter; left time: 692.0433s
Epoch: 10 cost time: 8.216390132904053
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
Validation loss decreased (-0.969985 --> -0.973169).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0020839
	speed: 0.0879s/iter; left time: 3258.5171s
	iters: 200, epoch: 11 | loss: 0.0074811
	speed: 0.0214s/iter; left time: 790.1668s
	iters: 300, epoch: 11 | loss: 0.0071456
	speed: 0.0186s/iter; left time: 687.3688s
	iters: 400, epoch: 11 | loss: 0.0276907
	speed: 0.0190s/iter; left time: 699.2928s
Epoch: 11 cost time: 8.589802503585815
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.962 Test Loss: 0.200 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0007400
	speed: 0.0852s/iter; left time: 3123.2392s
	iters: 200, epoch: 12 | loss: 0.2130301
	speed: 0.0196s/iter; left time: 716.3540s
	iters: 300, epoch: 12 | loss: 0.0001715
	speed: 0.0203s/iter; left time: 738.4409s
	iters: 400, epoch: 12 | loss: 0.1530095
	speed: 0.0210s/iter; left time: 762.2997s
Epoch: 12 cost time: 8.746535062789917
Epoch: 12, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0062395
	speed: 0.0856s/iter; left time: 3103.7453s
	iters: 200, epoch: 13 | loss: 0.0000003
	speed: 0.0200s/iter; left time: 723.5289s
	iters: 300, epoch: 13 | loss: 0.0680849
	speed: 0.0195s/iter; left time: 703.6801s
	iters: 400, epoch: 13 | loss: 0.0115527
	speed: 0.0183s/iter; left time: 657.5354s
Epoch: 13 cost time: 8.375242471694946
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0000619
	speed: 0.0811s/iter; left time: 2907.3742s
	iters: 200, epoch: 14 | loss: 0.1854693
	speed: 0.0160s/iter; left time: 570.4439s
	iters: 300, epoch: 14 | loss: 0.0000093
	speed: 0.0159s/iter; left time: 568.0482s
	iters: 400, epoch: 14 | loss: 0.0010102
	speed: 0.0155s/iter; left time: 550.0379s
Epoch: 14 cost time: 7.071915149688721
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.1293821
	speed: 0.0795s/iter; left time: 2815.1681s
	iters: 200, epoch: 15 | loss: 0.0014081
	speed: 0.0162s/iter; left time: 573.1518s
	iters: 300, epoch: 15 | loss: 0.0001140
	speed: 0.0152s/iter; left time: 533.8633s
	iters: 400, epoch: 15 | loss: 0.0322362
	speed: 0.0177s/iter; left time: 621.7365s
Epoch: 15 cost time: 7.2969114780426025
Epoch: 15, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.962 Test Loss: 0.205 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0021037
	speed: 0.0876s/iter; left time: 3068.0743s
	iters: 200, epoch: 16 | loss: 0.0004150
	speed: 0.0168s/iter; left time: 587.6608s
	iters: 300, epoch: 16 | loss: 0.0000234
	speed: 0.0178s/iter; left time: 618.0973s
	iters: 400, epoch: 16 | loss: 0.0000134
	speed: 0.0182s/iter; left time: 631.0580s
Epoch: 16 cost time: 7.95887017250061
Epoch: 16, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0001503
	speed: 0.0870s/iter; left time: 3010.6167s
	iters: 200, epoch: 17 | loss: 0.2492725
	speed: 0.0191s/iter; left time: 659.5627s
	iters: 300, epoch: 17 | loss: 0.0001088
	speed: 0.0203s/iter; left time: 698.5277s
	iters: 400, epoch: 17 | loss: 0.0793899
	speed: 0.0214s/iter; left time: 732.2525s
Epoch: 17 cost time: 8.804996252059937
Epoch: 17, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0006391
	speed: 0.0898s/iter; left time: 3067.8192s
	iters: 200, epoch: 18 | loss: 0.0000055
	speed: 0.0182s/iter; left time: 618.9052s
	iters: 300, epoch: 18 | loss: 0.0016596
	speed: 0.0196s/iter; left time: 664.4339s
	iters: 400, epoch: 18 | loss: 0.0022787
	speed: 0.0205s/iter; left time: 693.9951s
Epoch: 18 cost time: 8.491121053695679
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.961 Test Loss: 0.216 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0005943
	speed: 0.0906s/iter; left time: 3060.7176s
	iters: 200, epoch: 19 | loss: 0.0009664
	speed: 0.0188s/iter; left time: 634.2175s
	iters: 300, epoch: 19 | loss: 0.0000107
	speed: 0.0195s/iter; left time: 656.1179s
	iters: 400, epoch: 19 | loss: 0.0000343
	speed: 0.0199s/iter; left time: 665.5142s
Epoch: 19 cost time: 8.613564252853394
Epoch: 19, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0001693
	speed: 0.0972s/iter; left time: 3241.7799s
	iters: 200, epoch: 20 | loss: 0.0000880
	speed: 0.0185s/iter; left time: 614.6265s
	iters: 300, epoch: 20 | loss: 0.1485371
	speed: 0.0164s/iter; left time: 542.8400s
	iters: 400, epoch: 20 | loss: 0.0000212
	speed: 0.0205s/iter; left time: 676.8948s
Epoch: 20 cost time: 8.20643663406372
Epoch: 20, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.285 Vali Acc: 0.960 Test Loss: 0.285 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 129843
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1403050
	speed: 0.0362s/iter; left time: 1492.7766s
	iters: 200, epoch: 1 | loss: 0.4742972
	speed: 0.0209s/iter; left time: 857.8981s
	iters: 300, epoch: 1 | loss: 0.2209454
	speed: 0.0177s/iter; left time: 725.7291s
	iters: 400, epoch: 1 | loss: 0.0758305
	speed: 0.0162s/iter; left time: 662.7417s
Epoch: 1 cost time: 9.404839754104614
Epoch: 1, Steps: 413 | Train Loss: 0.729 Vali Loss: 0.173 Vali Acc: 0.950 Test Loss: 0.173 Test Acc: 0.950
Validation loss decreased (inf --> -0.949521).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0672678
	speed: 0.0856s/iter; left time: 3489.6426s
	iters: 200, epoch: 2 | loss: 0.0124638
	speed: 0.0149s/iter; left time: 605.8412s
	iters: 300, epoch: 2 | loss: 0.1274561
	speed: 0.0153s/iter; left time: 622.0351s
	iters: 400, epoch: 2 | loss: 0.0102754
	speed: 0.0174s/iter; left time: 706.2302s
Epoch: 2 cost time: 7.171906232833862
Epoch: 2, Steps: 413 | Train Loss: 0.134 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
Validation loss decreased (-0.949521 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0155553
	speed: 0.0932s/iter; left time: 3764.7902s
	iters: 200, epoch: 3 | loss: 0.0006002
	speed: 0.0194s/iter; left time: 779.6010s
	iters: 300, epoch: 3 | loss: 0.1470928
	speed: 0.0177s/iter; left time: 712.7513s
	iters: 400, epoch: 3 | loss: 0.0042852
	speed: 0.0196s/iter; left time: 785.3334s
Epoch: 3 cost time: 8.644273519515991
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.121 Vali Acc: 0.957 Test Loss: 0.121 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0032927
	speed: 0.0884s/iter; left time: 3530.9643s
	iters: 200, epoch: 4 | loss: 0.1162895
	speed: 0.0195s/iter; left time: 775.7033s
	iters: 300, epoch: 4 | loss: 0.0291849
	speed: 0.0176s/iter; left time: 699.9438s
	iters: 400, epoch: 4 | loss: 0.0041823
	speed: 0.0179s/iter; left time: 708.6587s
Epoch: 4 cost time: 8.032506227493286
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.964 Test Loss: 0.101 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0170917
	speed: 0.0839s/iter; left time: 3319.9582s
	iters: 200, epoch: 5 | loss: 0.0014138
	speed: 0.0165s/iter; left time: 652.6010s
	iters: 300, epoch: 5 | loss: 0.1651468
	speed: 0.0170s/iter; left time: 670.7948s
	iters: 400, epoch: 5 | loss: 0.0055545
	speed: 0.0177s/iter; left time: 693.8105s
Epoch: 5 cost time: 7.862416982650757
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.968 Test Loss: 0.107 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0091837
	speed: 0.0870s/iter; left time: 3405.6537s
	iters: 200, epoch: 6 | loss: 0.0098773
	speed: 0.0176s/iter; left time: 686.7761s
	iters: 300, epoch: 6 | loss: 0.0009271
	speed: 0.0194s/iter; left time: 755.0067s
	iters: 400, epoch: 6 | loss: 0.0071787
	speed: 0.0201s/iter; left time: 779.3023s
Epoch: 6 cost time: 8.164726734161377
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.968621 --> -0.973623).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.2363872
	speed: 0.0883s/iter; left time: 3419.5158s
	iters: 200, epoch: 7 | loss: 0.0046039
	speed: 0.0192s/iter; left time: 740.6286s
	iters: 300, epoch: 7 | loss: 0.0874407
	speed: 0.0187s/iter; left time: 719.8980s
	iters: 400, epoch: 7 | loss: 0.0005882
	speed: 0.0194s/iter; left time: 746.1749s
Epoch: 7 cost time: 8.547993659973145
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0004894
	speed: 0.0941s/iter; left time: 3606.6881s
	iters: 200, epoch: 8 | loss: 0.0059064
	speed: 0.0175s/iter; left time: 669.2868s
	iters: 300, epoch: 8 | loss: 0.0022913
	speed: 0.0176s/iter; left time: 670.2506s
	iters: 400, epoch: 8 | loss: 0.0576948
	speed: 0.0181s/iter; left time: 686.5312s
Epoch: 8 cost time: 8.040384769439697
Epoch: 8, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.1303699
	speed: 0.0882s/iter; left time: 3343.2593s
	iters: 200, epoch: 9 | loss: 0.0009635
	speed: 0.0189s/iter; left time: 714.7010s
	iters: 300, epoch: 9 | loss: 0.0040077
	speed: 0.0180s/iter; left time: 679.1096s
	iters: 400, epoch: 9 | loss: 0.0000424
	speed: 0.0180s/iter; left time: 675.3545s
Epoch: 9 cost time: 8.150761842727661
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.1025546
	speed: 0.0881s/iter; left time: 3301.8774s
	iters: 200, epoch: 10 | loss: 0.0006551
	speed: 0.0162s/iter; left time: 607.4716s
	iters: 300, epoch: 10 | loss: 0.0004368
	speed: 0.0178s/iter; left time: 664.2405s
	iters: 400, epoch: 10 | loss: 0.0002428
	speed: 0.0177s/iter; left time: 656.5553s
Epoch: 10 cost time: 7.63361930847168
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.1347723
	speed: 0.0845s/iter; left time: 3133.9089s
	iters: 200, epoch: 11 | loss: 0.0100233
	speed: 0.0171s/iter; left time: 630.6604s
	iters: 300, epoch: 11 | loss: 0.0076311
	speed: 0.0190s/iter; left time: 702.0263s
	iters: 400, epoch: 11 | loss: 0.0757477
	speed: 0.0209s/iter; left time: 767.3848s
Epoch: 11 cost time: 8.356086730957031
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0156301
	speed: 0.0873s/iter; left time: 3201.8780s
	iters: 200, epoch: 12 | loss: 0.0000580
	speed: 0.0201s/iter; left time: 734.9128s
	iters: 300, epoch: 12 | loss: 0.0003085
	speed: 0.0182s/iter; left time: 664.4712s
	iters: 400, epoch: 12 | loss: 0.1972196
	speed: 0.0182s/iter; left time: 662.6073s
Epoch: 12 cost time: 8.30324387550354
Epoch: 12, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.974988).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0016369
	speed: 0.0910s/iter; left time: 3299.7699s
	iters: 200, epoch: 13 | loss: 0.0000245
	speed: 0.0178s/iter; left time: 641.8026s
	iters: 300, epoch: 13 | loss: 0.0001445
	speed: 0.0187s/iter; left time: 673.6070s
	iters: 400, epoch: 13 | loss: 0.0000999
	speed: 0.0168s/iter; left time: 605.3872s
Epoch: 13 cost time: 7.824631214141846
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0001118
	speed: 0.0795s/iter; left time: 2850.3913s
	iters: 200, epoch: 14 | loss: 0.0000286
	speed: 0.0173s/iter; left time: 619.8750s
	iters: 300, epoch: 14 | loss: 0.0002199
	speed: 0.0173s/iter; left time: 616.1005s
	iters: 400, epoch: 14 | loss: 0.0003835
	speed: 0.0184s/iter; left time: 653.4430s
Epoch: 14 cost time: 7.972609996795654
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0000094
	speed: 0.0859s/iter; left time: 3043.5371s
	iters: 200, epoch: 15 | loss: 0.3298707
	speed: 0.0188s/iter; left time: 662.7202s
	iters: 300, epoch: 15 | loss: 0.0007844
	speed: 0.0182s/iter; left time: 642.5431s
	iters: 400, epoch: 15 | loss: 0.0950076
	speed: 0.0196s/iter; left time: 688.2128s
Epoch: 15 cost time: 8.289719104766846
Epoch: 15, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000103
	speed: 0.0903s/iter; left time: 3159.4042s
	iters: 200, epoch: 16 | loss: 0.0000008
	speed: 0.0181s/iter; left time: 631.4148s
	iters: 300, epoch: 16 | loss: 0.0000102
	speed: 0.0186s/iter; left time: 648.3653s
	iters: 400, epoch: 16 | loss: 0.0001467
	speed: 0.0196s/iter; left time: 679.8430s
Epoch: 16 cost time: 8.348777055740356
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0005451
	speed: 0.0928s/iter; left time: 3209.5199s
	iters: 200, epoch: 17 | loss: 0.0000312
	speed: 0.0168s/iter; left time: 580.3671s
	iters: 300, epoch: 17 | loss: 0.0837820
	speed: 0.0150s/iter; left time: 516.6686s
	iters: 400, epoch: 17 | loss: 0.0007086
	speed: 0.0167s/iter; left time: 571.1939s
Epoch: 17 cost time: 7.6040427684783936
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.961 Test Loss: 0.220 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0008376
	speed: 0.0803s/iter; left time: 2745.8359s
	iters: 200, epoch: 18 | loss: 0.0000081
	speed: 0.0143s/iter; left time: 488.7863s
	iters: 300, epoch: 18 | loss: 0.0333350
	speed: 0.0147s/iter; left time: 499.4848s
	iters: 400, epoch: 18 | loss: 0.0003007
	speed: 0.0181s/iter; left time: 612.2189s
Epoch: 18 cost time: 6.951599836349487
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.264 Vali Acc: 0.961 Test Loss: 0.264 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0000335
	speed: 0.0813s/iter; left time: 2745.4097s
	iters: 200, epoch: 19 | loss: 0.0009386
	speed: 0.0198s/iter; left time: 667.2410s
	iters: 300, epoch: 19 | loss: 0.0000014
	speed: 0.0182s/iter; left time: 611.0057s
	iters: 400, epoch: 19 | loss: 0.0000710
	speed: 0.0182s/iter; left time: 609.0427s
Epoch: 19 cost time: 8.07877492904663
Epoch: 19, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0001347
	speed: 0.0888s/iter; left time: 2961.1917s
	iters: 200, epoch: 20 | loss: 0.0027996
	speed: 0.0207s/iter; left time: 689.1083s
	iters: 300, epoch: 20 | loss: 0.0000122
	speed: 0.0180s/iter; left time: 596.5020s
	iters: 400, epoch: 20 | loss: 0.0000091
	speed: 0.0189s/iter; left time: 625.3518s
Epoch: 20 cost time: 8.27072787284851
Epoch: 20, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000255
	speed: 0.0938s/iter; left time: 3089.9775s
	iters: 200, epoch: 21 | loss: 0.0000047
	speed: 0.0206s/iter; left time: 676.4024s
	iters: 300, epoch: 21 | loss: 0.0000356
	speed: 0.0194s/iter; left time: 633.9502s
	iters: 400, epoch: 21 | loss: 0.0003401
	speed: 0.0187s/iter; left time: 610.9815s
Epoch: 21 cost time: 8.46122932434082
Epoch: 21, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.961 Test Loss: 0.174 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 22 | loss: 0.0005633
	speed: 0.0913s/iter; left time: 2969.5999s
	iters: 200, epoch: 22 | loss: 0.0013596
	speed: 0.0199s/iter; left time: 644.6527s
	iters: 300, epoch: 22 | loss: 0.1075217
	speed: 0.0172s/iter; left time: 554.7774s
	iters: 400, epoch: 22 | loss: 0.0005576
	speed: 0.0169s/iter; left time: 543.1803s
Epoch: 22 cost time: 7.970415830612183
Epoch: 22, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 129722
model size : 0.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.8910347
	speed: 0.0356s/iter; left time: 1467.7930s
	iters: 200, epoch: 1 | loss: 0.5633349
	speed: 0.0170s/iter; left time: 697.0256s
	iters: 300, epoch: 1 | loss: 0.3264341
	speed: 0.0207s/iter; left time: 849.8855s
	iters: 400, epoch: 1 | loss: 0.0383404
	speed: 0.0170s/iter; left time: 695.3759s
Epoch: 1 cost time: 9.365431785583496
Epoch: 1, Steps: 413 | Train Loss: 0.680 Vali Loss: 0.138 Vali Acc: 0.959 Test Loss: 0.138 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4699869
	speed: 0.0898s/iter; left time: 3664.7692s
	iters: 200, epoch: 2 | loss: 0.3212685
	speed: 0.0173s/iter; left time: 702.8816s
	iters: 300, epoch: 2 | loss: 0.0078751
	speed: 0.0160s/iter; left time: 648.0673s
	iters: 400, epoch: 2 | loss: 0.3199651
	speed: 0.0175s/iter; left time: 709.2762s
Epoch: 2 cost time: 7.7196197509765625
Epoch: 2, Steps: 413 | Train Loss: 0.135 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
Validation loss decreased (-0.959071 --> -0.967711).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0853957
	speed: 0.0833s/iter; left time: 3364.5284s
	iters: 200, epoch: 3 | loss: 0.0155344
	speed: 0.0172s/iter; left time: 691.8437s
	iters: 300, epoch: 3 | loss: 0.0497774
	speed: 0.0147s/iter; left time: 591.4556s
	iters: 400, epoch: 3 | loss: 0.0455021
	speed: 0.0189s/iter; left time: 756.3643s
Epoch: 3 cost time: 7.4995856285095215
Epoch: 3, Steps: 413 | Train Loss: 0.088 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0085086
	speed: 0.0846s/iter; left time: 3381.8070s
	iters: 200, epoch: 4 | loss: 0.0048090
	speed: 0.0198s/iter; left time: 789.4534s
	iters: 300, epoch: 4 | loss: 0.0364873
	speed: 0.0181s/iter; left time: 721.0214s
	iters: 400, epoch: 4 | loss: 0.0333401
	speed: 0.0168s/iter; left time: 667.4323s
Epoch: 4 cost time: 8.280772924423218
Epoch: 4, Steps: 413 | Train Loss: 0.067 Vali Loss: 0.116 Vali Acc: 0.964 Test Loss: 0.116 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0019170
	speed: 0.0870s/iter; left time: 3440.8449s
	iters: 200, epoch: 5 | loss: 0.0005791
	speed: 0.0187s/iter; left time: 735.9172s
	iters: 300, epoch: 5 | loss: 0.1086778
	speed: 0.0203s/iter; left time: 799.2049s
	iters: 400, epoch: 5 | loss: 0.0395094
	speed: 0.0185s/iter; left time: 726.6463s
Epoch: 5 cost time: 8.239778757095337
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.967 Test Loss: 0.101 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0042408
	speed: 0.0916s/iter; left time: 3584.0594s
	iters: 200, epoch: 6 | loss: 0.0274857
	speed: 0.0206s/iter; left time: 802.5205s
	iters: 300, epoch: 6 | loss: 0.0000282
	speed: 0.0215s/iter; left time: 835.8914s
	iters: 400, epoch: 6 | loss: 0.0028153
	speed: 0.0197s/iter; left time: 766.6833s
Epoch: 6 cost time: 8.90249490737915
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.3706536
	speed: 0.0881s/iter; left time: 3410.7015s
	iters: 200, epoch: 7 | loss: 0.0059936
	speed: 0.0181s/iter; left time: 699.9192s
	iters: 300, epoch: 7 | loss: 0.0095320
	speed: 0.0189s/iter; left time: 727.0853s
	iters: 400, epoch: 7 | loss: 0.0204734
	speed: 0.0189s/iter; left time: 727.3254s
Epoch: 7 cost time: 8.187077283859253
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0015318
	speed: 0.0874s/iter; left time: 3347.8423s
	iters: 200, epoch: 8 | loss: 0.1882365
	speed: 0.0185s/iter; left time: 708.6906s
	iters: 300, epoch: 8 | loss: 0.0046356
	speed: 0.0178s/iter; left time: 678.6307s
	iters: 400, epoch: 8 | loss: 0.0105738
	speed: 0.0189s/iter; left time: 720.2528s
Epoch: 8 cost time: 8.038349866867065
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.967711 --> -0.969530).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0025629
	speed: 0.0795s/iter; left time: 3012.1480s
	iters: 200, epoch: 9 | loss: 0.0047567
	speed: 0.0176s/iter; left time: 663.9118s
	iters: 300, epoch: 9 | loss: 0.0010453
	speed: 0.0179s/iter; left time: 674.3790s
	iters: 400, epoch: 9 | loss: 0.0020028
	speed: 0.0164s/iter; left time: 617.6046s
Epoch: 9 cost time: 7.597749710083008
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
Validation loss decreased (-0.969530 --> -0.979081).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0003256
	speed: 0.0772s/iter; left time: 2892.2188s
	iters: 200, epoch: 10 | loss: 0.0152726
	speed: 0.0161s/iter; left time: 600.4277s
	iters: 300, epoch: 10 | loss: 0.0012746
	speed: 0.0176s/iter; left time: 655.7199s
	iters: 400, epoch: 10 | loss: 0.3091480
	speed: 0.0182s/iter; left time: 677.0607s
Epoch: 10 cost time: 7.393845796585083
Epoch: 10, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0000762
	speed: 0.0761s/iter; left time: 2820.6668s
	iters: 200, epoch: 11 | loss: 0.0063716
	speed: 0.0189s/iter; left time: 699.7660s
	iters: 300, epoch: 11 | loss: 0.0056034
	speed: 0.0240s/iter; left time: 884.0352s
	iters: 400, epoch: 11 | loss: 0.0003913
	speed: 0.0215s/iter; left time: 792.2614s
Epoch: 11 cost time: 9.10240626335144
Epoch: 11, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0046598
	speed: 0.0991s/iter; left time: 3631.6445s
	iters: 200, epoch: 12 | loss: 0.0001615
	speed: 0.0204s/iter; left time: 747.2714s
	iters: 300, epoch: 12 | loss: 0.0000253
	speed: 0.0216s/iter; left time: 786.4731s
	iters: 400, epoch: 12 | loss: 0.0191054
	speed: 0.0216s/iter; left time: 784.1629s
Epoch: 12 cost time: 9.295310974121094
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.2565443
	speed: 0.0910s/iter; left time: 3298.7748s
	iters: 200, epoch: 13 | loss: 0.0219837
	speed: 0.0222s/iter; left time: 802.8477s
	iters: 300, epoch: 13 | loss: 0.0006326
	speed: 0.0216s/iter; left time: 776.7885s
	iters: 400, epoch: 13 | loss: 0.0000135
	speed: 0.0217s/iter; left time: 781.3057s
Epoch: 13 cost time: 9.470458269119263
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0000078
	speed: 0.0976s/iter; left time: 3497.9361s
	iters: 200, epoch: 14 | loss: 0.0000970
	speed: 0.0211s/iter; left time: 753.1733s
	iters: 300, epoch: 14 | loss: 0.0003348
	speed: 0.0214s/iter; left time: 764.0437s
	iters: 400, epoch: 14 | loss: 0.0000470
	speed: 0.0196s/iter; left time: 698.1994s
Epoch: 14 cost time: 9.326971530914307
Epoch: 14, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000104
	speed: 0.0921s/iter; left time: 3262.4248s
	iters: 200, epoch: 15 | loss: 0.0006458
	speed: 0.0209s/iter; left time: 739.0179s
	iters: 300, epoch: 15 | loss: 0.0311616
	speed: 0.0197s/iter; left time: 693.4542s
	iters: 400, epoch: 15 | loss: 0.0000098
	speed: 0.0201s/iter; left time: 705.4492s
Epoch: 15 cost time: 8.722041845321655
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0000017
	speed: 0.0901s/iter; left time: 3153.7971s
	iters: 200, epoch: 16 | loss: 0.0001067
	speed: 0.0198s/iter; left time: 690.8710s
	iters: 300, epoch: 16 | loss: 0.0072602
	speed: 0.0198s/iter; left time: 690.2010s
	iters: 400, epoch: 16 | loss: 0.0027873
	speed: 0.0209s/iter; left time: 725.4574s
Epoch: 16 cost time: 8.73783564567566
Epoch: 16, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000327
	speed: 0.0925s/iter; left time: 3199.1177s
	iters: 200, epoch: 17 | loss: 0.0000014
	speed: 0.0205s/iter; left time: 707.0153s
	iters: 300, epoch: 17 | loss: 0.0016746
	speed: 0.0221s/iter; left time: 761.4796s
	iters: 400, epoch: 17 | loss: 0.0000039
	speed: 0.0184s/iter; left time: 632.5842s
Epoch: 17 cost time: 9.055740356445312
Epoch: 17, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0030682
	speed: 0.0834s/iter; left time: 2850.5806s
	iters: 200, epoch: 18 | loss: 0.0015013
	speed: 0.0166s/iter; left time: 564.5720s
	iters: 300, epoch: 18 | loss: 0.0014008
	speed: 0.0168s/iter; left time: 571.9855s
	iters: 400, epoch: 18 | loss: 0.0008998
	speed: 0.0159s/iter; left time: 539.8648s
Epoch: 18 cost time: 7.462010860443115
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000074
	speed: 0.0748s/iter; left time: 2524.9975s
	iters: 200, epoch: 19 | loss: 0.0000053
	speed: 0.0160s/iter; left time: 539.8391s
	iters: 300, epoch: 19 | loss: 0.0000009
	speed: 0.0160s/iter; left time: 538.3324s
	iters: 400, epoch: 19 | loss: 0.0006081
	speed: 0.0162s/iter; left time: 543.0698s
Epoch: 19 cost time: 7.245101690292358
Epoch: 19, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 129419
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.7186361
	speed: 0.0334s/iter; left time: 1375.1600s
	iters: 200, epoch: 1 | loss: 0.2489972
	speed: 0.0176s/iter; left time: 724.1479s
	iters: 300, epoch: 1 | loss: 0.3260291
	speed: 0.0176s/iter; left time: 720.1319s
	iters: 400, epoch: 1 | loss: 0.4110971
	speed: 0.0176s/iter; left time: 720.0855s
Epoch: 1 cost time: 8.909385442733765
Epoch: 1, Steps: 413 | Train Loss: 0.684 Vali Loss: 0.168 Vali Acc: 0.945 Test Loss: 0.168 Test Acc: 0.945
Validation loss decreased (inf --> -0.945428).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0767495
	speed: 0.0833s/iter; left time: 3397.2629s
	iters: 200, epoch: 2 | loss: 0.0493871
	speed: 0.0196s/iter; left time: 797.7884s
	iters: 300, epoch: 2 | loss: 0.0790411
	speed: 0.0184s/iter; left time: 745.3590s
	iters: 400, epoch: 2 | loss: 0.0213635
	speed: 0.0148s/iter; left time: 597.9692s
Epoch: 2 cost time: 7.851696014404297
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.126 Vali Acc: 0.955 Test Loss: 0.126 Test Acc: 0.955
Validation loss decreased (-0.945428 --> -0.954524).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0252388
	speed: 0.0839s/iter; left time: 3386.8113s
	iters: 200, epoch: 3 | loss: 0.2430560
	speed: 0.0192s/iter; left time: 772.7186s
	iters: 300, epoch: 3 | loss: 0.0250431
	speed: 0.0157s/iter; left time: 632.7356s
	iters: 400, epoch: 3 | loss: 0.0566882
	speed: 0.0172s/iter; left time: 687.7905s
Epoch: 3 cost time: 7.719921350479126
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.140 Vali Acc: 0.955 Test Loss: 0.140 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0032423
	speed: 0.0834s/iter; left time: 3332.4308s
	iters: 200, epoch: 4 | loss: 0.0053240
	speed: 0.0181s/iter; left time: 720.0777s
	iters: 300, epoch: 4 | loss: 0.0429821
	speed: 0.0170s/iter; left time: 674.1131s
	iters: 400, epoch: 4 | loss: 0.0010422
	speed: 0.0164s/iter; left time: 649.3360s
Epoch: 4 cost time: 7.61638617515564
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.100 Vali Acc: 0.964 Test Loss: 0.100 Test Acc: 0.964
Validation loss decreased (-0.954524 --> -0.963619).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0351706
	speed: 0.0812s/iter; left time: 3210.8610s
	iters: 200, epoch: 5 | loss: 0.0485164
	speed: 0.0160s/iter; left time: 632.1243s
	iters: 300, epoch: 5 | loss: 0.0021504
	speed: 0.0145s/iter; left time: 569.8953s
	iters: 400, epoch: 5 | loss: 0.1209173
	speed: 0.0164s/iter; left time: 642.9000s
Epoch: 5 cost time: 7.0328168869018555
Epoch: 5, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
Validation loss decreased (-0.963619 --> -0.977716).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0020416
	speed: 0.0933s/iter; left time: 3650.2306s
	iters: 200, epoch: 6 | loss: 0.0353599
	speed: 0.0158s/iter; left time: 617.6683s
	iters: 300, epoch: 6 | loss: 0.0064204
	speed: 0.0190s/iter; left time: 740.7616s
	iters: 400, epoch: 6 | loss: 0.0643872
	speed: 0.0187s/iter; left time: 725.5802s
Epoch: 6 cost time: 8.274691104888916
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.967 Test Loss: 0.108 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0009118
	speed: 0.0904s/iter; left time: 3500.7102s
	iters: 200, epoch: 7 | loss: 0.0673608
	speed: 0.0163s/iter; left time: 628.5480s
	iters: 300, epoch: 7 | loss: 0.0203008
	speed: 0.0160s/iter; left time: 614.6009s
	iters: 400, epoch: 7 | loss: 0.0886711
	speed: 0.0170s/iter; left time: 655.0327s
Epoch: 7 cost time: 7.452106952667236
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0220886
	speed: 0.0770s/iter; left time: 2949.0078s
	iters: 200, epoch: 8 | loss: 0.0079516
	speed: 0.0156s/iter; left time: 597.7447s
	iters: 300, epoch: 8 | loss: 0.0032597
	speed: 0.0191s/iter; left time: 728.1081s
	iters: 400, epoch: 8 | loss: 0.6697736
	speed: 0.0182s/iter; left time: 693.2880s
Epoch: 8 cost time: 7.512346982955933
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.3215508
	speed: 0.0838s/iter; left time: 3175.5437s
	iters: 200, epoch: 9 | loss: 0.0327132
	speed: 0.0195s/iter; left time: 738.0806s
	iters: 300, epoch: 9 | loss: 0.0051867
	speed: 0.0184s/iter; left time: 695.3020s
	iters: 400, epoch: 9 | loss: 0.1939671
	speed: 0.0178s/iter; left time: 669.8153s
Epoch: 9 cost time: 8.084456443786621
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0039016
	speed: 0.0899s/iter; left time: 3368.0610s
	iters: 200, epoch: 10 | loss: 0.0033113
	speed: 0.0202s/iter; left time: 755.6576s
	iters: 300, epoch: 10 | loss: 0.0196912
	speed: 0.0180s/iter; left time: 669.5507s
	iters: 400, epoch: 10 | loss: 0.0008210
	speed: 0.0177s/iter; left time: 657.2297s
Epoch: 10 cost time: 8.1238694190979
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.962 Test Loss: 0.112 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0054132
	speed: 0.0907s/iter; left time: 3360.7093s
	iters: 200, epoch: 11 | loss: 0.0003119
	speed: 0.0239s/iter; left time: 882.4928s
	iters: 300, epoch: 11 | loss: 0.0249238
	speed: 0.0200s/iter; left time: 736.2869s
	iters: 400, epoch: 11 | loss: 0.0005871
	speed: 0.0199s/iter; left time: 731.5782s
Epoch: 11 cost time: 9.3136727809906
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.965 Test Loss: 0.155 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.1587949
	speed: 0.0916s/iter; left time: 3357.7193s
	iters: 200, epoch: 12 | loss: 0.0001280
	speed: 0.0195s/iter; left time: 714.3559s
	iters: 300, epoch: 12 | loss: 0.0000040
	speed: 0.0165s/iter; left time: 601.3005s
	iters: 400, epoch: 12 | loss: 0.0828069
	speed: 0.0193s/iter; left time: 703.0524s
Epoch: 12 cost time: 8.319998979568481
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001177
	speed: 0.0903s/iter; left time: 3272.2466s
	iters: 200, epoch: 13 | loss: 0.0001906
	speed: 0.0198s/iter; left time: 715.7259s
	iters: 300, epoch: 13 | loss: 0.0002196
	speed: 0.0188s/iter; left time: 677.4932s
	iters: 400, epoch: 13 | loss: 0.0001073
	speed: 0.0182s/iter; left time: 652.8484s
Epoch: 13 cost time: 8.275095701217651
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000417
	speed: 0.0958s/iter; left time: 3432.8593s
	iters: 200, epoch: 14 | loss: 0.0000075
	speed: 0.0197s/iter; left time: 703.6636s
	iters: 300, epoch: 14 | loss: 0.0000377
	speed: 0.0184s/iter; left time: 655.3595s
	iters: 400, epoch: 14 | loss: 0.0033469
	speed: 0.0163s/iter; left time: 578.6584s
Epoch: 14 cost time: 8.140958786010742
Epoch: 14, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.968 Test Loss: 0.150 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000064
	speed: 0.0929s/iter; left time: 3289.0672s
	iters: 200, epoch: 15 | loss: 0.0047964
	speed: 0.0199s/iter; left time: 701.3196s
	iters: 300, epoch: 15 | loss: 0.0000530
	speed: 0.0157s/iter; left time: 552.1181s
	iters: 400, epoch: 15 | loss: 0.0002018
	speed: 0.0179s/iter; left time: 628.5061s
Epoch: 15 cost time: 7.912017583847046
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 128934
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0796862
	speed: 0.0340s/iter; left time: 1399.1085s
	iters: 200, epoch: 1 | loss: 0.4372763
	speed: 0.0197s/iter; left time: 808.0297s
	iters: 300, epoch: 1 | loss: 0.0431178
	speed: 0.0169s/iter; left time: 692.7003s
	iters: 400, epoch: 1 | loss: 0.0256551
	speed: 0.0185s/iter; left time: 755.5863s
Epoch: 1 cost time: 9.251086235046387
Epoch: 1, Steps: 413 | Train Loss: 0.650 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0205994
	speed: 0.0844s/iter; left time: 3444.1631s
	iters: 200, epoch: 2 | loss: 0.5701848
	speed: 0.0185s/iter; left time: 753.4279s
	iters: 300, epoch: 2 | loss: 0.1954758
	speed: 0.0206s/iter; left time: 837.4536s
	iters: 400, epoch: 2 | loss: 0.0371666
	speed: 0.0195s/iter; left time: 791.2979s
Epoch: 2 cost time: 8.489126205444336
Epoch: 2, Steps: 413 | Train Loss: 0.141 Vali Loss: 0.099 Vali Acc: 0.965 Test Loss: 0.099 Test Acc: 0.965
Validation loss decreased (-0.951340 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0743692
	speed: 0.0898s/iter; left time: 3626.1968s
	iters: 200, epoch: 3 | loss: 0.2445511
	speed: 0.0196s/iter; left time: 791.2327s
	iters: 300, epoch: 3 | loss: 0.2557594
	speed: 0.0195s/iter; left time: 782.7586s
	iters: 400, epoch: 3 | loss: 0.0151856
	speed: 0.0158s/iter; left time: 632.2229s
Epoch: 3 cost time: 8.089596271514893
Epoch: 3, Steps: 413 | Train Loss: 0.095 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0146261
	speed: 0.0813s/iter; left time: 3247.1929s
	iters: 200, epoch: 4 | loss: 0.0026591
	speed: 0.0187s/iter; left time: 745.9906s
	iters: 300, epoch: 4 | loss: 0.0414088
	speed: 0.0190s/iter; left time: 755.7147s
	iters: 400, epoch: 4 | loss: 0.0258880
	speed: 0.0175s/iter; left time: 693.1434s
Epoch: 4 cost time: 8.155123472213745
Epoch: 4, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.064 Vali Acc: 0.975 Test Loss: 0.064 Test Acc: 0.975
Validation loss decreased (-0.965438 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0046380
	speed: 0.0873s/iter; left time: 3454.3293s
	iters: 200, epoch: 5 | loss: 0.0160287
	speed: 0.0175s/iter; left time: 690.4307s
	iters: 300, epoch: 5 | loss: 0.0062550
	speed: 0.0154s/iter; left time: 606.3975s
	iters: 400, epoch: 5 | loss: 0.0009191
	speed: 0.0169s/iter; left time: 663.5306s
Epoch: 5 cost time: 7.516294002532959
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.084 Vali Acc: 0.968 Test Loss: 0.084 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1008950
	speed: 0.0936s/iter; left time: 3661.1991s
	iters: 200, epoch: 6 | loss: 0.0156013
	speed: 0.0159s/iter; left time: 620.1958s
	iters: 300, epoch: 6 | loss: 0.0141481
	speed: 0.0182s/iter; left time: 709.9477s
	iters: 400, epoch: 6 | loss: 0.0117798
	speed: 0.0183s/iter; left time: 712.0224s
Epoch: 6 cost time: 7.993969440460205
Epoch: 6, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.099 Vali Acc: 0.971 Test Loss: 0.099 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0009161
	speed: 0.0901s/iter; left time: 3488.9605s
	iters: 200, epoch: 7 | loss: 0.1235053
	speed: 0.0150s/iter; left time: 578.4873s
	iters: 300, epoch: 7 | loss: 0.0120185
	speed: 0.0187s/iter; left time: 721.7536s
	iters: 400, epoch: 7 | loss: 0.0002069
	speed: 0.0181s/iter; left time: 696.7755s
Epoch: 7 cost time: 7.583699941635132
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0001763
	speed: 0.0848s/iter; left time: 3248.3421s
	iters: 200, epoch: 8 | loss: 0.0165423
	speed: 0.0180s/iter; left time: 687.3472s
	iters: 300, epoch: 8 | loss: 0.0003531
	speed: 0.0206s/iter; left time: 785.8684s
	iters: 400, epoch: 8 | loss: 0.0004152
	speed: 0.0187s/iter; left time: 709.9656s
Epoch: 8 cost time: 8.255245447158813
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0055276
	speed: 0.0858s/iter; left time: 3252.7891s
	iters: 200, epoch: 9 | loss: 0.0001834
	speed: 0.0180s/iter; left time: 680.4017s
	iters: 300, epoch: 9 | loss: 0.1178073
	speed: 0.0199s/iter; left time: 748.4166s
	iters: 400, epoch: 9 | loss: 0.0000613
	speed: 0.0199s/iter; left time: 747.6751s
Epoch: 9 cost time: 8.218086957931519
Epoch: 9, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0048457
	speed: 0.0861s/iter; left time: 3226.0028s
	iters: 200, epoch: 10 | loss: 0.0105764
	speed: 0.0195s/iter; left time: 727.7527s
	iters: 300, epoch: 10 | loss: 0.0000037
	speed: 0.0193s/iter; left time: 720.9141s
	iters: 400, epoch: 10 | loss: 0.0000064
	speed: 0.0191s/iter; left time: 710.1537s
Epoch: 10 cost time: 8.415300607681274
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.1052091
	speed: 0.0805s/iter; left time: 2985.7214s
	iters: 200, epoch: 11 | loss: 0.0073736
	speed: 0.0167s/iter; left time: 616.9116s
	iters: 300, epoch: 11 | loss: 0.0001113
	speed: 0.0174s/iter; left time: 642.2125s
	iters: 400, epoch: 11 | loss: 0.0003541
	speed: 0.0159s/iter; left time: 586.1062s
Epoch: 11 cost time: 7.4106292724609375
Epoch: 11, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0006437
	speed: 0.0772s/iter; left time: 2829.1754s
	iters: 200, epoch: 12 | loss: 0.0005300
	speed: 0.0182s/iter; left time: 664.6551s
	iters: 300, epoch: 12 | loss: 0.0427930
	speed: 0.0173s/iter; left time: 630.3673s
	iters: 400, epoch: 12 | loss: 0.0003235
	speed: 0.0159s/iter; left time: 577.9727s
Epoch: 12 cost time: 7.436641454696655
Epoch: 12, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0520628
	speed: 0.0862s/iter; left time: 3123.9826s
	iters: 200, epoch: 13 | loss: 0.0001838
	speed: 0.0185s/iter; left time: 667.5629s
	iters: 300, epoch: 13 | loss: 0.0161623
	speed: 0.0176s/iter; left time: 633.7151s
	iters: 400, epoch: 13 | loss: 0.0096369
	speed: 0.0163s/iter; left time: 587.5145s
Epoch: 13 cost time: 8.112215280532837
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000258
	speed: 0.0945s/iter; left time: 3387.2311s
	iters: 200, epoch: 14 | loss: 0.0000221
	speed: 0.0173s/iter; left time: 618.4558s
	iters: 300, epoch: 14 | loss: 0.0035807
	speed: 0.0153s/iter; left time: 545.3081s
	iters: 400, epoch: 14 | loss: 0.2238241
	speed: 0.0173s/iter; left time: 613.2032s
Epoch: 14 cost time: 7.62148118019104
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 128976
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0447319
	speed: 0.0428s/iter; left time: 1762.4077s
	iters: 200, epoch: 1 | loss: 0.1173854
	speed: 0.0213s/iter; left time: 877.4757s
	iters: 300, epoch: 1 | loss: 0.1379261
	speed: 0.0203s/iter; left time: 831.7138s
	iters: 400, epoch: 1 | loss: 0.2723015
	speed: 0.0182s/iter; left time: 745.4284s
Epoch: 1 cost time: 10.59235692024231
Epoch: 1, Steps: 413 | Train Loss: 0.692 Vali Loss: 0.313 Vali Acc: 0.899 Test Loss: 0.313 Test Acc: 0.899
Validation loss decreased (inf --> -0.899042).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0150929
	speed: 0.0931s/iter; left time: 3797.6596s
	iters: 200, epoch: 2 | loss: 0.1653948
	speed: 0.0207s/iter; left time: 843.2253s
	iters: 300, epoch: 2 | loss: 0.0817448
	speed: 0.0192s/iter; left time: 777.5344s
	iters: 400, epoch: 2 | loss: 0.0132304
	speed: 0.0174s/iter; left time: 704.3489s
Epoch: 2 cost time: 8.562434434890747
Epoch: 2, Steps: 413 | Train Loss: 0.140 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (-0.899042 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1314681
	speed: 0.0833s/iter; left time: 3361.2210s
	iters: 200, epoch: 3 | loss: 0.0355618
	speed: 0.0169s/iter; left time: 679.3917s
	iters: 300, epoch: 3 | loss: 0.0358842
	speed: 0.0184s/iter; left time: 738.8410s
	iters: 400, epoch: 3 | loss: 0.0064270
	speed: 0.0171s/iter; left time: 687.2273s
Epoch: 3 cost time: 7.617213487625122
Epoch: 3, Steps: 413 | Train Loss: 0.092 Vali Loss: 0.077 Vali Acc: 0.974 Test Loss: 0.077 Test Acc: 0.974
Validation loss decreased (-0.967257 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0558345
	speed: 0.0768s/iter; left time: 3070.9772s
	iters: 200, epoch: 4 | loss: 0.0007672
	speed: 0.0184s/iter; left time: 732.3019s
	iters: 300, epoch: 4 | loss: 0.0073472
	speed: 0.0195s/iter; left time: 773.8769s
	iters: 400, epoch: 4 | loss: 0.0866059
	speed: 0.0199s/iter; left time: 789.3762s
Epoch: 4 cost time: 8.222245216369629
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0017560
	speed: 0.0844s/iter; left time: 3339.8511s
	iters: 200, epoch: 5 | loss: 0.1188010
	speed: 0.0168s/iter; left time: 663.1561s
	iters: 300, epoch: 5 | loss: 0.0587352
	speed: 0.0187s/iter; left time: 734.6177s
	iters: 400, epoch: 5 | loss: 0.2324308
	speed: 0.0178s/iter; left time: 697.8700s
Epoch: 5 cost time: 7.755969285964966
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0658756
	speed: 0.0891s/iter; left time: 3486.7737s
	iters: 200, epoch: 6 | loss: 0.0003912
	speed: 0.0169s/iter; left time: 660.3996s
	iters: 300, epoch: 6 | loss: 0.0153755
	speed: 0.0168s/iter; left time: 655.7554s
	iters: 400, epoch: 6 | loss: 0.0014845
	speed: 0.0161s/iter; left time: 624.0280s
Epoch: 6 cost time: 7.505264759063721
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0114719
	speed: 0.0725s/iter; left time: 2807.3457s
	iters: 200, epoch: 7 | loss: 0.0029732
	speed: 0.0141s/iter; left time: 545.1745s
	iters: 300, epoch: 7 | loss: 0.0011532
	speed: 0.0160s/iter; left time: 615.7074s
	iters: 400, epoch: 7 | loss: 0.0018840
	speed: 0.0139s/iter; left time: 532.7972s
Epoch: 7 cost time: 6.495183706283569
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.081 Vali Acc: 0.978 Test Loss: 0.081 Test Acc: 0.978
Validation loss decreased (-0.973624 --> -0.977716).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1641360
	speed: 0.0763s/iter; left time: 2924.0441s
	iters: 200, epoch: 8 | loss: 0.0037745
	speed: 0.0171s/iter; left time: 652.2757s
	iters: 300, epoch: 8 | loss: 0.0040108
	speed: 0.0202s/iter; left time: 771.2145s
	iters: 400, epoch: 8 | loss: 0.0274489
	speed: 0.0184s/iter; left time: 700.8086s
Epoch: 8 cost time: 7.976298809051514
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.069 Vali Acc: 0.979 Test Loss: 0.069 Test Acc: 0.979
Validation loss decreased (-0.977716 --> -0.978626).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0005865
	speed: 0.0894s/iter; left time: 3389.6898s
	iters: 200, epoch: 9 | loss: 0.0060924
	speed: 0.0203s/iter; left time: 766.5697s
	iters: 300, epoch: 9 | loss: 0.2540953
	speed: 0.0203s/iter; left time: 764.0506s
	iters: 400, epoch: 9 | loss: 0.0256166
	speed: 0.0188s/iter; left time: 706.4851s
Epoch: 9 cost time: 8.709339618682861
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0081832
	speed: 0.0937s/iter; left time: 3510.8251s
	iters: 200, epoch: 10 | loss: 0.0235224
	speed: 0.0195s/iter; left time: 727.7198s
	iters: 300, epoch: 10 | loss: 0.0452401
	speed: 0.0211s/iter; left time: 787.9122s
	iters: 400, epoch: 10 | loss: 0.0918465
	speed: 0.0186s/iter; left time: 689.8488s
Epoch: 10 cost time: 8.570397853851318
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.959 Test Loss: 0.147 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1712293
	speed: 0.0952s/iter; left time: 3530.4327s
	iters: 200, epoch: 11 | loss: 0.0008584
	speed: 0.0191s/iter; left time: 705.2435s
	iters: 300, epoch: 11 | loss: 0.0000482
	speed: 0.0182s/iter; left time: 670.1059s
	iters: 400, epoch: 11 | loss: 0.1520293
	speed: 0.0169s/iter; left time: 619.8535s
Epoch: 11 cost time: 7.9789650440216064
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0082482
	speed: 0.0885s/iter; left time: 3245.5200s
	iters: 200, epoch: 12 | loss: 0.0002724
	speed: 0.0181s/iter; left time: 659.9197s
	iters: 300, epoch: 12 | loss: 0.0031280
	speed: 0.0186s/iter; left time: 677.9536s
	iters: 400, epoch: 12 | loss: 0.0000205
	speed: 0.0186s/iter; left time: 675.0932s
Epoch: 12 cost time: 8.152190208435059
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0263493
	speed: 0.0925s/iter; left time: 3352.0199s
	iters: 200, epoch: 13 | loss: 0.0190003
	speed: 0.0168s/iter; left time: 608.4929s
	iters: 300, epoch: 13 | loss: 0.0000708
	speed: 0.0205s/iter; left time: 740.3198s
	iters: 400, epoch: 13 | loss: 0.1484165
	speed: 0.0187s/iter; left time: 670.9219s
Epoch: 13 cost time: 8.4331533908844
Epoch: 13, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0015986
	speed: 0.0910s/iter; left time: 3261.2777s
	iters: 200, epoch: 14 | loss: 0.0114226
	speed: 0.0194s/iter; left time: 693.1824s
	iters: 300, epoch: 14 | loss: 0.0004438
	speed: 0.0195s/iter; left time: 695.3424s
	iters: 400, epoch: 14 | loss: 0.0003101
	speed: 0.0184s/iter; left time: 655.2197s
Epoch: 14 cost time: 8.584646463394165
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000267
	speed: 0.0803s/iter; left time: 2845.3206s
	iters: 200, epoch: 15 | loss: 0.2449457
	speed: 0.0172s/iter; left time: 608.3740s
	iters: 300, epoch: 15 | loss: 0.0042360
	speed: 0.0162s/iter; left time: 571.4178s
	iters: 400, epoch: 15 | loss: 0.0000123
	speed: 0.0176s/iter; left time: 618.2139s
Epoch: 15 cost time: 7.62720251083374
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0118828
	speed: 0.0808s/iter; left time: 2827.4712s
	iters: 200, epoch: 16 | loss: 0.0194419
	speed: 0.0177s/iter; left time: 616.6853s
	iters: 300, epoch: 16 | loss: 0.1118921
	speed: 0.0172s/iter; left time: 597.8928s
	iters: 400, epoch: 16 | loss: 0.0002251
	speed: 0.0169s/iter; left time: 585.8276s
Epoch: 16 cost time: 7.796064376831055
Epoch: 16, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0021490
	speed: 0.0776s/iter; left time: 2683.8900s
	iters: 200, epoch: 17 | loss: 0.0776217
	speed: 0.0187s/iter; left time: 643.6654s
	iters: 300, epoch: 17 | loss: 0.0003406
	speed: 0.0178s/iter; left time: 613.0244s
	iters: 400, epoch: 17 | loss: 0.0000360
	speed: 0.0181s/iter; left time: 620.9414s
Epoch: 17 cost time: 7.796070337295532
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0001685
	speed: 0.0724s/iter; left time: 2474.4239s
	iters: 200, epoch: 18 | loss: 0.0000524
	speed: 0.0184s/iter; left time: 625.7655s
	iters: 300, epoch: 18 | loss: 0.2256961
	speed: 0.0161s/iter; left time: 545.5632s
	iters: 400, epoch: 18 | loss: 0.0003161
	speed: 0.0172s/iter; left time: 583.4672s
Epoch: 18 cost time: 7.547005891799927
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 128662
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9286911
	speed: 0.0396s/iter; left time: 1630.8181s
	iters: 200, epoch: 1 | loss: 0.1231935
	speed: 0.0189s/iter; left time: 776.9316s
	iters: 300, epoch: 1 | loss: 0.2374586
	speed: 0.0184s/iter; left time: 752.4030s
	iters: 400, epoch: 1 | loss: 0.1487352
	speed: 0.0183s/iter; left time: 747.3136s
Epoch: 1 cost time: 9.759318590164185
Epoch: 1, Steps: 413 | Train Loss: 0.694 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
Validation loss decreased (inf --> -0.948157).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2304418
	speed: 0.0785s/iter; left time: 3199.9291s
	iters: 200, epoch: 2 | loss: 0.0186931
	speed: 0.0184s/iter; left time: 747.0451s
	iters: 300, epoch: 2 | loss: 0.4067919
	speed: 0.0168s/iter; left time: 682.8752s
	iters: 400, epoch: 2 | loss: 0.0360391
	speed: 0.0157s/iter; left time: 635.0818s
Epoch: 2 cost time: 7.522390365600586
Epoch: 2, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.101 Vali Acc: 0.964 Test Loss: 0.101 Test Acc: 0.964
Validation loss decreased (-0.948157 --> -0.963619).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0374572
	speed: 0.0792s/iter; left time: 3196.2853s
	iters: 200, epoch: 3 | loss: 0.0230341
	speed: 0.0179s/iter; left time: 721.0135s
	iters: 300, epoch: 3 | loss: 0.1335671
	speed: 0.0185s/iter; left time: 743.8557s
	iters: 400, epoch: 3 | loss: 0.0702824
	speed: 0.0183s/iter; left time: 732.9032s
Epoch: 3 cost time: 8.173272371292114
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.072 Vali Acc: 0.974 Test Loss: 0.072 Test Acc: 0.974
Validation loss decreased (-0.963619 --> -0.973624).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0092960
	speed: 0.0885s/iter; left time: 3537.2442s
	iters: 200, epoch: 4 | loss: 0.0276315
	speed: 0.0179s/iter; left time: 712.5204s
	iters: 300, epoch: 4 | loss: 0.0023412
	speed: 0.0197s/iter; left time: 782.5031s
	iters: 400, epoch: 4 | loss: 0.0907560
	speed: 0.0185s/iter; left time: 734.7705s
Epoch: 4 cost time: 8.240880012512207
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.059 Vali Acc: 0.979 Test Loss: 0.059 Test Acc: 0.979
Validation loss decreased (-0.973624 --> -0.979081).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0405490
	speed: 0.0866s/iter; left time: 3423.1752s
	iters: 200, epoch: 5 | loss: 0.0182174
	speed: 0.0177s/iter; left time: 696.8460s
	iters: 300, epoch: 5 | loss: 0.0060714
	speed: 0.0186s/iter; left time: 731.6146s
	iters: 400, epoch: 5 | loss: 0.0058293
	speed: 0.0182s/iter; left time: 714.4347s
Epoch: 5 cost time: 7.932413578033447
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0603064
	speed: 0.0831s/iter; left time: 3251.0258s
	iters: 200, epoch: 6 | loss: 0.0390612
	speed: 0.0171s/iter; left time: 667.3932s
	iters: 300, epoch: 6 | loss: 0.0048713
	speed: 0.0166s/iter; left time: 644.8878s
	iters: 400, epoch: 6 | loss: 0.0614237
	speed: 0.0196s/iter; left time: 760.8292s
Epoch: 6 cost time: 7.8115153312683105
Epoch: 6, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0630096
	speed: 0.0804s/iter; left time: 3111.9322s
	iters: 200, epoch: 7 | loss: 0.0050575
	speed: 0.0175s/iter; left time: 676.7698s
	iters: 300, epoch: 7 | loss: 0.0825502
	speed: 0.0179s/iter; left time: 688.6985s
	iters: 400, epoch: 7 | loss: 0.0008313
	speed: 0.0176s/iter; left time: 678.0333s
Epoch: 7 cost time: 7.642019748687744
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.096 Vali Acc: 0.972 Test Loss: 0.096 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0000270
	speed: 0.0838s/iter; left time: 3209.3791s
	iters: 200, epoch: 8 | loss: 0.0000652
	speed: 0.0176s/iter; left time: 673.4193s
	iters: 300, epoch: 8 | loss: 0.0064773
	speed: 0.0186s/iter; left time: 707.6656s
	iters: 400, epoch: 8 | loss: 0.0712545
	speed: 0.0157s/iter; left time: 597.3078s
Epoch: 8 cost time: 7.694073438644409
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0206175
	speed: 0.0827s/iter; left time: 3134.5774s
	iters: 200, epoch: 9 | loss: 0.0039092
	speed: 0.0160s/iter; left time: 604.8515s
	iters: 300, epoch: 9 | loss: 0.0196858
	speed: 0.0159s/iter; left time: 599.7930s
	iters: 400, epoch: 9 | loss: 0.0130153
	speed: 0.0152s/iter; left time: 570.3154s
Epoch: 9 cost time: 6.980208158493042
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0004142
	speed: 0.0788s/iter; left time: 2955.2623s
	iters: 200, epoch: 10 | loss: 0.0001386
	speed: 0.0191s/iter; left time: 713.1906s
	iters: 300, epoch: 10 | loss: 0.0064695
	speed: 0.0174s/iter; left time: 650.3833s
	iters: 400, epoch: 10 | loss: 0.0033442
	speed: 0.0147s/iter; left time: 545.6992s
Epoch: 10 cost time: 7.5164666175842285
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.123 Vali Acc: 0.969 Test Loss: 0.123 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0201128
	speed: 0.0894s/iter; left time: 3314.2182s
	iters: 200, epoch: 11 | loss: 0.2933527
	speed: 0.0200s/iter; left time: 739.1983s
	iters: 300, epoch: 11 | loss: 0.0000159
	speed: 0.0181s/iter; left time: 667.5132s
	iters: 400, epoch: 11 | loss: 0.0000941
	speed: 0.0190s/iter; left time: 697.3806s
Epoch: 11 cost time: 8.198946952819824
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0005716
	speed: 0.0941s/iter; left time: 3450.1995s
	iters: 200, epoch: 12 | loss: 0.0000511
	speed: 0.0199s/iter; left time: 729.2350s
	iters: 300, epoch: 12 | loss: 0.2046361
	speed: 0.0179s/iter; left time: 650.9814s
	iters: 400, epoch: 12 | loss: 0.0006761
	speed: 0.0170s/iter; left time: 617.4898s
Epoch: 12 cost time: 8.169071912765503
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0140055
	speed: 0.0861s/iter; left time: 3119.9926s
	iters: 200, epoch: 13 | loss: 0.0044946
	speed: 0.0192s/iter; left time: 694.2544s
	iters: 300, epoch: 13 | loss: 0.0002746
	speed: 0.0169s/iter; left time: 607.7645s
	iters: 400, epoch: 13 | loss: 0.0000757
	speed: 0.0173s/iter; left time: 621.4143s
Epoch: 13 cost time: 7.9492881298065186
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.212 Vali Acc: 0.961 Test Loss: 0.212 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0048604
	speed: 0.0934s/iter; left time: 3346.9666s
	iters: 200, epoch: 14 | loss: 0.0000610
	speed: 0.0198s/iter; left time: 708.3312s
	iters: 300, epoch: 14 | loss: 0.0042481
	speed: 0.0191s/iter; left time: 679.1938s
	iters: 400, epoch: 14 | loss: 0.0060418
	speed: 0.0212s/iter; left time: 753.0915s
Epoch: 14 cost time: 8.864780902862549
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.176 Vali Acc: 0.966 Test Loss: 0.176 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 128535
model size : 0.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1017480
	speed: 0.0326s/iter; left time: 1343.8443s
	iters: 200, epoch: 1 | loss: 0.3601164
	speed: 0.0179s/iter; left time: 736.1065s
	iters: 300, epoch: 1 | loss: 0.0847450
	speed: 0.0180s/iter; left time: 737.9468s
	iters: 400, epoch: 1 | loss: 0.1460268
	speed: 0.0182s/iter; left time: 744.5250s
Epoch: 1 cost time: 8.998093128204346
Epoch: 1, Steps: 413 | Train Loss: 0.699 Vali Loss: 0.149 Vali Acc: 0.956 Test Loss: 0.149 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3243815
	speed: 0.0772s/iter; left time: 3150.5510s
	iters: 200, epoch: 2 | loss: 0.1811479
	speed: 0.0178s/iter; left time: 724.3208s
	iters: 300, epoch: 2 | loss: 0.2637890
	speed: 0.0173s/iter; left time: 701.1618s
	iters: 400, epoch: 2 | loss: 0.0429434
	speed: 0.0173s/iter; left time: 699.8621s
Epoch: 2 cost time: 7.49213719367981
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.113 Vali Acc: 0.961 Test Loss: 0.113 Test Acc: 0.961
Validation loss decreased (-0.955888 --> -0.960890).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0202177
	speed: 0.0763s/iter; left time: 3078.7449s
	iters: 200, epoch: 3 | loss: 0.0466145
	speed: 0.0175s/iter; left time: 703.2958s
	iters: 300, epoch: 3 | loss: 0.4113605
	speed: 0.0204s/iter; left time: 820.5774s
	iters: 400, epoch: 3 | loss: 0.0144645
	speed: 0.0183s/iter; left time: 735.0201s
Epoch: 3 cost time: 7.934412240982056
Epoch: 3, Steps: 413 | Train Loss: 0.089 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
Validation loss decreased (-0.960890 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1270312
	speed: 0.0843s/iter; left time: 3367.8821s
	iters: 200, epoch: 4 | loss: 0.0091472
	speed: 0.0187s/iter; left time: 746.1351s
	iters: 300, epoch: 4 | loss: 0.0235869
	speed: 0.0190s/iter; left time: 757.1824s
	iters: 400, epoch: 4 | loss: 0.2855380
	speed: 0.0174s/iter; left time: 688.9571s
Epoch: 4 cost time: 8.019227981567383
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.079 Vali Acc: 0.977 Test Loss: 0.079 Test Acc: 0.977
Validation loss decreased (-0.973169 --> -0.977262).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0303862
	speed: 0.0893s/iter; left time: 3533.6271s
	iters: 200, epoch: 5 | loss: 0.0146002
	speed: 0.0203s/iter; left time: 801.9070s
	iters: 300, epoch: 5 | loss: 0.0083198
	speed: 0.0215s/iter; left time: 846.0959s
	iters: 400, epoch: 5 | loss: 0.0021861
	speed: 0.0184s/iter; left time: 721.5079s
Epoch: 5 cost time: 8.58150339126587
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.110 Vali Acc: 0.969 Test Loss: 0.110 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0003276
	speed: 0.0923s/iter; left time: 3613.1597s
	iters: 200, epoch: 6 | loss: 0.0034614
	speed: 0.0189s/iter; left time: 737.8755s
	iters: 300, epoch: 6 | loss: 0.0003651
	speed: 0.0192s/iter; left time: 749.4286s
	iters: 400, epoch: 6 | loss: 0.0508420
	speed: 0.0211s/iter; left time: 821.1045s
Epoch: 6 cost time: 8.88677191734314
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000203
	speed: 0.0900s/iter; left time: 3484.4122s
	iters: 200, epoch: 7 | loss: 0.0040232
	speed: 0.0181s/iter; left time: 699.5920s
	iters: 300, epoch: 7 | loss: 0.0014198
	speed: 0.0211s/iter; left time: 812.8760s
	iters: 400, epoch: 7 | loss: 0.0056363
	speed: 0.0196s/iter; left time: 754.9041s
Epoch: 7 cost time: 8.383387088775635
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0027994
	speed: 0.0884s/iter; left time: 3388.1718s
	iters: 200, epoch: 8 | loss: 0.0098757
	speed: 0.0193s/iter; left time: 738.7005s
	iters: 300, epoch: 8 | loss: 0.0079823
	speed: 0.0188s/iter; left time: 717.4146s
	iters: 400, epoch: 8 | loss: 0.0132968
	speed: 0.0185s/iter; left time: 703.4777s
Epoch: 8 cost time: 8.23482370376587
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0160537
	speed: 0.0903s/iter; left time: 3421.3156s
	iters: 200, epoch: 9 | loss: 0.0006013
	speed: 0.0196s/iter; left time: 742.4630s
	iters: 300, epoch: 9 | loss: 0.0004305
	speed: 0.0209s/iter; left time: 786.1375s
	iters: 400, epoch: 9 | loss: 0.0021627
	speed: 0.0183s/iter; left time: 689.1013s
Epoch: 9 cost time: 8.54598069190979
Epoch: 9, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0001704
	speed: 0.0962s/iter; left time: 3604.3244s
	iters: 200, epoch: 10 | loss: 0.0000517
	speed: 0.0192s/iter; left time: 718.4131s
	iters: 300, epoch: 10 | loss: 0.0004609
	speed: 0.0194s/iter; left time: 723.7636s
	iters: 400, epoch: 10 | loss: 0.0986872
	speed: 0.0148s/iter; left time: 548.9600s
Epoch: 10 cost time: 8.078194618225098
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0071554
	speed: 0.0813s/iter; left time: 3012.7683s
	iters: 200, epoch: 11 | loss: 0.0000708
	speed: 0.0166s/iter; left time: 612.4337s
	iters: 300, epoch: 11 | loss: 0.0000427
	speed: 0.0175s/iter; left time: 643.5178s
	iters: 400, epoch: 11 | loss: 0.5217822
	speed: 0.0176s/iter; left time: 647.3797s
Epoch: 11 cost time: 7.6287219524383545
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.953 Test Loss: 0.175 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0114066
	speed: 0.0869s/iter; left time: 3186.2374s
	iters: 200, epoch: 12 | loss: 0.0025005
	speed: 0.0198s/iter; left time: 722.0708s
	iters: 300, epoch: 12 | loss: 0.0009112
	speed: 0.0200s/iter; left time: 728.8018s
	iters: 400, epoch: 12 | loss: 0.0000668
	speed: 0.0173s/iter; left time: 629.4143s
Epoch: 12 cost time: 8.428552865982056
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0029662
	speed: 0.0902s/iter; left time: 3269.2756s
	iters: 200, epoch: 13 | loss: 0.0050182
	speed: 0.0179s/iter; left time: 646.2869s
	iters: 300, epoch: 13 | loss: 0.0008758
	speed: 0.0177s/iter; left time: 636.8225s
	iters: 400, epoch: 13 | loss: 0.0000344
	speed: 0.0169s/iter; left time: 607.1096s
Epoch: 13 cost time: 7.742265701293945
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0000616
	speed: 0.0893s/iter; left time: 3198.7613s
	iters: 200, epoch: 14 | loss: 0.0008067
	speed: 0.0179s/iter; left time: 640.9170s
	iters: 300, epoch: 14 | loss: 0.0000010
	speed: 0.0174s/iter; left time: 621.1726s
	iters: 400, epoch: 14 | loss: 0.0148403
	speed: 0.0168s/iter; left time: 596.1191s
Epoch: 14 cost time: 7.947895765304565
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 55244
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1851540
	speed: 0.0387s/iter; left time: 1595.7495s
	iters: 200, epoch: 1 | loss: 0.6094489
	speed: 0.0205s/iter; left time: 841.1613s
	iters: 300, epoch: 1 | loss: 0.0807457
	speed: 0.0243s/iter; left time: 994.5306s
	iters: 400, epoch: 1 | loss: 0.0200744
	speed: 0.0223s/iter; left time: 912.9791s
Epoch: 1 cost time: 10.9386465549469
Epoch: 1, Steps: 413 | Train Loss: 0.714 Vali Loss: 0.141 Vali Acc: 0.951 Test Loss: 0.141 Test Acc: 0.951
Validation loss decreased (inf --> -0.950885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0119021
	speed: 0.0971s/iter; left time: 3961.3364s
	iters: 200, epoch: 2 | loss: 0.1916999
	speed: 0.0220s/iter; left time: 895.1784s
	iters: 300, epoch: 2 | loss: 0.0435819
	speed: 0.0218s/iter; left time: 886.8466s
	iters: 400, epoch: 2 | loss: 0.1830450
	speed: 0.0194s/iter; left time: 784.9760s
Epoch: 2 cost time: 9.09701418876648
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.106 Vali Acc: 0.961 Test Loss: 0.106 Test Acc: 0.961
Validation loss decreased (-0.950885 --> -0.960890).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1244128
	speed: 0.0774s/iter; left time: 3127.0339s
	iters: 200, epoch: 3 | loss: 0.2426631
	speed: 0.0182s/iter; left time: 733.4910s
	iters: 300, epoch: 3 | loss: 0.1028618
	speed: 0.0186s/iter; left time: 749.0652s
	iters: 400, epoch: 3 | loss: 0.0852607
	speed: 0.0179s/iter; left time: 719.3005s
Epoch: 3 cost time: 8.109013080596924
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
Validation loss decreased (-0.960890 --> -0.965438).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7567394
	speed: 0.0832s/iter; left time: 3324.7871s
	iters: 200, epoch: 4 | loss: 0.0680732
	speed: 0.0192s/iter; left time: 766.8001s
	iters: 300, epoch: 4 | loss: 0.0639077
	speed: 0.0221s/iter; left time: 879.9881s
	iters: 400, epoch: 4 | loss: 0.0229510
	speed: 0.0199s/iter; left time: 788.3875s
Epoch: 4 cost time: 8.686279773712158
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.080 Vali Acc: 0.972 Test Loss: 0.080 Test Acc: 0.972
Validation loss decreased (-0.965438 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0020531
	speed: 0.0963s/iter; left time: 3808.9230s
	iters: 200, epoch: 5 | loss: 0.0048620
	speed: 0.0205s/iter; left time: 809.0949s
	iters: 300, epoch: 5 | loss: 0.0048848
	speed: 0.0182s/iter; left time: 716.1224s
	iters: 400, epoch: 5 | loss: 0.3304911
	speed: 0.0161s/iter; left time: 632.7217s
Epoch: 5 cost time: 8.089856386184692
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0014719
	speed: 0.0774s/iter; left time: 3028.2324s
	iters: 200, epoch: 6 | loss: 0.0026040
	speed: 0.0205s/iter; left time: 800.1977s
	iters: 300, epoch: 6 | loss: 0.0027640
	speed: 0.0175s/iter; left time: 680.1016s
	iters: 400, epoch: 6 | loss: 0.0546041
	speed: 0.0142s/iter; left time: 550.6025s
Epoch: 6 cost time: 7.515415191650391
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0000206
	speed: 0.0766s/iter; left time: 2967.5926s
	iters: 200, epoch: 7 | loss: 0.0168748
	speed: 0.0160s/iter; left time: 619.5398s
	iters: 300, epoch: 7 | loss: 0.0004619
	speed: 0.0167s/iter; left time: 642.9667s
	iters: 400, epoch: 7 | loss: 0.0010341
	speed: 0.0168s/iter; left time: 643.9543s
Epoch: 7 cost time: 7.377796649932861
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.962 Test Loss: 0.131 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0355307
	speed: 0.0985s/iter; left time: 3771.9311s
	iters: 200, epoch: 8 | loss: 0.0009420
	speed: 0.0177s/iter; left time: 677.3973s
	iters: 300, epoch: 8 | loss: 0.0068375
	speed: 0.0170s/iter; left time: 646.9382s
	iters: 400, epoch: 8 | loss: 0.0185084
	speed: 0.0198s/iter; left time: 753.2847s
Epoch: 8 cost time: 8.24009895324707
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0006700
	speed: 0.0906s/iter; left time: 3431.8486s
	iters: 200, epoch: 9 | loss: 0.0263060
	speed: 0.0178s/iter; left time: 673.9922s
	iters: 300, epoch: 9 | loss: 0.0007500
	speed: 0.0151s/iter; left time: 568.7044s
	iters: 400, epoch: 9 | loss: 0.0004146
	speed: 0.0169s/iter; left time: 635.4184s
Epoch: 9 cost time: 7.314331769943237
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.2237301
	speed: 0.0818s/iter; left time: 3068.0046s
	iters: 200, epoch: 10 | loss: 0.0000366
	speed: 0.0185s/iter; left time: 690.4699s
	iters: 300, epoch: 10 | loss: 0.0108587
	speed: 0.0184s/iter; left time: 687.4235s
	iters: 400, epoch: 10 | loss: 0.0016500
	speed: 0.0215s/iter; left time: 797.6977s
Epoch: 10 cost time: 8.032254219055176
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001960
	speed: 0.0932s/iter; left time: 3453.1665s
	iters: 200, epoch: 11 | loss: 0.0000564
	speed: 0.0182s/iter; left time: 671.8005s
	iters: 300, epoch: 11 | loss: 0.0000973
	speed: 0.0211s/iter; left time: 777.7906s
	iters: 400, epoch: 11 | loss: 0.0010358
	speed: 0.0184s/iter; left time: 675.2537s
Epoch: 11 cost time: 8.448861837387085
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.975897).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0002994
	speed: 0.0908s/iter; left time: 3329.3796s
	iters: 200, epoch: 12 | loss: 0.0000066
	speed: 0.0189s/iter; left time: 690.1366s
	iters: 300, epoch: 12 | loss: 0.0001346
	speed: 0.0199s/iter; left time: 725.8500s
	iters: 400, epoch: 12 | loss: 0.0118923
	speed: 0.0186s/iter; left time: 676.9836s
Epoch: 12 cost time: 8.305107355117798
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0001638
	speed: 0.0765s/iter; left time: 2772.6152s
	iters: 200, epoch: 13 | loss: 0.1060948
	speed: 0.0175s/iter; left time: 631.0832s
	iters: 300, epoch: 13 | loss: 0.3296510
	speed: 0.0173s/iter; left time: 623.0047s
	iters: 400, epoch: 13 | loss: 0.1722992
	speed: 0.0189s/iter; left time: 680.6962s
Epoch: 13 cost time: 7.693937063217163
Epoch: 13, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.961 Test Loss: 0.184 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0011231
	speed: 0.0795s/iter; left time: 2847.8886s
	iters: 200, epoch: 14 | loss: 0.0360114
	speed: 0.0183s/iter; left time: 652.2098s
	iters: 300, epoch: 14 | loss: 0.0014031
	speed: 0.0228s/iter; left time: 811.9796s
	iters: 400, epoch: 14 | loss: 0.0019934
	speed: 0.0201s/iter; left time: 714.1608s
Epoch: 14 cost time: 8.765854120254517
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0002773
	speed: 0.0954s/iter; left time: 3377.5811s
	iters: 200, epoch: 15 | loss: 0.0747787
	speed: 0.0187s/iter; left time: 659.9278s
	iters: 300, epoch: 15 | loss: 0.0010444
	speed: 0.0219s/iter; left time: 771.0962s
	iters: 400, epoch: 15 | loss: 0.0000008
	speed: 0.0168s/iter; left time: 591.6434s
Epoch: 15 cost time: 8.56243109703064
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0003323
	speed: 0.0808s/iter; left time: 2828.9159s
	iters: 200, epoch: 16 | loss: 0.0001333
	speed: 0.0228s/iter; left time: 796.2831s
	iters: 300, epoch: 16 | loss: 0.0000000
	speed: 0.0177s/iter; left time: 616.5587s
	iters: 400, epoch: 16 | loss: 0.0000005
	speed: 0.0164s/iter; left time: 570.2335s
Epoch: 16 cost time: 8.346850395202637
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.966 Test Loss: 0.216 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0000214
	speed: 0.0962s/iter; left time: 3327.8328s
	iters: 200, epoch: 17 | loss: 0.0002357
	speed: 0.0201s/iter; left time: 692.3972s
	iters: 300, epoch: 17 | loss: 0.0000002
	speed: 0.0168s/iter; left time: 576.7804s
	iters: 400, epoch: 17 | loss: 0.0000011
	speed: 0.0167s/iter; left time: 572.1170s
Epoch: 17 cost time: 8.265275478363037
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0015018
	speed: 0.0868s/iter; left time: 2965.7932s
	iters: 200, epoch: 18 | loss: 0.0000143
	speed: 0.0175s/iter; left time: 595.4279s
	iters: 300, epoch: 18 | loss: 0.0000063
	speed: 0.0168s/iter; left time: 570.8710s
	iters: 400, epoch: 18 | loss: 0.0059956
	speed: 0.0164s/iter; left time: 555.9354s
Epoch: 18 cost time: 7.777838468551636
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.960 Test Loss: 0.291 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000967
	speed: 0.0822s/iter; left time: 2775.9665s
	iters: 200, epoch: 19 | loss: 0.0000355
	speed: 0.0178s/iter; left time: 599.6556s
	iters: 300, epoch: 19 | loss: 0.0000000
	speed: 0.0159s/iter; left time: 533.8332s
	iters: 400, epoch: 19 | loss: 0.1607486
	speed: 0.0167s/iter; left time: 558.2778s
Epoch: 19 cost time: 7.571465253829956
Epoch: 19, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000103
	speed: 0.0937s/iter; left time: 3125.8977s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0197s/iter; left time: 654.2028s
	iters: 300, epoch: 20 | loss: 0.0000043
	speed: 0.0199s/iter; left time: 660.5910s
	iters: 400, epoch: 20 | loss: 0.0045906
	speed: 0.0202s/iter; left time: 669.2680s
Epoch: 20 cost time: 8.750778436660767
Epoch: 20, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0001563
	speed: 0.0974s/iter; left time: 3209.2156s
	iters: 200, epoch: 21 | loss: 0.0000038
	speed: 0.0216s/iter; left time: 710.1525s
	iters: 300, epoch: 21 | loss: 0.0004832
	speed: 0.0205s/iter; left time: 671.0877s
	iters: 400, epoch: 21 | loss: 0.0000009
	speed: 0.0231s/iter; left time: 754.9612s
Epoch: 21 cost time: 9.211167812347412
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000822
	speed: 0.0946s/iter; left time: 3078.2685s
	iters: 200, epoch: 22 | loss: 0.0000007
	speed: 0.0177s/iter; left time: 574.7927s
	iters: 300, epoch: 22 | loss: 0.0002510
	speed: 0.0212s/iter; left time: 684.6870s
	iters: 400, epoch: 22 | loss: 0.0000025
	speed: 0.0189s/iter; left time: 609.7855s
Epoch: 22 cost time: 8.392826318740845
Epoch: 22, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000014
	speed: 0.0861s/iter; left time: 2766.1338s
	iters: 200, epoch: 23 | loss: 0.0000020
	speed: 0.0235s/iter; left time: 753.5361s
	iters: 300, epoch: 23 | loss: 0.0030244
	speed: 0.0212s/iter; left time: 677.4216s
	iters: 400, epoch: 23 | loss: 0.0418126
	speed: 0.0194s/iter; left time: 616.8284s
Epoch: 23 cost time: 8.875697135925293
Epoch: 23, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0000088
	speed: 0.0831s/iter; left time: 2634.9487s
	iters: 200, epoch: 24 | loss: 0.0000012
	speed: 0.0184s/iter; left time: 580.5066s
	iters: 300, epoch: 24 | loss: 0.0000000
	speed: 0.0157s/iter; left time: 495.6707s
	iters: 400, epoch: 24 | loss: 0.0000091
	speed: 0.0195s/iter; left time: 612.1468s
Epoch: 24 cost time: 7.691132068634033
Epoch: 24, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.961 Test Loss: 0.281 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.4365092
	speed: 0.0840s/iter; left time: 2629.2290s
	iters: 200, epoch: 25 | loss: 0.0000062
	speed: 0.0176s/iter; left time: 548.0264s
	iters: 300, epoch: 25 | loss: 0.0000020
	speed: 0.0184s/iter; left time: 571.8802s
	iters: 400, epoch: 25 | loss: 0.0000060
	speed: 0.0174s/iter; left time: 540.0117s
Epoch: 25 cost time: 8.078223466873169
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.962 Test Loss: 0.282 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 53117
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1130962
	speed: 0.0417s/iter; left time: 1716.6275s
	iters: 200, epoch: 1 | loss: 0.2289751
	speed: 0.0190s/iter; left time: 778.9183s
	iters: 300, epoch: 1 | loss: 0.0932752
	speed: 0.0167s/iter; left time: 685.6750s
	iters: 400, epoch: 1 | loss: 0.0576798
	speed: 0.0160s/iter; left time: 655.1685s
Epoch: 1 cost time: 9.690526008605957
Epoch: 1, Steps: 413 | Train Loss: 0.708 Vali Loss: 0.132 Vali Acc: 0.955 Test Loss: 0.132 Test Acc: 0.955
Validation loss decreased (inf --> -0.954523).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0383280
	speed: 0.0936s/iter; left time: 3818.2569s
	iters: 200, epoch: 2 | loss: 0.1558993
	speed: 0.0173s/iter; left time: 705.8978s
	iters: 300, epoch: 2 | loss: 0.2610354
	speed: 0.0186s/iter; left time: 753.0463s
	iters: 400, epoch: 2 | loss: 0.0603150
	speed: 0.0191s/iter; left time: 772.1330s
Epoch: 2 cost time: 8.221794366836548
Epoch: 2, Steps: 413 | Train Loss: 0.118 Vali Loss: 0.097 Vali Acc: 0.966 Test Loss: 0.097 Test Acc: 0.966
Validation loss decreased (-0.954523 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0163698
	speed: 0.0916s/iter; left time: 3697.0697s
	iters: 200, epoch: 3 | loss: 0.0772227
	speed: 0.0198s/iter; left time: 797.6154s
	iters: 300, epoch: 3 | loss: 0.0806659
	speed: 0.0177s/iter; left time: 709.2617s
	iters: 400, epoch: 3 | loss: 0.0017182
	speed: 0.0166s/iter; left time: 664.9299s
Epoch: 3 cost time: 7.842293739318848
Epoch: 3, Steps: 413 | Train Loss: 0.087 Vali Loss: 0.103 Vali Acc: 0.964 Test Loss: 0.103 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0015436
	speed: 0.0876s/iter; left time: 3500.2554s
	iters: 200, epoch: 4 | loss: 0.1035070
	speed: 0.0167s/iter; left time: 664.0842s
	iters: 300, epoch: 4 | loss: 0.1866073
	speed: 0.0148s/iter; left time: 589.4081s
	iters: 400, epoch: 4 | loss: 0.2747616
	speed: 0.0153s/iter; left time: 606.7975s
Epoch: 4 cost time: 7.093502759933472
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.068 Vali Acc: 0.975 Test Loss: 0.068 Test Acc: 0.975
Validation loss decreased (-0.965893 --> -0.975443).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0377399
	speed: 0.0750s/iter; left time: 2964.5464s
	iters: 200, epoch: 5 | loss: 0.0005569
	speed: 0.0136s/iter; left time: 537.7870s
	iters: 300, epoch: 5 | loss: 0.0060071
	speed: 0.0129s/iter; left time: 508.4079s
	iters: 400, epoch: 5 | loss: 0.0293029
	speed: 0.0149s/iter; left time: 586.1684s
Epoch: 5 cost time: 6.208389043807983
Epoch: 5, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.065 Vali Acc: 0.975 Test Loss: 0.065 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0000805
	speed: 0.0827s/iter; left time: 3237.5343s
	iters: 200, epoch: 6 | loss: 0.0125617
	speed: 0.0171s/iter; left time: 668.1508s
	iters: 300, epoch: 6 | loss: 0.0001792
	speed: 0.0191s/iter; left time: 741.7597s
	iters: 400, epoch: 6 | loss: 0.0016444
	speed: 0.0180s/iter; left time: 697.6747s
Epoch: 6 cost time: 7.882840394973755
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.975443 --> -0.976352).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0026025
	speed: 0.0967s/iter; left time: 3744.3893s
	iters: 200, epoch: 7 | loss: 0.0089066
	speed: 0.0195s/iter; left time: 754.2741s
	iters: 300, epoch: 7 | loss: 0.0048578
	speed: 0.0202s/iter; left time: 777.0923s
	iters: 400, epoch: 7 | loss: 0.2238641
	speed: 0.0187s/iter; left time: 717.7283s
Epoch: 7 cost time: 8.710414171218872
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0538966
	speed: 0.0904s/iter; left time: 3464.6500s
	iters: 200, epoch: 8 | loss: 0.0006234
	speed: 0.0173s/iter; left time: 662.6949s
	iters: 300, epoch: 8 | loss: 0.0522673
	speed: 0.0166s/iter; left time: 631.0196s
	iters: 400, epoch: 8 | loss: 0.0656234
	speed: 0.0168s/iter; left time: 640.4063s
Epoch: 8 cost time: 7.637268781661987
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0008804
	speed: 0.0864s/iter; left time: 3272.7847s
	iters: 200, epoch: 9 | loss: 0.0000082
	speed: 0.0194s/iter; left time: 732.9770s
	iters: 300, epoch: 9 | loss: 0.0062076
	speed: 0.0174s/iter; left time: 655.0951s
	iters: 400, epoch: 9 | loss: 0.0017922
	speed: 0.0183s/iter; left time: 688.7158s
Epoch: 9 cost time: 7.906742334365845
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0229608
	speed: 0.0858s/iter; left time: 3215.5784s
	iters: 200, epoch: 10 | loss: 0.0173070
	speed: 0.0175s/iter; left time: 655.1441s
	iters: 300, epoch: 10 | loss: 0.0001923
	speed: 0.0165s/iter; left time: 614.1896s
	iters: 400, epoch: 10 | loss: 0.0001470
	speed: 0.0184s/iter; left time: 685.4780s
Epoch: 10 cost time: 7.731035232543945
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0480837
	speed: 0.0789s/iter; left time: 2924.1279s
	iters: 200, epoch: 11 | loss: 0.0001159
	speed: 0.0175s/iter; left time: 646.7588s
	iters: 300, epoch: 11 | loss: 0.0001523
	speed: 0.0198s/iter; left time: 730.1524s
	iters: 400, epoch: 11 | loss: 0.0003539
	speed: 0.0170s/iter; left time: 624.8767s
Epoch: 11 cost time: 7.941016912460327
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0025395
	speed: 0.0813s/iter; left time: 2980.2829s
	iters: 200, epoch: 12 | loss: 0.0004219
	speed: 0.0162s/iter; left time: 593.5419s
	iters: 300, epoch: 12 | loss: 0.0020283
	speed: 0.0145s/iter; left time: 528.3240s
	iters: 400, epoch: 12 | loss: 0.0013121
	speed: 0.0145s/iter; left time: 527.6028s
Epoch: 12 cost time: 6.888319969177246
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.960 Test Loss: 0.207 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0004015
	speed: 0.0766s/iter; left time: 2775.6997s
	iters: 200, epoch: 13 | loss: 0.0016793
	speed: 0.0166s/iter; left time: 599.0865s
	iters: 300, epoch: 13 | loss: 0.0018117
	speed: 0.0170s/iter; left time: 614.0062s
	iters: 400, epoch: 13 | loss: 0.0000771
	speed: 0.0150s/iter; left time: 540.6292s
Epoch: 13 cost time: 7.296813726425171
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976352 --> -0.976807).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0160645
	speed: 0.0780s/iter; left time: 2794.9047s
	iters: 200, epoch: 14 | loss: 0.0007049
	speed: 0.0161s/iter; left time: 575.2450s
	iters: 300, epoch: 14 | loss: 0.0000067
	speed: 0.0165s/iter; left time: 588.7154s
	iters: 400, epoch: 14 | loss: 0.0018560
	speed: 0.0173s/iter; left time: 614.0228s
Epoch: 14 cost time: 7.451857566833496
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0077272
	speed: 0.0863s/iter; left time: 3056.1521s
	iters: 200, epoch: 15 | loss: 0.0000064
	speed: 0.0167s/iter; left time: 590.4292s
	iters: 300, epoch: 15 | loss: 0.0166811
	speed: 0.0168s/iter; left time: 591.8190s
	iters: 400, epoch: 15 | loss: 0.0000628
	speed: 0.0210s/iter; left time: 738.6204s
Epoch: 15 cost time: 7.9769370555877686
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.964 Test Loss: 0.170 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0004524
	speed: 0.0876s/iter; left time: 3068.1744s
	iters: 200, epoch: 16 | loss: 0.0000341
	speed: 0.0205s/iter; left time: 717.0736s
	iters: 300, epoch: 16 | loss: 0.0011511
	speed: 0.0193s/iter; left time: 672.3544s
	iters: 400, epoch: 16 | loss: 0.0000002
	speed: 0.0185s/iter; left time: 641.5148s
Epoch: 16 cost time: 8.395604133605957
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.140 Vali Acc: 0.972 Test Loss: 0.140 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0004979
	speed: 0.0840s/iter; left time: 2904.8457s
	iters: 200, epoch: 17 | loss: 0.0000096
	speed: 0.0174s/iter; left time: 599.9598s
	iters: 300, epoch: 17 | loss: 0.0000180
	speed: 0.0149s/iter; left time: 513.7853s
	iters: 400, epoch: 17 | loss: 0.0000058
	speed: 0.0155s/iter; left time: 532.5234s
Epoch: 17 cost time: 7.2970287799835205
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000935
	speed: 0.0721s/iter; left time: 2465.6052s
	iters: 200, epoch: 18 | loss: 0.0036417
	speed: 0.0178s/iter; left time: 605.1128s
	iters: 300, epoch: 18 | loss: 0.0000375
	speed: 0.0180s/iter; left time: 610.2964s
	iters: 400, epoch: 18 | loss: 0.0005305
	speed: 0.0135s/iter; left time: 455.8958s
Epoch: 18 cost time: 7.1631059646606445
Epoch: 18, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000049
	speed: 0.0746s/iter; left time: 2517.3532s
	iters: 200, epoch: 19 | loss: 0.0000501
	speed: 0.0169s/iter; left time: 568.0912s
	iters: 300, epoch: 19 | loss: 0.0002258
	speed: 0.0148s/iter; left time: 497.0038s
	iters: 400, epoch: 19 | loss: 0.0111526
	speed: 0.0149s/iter; left time: 498.7109s
Epoch: 19 cost time: 6.836593151092529
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.258 Vali Acc: 0.959 Test Loss: 0.258 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.0822s/iter; left time: 2741.3097s
	iters: 200, epoch: 20 | loss: 0.0000078
	speed: 0.0183s/iter; left time: 607.6742s
	iters: 300, epoch: 20 | loss: 0.0006206
	speed: 0.0177s/iter; left time: 588.0731s
	iters: 400, epoch: 20 | loss: 0.0000045
	speed: 0.0162s/iter; left time: 536.4278s
Epoch: 20 cost time: 7.742933988571167
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0000003
	speed: 0.0823s/iter; left time: 2710.2909s
	iters: 200, epoch: 21 | loss: 0.0000095
	speed: 0.0169s/iter; left time: 554.2940s
	iters: 300, epoch: 21 | loss: 0.0020429
	speed: 0.0191s/iter; left time: 626.7818s
	iters: 400, epoch: 21 | loss: 0.0000005
	speed: 0.0150s/iter; left time: 488.2079s
Epoch: 21 cost time: 7.521578311920166
Epoch: 21, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000019
	speed: 0.0805s/iter; left time: 2619.6798s
	iters: 200, epoch: 22 | loss: 0.0000529
	speed: 0.0151s/iter; left time: 490.0390s
	iters: 300, epoch: 22 | loss: 0.0157529
	speed: 0.0163s/iter; left time: 527.8996s
	iters: 400, epoch: 22 | loss: 0.0000010
	speed: 0.0167s/iter; left time: 538.7729s
Epoch: 22 cost time: 7.391561508178711
Epoch: 22, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.265 Vali Acc: 0.960 Test Loss: 0.265 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000005
	speed: 0.0820s/iter; left time: 2632.3728s
	iters: 200, epoch: 23 | loss: 0.0000016
	speed: 0.0216s/iter; left time: 690.6181s
	iters: 300, epoch: 23 | loss: 0.0005820
	speed: 0.0164s/iter; left time: 524.4688s
	iters: 400, epoch: 23 | loss: 0.0761821
	speed: 0.0171s/iter; left time: 542.9933s
Epoch: 23 cost time: 8.04096269607544
Epoch: 23, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.965 Test Loss: 0.231 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 52518
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4907508
	speed: 0.0299s/iter; left time: 1230.8913s
	iters: 200, epoch: 1 | loss: 0.5171664
	speed: 0.0165s/iter; left time: 676.3835s
	iters: 300, epoch: 1 | loss: 0.2264514
	speed: 0.0146s/iter; left time: 600.1408s
	iters: 400, epoch: 1 | loss: 0.0589789
	speed: 0.0163s/iter; left time: 667.4758s
Epoch: 1 cost time: 8.016645431518555
Epoch: 1, Steps: 413 | Train Loss: 0.729 Vali Loss: 0.140 Vali Acc: 0.949 Test Loss: 0.140 Test Acc: 0.949
Validation loss decreased (inf --> -0.948612).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0938404
	speed: 0.0715s/iter; left time: 2914.9451s
	iters: 200, epoch: 2 | loss: 0.1045974
	speed: 0.0167s/iter; left time: 678.5643s
	iters: 300, epoch: 2 | loss: 0.0042154
	speed: 0.0163s/iter; left time: 662.7397s
	iters: 400, epoch: 2 | loss: 0.1443990
	speed: 0.0152s/iter; left time: 616.5413s
Epoch: 2 cost time: 7.1340672969818115
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
Validation loss decreased (-0.948612 --> -0.971805).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0053642
	speed: 0.0725s/iter; left time: 2928.3265s
	iters: 200, epoch: 3 | loss: 0.0520327
	speed: 0.0173s/iter; left time: 696.6859s
	iters: 300, epoch: 3 | loss: 0.0423390
	speed: 0.0164s/iter; left time: 659.2826s
	iters: 400, epoch: 3 | loss: 0.0036272
	speed: 0.0175s/iter; left time: 702.9916s
Epoch: 3 cost time: 7.281039714813232
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.092 Vali Acc: 0.960 Test Loss: 0.092 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0027632
	speed: 0.0825s/iter; left time: 3296.3085s
	iters: 200, epoch: 4 | loss: 0.0005976
	speed: 0.0166s/iter; left time: 661.8986s
	iters: 300, epoch: 4 | loss: 0.1287591
	speed: 0.0183s/iter; left time: 726.5538s
	iters: 400, epoch: 4 | loss: 0.1079029
	speed: 0.0180s/iter; left time: 715.5225s
Epoch: 4 cost time: 7.7332212924957275
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.078 Vali Acc: 0.970 Test Loss: 0.078 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012521
	speed: 0.0813s/iter; left time: 3214.0294s
	iters: 200, epoch: 5 | loss: 0.2773295
	speed: 0.0169s/iter; left time: 665.9275s
	iters: 300, epoch: 5 | loss: 0.0003831
	speed: 0.0172s/iter; left time: 675.2175s
	iters: 400, epoch: 5 | loss: 0.0018488
	speed: 0.0168s/iter; left time: 660.2452s
Epoch: 5 cost time: 7.551559925079346
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0219065
	speed: 0.0713s/iter; left time: 2791.7386s
	iters: 200, epoch: 6 | loss: 0.0007343
	speed: 0.0173s/iter; left time: 676.7107s
	iters: 300, epoch: 6 | loss: 0.1278173
	speed: 0.0143s/iter; left time: 558.4256s
	iters: 400, epoch: 6 | loss: 0.0001023
	speed: 0.0156s/iter; left time: 606.5562s
Epoch: 6 cost time: 6.755309104919434
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.072 Vali Acc: 0.976 Test Loss: 0.072 Test Acc: 0.976
Validation loss decreased (-0.971805 --> -0.976352).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0000690
	speed: 0.0666s/iter; left time: 2577.8349s
	iters: 200, epoch: 7 | loss: 0.0086197
	speed: 0.0181s/iter; left time: 697.4135s
	iters: 300, epoch: 7 | loss: 0.0072431
	speed: 0.0147s/iter; left time: 565.5981s
	iters: 400, epoch: 7 | loss: 0.1376668
	speed: 0.0157s/iter; left time: 602.5611s
Epoch: 7 cost time: 6.957238435745239
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.094 Vali Acc: 0.975 Test Loss: 0.094 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0055281
	speed: 0.0695s/iter; left time: 2662.0667s
	iters: 200, epoch: 8 | loss: 0.0009102
	speed: 0.0179s/iter; left time: 684.0680s
	iters: 300, epoch: 8 | loss: 0.0120466
	speed: 0.0173s/iter; left time: 658.5821s
	iters: 400, epoch: 8 | loss: 0.0029490
	speed: 0.0175s/iter; left time: 665.0323s
Epoch: 8 cost time: 7.334228754043579
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0002788
	speed: 0.0775s/iter; left time: 2936.7179s
	iters: 200, epoch: 9 | loss: 0.0041115
	speed: 0.0174s/iter; left time: 657.9145s
	iters: 300, epoch: 9 | loss: 0.0058714
	speed: 0.0166s/iter; left time: 625.7932s
	iters: 400, epoch: 9 | loss: 0.1723116
	speed: 0.0177s/iter; left time: 666.1598s
Epoch: 9 cost time: 7.582779169082642
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.966 Test Loss: 0.110 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002385
	speed: 0.0780s/iter; left time: 2922.9742s
	iters: 200, epoch: 10 | loss: 0.0008431
	speed: 0.0170s/iter; left time: 635.1414s
	iters: 300, epoch: 10 | loss: 0.0026414
	speed: 0.0154s/iter; left time: 573.4767s
	iters: 400, epoch: 10 | loss: 0.0015336
	speed: 0.0162s/iter; left time: 600.7775s
Epoch: 10 cost time: 7.215626955032349
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0030631
	speed: 0.0810s/iter; left time: 3000.9760s
	iters: 200, epoch: 11 | loss: 0.0168678
	speed: 0.0180s/iter; left time: 666.7332s
	iters: 300, epoch: 11 | loss: 0.0002377
	speed: 0.0179s/iter; left time: 660.8243s
	iters: 400, epoch: 11 | loss: 0.0009355
	speed: 0.0190s/iter; left time: 698.2871s
Epoch: 11 cost time: 8.060821771621704
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.082 Vali Acc: 0.980 Test Loss: 0.082 Test Acc: 0.980
Validation loss decreased (-0.976352 --> -0.979990).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0005999
	speed: 0.0822s/iter; left time: 3013.4381s
	iters: 200, epoch: 12 | loss: 0.0524878
	speed: 0.0163s/iter; left time: 595.7900s
	iters: 300, epoch: 12 | loss: 0.0017454
	speed: 0.0159s/iter; left time: 577.9222s
	iters: 400, epoch: 12 | loss: 0.0000364
	speed: 0.0155s/iter; left time: 564.5680s
Epoch: 12 cost time: 7.223861455917358
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0000675
	speed: 0.0743s/iter; left time: 2692.6316s
	iters: 200, epoch: 13 | loss: 0.0001136
	speed: 0.0163s/iter; left time: 589.6983s
	iters: 300, epoch: 13 | loss: 0.0014124
	speed: 0.0155s/iter; left time: 559.3364s
	iters: 400, epoch: 13 | loss: 0.0013456
	speed: 0.0140s/iter; left time: 503.4140s
Epoch: 13 cost time: 6.9627509117126465
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0001233
	speed: 0.0682s/iter; left time: 2445.2787s
	iters: 200, epoch: 14 | loss: 0.0001355
	speed: 0.0156s/iter; left time: 556.2690s
	iters: 300, epoch: 14 | loss: 0.0001159
	speed: 0.0159s/iter; left time: 568.0771s
	iters: 400, epoch: 14 | loss: 0.0243135
	speed: 0.0140s/iter; left time: 496.5751s
Epoch: 14 cost time: 6.702022314071655
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0000043
	speed: 0.0738s/iter; left time: 2615.0847s
	iters: 200, epoch: 15 | loss: 0.0008671
	speed: 0.0164s/iter; left time: 578.1291s
	iters: 300, epoch: 15 | loss: 0.0010820
	speed: 0.0181s/iter; left time: 636.0462s
	iters: 400, epoch: 15 | loss: 0.0000247
	speed: 0.0157s/iter; left time: 550.1338s
Epoch: 15 cost time: 7.325356483459473
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000616
	speed: 0.0778s/iter; left time: 2721.7733s
	iters: 200, epoch: 16 | loss: 0.0001233
	speed: 0.0184s/iter; left time: 643.0279s
	iters: 300, epoch: 16 | loss: 0.0000003
	speed: 0.0169s/iter; left time: 588.0524s
	iters: 400, epoch: 16 | loss: 0.0003900
	speed: 0.0160s/iter; left time: 555.4263s
Epoch: 16 cost time: 7.36668062210083
Epoch: 16, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0013548
	speed: 0.0708s/iter; left time: 2450.8067s
	iters: 200, epoch: 17 | loss: 0.0008684
	speed: 0.0172s/iter; left time: 593.9964s
	iters: 300, epoch: 17 | loss: 0.0000023
	speed: 0.0163s/iter; left time: 561.1604s
	iters: 400, epoch: 17 | loss: 0.0000128
	speed: 0.0152s/iter; left time: 521.5591s
Epoch: 17 cost time: 7.137763261795044
Epoch: 17, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0096232
	speed: 0.0657s/iter; left time: 2246.1709s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0150s/iter; left time: 510.4790s
	iters: 300, epoch: 18 | loss: 0.0000089
	speed: 0.0157s/iter; left time: 533.4393s
	iters: 400, epoch: 18 | loss: 0.0000243
	speed: 0.0166s/iter; left time: 563.0301s
Epoch: 18 cost time: 6.831657886505127
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0000338
	speed: 0.0654s/iter; left time: 2209.8186s
	iters: 200, epoch: 19 | loss: 0.0000365
	speed: 0.0142s/iter; left time: 477.7936s
	iters: 300, epoch: 19 | loss: 0.0004878
	speed: 0.0141s/iter; left time: 474.1867s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0143s/iter; left time: 479.1968s
Epoch: 19 cost time: 6.318928956985474
Epoch: 19, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0003132
	speed: 0.0734s/iter; left time: 2449.5094s
	iters: 200, epoch: 20 | loss: 0.0000030
	speed: 0.0164s/iter; left time: 544.8387s
	iters: 300, epoch: 20 | loss: 0.0000001
	speed: 0.0166s/iter; left time: 551.5397s
	iters: 400, epoch: 20 | loss: 0.0000005
	speed: 0.0145s/iter; left time: 479.6796s
Epoch: 20 cost time: 7.070657014846802
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000018
	speed: 0.0653s/iter; left time: 2151.5403s
	iters: 200, epoch: 21 | loss: 0.0007801
	speed: 0.0145s/iter; left time: 475.2549s
	iters: 300, epoch: 21 | loss: 0.0008405
	speed: 0.0145s/iter; left time: 473.8647s
	iters: 400, epoch: 21 | loss: 0.0000011
	speed: 0.0150s/iter; left time: 488.4884s
Epoch: 21 cost time: 6.444300651550293
Epoch: 21, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 51807
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0725850
	speed: 0.0319s/iter; left time: 1316.2222s
	iters: 200, epoch: 1 | loss: 0.3266611
	speed: 0.0175s/iter; left time: 721.2956s
	iters: 300, epoch: 1 | loss: 0.0706854
	speed: 0.0162s/iter; left time: 663.6703s
	iters: 400, epoch: 1 | loss: 0.0588730
	speed: 0.0156s/iter; left time: 638.7370s
Epoch: 1 cost time: 8.42152738571167
Epoch: 1, Steps: 413 | Train Loss: 0.730 Vali Loss: 0.135 Vali Acc: 0.956 Test Loss: 0.135 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0455132
	speed: 0.0746s/iter; left time: 3042.1615s
	iters: 200, epoch: 2 | loss: 0.0471189
	speed: 0.0153s/iter; left time: 622.6518s
	iters: 300, epoch: 2 | loss: 0.0073815
	speed: 0.0153s/iter; left time: 620.3820s
	iters: 400, epoch: 2 | loss: 0.1351963
	speed: 0.0154s/iter; left time: 623.9253s
Epoch: 2 cost time: 6.875385284423828
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.144 Vali Acc: 0.953 Test Loss: 0.144 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.0254113
	speed: 0.0613s/iter; left time: 2474.2063s
	iters: 200, epoch: 3 | loss: 0.0130177
	speed: 0.0138s/iter; left time: 554.8700s
	iters: 300, epoch: 3 | loss: 0.1079419
	speed: 0.0142s/iter; left time: 570.4622s
	iters: 400, epoch: 3 | loss: 0.2080297
	speed: 0.0134s/iter; left time: 538.1818s
Epoch: 3 cost time: 6.180171489715576
Epoch: 3, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.124 Vali Acc: 0.960 Test Loss: 0.124 Test Acc: 0.960
Validation loss decreased (-0.955888 --> -0.960435).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0027759
	speed: 0.0592s/iter; left time: 2366.4768s
	iters: 200, epoch: 4 | loss: 0.0288569
	speed: 0.0134s/iter; left time: 533.1978s
	iters: 300, epoch: 4 | loss: 0.0011372
	speed: 0.0174s/iter; left time: 692.9479s
	iters: 400, epoch: 4 | loss: 0.0135679
	speed: 0.0140s/iter; left time: 556.8170s
Epoch: 4 cost time: 6.485922574996948
Epoch: 4, Steps: 413 | Train Loss: 0.058 Vali Loss: 0.100 Vali Acc: 0.971 Test Loss: 0.100 Test Acc: 0.971
Validation loss decreased (-0.960435 --> -0.971350).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0517061
	speed: 0.0635s/iter; left time: 2510.9650s
	iters: 200, epoch: 5 | loss: 0.0440552
	speed: 0.0183s/iter; left time: 721.8696s
	iters: 300, epoch: 5 | loss: 0.0447695
	speed: 0.0182s/iter; left time: 715.9522s
	iters: 400, epoch: 5 | loss: 0.0111720
	speed: 0.0164s/iter; left time: 641.9470s
Epoch: 5 cost time: 7.585452556610107
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.950 Test Loss: 0.181 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0004010
	speed: 0.0825s/iter; left time: 3227.8339s
	iters: 200, epoch: 6 | loss: 0.0100058
	speed: 0.0187s/iter; left time: 731.7758s
	iters: 300, epoch: 6 | loss: 0.0001305
	speed: 0.0152s/iter; left time: 591.1622s
	iters: 400, epoch: 6 | loss: 0.0062026
	speed: 0.0171s/iter; left time: 665.4569s
Epoch: 6 cost time: 7.665593385696411
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0035199
	speed: 0.0924s/iter; left time: 3579.5860s
	iters: 200, epoch: 7 | loss: 0.0084810
	speed: 0.0183s/iter; left time: 706.9507s
	iters: 300, epoch: 7 | loss: 0.0087346
	speed: 0.0173s/iter; left time: 667.8480s
	iters: 400, epoch: 7 | loss: 0.0005237
	speed: 0.0169s/iter; left time: 649.0032s
Epoch: 7 cost time: 8.083073377609253
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0009895
	speed: 0.0830s/iter; left time: 3179.5419s
	iters: 200, epoch: 8 | loss: 0.0002877
	speed: 0.0163s/iter; left time: 621.1203s
	iters: 300, epoch: 8 | loss: 0.1504465
	speed: 0.0151s/iter; left time: 574.1294s
	iters: 400, epoch: 8 | loss: 0.0707271
	speed: 0.0192s/iter; left time: 729.6368s
Epoch: 8 cost time: 7.483933925628662
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0143174
	speed: 0.0673s/iter; left time: 2551.3595s
	iters: 200, epoch: 9 | loss: 0.0007952
	speed: 0.0130s/iter; left time: 490.0399s
	iters: 300, epoch: 9 | loss: 0.0036381
	speed: 0.0143s/iter; left time: 540.1361s
	iters: 400, epoch: 9 | loss: 0.0093160
	speed: 0.0135s/iter; left time: 505.7109s
Epoch: 9 cost time: 6.109915256500244
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0006991
	speed: 0.0703s/iter; left time: 2635.2820s
	iters: 200, epoch: 10 | loss: 0.0094338
	speed: 0.0173s/iter; left time: 646.7540s
	iters: 300, epoch: 10 | loss: 0.0666829
	speed: 0.0147s/iter; left time: 549.8246s
	iters: 400, epoch: 10 | loss: 0.0000465
	speed: 0.0153s/iter; left time: 569.8748s
Epoch: 10 cost time: 7.0221662521362305
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000194
	speed: 0.0715s/iter; left time: 2649.6949s
	iters: 200, epoch: 11 | loss: 0.0018511
	speed: 0.0160s/iter; left time: 592.1272s
	iters: 300, epoch: 11 | loss: 0.0024422
	speed: 0.0158s/iter; left time: 581.1513s
	iters: 400, epoch: 11 | loss: 0.0050583
	speed: 0.0149s/iter; left time: 548.3298s
Epoch: 11 cost time: 7.1402857303619385
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0015448
	speed: 0.0700s/iter; left time: 2566.8833s
	iters: 200, epoch: 12 | loss: 0.0015989
	speed: 0.0176s/iter; left time: 644.1302s
	iters: 300, epoch: 12 | loss: 0.0005312
	speed: 0.0173s/iter; left time: 630.1610s
	iters: 400, epoch: 12 | loss: 0.0005524
	speed: 0.0145s/iter; left time: 528.8000s
Epoch: 12 cost time: 7.37554144859314
Epoch: 12, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1612110
	speed: 0.0827s/iter; left time: 2996.8745s
	iters: 200, epoch: 13 | loss: 0.0008141
	speed: 0.0190s/iter; left time: 685.7706s
	iters: 300, epoch: 13 | loss: 0.0001487
	speed: 0.0168s/iter; left time: 606.2719s
	iters: 400, epoch: 13 | loss: 0.0004783
	speed: 0.0148s/iter; left time: 532.8217s
Epoch: 13 cost time: 7.411619424819946
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0001413
	speed: 0.0790s/iter; left time: 2832.3824s
	iters: 200, epoch: 14 | loss: 0.0001868
	speed: 0.0178s/iter; left time: 634.5701s
	iters: 300, epoch: 14 | loss: 0.0149804
	speed: 0.0155s/iter; left time: 553.9303s
	iters: 400, epoch: 14 | loss: 0.0050688
	speed: 0.0152s/iter; left time: 540.2052s
Epoch: 14 cost time: 7.1817474365234375
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9713506139154161
model parameter : 51542
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0249438
	speed: 0.0281s/iter; left time: 1156.0397s
	iters: 200, epoch: 1 | loss: 0.3701263
	speed: 0.0137s/iter; left time: 563.9520s
	iters: 300, epoch: 1 | loss: 0.7350327
	speed: 0.0139s/iter; left time: 569.1000s
	iters: 400, epoch: 1 | loss: 0.1274455
	speed: 0.0137s/iter; left time: 560.4361s
Epoch: 1 cost time: 7.191977262496948
Epoch: 1, Steps: 413 | Train Loss: 0.710 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (inf --> -0.950885).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.4285780
	speed: 0.0662s/iter; left time: 2701.1816s
	iters: 200, epoch: 2 | loss: 0.0077345
	speed: 0.0150s/iter; left time: 610.0331s
	iters: 300, epoch: 2 | loss: 0.0287143
	speed: 0.0162s/iter; left time: 656.7559s
	iters: 400, epoch: 2 | loss: 0.0126110
	speed: 0.0190s/iter; left time: 770.6651s
Epoch: 2 cost time: 7.204270601272583
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.950885 --> -0.959071).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0099090
	speed: 0.0784s/iter; left time: 3163.6035s
	iters: 200, epoch: 3 | loss: 0.0881614
	speed: 0.0182s/iter; left time: 732.6696s
	iters: 300, epoch: 3 | loss: 0.1076844
	speed: 0.0170s/iter; left time: 681.0639s
	iters: 400, epoch: 3 | loss: 0.0043760
	speed: 0.0167s/iter; left time: 669.9981s
Epoch: 3 cost time: 7.502376079559326
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.098 Vali Acc: 0.969 Test Loss: 0.098 Test Acc: 0.969
Validation loss decreased (-0.959071 --> -0.968621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0029239
	speed: 0.0780s/iter; left time: 3118.5997s
	iters: 200, epoch: 4 | loss: 0.0006135
	speed: 0.0164s/iter; left time: 652.0862s
	iters: 300, epoch: 4 | loss: 0.0165441
	speed: 0.0153s/iter; left time: 609.0466s
	iters: 400, epoch: 4 | loss: 0.1144293
	speed: 0.0162s/iter; left time: 640.5686s
Epoch: 4 cost time: 6.98171329498291
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.100 Vali Acc: 0.965 Test Loss: 0.100 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1308471
	speed: 0.0679s/iter; left time: 2686.0863s
	iters: 200, epoch: 5 | loss: 0.0082938
	speed: 0.0157s/iter; left time: 617.5049s
	iters: 300, epoch: 5 | loss: 0.0108721
	speed: 0.0178s/iter; left time: 699.0672s
	iters: 400, epoch: 5 | loss: 0.0580069
	speed: 0.0168s/iter; left time: 658.7808s
Epoch: 5 cost time: 7.271852731704712
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.968621 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0035189
	speed: 0.0623s/iter; left time: 2437.0766s
	iters: 200, epoch: 6 | loss: 0.0161984
	speed: 0.0152s/iter; left time: 594.0685s
	iters: 300, epoch: 6 | loss: 0.0091729
	speed: 0.0139s/iter; left time: 541.7964s
	iters: 400, epoch: 6 | loss: 0.0023703
	speed: 0.0139s/iter; left time: 538.1942s
Epoch: 6 cost time: 6.370094299316406
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0007148
	speed: 0.0614s/iter; left time: 2379.4333s
	iters: 200, epoch: 7 | loss: 0.0018304
	speed: 0.0138s/iter; left time: 534.5300s
	iters: 300, epoch: 7 | loss: 0.0002301
	speed: 0.0153s/iter; left time: 591.0353s
	iters: 400, epoch: 7 | loss: 0.0402573
	speed: 0.0139s/iter; left time: 535.7369s
Epoch: 7 cost time: 6.515862464904785
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0018552
	speed: 0.0614s/iter; left time: 2352.6735s
	iters: 200, epoch: 8 | loss: 0.0000860
	speed: 0.0171s/iter; left time: 651.8379s
	iters: 300, epoch: 8 | loss: 0.1339941
	speed: 0.0166s/iter; left time: 634.2464s
	iters: 400, epoch: 8 | loss: 0.4321197
	speed: 0.0156s/iter; left time: 594.8374s
Epoch: 8 cost time: 7.208693504333496
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0068099
	speed: 0.0793s/iter; left time: 3006.2870s
	iters: 200, epoch: 9 | loss: 0.0026827
	speed: 0.0185s/iter; left time: 697.9775s
	iters: 300, epoch: 9 | loss: 0.0004116
	speed: 0.0166s/iter; left time: 624.8308s
	iters: 400, epoch: 9 | loss: 0.0007143
	speed: 0.0155s/iter; left time: 581.6765s
Epoch: 9 cost time: 7.444534778594971
Epoch: 9, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0682855
	speed: 0.0735s/iter; left time: 2753.8847s
	iters: 200, epoch: 10 | loss: 0.0021943
	speed: 0.0147s/iter; left time: 548.9710s
	iters: 300, epoch: 10 | loss: 0.6015164
	speed: 0.0182s/iter; left time: 679.3254s
	iters: 400, epoch: 10 | loss: 0.0027069
	speed: 0.0149s/iter; left time: 553.3865s
Epoch: 10 cost time: 7.0238964557647705
Epoch: 10, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000307
	speed: 0.0739s/iter; left time: 2738.0428s
	iters: 200, epoch: 11 | loss: 0.0037124
	speed: 0.0167s/iter; left time: 616.3406s
	iters: 300, epoch: 11 | loss: 0.0000555
	speed: 0.0151s/iter; left time: 556.0965s
	iters: 400, epoch: 11 | loss: 0.0000043
	speed: 0.0149s/iter; left time: 549.4168s
Epoch: 11 cost time: 6.924868583679199
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0017908
	speed: 0.0733s/iter; left time: 2688.1442s
	iters: 200, epoch: 12 | loss: 0.0010563
	speed: 0.0144s/iter; left time: 527.2647s
	iters: 300, epoch: 12 | loss: 0.0113691
	speed: 0.0135s/iter; left time: 493.1267s
	iters: 400, epoch: 12 | loss: 0.0000003
	speed: 0.0122s/iter; left time: 441.8207s
Epoch: 12 cost time: 6.227318286895752
Epoch: 12, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0189337
	speed: 0.0688s/iter; left time: 2492.4237s
	iters: 200, epoch: 13 | loss: 0.0000012
	speed: 0.0139s/iter; left time: 502.7874s
	iters: 300, epoch: 13 | loss: 0.0060694
	speed: 0.0137s/iter; left time: 493.4223s
	iters: 400, epoch: 13 | loss: 0.0000574
	speed: 0.0137s/iter; left time: 492.2970s
Epoch: 13 cost time: 6.171489477157593
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0026236
	speed: 0.0648s/iter; left time: 2322.5380s
	iters: 200, epoch: 14 | loss: 0.1096436
	speed: 0.0147s/iter; left time: 525.4545s
	iters: 300, epoch: 14 | loss: 0.0000008
	speed: 0.0141s/iter; left time: 501.0190s
	iters: 400, epoch: 14 | loss: 0.0000935
	speed: 0.0139s/iter; left time: 494.8138s
Epoch: 14 cost time: 6.5134806632995605
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000399
	speed: 0.0732s/iter; left time: 2591.7208s
	iters: 200, epoch: 15 | loss: 0.0004672
	speed: 0.0159s/iter; left time: 561.8233s
	iters: 300, epoch: 15 | loss: 0.0000302
	speed: 0.0150s/iter; left time: 529.2483s
	iters: 400, epoch: 15 | loss: 0.0000205
	speed: 0.0144s/iter; left time: 506.9688s
Epoch: 15 cost time: 6.742198705673218
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 51502
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3091025
	speed: 0.0337s/iter; left time: 1387.1091s
	iters: 200, epoch: 1 | loss: 0.1595884
	speed: 0.0181s/iter; left time: 744.2131s
	iters: 300, epoch: 1 | loss: 0.1439073
	speed: 0.0168s/iter; left time: 686.8221s
	iters: 400, epoch: 1 | loss: 0.0672253
	speed: 0.0197s/iter; left time: 805.3229s
Epoch: 1 cost time: 9.07184648513794
Epoch: 1, Steps: 413 | Train Loss: 0.712 Vali Loss: 0.120 Vali Acc: 0.960 Test Loss: 0.120 Test Acc: 0.960
Validation loss decreased (inf --> -0.959981).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0281316
	speed: 0.0692s/iter; left time: 2823.9540s
	iters: 200, epoch: 2 | loss: 0.1664770
	speed: 0.0150s/iter; left time: 612.1629s
	iters: 300, epoch: 2 | loss: 0.2828375
	speed: 0.0172s/iter; left time: 696.2807s
	iters: 400, epoch: 2 | loss: 0.0418482
	speed: 0.0148s/iter; left time: 600.2516s
Epoch: 2 cost time: 7.110818862915039
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.959981 --> -0.974533).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2377055
	speed: 0.0614s/iter; left time: 2480.9017s
	iters: 200, epoch: 3 | loss: 0.0419260
	speed: 0.0132s/iter; left time: 531.0355s
	iters: 300, epoch: 3 | loss: 0.0152687
	speed: 0.0143s/iter; left time: 575.1050s
	iters: 400, epoch: 3 | loss: 0.0085737
	speed: 0.0136s/iter; left time: 546.6875s
Epoch: 3 cost time: 6.144849061965942
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.083 Vali Acc: 0.976 Test Loss: 0.083 Test Acc: 0.976
Validation loss decreased (-0.974533 --> -0.975897).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0076149
	speed: 0.0579s/iter; left time: 2312.0977s
	iters: 200, epoch: 4 | loss: 0.0330386
	speed: 0.0155s/iter; left time: 619.0652s
	iters: 300, epoch: 4 | loss: 0.0087949
	speed: 0.0135s/iter; left time: 536.8338s
	iters: 400, epoch: 4 | loss: 0.0019368
	speed: 0.0130s/iter; left time: 513.9425s
Epoch: 4 cost time: 6.298539638519287
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.057 Vali Acc: 0.978 Test Loss: 0.057 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978171).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0188405
	speed: 0.0732s/iter; left time: 2896.1335s
	iters: 200, epoch: 5 | loss: 0.0024993
	speed: 0.0138s/iter; left time: 544.1993s
	iters: 300, epoch: 5 | loss: 0.0047772
	speed: 0.0151s/iter; left time: 596.0302s
	iters: 400, epoch: 5 | loss: 0.0020444
	speed: 0.0151s/iter; left time: 591.6220s
Epoch: 5 cost time: 6.635035753250122
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0128132
	speed: 0.0711s/iter; left time: 2782.8686s
	iters: 200, epoch: 6 | loss: 0.0005726
	speed: 0.0157s/iter; left time: 613.9453s
	iters: 300, epoch: 6 | loss: 0.0851232
	speed: 0.0158s/iter; left time: 614.0316s
	iters: 400, epoch: 6 | loss: 0.0009326
	speed: 0.0175s/iter; left time: 678.4194s
Epoch: 6 cost time: 7.05174708366394
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0329860
	speed: 0.0651s/iter; left time: 2522.5410s
	iters: 200, epoch: 7 | loss: 0.0031017
	speed: 0.0134s/iter; left time: 516.9899s
	iters: 300, epoch: 7 | loss: 0.1732383
	speed: 0.0153s/iter; left time: 590.3603s
	iters: 400, epoch: 7 | loss: 0.6993688
	speed: 0.0158s/iter; left time: 607.2780s
Epoch: 7 cost time: 6.283380508422852
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0037797
	speed: 0.0716s/iter; left time: 2744.2848s
	iters: 200, epoch: 8 | loss: 0.0006328
	speed: 0.0176s/iter; left time: 672.9100s
	iters: 300, epoch: 8 | loss: 0.0032185
	speed: 0.0175s/iter; left time: 668.2172s
	iters: 400, epoch: 8 | loss: 0.0189232
	speed: 0.0155s/iter; left time: 587.9411s
Epoch: 8 cost time: 7.23497462272644
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0005942
	speed: 0.0748s/iter; left time: 2832.8212s
	iters: 200, epoch: 9 | loss: 0.0000601
	speed: 0.0178s/iter; left time: 674.6048s
	iters: 300, epoch: 9 | loss: 0.0597476
	speed: 0.0153s/iter; left time: 574.8820s
	iters: 400, epoch: 9 | loss: 0.0004598
	speed: 0.0190s/iter; left time: 713.2699s
Epoch: 9 cost time: 7.482771635055542
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0038740
	speed: 0.0718s/iter; left time: 2690.6856s
	iters: 200, epoch: 10 | loss: 0.2920573
	speed: 0.0166s/iter; left time: 619.4476s
	iters: 300, epoch: 10 | loss: 0.0041336
	speed: 0.0179s/iter; left time: 669.1622s
	iters: 400, epoch: 10 | loss: 0.0005781
	speed: 0.0191s/iter; left time: 709.9779s
Epoch: 10 cost time: 7.5256617069244385
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0002655
	speed: 0.0767s/iter; left time: 2842.2582s
	iters: 200, epoch: 11 | loss: 0.0010738
	speed: 0.0167s/iter; left time: 617.6167s
	iters: 300, epoch: 11 | loss: 0.0553384
	speed: 0.0178s/iter; left time: 656.7186s
	iters: 400, epoch: 11 | loss: 0.0788090
	speed: 0.0158s/iter; left time: 580.9294s
Epoch: 11 cost time: 7.318119287490845
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0046643
	speed: 0.0737s/iter; left time: 2700.4199s
	iters: 200, epoch: 12 | loss: 0.0004168
	speed: 0.0161s/iter; left time: 589.8419s
	iters: 300, epoch: 12 | loss: 0.0000166
	speed: 0.0152s/iter; left time: 552.5170s
	iters: 400, epoch: 12 | loss: 0.0000041
	speed: 0.0135s/iter; left time: 492.2444s
Epoch: 12 cost time: 6.765932559967041
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0014330
	speed: 0.0639s/iter; left time: 2317.3817s
	iters: 200, epoch: 13 | loss: 0.0006083
	speed: 0.0121s/iter; left time: 439.0314s
	iters: 300, epoch: 13 | loss: 0.0128951
	speed: 0.0154s/iter; left time: 555.1949s
	iters: 400, epoch: 13 | loss: 0.0002467
	speed: 0.0152s/iter; left time: 547.3703s
Epoch: 13 cost time: 6.306884050369263
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0806585
	speed: 0.0715s/iter; left time: 2562.7218s
	iters: 200, epoch: 14 | loss: 0.0082107
	speed: 0.0147s/iter; left time: 524.6023s
	iters: 300, epoch: 14 | loss: 0.0000294
	speed: 0.0135s/iter; left time: 481.6778s
	iters: 400, epoch: 14 | loss: 0.0000830
	speed: 0.0150s/iter; left time: 534.1231s
Epoch: 14 cost time: 6.6086108684539795
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.180 Vali Acc: 0.966 Test Loss: 0.180 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 51094
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2636918
	speed: 0.0363s/iter; left time: 1494.1308s
	iters: 200, epoch: 1 | loss: 0.4383583
	speed: 0.0177s/iter; left time: 727.9047s
	iters: 300, epoch: 1 | loss: 0.4636587
	speed: 0.0179s/iter; left time: 734.7341s
	iters: 400, epoch: 1 | loss: 0.1034779
	speed: 0.0194s/iter; left time: 794.3690s
Epoch: 1 cost time: 9.449754476547241
Epoch: 1, Steps: 413 | Train Loss: 0.710 Vali Loss: 0.133 Vali Acc: 0.958 Test Loss: 0.133 Test Acc: 0.958
Validation loss decreased (inf --> -0.957707).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2409379
	speed: 0.0696s/iter; left time: 2838.1820s
	iters: 200, epoch: 2 | loss: 0.0069857
	speed: 0.0194s/iter; left time: 789.9606s
	iters: 300, epoch: 2 | loss: 0.0708528
	speed: 0.0156s/iter; left time: 633.2211s
	iters: 400, epoch: 2 | loss: 0.0286468
	speed: 0.0153s/iter; left time: 621.0566s
Epoch: 2 cost time: 7.281030178070068
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
Validation loss decreased (-0.957707 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0203334
	speed: 0.0720s/iter; left time: 2908.0121s
	iters: 200, epoch: 3 | loss: 0.0321158
	speed: 0.0197s/iter; left time: 794.9990s
	iters: 300, epoch: 3 | loss: 0.0231863
	speed: 0.0166s/iter; left time: 666.4545s
	iters: 400, epoch: 3 | loss: 0.0080107
	speed: 0.0152s/iter; left time: 610.5112s
Epoch: 3 cost time: 7.512831449508667
Epoch: 3, Steps: 413 | Train Loss: 0.071 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.1005653
	speed: 0.0761s/iter; left time: 3042.2158s
	iters: 200, epoch: 4 | loss: 0.0110149
	speed: 0.0165s/iter; left time: 659.0598s
	iters: 300, epoch: 4 | loss: 0.0028229
	speed: 0.0145s/iter; left time: 578.5120s
	iters: 400, epoch: 4 | loss: 0.1114416
	speed: 0.0155s/iter; left time: 613.0266s
Epoch: 4 cost time: 7.096564054489136
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.102 Vali Acc: 0.964 Test Loss: 0.102 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0012028
	speed: 0.0823s/iter; left time: 3254.4772s
	iters: 200, epoch: 5 | loss: 0.0256912
	speed: 0.0163s/iter; left time: 644.8636s
	iters: 300, epoch: 5 | loss: 0.0159685
	speed: 0.0151s/iter; left time: 592.2183s
	iters: 400, epoch: 5 | loss: 0.0021261
	speed: 0.0175s/iter; left time: 687.4424s
Epoch: 5 cost time: 7.466149091720581
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.969531 --> -0.969985).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0055317
	speed: 0.0868s/iter; left time: 3395.2666s
	iters: 200, epoch: 6 | loss: 0.0091396
	speed: 0.0167s/iter; left time: 652.3257s
	iters: 300, epoch: 6 | loss: 0.0022458
	speed: 0.0192s/iter; left time: 746.2852s
	iters: 400, epoch: 6 | loss: 0.2044071
	speed: 0.0199s/iter; left time: 771.6805s
Epoch: 6 cost time: 8.23288083076477
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.1623692
	speed: 0.0797s/iter; left time: 3087.4270s
	iters: 200, epoch: 7 | loss: 0.0002282
	speed: 0.0163s/iter; left time: 630.1553s
	iters: 300, epoch: 7 | loss: 0.0369237
	speed: 0.0200s/iter; left time: 771.1380s
	iters: 400, epoch: 7 | loss: 0.0000274
	speed: 0.0170s/iter; left time: 654.6572s
Epoch: 7 cost time: 7.682573318481445
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.069 Vali Acc: 0.973 Test Loss: 0.069 Test Acc: 0.973
Validation loss decreased (-0.969985 --> -0.972714).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0126617
	speed: 0.0730s/iter; left time: 2794.7164s
	iters: 200, epoch: 8 | loss: 0.0046310
	speed: 0.0184s/iter; left time: 703.8864s
	iters: 300, epoch: 8 | loss: 0.0002345
	speed: 0.0160s/iter; left time: 609.9580s
	iters: 400, epoch: 8 | loss: 0.0011040
	speed: 0.0167s/iter; left time: 635.5564s
Epoch: 8 cost time: 7.369323968887329
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0001920
	speed: 0.0699s/iter; left time: 2647.7956s
	iters: 200, epoch: 9 | loss: 0.0003140
	speed: 0.0191s/iter; left time: 721.9964s
	iters: 300, epoch: 9 | loss: 0.0607813
	speed: 0.0177s/iter; left time: 667.2429s
	iters: 400, epoch: 9 | loss: 0.0001341
	speed: 0.0163s/iter; left time: 611.3937s
Epoch: 9 cost time: 7.449219703674316
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.104 Vali Acc: 0.969 Test Loss: 0.104 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001257
	speed: 0.0719s/iter; left time: 2696.1431s
	iters: 200, epoch: 10 | loss: 0.0005284
	speed: 0.0183s/iter; left time: 684.6190s
	iters: 300, epoch: 10 | loss: 0.0001367
	speed: 0.0202s/iter; left time: 753.1837s
	iters: 400, epoch: 10 | loss: 0.0004361
	speed: 0.0180s/iter; left time: 668.4279s
Epoch: 10 cost time: 7.974276542663574
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.967 Test Loss: 0.103 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0814337
	speed: 0.0791s/iter; left time: 2934.1120s
	iters: 200, epoch: 11 | loss: 0.0011756
	speed: 0.0171s/iter; left time: 632.5132s
	iters: 300, epoch: 11 | loss: 0.0049842
	speed: 0.0155s/iter; left time: 572.9703s
	iters: 400, epoch: 11 | loss: 0.0054364
	speed: 0.0147s/iter; left time: 541.2570s
Epoch: 11 cost time: 7.1377809047698975
Epoch: 11, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.101 Vali Acc: 0.968 Test Loss: 0.101 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.1759683
	speed: 0.0631s/iter; left time: 2312.8925s
	iters: 200, epoch: 12 | loss: 0.0010714
	speed: 0.0150s/iter; left time: 548.7141s
	iters: 300, epoch: 12 | loss: 0.0004651
	speed: 0.0169s/iter; left time: 614.7208s
	iters: 400, epoch: 12 | loss: 0.3483703
	speed: 0.0138s/iter; left time: 500.4940s
Epoch: 12 cost time: 7.097878456115723
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0006599
	speed: 0.0653s/iter; left time: 2368.3324s
	iters: 200, epoch: 13 | loss: 0.0000581
	speed: 0.0126s/iter; left time: 456.7954s
	iters: 300, epoch: 13 | loss: 0.0111063
	speed: 0.0132s/iter; left time: 476.1910s
	iters: 400, epoch: 13 | loss: 0.0000039
	speed: 0.0145s/iter; left time: 521.4633s
Epoch: 13 cost time: 6.113672256469727
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0005951
	speed: 0.0606s/iter; left time: 2171.7114s
	iters: 200, epoch: 14 | loss: 0.0000080
	speed: 0.0135s/iter; left time: 482.9671s
	iters: 300, epoch: 14 | loss: 0.0001215
	speed: 0.0122s/iter; left time: 435.9260s
	iters: 400, epoch: 14 | loss: 0.0017990
	speed: 0.0157s/iter; left time: 557.0273s
Epoch: 14 cost time: 6.296011924743652
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0029948
	speed: 0.0727s/iter; left time: 2575.9349s
	iters: 200, epoch: 15 | loss: 0.0000058
	speed: 0.0143s/iter; left time: 506.3198s
	iters: 300, epoch: 15 | loss: 0.0000149
	speed: 0.0140s/iter; left time: 491.5965s
	iters: 400, epoch: 15 | loss: 0.0222021
	speed: 0.0135s/iter; left time: 474.2164s
Epoch: 15 cost time: 6.2736430168151855
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0003991
	speed: 0.0680s/iter; left time: 2381.6753s
	iters: 200, epoch: 16 | loss: 0.0051220
	speed: 0.0148s/iter; left time: 516.5630s
	iters: 300, epoch: 16 | loss: 0.0003288
	speed: 0.0161s/iter; left time: 561.5846s
	iters: 400, epoch: 16 | loss: 0.0252658
	speed: 0.0148s/iter; left time: 512.3573s
Epoch: 16 cost time: 6.711347818374634
Epoch: 16, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.962 Test Loss: 0.200 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0003070
	speed: 0.0710s/iter; left time: 2457.0474s
	iters: 200, epoch: 17 | loss: 0.0008673
	speed: 0.0146s/iter; left time: 503.0296s
	iters: 300, epoch: 17 | loss: 0.0000034
	speed: 0.0148s/iter; left time: 508.7591s
	iters: 400, epoch: 17 | loss: 0.0003356
	speed: 0.0141s/iter; left time: 485.0760s
Epoch: 17 cost time: 6.665290594100952
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 51283
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0584981
	speed: 0.0258s/iter; left time: 1063.3560s
	iters: 200, epoch: 1 | loss: 0.9353620
	speed: 0.0142s/iter; left time: 583.9103s
	iters: 300, epoch: 1 | loss: 0.3398663
	speed: 0.0131s/iter; left time: 537.3947s
	iters: 400, epoch: 1 | loss: 0.0280608
	speed: 0.0143s/iter; left time: 586.3027s
Epoch: 1 cost time: 7.013094663619995
Epoch: 1, Steps: 413 | Train Loss: 0.715 Vali Loss: 0.137 Vali Acc: 0.952 Test Loss: 0.137 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0165853
	speed: 0.0631s/iter; left time: 2571.8875s
	iters: 200, epoch: 2 | loss: 0.0384222
	speed: 0.0152s/iter; left time: 618.5216s
	iters: 300, epoch: 2 | loss: 0.5460644
	speed: 0.0136s/iter; left time: 551.0609s
	iters: 400, epoch: 2 | loss: 0.0150894
	speed: 0.0134s/iter; left time: 544.4429s
Epoch: 2 cost time: 6.220275402069092
Epoch: 2, Steps: 413 | Train Loss: 0.115 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
Validation loss decreased (-0.951795 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0761438
	speed: 0.0586s/iter; left time: 2366.3434s
	iters: 200, epoch: 3 | loss: 0.0762403
	speed: 0.0136s/iter; left time: 547.4949s
	iters: 300, epoch: 3 | loss: 0.1707933
	speed: 0.0133s/iter; left time: 535.1406s
	iters: 400, epoch: 3 | loss: 0.1609340
	speed: 0.0158s/iter; left time: 634.4297s
Epoch: 3 cost time: 6.362086057662964
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.083 Vali Acc: 0.967 Test Loss: 0.083 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0463165
	speed: 0.0694s/iter; left time: 2774.0518s
	iters: 200, epoch: 4 | loss: 0.0245114
	speed: 0.0136s/iter; left time: 540.8472s
	iters: 300, epoch: 4 | loss: 0.0226357
	speed: 0.0153s/iter; left time: 606.6232s
	iters: 400, epoch: 4 | loss: 0.0680129
	speed: 0.0151s/iter; left time: 600.2507s
Epoch: 4 cost time: 6.536620378494263
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
Validation loss decreased (-0.967257 --> -0.969985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032965
	speed: 0.0644s/iter; left time: 2546.1248s
	iters: 200, epoch: 5 | loss: 0.0580788
	speed: 0.0140s/iter; left time: 553.0965s
	iters: 300, epoch: 5 | loss: 0.4281530
	speed: 0.0151s/iter; left time: 595.6946s
	iters: 400, epoch: 5 | loss: 0.0364289
	speed: 0.0150s/iter; left time: 588.6184s
Epoch: 5 cost time: 6.226393222808838
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0597910
	speed: 0.0660s/iter; left time: 2581.3965s
	iters: 200, epoch: 6 | loss: 0.0028699
	speed: 0.0154s/iter; left time: 602.4527s
	iters: 300, epoch: 6 | loss: 0.0054562
	speed: 0.0149s/iter; left time: 581.1156s
	iters: 400, epoch: 6 | loss: 0.0018061
	speed: 0.0158s/iter; left time: 612.6771s
Epoch: 6 cost time: 6.833773374557495
Epoch: 6, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1951155
	speed: 0.0591s/iter; left time: 2288.8322s
	iters: 200, epoch: 7 | loss: 0.0291521
	speed: 0.0137s/iter; left time: 530.3037s
	iters: 300, epoch: 7 | loss: 0.0001765
	speed: 0.0135s/iter; left time: 518.5489s
	iters: 400, epoch: 7 | loss: 0.0618579
	speed: 0.0134s/iter; left time: 515.1543s
Epoch: 7 cost time: 5.984780550003052
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.084 Vali Acc: 0.975 Test Loss: 0.084 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974533).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0017389
	speed: 0.0565s/iter; left time: 2164.0855s
	iters: 200, epoch: 8 | loss: 0.0017323
	speed: 0.0120s/iter; left time: 457.9375s
	iters: 300, epoch: 8 | loss: 0.0115245
	speed: 0.0121s/iter; left time: 461.3631s
	iters: 400, epoch: 8 | loss: 0.0045265
	speed: 0.0120s/iter; left time: 456.7540s
Epoch: 8 cost time: 5.488819360733032
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0105980
	speed: 0.0589s/iter; left time: 2230.5224s
	iters: 200, epoch: 9 | loss: 0.0003073
	speed: 0.0146s/iter; left time: 550.8613s
	iters: 300, epoch: 9 | loss: 0.0002708
	speed: 0.0144s/iter; left time: 544.2561s
	iters: 400, epoch: 9 | loss: 0.0000394
	speed: 0.0152s/iter; left time: 569.8193s
Epoch: 9 cost time: 6.366677522659302
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001308
	speed: 0.0696s/iter; left time: 2608.7773s
	iters: 200, epoch: 10 | loss: 0.0006312
	speed: 0.0160s/iter; left time: 597.9864s
	iters: 300, epoch: 10 | loss: 0.0001096
	speed: 0.0154s/iter; left time: 575.8279s
	iters: 400, epoch: 10 | loss: 0.0198483
	speed: 0.0150s/iter; left time: 559.5434s
Epoch: 10 cost time: 6.644479036331177
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0001339
	speed: 0.0693s/iter; left time: 2568.1267s
	iters: 200, epoch: 11 | loss: 0.0024770
	speed: 0.0157s/iter; left time: 579.5865s
	iters: 300, epoch: 11 | loss: 0.0008708
	speed: 0.0179s/iter; left time: 659.8649s
	iters: 400, epoch: 11 | loss: 0.0008543
	speed: 0.0148s/iter; left time: 542.9879s
Epoch: 11 cost time: 7.022616386413574
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
Validation loss decreased (-0.974533 --> -0.974987).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.2826843
	speed: 0.0690s/iter; left time: 2529.7788s
	iters: 200, epoch: 12 | loss: 0.0204227
	speed: 0.0147s/iter; left time: 538.0958s
	iters: 300, epoch: 12 | loss: 0.0235389
	speed: 0.0160s/iter; left time: 583.6846s
	iters: 400, epoch: 12 | loss: 0.0000993
	speed: 0.0159s/iter; left time: 579.0484s
Epoch: 12 cost time: 6.766885280609131
Epoch: 12, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0251209
	speed: 0.0582s/iter; left time: 2111.0911s
	iters: 200, epoch: 13 | loss: 0.0016697
	speed: 0.0144s/iter; left time: 522.1274s
	iters: 300, epoch: 13 | loss: 0.0000239
	speed: 0.0147s/iter; left time: 530.8556s
	iters: 400, epoch: 13 | loss: 0.0000003
	speed: 0.0128s/iter; left time: 459.1686s
Epoch: 13 cost time: 6.295661926269531
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.964 Test Loss: 0.192 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0300233
	speed: 0.0591s/iter; left time: 2118.1323s
	iters: 200, epoch: 14 | loss: 0.0004366
	speed: 0.0144s/iter; left time: 513.6139s
	iters: 300, epoch: 14 | loss: 0.0069269
	speed: 0.0116s/iter; left time: 414.9151s
	iters: 400, epoch: 14 | loss: 0.0064052
	speed: 0.0123s/iter; left time: 436.0861s
Epoch: 14 cost time: 5.85943865776062
Epoch: 14, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.251 Vali Acc: 0.957 Test Loss: 0.251 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0006849
	speed: 0.0581s/iter; left time: 2056.3174s
	iters: 200, epoch: 15 | loss: 0.0297655
	speed: 0.0131s/iter; left time: 463.1688s
	iters: 300, epoch: 15 | loss: 0.0058690
	speed: 0.0131s/iter; left time: 461.6398s
	iters: 400, epoch: 15 | loss: 0.0000023
	speed: 0.0128s/iter; left time: 451.0467s
Epoch: 15 cost time: 5.836308240890503
Epoch: 15, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000009
	speed: 0.0709s/iter; left time: 2482.1105s
	iters: 200, epoch: 16 | loss: 0.0039994
	speed: 0.0159s/iter; left time: 554.1845s
	iters: 300, epoch: 16 | loss: 0.0159800
	speed: 0.0150s/iter; left time: 523.3796s
	iters: 400, epoch: 16 | loss: 0.0000161
	speed: 0.0173s/iter; left time: 599.4246s
Epoch: 16 cost time: 7.172775506973267
Epoch: 16, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000784
	speed: 0.0739s/iter; left time: 2556.4731s
	iters: 200, epoch: 17 | loss: 0.0043666
	speed: 0.0157s/iter; left time: 541.6846s
	iters: 300, epoch: 17 | loss: 0.0000330
	speed: 0.0170s/iter; left time: 584.3621s
	iters: 400, epoch: 17 | loss: 0.0020150
	speed: 0.0179s/iter; left time: 615.5007s
Epoch: 17 cost time: 7.299566745758057
Epoch: 17, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.964 Test Loss: 0.189 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0003639
	speed: 0.0725s/iter; left time: 2476.5549s
	iters: 200, epoch: 18 | loss: 0.0000014
	speed: 0.0160s/iter; left time: 545.5882s
	iters: 300, epoch: 18 | loss: 0.0000115
	speed: 0.0139s/iter; left time: 473.9461s
	iters: 400, epoch: 18 | loss: 0.0000017
	speed: 0.0151s/iter; left time: 510.8317s
Epoch: 18 cost time: 6.533829212188721
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0002981
	speed: 0.0559s/iter; left time: 1887.5144s
	iters: 200, epoch: 19 | loss: 0.0313600
	speed: 0.0144s/iter; left time: 486.1290s
	iters: 300, epoch: 19 | loss: 0.0000149
	speed: 0.0133s/iter; left time: 447.0495s
	iters: 400, epoch: 19 | loss: 0.0003943
	speed: 0.0166s/iter; left time: 556.0632s
Epoch: 19 cost time: 6.301388740539551
Epoch: 19, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000000
	speed: 0.0643s/iter; left time: 2144.9168s
	iters: 200, epoch: 20 | loss: 0.0089429
	speed: 0.0159s/iter; left time: 527.3136s
	iters: 300, epoch: 20 | loss: 0.0001074
	speed: 0.0140s/iter; left time: 465.6413s
	iters: 400, epoch: 20 | loss: 0.0074680
	speed: 0.0151s/iter; left time: 499.8780s
Epoch: 20 cost time: 6.671633720397949
Epoch: 20, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.968 Test Loss: 0.182 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000033
	speed: 0.0717s/iter; left time: 2361.1800s
	iters: 200, epoch: 21 | loss: 0.0001202
	speed: 0.0146s/iter; left time: 481.0877s
	iters: 300, epoch: 21 | loss: 0.0000032
	speed: 0.0158s/iter; left time: 516.2769s
	iters: 400, epoch: 21 | loss: 0.0000027
	speed: 0.0157s/iter; left time: 511.7396s
Epoch: 21 cost time: 7.001638889312744
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.969 Test Loss: 0.215 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 51290
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1185263
	speed: 0.0308s/iter; left time: 1270.1309s
	iters: 200, epoch: 1 | loss: 0.2822165
	speed: 0.0148s/iter; left time: 608.1369s
	iters: 300, epoch: 1 | loss: 0.1850093
	speed: 0.0155s/iter; left time: 634.7029s
	iters: 400, epoch: 1 | loss: 0.1997962
	speed: 0.0149s/iter; left time: 609.6172s
Epoch: 1 cost time: 7.817572593688965
Epoch: 1, Steps: 413 | Train Loss: 0.727 Vali Loss: 0.140 Vali Acc: 0.951 Test Loss: 0.140 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0434005
	speed: 0.0567s/iter; left time: 2310.9631s
	iters: 200, epoch: 2 | loss: 0.0516264
	speed: 0.0124s/iter; left time: 505.9726s
	iters: 300, epoch: 2 | loss: 0.0121334
	speed: 0.0111s/iter; left time: 449.8276s
	iters: 400, epoch: 2 | loss: 0.3609629
	speed: 0.0143s/iter; left time: 577.7105s
Epoch: 2 cost time: 5.8283491134643555
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.091 Vali Acc: 0.965 Test Loss: 0.091 Test Acc: 0.965
Validation loss decreased (-0.951340 --> -0.965438).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0141751
	speed: 0.0624s/iter; left time: 2519.9388s
	iters: 200, epoch: 3 | loss: 0.0974917
	speed: 0.0133s/iter; left time: 537.6049s
	iters: 300, epoch: 3 | loss: 0.0037174
	speed: 0.0136s/iter; left time: 546.6071s
	iters: 400, epoch: 3 | loss: 0.0633494
	speed: 0.0149s/iter; left time: 596.1398s
Epoch: 3 cost time: 6.208570241928101
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.096 Vali Acc: 0.966 Test Loss: 0.096 Test Acc: 0.966
Validation loss decreased (-0.965438 --> -0.966347).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0030825
	speed: 0.0611s/iter; left time: 2443.5133s
	iters: 200, epoch: 4 | loss: 0.0040247
	speed: 0.0139s/iter; left time: 552.3754s
	iters: 300, epoch: 4 | loss: 0.0007626
	speed: 0.0155s/iter; left time: 616.7076s
	iters: 400, epoch: 4 | loss: 0.0263334
	speed: 0.0149s/iter; left time: 590.6839s
Epoch: 4 cost time: 6.361738443374634
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0109137
	speed: 0.0649s/iter; left time: 2568.1773s
	iters: 200, epoch: 5 | loss: 0.0058388
	speed: 0.0139s/iter; left time: 548.0504s
	iters: 300, epoch: 5 | loss: 0.0075813
	speed: 0.0146s/iter; left time: 573.4502s
	iters: 400, epoch: 5 | loss: 0.0219552
	speed: 0.0135s/iter; left time: 531.1440s
Epoch: 5 cost time: 6.122039318084717
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.976 Test Loss: 0.086 Test Acc: 0.976
Validation loss decreased (-0.966347 --> -0.976352).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0016388
	speed: 0.0609s/iter; left time: 2384.7034s
	iters: 200, epoch: 6 | loss: 0.4427879
	speed: 0.0158s/iter; left time: 618.6010s
	iters: 300, epoch: 6 | loss: 0.2309945
	speed: 0.0164s/iter; left time: 640.1430s
	iters: 400, epoch: 6 | loss: 0.0126160
	speed: 0.0144s/iter; left time: 557.8510s
Epoch: 6 cost time: 6.590663909912109
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0181821
	speed: 0.0627s/iter; left time: 2427.9321s
	iters: 200, epoch: 7 | loss: 0.0141216
	speed: 0.0174s/iter; left time: 673.3774s
	iters: 300, epoch: 7 | loss: 0.0012298
	speed: 0.0145s/iter; left time: 558.8141s
	iters: 400, epoch: 7 | loss: 0.0003744
	speed: 0.0136s/iter; left time: 521.4172s
Epoch: 7 cost time: 6.551872730255127
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.970 Test Loss: 0.108 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0036629
	speed: 0.0506s/iter; left time: 1938.4370s
	iters: 200, epoch: 8 | loss: 0.0004929
	speed: 0.0138s/iter; left time: 526.7039s
	iters: 300, epoch: 8 | loss: 0.0049551
	speed: 0.0132s/iter; left time: 502.4115s
	iters: 400, epoch: 8 | loss: 0.0007049
	speed: 0.0121s/iter; left time: 460.8349s
Epoch: 8 cost time: 5.765233516693115
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0067881
	speed: 0.0484s/iter; left time: 1835.5223s
	iters: 200, epoch: 9 | loss: 0.0013672
	speed: 0.0134s/iter; left time: 505.3669s
	iters: 300, epoch: 9 | loss: 0.0434524
	speed: 0.0125s/iter; left time: 469.5095s
	iters: 400, epoch: 9 | loss: 0.0021208
	speed: 0.0123s/iter; left time: 463.3341s
Epoch: 9 cost time: 5.589657545089722
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0011770
	speed: 0.0539s/iter; left time: 2021.4680s
	iters: 200, epoch: 10 | loss: 0.0343937
	speed: 0.0136s/iter; left time: 507.4302s
	iters: 300, epoch: 10 | loss: 0.0035030
	speed: 0.0148s/iter; left time: 550.5513s
	iters: 400, epoch: 10 | loss: 0.1109633
	speed: 0.0131s/iter; left time: 485.4413s
Epoch: 10 cost time: 6.148536443710327
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0100139
	speed: 0.0662s/iter; left time: 2455.5962s
	iters: 200, epoch: 11 | loss: 0.0009617
	speed: 0.0146s/iter; left time: 540.2380s
	iters: 300, epoch: 11 | loss: 0.0077257
	speed: 0.0142s/iter; left time: 523.5950s
	iters: 400, epoch: 11 | loss: 0.0001832
	speed: 0.0124s/iter; left time: 456.4647s
Epoch: 11 cost time: 6.487740993499756
Epoch: 11, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000744
	speed: 0.0739s/iter; left time: 2707.7046s
	iters: 200, epoch: 12 | loss: 0.0001210
	speed: 0.0140s/iter; left time: 512.3595s
	iters: 300, epoch: 12 | loss: 0.0000151
	speed: 0.0131s/iter; left time: 476.5058s
	iters: 400, epoch: 12 | loss: 0.0003858
	speed: 0.0139s/iter; left time: 505.3052s
Epoch: 12 cost time: 6.216615200042725
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0076770
	speed: 0.0626s/iter; left time: 2268.7003s
	iters: 200, epoch: 13 | loss: 0.0081970
	speed: 0.0135s/iter; left time: 486.9995s
	iters: 300, epoch: 13 | loss: 0.0000491
	speed: 0.0128s/iter; left time: 460.4208s
	iters: 400, epoch: 13 | loss: 0.2639645
	speed: 0.0126s/iter; left time: 452.8485s
Epoch: 13 cost time: 5.642355680465698
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.161 Vali Acc: 0.966 Test Loss: 0.161 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0005773
	speed: 0.0550s/iter; left time: 1969.8025s
	iters: 200, epoch: 14 | loss: 0.1610145
	speed: 0.0122s/iter; left time: 436.8645s
	iters: 300, epoch: 14 | loss: 0.0428381
	speed: 0.0132s/iter; left time: 469.1090s
	iters: 400, epoch: 14 | loss: 0.0134951
	speed: 0.0132s/iter; left time: 470.1141s
Epoch: 14 cost time: 5.689572334289551
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0428198
	speed: 0.0516s/iter; left time: 1826.1780s
	iters: 200, epoch: 15 | loss: 0.0001187
	speed: 0.0146s/iter; left time: 514.3527s
	iters: 300, epoch: 15 | loss: 0.0482334
	speed: 0.0142s/iter; left time: 499.1801s
	iters: 400, epoch: 15 | loss: 0.0073052
	speed: 0.0131s/iter; left time: 460.1073s
Epoch: 15 cost time: 5.961022615432739
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 51115
model size : 0.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2072288
	speed: 0.0317s/iter; left time: 1306.1190s
	iters: 200, epoch: 1 | loss: 0.8142459
	speed: 0.0136s/iter; left time: 559.7862s
	iters: 300, epoch: 1 | loss: 0.0824418
	speed: 0.0138s/iter; left time: 565.5927s
	iters: 400, epoch: 1 | loss: 0.0585007
	speed: 0.0134s/iter; left time: 546.8894s
Epoch: 1 cost time: 7.517225980758667
Epoch: 1, Steps: 413 | Train Loss: 0.707 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (inf --> -0.940881).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1040087
	speed: 0.0706s/iter; left time: 2880.2085s
	iters: 200, epoch: 2 | loss: 0.1009194
	speed: 0.0139s/iter; left time: 564.9440s
	iters: 300, epoch: 2 | loss: 0.0797210
	speed: 0.0136s/iter; left time: 550.1734s
	iters: 400, epoch: 2 | loss: 0.0449716
	speed: 0.0129s/iter; left time: 521.0611s
Epoch: 2 cost time: 6.07813286781311
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.102 Vali Acc: 0.962 Test Loss: 0.102 Test Acc: 0.962
Validation loss decreased (-0.940881 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0306846
	speed: 0.0561s/iter; left time: 2263.6515s
	iters: 200, epoch: 3 | loss: 0.1704677
	speed: 0.0123s/iter; left time: 497.0076s
	iters: 300, epoch: 3 | loss: 0.0055698
	speed: 0.0130s/iter; left time: 521.1204s
	iters: 400, epoch: 3 | loss: 0.0088026
	speed: 0.0133s/iter; left time: 532.7704s
Epoch: 3 cost time: 5.695817947387695
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.091 Vali Acc: 0.973 Test Loss: 0.091 Test Acc: 0.973
Validation loss decreased (-0.961800 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0114368
	speed: 0.0550s/iter; left time: 2196.7452s
	iters: 200, epoch: 4 | loss: 0.0037580
	speed: 0.0130s/iter; left time: 517.5412s
	iters: 300, epoch: 4 | loss: 0.0007839
	speed: 0.0130s/iter; left time: 518.3363s
	iters: 400, epoch: 4 | loss: 0.0006532
	speed: 0.0124s/iter; left time: 491.2478s
Epoch: 4 cost time: 5.592212915420532
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.057 Vali Acc: 0.981 Test Loss: 0.057 Test Acc: 0.981
Validation loss decreased (-0.972714 --> -0.980900).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0299387
	speed: 0.0517s/iter; left time: 2046.6303s
	iters: 200, epoch: 5 | loss: 0.0116934
	speed: 0.0139s/iter; left time: 548.8434s
	iters: 300, epoch: 5 | loss: 0.1688595
	speed: 0.0139s/iter; left time: 547.8435s
	iters: 400, epoch: 5 | loss: 0.0095083
	speed: 0.0158s/iter; left time: 618.4279s
Epoch: 5 cost time: 6.260845422744751
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.972 Test Loss: 0.094 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1580834
	speed: 0.0649s/iter; left time: 2540.0006s
	iters: 200, epoch: 6 | loss: 0.0035580
	speed: 0.0145s/iter; left time: 565.6342s
	iters: 300, epoch: 6 | loss: 0.0261866
	speed: 0.0137s/iter; left time: 532.8364s
	iters: 400, epoch: 6 | loss: 0.0306009
	speed: 0.0149s/iter; left time: 580.4635s
Epoch: 6 cost time: 6.200360298156738
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.061 Vali Acc: 0.975 Test Loss: 0.061 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0094655
	speed: 0.0659s/iter; left time: 2552.9715s
	iters: 200, epoch: 7 | loss: 0.0026533
	speed: 0.0156s/iter; left time: 602.5274s
	iters: 300, epoch: 7 | loss: 0.0670666
	speed: 0.0155s/iter; left time: 595.7267s
	iters: 400, epoch: 7 | loss: 0.0034278
	speed: 0.0158s/iter; left time: 605.2287s
Epoch: 7 cost time: 7.000147342681885
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0022915
	speed: 0.0718s/iter; left time: 2749.4079s
	iters: 200, epoch: 8 | loss: 0.0035182
	speed: 0.0155s/iter; left time: 593.0001s
	iters: 300, epoch: 8 | loss: 0.0012435
	speed: 0.0134s/iter; left time: 510.7740s
	iters: 400, epoch: 8 | loss: 0.0024776
	speed: 0.0122s/iter; left time: 464.3102s
Epoch: 8 cost time: 6.298163414001465
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0107348
	speed: 0.0603s/iter; left time: 2283.4846s
	iters: 200, epoch: 9 | loss: 0.0060058
	speed: 0.0139s/iter; left time: 525.2704s
	iters: 300, epoch: 9 | loss: 0.0013028
	speed: 0.0126s/iter; left time: 475.0688s
	iters: 400, epoch: 9 | loss: 0.0001666
	speed: 0.0130s/iter; left time: 490.2660s
Epoch: 9 cost time: 5.876708507537842
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0011422
	speed: 0.0596s/iter; left time: 2233.8704s
	iters: 200, epoch: 10 | loss: 0.0014755
	speed: 0.0122s/iter; left time: 454.8394s
	iters: 300, epoch: 10 | loss: 0.0017852
	speed: 0.0127s/iter; left time: 472.7685s
	iters: 400, epoch: 10 | loss: 0.0000112
	speed: 0.0149s/iter; left time: 553.1680s
Epoch: 10 cost time: 5.949457883834839
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0001102
	speed: 0.0639s/iter; left time: 2369.8212s
	iters: 200, epoch: 11 | loss: 0.0265513
	speed: 0.0139s/iter; left time: 514.8115s
	iters: 300, epoch: 11 | loss: 0.0308167
	speed: 0.0158s/iter; left time: 583.5889s
	iters: 400, epoch: 11 | loss: 0.0105297
	speed: 0.0150s/iter; left time: 551.2719s
Epoch: 11 cost time: 6.529465436935425
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.080 Vali Acc: 0.980 Test Loss: 0.080 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0074401
	speed: 0.0627s/iter; left time: 2298.7559s
	iters: 200, epoch: 12 | loss: 0.0001485
	speed: 0.0157s/iter; left time: 573.5606s
	iters: 300, epoch: 12 | loss: 0.0029902
	speed: 0.0151s/iter; left time: 550.4520s
	iters: 400, epoch: 12 | loss: 0.0001189
	speed: 0.0146s/iter; left time: 529.0922s
Epoch: 12 cost time: 6.401375770568848
Epoch: 12, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0001688
	speed: 0.0637s/iter; left time: 2309.1860s
	iters: 200, epoch: 13 | loss: 0.0007944
	speed: 0.0162s/iter; left time: 584.6588s
	iters: 300, epoch: 13 | loss: 0.0163580
	speed: 0.0167s/iter; left time: 602.5706s
	iters: 400, epoch: 13 | loss: 0.0000367
	speed: 0.0169s/iter; left time: 606.0882s
Epoch: 13 cost time: 7.1911211013793945
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0254176
	speed: 0.0645s/iter; left time: 2310.1325s
	iters: 200, epoch: 14 | loss: 0.0016028
	speed: 0.0140s/iter; left time: 501.4417s
	iters: 300, epoch: 14 | loss: 0.0009801
	speed: 0.0141s/iter; left time: 501.4625s
	iters: 400, epoch: 14 | loss: 0.0000966
	speed: 0.0130s/iter; left time: 461.3852s
Epoch: 14 cost time: 6.240709543228149
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9809004092769441
model parameter : 50758
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1023391
	speed: 0.0299s/iter; left time: 1230.6521s
	iters: 200, epoch: 1 | loss: 0.6818841
	speed: 0.0157s/iter; left time: 644.2122s
	iters: 300, epoch: 1 | loss: 0.1201003
	speed: 0.0174s/iter; left time: 713.3587s
	iters: 400, epoch: 1 | loss: 0.0434442
	speed: 0.0167s/iter; left time: 684.2066s
Epoch: 1 cost time: 8.204404830932617
Epoch: 1, Steps: 413 | Train Loss: 0.734 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
Validation loss decreased (inf --> -0.945883).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0608105
	speed: 0.0707s/iter; left time: 2885.2141s
	iters: 200, epoch: 2 | loss: 0.1757233
	speed: 0.0147s/iter; left time: 596.2522s
	iters: 300, epoch: 2 | loss: 0.0282936
	speed: 0.0162s/iter; left time: 656.1530s
	iters: 400, epoch: 2 | loss: 0.1308871
	speed: 0.0143s/iter; left time: 579.8534s
Epoch: 2 cost time: 6.662227392196655
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.117 Vali Acc: 0.966 Test Loss: 0.117 Test Acc: 0.966
Validation loss decreased (-0.945883 --> -0.965892).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0148519
	speed: 0.0672s/iter; left time: 2711.9609s
	iters: 200, epoch: 3 | loss: 0.9120520
	speed: 0.0146s/iter; left time: 587.0659s
	iters: 300, epoch: 3 | loss: 0.5118227
	speed: 0.0138s/iter; left time: 552.6294s
	iters: 400, epoch: 3 | loss: 0.0423731
	speed: 0.0131s/iter; left time: 524.9711s
Epoch: 3 cost time: 6.332069635391235
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.096 Vali Acc: 0.967 Test Loss: 0.096 Test Acc: 0.967
Validation loss decreased (-0.965892 --> -0.966802).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0032628
	speed: 0.0655s/iter; left time: 2615.9579s
	iters: 200, epoch: 4 | loss: 0.0478694
	speed: 0.0140s/iter; left time: 557.9768s
	iters: 300, epoch: 4 | loss: 0.0220528
	speed: 0.0131s/iter; left time: 519.9044s
	iters: 400, epoch: 4 | loss: 0.0112056
	speed: 0.0155s/iter; left time: 616.2042s
Epoch: 4 cost time: 6.360837697982788
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.091 Vali Acc: 0.966 Test Loss: 0.091 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.2240627
	speed: 0.0639s/iter; left time: 2525.9141s
	iters: 200, epoch: 5 | loss: 0.0786846
	speed: 0.0128s/iter; left time: 505.7850s
	iters: 300, epoch: 5 | loss: 0.0100777
	speed: 0.0154s/iter; left time: 607.0400s
	iters: 400, epoch: 5 | loss: 0.1572744
	speed: 0.0150s/iter; left time: 587.5050s
Epoch: 5 cost time: 6.268763780593872
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.111 Vali Acc: 0.963 Test Loss: 0.111 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0003000
	speed: 0.0619s/iter; left time: 2421.0507s
	iters: 200, epoch: 6 | loss: 0.0076670
	speed: 0.0153s/iter; left time: 595.8107s
	iters: 300, epoch: 6 | loss: 0.0222979
	speed: 0.0137s/iter; left time: 533.5351s
	iters: 400, epoch: 6 | loss: 0.0055800
	speed: 0.0150s/iter; left time: 582.2406s
Epoch: 6 cost time: 6.236626386642456
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
Validation loss decreased (-0.966802 --> -0.973624).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0137931
	speed: 0.0536s/iter; left time: 2073.9864s
	iters: 200, epoch: 7 | loss: 0.0060956
	speed: 0.0130s/iter; left time: 501.4836s
	iters: 300, epoch: 7 | loss: 0.0000390
	speed: 0.0146s/iter; left time: 560.7345s
	iters: 400, epoch: 7 | loss: 0.6766598
	speed: 0.0148s/iter; left time: 567.7028s
Epoch: 7 cost time: 6.1280517578125
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0061348
	speed: 0.0704s/iter; left time: 2696.9329s
	iters: 200, epoch: 8 | loss: 0.0216391
	speed: 0.0151s/iter; left time: 578.8677s
	iters: 300, epoch: 8 | loss: 0.0006682
	speed: 0.0143s/iter; left time: 543.5180s
	iters: 400, epoch: 8 | loss: 0.0182550
	speed: 0.0135s/iter; left time: 511.5685s
Epoch: 8 cost time: 6.399347543716431
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0005960
	speed: 0.0703s/iter; left time: 2664.9241s
	iters: 200, epoch: 9 | loss: 0.0100806
	speed: 0.0152s/iter; left time: 575.8315s
	iters: 300, epoch: 9 | loss: 0.0020836
	speed: 0.0154s/iter; left time: 581.8522s
	iters: 400, epoch: 9 | loss: 0.0000313
	speed: 0.0150s/iter; left time: 562.3576s
Epoch: 9 cost time: 6.911784410476685
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0010311
	speed: 0.0750s/iter; left time: 2809.7360s
	iters: 200, epoch: 10 | loss: 0.0007848
	speed: 0.0129s/iter; left time: 481.5589s
	iters: 300, epoch: 10 | loss: 0.0027003
	speed: 0.0133s/iter; left time: 497.0549s
	iters: 400, epoch: 10 | loss: 0.0055076
	speed: 0.0148s/iter; left time: 551.6277s
Epoch: 10 cost time: 6.301745891571045
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.136 Vali Acc: 0.968 Test Loss: 0.136 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0139554
	speed: 0.0568s/iter; left time: 2107.2121s
	iters: 200, epoch: 11 | loss: 0.0000891
	speed: 0.0155s/iter; left time: 571.3380s
	iters: 300, epoch: 11 | loss: 0.0003913
	speed: 0.0134s/iter; left time: 492.8437s
	iters: 400, epoch: 11 | loss: 0.0000102
	speed: 0.0137s/iter; left time: 504.6194s
Epoch: 11 cost time: 6.155684232711792
Epoch: 11, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0132629
	speed: 0.0441s/iter; left time: 1616.4006s
	iters: 200, epoch: 12 | loss: 0.0002846
	speed: 0.0121s/iter; left time: 442.6996s
	iters: 300, epoch: 12 | loss: 0.0020613
	speed: 0.0123s/iter; left time: 448.0543s
	iters: 400, epoch: 12 | loss: 0.0000122
	speed: 0.0130s/iter; left time: 474.3370s
Epoch: 12 cost time: 5.585705280303955
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0000021
	speed: 0.0510s/iter; left time: 1848.3703s
	iters: 200, epoch: 13 | loss: 0.0002455
	speed: 0.0130s/iter; left time: 468.5581s
	iters: 300, epoch: 13 | loss: 0.0014526
	speed: 0.0124s/iter; left time: 448.0453s
	iters: 400, epoch: 13 | loss: 0.0422255
	speed: 0.0119s/iter; left time: 426.1153s
Epoch: 13 cost time: 5.502071857452393
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0000345
	speed: 0.0537s/iter; left time: 1924.3812s
	iters: 200, epoch: 14 | loss: 0.0000047
	speed: 0.0126s/iter; left time: 449.1496s
	iters: 300, epoch: 14 | loss: 0.0000070
	speed: 0.0131s/iter; left time: 466.2950s
	iters: 400, epoch: 14 | loss: 0.0766564
	speed: 0.0138s/iter; left time: 491.4090s
Epoch: 14 cost time: 5.745826005935669
Epoch: 14, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.238 Vali Acc: 0.958 Test Loss: 0.238 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0200563
	speed: 0.0489s/iter; left time: 1733.1931s
	iters: 200, epoch: 15 | loss: 0.0000048
	speed: 0.0149s/iter; left time: 528.0067s
	iters: 300, epoch: 15 | loss: 0.0005641
	speed: 0.0133s/iter; left time: 467.9791s
	iters: 400, epoch: 15 | loss: 0.2687827
	speed: 0.0136s/iter; left time: 478.8155s
Epoch: 15 cost time: 5.978276968002319
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0000527
	speed: 0.0567s/iter; left time: 1986.4098s
	iters: 200, epoch: 16 | loss: 0.0000450
	speed: 0.0142s/iter; left time: 497.2172s
	iters: 300, epoch: 16 | loss: 0.0003413
	speed: 0.0158s/iter; left time: 549.5285s
	iters: 400, epoch: 16 | loss: 0.0008555
	speed: 0.0138s/iter; left time: 479.5894s
Epoch: 16 cost time: 6.590285301208496
Epoch: 16, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 50928
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1830195
	speed: 0.0294s/iter; left time: 1210.6103s
	iters: 200, epoch: 1 | loss: 0.4603729
	speed: 0.0153s/iter; left time: 628.3603s
	iters: 300, epoch: 1 | loss: 0.3015338
	speed: 0.0132s/iter; left time: 539.4984s
	iters: 400, epoch: 1 | loss: 0.6519285
	speed: 0.0111s/iter; left time: 452.2324s
Epoch: 1 cost time: 7.084083795547485
Epoch: 1, Steps: 413 | Train Loss: 0.665 Vali Loss: 0.125 Vali Acc: 0.956 Test Loss: 0.125 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0501491
	speed: 0.0501s/iter; left time: 2042.3443s
	iters: 200, epoch: 2 | loss: 0.0148664
	speed: 0.0119s/iter; left time: 483.2578s
	iters: 300, epoch: 2 | loss: 0.0841120
	speed: 0.0116s/iter; left time: 472.1789s
	iters: 400, epoch: 2 | loss: 0.0531609
	speed: 0.0115s/iter; left time: 464.2404s
Epoch: 2 cost time: 5.270948171615601
Epoch: 2, Steps: 413 | Train Loss: 0.122 Vali Loss: 0.125 Vali Acc: 0.958 Test Loss: 0.125 Test Acc: 0.958
Validation loss decreased (-0.955888 --> -0.957707).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0125909
	speed: 0.0506s/iter; left time: 2042.2859s
	iters: 200, epoch: 3 | loss: 0.4226482
	speed: 0.0115s/iter; left time: 462.6249s
	iters: 300, epoch: 3 | loss: 0.0112519
	speed: 0.0100s/iter; left time: 403.0901s
	iters: 400, epoch: 3 | loss: 0.0425868
	speed: 0.0104s/iter; left time: 416.1368s
Epoch: 3 cost time: 4.99513053894043
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.058 Vali Acc: 0.979 Test Loss: 0.058 Test Acc: 0.979
Validation loss decreased (-0.957707 --> -0.978626).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0328587
	speed: 0.0528s/iter; left time: 2108.5264s
	iters: 200, epoch: 4 | loss: 0.2365441
	speed: 0.0131s/iter; left time: 522.3039s
	iters: 300, epoch: 4 | loss: 0.0064725
	speed: 0.0118s/iter; left time: 467.7067s
	iters: 400, epoch: 4 | loss: 0.0133384
	speed: 0.0124s/iter; left time: 491.2189s
Epoch: 4 cost time: 5.769463539123535
Epoch: 4, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.087 Vali Acc: 0.972 Test Loss: 0.087 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0110645
	speed: 0.0563s/iter; left time: 2226.7922s
	iters: 200, epoch: 5 | loss: 0.0105571
	speed: 0.0140s/iter; left time: 552.1312s
	iters: 300, epoch: 5 | loss: 0.0866405
	speed: 0.0129s/iter; left time: 507.7426s
	iters: 400, epoch: 5 | loss: 0.0111396
	speed: 0.0123s/iter; left time: 484.5226s
Epoch: 5 cost time: 5.9486083984375
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.964 Test Loss: 0.118 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0008762
	speed: 0.0626s/iter; left time: 2448.3831s
	iters: 200, epoch: 6 | loss: 0.0285891
	speed: 0.0124s/iter; left time: 482.4891s
	iters: 300, epoch: 6 | loss: 0.0000932
	speed: 0.0130s/iter; left time: 505.7216s
	iters: 400, epoch: 6 | loss: 0.0001124
	speed: 0.0137s/iter; left time: 532.8297s
Epoch: 6 cost time: 5.911216735839844
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.089 Vali Acc: 0.970 Test Loss: 0.089 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0129788
	speed: 0.0608s/iter; left time: 2354.4019s
	iters: 200, epoch: 7 | loss: 0.0050606
	speed: 0.0120s/iter; left time: 464.2451s
	iters: 300, epoch: 7 | loss: 0.1522331
	speed: 0.0116s/iter; left time: 447.7756s
	iters: 400, epoch: 7 | loss: 0.0189874
	speed: 0.0111s/iter; left time: 426.7762s
Epoch: 7 cost time: 5.430821657180786
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0016672
	speed: 0.0552s/iter; left time: 2114.6666s
	iters: 200, epoch: 8 | loss: 0.0002426
	speed: 0.0114s/iter; left time: 436.1108s
	iters: 300, epoch: 8 | loss: 0.0587395
	speed: 0.0118s/iter; left time: 448.8273s
	iters: 400, epoch: 8 | loss: 0.0047663
	speed: 0.0121s/iter; left time: 461.7473s
Epoch: 8 cost time: 5.261846303939819
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.087 Vali Acc: 0.971 Test Loss: 0.087 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0005992
	speed: 0.0473s/iter; left time: 1792.8546s
	iters: 200, epoch: 9 | loss: 0.0425505
	speed: 0.0115s/iter; left time: 433.6235s
	iters: 300, epoch: 9 | loss: 0.0024034
	speed: 0.0132s/iter; left time: 496.6448s
	iters: 400, epoch: 9 | loss: 0.0014592
	speed: 0.0111s/iter; left time: 417.6288s
Epoch: 9 cost time: 5.090284585952759
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0002371
	speed: 0.0465s/iter; left time: 1741.6893s
	iters: 200, epoch: 10 | loss: 0.0000029
	speed: 0.0131s/iter; left time: 488.7793s
	iters: 300, epoch: 10 | loss: 0.0486770
	speed: 0.0127s/iter; left time: 474.4938s
	iters: 400, epoch: 10 | loss: 0.0007929
	speed: 0.0161s/iter; left time: 597.1474s
Epoch: 10 cost time: 6.052225112915039
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0002332
	speed: 0.0660s/iter; left time: 2448.2496s
	iters: 200, epoch: 11 | loss: 0.1093201
	speed: 0.0133s/iter; left time: 490.8956s
	iters: 300, epoch: 11 | loss: 0.0000390
	speed: 0.0143s/iter; left time: 526.5193s
	iters: 400, epoch: 11 | loss: 0.0002996
	speed: 0.0148s/iter; left time: 545.9417s
Epoch: 11 cost time: 6.291242837905884
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.081 Vali Acc: 0.972 Test Loss: 0.081 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0004499
	speed: 0.0649s/iter; left time: 2379.2120s
	iters: 200, epoch: 12 | loss: 0.0218831
	speed: 0.0140s/iter; left time: 511.6631s
	iters: 300, epoch: 12 | loss: 0.0763535
	speed: 0.0149s/iter; left time: 541.6863s
	iters: 400, epoch: 12 | loss: 0.0010811
	speed: 0.0140s/iter; left time: 508.2044s
Epoch: 12 cost time: 6.339062452316284
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.969 Test Loss: 0.109 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.3063768
	speed: 0.0627s/iter; left time: 2274.1228s
	iters: 200, epoch: 13 | loss: 0.1179722
	speed: 0.0145s/iter; left time: 524.0616s
	iters: 300, epoch: 13 | loss: 0.1392496
	speed: 0.0122s/iter; left time: 440.4080s
	iters: 400, epoch: 13 | loss: 0.0440413
	speed: 0.0142s/iter; left time: 510.3346s
Epoch: 13 cost time: 5.999876260757446
Epoch: 13, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 50742
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9444934
	speed: 0.0286s/iter; left time: 1176.8558s
	iters: 200, epoch: 1 | loss: 0.2179037
	speed: 0.0141s/iter; left time: 579.9185s
	iters: 300, epoch: 1 | loss: 0.0793736
	speed: 0.0138s/iter; left time: 565.5422s
	iters: 400, epoch: 1 | loss: 0.0545777
	speed: 0.0139s/iter; left time: 570.4192s
Epoch: 1 cost time: 7.276660680770874
Epoch: 1, Steps: 413 | Train Loss: 0.701 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (inf --> -0.931785).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1686449
	speed: 0.0606s/iter; left time: 2471.0978s
	iters: 200, epoch: 2 | loss: 0.0744511
	speed: 0.0122s/iter; left time: 496.1097s
	iters: 300, epoch: 2 | loss: 0.1162221
	speed: 0.0135s/iter; left time: 547.4631s
	iters: 400, epoch: 2 | loss: 0.0384621
	speed: 0.0125s/iter; left time: 506.7193s
Epoch: 2 cost time: 5.749980211257935
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.095 Vali Acc: 0.967 Test Loss: 0.095 Test Acc: 0.967
Validation loss decreased (-0.931785 --> -0.967257).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0059255
	speed: 0.0620s/iter; left time: 2502.0387s
	iters: 200, epoch: 3 | loss: 0.0434995
	speed: 0.0131s/iter; left time: 529.3085s
	iters: 300, epoch: 3 | loss: 0.0006878
	speed: 0.0131s/iter; left time: 527.3243s
	iters: 400, epoch: 3 | loss: 0.0216673
	speed: 0.0145s/iter; left time: 579.3022s
Epoch: 3 cost time: 6.051332473754883
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
Validation loss decreased (-0.967257 --> -0.971805).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0096352
	speed: 0.0699s/iter; left time: 2794.8054s
	iters: 200, epoch: 4 | loss: 0.0014296
	speed: 0.0141s/iter; left time: 562.5398s
	iters: 300, epoch: 4 | loss: 0.0182969
	speed: 0.0146s/iter; left time: 580.1188s
	iters: 400, epoch: 4 | loss: 0.0028028
	speed: 0.0134s/iter; left time: 531.7903s
Epoch: 4 cost time: 6.256293535232544
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
Validation loss decreased (-0.971805 --> -0.972259).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0209504
	speed: 0.0495s/iter; left time: 1958.8191s
	iters: 200, epoch: 5 | loss: 0.0047727
	speed: 0.0128s/iter; left time: 505.0435s
	iters: 300, epoch: 5 | loss: 0.0401788
	speed: 0.0122s/iter; left time: 480.1979s
	iters: 400, epoch: 5 | loss: 0.0049521
	speed: 0.0128s/iter; left time: 502.2670s
Epoch: 5 cost time: 5.455835580825806
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.076 Vali Acc: 0.972 Test Loss: 0.076 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0142024
	speed: 0.0498s/iter; left time: 1950.2348s
	iters: 200, epoch: 6 | loss: 0.0059881
	speed: 0.0136s/iter; left time: 531.5626s
	iters: 300, epoch: 6 | loss: 0.0178498
	speed: 0.0139s/iter; left time: 541.9393s
	iters: 400, epoch: 6 | loss: 0.1255798
	speed: 0.0161s/iter; left time: 623.4517s
Epoch: 6 cost time: 6.118798494338989
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.090 Vali Acc: 0.966 Test Loss: 0.090 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0748407
	speed: 0.0577s/iter; left time: 2235.8442s
	iters: 200, epoch: 7 | loss: 0.0028682
	speed: 0.0154s/iter; left time: 595.1994s
	iters: 300, epoch: 7 | loss: 0.0008016
	speed: 0.0150s/iter; left time: 576.6059s
	iters: 400, epoch: 7 | loss: 0.0041776
	speed: 0.0153s/iter; left time: 586.2102s
Epoch: 7 cost time: 6.509196996688843
Epoch: 7, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.096 Vali Acc: 0.968 Test Loss: 0.096 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0018255
	speed: 0.0645s/iter; left time: 2471.1325s
	iters: 200, epoch: 8 | loss: 0.0076679
	speed: 0.0139s/iter; left time: 532.4704s
	iters: 300, epoch: 8 | loss: 0.0002660
	speed: 0.0150s/iter; left time: 571.1215s
	iters: 400, epoch: 8 | loss: 0.0010684
	speed: 0.0142s/iter; left time: 539.5139s
Epoch: 8 cost time: 6.385082244873047
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0996761
	speed: 0.0610s/iter; left time: 2311.5082s
	iters: 200, epoch: 9 | loss: 0.0102896
	speed: 0.0149s/iter; left time: 563.5549s
	iters: 300, epoch: 9 | loss: 0.3571880
	speed: 0.0155s/iter; left time: 585.6230s
	iters: 400, epoch: 9 | loss: 0.0101513
	speed: 0.0148s/iter; left time: 554.6705s
Epoch: 9 cost time: 6.744870662689209
Epoch: 9, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0146263
	speed: 0.0655s/iter; left time: 2456.9239s
	iters: 200, epoch: 10 | loss: 0.0027186
	speed: 0.0162s/iter; left time: 607.3633s
	iters: 300, epoch: 10 | loss: 0.0010818
	speed: 0.0131s/iter; left time: 487.0362s
	iters: 400, epoch: 10 | loss: 0.0000628
	speed: 0.0118s/iter; left time: 439.7023s
Epoch: 10 cost time: 6.341283082962036
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0272157
	speed: 0.0505s/iter; left time: 1870.8291s
	iters: 200, epoch: 11 | loss: 0.0003715
	speed: 0.0104s/iter; left time: 385.8449s
	iters: 300, epoch: 11 | loss: 0.1013318
	speed: 0.0104s/iter; left time: 382.8312s
	iters: 400, epoch: 11 | loss: 0.0079703
	speed: 0.0106s/iter; left time: 391.3460s
Epoch: 11 cost time: 4.828970193862915
Epoch: 11, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.3365997
	speed: 0.0516s/iter; left time: 1890.6473s
	iters: 200, epoch: 12 | loss: 0.0073236
	speed: 0.0112s/iter; left time: 409.2319s
	iters: 300, epoch: 12 | loss: 0.2029395
	speed: 0.0142s/iter; left time: 519.1108s
	iters: 400, epoch: 12 | loss: 0.0000105
	speed: 0.0140s/iter; left time: 509.9559s
Epoch: 12 cost time: 5.471358060836792
Epoch: 12, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0030066
	speed: 0.0607s/iter; left time: 2199.3891s
	iters: 200, epoch: 13 | loss: 0.0000094
	speed: 0.0128s/iter; left time: 462.4715s
	iters: 300, epoch: 13 | loss: 0.0008196
	speed: 0.0142s/iter; left time: 511.0389s
	iters: 400, epoch: 13 | loss: 0.0048777
	speed: 0.0140s/iter; left time: 503.5316s
Epoch: 13 cost time: 6.080883264541626
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.249 Vali Acc: 0.955 Test Loss: 0.249 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0001859
	speed: 0.0630s/iter; left time: 2258.8755s
	iters: 200, epoch: 14 | loss: 0.0109399
	speed: 0.0143s/iter; left time: 511.9489s
	iters: 300, epoch: 14 | loss: 0.0114914
	speed: 0.0136s/iter; left time: 484.8077s
	iters: 400, epoch: 14 | loss: 0.0000916
	speed: 0.0148s/iter; left time: 524.4872s
Epoch: 14 cost time: 6.4607648849487305
Epoch: 14, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 50743
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2168860
	speed: 0.0258s/iter; left time: 1060.9825s
	iters: 200, epoch: 1 | loss: 0.3607517
	speed: 0.0121s/iter; left time: 496.1934s
	iters: 300, epoch: 1 | loss: 0.1565674
	speed: 0.0130s/iter; left time: 534.0739s
	iters: 400, epoch: 1 | loss: 0.0498605
	speed: 0.0125s/iter; left time: 509.4957s
Epoch: 1 cost time: 6.545305967330933
Epoch: 1, Steps: 413 | Train Loss: 0.739 Vali Loss: 0.132 Vali Acc: 0.956 Test Loss: 0.132 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0555472
	speed: 0.0474s/iter; left time: 1933.1957s
	iters: 200, epoch: 2 | loss: 0.1834226
	speed: 0.0133s/iter; left time: 540.1095s
	iters: 300, epoch: 2 | loss: 0.0181448
	speed: 0.0116s/iter; left time: 472.1808s
	iters: 400, epoch: 2 | loss: 0.0395718
	speed: 0.0120s/iter; left time: 484.8388s
Epoch: 2 cost time: 5.248668909072876
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.955888 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0459426
	speed: 0.0465s/iter; left time: 1878.2064s
	iters: 200, epoch: 3 | loss: 0.0674310
	speed: 0.0133s/iter; left time: 535.4678s
	iters: 300, epoch: 3 | loss: 0.0044350
	speed: 0.0126s/iter; left time: 504.4902s
	iters: 400, epoch: 3 | loss: 0.0502029
	speed: 0.0132s/iter; left time: 527.0666s
Epoch: 3 cost time: 6.104855537414551
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.973169 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0145412
	speed: 0.0654s/iter; left time: 2613.7779s
	iters: 200, epoch: 4 | loss: 0.0252207
	speed: 0.0140s/iter; left time: 557.8100s
	iters: 300, epoch: 4 | loss: 0.0439985
	speed: 0.0139s/iter; left time: 552.7142s
	iters: 400, epoch: 4 | loss: 0.0261570
	speed: 0.0143s/iter; left time: 568.1359s
Epoch: 4 cost time: 6.293333530426025
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.084 Vali Acc: 0.970 Test Loss: 0.084 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0059736
	speed: 0.0633s/iter; left time: 2503.3425s
	iters: 200, epoch: 5 | loss: 0.1051306
	speed: 0.0131s/iter; left time: 516.3983s
	iters: 300, epoch: 5 | loss: 0.0100324
	speed: 0.0139s/iter; left time: 546.3406s
	iters: 400, epoch: 5 | loss: 0.0018614
	speed: 0.0139s/iter; left time: 544.2153s
Epoch: 5 cost time: 6.0520641803741455
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.089 Vali Acc: 0.971 Test Loss: 0.089 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0124475
	speed: 0.0647s/iter; left time: 2533.2757s
	iters: 200, epoch: 6 | loss: 0.0274184
	speed: 0.0136s/iter; left time: 531.8536s
	iters: 300, epoch: 6 | loss: 0.0443430
	speed: 0.0137s/iter; left time: 533.5574s
	iters: 400, epoch: 6 | loss: 0.0029175
	speed: 0.0135s/iter; left time: 524.7102s
Epoch: 6 cost time: 6.0296289920806885
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.961 Test Loss: 0.142 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.2914764
	speed: 0.0577s/iter; left time: 2233.2649s
	iters: 200, epoch: 7 | loss: 0.0010605
	speed: 0.0112s/iter; left time: 432.1479s
	iters: 300, epoch: 7 | loss: 0.0008861
	speed: 0.0120s/iter; left time: 462.2729s
	iters: 400, epoch: 7 | loss: 0.0504653
	speed: 0.0146s/iter; left time: 560.3644s
Epoch: 7 cost time: 5.516636848449707
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.100 Vali Acc: 0.967 Test Loss: 0.100 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0035695
	speed: 0.0568s/iter; left time: 2176.7492s
	iters: 200, epoch: 8 | loss: 0.0020057
	speed: 0.0131s/iter; left time: 498.6700s
	iters: 300, epoch: 8 | loss: 0.0006094
	speed: 0.0137s/iter; left time: 521.1644s
	iters: 400, epoch: 8 | loss: 0.0104377
	speed: 0.0135s/iter; left time: 511.4221s
Epoch: 8 cost time: 5.850770473480225
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0007709
	speed: 0.0537s/iter; left time: 2034.5184s
	iters: 200, epoch: 9 | loss: 0.2802493
	speed: 0.0131s/iter; left time: 496.4711s
	iters: 300, epoch: 9 | loss: 0.0000971
	speed: 0.0148s/iter; left time: 558.0249s
	iters: 400, epoch: 9 | loss: 0.0000400
	speed: 0.0149s/iter; left time: 561.4335s
Epoch: 9 cost time: 5.984453916549683
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0008201
	speed: 0.0610s/iter; left time: 2286.3126s
	iters: 200, epoch: 10 | loss: 0.0000030
	speed: 0.0140s/iter; left time: 521.5188s
	iters: 300, epoch: 10 | loss: 0.0021571
	speed: 0.0147s/iter; left time: 546.7964s
	iters: 400, epoch: 10 | loss: 0.0038063
	speed: 0.0138s/iter; left time: 511.3582s
Epoch: 10 cost time: 6.383757591247559
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0121889
	speed: 0.0622s/iter; left time: 2307.6482s
	iters: 200, epoch: 11 | loss: 0.0000431
	speed: 0.0141s/iter; left time: 520.1656s
	iters: 300, epoch: 11 | loss: 0.0010454
	speed: 0.0156s/iter; left time: 576.0563s
	iters: 400, epoch: 11 | loss: 0.0004593
	speed: 0.0138s/iter; left time: 506.4699s
Epoch: 11 cost time: 6.453654766082764
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0013415
	speed: 0.0675s/iter; left time: 2473.4164s
	iters: 200, epoch: 12 | loss: 0.0208934
	speed: 0.0150s/iter; left time: 550.0998s
	iters: 300, epoch: 12 | loss: 0.0000041
	speed: 0.0130s/iter; left time: 474.7552s
	iters: 400, epoch: 12 | loss: 0.0010480
	speed: 0.0137s/iter; left time: 497.2342s
Epoch: 12 cost time: 6.483055830001831
Epoch: 12, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.964 Test Loss: 0.185 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000009
	speed: 0.0508s/iter; left time: 1840.7757s
	iters: 200, epoch: 13 | loss: 0.0375770
	speed: 0.0119s/iter; left time: 429.5831s
	iters: 300, epoch: 13 | loss: 0.0011503
	speed: 0.0126s/iter; left time: 452.8228s
	iters: 400, epoch: 13 | loss: 0.0000191
	speed: 0.0107s/iter; left time: 386.3848s
Epoch: 13 cost time: 5.328455209732056
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.273 Vali Acc: 0.955 Test Loss: 0.273 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9731696225557072
model parameter : 32092
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2359869
	speed: 0.0330s/iter; left time: 1357.7766s
	iters: 200, epoch: 1 | loss: 0.6129500
	speed: 0.0162s/iter; left time: 665.9127s
	iters: 300, epoch: 1 | loss: 0.1748201
	speed: 0.0153s/iter; left time: 626.5215s
	iters: 400, epoch: 1 | loss: 1.1920244
	speed: 0.0143s/iter; left time: 586.3520s
Epoch: 1 cost time: 8.108555793762207
Epoch: 1, Steps: 413 | Train Loss: 0.752 Vali Loss: 0.143 Vali Acc: 0.953 Test Loss: 0.143 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0810190
	speed: 0.0694s/iter; left time: 2829.6545s
	iters: 200, epoch: 2 | loss: 0.1821947
	speed: 0.0150s/iter; left time: 612.2226s
	iters: 300, epoch: 2 | loss: 0.0776286
	speed: 0.0128s/iter; left time: 520.5959s
	iters: 400, epoch: 2 | loss: 0.0532096
	speed: 0.0125s/iter; left time: 507.6927s
Epoch: 2 cost time: 6.066002130508423
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.117 Vali Acc: 0.959 Test Loss: 0.117 Test Acc: 0.959
Validation loss decreased (-0.953159 --> -0.958616).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1838232
	speed: 0.0618s/iter; left time: 2497.0589s
	iters: 200, epoch: 3 | loss: 0.1178382
	speed: 0.0142s/iter; left time: 571.5351s
	iters: 300, epoch: 3 | loss: 0.0611862
	speed: 0.0120s/iter; left time: 483.7469s
	iters: 400, epoch: 3 | loss: 0.1515953
	speed: 0.0132s/iter; left time: 527.3450s
Epoch: 3 cost time: 6.106159687042236
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.087 Vali Acc: 0.968 Test Loss: 0.087 Test Acc: 0.968
Validation loss decreased (-0.958616 --> -0.967712).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0120022
	speed: 0.0647s/iter; left time: 2586.6799s
	iters: 200, epoch: 4 | loss: 0.0282989
	speed: 0.0119s/iter; left time: 473.3008s
	iters: 300, epoch: 4 | loss: 0.1896544
	speed: 0.0126s/iter; left time: 502.9780s
	iters: 400, epoch: 4 | loss: 0.0038121
	speed: 0.0121s/iter; left time: 480.5527s
Epoch: 4 cost time: 5.8740129470825195
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
Validation loss decreased (-0.967712 --> -0.970895).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0023756
	speed: 0.0551s/iter; left time: 2177.3764s
	iters: 200, epoch: 5 | loss: 0.0006159
	speed: 0.0121s/iter; left time: 477.3521s
	iters: 300, epoch: 5 | loss: 0.0079874
	speed: 0.0132s/iter; left time: 517.4435s
	iters: 400, epoch: 5 | loss: 0.0213128
	speed: 0.0133s/iter; left time: 520.0648s
Epoch: 5 cost time: 5.60465669631958
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.098 Vali Acc: 0.968 Test Loss: 0.098 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0782615
	speed: 0.0573s/iter; left time: 2242.2058s
	iters: 200, epoch: 6 | loss: 0.0009770
	speed: 0.0125s/iter; left time: 489.0309s
	iters: 300, epoch: 6 | loss: 0.0397427
	speed: 0.0142s/iter; left time: 552.7640s
	iters: 400, epoch: 6 | loss: 0.0655651
	speed: 0.0137s/iter; left time: 531.1511s
Epoch: 6 cost time: 5.868287086486816
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.1243246
	speed: 0.0657s/iter; left time: 2543.4362s
	iters: 200, epoch: 7 | loss: 0.0033614
	speed: 0.0146s/iter; left time: 562.0099s
	iters: 300, epoch: 7 | loss: 0.0021906
	speed: 0.0148s/iter; left time: 568.5354s
	iters: 400, epoch: 7 | loss: 0.0102503
	speed: 0.0149s/iter; left time: 571.7605s
Epoch: 7 cost time: 6.416217565536499
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0008470
	speed: 0.0585s/iter; left time: 2239.4525s
	iters: 200, epoch: 8 | loss: 0.0008823
	speed: 0.0130s/iter; left time: 495.8991s
	iters: 300, epoch: 8 | loss: 0.0232400
	speed: 0.0140s/iter; left time: 534.8509s
	iters: 400, epoch: 8 | loss: 0.0033337
	speed: 0.0148s/iter; left time: 562.5024s
Epoch: 8 cost time: 6.183614015579224
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.959 Test Loss: 0.133 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0057843
	speed: 0.0610s/iter; left time: 2311.6307s
	iters: 200, epoch: 9 | loss: 0.0318500
	speed: 0.0140s/iter; left time: 527.4846s
	iters: 300, epoch: 9 | loss: 0.0009181
	speed: 0.0138s/iter; left time: 519.7747s
	iters: 400, epoch: 9 | loss: 0.0013578
	speed: 0.0125s/iter; left time: 471.1149s
Epoch: 9 cost time: 6.134979963302612
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0589210
	speed: 0.0609s/iter; left time: 2283.5408s
	iters: 200, epoch: 10 | loss: 0.0005675
	speed: 0.0134s/iter; left time: 499.8316s
	iters: 300, epoch: 10 | loss: 0.0031288
	speed: 0.0120s/iter; left time: 448.5488s
	iters: 400, epoch: 10 | loss: 0.0410481
	speed: 0.0119s/iter; left time: 443.8348s
Epoch: 10 cost time: 5.7836291790008545
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0067595
	speed: 0.0552s/iter; left time: 2047.4504s
	iters: 200, epoch: 11 | loss: 0.0183710
	speed: 0.0152s/iter; left time: 560.5727s
	iters: 300, epoch: 11 | loss: 0.0002095
	speed: 0.0131s/iter; left time: 482.9998s
	iters: 400, epoch: 11 | loss: 0.3521051
	speed: 0.0124s/iter; left time: 456.5050s
Epoch: 11 cost time: 5.985728740692139
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.1324054
	speed: 0.0583s/iter; left time: 2136.8441s
	iters: 200, epoch: 12 | loss: 0.0079904
	speed: 0.0120s/iter; left time: 437.1195s
	iters: 300, epoch: 12 | loss: 0.0000136
	speed: 0.0121s/iter; left time: 441.0774s
	iters: 400, epoch: 12 | loss: 0.0000191
	speed: 0.0121s/iter; left time: 440.1115s
Epoch: 12 cost time: 5.50355076789856
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0008776
	speed: 0.0592s/iter; left time: 2146.8959s
	iters: 200, epoch: 13 | loss: 0.0084034
	speed: 0.0143s/iter; left time: 515.9828s
	iters: 300, epoch: 13 | loss: 0.0012094
	speed: 0.0127s/iter; left time: 458.5244s
	iters: 400, epoch: 13 | loss: 0.0003875
	speed: 0.0142s/iter; left time: 510.5900s
Epoch: 13 cost time: 6.067804336547852
Epoch: 13, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.226 Vali Acc: 0.955 Test Loss: 0.226 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0006506
	speed: 0.0649s/iter; left time: 2325.3844s
	iters: 200, epoch: 14 | loss: 0.0007316
	speed: 0.0129s/iter; left time: 459.8881s
	iters: 300, epoch: 14 | loss: 0.0152542
	speed: 0.0128s/iter; left time: 457.4561s
	iters: 400, epoch: 14 | loss: 0.0000635
	speed: 0.0141s/iter; left time: 501.3132s
Epoch: 14 cost time: 5.889445543289185
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.966 Test Loss: 0.205 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9708958617553434
model parameter : 30989
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2274535
	speed: 0.0269s/iter; left time: 1106.9779s
	iters: 200, epoch: 1 | loss: 0.5200287
	speed: 0.0128s/iter; left time: 524.6145s
	iters: 300, epoch: 1 | loss: 0.2258993
	speed: 0.0124s/iter; left time: 509.0857s
	iters: 400, epoch: 1 | loss: 0.1006771
	speed: 0.0133s/iter; left time: 542.2599s
Epoch: 1 cost time: 6.768932342529297
Epoch: 1, Steps: 413 | Train Loss: 0.766 Vali Loss: 0.154 Vali Acc: 0.950 Test Loss: 0.154 Test Acc: 0.950
Validation loss decreased (inf --> -0.949976).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0782599
	speed: 0.0564s/iter; left time: 2301.0645s
	iters: 200, epoch: 2 | loss: 0.1201885
	speed: 0.0123s/iter; left time: 501.1220s
	iters: 300, epoch: 2 | loss: 0.2589056
	speed: 0.0121s/iter; left time: 492.0249s
	iters: 400, epoch: 2 | loss: 0.0145325
	speed: 0.0134s/iter; left time: 540.6144s
Epoch: 2 cost time: 5.6708197593688965
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.090 Vali Acc: 0.966 Test Loss: 0.090 Test Acc: 0.966
Validation loss decreased (-0.949976 --> -0.965893).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1726544
	speed: 0.0594s/iter; left time: 2397.8321s
	iters: 200, epoch: 3 | loss: 0.0790908
	speed: 0.0140s/iter; left time: 563.9721s
	iters: 300, epoch: 3 | loss: 0.0273341
	speed: 0.0141s/iter; left time: 565.3416s
	iters: 400, epoch: 3 | loss: 0.0460256
	speed: 0.0159s/iter; left time: 636.1552s
Epoch: 3 cost time: 6.38341760635376
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.082 Vali Acc: 0.975 Test Loss: 0.082 Test Acc: 0.975
Validation loss decreased (-0.965893 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0326348
	speed: 0.0609s/iter; left time: 2433.5617s
	iters: 200, epoch: 4 | loss: 0.0378659
	speed: 0.0143s/iter; left time: 571.0224s
	iters: 300, epoch: 4 | loss: 0.0122740
	speed: 0.0142s/iter; left time: 563.7991s
	iters: 400, epoch: 4 | loss: 0.1549121
	speed: 0.0138s/iter; left time: 547.1848s
Epoch: 4 cost time: 6.11519193649292
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.071 Vali Acc: 0.977 Test Loss: 0.071 Test Acc: 0.977
Validation loss decreased (-0.974533 --> -0.976807).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0029793
	speed: 0.0617s/iter; left time: 2441.2736s
	iters: 200, epoch: 5 | loss: 0.0507037
	speed: 0.0151s/iter; left time: 595.6663s
	iters: 300, epoch: 5 | loss: 0.0068328
	speed: 0.0152s/iter; left time: 596.8267s
	iters: 400, epoch: 5 | loss: 0.0379607
	speed: 0.0140s/iter; left time: 547.6812s
Epoch: 5 cost time: 6.393773078918457
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.973 Test Loss: 0.094 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0033992
	speed: 0.0619s/iter; left time: 2422.5376s
	iters: 200, epoch: 6 | loss: 0.0058661
	speed: 0.0128s/iter; left time: 499.3212s
	iters: 300, epoch: 6 | loss: 0.0199184
	speed: 0.0144s/iter; left time: 560.5673s
	iters: 400, epoch: 6 | loss: 0.0040255
	speed: 0.0129s/iter; left time: 502.4255s
Epoch: 6 cost time: 6.045784950256348
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0210958
	speed: 0.0488s/iter; left time: 1888.8539s
	iters: 200, epoch: 7 | loss: 0.0543037
	speed: 0.0125s/iter; left time: 481.5366s
	iters: 300, epoch: 7 | loss: 0.0015914
	speed: 0.0137s/iter; left time: 528.3023s
	iters: 400, epoch: 7 | loss: 0.0802519
	speed: 0.0121s/iter; left time: 465.5152s
Epoch: 7 cost time: 5.765438795089722
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.104 Vali Acc: 0.973 Test Loss: 0.104 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0017249
	speed: 0.0532s/iter; left time: 2039.7968s
	iters: 200, epoch: 8 | loss: 0.0001829
	speed: 0.0134s/iter; left time: 510.4228s
	iters: 300, epoch: 8 | loss: 0.0118734
	speed: 0.0123s/iter; left time: 467.1268s
	iters: 400, epoch: 8 | loss: 0.0001372
	speed: 0.0133s/iter; left time: 505.6773s
Epoch: 8 cost time: 5.750577211380005
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0467966
	speed: 0.0596s/iter; left time: 2256.7841s
	iters: 200, epoch: 9 | loss: 0.0301340
	speed: 0.0135s/iter; left time: 510.4718s
	iters: 300, epoch: 9 | loss: 0.0018565
	speed: 0.0129s/iter; left time: 487.1451s
	iters: 400, epoch: 9 | loss: 0.0290659
	speed: 0.0130s/iter; left time: 488.2000s
Epoch: 9 cost time: 5.967652320861816
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0000413
	speed: 0.0647s/iter; left time: 2425.4081s
	iters: 200, epoch: 10 | loss: 0.0010707
	speed: 0.0122s/iter; left time: 454.2601s
	iters: 300, epoch: 10 | loss: 0.0034221
	speed: 0.0121s/iter; left time: 451.1523s
	iters: 400, epoch: 10 | loss: 0.0239058
	speed: 0.0145s/iter; left time: 540.3472s
Epoch: 10 cost time: 5.857774972915649
Epoch: 10, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000742
	speed: 0.0645s/iter; left time: 2389.9000s
	iters: 200, epoch: 11 | loss: 0.0052882
	speed: 0.0130s/iter; left time: 482.2338s
	iters: 300, epoch: 11 | loss: 0.0005510
	speed: 0.0134s/iter; left time: 492.7282s
	iters: 400, epoch: 11 | loss: 0.0003808
	speed: 0.0136s/iter; left time: 498.8782s
Epoch: 11 cost time: 5.9734156131744385
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0127269
	speed: 0.0594s/iter; left time: 2176.6422s
	iters: 200, epoch: 12 | loss: 0.0000330
	speed: 0.0116s/iter; left time: 425.8390s
	iters: 300, epoch: 12 | loss: 0.0061397
	speed: 0.0152s/iter; left time: 552.4349s
	iters: 400, epoch: 12 | loss: 0.0000935
	speed: 0.0144s/iter; left time: 522.0147s
Epoch: 12 cost time: 5.801401615142822
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0129592
	speed: 0.0514s/iter; left time: 1862.2618s
	iters: 200, epoch: 13 | loss: 0.0000156
	speed: 0.0118s/iter; left time: 426.1311s
	iters: 300, epoch: 13 | loss: 0.0000015
	speed: 0.0129s/iter; left time: 463.3336s
	iters: 400, epoch: 13 | loss: 0.0002781
	speed: 0.0134s/iter; left time: 482.0196s
Epoch: 13 cost time: 5.559215307235718
Epoch: 13, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976807 --> -0.977261).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0001263
	speed: 0.0504s/iter; left time: 1806.1108s
	iters: 200, epoch: 14 | loss: 0.0632789
	speed: 0.0126s/iter; left time: 449.6960s
	iters: 300, epoch: 14 | loss: 0.0382271
	speed: 0.0134s/iter; left time: 478.2315s
	iters: 400, epoch: 14 | loss: 0.0005951
	speed: 0.0139s/iter; left time: 493.7246s
Epoch: 14 cost time: 5.899080753326416
Epoch: 14, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.976 Test Loss: 0.157 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0027980
	speed: 0.0577s/iter; left time: 2042.7955s
	iters: 200, epoch: 15 | loss: 0.0000127
	speed: 0.0137s/iter; left time: 484.7128s
	iters: 300, epoch: 15 | loss: 0.0024514
	speed: 0.0144s/iter; left time: 506.2927s
	iters: 400, epoch: 15 | loss: 0.0002080
	speed: 0.0146s/iter; left time: 511.7502s
Epoch: 15 cost time: 6.378631114959717
Epoch: 15, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0000243
	speed: 0.0588s/iter; left time: 2059.6608s
	iters: 200, epoch: 16 | loss: 0.0000453
	speed: 0.0147s/iter; left time: 511.6556s
	iters: 300, epoch: 16 | loss: 0.0039694
	speed: 0.0137s/iter; left time: 475.2860s
	iters: 400, epoch: 16 | loss: 0.0111618
	speed: 0.0142s/iter; left time: 491.9829s
Epoch: 16 cost time: 6.283900260925293
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.1157233
	speed: 0.0585s/iter; left time: 2024.4249s
	iters: 200, epoch: 17 | loss: 0.1580025
	speed: 0.0134s/iter; left time: 460.8960s
	iters: 300, epoch: 17 | loss: 0.0032297
	speed: 0.0127s/iter; left time: 437.3838s
	iters: 400, epoch: 17 | loss: 0.0023427
	speed: 0.0133s/iter; left time: 454.5043s
Epoch: 17 cost time: 5.861822843551636
Epoch: 17, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000145
	speed: 0.0552s/iter; left time: 1885.1457s
	iters: 200, epoch: 18 | loss: 0.0000053
	speed: 0.0114s/iter; left time: 388.5678s
	iters: 300, epoch: 18 | loss: 0.0000716
	speed: 0.0121s/iter; left time: 410.7097s
	iters: 400, epoch: 18 | loss: 0.0002399
	speed: 0.0111s/iter; left time: 376.3168s
Epoch: 18 cost time: 5.223773002624512
Epoch: 18, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0000559
	speed: 0.0511s/iter; left time: 1725.5513s
	iters: 200, epoch: 19 | loss: 0.0000004
	speed: 0.0119s/iter; left time: 400.2117s
	iters: 300, epoch: 19 | loss: 0.3287284
	speed: 0.0113s/iter; left time: 379.3298s
	iters: 400, epoch: 19 | loss: 0.0000006
	speed: 0.0128s/iter; left time: 427.1021s
Epoch: 19 cost time: 5.354630708694458
Epoch: 19, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.278 Vali Acc: 0.961 Test Loss: 0.278 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0000575
	speed: 0.0535s/iter; left time: 1784.2756s
	iters: 200, epoch: 20 | loss: 0.0006223
	speed: 0.0108s/iter; left time: 359.9414s
	iters: 300, epoch: 20 | loss: 0.0545558
	speed: 0.0117s/iter; left time: 387.2016s
	iters: 400, epoch: 20 | loss: 0.0000025
	speed: 0.0135s/iter; left time: 446.7128s
Epoch: 20 cost time: 5.3173887729644775
Epoch: 20, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.0004596
	speed: 0.0595s/iter; left time: 1961.2540s
	iters: 200, epoch: 21 | loss: 0.0000003
	speed: 0.0116s/iter; left time: 382.0740s
	iters: 300, epoch: 21 | loss: 0.0000077
	speed: 0.0161s/iter; left time: 527.1856s
	iters: 400, epoch: 21 | loss: 0.0000021
	speed: 0.0134s/iter; left time: 438.6380s
Epoch: 21 cost time: 5.940370082855225
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.324 Vali Acc: 0.954 Test Loss: 0.324 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0559s/iter; left time: 1819.8452s
	iters: 200, epoch: 22 | loss: 0.0000001
	speed: 0.0120s/iter; left time: 389.0543s
	iters: 300, epoch: 22 | loss: 0.0000001
	speed: 0.0133s/iter; left time: 429.4964s
	iters: 400, epoch: 22 | loss: 0.0000070
	speed: 0.0135s/iter; left time: 434.7276s
Epoch: 22 cost time: 5.596306562423706
Epoch: 22, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000200
	speed: 0.0587s/iter; left time: 1885.9182s
	iters: 200, epoch: 23 | loss: 0.0000002
	speed: 0.0135s/iter; left time: 433.6241s
	iters: 300, epoch: 23 | loss: 0.0051372
	speed: 0.0153s/iter; left time: 489.3970s
	iters: 400, epoch: 23 | loss: 0.0000000
	speed: 0.0146s/iter; left time: 464.5858s
Epoch: 23 cost time: 6.16634202003479
Epoch: 23, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.977262391996362
model parameter : 30838
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1379527
	speed: 0.0261s/iter; left time: 1074.6457s
	iters: 200, epoch: 1 | loss: 0.3042134
	speed: 0.0118s/iter; left time: 486.6705s
	iters: 300, epoch: 1 | loss: 0.2593387
	speed: 0.0123s/iter; left time: 502.4264s
	iters: 400, epoch: 1 | loss: 0.3527647
	speed: 0.0116s/iter; left time: 473.2237s
Epoch: 1 cost time: 6.374133110046387
Epoch: 1, Steps: 413 | Train Loss: 0.745 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
Validation loss decreased (inf --> -0.960890).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0452521
	speed: 0.0409s/iter; left time: 1667.5895s
	iters: 200, epoch: 2 | loss: 0.0215634
	speed: 0.0124s/iter; left time: 506.5156s
	iters: 300, epoch: 2 | loss: 0.0552168
	speed: 0.0134s/iter; left time: 543.8989s
	iters: 400, epoch: 2 | loss: 0.0316995
	speed: 0.0121s/iter; left time: 490.9701s
Epoch: 2 cost time: 5.634148120880127
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
Validation loss decreased (-0.960890 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1497422
	speed: 0.0442s/iter; left time: 1784.3866s
	iters: 200, epoch: 3 | loss: 0.0364698
	speed: 0.0122s/iter; left time: 490.3849s
	iters: 300, epoch: 3 | loss: 0.0931502
	speed: 0.0118s/iter; left time: 473.6146s
	iters: 400, epoch: 3 | loss: 0.0122829
	speed: 0.0111s/iter; left time: 443.7611s
Epoch: 3 cost time: 5.154864549636841
Epoch: 3, Steps: 413 | Train Loss: 0.069 Vali Loss: 0.078 Vali Acc: 0.977 Test Loss: 0.078 Test Acc: 0.977
Validation loss decreased (-0.968621 --> -0.976807).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1473810
	speed: 0.0494s/iter; left time: 1972.9415s
	iters: 200, epoch: 4 | loss: 0.0069629
	speed: 0.0116s/iter; left time: 462.2399s
	iters: 300, epoch: 4 | loss: 0.0164758
	speed: 0.0118s/iter; left time: 468.3737s
	iters: 400, epoch: 4 | loss: 0.0110713
	speed: 0.0130s/iter; left time: 514.7301s
Epoch: 4 cost time: 5.671515226364136
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.086 Vali Acc: 0.973 Test Loss: 0.086 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0227827
	speed: 0.0605s/iter; left time: 2392.4388s
	iters: 200, epoch: 5 | loss: 0.0190697
	speed: 0.0125s/iter; left time: 491.3065s
	iters: 300, epoch: 5 | loss: 0.0022419
	speed: 0.0148s/iter; left time: 583.2528s
	iters: 400, epoch: 5 | loss: 0.0115562
	speed: 0.0153s/iter; left time: 598.9335s
Epoch: 5 cost time: 6.228919267654419
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.089 Vali Acc: 0.967 Test Loss: 0.089 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0110801
	speed: 0.0597s/iter; left time: 2335.8723s
	iters: 200, epoch: 6 | loss: 0.0071637
	speed: 0.0133s/iter; left time: 520.8146s
	iters: 300, epoch: 6 | loss: 0.0601619
	speed: 0.0140s/iter; left time: 546.4206s
	iters: 400, epoch: 6 | loss: 0.0031439
	speed: 0.0143s/iter; left time: 554.0821s
Epoch: 6 cost time: 6.092010259628296
Epoch: 6, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0022704
	speed: 0.0585s/iter; left time: 2263.8967s
	iters: 200, epoch: 7 | loss: 0.0380041
	speed: 0.0144s/iter; left time: 554.3840s
	iters: 300, epoch: 7 | loss: 0.0118289
	speed: 0.0147s/iter; left time: 565.7662s
	iters: 400, epoch: 7 | loss: 0.1700271
	speed: 0.0148s/iter; left time: 567.2010s
Epoch: 7 cost time: 6.354040861129761
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0020066
	speed: 0.0519s/iter; left time: 1990.1080s
	iters: 200, epoch: 8 | loss: 0.0018800
	speed: 0.0132s/iter; left time: 504.5636s
	iters: 300, epoch: 8 | loss: 0.0019357
	speed: 0.0116s/iter; left time: 440.6913s
	iters: 400, epoch: 8 | loss: 0.0000305
	speed: 0.0123s/iter; left time: 467.8131s
Epoch: 8 cost time: 5.540292263031006
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.972 Test Loss: 0.088 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.1301798
	speed: 0.0456s/iter; left time: 1727.7580s
	iters: 200, epoch: 9 | loss: 0.0005546
	speed: 0.0114s/iter; left time: 429.9302s
	iters: 300, epoch: 9 | loss: 0.0001160
	speed: 0.0117s/iter; left time: 442.9248s
	iters: 400, epoch: 9 | loss: 0.0179308
	speed: 0.0120s/iter; left time: 450.3800s
Epoch: 9 cost time: 5.197918891906738
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.970 Test Loss: 0.098 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.1096059
	speed: 0.0491s/iter; left time: 1839.5835s
	iters: 200, epoch: 10 | loss: 0.0221574
	speed: 0.0118s/iter; left time: 439.5041s
	iters: 300, epoch: 10 | loss: 0.1731783
	speed: 0.0132s/iter; left time: 490.9265s
	iters: 400, epoch: 10 | loss: 0.0008593
	speed: 0.0132s/iter; left time: 491.1786s
Epoch: 10 cost time: 5.5312676429748535
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0724824
	speed: 0.0589s/iter; left time: 2182.4166s
	iters: 200, epoch: 11 | loss: 0.0004580
	speed: 0.0129s/iter; left time: 476.2664s
	iters: 300, epoch: 11 | loss: 0.0015378
	speed: 0.0145s/iter; left time: 536.0147s
	iters: 400, epoch: 11 | loss: 0.0079972
	speed: 0.0140s/iter; left time: 516.4149s
Epoch: 11 cost time: 5.954535961151123
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000545
	speed: 0.0533s/iter; left time: 1953.6468s
	iters: 200, epoch: 12 | loss: 0.0000233
	speed: 0.0146s/iter; left time: 532.3624s
	iters: 300, epoch: 12 | loss: 0.0010533
	speed: 0.0142s/iter; left time: 517.1829s
	iters: 400, epoch: 12 | loss: 0.0008384
	speed: 0.0137s/iter; left time: 497.2069s
Epoch: 12 cost time: 6.0583579540252686
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.964 Test Loss: 0.200 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0018153
	speed: 0.0517s/iter; left time: 1873.7430s
	iters: 200, epoch: 13 | loss: 0.0005203
	speed: 0.0124s/iter; left time: 449.4138s
	iters: 300, epoch: 13 | loss: 0.0000048
	speed: 0.0117s/iter; left time: 421.0046s
	iters: 400, epoch: 13 | loss: 0.0068607
	speed: 0.0113s/iter; left time: 407.3116s
Epoch: 13 cost time: 5.489836692810059
Epoch: 13, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 30447
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2073491
	speed: 0.0262s/iter; left time: 1079.7183s
	iters: 200, epoch: 1 | loss: 0.6440488
	speed: 0.0144s/iter; left time: 590.5384s
	iters: 300, epoch: 1 | loss: 0.3852676
	speed: 0.0149s/iter; left time: 612.6292s
	iters: 400, epoch: 1 | loss: 0.1346069
	speed: 0.0121s/iter; left time: 493.9149s
Epoch: 1 cost time: 6.928278207778931
Epoch: 1, Steps: 413 | Train Loss: 0.726 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0892792
	speed: 0.0617s/iter; left time: 2516.5607s
	iters: 200, epoch: 2 | loss: 0.0687910
	speed: 0.0132s/iter; left time: 538.8952s
	iters: 300, epoch: 2 | loss: 0.0284101
	speed: 0.0119s/iter; left time: 482.7964s
	iters: 400, epoch: 2 | loss: 0.7203594
	speed: 0.0128s/iter; left time: 519.5102s
Epoch: 2 cost time: 5.921741962432861
Epoch: 2, Steps: 413 | Train Loss: 0.109 Vali Loss: 0.097 Vali Acc: 0.967 Test Loss: 0.097 Test Acc: 0.967
Validation loss decreased (-0.953614 --> -0.966802).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0057680
	speed: 0.0592s/iter; left time: 2388.6829s
	iters: 200, epoch: 3 | loss: 0.1785333
	speed: 0.0123s/iter; left time: 497.3062s
	iters: 300, epoch: 3 | loss: 0.0343523
	speed: 0.0120s/iter; left time: 483.4317s
	iters: 400, epoch: 3 | loss: 0.0074956
	speed: 0.0120s/iter; left time: 481.5474s
Epoch: 3 cost time: 5.537100076675415
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.091 Vali Acc: 0.969 Test Loss: 0.091 Test Acc: 0.969
Validation loss decreased (-0.966802 --> -0.968621).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0152584
	speed: 0.0529s/iter; left time: 2113.6405s
	iters: 200, epoch: 4 | loss: 0.0049403
	speed: 0.0114s/iter; left time: 452.6951s
	iters: 300, epoch: 4 | loss: 0.0123514
	speed: 0.0115s/iter; left time: 458.3127s
	iters: 400, epoch: 4 | loss: 0.0230824
	speed: 0.0112s/iter; left time: 445.9154s
Epoch: 4 cost time: 5.1055145263671875
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.968621 --> -0.969985).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0464570
	speed: 0.0465s/iter; left time: 1839.3495s
	iters: 200, epoch: 5 | loss: 0.0015631
	speed: 0.0110s/iter; left time: 433.1427s
	iters: 300, epoch: 5 | loss: 0.0109840
	speed: 0.0109s/iter; left time: 430.2386s
	iters: 400, epoch: 5 | loss: 0.0332178
	speed: 0.0121s/iter; left time: 475.4991s
Epoch: 5 cost time: 5.0655677318573
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0058823
	speed: 0.0415s/iter; left time: 1626.0470s
	iters: 200, epoch: 6 | loss: 0.0012823
	speed: 0.0116s/iter; left time: 451.5950s
	iters: 300, epoch: 6 | loss: 0.0291964
	speed: 0.0112s/iter; left time: 434.7334s
	iters: 400, epoch: 6 | loss: 0.0058310
	speed: 0.0122s/iter; left time: 472.8491s
Epoch: 6 cost time: 5.31076979637146
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.971 Test Loss: 0.091 Test Acc: 0.971
Validation loss decreased (-0.969985 --> -0.971350).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0009012
	speed: 0.0573s/iter; left time: 2219.3572s
	iters: 200, epoch: 7 | loss: 0.0079292
	speed: 0.0125s/iter; left time: 484.5133s
	iters: 300, epoch: 7 | loss: 0.0003803
	speed: 0.0132s/iter; left time: 509.4968s
	iters: 400, epoch: 7 | loss: 0.0056229
	speed: 0.0122s/iter; left time: 470.6614s
Epoch: 7 cost time: 5.730609178543091
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0005973
	speed: 0.0589s/iter; left time: 2258.1918s
	iters: 200, epoch: 8 | loss: 0.0646550
	speed: 0.0127s/iter; left time: 484.1968s
	iters: 300, epoch: 8 | loss: 0.0029726
	speed: 0.0124s/iter; left time: 472.5985s
	iters: 400, epoch: 8 | loss: 0.0015087
	speed: 0.0129s/iter; left time: 490.0824s
Epoch: 8 cost time: 5.89570689201355
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0005299
	speed: 0.0590s/iter; left time: 2236.9752s
	iters: 200, epoch: 9 | loss: 0.0007291
	speed: 0.0110s/iter; left time: 417.3214s
	iters: 300, epoch: 9 | loss: 0.0015819
	speed: 0.0112s/iter; left time: 421.1183s
	iters: 400, epoch: 9 | loss: 0.1397374
	speed: 0.0112s/iter; left time: 420.1685s
Epoch: 9 cost time: 5.215336322784424
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0000349
	speed: 0.0436s/iter; left time: 1634.6066s
	iters: 200, epoch: 10 | loss: 0.0159604
	speed: 0.0122s/iter; left time: 455.9656s
	iters: 300, epoch: 10 | loss: 0.0610001
	speed: 0.0128s/iter; left time: 476.2965s
	iters: 400, epoch: 10 | loss: 0.0007974
	speed: 0.0110s/iter; left time: 410.3920s
Epoch: 10 cost time: 5.236926317214966
Epoch: 10, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.973623).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0019161
	speed: 0.0456s/iter; left time: 1689.5010s
	iters: 200, epoch: 11 | loss: 0.0006139
	speed: 0.0120s/iter; left time: 444.5302s
	iters: 300, epoch: 11 | loss: 0.0013391
	speed: 0.0115s/iter; left time: 422.7891s
	iters: 400, epoch: 11 | loss: 0.0011463
	speed: 0.0116s/iter; left time: 427.1135s
Epoch: 11 cost time: 5.429139137268066
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000124
	speed: 0.0581s/iter; left time: 2128.3792s
	iters: 200, epoch: 12 | loss: 0.0000385
	speed: 0.0158s/iter; left time: 576.6998s
	iters: 300, epoch: 12 | loss: 0.1073702
	speed: 0.0129s/iter; left time: 471.6747s
	iters: 400, epoch: 12 | loss: 0.0000276
	speed: 0.0126s/iter; left time: 458.3186s
Epoch: 12 cost time: 6.286400556564331
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0006524
	speed: 0.0631s/iter; left time: 2286.8205s
	iters: 200, epoch: 13 | loss: 0.0002511
	speed: 0.0117s/iter; left time: 424.5670s
	iters: 300, epoch: 13 | loss: 0.0001426
	speed: 0.0123s/iter; left time: 441.7357s
	iters: 400, epoch: 13 | loss: 0.1176141
	speed: 0.0120s/iter; left time: 430.8109s
Epoch: 13 cost time: 5.58828330039978
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 14 | loss: 0.0005544
	speed: 0.0638s/iter; left time: 2287.5979s
	iters: 200, epoch: 14 | loss: 0.0000533
	speed: 0.0121s/iter; left time: 431.2657s
	iters: 300, epoch: 14 | loss: 0.0285251
	speed: 0.0131s/iter; left time: 468.2186s
	iters: 400, epoch: 14 | loss: 0.0146526
	speed: 0.0134s/iter; left time: 476.1390s
Epoch: 14 cost time: 5.85349178314209
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.958 Test Loss: 0.199 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 15 | loss: 0.0151368
	speed: 0.0499s/iter; left time: 1765.9074s
	iters: 200, epoch: 15 | loss: 0.3294430
	speed: 0.0121s/iter; left time: 428.2123s
	iters: 300, epoch: 15 | loss: 0.0000514
	speed: 0.0130s/iter; left time: 459.0227s
	iters: 400, epoch: 15 | loss: 0.0052546
	speed: 0.0116s/iter; left time: 405.7886s
Epoch: 15 cost time: 5.379918098449707
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 16 | loss: 0.0000006
	speed: 0.0519s/iter; left time: 1816.3611s
	iters: 200, epoch: 16 | loss: 0.0021573
	speed: 0.0116s/iter; left time: 403.1669s
	iters: 300, epoch: 16 | loss: 0.0015921
	speed: 0.0113s/iter; left time: 394.5757s
	iters: 400, epoch: 16 | loss: 0.0008984
	speed: 0.0108s/iter; left time: 375.7931s
Epoch: 16 cost time: 4.994023323059082
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 17 | loss: 0.0000049
	speed: 0.0462s/iter; left time: 1597.3579s
	iters: 200, epoch: 17 | loss: 0.0016729
	speed: 0.0115s/iter; left time: 395.0260s
	iters: 300, epoch: 17 | loss: 0.0000040
	speed: 0.0123s/iter; left time: 422.7158s
	iters: 400, epoch: 17 | loss: 0.0001695
	speed: 0.0118s/iter; left time: 406.0171s
Epoch: 17 cost time: 5.307394504547119
Epoch: 17, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 18 | loss: 0.0045362
	speed: 0.0576s/iter; left time: 1970.0775s
	iters: 200, epoch: 18 | loss: 0.0044392
	speed: 0.0141s/iter; left time: 480.5617s
	iters: 300, epoch: 18 | loss: 0.0799242
	speed: 0.0125s/iter; left time: 426.1821s
	iters: 400, epoch: 18 | loss: 0.0000011
	speed: 0.0124s/iter; left time: 418.5688s
Epoch: 18 cost time: 5.899196624755859
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 19 | loss: 0.0008336
	speed: 0.0622s/iter; left time: 2099.5047s
	iters: 200, epoch: 19 | loss: 0.0000282
	speed: 0.0123s/iter; left time: 415.0265s
	iters: 300, epoch: 19 | loss: 0.0009123
	speed: 0.0129s/iter; left time: 432.7246s
	iters: 400, epoch: 19 | loss: 0.0000249
	speed: 0.0134s/iter; left time: 448.5081s
Epoch: 19 cost time: 5.998503684997559
Epoch: 19, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.965 Test Loss: 0.221 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 20 | loss: 0.0002600
	speed: 0.0701s/iter; left time: 2338.8089s
	iters: 200, epoch: 20 | loss: 0.0004656
	speed: 0.0120s/iter; left time: 397.3956s
	iters: 300, epoch: 20 | loss: 0.0000027
	speed: 0.0129s/iter; left time: 426.1373s
	iters: 400, epoch: 20 | loss: 0.1015584
	speed: 0.0126s/iter; left time: 416.0726s
Epoch: 20 cost time: 5.670537710189819
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.965 Test Loss: 0.209 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 30374
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0900029
	speed: 0.0253s/iter; left time: 1043.5083s
	iters: 200, epoch: 1 | loss: 0.5058768
	speed: 0.0130s/iter; left time: 534.4720s
	iters: 300, epoch: 1 | loss: 0.2352123
	speed: 0.0129s/iter; left time: 527.4142s
	iters: 400, epoch: 1 | loss: 0.0899825
	speed: 0.0136s/iter; left time: 557.1425s
Epoch: 1 cost time: 6.71326470375061
Epoch: 1, Steps: 413 | Train Loss: 0.730 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
Validation loss decreased (inf --> -0.956797).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1362621
	speed: 0.0510s/iter; left time: 2081.0287s
	iters: 200, epoch: 2 | loss: 0.1368106
	speed: 0.0129s/iter; left time: 526.7237s
	iters: 300, epoch: 2 | loss: 0.0448916
	speed: 0.0134s/iter; left time: 544.0637s
	iters: 400, epoch: 2 | loss: 0.0217298
	speed: 0.0123s/iter; left time: 497.3993s
Epoch: 2 cost time: 5.741503477096558
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
Validation loss decreased (-0.956797 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2692541
	speed: 0.0587s/iter; left time: 2371.0068s
	iters: 200, epoch: 3 | loss: 0.0235947
	speed: 0.0143s/iter; left time: 576.3006s
	iters: 300, epoch: 3 | loss: 0.0335407
	speed: 0.0135s/iter; left time: 540.5241s
	iters: 400, epoch: 3 | loss: 0.0067337
	speed: 0.0136s/iter; left time: 543.3010s
Epoch: 3 cost time: 6.158976793289185
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0164449
	speed: 0.0540s/iter; left time: 2159.2406s
	iters: 200, epoch: 4 | loss: 0.0061508
	speed: 0.0119s/iter; left time: 474.0284s
	iters: 300, epoch: 4 | loss: 0.0059732
	speed: 0.0119s/iter; left time: 472.9340s
	iters: 400, epoch: 4 | loss: 0.0719965
	speed: 0.0117s/iter; left time: 463.3794s
Epoch: 4 cost time: 5.322540283203125
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.092 Vali Acc: 0.961 Test Loss: 0.092 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0030450
	speed: 0.0502s/iter; left time: 1985.3920s
	iters: 200, epoch: 5 | loss: 0.1142291
	speed: 0.0121s/iter; left time: 478.8423s
	iters: 300, epoch: 5 | loss: 0.0102675
	speed: 0.0109s/iter; left time: 430.7176s
	iters: 400, epoch: 5 | loss: 0.0232038
	speed: 0.0117s/iter; left time: 459.3598s
Epoch: 5 cost time: 5.251059055328369
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.961 Test Loss: 0.136 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0044830
	speed: 0.0504s/iter; left time: 1973.6121s
	iters: 200, epoch: 6 | loss: 0.0007237
	speed: 0.0117s/iter; left time: 455.7451s
	iters: 300, epoch: 6 | loss: 0.0008176
	speed: 0.0130s/iter; left time: 507.3617s
	iters: 400, epoch: 6 | loss: 0.0049852
	speed: 0.0141s/iter; left time: 548.7632s
Epoch: 6 cost time: 5.5962440967559814
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.1591476
	speed: 0.0562s/iter; left time: 2178.0835s
	iters: 200, epoch: 7 | loss: 0.0061321
	speed: 0.0130s/iter; left time: 502.3409s
	iters: 300, epoch: 7 | loss: 0.0000516
	speed: 0.0140s/iter; left time: 540.6773s
	iters: 400, epoch: 7 | loss: 0.0014590
	speed: 0.0128s/iter; left time: 492.1993s
Epoch: 7 cost time: 5.760740756988525
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0068618
	speed: 0.0568s/iter; left time: 2175.4849s
	iters: 200, epoch: 8 | loss: 0.0007824
	speed: 0.0128s/iter; left time: 490.6271s
	iters: 300, epoch: 8 | loss: 0.0699272
	speed: 0.0138s/iter; left time: 524.5967s
	iters: 400, epoch: 8 | loss: 0.0057258
	speed: 0.0142s/iter; left time: 540.2504s
Epoch: 8 cost time: 6.071855783462524
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.143 Vali Acc: 0.957 Test Loss: 0.143 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0031431
	speed: 0.0550s/iter; left time: 2083.3679s
	iters: 200, epoch: 9 | loss: 0.0052543
	speed: 0.0130s/iter; left time: 492.9504s
	iters: 300, epoch: 9 | loss: 0.0001204
	speed: 0.0129s/iter; left time: 486.4638s
	iters: 400, epoch: 9 | loss: 0.0164785
	speed: 0.0118s/iter; left time: 443.8393s
Epoch: 9 cost time: 5.695101022720337
Epoch: 9, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0046787
	speed: 0.0458s/iter; left time: 1716.4760s
	iters: 200, epoch: 10 | loss: 0.0013569
	speed: 0.0122s/iter; left time: 457.0882s
	iters: 300, epoch: 10 | loss: 0.0365109
	speed: 0.0111s/iter; left time: 415.3324s
	iters: 400, epoch: 10 | loss: 0.0016492
	speed: 0.0100s/iter; left time: 372.5951s
Epoch: 10 cost time: 4.972711801528931
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0001070
	speed: 0.0458s/iter; left time: 1698.1405s
	iters: 200, epoch: 11 | loss: 0.0024567
	speed: 0.0112s/iter; left time: 414.0377s
	iters: 300, epoch: 11 | loss: 0.0014672
	speed: 0.0114s/iter; left time: 421.5251s
	iters: 400, epoch: 11 | loss: 0.0334705
	speed: 0.0103s/iter; left time: 379.5869s
Epoch: 11 cost time: 5.016109943389893
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0003429
	speed: 0.0497s/iter; left time: 1821.7622s
	iters: 200, epoch: 12 | loss: 0.0000424
	speed: 0.0121s/iter; left time: 443.3301s
	iters: 300, epoch: 12 | loss: 0.0000159
	speed: 0.0120s/iter; left time: 438.9788s
	iters: 400, epoch: 12 | loss: 0.0000908
	speed: 0.0132s/iter; left time: 480.9575s
Epoch: 12 cost time: 5.549967288970947
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.165 Vali Acc: 0.965 Test Loss: 0.165 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9681673487949067
model parameter : 30462
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2648867
	speed: 0.0280s/iter; left time: 1154.0639s
	iters: 200, epoch: 1 | loss: 0.2607100
	speed: 0.0112s/iter; left time: 459.2153s
	iters: 300, epoch: 1 | loss: 0.2079396
	speed: 0.0113s/iter; left time: 462.9968s
	iters: 400, epoch: 1 | loss: 0.0611071
	speed: 0.0115s/iter; left time: 469.9191s
Epoch: 1 cost time: 6.395263433456421
Epoch: 1, Steps: 413 | Train Loss: 0.757 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (inf --> -0.953614).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0493395
	speed: 0.0471s/iter; left time: 1921.1714s
	iters: 200, epoch: 2 | loss: 0.0301842
	speed: 0.0110s/iter; left time: 446.9986s
	iters: 300, epoch: 2 | loss: 0.0070971
	speed: 0.0101s/iter; left time: 409.4138s
	iters: 400, epoch: 2 | loss: 0.0742549
	speed: 0.0124s/iter; left time: 500.4501s
Epoch: 2 cost time: 4.90446662902832
Epoch: 2, Steps: 413 | Train Loss: 0.114 Vali Loss: 0.104 Vali Acc: 0.961 Test Loss: 0.104 Test Acc: 0.961
Validation loss decreased (-0.953614 --> -0.961345).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0653303
	speed: 0.0447s/iter; left time: 1805.6949s
	iters: 200, epoch: 3 | loss: 0.0347133
	speed: 0.0110s/iter; left time: 441.7335s
	iters: 300, epoch: 3 | loss: 0.0079891
	speed: 0.0116s/iter; left time: 466.4076s
	iters: 400, epoch: 3 | loss: 0.0081060
	speed: 0.0119s/iter; left time: 475.4795s
Epoch: 3 cost time: 4.991528511047363
Epoch: 3, Steps: 413 | Train Loss: 0.079 Vali Loss: 0.082 Vali Acc: 0.966 Test Loss: 0.082 Test Acc: 0.966
Validation loss decreased (-0.961345 --> -0.966348).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8167686
	speed: 0.0498s/iter; left time: 1991.4189s
	iters: 200, epoch: 4 | loss: 0.1751626
	speed: 0.0136s/iter; left time: 542.8034s
	iters: 300, epoch: 4 | loss: 0.0147900
	speed: 0.0138s/iter; left time: 547.3393s
	iters: 400, epoch: 4 | loss: 0.0669160
	speed: 0.0139s/iter; left time: 549.7604s
Epoch: 4 cost time: 5.89404296875
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.111 Vali Acc: 0.962 Test Loss: 0.111 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0036444
	speed: 0.0571s/iter; left time: 2259.7462s
	iters: 200, epoch: 5 | loss: 0.0018787
	speed: 0.0140s/iter; left time: 551.5984s
	iters: 300, epoch: 5 | loss: 0.0053741
	speed: 0.0124s/iter; left time: 486.7313s
	iters: 400, epoch: 5 | loss: 0.0130093
	speed: 0.0124s/iter; left time: 486.5812s
Epoch: 5 cost time: 5.806774139404297
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.117 Vali Acc: 0.969 Test Loss: 0.117 Test Acc: 0.969
Validation loss decreased (-0.966348 --> -0.968621).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0395736
	speed: 0.0531s/iter; left time: 2078.1535s
	iters: 200, epoch: 6 | loss: 0.5084925
	speed: 0.0127s/iter; left time: 497.5400s
	iters: 300, epoch: 6 | loss: 0.0222640
	speed: 0.0132s/iter; left time: 513.7184s
	iters: 400, epoch: 6 | loss: 0.0028274
	speed: 0.0124s/iter; left time: 480.0811s
Epoch: 6 cost time: 5.6755146980285645
Epoch: 6, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
Validation loss decreased (-0.968621 --> -0.969530).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0476095
	speed: 0.0467s/iter; left time: 1808.4998s
	iters: 200, epoch: 7 | loss: 0.0035674
	speed: 0.0109s/iter; left time: 420.9187s
	iters: 300, epoch: 7 | loss: 0.1966550
	speed: 0.0101s/iter; left time: 390.6827s
	iters: 400, epoch: 7 | loss: 0.0027175
	speed: 0.0109s/iter; left time: 416.8984s
Epoch: 7 cost time: 4.61541748046875
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.081 Vali Acc: 0.976 Test Loss: 0.081 Test Acc: 0.976
Validation loss decreased (-0.969530 --> -0.976352).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.1510906
	speed: 0.0373s/iter; left time: 1428.7285s
	iters: 200, epoch: 8 | loss: 0.3133637
	speed: 0.0106s/iter; left time: 403.6668s
	iters: 300, epoch: 8 | loss: 0.0015577
	speed: 0.0103s/iter; left time: 393.5146s
	iters: 400, epoch: 8 | loss: 0.0558821
	speed: 0.0126s/iter; left time: 477.4545s
Epoch: 8 cost time: 5.01444935798645
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000419
	speed: 0.0405s/iter; left time: 1534.2621s
	iters: 200, epoch: 9 | loss: 0.0242724
	speed: 0.0112s/iter; left time: 422.7759s
	iters: 300, epoch: 9 | loss: 0.1182233
	speed: 0.0117s/iter; left time: 441.6245s
	iters: 400, epoch: 9 | loss: 0.0002698
	speed: 0.0105s/iter; left time: 393.4728s
Epoch: 9 cost time: 5.005467414855957
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.968 Test Loss: 0.113 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0019494
	speed: 0.0533s/iter; left time: 1998.9180s
	iters: 200, epoch: 10 | loss: 0.0035404
	speed: 0.0130s/iter; left time: 485.5576s
	iters: 300, epoch: 10 | loss: 0.0005916
	speed: 0.0121s/iter; left time: 450.1054s
	iters: 400, epoch: 10 | loss: 0.0061052
	speed: 0.0124s/iter; left time: 462.2923s
Epoch: 10 cost time: 5.737192153930664
Epoch: 10, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0141335
	speed: 0.0558s/iter; left time: 2069.6044s
	iters: 200, epoch: 11 | loss: 0.0010743
	speed: 0.0105s/iter; left time: 389.7104s
	iters: 300, epoch: 11 | loss: 0.0009094
	speed: 0.0111s/iter; left time: 407.7689s
	iters: 400, epoch: 11 | loss: 0.0002017
	speed: 0.0117s/iter; left time: 431.5067s
Epoch: 11 cost time: 5.087780237197876
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.166 Vali Acc: 0.961 Test Loss: 0.166 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0002147
	speed: 0.0542s/iter; left time: 1986.7353s
	iters: 200, epoch: 12 | loss: 0.1034343
	speed: 0.0132s/iter; left time: 481.9379s
	iters: 300, epoch: 12 | loss: 0.0000107
	speed: 0.0119s/iter; left time: 433.8513s
	iters: 400, epoch: 12 | loss: 0.0026791
	speed: 0.0129s/iter; left time: 470.5248s
Epoch: 12 cost time: 5.506137371063232
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0001628
	speed: 0.0477s/iter; left time: 1730.0394s
	iters: 200, epoch: 13 | loss: 0.0000070
	speed: 0.0109s/iter; left time: 393.0658s
	iters: 300, epoch: 13 | loss: 0.0000154
	speed: 0.0121s/iter; left time: 436.2636s
	iters: 400, epoch: 13 | loss: 0.0237740
	speed: 0.0121s/iter; left time: 434.3965s
Epoch: 13 cost time: 5.2651824951171875
Epoch: 13, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0005157
	speed: 0.0470s/iter; left time: 1682.8620s
	iters: 200, epoch: 14 | loss: 0.0000065
	speed: 0.0131s/iter; left time: 469.1368s
	iters: 300, epoch: 14 | loss: 0.0000044
	speed: 0.0127s/iter; left time: 452.6527s
	iters: 400, epoch: 14 | loss: 0.0000200
	speed: 0.0128s/iter; left time: 454.7675s
Epoch: 14 cost time: 5.5832273960113525
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0000166
	speed: 0.0464s/iter; left time: 1644.8018s
	iters: 200, epoch: 15 | loss: 0.0001392
	speed: 0.0134s/iter; left time: 472.0073s
	iters: 300, epoch: 15 | loss: 0.0005744
	speed: 0.0158s/iter; left time: 556.6059s
	iters: 400, epoch: 15 | loss: 0.0004505
	speed: 0.0135s/iter; left time: 475.2115s
Epoch: 15 cost time: 6.0933520793914795
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0001600
	speed: 0.0576s/iter; left time: 2018.0557s
	iters: 200, epoch: 16 | loss: 0.0000341
	speed: 0.0137s/iter; left time: 478.2831s
	iters: 300, epoch: 16 | loss: 0.0020026
	speed: 0.0133s/iter; left time: 461.7818s
	iters: 400, epoch: 16 | loss: 0.0020713
	speed: 0.0129s/iter; left time: 446.8971s
Epoch: 16 cost time: 5.914248943328857
Epoch: 16, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.963 Test Loss: 0.222 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0002918
	speed: 0.0594s/iter; left time: 2053.9571s
	iters: 200, epoch: 17 | loss: 0.2888090
	speed: 0.0124s/iter; left time: 429.0986s
	iters: 300, epoch: 17 | loss: 0.0436834
	speed: 0.0116s/iter; left time: 399.0051s
	iters: 400, epoch: 17 | loss: 0.0001354
	speed: 0.0120s/iter; left time: 413.0344s
Epoch: 17 cost time: 5.4295525550842285
Epoch: 17, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 30182
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3477302
	speed: 0.0267s/iter; left time: 1099.4498s
	iters: 200, epoch: 1 | loss: 0.3721155
	speed: 0.0118s/iter; left time: 484.9651s
	iters: 300, epoch: 1 | loss: 0.2117317
	speed: 0.0111s/iter; left time: 454.8559s
	iters: 400, epoch: 1 | loss: 0.1850166
	speed: 0.0118s/iter; left time: 481.8017s
Epoch: 1 cost time: 6.340521812438965
Epoch: 1, Steps: 413 | Train Loss: 0.759 Vali Loss: 0.153 Vali Acc: 0.948 Test Loss: 0.153 Test Acc: 0.948
Validation loss decreased (inf --> -0.948157).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0836378
	speed: 0.0508s/iter; left time: 2070.7442s
	iters: 200, epoch: 2 | loss: 0.0780185
	speed: 0.0127s/iter; left time: 515.8400s
	iters: 300, epoch: 2 | loss: 0.0146851
	speed: 0.0127s/iter; left time: 514.9771s
	iters: 400, epoch: 2 | loss: 0.1437431
	speed: 0.0138s/iter; left time: 557.9471s
Epoch: 2 cost time: 5.675249099731445
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
Validation loss decreased (-0.948157 --> -0.956797).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0585424
	speed: 0.0579s/iter; left time: 2338.0812s
	iters: 200, epoch: 3 | loss: 0.4006984
	speed: 0.0122s/iter; left time: 492.1428s
	iters: 300, epoch: 3 | loss: 0.0050991
	speed: 0.0127s/iter; left time: 511.3165s
	iters: 400, epoch: 3 | loss: 0.0417020
	speed: 0.0136s/iter; left time: 546.8028s
Epoch: 3 cost time: 5.6771461963653564
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.114 Vali Acc: 0.961 Test Loss: 0.114 Test Acc: 0.961
Validation loss decreased (-0.956797 --> -0.961345).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0376341
	speed: 0.0564s/iter; left time: 2254.1835s
	iters: 200, epoch: 4 | loss: 0.0013071
	speed: 0.0118s/iter; left time: 472.2637s
	iters: 300, epoch: 4 | loss: 0.0149344
	speed: 0.0131s/iter; left time: 521.9454s
	iters: 400, epoch: 4 | loss: 0.0059014
	speed: 0.0139s/iter; left time: 551.4132s
Epoch: 4 cost time: 5.62672758102417
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
Validation loss decreased (-0.961345 --> -0.962255).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0121380
	speed: 0.0581s/iter; left time: 2295.8958s
	iters: 200, epoch: 5 | loss: 0.0036441
	speed: 0.0124s/iter; left time: 487.6153s
	iters: 300, epoch: 5 | loss: 0.0146167
	speed: 0.0130s/iter; left time: 513.4279s
	iters: 400, epoch: 5 | loss: 0.0002352
	speed: 0.0138s/iter; left time: 543.4049s
Epoch: 5 cost time: 5.677419424057007
Epoch: 5, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
Validation loss decreased (-0.962255 --> -0.967712).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0160981
	speed: 0.0506s/iter; left time: 1981.9725s
	iters: 200, epoch: 6 | loss: 0.0011801
	speed: 0.0122s/iter; left time: 476.7954s
	iters: 300, epoch: 6 | loss: 0.0006310
	speed: 0.0126s/iter; left time: 492.1136s
	iters: 400, epoch: 6 | loss: 0.0352088
	speed: 0.0112s/iter; left time: 434.6145s
Epoch: 6 cost time: 5.163830995559692
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.966 Test Loss: 0.118 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0001194
	speed: 0.0427s/iter; left time: 1653.8134s
	iters: 200, epoch: 7 | loss: 0.2213462
	speed: 0.0117s/iter; left time: 451.9349s
	iters: 300, epoch: 7 | loss: 0.0031008
	speed: 0.0111s/iter; left time: 426.1808s
	iters: 400, epoch: 7 | loss: 0.0003646
	speed: 0.0102s/iter; left time: 393.4794s
Epoch: 7 cost time: 4.803412675857544
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.101 Vali Acc: 0.970 Test Loss: 0.101 Test Acc: 0.970
Validation loss decreased (-0.967712 --> -0.969985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.2330825
	speed: 0.0369s/iter; left time: 1415.3481s
	iters: 200, epoch: 8 | loss: 0.0035362
	speed: 0.0141s/iter; left time: 539.0823s
	iters: 300, epoch: 8 | loss: 0.0041147
	speed: 0.0127s/iter; left time: 483.8613s
	iters: 400, epoch: 8 | loss: 0.0015871
	speed: 0.0104s/iter; left time: 397.0848s
Epoch: 8 cost time: 5.370088577270508
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.098 Vali Acc: 0.972 Test Loss: 0.098 Test Acc: 0.972
Validation loss decreased (-0.969985 --> -0.972259).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0167551
	speed: 0.0508s/iter; left time: 1925.7642s
	iters: 200, epoch: 9 | loss: 0.0006547
	speed: 0.0130s/iter; left time: 490.9264s
	iters: 300, epoch: 9 | loss: 0.0089563
	speed: 0.0106s/iter; left time: 399.7349s
	iters: 400, epoch: 9 | loss: 0.1195506
	speed: 0.0109s/iter; left time: 409.1280s
Epoch: 9 cost time: 5.329571485519409
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.965 Test Loss: 0.117 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0243045
	speed: 0.0454s/iter; left time: 1703.5846s
	iters: 200, epoch: 10 | loss: 0.0011832
	speed: 0.0114s/iter; left time: 425.0517s
	iters: 300, epoch: 10 | loss: 0.0000835
	speed: 0.0110s/iter; left time: 408.3169s
	iters: 400, epoch: 10 | loss: 0.0006571
	speed: 0.0108s/iter; left time: 399.8390s
Epoch: 10 cost time: 4.966681957244873
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0002623
	speed: 0.0504s/iter; left time: 1869.4125s
	iters: 200, epoch: 11 | loss: 0.0018232
	speed: 0.0107s/iter; left time: 395.1846s
	iters: 300, epoch: 11 | loss: 0.0021687
	speed: 0.0112s/iter; left time: 414.3774s
	iters: 400, epoch: 11 | loss: 0.0039884
	speed: 0.0112s/iter; left time: 410.3335s
Epoch: 11 cost time: 5.046699047088623
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0001577
	speed: 0.0566s/iter; left time: 2076.2075s
	iters: 200, epoch: 12 | loss: 0.0024350
	speed: 0.0118s/iter; left time: 430.3252s
	iters: 300, epoch: 12 | loss: 0.0011205
	speed: 0.0136s/iter; left time: 494.7849s
	iters: 400, epoch: 12 | loss: 0.0000017
	speed: 0.0131s/iter; left time: 478.0952s
Epoch: 12 cost time: 5.625638961791992
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0005335
	speed: 0.0541s/iter; left time: 1960.4952s
	iters: 200, epoch: 13 | loss: 0.0002906
	speed: 0.0121s/iter; left time: 437.6922s
	iters: 300, epoch: 13 | loss: 0.0073725
	speed: 0.0129s/iter; left time: 464.5117s
	iters: 400, epoch: 13 | loss: 0.0015385
	speed: 0.0123s/iter; left time: 440.9194s
Epoch: 13 cost time: 5.427845001220703
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0265353
	speed: 0.0554s/iter; left time: 1986.3396s
	iters: 200, epoch: 14 | loss: 0.0000259
	speed: 0.0135s/iter; left time: 481.5865s
	iters: 300, epoch: 14 | loss: 0.0005267
	speed: 0.0139s/iter; left time: 495.7220s
	iters: 400, epoch: 14 | loss: 0.0002474
	speed: 0.0138s/iter; left time: 489.4166s
Epoch: 14 cost time: 5.9293882846832275
Epoch: 14, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0012329
	speed: 0.0501s/iter; left time: 1773.8656s
	iters: 200, epoch: 15 | loss: 0.0000008
	speed: 0.0111s/iter; left time: 391.9031s
	iters: 300, epoch: 15 | loss: 0.0015771
	speed: 0.0120s/iter; left time: 420.9545s
	iters: 400, epoch: 15 | loss: 0.0002676
	speed: 0.0127s/iter; left time: 446.5549s
Epoch: 15 cost time: 5.253735780715942
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.966 Test Loss: 0.172 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0042008
	speed: 0.0410s/iter; left time: 1434.7169s
	iters: 200, epoch: 16 | loss: 0.0000001
	speed: 0.0131s/iter; left time: 457.2962s
	iters: 300, epoch: 16 | loss: 0.0034843
	speed: 0.0117s/iter; left time: 407.0477s
	iters: 400, epoch: 16 | loss: 0.0541715
	speed: 0.0119s/iter; left time: 414.4782s
Epoch: 16 cost time: 5.289989471435547
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000016
	speed: 0.0365s/iter; left time: 1261.4179s
	iters: 200, epoch: 17 | loss: 0.0000048
	speed: 0.0122s/iter; left time: 421.9043s
	iters: 300, epoch: 17 | loss: 0.0001606
	speed: 0.0111s/iter; left time: 381.6947s
	iters: 400, epoch: 17 | loss: 0.0006228
	speed: 0.0120s/iter; left time: 411.6168s
Epoch: 17 cost time: 5.138400316238403
Epoch: 17, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.962 Test Loss: 0.218 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000000
	speed: 0.0554s/iter; left time: 1894.4928s
	iters: 200, epoch: 18 | loss: 0.0001492
	speed: 0.0130s/iter; left time: 443.6972s
	iters: 300, epoch: 18 | loss: 0.0003609
	speed: 0.0127s/iter; left time: 430.0912s
	iters: 400, epoch: 18 | loss: 0.0000091
	speed: 0.0122s/iter; left time: 411.8883s
Epoch: 18 cost time: 5.7190539836883545
Epoch: 18, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9722601182355616
model parameter : 30435
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3113978
	speed: 0.0267s/iter; left time: 1099.6275s
	iters: 200, epoch: 1 | loss: 0.1980435
	speed: 0.0113s/iter; left time: 465.1641s
	iters: 300, epoch: 1 | loss: 0.5604097
	speed: 0.0117s/iter; left time: 481.3871s
	iters: 400, epoch: 1 | loss: 0.0950710
	speed: 0.0127s/iter; left time: 518.1591s
Epoch: 1 cost time: 6.441656827926636
Epoch: 1, Steps: 413 | Train Loss: 0.778 Vali Loss: 0.147 Vali Acc: 0.952 Test Loss: 0.147 Test Acc: 0.952
Validation loss decreased (inf --> -0.951795).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1744631
	speed: 0.0440s/iter; left time: 1795.4214s
	iters: 200, epoch: 2 | loss: 0.1170622
	speed: 0.0120s/iter; left time: 486.5607s
	iters: 300, epoch: 2 | loss: 0.0981058
	speed: 0.0123s/iter; left time: 498.3142s
	iters: 400, epoch: 2 | loss: 0.0775182
	speed: 0.0122s/iter; left time: 495.7766s
Epoch: 2 cost time: 5.202286958694458
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.951795 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0118576
	speed: 0.0463s/iter; left time: 1869.1508s
	iters: 200, epoch: 3 | loss: 0.0076875
	speed: 0.0126s/iter; left time: 505.4564s
	iters: 300, epoch: 3 | loss: 0.0116237
	speed: 0.0138s/iter; left time: 552.4943s
	iters: 400, epoch: 3 | loss: 0.0011020
	speed: 0.0130s/iter; left time: 520.6968s
Epoch: 3 cost time: 5.757596254348755
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.101 Vali Acc: 0.964 Test Loss: 0.101 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0078018
	speed: 0.0538s/iter; left time: 2150.6235s
	iters: 200, epoch: 4 | loss: 0.0240521
	speed: 0.0150s/iter; left time: 598.7417s
	iters: 300, epoch: 4 | loss: 0.0662751
	speed: 0.0145s/iter; left time: 575.1435s
	iters: 400, epoch: 4 | loss: 0.0149109
	speed: 0.0138s/iter; left time: 546.5668s
Epoch: 4 cost time: 6.339885711669922
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.176 Vali Acc: 0.954 Test Loss: 0.176 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0053016
	speed: 0.0579s/iter; left time: 2290.2386s
	iters: 200, epoch: 5 | loss: 0.0657484
	speed: 0.0130s/iter; left time: 513.0097s
	iters: 300, epoch: 5 | loss: 0.0076618
	speed: 0.0135s/iter; left time: 529.5004s
	iters: 400, epoch: 5 | loss: 0.0291119
	speed: 0.0123s/iter; left time: 482.1102s
Epoch: 5 cost time: 5.796833276748657
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.116 Vali Acc: 0.962 Test Loss: 0.116 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0112130
	speed: 0.0604s/iter; left time: 2363.6810s
	iters: 200, epoch: 6 | loss: 0.0011723
	speed: 0.0126s/iter; left time: 491.5713s
	iters: 300, epoch: 6 | loss: 0.0015928
	speed: 0.0110s/iter; left time: 429.4721s
	iters: 400, epoch: 6 | loss: 0.0037289
	speed: 0.0121s/iter; left time: 471.0076s
Epoch: 6 cost time: 5.488377809524536
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0251507
	speed: 0.0487s/iter; left time: 1885.2986s
	iters: 200, epoch: 7 | loss: 0.0043961
	speed: 0.0103s/iter; left time: 396.7225s
	iters: 300, epoch: 7 | loss: 0.0395828
	speed: 0.0117s/iter; left time: 450.7037s
	iters: 400, epoch: 7 | loss: 0.0021993
	speed: 0.0113s/iter; left time: 432.8488s
Epoch: 7 cost time: 5.002838611602783
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.130 Vali Acc: 0.958 Test Loss: 0.130 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0250206
	speed: 0.0426s/iter; left time: 1633.0224s
	iters: 200, epoch: 8 | loss: 0.0796825
	speed: 0.0113s/iter; left time: 429.9700s
	iters: 300, epoch: 8 | loss: 0.0210127
	speed: 0.0111s/iter; left time: 422.8081s
	iters: 400, epoch: 8 | loss: 0.0001908
	speed: 0.0112s/iter; left time: 426.7965s
Epoch: 8 cost time: 4.803876161575317
Epoch: 8, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.945 Test Loss: 0.205 Test Acc: 0.945
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0336028
	speed: 0.0443s/iter; left time: 1678.6001s
	iters: 200, epoch: 9 | loss: 0.0821869
	speed: 0.0129s/iter; left time: 489.4661s
	iters: 300, epoch: 9 | loss: 0.1078427
	speed: 0.0144s/iter; left time: 541.3842s
	iters: 400, epoch: 9 | loss: 0.0354883
	speed: 0.0136s/iter; left time: 512.4414s
Epoch: 9 cost time: 6.127969980239868
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.960 Test Loss: 0.138 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0011856
	speed: 0.0610s/iter; left time: 2284.7399s
	iters: 200, epoch: 10 | loss: 0.0012144
	speed: 0.0138s/iter; left time: 515.7924s
	iters: 300, epoch: 10 | loss: 0.0000131
	speed: 0.0123s/iter; left time: 457.4997s
	iters: 400, epoch: 10 | loss: 0.0001022
	speed: 0.0131s/iter; left time: 488.7557s
Epoch: 10 cost time: 5.970031499862671
Epoch: 10, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.964 Test Loss: 0.129 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0017017
	speed: 0.0669s/iter; left time: 2481.3052s
	iters: 200, epoch: 11 | loss: 0.0000081
	speed: 0.0126s/iter; left time: 464.3290s
	iters: 300, epoch: 11 | loss: 0.0043204
	speed: 0.0127s/iter; left time: 467.4435s
	iters: 400, epoch: 11 | loss: 0.0010701
	speed: 0.0136s/iter; left time: 500.1911s
Epoch: 11 cost time: 5.8607189655303955
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.960 Test Loss: 0.176 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0001664
	speed: 0.0519s/iter; left time: 1901.0812s
	iters: 200, epoch: 12 | loss: 0.0036962
	speed: 0.0117s/iter; left time: 427.1668s
	iters: 300, epoch: 12 | loss: 0.0025345
	speed: 0.0124s/iter; left time: 451.0380s
	iters: 400, epoch: 12 | loss: 0.0000226
	speed: 0.0125s/iter; left time: 455.6370s
Epoch: 12 cost time: 5.370056629180908
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9686221009549796
model parameter : 30506
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1688428
	speed: 0.0293s/iter; left time: 1206.9516s
	iters: 200, epoch: 1 | loss: 0.3301618
	speed: 0.0133s/iter; left time: 547.3870s
	iters: 300, epoch: 1 | loss: 0.0939851
	speed: 0.0132s/iter; left time: 539.9286s
	iters: 400, epoch: 1 | loss: 0.1923493
	speed: 0.0150s/iter; left time: 615.4372s
Epoch: 1 cost time: 7.340607643127441
Epoch: 1, Steps: 413 | Train Loss: 0.724 Vali Loss: 0.165 Vali Acc: 0.939 Test Loss: 0.165 Test Acc: 0.939
Validation loss decreased (inf --> -0.939062).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1447519
	speed: 0.0623s/iter; left time: 2541.5119s
	iters: 200, epoch: 2 | loss: 0.0497895
	speed: 0.0122s/iter; left time: 495.7946s
	iters: 300, epoch: 2 | loss: 0.3012364
	speed: 0.0125s/iter; left time: 507.4552s
	iters: 400, epoch: 2 | loss: 0.0897421
	speed: 0.0132s/iter; left time: 535.8616s
Epoch: 2 cost time: 5.618152379989624
Epoch: 2, Steps: 413 | Train Loss: 0.119 Vali Loss: 0.106 Vali Acc: 0.960 Test Loss: 0.106 Test Acc: 0.960
Validation loss decreased (-0.939062 --> -0.960436).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0439276
	speed: 0.0539s/iter; left time: 2174.7629s
	iters: 200, epoch: 3 | loss: 0.0147773
	speed: 0.0139s/iter; left time: 561.0919s
	iters: 300, epoch: 3 | loss: 0.0951394
	speed: 0.0131s/iter; left time: 527.1667s
	iters: 400, epoch: 3 | loss: 0.1193284
	speed: 0.0125s/iter; left time: 501.7692s
Epoch: 3 cost time: 5.630009174346924
Epoch: 3, Steps: 413 | Train Loss: 0.073 Vali Loss: 0.088 Vali Acc: 0.969 Test Loss: 0.088 Test Acc: 0.969
Validation loss decreased (-0.960436 --> -0.969076).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0702737
	speed: 0.0421s/iter; left time: 1680.8397s
	iters: 200, epoch: 4 | loss: 0.0149674
	speed: 0.0120s/iter; left time: 479.9860s
	iters: 300, epoch: 4 | loss: 0.0014138
	speed: 0.0115s/iter; left time: 457.4284s
	iters: 400, epoch: 4 | loss: 0.0118167
	speed: 0.0123s/iter; left time: 486.4431s
Epoch: 4 cost time: 5.212626695632935
Epoch: 4, Steps: 413 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.956 Test Loss: 0.144 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0091784
	speed: 0.0564s/iter; left time: 2229.1388s
	iters: 200, epoch: 5 | loss: 0.0304636
	speed: 0.0132s/iter; left time: 518.8311s
	iters: 300, epoch: 5 | loss: 0.0238855
	speed: 0.0137s/iter; left time: 537.7133s
	iters: 400, epoch: 5 | loss: 0.0015455
	speed: 0.0122s/iter; left time: 478.6267s
Epoch: 5 cost time: 5.958751678466797
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.115 Vali Acc: 0.962 Test Loss: 0.115 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0035125
	speed: 0.0515s/iter; left time: 2017.2489s
	iters: 200, epoch: 6 | loss: 0.0014261
	speed: 0.0129s/iter; left time: 503.7570s
	iters: 300, epoch: 6 | loss: 0.0323176
	speed: 0.0134s/iter; left time: 521.6856s
	iters: 400, epoch: 6 | loss: 0.0015699
	speed: 0.0132s/iter; left time: 510.9201s
Epoch: 6 cost time: 5.9240288734436035
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.085 Vali Acc: 0.973 Test Loss: 0.085 Test Acc: 0.973
Validation loss decreased (-0.969076 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0013888
	speed: 0.0620s/iter; left time: 2402.4239s
	iters: 200, epoch: 7 | loss: 0.0036767
	speed: 0.0123s/iter; left time: 474.3627s
	iters: 300, epoch: 7 | loss: 0.0085633
	speed: 0.0132s/iter; left time: 509.7099s
	iters: 400, epoch: 7 | loss: 0.0103379
	speed: 0.0132s/iter; left time: 507.8184s
Epoch: 7 cost time: 5.9760918617248535
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0202556
	speed: 0.0600s/iter; left time: 2298.2023s
	iters: 200, epoch: 8 | loss: 0.0354862
	speed: 0.0126s/iter; left time: 479.6829s
	iters: 300, epoch: 8 | loss: 0.0015734
	speed: 0.0130s/iter; left time: 494.7920s
	iters: 400, epoch: 8 | loss: 0.0063870
	speed: 0.0141s/iter; left time: 534.1076s
Epoch: 8 cost time: 5.8355324268341064
Epoch: 8, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.972 Test Loss: 0.084 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0003742
	speed: 0.0663s/iter; left time: 2513.0074s
	iters: 200, epoch: 9 | loss: 0.0088626
	speed: 0.0141s/iter; left time: 534.0206s
	iters: 300, epoch: 9 | loss: 0.0004435
	speed: 0.0134s/iter; left time: 506.2388s
	iters: 400, epoch: 9 | loss: 0.0001223
	speed: 0.0146s/iter; left time: 549.4483s
Epoch: 9 cost time: 6.262962102890015
Epoch: 9, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0002295
	speed: 0.0555s/iter; left time: 2080.0910s
	iters: 200, epoch: 10 | loss: 0.0028415
	speed: 0.0125s/iter; left time: 466.6387s
	iters: 300, epoch: 10 | loss: 0.2320258
	speed: 0.0134s/iter; left time: 497.8863s
	iters: 400, epoch: 10 | loss: 0.0000257
	speed: 0.0136s/iter; left time: 505.0300s
Epoch: 10 cost time: 5.819016695022583
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.972714 --> -0.973169).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0003656
	speed: 0.0385s/iter; left time: 1428.5944s
	iters: 200, epoch: 11 | loss: 0.0002504
	speed: 0.0111s/iter; left time: 410.7730s
	iters: 300, epoch: 11 | loss: 0.0011513
	speed: 0.0114s/iter; left time: 419.0533s
	iters: 400, epoch: 11 | loss: 0.0013747
	speed: 0.0101s/iter; left time: 371.4759s
Epoch: 11 cost time: 4.774897575378418
Epoch: 11, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0000206
	speed: 0.0369s/iter; left time: 1351.5716s
	iters: 200, epoch: 12 | loss: 0.0083742
	speed: 0.0136s/iter; left time: 496.6146s
	iters: 300, epoch: 12 | loss: 0.0000780
	speed: 0.0120s/iter; left time: 438.8366s
	iters: 400, epoch: 12 | loss: 0.0000028
	speed: 0.0118s/iter; left time: 430.4278s
Epoch: 12 cost time: 5.422978639602661
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 13 | loss: 0.0035365
	speed: 0.0564s/iter; left time: 2044.3218s
	iters: 200, epoch: 13 | loss: 0.0111716
	speed: 0.0149s/iter; left time: 537.7579s
	iters: 300, epoch: 13 | loss: 0.0016599
	speed: 0.0121s/iter; left time: 436.7363s
	iters: 400, epoch: 13 | loss: 0.0003116
	speed: 0.0127s/iter; left time: 457.3434s
Epoch: 13 cost time: 5.9696173667907715
Epoch: 13, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.973169 --> -0.974078).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0055482
	speed: 0.0592s/iter; left time: 2120.7029s
	iters: 200, epoch: 14 | loss: 0.0000771
	speed: 0.0135s/iter; left time: 480.6461s
	iters: 300, epoch: 14 | loss: 0.0000225
	speed: 0.0129s/iter; left time: 459.4029s
	iters: 400, epoch: 14 | loss: 0.0002358
	speed: 0.0140s/iter; left time: 498.0576s
Epoch: 14 cost time: 6.092398166656494
Epoch: 14, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0001299
	speed: 0.0604s/iter; left time: 2138.4367s
	iters: 200, epoch: 15 | loss: 0.0326250
	speed: 0.0112s/iter; left time: 396.5163s
	iters: 300, epoch: 15 | loss: 0.0008755
	speed: 0.0118s/iter; left time: 414.8871s
	iters: 400, epoch: 15 | loss: 0.0064148
	speed: 0.0127s/iter; left time: 446.7974s
Epoch: 15 cost time: 5.316855192184448
Epoch: 15, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0035005
	speed: 0.0470s/iter; left time: 1644.6458s
	iters: 200, epoch: 16 | loss: 0.0068911
	speed: 0.0116s/iter; left time: 405.6471s
	iters: 300, epoch: 16 | loss: 0.0002850
	speed: 0.0116s/iter; left time: 404.5789s
	iters: 400, epoch: 16 | loss: 0.0000048
	speed: 0.0124s/iter; left time: 429.7102s
Epoch: 16 cost time: 5.082037448883057
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0002635
	speed: 0.0415s/iter; left time: 1434.7947s
	iters: 200, epoch: 17 | loss: 0.0022979
	speed: 0.0137s/iter; left time: 470.9145s
	iters: 300, epoch: 17 | loss: 0.0000696
	speed: 0.0118s/iter; left time: 404.9356s
	iters: 400, epoch: 17 | loss: 0.0000111
	speed: 0.0130s/iter; left time: 444.7123s
Epoch: 17 cost time: 5.378644943237305
Epoch: 17, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.158 Vali Acc: 0.969 Test Loss: 0.158 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0017037
	speed: 0.0441s/iter; left time: 1508.5877s
	iters: 200, epoch: 18 | loss: 0.0000010
	speed: 0.0124s/iter; left time: 422.7163s
	iters: 300, epoch: 18 | loss: 0.0000159
	speed: 0.0128s/iter; left time: 433.6205s
	iters: 400, epoch: 18 | loss: 0.0000480
	speed: 0.0125s/iter; left time: 423.9707s
Epoch: 18 cost time: 5.6555259227752686
Epoch: 18, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.249 Vali Acc: 0.954 Test Loss: 0.249 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.1144980
	speed: 0.0535s/iter; left time: 1806.5794s
	iters: 200, epoch: 19 | loss: 0.0000056
	speed: 0.0148s/iter; left time: 499.7286s
	iters: 300, epoch: 19 | loss: 0.0000067
	speed: 0.0137s/iter; left time: 460.7107s
	iters: 400, epoch: 19 | loss: 0.0000722
	speed: 0.0134s/iter; left time: 447.7348s
Epoch: 19 cost time: 6.281298637390137
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
Validation loss decreased (-0.974078 --> -0.978171).  Saving model ...
	iters: 100, epoch: 20 | loss: 0.0000045
	speed: 0.0524s/iter; left time: 1749.3071s
	iters: 200, epoch: 20 | loss: 0.0000049
	speed: 0.0121s/iter; left time: 402.5133s
	iters: 300, epoch: 20 | loss: 0.0000016
	speed: 0.0126s/iter; left time: 416.5523s
	iters: 400, epoch: 20 | loss: 0.0000056
	speed: 0.0127s/iter; left time: 419.2953s
Epoch: 20 cost time: 5.580713748931885
Epoch: 20, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 21 | loss: 0.0000051
	speed: 0.0503s/iter; left time: 1657.2441s
	iters: 200, epoch: 21 | loss: 0.0000000
	speed: 0.0106s/iter; left time: 346.8520s
	iters: 300, epoch: 21 | loss: 0.0000002
	speed: 0.0104s/iter; left time: 340.1466s
	iters: 400, epoch: 21 | loss: 0.0019285
	speed: 0.0115s/iter; left time: 374.6363s
Epoch: 21 cost time: 4.760185956954956
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.141 Vali Acc: 0.975 Test Loss: 0.141 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 22 | loss: 0.0000000
	speed: 0.0332s/iter; left time: 1079.2605s
	iters: 200, epoch: 22 | loss: 0.0008567
	speed: 0.0096s/iter; left time: 310.5207s
	iters: 300, epoch: 22 | loss: 0.0003643
	speed: 0.0108s/iter; left time: 348.7919s
	iters: 400, epoch: 22 | loss: 0.0000172
	speed: 0.0108s/iter; left time: 347.5413s
Epoch: 22 cost time: 4.55009913444519
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 23 | loss: 0.0000000
	speed: 0.0331s/iter; left time: 1062.1151s
	iters: 200, epoch: 23 | loss: 0.0000039
	speed: 0.0113s/iter; left time: 360.3646s
	iters: 300, epoch: 23 | loss: 0.0041917
	speed: 0.0105s/iter; left time: 333.5563s
	iters: 400, epoch: 23 | loss: 0.0013420
	speed: 0.0114s/iter; left time: 361.1447s
Epoch: 23 cost time: 4.855410575866699
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.267 Vali Acc: 0.959 Test Loss: 0.267 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 24 | loss: 0.0001575
	speed: 0.0424s/iter; left time: 1342.7838s
	iters: 200, epoch: 24 | loss: 0.0019015
	speed: 0.0124s/iter; left time: 390.7600s
	iters: 300, epoch: 24 | loss: 0.0000038
	speed: 0.0113s/iter; left time: 355.4676s
	iters: 400, epoch: 24 | loss: 0.0000233
	speed: 0.0119s/iter; left time: 372.9342s
Epoch: 24 cost time: 5.385712385177612
Epoch: 24, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.971 Test Loss: 0.225 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 25 | loss: 0.0002144
	speed: 0.0485s/iter; left time: 1516.9197s
	iters: 200, epoch: 25 | loss: 0.0007464
	speed: 0.0127s/iter; left time: 396.1613s
	iters: 300, epoch: 25 | loss: 0.0000013
	speed: 0.0121s/iter; left time: 377.0971s
	iters: 400, epoch: 25 | loss: 0.0000002
	speed: 0.0122s/iter; left time: 378.6435s
Epoch: 25 cost time: 5.421987771987915
Epoch: 25, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.280 Vali Acc: 0.959 Test Loss: 0.280 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 26 | loss: 0.0002408
	speed: 0.0514s/iter; left time: 1588.3814s
	iters: 200, epoch: 26 | loss: 0.0000019
	speed: 0.0120s/iter; left time: 370.7836s
	iters: 300, epoch: 26 | loss: 0.0137462
	speed: 0.0119s/iter; left time: 363.7672s
	iters: 400, epoch: 26 | loss: 0.0000764
	speed: 0.0114s/iter; left time: 347.9303s
Epoch: 26 cost time: 5.295373201370239
Epoch: 26, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.249 Vali Acc: 0.972 Test Loss: 0.249 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 27 | loss: 0.0033258
	speed: 0.0427s/iter; left time: 1299.4800s
	iters: 200, epoch: 27 | loss: 0.0003973
	speed: 0.0114s/iter; left time: 345.9248s
	iters: 300, epoch: 27 | loss: 0.0070005
	speed: 0.0102s/iter; left time: 309.2497s
	iters: 400, epoch: 27 | loss: 0.0227498
	speed: 0.0118s/iter; left time: 355.8428s
Epoch: 27 cost time: 4.9025750160217285
Epoch: 27, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.272 Vali Acc: 0.968 Test Loss: 0.272 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 28 | loss: 0.0022823
	speed: 0.0368s/iter; left time: 1106.5900s
	iters: 200, epoch: 28 | loss: 0.0000000
	speed: 0.0108s/iter; left time: 323.4348s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0115s/iter; left time: 343.2836s
	iters: 400, epoch: 28 | loss: 0.0000015
	speed: 0.0104s/iter; left time: 309.3956s
Epoch: 28 cost time: 4.851212024688721
Epoch: 28, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 29 | loss: 0.0000004
	speed: 0.0378s/iter; left time: 1120.2591s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0114s/iter; left time: 335.7897s
	iters: 300, epoch: 29 | loss: 0.0000000
	speed: 0.0110s/iter; left time: 325.1296s
	iters: 400, epoch: 29 | loss: 0.0000002
	speed: 0.0120s/iter; left time: 351.4438s
Epoch: 29 cost time: 4.96585750579834
Epoch: 29, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 30395
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2388574
	speed: 0.0261s/iter; left time: 1076.3550s
	iters: 200, epoch: 1 | loss: 0.6056337
	speed: 0.0112s/iter; left time: 461.5788s
	iters: 300, epoch: 1 | loss: 0.1734774
	speed: 0.0107s/iter; left time: 439.4857s
	iters: 400, epoch: 1 | loss: 0.0511462
	speed: 0.0118s/iter; left time: 483.6675s
Epoch: 1 cost time: 6.189636707305908
Epoch: 1, Steps: 413 | Train Loss: 0.724 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0170873
	speed: 0.0404s/iter; left time: 1649.5568s
	iters: 200, epoch: 2 | loss: 0.3031423
	speed: 0.0109s/iter; left time: 442.5221s
	iters: 300, epoch: 2 | loss: 0.0413126
	speed: 0.0120s/iter; left time: 487.8037s
	iters: 400, epoch: 2 | loss: 0.0141295
	speed: 0.0111s/iter; left time: 450.0398s
Epoch: 2 cost time: 5.118438959121704
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.076 Vali Acc: 0.973 Test Loss: 0.076 Test Acc: 0.973
Validation loss decreased (-0.955433 --> -0.973169).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.3791611
	speed: 0.0377s/iter; left time: 1520.7713s
	iters: 200, epoch: 3 | loss: 0.0624159
	speed: 0.0114s/iter; left time: 457.6402s
	iters: 300, epoch: 3 | loss: 0.1644272
	speed: 0.0121s/iter; left time: 485.1485s
	iters: 400, epoch: 3 | loss: 0.0043105
	speed: 0.0110s/iter; left time: 440.4712s
Epoch: 3 cost time: 5.044381856918335
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0050222
	speed: 0.0507s/iter; left time: 2028.0287s
	iters: 200, epoch: 4 | loss: 0.0017438
	speed: 0.0114s/iter; left time: 452.5594s
	iters: 300, epoch: 4 | loss: 0.0537269
	speed: 0.0140s/iter; left time: 556.1656s
	iters: 400, epoch: 4 | loss: 0.2670400
	speed: 0.0123s/iter; left time: 488.5426s
Epoch: 4 cost time: 5.680146932601929
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.074 Vali Acc: 0.979 Test Loss: 0.074 Test Acc: 0.979
Validation loss decreased (-0.974533 --> -0.978626).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0032620
	speed: 0.0543s/iter; left time: 2149.3534s
	iters: 200, epoch: 5 | loss: 0.0205047
	speed: 0.0133s/iter; left time: 524.1858s
	iters: 300, epoch: 5 | loss: 0.0808791
	speed: 0.0132s/iter; left time: 518.1451s
	iters: 400, epoch: 5 | loss: 0.0459101
	speed: 0.0136s/iter; left time: 531.8446s
Epoch: 5 cost time: 5.776553153991699
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.060 Vali Acc: 0.975 Test Loss: 0.060 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1522239
	speed: 0.0539s/iter; left time: 2108.9159s
	iters: 200, epoch: 6 | loss: 0.0111245
	speed: 0.0126s/iter; left time: 490.8592s
	iters: 300, epoch: 6 | loss: 0.0004028
	speed: 0.0140s/iter; left time: 544.4138s
	iters: 400, epoch: 6 | loss: 0.1697908
	speed: 0.0114s/iter; left time: 440.8495s
Epoch: 6 cost time: 5.709822654724121
Epoch: 6, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.085 Vali Acc: 0.978 Test Loss: 0.085 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0076311
	speed: 0.0481s/iter; left time: 1861.2094s
	iters: 200, epoch: 7 | loss: 0.0002870
	speed: 0.0120s/iter; left time: 462.7969s
	iters: 300, epoch: 7 | loss: 0.0057739
	speed: 0.0132s/iter; left time: 507.3639s
	iters: 400, epoch: 7 | loss: 0.0015261
	speed: 0.0113s/iter; left time: 435.8270s
Epoch: 7 cost time: 5.46708345413208
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.975 Test Loss: 0.097 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0658019
	speed: 0.0469s/iter; left time: 1794.9858s
	iters: 200, epoch: 8 | loss: 0.0181404
	speed: 0.0117s/iter; left time: 446.0285s
	iters: 300, epoch: 8 | loss: 0.0116620
	speed: 0.0116s/iter; left time: 442.8153s
	iters: 400, epoch: 8 | loss: 0.0011934
	speed: 0.0119s/iter; left time: 453.9892s
Epoch: 8 cost time: 5.2713234424591064
Epoch: 8, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.093 Vali Acc: 0.970 Test Loss: 0.093 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0002513
	speed: 0.0457s/iter; left time: 1733.3436s
	iters: 200, epoch: 9 | loss: 0.0003824
	speed: 0.0138s/iter; left time: 523.1718s
	iters: 300, epoch: 9 | loss: 0.0000170
	speed: 0.0133s/iter; left time: 501.5161s
	iters: 400, epoch: 9 | loss: 0.0132057
	speed: 0.0132s/iter; left time: 497.8214s
Epoch: 9 cost time: 5.69589900970459
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0037277
	speed: 0.0568s/iter; left time: 2127.4018s
	iters: 200, epoch: 10 | loss: 0.0133579
	speed: 0.0130s/iter; left time: 485.2515s
	iters: 300, epoch: 10 | loss: 0.0000590
	speed: 0.0124s/iter; left time: 461.8269s
	iters: 400, epoch: 10 | loss: 0.2440290
	speed: 0.0138s/iter; left time: 514.0681s
Epoch: 10 cost time: 5.947420358657837
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0004797
	speed: 0.0610s/iter; left time: 2260.4204s
	iters: 200, epoch: 11 | loss: 0.0266663
	speed: 0.0139s/iter; left time: 514.6196s
	iters: 300, epoch: 11 | loss: 0.0000134
	speed: 0.0127s/iter; left time: 468.5826s
	iters: 400, epoch: 11 | loss: 0.0000319
	speed: 0.0125s/iter; left time: 460.1993s
Epoch: 11 cost time: 5.956345558166504
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0008815
	speed: 0.0456s/iter; left time: 1671.1990s
	iters: 200, epoch: 12 | loss: 0.0108340
	speed: 0.0111s/iter; left time: 405.3682s
	iters: 300, epoch: 12 | loss: 0.0000008
	speed: 0.0102s/iter; left time: 370.2202s
	iters: 400, epoch: 12 | loss: 0.0015947
	speed: 0.0116s/iter; left time: 421.0703s
Epoch: 12 cost time: 4.791271448135376
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.079 Vali Acc: 0.978 Test Loss: 0.079 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.0040865
	speed: 0.0367s/iter; left time: 1331.4623s
	iters: 200, epoch: 13 | loss: 0.0000081
	speed: 0.0101s/iter; left time: 364.2612s
	iters: 300, epoch: 13 | loss: 0.0001530
	speed: 0.0104s/iter; left time: 373.2218s
	iters: 400, epoch: 13 | loss: 0.0023626
	speed: 0.0109s/iter; left time: 391.3895s
Epoch: 13 cost time: 4.665440082550049
Epoch: 13, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0005117
	speed: 0.0395s/iter; left time: 1416.5875s
	iters: 200, epoch: 14 | loss: 0.0414085
	speed: 0.0098s/iter; left time: 351.3230s
	iters: 300, epoch: 14 | loss: 0.0010013
	speed: 0.0109s/iter; left time: 390.0578s
	iters: 400, epoch: 14 | loss: 0.0000012
	speed: 0.0118s/iter; left time: 417.6078s
Epoch: 14 cost time: 4.791717290878296
Epoch: 14, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9786266484765803
model parameter : 30102
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2468374
	speed: 0.0209s/iter; left time: 860.2944s
	iters: 200, epoch: 1 | loss: 0.2584231
	speed: 0.0100s/iter; left time: 409.5608s
	iters: 300, epoch: 1 | loss: 0.1964694
	speed: 0.0099s/iter; left time: 405.3379s
	iters: 400, epoch: 1 | loss: 0.1271531
	speed: 0.0099s/iter; left time: 404.6648s
Epoch: 1 cost time: 5.241547107696533
Epoch: 1, Steps: 413 | Train Loss: 0.736 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
Validation loss decreased (inf --> -0.961800).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1977192
	speed: 0.0321s/iter; left time: 1308.6818s
	iters: 200, epoch: 2 | loss: 0.0650106
	speed: 0.0092s/iter; left time: 374.9316s
	iters: 300, epoch: 2 | loss: 0.4506095
	speed: 0.0089s/iter; left time: 362.9696s
	iters: 400, epoch: 2 | loss: 0.0308190
	speed: 0.0080s/iter; left time: 324.4262s
Epoch: 2 cost time: 3.8899428844451904
Epoch: 2, Steps: 413 | Train Loss: 0.117 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
Validation loss decreased (-0.961800 --> -0.964983).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0187311
	speed: 0.0319s/iter; left time: 1289.9460s
	iters: 200, epoch: 3 | loss: 0.0351511
	speed: 0.0094s/iter; left time: 378.7514s
	iters: 300, epoch: 3 | loss: 0.0364340
	speed: 0.0097s/iter; left time: 391.0679s
	iters: 400, epoch: 3 | loss: 0.0078841
	speed: 0.0101s/iter; left time: 406.2860s
Epoch: 3 cost time: 4.239768028259277
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.105 Vali Acc: 0.964 Test Loss: 0.105 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0301956
	speed: 0.0336s/iter; left time: 1344.4046s
	iters: 200, epoch: 4 | loss: 0.0467071
	speed: 0.0095s/iter; left time: 377.4522s
	iters: 300, epoch: 4 | loss: 0.0023140
	speed: 0.0103s/iter; left time: 409.9924s
	iters: 400, epoch: 4 | loss: 0.1118864
	speed: 0.0106s/iter; left time: 418.5746s
Epoch: 4 cost time: 4.3755974769592285
Epoch: 4, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.095 Vali Acc: 0.971 Test Loss: 0.095 Test Acc: 0.971
Validation loss decreased (-0.964983 --> -0.971350).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1542577
	speed: 0.0338s/iter; left time: 1338.6368s
	iters: 200, epoch: 5 | loss: 0.0043796
	speed: 0.0100s/iter; left time: 392.6766s
	iters: 300, epoch: 5 | loss: 0.0236879
	speed: 0.0111s/iter; left time: 435.1050s
	iters: 400, epoch: 5 | loss: 0.0091526
	speed: 0.0113s/iter; left time: 443.6042s
Epoch: 5 cost time: 4.5792014598846436
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.973624).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0034412
	speed: 0.0322s/iter; left time: 1259.7355s
	iters: 200, epoch: 6 | loss: 0.0056462
	speed: 0.0104s/iter; left time: 406.0890s
	iters: 300, epoch: 6 | loss: 0.0041012
	speed: 0.0098s/iter; left time: 383.2247s
	iters: 400, epoch: 6 | loss: 0.0012748
	speed: 0.0109s/iter; left time: 424.1241s
Epoch: 6 cost time: 4.504275560379028
Epoch: 6, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.092 Vali Acc: 0.967 Test Loss: 0.092 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0445736
	speed: 0.0336s/iter; left time: 1300.9345s
	iters: 200, epoch: 7 | loss: 0.0004797
	speed: 0.0107s/iter; left time: 411.7799s
	iters: 300, epoch: 7 | loss: 0.0094982
	speed: 0.0108s/iter; left time: 416.6661s
	iters: 400, epoch: 7 | loss: 0.0004106
	speed: 0.0107s/iter; left time: 410.8651s
Epoch: 7 cost time: 4.652930736541748
Epoch: 7, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.102 Vali Acc: 0.969 Test Loss: 0.102 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0244707
	speed: 0.0424s/iter; left time: 1622.8543s
	iters: 200, epoch: 8 | loss: 0.0189260
	speed: 0.0113s/iter; left time: 431.0085s
	iters: 300, epoch: 8 | loss: 0.0005539
	speed: 0.0127s/iter; left time: 485.4676s
	iters: 400, epoch: 8 | loss: 0.0004347
	speed: 0.0104s/iter; left time: 396.6411s
Epoch: 8 cost time: 5.0171263217926025
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.965 Test Loss: 0.126 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0140106
	speed: 0.0416s/iter; left time: 1577.4848s
	iters: 200, epoch: 9 | loss: 0.0000400
	speed: 0.0115s/iter; left time: 433.7056s
	iters: 300, epoch: 9 | loss: 0.1656324
	speed: 0.0106s/iter; left time: 397.7816s
	iters: 400, epoch: 9 | loss: 0.0017402
	speed: 0.0106s/iter; left time: 396.9831s
Epoch: 9 cost time: 4.711070537567139
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.960 Test Loss: 0.129 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0001519
	speed: 0.0423s/iter; left time: 1584.3280s
	iters: 200, epoch: 10 | loss: 0.0012144
	speed: 0.0104s/iter; left time: 389.7071s
	iters: 300, epoch: 10 | loss: 0.0001861
	speed: 0.0098s/iter; left time: 366.8566s
	iters: 400, epoch: 10 | loss: 0.0271261
	speed: 0.0094s/iter; left time: 350.3846s
Epoch: 10 cost time: 4.409953832626343
Epoch: 10, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0172703
	speed: 0.0321s/iter; left time: 1189.9910s
	iters: 200, epoch: 11 | loss: 0.1216801
	speed: 0.0096s/iter; left time: 356.2358s
	iters: 300, epoch: 11 | loss: 0.0171272
	speed: 0.0102s/iter; left time: 374.3832s
	iters: 400, epoch: 11 | loss: 0.0203187
	speed: 0.0102s/iter; left time: 376.8275s
Epoch: 11 cost time: 4.345012426376343
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0003566
	speed: 0.0308s/iter; left time: 1130.2003s
	iters: 200, epoch: 12 | loss: 0.0075212
	speed: 0.0101s/iter; left time: 370.6862s
	iters: 300, epoch: 12 | loss: 0.0052514
	speed: 0.0098s/iter; left time: 356.5328s
	iters: 400, epoch: 12 | loss: 0.0009409
	speed: 0.0104s/iter; left time: 379.6098s
Epoch: 12 cost time: 4.478765964508057
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0290069
	speed: 0.0333s/iter; left time: 1207.8296s
	iters: 200, epoch: 13 | loss: 0.0052302
	speed: 0.0109s/iter; left time: 394.5324s
	iters: 300, epoch: 13 | loss: 0.0000088
	speed: 0.0106s/iter; left time: 382.8683s
	iters: 400, epoch: 13 | loss: 0.0001811
	speed: 0.0101s/iter; left time: 364.4902s
Epoch: 13 cost time: 4.687323093414307
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0065266
	speed: 0.0429s/iter; left time: 1537.4007s
	iters: 200, epoch: 14 | loss: 0.1674191
	speed: 0.0102s/iter; left time: 365.8541s
	iters: 300, epoch: 14 | loss: 0.0138868
	speed: 0.0102s/iter; left time: 361.9471s
	iters: 400, epoch: 14 | loss: 0.0000172
	speed: 0.0106s/iter; left time: 375.1668s
Epoch: 14 cost time: 4.740599870681763
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0434135
	speed: 0.0430s/iter; left time: 1523.4124s
	iters: 200, epoch: 15 | loss: 0.0003819
	speed: 0.0110s/iter; left time: 388.1060s
	iters: 300, epoch: 15 | loss: 0.0000569
	speed: 0.0097s/iter; left time: 341.1741s
	iters: 400, epoch: 15 | loss: 0.1917580
	speed: 0.0096s/iter; left time: 338.4711s
Epoch: 15 cost time: 4.588211297988892
Epoch: 15, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9736243747157799
model parameter : 30336
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0693632
	speed: 0.0221s/iter; left time: 908.6829s
	iters: 200, epoch: 1 | loss: 0.1673758
	speed: 0.0097s/iter; left time: 396.9116s
	iters: 300, epoch: 1 | loss: 0.1011420
	speed: 0.0098s/iter; left time: 403.3770s
	iters: 400, epoch: 1 | loss: 0.1382029
	speed: 0.0105s/iter; left time: 430.8807s
Epoch: 1 cost time: 5.388484954833984
Epoch: 1, Steps: 413 | Train Loss: 0.723 Vali Loss: 0.171 Vali Acc: 0.939 Test Loss: 0.171 Test Acc: 0.939
Validation loss decreased (inf --> -0.938607).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1971907
	speed: 0.0455s/iter; left time: 1857.3022s
	iters: 200, epoch: 2 | loss: 0.5079600
	speed: 0.0110s/iter; left time: 445.6675s
	iters: 300, epoch: 2 | loss: 0.0081265
	speed: 0.0110s/iter; left time: 447.9129s
	iters: 400, epoch: 2 | loss: 0.0172875
	speed: 0.0110s/iter; left time: 443.6554s
Epoch: 2 cost time: 4.844133138656616
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.115 Vali Acc: 0.960 Test Loss: 0.115 Test Acc: 0.960
Validation loss decreased (-0.938607 --> -0.959526).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1410616
	speed: 0.0428s/iter; left time: 1727.7226s
	iters: 200, epoch: 3 | loss: 0.0494688
	speed: 0.0114s/iter; left time: 457.6164s
	iters: 300, epoch: 3 | loss: 0.1646883
	speed: 0.0107s/iter; left time: 430.2105s
	iters: 400, epoch: 3 | loss: 0.0230787
	speed: 0.0112s/iter; left time: 449.4617s
Epoch: 3 cost time: 4.947736501693726
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.075 Vali Acc: 0.971 Test Loss: 0.075 Test Acc: 0.971
Validation loss decreased (-0.959526 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0105502
	speed: 0.0463s/iter; left time: 1850.3515s
	iters: 200, epoch: 4 | loss: 0.2125157
	speed: 0.0094s/iter; left time: 375.1813s
	iters: 300, epoch: 4 | loss: 0.1312239
	speed: 0.0108s/iter; left time: 428.7913s
	iters: 400, epoch: 4 | loss: 0.2790272
	speed: 0.0101s/iter; left time: 400.0845s
Epoch: 4 cost time: 4.483738660812378
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.105 Vali Acc: 0.964 Test Loss: 0.105 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0110086
	speed: 0.0347s/iter; left time: 1374.2429s
	iters: 200, epoch: 5 | loss: 0.0301868
	speed: 0.0101s/iter; left time: 400.0246s
	iters: 300, epoch: 5 | loss: 0.0348193
	speed: 0.0100s/iter; left time: 393.2927s
	iters: 400, epoch: 5 | loss: 0.0023976
	speed: 0.0101s/iter; left time: 396.8377s
Epoch: 5 cost time: 4.414846420288086
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.076 Vali Acc: 0.974 Test Loss: 0.076 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974078).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0060466
	speed: 0.0324s/iter; left time: 1267.2891s
	iters: 200, epoch: 6 | loss: 0.0023957
	speed: 0.0107s/iter; left time: 417.2571s
	iters: 300, epoch: 6 | loss: 0.1847072
	speed: 0.0103s/iter; left time: 402.4407s
	iters: 400, epoch: 6 | loss: 0.0476123
	speed: 0.0096s/iter; left time: 374.6415s
Epoch: 6 cost time: 4.495461940765381
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.078 Vali Acc: 0.973 Test Loss: 0.078 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0083665
	speed: 0.0360s/iter; left time: 1394.7336s
	iters: 200, epoch: 7 | loss: 0.0009799
	speed: 0.0115s/iter; left time: 442.7357s
	iters: 300, epoch: 7 | loss: 0.0001309
	speed: 0.0120s/iter; left time: 460.9983s
	iters: 400, epoch: 7 | loss: 0.0578817
	speed: 0.0109s/iter; left time: 417.5420s
Epoch: 7 cost time: 5.04723596572876
Epoch: 7, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.081 Vali Acc: 0.971 Test Loss: 0.081 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0050043
	speed: 0.0461s/iter; left time: 1766.3547s
	iters: 200, epoch: 8 | loss: 0.0102476
	speed: 0.0110s/iter; left time: 419.4900s
	iters: 300, epoch: 8 | loss: 0.0003355
	speed: 0.0115s/iter; left time: 437.3616s
	iters: 400, epoch: 8 | loss: 0.0081533
	speed: 0.0129s/iter; left time: 492.1323s
Epoch: 8 cost time: 5.187100410461426
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0018075
	speed: 0.0465s/iter; left time: 1762.8754s
	iters: 200, epoch: 9 | loss: 0.4326989
	speed: 0.0110s/iter; left time: 416.7670s
	iters: 300, epoch: 9 | loss: 0.0051307
	speed: 0.0104s/iter; left time: 390.4043s
	iters: 400, epoch: 9 | loss: 0.0146120
	speed: 0.0100s/iter; left time: 376.3632s
Epoch: 9 cost time: 4.887296438217163
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.062 Vali Acc: 0.980 Test Loss: 0.062 Test Acc: 0.980
Validation loss decreased (-0.974078 --> -0.979990).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.0052285
	speed: 0.0403s/iter; left time: 1511.7362s
	iters: 200, epoch: 10 | loss: 0.0123967
	speed: 0.0105s/iter; left time: 393.9494s
	iters: 300, epoch: 10 | loss: 0.0231135
	speed: 0.0113s/iter; left time: 419.5612s
	iters: 400, epoch: 10 | loss: 0.0044928
	speed: 0.0121s/iter; left time: 449.0721s
Epoch: 10 cost time: 4.906552076339722
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 11 | loss: 0.0002602
	speed: 0.0344s/iter; left time: 1274.2075s
	iters: 200, epoch: 11 | loss: 0.0004359
	speed: 0.0103s/iter; left time: 379.0423s
	iters: 300, epoch: 11 | loss: 0.0012360
	speed: 0.0099s/iter; left time: 364.5666s
	iters: 400, epoch: 11 | loss: 0.0005548
	speed: 0.0096s/iter; left time: 353.7663s
Epoch: 11 cost time: 4.360573053359985
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 12 | loss: 0.0055147
	speed: 0.0342s/iter; left time: 1253.1465s
	iters: 200, epoch: 12 | loss: 0.0001442
	speed: 0.0110s/iter; left time: 402.9971s
	iters: 300, epoch: 12 | loss: 0.0002061
	speed: 0.0109s/iter; left time: 398.7534s
	iters: 400, epoch: 12 | loss: 0.0060515
	speed: 0.0103s/iter; left time: 374.8422s
Epoch: 12 cost time: 4.6502180099487305
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 13 | loss: 0.0000007
	speed: 0.0425s/iter; left time: 1542.2217s
	iters: 200, epoch: 13 | loss: 0.6663440
	speed: 0.0104s/iter; left time: 375.1351s
	iters: 300, epoch: 13 | loss: 0.0004117
	speed: 0.0107s/iter; left time: 387.3568s
	iters: 400, epoch: 13 | loss: 0.3637770
	speed: 0.0124s/iter; left time: 446.7912s
Epoch: 13 cost time: 4.887012004852295
Epoch: 13, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 14 | loss: 0.0261075
	speed: 0.0434s/iter; left time: 1556.6494s
	iters: 200, epoch: 14 | loss: 0.0067390
	speed: 0.0111s/iter; left time: 398.3958s
	iters: 300, epoch: 14 | loss: 0.0006947
	speed: 0.0105s/iter; left time: 375.0039s
	iters: 400, epoch: 14 | loss: 0.0001948
	speed: 0.0100s/iter; left time: 355.3792s
Epoch: 14 cost time: 4.683414697647095
Epoch: 14, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 15 | loss: 0.0000496
	speed: 0.0346s/iter; left time: 1225.1516s
	iters: 200, epoch: 15 | loss: 0.0003830
	speed: 0.0101s/iter; left time: 356.9030s
	iters: 300, epoch: 15 | loss: 0.0000155
	speed: 0.0101s/iter; left time: 356.4418s
	iters: 400, epoch: 15 | loss: 0.0003710
	speed: 0.0105s/iter; left time: 368.0880s
Epoch: 15 cost time: 4.537004470825195
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 16 | loss: 0.0542495
	speed: 0.0338s/iter; left time: 1181.7190s
	iters: 200, epoch: 16 | loss: 0.0035251
	speed: 0.0095s/iter; left time: 331.9952s
	iters: 300, epoch: 16 | loss: 0.0000514
	speed: 0.0107s/iter; left time: 372.0165s
	iters: 400, epoch: 16 | loss: 0.0095262
	speed: 0.0102s/iter; left time: 354.2285s
Epoch: 16 cost time: 4.464824438095093
Epoch: 16, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 17 | loss: 0.0000073
	speed: 0.0333s/iter; left time: 1152.0576s
	iters: 200, epoch: 17 | loss: 0.0001311
	speed: 0.0097s/iter; left time: 335.3126s
	iters: 300, epoch: 17 | loss: 0.0000457
	speed: 0.0103s/iter; left time: 355.3504s
	iters: 400, epoch: 17 | loss: 0.0000140
	speed: 0.0113s/iter; left time: 387.6781s
Epoch: 17 cost time: 4.506577253341675
Epoch: 17, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 18 | loss: 0.0000005
	speed: 0.0447s/iter; left time: 1527.0144s
	iters: 200, epoch: 18 | loss: 0.0001379
	speed: 0.0114s/iter; left time: 388.1064s
	iters: 300, epoch: 18 | loss: 0.0004731
	speed: 0.0112s/iter; left time: 380.5159s
	iters: 400, epoch: 18 | loss: 0.0059039
	speed: 0.0119s/iter; left time: 402.1790s
Epoch: 18 cost time: 5.027777194976807
Epoch: 18, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 19 | loss: 0.0000022
	speed: 0.0466s/iter; left time: 1574.3370s
	iters: 200, epoch: 19 | loss: 0.0000362
	speed: 0.0114s/iter; left time: 382.5685s
	iters: 300, epoch: 19 | loss: 0.0000303
	speed: 0.0114s/iter; left time: 381.0624s
	iters: 400, epoch: 19 | loss: 0.0003646
	speed: 0.0111s/iter; left time: 371.1239s
Epoch: 19 cost time: 5.164198637008667
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9799909049567985
model parameter : 30214
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1755307
	speed: 0.0219s/iter; left time: 903.7455s
	iters: 200, epoch: 1 | loss: 0.1846081
	speed: 0.0099s/iter; left time: 405.3399s
	iters: 300, epoch: 1 | loss: 0.1768962
	speed: 0.0097s/iter; left time: 398.5564s
	iters: 400, epoch: 1 | loss: 0.1234141
	speed: 0.0102s/iter; left time: 418.9029s
Epoch: 1 cost time: 5.346453666687012
Epoch: 1, Steps: 413 | Train Loss: 0.705 Vali Loss: 0.175 Vali Acc: 0.945 Test Loss: 0.175 Test Acc: 0.945
Validation loss decreased (inf --> -0.944973).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1360851
	speed: 0.0364s/iter; left time: 1486.1261s
	iters: 200, epoch: 2 | loss: 0.0942176
	speed: 0.0111s/iter; left time: 451.4423s
	iters: 300, epoch: 2 | loss: 0.1531837
	speed: 0.0117s/iter; left time: 475.9865s
	iters: 400, epoch: 2 | loss: 0.0575728
	speed: 0.0119s/iter; left time: 480.1672s
Epoch: 2 cost time: 4.850086688995361
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.147 Vali Acc: 0.950 Test Loss: 0.147 Test Acc: 0.950
Validation loss decreased (-0.944973 --> -0.949521).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0584091
	speed: 0.0463s/iter; left time: 1870.5029s
	iters: 200, epoch: 3 | loss: 0.0708733
	speed: 0.0116s/iter; left time: 466.2398s
	iters: 300, epoch: 3 | loss: 0.1898206
	speed: 0.0115s/iter; left time: 461.6068s
	iters: 400, epoch: 3 | loss: 0.0096438
	speed: 0.0112s/iter; left time: 448.4860s
Epoch: 3 cost time: 5.100079298019409
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0105590
	speed: 0.0471s/iter; left time: 1884.1231s
	iters: 200, epoch: 4 | loss: 0.0085825
	speed: 0.0111s/iter; left time: 442.2839s
	iters: 300, epoch: 4 | loss: 0.0061169
	speed: 0.0116s/iter; left time: 461.8442s
	iters: 400, epoch: 4 | loss: 0.0317109
	speed: 0.0114s/iter; left time: 451.1294s
Epoch: 4 cost time: 5.048382520675659
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.140 Vali Acc: 0.961 Test Loss: 0.140 Test Acc: 0.961
Validation loss decreased (-0.949521 --> -0.960890).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0004365
	speed: 0.0399s/iter; left time: 1579.2204s
	iters: 200, epoch: 5 | loss: 0.0062621
	speed: 0.0098s/iter; left time: 385.5682s
	iters: 300, epoch: 5 | loss: 0.0152699
	speed: 0.0104s/iter; left time: 408.3621s
	iters: 400, epoch: 5 | loss: 0.0057672
	speed: 0.0102s/iter; left time: 399.9391s
Epoch: 5 cost time: 4.537629127502441
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.070 Vali Acc: 0.976 Test Loss: 0.070 Test Acc: 0.976
Validation loss decreased (-0.960890 --> -0.976352).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0005112
	speed: 0.0341s/iter; left time: 1335.2805s
	iters: 200, epoch: 6 | loss: 0.0166836
	speed: 0.0098s/iter; left time: 381.7581s
	iters: 300, epoch: 6 | loss: 0.0141869
	speed: 0.0097s/iter; left time: 379.3103s
	iters: 400, epoch: 6 | loss: 0.0214625
	speed: 0.0093s/iter; left time: 361.8704s
Epoch: 6 cost time: 4.3217198848724365
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.088 Vali Acc: 0.973 Test Loss: 0.088 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0357635
	speed: 0.0371s/iter; left time: 1437.9621s
	iters: 200, epoch: 7 | loss: 0.0037904
	speed: 0.0103s/iter; left time: 396.1842s
	iters: 300, epoch: 7 | loss: 0.0006591
	speed: 0.0097s/iter; left time: 371.8474s
	iters: 400, epoch: 7 | loss: 0.0893992
	speed: 0.0099s/iter; left time: 379.6685s
Epoch: 7 cost time: 4.471564292907715
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.081 Vali Acc: 0.974 Test Loss: 0.081 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0213322
	speed: 0.0451s/iter; left time: 1726.9134s
	iters: 200, epoch: 8 | loss: 0.0010267
	speed: 0.0113s/iter; left time: 430.1138s
	iters: 300, epoch: 8 | loss: 0.0010293
	speed: 0.0116s/iter; left time: 441.9774s
	iters: 400, epoch: 8 | loss: 0.0307659
	speed: 0.0119s/iter; left time: 451.0296s
Epoch: 8 cost time: 5.036010980606079
Epoch: 8, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.080 Vali Acc: 0.975 Test Loss: 0.080 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0054337
	speed: 0.0469s/iter; left time: 1777.7672s
	iters: 200, epoch: 9 | loss: 0.0033045
	speed: 0.0112s/iter; left time: 422.1669s
	iters: 300, epoch: 9 | loss: 0.0003032
	speed: 0.0109s/iter; left time: 409.3976s
	iters: 400, epoch: 9 | loss: 0.0033182
	speed: 0.0113s/iter; left time: 425.7779s
Epoch: 9 cost time: 4.95408821105957
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0052920
	speed: 0.0477s/iter; left time: 1788.0249s
	iters: 200, epoch: 10 | loss: 0.0011946
	speed: 0.0121s/iter; left time: 453.8959s
	iters: 300, epoch: 10 | loss: 0.0004488
	speed: 0.0115s/iter; left time: 430.6041s
	iters: 400, epoch: 10 | loss: 0.0705898
	speed: 0.0107s/iter; left time: 398.2598s
Epoch: 10 cost time: 5.094297170639038
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.246 Vali Acc: 0.949 Test Loss: 0.246 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0046088
	speed: 0.0362s/iter; left time: 1340.9230s
	iters: 200, epoch: 11 | loss: 0.0000529
	speed: 0.0106s/iter; left time: 392.6803s
	iters: 300, epoch: 11 | loss: 0.0038191
	speed: 0.0106s/iter; left time: 391.9741s
	iters: 400, epoch: 11 | loss: 0.1068623
	speed: 0.0107s/iter; left time: 394.4488s
Epoch: 11 cost time: 4.657520771026611
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000385
	speed: 0.0391s/iter; left time: 1432.4129s
	iters: 200, epoch: 12 | loss: 0.0001013
	speed: 0.0108s/iter; left time: 393.7593s
	iters: 300, epoch: 12 | loss: 0.0000458
	speed: 0.0106s/iter; left time: 385.2712s
	iters: 400, epoch: 12 | loss: 0.0011835
	speed: 0.0106s/iter; left time: 384.4937s
Epoch: 12 cost time: 4.708348274230957
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0011114
	speed: 0.0350s/iter; left time: 1267.9066s
	iters: 200, epoch: 13 | loss: 0.0114043
	speed: 0.0115s/iter; left time: 415.9972s
	iters: 300, epoch: 13 | loss: 0.0005721
	speed: 0.0117s/iter; left time: 421.9912s
	iters: 400, epoch: 13 | loss: 0.1281305
	speed: 0.0116s/iter; left time: 418.7075s
Epoch: 13 cost time: 5.029690742492676
Epoch: 13, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0000152
	speed: 0.0504s/iter; left time: 1804.5944s
	iters: 200, epoch: 14 | loss: 0.0172836
	speed: 0.0110s/iter; left time: 392.6108s
	iters: 300, epoch: 14 | loss: 0.0149159
	speed: 0.0120s/iter; left time: 427.9802s
	iters: 400, epoch: 14 | loss: 0.0092527
	speed: 0.0120s/iter; left time: 424.6634s
Epoch: 14 cost time: 5.244709253311157
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0019751
	speed: 0.0475s/iter; left time: 1681.7643s
	iters: 200, epoch: 15 | loss: 0.0000032
	speed: 0.0113s/iter; left time: 399.3872s
	iters: 300, epoch: 15 | loss: 0.0003238
	speed: 0.0110s/iter; left time: 385.7347s
	iters: 400, epoch: 15 | loss: 0.0291144
	speed: 0.0104s/iter; left time: 363.8239s
Epoch: 15 cost time: 4.911257028579712
Epoch: 15, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.257 Vali Acc: 0.955 Test Loss: 0.257 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 30279
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1645287
	speed: 0.0213s/iter; left time: 879.2240s
	iters: 200, epoch: 1 | loss: 0.1023692
	speed: 0.0106s/iter; left time: 437.0135s
	iters: 300, epoch: 1 | loss: 0.3166984
	speed: 0.0114s/iter; left time: 465.5682s
	iters: 400, epoch: 1 | loss: 0.1720069
	speed: 0.0114s/iter; left time: 465.9143s
Epoch: 1 cost time: 5.674596309661865
Epoch: 1, Steps: 413 | Train Loss: 0.739 Vali Loss: 0.152 Vali Acc: 0.954 Test Loss: 0.152 Test Acc: 0.954
Validation loss decreased (inf --> -0.954069).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0877243
	speed: 0.0446s/iter; left time: 1820.8565s
	iters: 200, epoch: 2 | loss: 0.0962663
	speed: 0.0117s/iter; left time: 477.3490s
	iters: 300, epoch: 2 | loss: 0.0386081
	speed: 0.0119s/iter; left time: 482.1140s
	iters: 400, epoch: 2 | loss: 0.0703454
	speed: 0.0118s/iter; left time: 476.0213s
Epoch: 2 cost time: 5.219542980194092
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.115 Vali Acc: 0.966 Test Loss: 0.115 Test Acc: 0.966
Validation loss decreased (-0.954069 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0249288
	speed: 0.0437s/iter; left time: 1764.9370s
	iters: 200, epoch: 3 | loss: 0.3086430
	speed: 0.0122s/iter; left time: 493.2662s
	iters: 300, epoch: 3 | loss: 0.0033074
	speed: 0.0112s/iter; left time: 450.8012s
	iters: 400, epoch: 3 | loss: 0.0685883
	speed: 0.0130s/iter; left time: 519.6316s
Epoch: 3 cost time: 5.5654003620147705
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.966347 --> -0.967712).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0729792
	speed: 0.0430s/iter; left time: 1718.4099s
	iters: 200, epoch: 4 | loss: 0.0025708
	speed: 0.0100s/iter; left time: 396.8943s
	iters: 300, epoch: 4 | loss: 0.0179123
	speed: 0.0099s/iter; left time: 394.0879s
	iters: 400, epoch: 4 | loss: 0.0430392
	speed: 0.0098s/iter; left time: 387.5894s
Epoch: 4 cost time: 4.442569017410278
Epoch: 4, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.090 Vali Acc: 0.968 Test Loss: 0.090 Test Acc: 0.968
Validation loss decreased (-0.967712 --> -0.968166).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0085054
	speed: 0.0358s/iter; left time: 1414.0099s
	iters: 200, epoch: 5 | loss: 0.0211653
	speed: 0.0103s/iter; left time: 406.6448s
	iters: 300, epoch: 5 | loss: 0.0142790
	speed: 0.0102s/iter; left time: 400.0909s
	iters: 400, epoch: 5 | loss: 0.1172134
	speed: 0.0110s/iter; left time: 430.6106s
Epoch: 5 cost time: 4.6040449142456055
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0260629
	speed: 0.0339s/iter; left time: 1327.0816s
	iters: 200, epoch: 6 | loss: 0.0014820
	speed: 0.0105s/iter; left time: 408.3874s
	iters: 300, epoch: 6 | loss: 0.0224946
	speed: 0.0107s/iter; left time: 417.5755s
	iters: 400, epoch: 6 | loss: 0.0269831
	speed: 0.0107s/iter; left time: 417.0954s
Epoch: 6 cost time: 4.647543430328369
Epoch: 6, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3482561
	speed: 0.0425s/iter; left time: 1644.5394s
	iters: 200, epoch: 7 | loss: 0.0008118
	speed: 0.0120s/iter; left time: 462.3417s
	iters: 300, epoch: 7 | loss: 0.0201146
	speed: 0.0114s/iter; left time: 440.9535s
	iters: 400, epoch: 7 | loss: 0.0020914
	speed: 0.0112s/iter; left time: 428.8849s
Epoch: 7 cost time: 5.124255657196045
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.970 Test Loss: 0.102 Test Acc: 0.970
Validation loss decreased (-0.968166 --> -0.969985).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.3641898
	speed: 0.0461s/iter; left time: 1764.5053s
	iters: 200, epoch: 8 | loss: 0.0104140
	speed: 0.0112s/iter; left time: 429.3273s
	iters: 300, epoch: 8 | loss: 0.0000247
	speed: 0.0113s/iter; left time: 432.4269s
	iters: 400, epoch: 8 | loss: 0.0009036
	speed: 0.0117s/iter; left time: 443.9356s
Epoch: 8 cost time: 5.017816543579102
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.969985 --> -0.974533).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0007012
	speed: 0.0460s/iter; left time: 1742.2063s
	iters: 200, epoch: 9 | loss: 0.0006199
	speed: 0.0106s/iter; left time: 400.8679s
	iters: 300, epoch: 9 | loss: 0.0020849
	speed: 0.0104s/iter; left time: 392.4759s
	iters: 400, epoch: 9 | loss: 0.0020727
	speed: 0.0102s/iter; left time: 383.3822s
Epoch: 9 cost time: 4.699610948562622
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.093 Vali Acc: 0.971 Test Loss: 0.093 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0004943
	speed: 0.0349s/iter; left time: 1309.4959s
	iters: 200, epoch: 10 | loss: 0.0006929
	speed: 0.0103s/iter; left time: 384.2394s
	iters: 300, epoch: 10 | loss: 0.0416493
	speed: 0.0103s/iter; left time: 382.8095s
	iters: 400, epoch: 10 | loss: 0.0001983
	speed: 0.0101s/iter; left time: 376.5125s
Epoch: 10 cost time: 4.469099283218384
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.966 Test Loss: 0.124 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0203181
	speed: 0.0344s/iter; left time: 1274.4166s
	iters: 200, epoch: 11 | loss: 0.0000045
	speed: 0.0103s/iter; left time: 382.6257s
	iters: 300, epoch: 11 | loss: 0.0000533
	speed: 0.0100s/iter; left time: 367.8163s
	iters: 400, epoch: 11 | loss: 0.1081946
	speed: 0.0100s/iter; left time: 369.0014s
Epoch: 11 cost time: 4.531861305236816
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0002007
	speed: 0.0359s/iter; left time: 1317.0356s
	iters: 200, epoch: 12 | loss: 0.0006188
	speed: 0.0117s/iter; left time: 425.9156s
	iters: 300, epoch: 12 | loss: 0.0001037
	speed: 0.0115s/iter; left time: 418.0803s
	iters: 400, epoch: 12 | loss: 0.0035861
	speed: 0.0114s/iter; left time: 413.4758s
Epoch: 12 cost time: 5.03265118598938
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0039962
	speed: 0.0480s/iter; left time: 1738.5550s
	iters: 200, epoch: 13 | loss: 0.0137151
	speed: 0.0112s/iter; left time: 405.9483s
	iters: 300, epoch: 13 | loss: 0.0005746
	speed: 0.0119s/iter; left time: 430.6458s
	iters: 400, epoch: 13 | loss: 0.0000184
	speed: 0.0119s/iter; left time: 428.1470s
Epoch: 13 cost time: 5.166025400161743
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.974533 --> -0.978171).  Saving model ...
	iters: 100, epoch: 14 | loss: 0.0000435
	speed: 0.0469s/iter; left time: 1681.8769s
	iters: 200, epoch: 14 | loss: 0.0000112
	speed: 0.0110s/iter; left time: 393.3187s
	iters: 300, epoch: 14 | loss: 0.0197440
	speed: 0.0110s/iter; left time: 392.8413s
	iters: 400, epoch: 14 | loss: 0.0041011
	speed: 0.0104s/iter; left time: 370.3721s
Epoch: 14 cost time: 4.865945100784302
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 15 | loss: 0.0000094
	speed: 0.0334s/iter; left time: 1183.1717s
	iters: 200, epoch: 15 | loss: 0.0013899
	speed: 0.0105s/iter; left time: 372.2247s
	iters: 300, epoch: 15 | loss: 0.0005469
	speed: 0.0104s/iter; left time: 365.5464s
	iters: 400, epoch: 15 | loss: 0.0890160
	speed: 0.0104s/iter; left time: 364.6238s
Epoch: 15 cost time: 4.57057523727417
Epoch: 15, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 16 | loss: 0.0835752
	speed: 0.0346s/iter; left time: 1210.1221s
	iters: 200, epoch: 16 | loss: 0.0000096
	speed: 0.0104s/iter; left time: 364.0469s
	iters: 300, epoch: 16 | loss: 0.0000789
	speed: 0.0101s/iter; left time: 350.1465s
	iters: 400, epoch: 16 | loss: 0.0000070
	speed: 0.0106s/iter; left time: 366.2567s
Epoch: 16 cost time: 4.538730621337891
Epoch: 16, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 17 | loss: 0.0000018
	speed: 0.0345s/iter; left time: 1192.7856s
	iters: 200, epoch: 17 | loss: 0.0001273
	speed: 0.0097s/iter; left time: 335.7718s
	iters: 300, epoch: 17 | loss: 0.0000027
	speed: 0.0111s/iter; left time: 381.5217s
	iters: 400, epoch: 17 | loss: 0.0000079
	speed: 0.0124s/iter; left time: 424.5237s
Epoch: 17 cost time: 4.829267740249634
Epoch: 17, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 18 | loss: 0.0000001
	speed: 0.0480s/iter; left time: 1640.4738s
	iters: 200, epoch: 18 | loss: 0.0000000
	speed: 0.0122s/iter; left time: 415.1698s
	iters: 300, epoch: 18 | loss: 0.0024376
	speed: 0.0118s/iter; left time: 400.0894s
	iters: 400, epoch: 18 | loss: 0.0000120
	speed: 0.0109s/iter; left time: 369.5737s
Epoch: 18 cost time: 5.170267105102539
Epoch: 18, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.231 Vali Acc: 0.966 Test Loss: 0.231 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 19 | loss: 0.0008473
	speed: 0.0478s/iter; left time: 1614.0111s
	iters: 200, epoch: 19 | loss: 0.0000062
	speed: 0.0112s/iter; left time: 377.3657s
	iters: 300, epoch: 19 | loss: 0.0000053
	speed: 0.0115s/iter; left time: 385.2043s
	iters: 400, epoch: 19 | loss: 0.0000001
	speed: 0.0110s/iter; left time: 368.7230s
Epoch: 19 cost time: 5.076453685760498
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.965 Test Loss: 0.195 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 20 | loss: 0.0010238
	speed: 0.0382s/iter; left time: 1274.3856s
	iters: 200, epoch: 20 | loss: 0.0000000
	speed: 0.0114s/iter; left time: 377.7299s
	iters: 300, epoch: 20 | loss: 0.0000016
	speed: 0.0108s/iter; left time: 358.1390s
	iters: 400, epoch: 20 | loss: 0.0000000
	speed: 0.0109s/iter; left time: 360.8561s
Epoch: 20 cost time: 4.827782392501831
Epoch: 20, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.973 Test Loss: 0.188 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 21 | loss: 0.2497123
	speed: 0.0372s/iter; left time: 1226.7401s
	iters: 200, epoch: 21 | loss: 0.0128611
	speed: 0.0107s/iter; left time: 351.4319s
	iters: 300, epoch: 21 | loss: 0.0000152
	speed: 0.0104s/iter; left time: 340.4010s
	iters: 400, epoch: 21 | loss: 0.0003044
	speed: 0.0120s/iter; left time: 390.5707s
Epoch: 21 cost time: 4.892841339111328
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.974 Test Loss: 0.210 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 22 | loss: 0.0012028
	speed: 0.0375s/iter; left time: 1220.2878s
	iters: 200, epoch: 22 | loss: 0.6516868
	speed: 0.0107s/iter; left time: 345.4829s
	iters: 300, epoch: 22 | loss: 0.0001048
	speed: 0.0118s/iter; left time: 382.4276s
	iters: 400, epoch: 22 | loss: 0.0056888
	speed: 0.0116s/iter; left time: 372.6200s
Epoch: 22 cost time: 5.0587544441223145
Epoch: 22, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.974 Test Loss: 0.175 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 23 | loss: 0.0000551
	speed: 0.0403s/iter; left time: 1292.8905s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0116s/iter; left time: 372.2269s
	iters: 300, epoch: 23 | loss: 0.0000187
	speed: 0.0108s/iter; left time: 345.3370s
	iters: 400, epoch: 23 | loss: 0.0001070
	speed: 0.0107s/iter; left time: 339.2026s
Epoch: 23 cost time: 4.891568660736084
Epoch: 23, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.976 Test Loss: 0.168 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 25124
model size : 0.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3607018
	speed: 0.0216s/iter; left time: 891.7601s
	iters: 200, epoch: 1 | loss: 0.5180554
	speed: 0.0129s/iter; left time: 530.0666s
	iters: 300, epoch: 1 | loss: 0.1804280
	speed: 0.0117s/iter; left time: 480.6768s
	iters: 400, epoch: 1 | loss: 0.1268865
	speed: 0.0116s/iter; left time: 472.8451s
Epoch: 1 cost time: 6.001309633255005
Epoch: 1, Steps: 413 | Train Loss: 0.773 Vali Loss: 0.135 Vali Acc: 0.961 Test Loss: 0.135 Test Acc: 0.961
Validation loss decreased (inf --> -0.961345).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1288934
	speed: 0.0461s/iter; left time: 1878.7504s
	iters: 200, epoch: 2 | loss: 0.3075647
	speed: 0.0112s/iter; left time: 454.7193s
	iters: 300, epoch: 2 | loss: 0.1077089
	speed: 0.0116s/iter; left time: 469.1050s
	iters: 400, epoch: 2 | loss: 0.0485435
	speed: 0.0114s/iter; left time: 463.0412s
Epoch: 2 cost time: 5.093698501586914
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.079 Vali Acc: 0.975 Test Loss: 0.079 Test Acc: 0.975
Validation loss decreased (-0.961345 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0124576
	speed: 0.0519s/iter; left time: 2094.7974s
	iters: 200, epoch: 3 | loss: 0.0916959
	speed: 0.0117s/iter; left time: 471.9645s
	iters: 300, epoch: 3 | loss: 0.0648908
	speed: 0.0115s/iter; left time: 461.8095s
	iters: 400, epoch: 3 | loss: 0.0206929
	speed: 0.0115s/iter; left time: 459.7985s
Epoch: 3 cost time: 5.137183904647827
Epoch: 3, Steps: 413 | Train Loss: 0.082 Vali Loss: 0.093 Vali Acc: 0.967 Test Loss: 0.093 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0066553
	speed: 0.0400s/iter; left time: 1599.0967s
	iters: 200, epoch: 4 | loss: 0.0116872
	speed: 0.0099s/iter; left time: 394.0951s
	iters: 300, epoch: 4 | loss: 0.1628475
	speed: 0.0107s/iter; left time: 423.9332s
	iters: 400, epoch: 4 | loss: 0.0256727
	speed: 0.0098s/iter; left time: 388.4148s
Epoch: 4 cost time: 4.423330783843994
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.073 Vali Acc: 0.975 Test Loss: 0.073 Test Acc: 0.975
Validation loss decreased (-0.974988 --> -0.974988).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0699019
	speed: 0.0339s/iter; left time: 1340.4577s
	iters: 200, epoch: 5 | loss: 0.0134999
	speed: 0.0100s/iter; left time: 394.7165s
	iters: 300, epoch: 5 | loss: 0.0221082
	speed: 0.0106s/iter; left time: 417.1685s
	iters: 400, epoch: 5 | loss: 0.0418718
	speed: 0.0100s/iter; left time: 392.1364s
Epoch: 5 cost time: 4.568697929382324
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.064 Vali Acc: 0.979 Test Loss: 0.064 Test Acc: 0.979
Validation loss decreased (-0.974988 --> -0.979081).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0036289
	speed: 0.0335s/iter; left time: 1310.7402s
	iters: 200, epoch: 6 | loss: 0.0182754
	speed: 0.0104s/iter; left time: 404.6871s
	iters: 300, epoch: 6 | loss: 0.0055902
	speed: 0.0100s/iter; left time: 388.7266s
	iters: 400, epoch: 6 | loss: 0.0702719
	speed: 0.0100s/iter; left time: 388.4888s
Epoch: 6 cost time: 4.455250024795532
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0158588
	speed: 0.0461s/iter; left time: 1786.4256s
	iters: 200, epoch: 7 | loss: 0.0032571
	speed: 0.0114s/iter; left time: 441.1944s
	iters: 300, epoch: 7 | loss: 0.0035631
	speed: 0.0117s/iter; left time: 450.9530s
	iters: 400, epoch: 7 | loss: 0.0058219
	speed: 0.0115s/iter; left time: 443.3473s
Epoch: 7 cost time: 5.148965835571289
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.113 Vali Acc: 0.970 Test Loss: 0.113 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0020882
	speed: 0.0477s/iter; left time: 1825.9617s
	iters: 200, epoch: 8 | loss: 0.0024118
	speed: 0.0118s/iter; left time: 450.0845s
	iters: 300, epoch: 8 | loss: 0.0326686
	speed: 0.0118s/iter; left time: 448.7072s
	iters: 400, epoch: 8 | loss: 0.0111556
	speed: 0.0111s/iter; left time: 422.5094s
Epoch: 8 cost time: 5.0648462772369385
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0002211
	speed: 0.0452s/iter; left time: 1712.9683s
	iters: 200, epoch: 9 | loss: 0.0023907
	speed: 0.0109s/iter; left time: 412.5814s
	iters: 300, epoch: 9 | loss: 0.0011355
	speed: 0.0101s/iter; left time: 381.5340s
	iters: 400, epoch: 9 | loss: 0.0365667
	speed: 0.0100s/iter; left time: 377.1866s
Epoch: 9 cost time: 4.750167608261108
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0121049
	speed: 0.0334s/iter; left time: 1253.7488s
	iters: 200, epoch: 10 | loss: 0.0001978
	speed: 0.0104s/iter; left time: 389.5049s
	iters: 300, epoch: 10 | loss: 0.0044437
	speed: 0.0110s/iter; left time: 410.2150s
	iters: 400, epoch: 10 | loss: 0.0001313
	speed: 0.0098s/iter; left time: 364.6279s
Epoch: 10 cost time: 4.5201640129089355
Epoch: 10, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0002348
	speed: 0.0347s/iter; left time: 1287.4511s
	iters: 200, epoch: 11 | loss: 0.0193743
	speed: 0.0101s/iter; left time: 371.7145s
	iters: 300, epoch: 11 | loss: 0.0008444
	speed: 0.0101s/iter; left time: 371.0977s
	iters: 400, epoch: 11 | loss: 0.0015031
	speed: 0.0100s/iter; left time: 368.4768s
Epoch: 11 cost time: 4.481661558151245
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0886834
	speed: 0.0361s/iter; left time: 1322.9860s
	iters: 200, epoch: 12 | loss: 0.0008064
	speed: 0.0111s/iter; left time: 407.4812s
	iters: 300, epoch: 12 | loss: 0.0006238
	speed: 0.0113s/iter; left time: 413.2020s
	iters: 400, epoch: 12 | loss: 0.0004258
	speed: 0.0120s/iter; left time: 437.9207s
Epoch: 12 cost time: 5.00073766708374
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0020453
	speed: 0.0457s/iter; left time: 1654.8450s
	iters: 200, epoch: 13 | loss: 0.0002748
	speed: 0.0109s/iter; left time: 392.3711s
	iters: 300, epoch: 13 | loss: 0.0000537
	speed: 0.0118s/iter; left time: 424.0579s
	iters: 400, epoch: 13 | loss: 0.0004740
	speed: 0.0114s/iter; left time: 408.5179s
Epoch: 13 cost time: 5.047887563705444
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0003799
	speed: 0.0447s/iter; left time: 1601.2222s
	iters: 200, epoch: 14 | loss: 0.0005217
	speed: 0.0111s/iter; left time: 397.4152s
	iters: 300, epoch: 14 | loss: 0.0018504
	speed: 0.0114s/iter; left time: 405.3855s
	iters: 400, epoch: 14 | loss: 0.0194246
	speed: 0.0103s/iter; left time: 365.6200s
Epoch: 14 cost time: 4.85817289352417
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0007443
	speed: 0.0352s/iter; left time: 1245.9893s
	iters: 200, epoch: 15 | loss: 0.0113536
	speed: 0.0101s/iter; left time: 356.0043s
	iters: 300, epoch: 15 | loss: 0.0011722
	speed: 0.0115s/iter; left time: 404.0975s
	iters: 400, epoch: 15 | loss: 0.0000026
	speed: 0.0112s/iter; left time: 394.9968s
Epoch: 15 cost time: 4.846285104751587
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.959 Test Loss: 0.226 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.979081400636653
model parameter : 24533
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3468242
	speed: 0.0239s/iter; left time: 984.4661s
	iters: 200, epoch: 1 | loss: 0.3287385
	speed: 0.0107s/iter; left time: 439.7375s
	iters: 300, epoch: 1 | loss: 0.2242574
	speed: 0.0108s/iter; left time: 444.6464s
	iters: 400, epoch: 1 | loss: 0.2491496
	speed: 0.0109s/iter; left time: 445.2510s
Epoch: 1 cost time: 5.8085036277771
Epoch: 1, Steps: 413 | Train Loss: 0.772 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
Validation loss decreased (inf --> -0.958161).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1149463
	speed: 0.0389s/iter; left time: 1588.4399s
	iters: 200, epoch: 2 | loss: 0.1309840
	speed: 0.0110s/iter; left time: 446.5604s
	iters: 300, epoch: 2 | loss: 0.1026123
	speed: 0.0108s/iter; left time: 439.4962s
	iters: 400, epoch: 2 | loss: 0.0219296
	speed: 0.0111s/iter; left time: 447.9212s
Epoch: 2 cost time: 4.811541795730591
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
Validation loss decreased (-0.958161 --> -0.967712).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0733023
	speed: 0.0398s/iter; left time: 1608.0189s
	iters: 200, epoch: 3 | loss: 0.0858243
	speed: 0.0104s/iter; left time: 419.3357s
	iters: 300, epoch: 3 | loss: 0.0210213
	speed: 0.0103s/iter; left time: 414.7963s
	iters: 400, epoch: 3 | loss: 0.2047738
	speed: 0.0100s/iter; left time: 399.2052s
Epoch: 3 cost time: 4.479381084442139
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.098 Vali Acc: 0.964 Test Loss: 0.098 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.3099152
	speed: 0.0377s/iter; left time: 1506.3771s
	iters: 200, epoch: 4 | loss: 0.0160541
	speed: 0.0102s/iter; left time: 407.8284s
	iters: 300, epoch: 4 | loss: 0.0074428
	speed: 0.0100s/iter; left time: 396.7679s
	iters: 400, epoch: 4 | loss: 0.0094332
	speed: 0.0101s/iter; left time: 399.8886s
Epoch: 4 cost time: 4.520368814468384
Epoch: 4, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.101 Vali Acc: 0.962 Test Loss: 0.101 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0035570
	speed: 0.0353s/iter; left time: 1396.3914s
	iters: 200, epoch: 5 | loss: 0.0036653
	speed: 0.0100s/iter; left time: 395.7593s
	iters: 300, epoch: 5 | loss: 0.0202587
	speed: 0.0115s/iter; left time: 451.5603s
	iters: 400, epoch: 5 | loss: 0.0010957
	speed: 0.0111s/iter; left time: 434.1295s
Epoch: 5 cost time: 4.778931379318237
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.961 Test Loss: 0.120 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0075491
	speed: 0.0436s/iter; left time: 1707.8312s
	iters: 200, epoch: 6 | loss: 0.0008171
	speed: 0.0103s/iter; left time: 403.1110s
	iters: 300, epoch: 6 | loss: 0.0041820
	speed: 0.0105s/iter; left time: 408.7404s
	iters: 400, epoch: 6 | loss: 0.0101022
	speed: 0.0103s/iter; left time: 398.7107s
Epoch: 6 cost time: 4.893092632293701
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.967712 --> -0.972714).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0013210
	speed: 0.0440s/iter; left time: 1702.0664s
	iters: 200, epoch: 7 | loss: 0.0005325
	speed: 0.0101s/iter; left time: 391.2905s
	iters: 300, epoch: 7 | loss: 0.0366015
	speed: 0.0100s/iter; left time: 385.9053s
	iters: 400, epoch: 7 | loss: 0.0004586
	speed: 0.0106s/iter; left time: 406.4011s
Epoch: 7 cost time: 4.622729301452637
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0010851
	speed: 0.0399s/iter; left time: 1528.0919s
	iters: 200, epoch: 8 | loss: 0.0266503
	speed: 0.0095s/iter; left time: 362.5677s
	iters: 300, epoch: 8 | loss: 0.0000857
	speed: 0.0097s/iter; left time: 371.3486s
	iters: 400, epoch: 8 | loss: 0.0009298
	speed: 0.0104s/iter; left time: 394.0465s
Epoch: 8 cost time: 4.4540183544158936
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.969 Test Loss: 0.105 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 9 | loss: 0.0650593
	speed: 0.0325s/iter; left time: 1230.2564s
	iters: 200, epoch: 9 | loss: 0.0126338
	speed: 0.0113s/iter; left time: 426.1996s
	iters: 300, epoch: 9 | loss: 0.0214235
	speed: 0.0103s/iter; left time: 388.0424s
	iters: 400, epoch: 9 | loss: 0.0377023
	speed: 0.0093s/iter; left time: 348.8174s
Epoch: 9 cost time: 4.511988401412964
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.164 Vali Acc: 0.962 Test Loss: 0.164 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 10 | loss: 0.0007839
	speed: 0.0302s/iter; left time: 1132.8813s
	iters: 200, epoch: 10 | loss: 0.0000469
	speed: 0.0099s/iter; left time: 368.7908s
	iters: 300, epoch: 10 | loss: 0.0986718
	speed: 0.0100s/iter; left time: 372.7593s
	iters: 400, epoch: 10 | loss: 0.0005226
	speed: 0.0093s/iter; left time: 347.5637s
Epoch: 10 cost time: 4.265270948410034
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.965 Test Loss: 0.118 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 11 | loss: 0.0028504
	speed: 0.0343s/iter; left time: 1273.0170s
	iters: 200, epoch: 11 | loss: 0.0003995
	speed: 0.0105s/iter; left time: 387.6910s
	iters: 300, epoch: 11 | loss: 0.0961667
	speed: 0.0105s/iter; left time: 385.8488s
	iters: 400, epoch: 11 | loss: 0.0065879
	speed: 0.0111s/iter; left time: 407.2777s
Epoch: 11 cost time: 4.651897668838501
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 12 | loss: 0.0441428
	speed: 0.0452s/iter; left time: 1657.3210s
	iters: 200, epoch: 12 | loss: 0.0006977
	speed: 0.0105s/iter; left time: 385.6784s
	iters: 300, epoch: 12 | loss: 0.0025190
	speed: 0.0102s/iter; left time: 370.2099s
	iters: 400, epoch: 12 | loss: 0.0000972
	speed: 0.0102s/iter; left time: 370.7969s
Epoch: 12 cost time: 4.771085023880005
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 13 | loss: 0.0003510
	speed: 0.0437s/iter; left time: 1583.1811s
	iters: 200, epoch: 13 | loss: 0.0940453
	speed: 0.0110s/iter; left time: 398.9940s
	iters: 300, epoch: 13 | loss: 0.0067471
	speed: 0.0114s/iter; left time: 410.5622s
	iters: 400, epoch: 13 | loss: 0.0008184
	speed: 0.0102s/iter; left time: 365.1086s
Epoch: 13 cost time: 4.769985914230347
Epoch: 13, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 14 | loss: 0.0447970
	speed: 0.0334s/iter; left time: 1195.7946s
	iters: 200, epoch: 14 | loss: 0.0005916
	speed: 0.0096s/iter; left time: 341.7620s
	iters: 300, epoch: 14 | loss: 0.0024483
	speed: 0.0105s/iter; left time: 374.0140s
	iters: 400, epoch: 14 | loss: 0.0000175
	speed: 0.0106s/iter; left time: 377.2436s
Epoch: 14 cost time: 4.595694065093994
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 15 | loss: 0.0000207
	speed: 0.0325s/iter; left time: 1151.0560s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0110s/iter; left time: 388.6434s
	iters: 300, epoch: 15 | loss: 0.0446001
	speed: 0.0119s/iter; left time: 420.3938s
	iters: 400, epoch: 15 | loss: 0.0003053
	speed: 0.0101s/iter; left time: 355.0289s
Epoch: 15 cost time: 4.714688062667847
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.963 Test Loss: 0.215 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 16 | loss: 0.0002238
	speed: 0.0359s/iter; left time: 1255.1149s
	iters: 200, epoch: 16 | loss: 0.0000404
	speed: 0.0110s/iter; left time: 384.4032s
	iters: 300, epoch: 16 | loss: 0.0005107
	speed: 0.0104s/iter; left time: 361.7218s
	iters: 400, epoch: 16 | loss: 0.0000063
	speed: 0.0114s/iter; left time: 395.4503s
Epoch: 16 cost time: 4.681924104690552
Epoch: 16, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 24606
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3223296
	speed: 0.0247s/iter; left time: 1017.9098s
	iters: 200, epoch: 1 | loss: 0.5552102
	speed: 0.0114s/iter; left time: 467.4477s
	iters: 300, epoch: 1 | loss: 0.4666400
	speed: 0.0095s/iter; left time: 389.7245s
	iters: 400, epoch: 1 | loss: 0.1214010
	speed: 0.0109s/iter; left time: 443.9077s
Epoch: 1 cost time: 5.815584897994995
Epoch: 1, Steps: 413 | Train Loss: 0.766 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2121277
	speed: 0.0339s/iter; left time: 1384.6607s
	iters: 200, epoch: 2 | loss: 0.1372287
	speed: 0.0102s/iter; left time: 413.5782s
	iters: 300, epoch: 2 | loss: 0.0840570
	speed: 0.0094s/iter; left time: 381.5167s
	iters: 400, epoch: 2 | loss: 0.0344519
	speed: 0.0107s/iter; left time: 431.9131s
Epoch: 2 cost time: 4.399077415466309
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.092 Vali Acc: 0.971 Test Loss: 0.092 Test Acc: 0.971
Validation loss decreased (-0.955433 --> -0.971350).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1196599
	speed: 0.0377s/iter; left time: 1522.9130s
	iters: 200, epoch: 3 | loss: 0.1160600
	speed: 0.0100s/iter; left time: 402.6600s
	iters: 300, epoch: 3 | loss: 0.5485127
	speed: 0.0100s/iter; left time: 402.0428s
	iters: 400, epoch: 3 | loss: 0.0686353
	speed: 0.0103s/iter; left time: 410.9616s
Epoch: 3 cost time: 4.404644250869751
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.091 Vali Acc: 0.974 Test Loss: 0.091 Test Acc: 0.974
Validation loss decreased (-0.971350 --> -0.974078).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2249486
	speed: 0.0322s/iter; left time: 1285.5302s
	iters: 200, epoch: 4 | loss: 0.0025374
	speed: 0.0108s/iter; left time: 429.9554s
	iters: 300, epoch: 4 | loss: 0.0848246
	speed: 0.0110s/iter; left time: 438.2511s
	iters: 400, epoch: 4 | loss: 0.0852403
	speed: 0.0113s/iter; left time: 446.3401s
Epoch: 4 cost time: 4.658613204956055
Epoch: 4, Steps: 413 | Train Loss: 0.059 Vali Loss: 0.104 Vali Acc: 0.965 Test Loss: 0.104 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.1649491
	speed: 0.0440s/iter; left time: 1741.8146s
	iters: 200, epoch: 5 | loss: 0.2866125
	speed: 0.0115s/iter; left time: 454.0124s
	iters: 300, epoch: 5 | loss: 0.1480816
	speed: 0.0104s/iter; left time: 410.0317s
	iters: 400, epoch: 5 | loss: 0.0180481
	speed: 0.0106s/iter; left time: 417.7434s
Epoch: 5 cost time: 4.874481916427612
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.084 Vali Acc: 0.969 Test Loss: 0.084 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0250289
	speed: 0.0457s/iter; left time: 1787.3383s
	iters: 200, epoch: 6 | loss: 0.1693683
	speed: 0.0108s/iter; left time: 420.7217s
	iters: 300, epoch: 6 | loss: 0.1246509
	speed: 0.0113s/iter; left time: 440.2582s
	iters: 400, epoch: 6 | loss: 0.0223063
	speed: 0.0106s/iter; left time: 412.7512s
Epoch: 6 cost time: 4.881531476974487
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.964 Test Loss: 0.108 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0193629
	speed: 0.0351s/iter; left time: 1360.1664s
	iters: 200, epoch: 7 | loss: 0.0703094
	speed: 0.0102s/iter; left time: 394.0205s
	iters: 300, epoch: 7 | loss: 0.0001771
	speed: 0.0102s/iter; left time: 392.6042s
	iters: 400, epoch: 7 | loss: 0.0007541
	speed: 0.0102s/iter; left time: 392.9153s
Epoch: 7 cost time: 4.4803266525268555
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0181896
	speed: 0.0332s/iter; left time: 1271.5612s
	iters: 200, epoch: 8 | loss: 0.0087031
	speed: 0.0099s/iter; left time: 376.7849s
	iters: 300, epoch: 8 | loss: 0.0480119
	speed: 0.0100s/iter; left time: 380.5379s
	iters: 400, epoch: 8 | loss: 0.0786883
	speed: 0.0106s/iter; left time: 401.9029s
Epoch: 8 cost time: 4.422001600265503
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0332288
	speed: 0.0348s/iter; left time: 1317.9010s
	iters: 200, epoch: 9 | loss: 0.0018664
	speed: 0.0107s/iter; left time: 402.8374s
	iters: 300, epoch: 9 | loss: 0.0049812
	speed: 0.0102s/iter; left time: 385.1702s
	iters: 400, epoch: 9 | loss: 0.0001451
	speed: 0.0104s/iter; left time: 392.6735s
Epoch: 9 cost time: 4.4998486042022705
Epoch: 9, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0004441
	speed: 0.0448s/iter; left time: 1678.5084s
	iters: 200, epoch: 10 | loss: 0.0022093
	speed: 0.0119s/iter; left time: 443.1529s
	iters: 300, epoch: 10 | loss: 0.0202609
	speed: 0.0110s/iter; left time: 409.9377s
	iters: 400, epoch: 10 | loss: 0.0023494
	speed: 0.0117s/iter; left time: 435.8163s
Epoch: 10 cost time: 5.139965057373047
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0000187
	speed: 0.0429s/iter; left time: 1591.7577s
	iters: 200, epoch: 11 | loss: 0.0008126
	speed: 0.0116s/iter; left time: 427.2390s
	iters: 300, epoch: 11 | loss: 0.0006419
	speed: 0.0117s/iter; left time: 432.7715s
	iters: 400, epoch: 11 | loss: 0.0033710
	speed: 0.0108s/iter; left time: 397.4500s
Epoch: 11 cost time: 5.00544810295105
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0015977
	speed: 0.0465s/iter; left time: 1703.9803s
	iters: 200, epoch: 12 | loss: 0.0000656
	speed: 0.0102s/iter; left time: 371.9972s
	iters: 300, epoch: 12 | loss: 0.0635689
	speed: 0.0107s/iter; left time: 389.1477s
	iters: 400, epoch: 12 | loss: 0.0127005
	speed: 0.0096s/iter; left time: 348.2333s
Epoch: 12 cost time: 4.626698017120361
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0106639
	speed: 0.0303s/iter; left time: 1099.1517s
	iters: 200, epoch: 13 | loss: 0.0301665
	speed: 0.0104s/iter; left time: 375.1331s
	iters: 300, epoch: 13 | loss: 0.0019930
	speed: 0.0110s/iter; left time: 395.0656s
	iters: 400, epoch: 13 | loss: 0.0045819
	speed: 0.0098s/iter; left time: 353.5261s
Epoch: 13 cost time: 4.4785332679748535
Epoch: 13, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 24375
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1629733
	speed: 0.0235s/iter; left time: 969.3972s
	iters: 200, epoch: 1 | loss: 0.5910420
	speed: 0.0110s/iter; left time: 453.0013s
	iters: 300, epoch: 1 | loss: 0.1832659
	speed: 0.0111s/iter; left time: 457.1481s
	iters: 400, epoch: 1 | loss: 0.4706497
	speed: 0.0121s/iter; left time: 496.8174s
Epoch: 1 cost time: 5.97905421257019
Epoch: 1, Steps: 413 | Train Loss: 0.757 Vali Loss: 0.149 Vali Acc: 0.957 Test Loss: 0.149 Test Acc: 0.957
Validation loss decreased (inf --> -0.957252).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1279553
	speed: 0.0442s/iter; left time: 1802.3207s
	iters: 200, epoch: 2 | loss: 0.1408444
	speed: 0.0116s/iter; left time: 470.2526s
	iters: 300, epoch: 2 | loss: 0.0336553
	speed: 0.0105s/iter; left time: 427.5604s
	iters: 400, epoch: 2 | loss: 0.0580838
	speed: 0.0112s/iter; left time: 452.0751s
Epoch: 2 cost time: 4.965589761734009
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
Validation loss decreased (-0.957252 --> -0.968166).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0248588
	speed: 0.0349s/iter; left time: 1407.3826s
	iters: 200, epoch: 3 | loss: 0.0061074
	speed: 0.0099s/iter; left time: 396.7463s
	iters: 300, epoch: 3 | loss: 0.0098229
	speed: 0.0102s/iter; left time: 410.7677s
	iters: 400, epoch: 3 | loss: 0.0128053
	speed: 0.0104s/iter; left time: 418.1382s
Epoch: 3 cost time: 4.416518688201904
Epoch: 3, Steps: 413 | Train Loss: 0.074 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.968166 --> -0.974988).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0811568
	speed: 0.0327s/iter; left time: 1305.8983s
	iters: 200, epoch: 4 | loss: 0.0177176
	speed: 0.0107s/iter; left time: 428.4646s
	iters: 300, epoch: 4 | loss: 0.0222717
	speed: 0.0121s/iter; left time: 480.7908s
	iters: 400, epoch: 4 | loss: 0.0885641
	speed: 0.0106s/iter; left time: 419.5862s
Epoch: 4 cost time: 4.774306058883667
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.083 Vali Acc: 0.970 Test Loss: 0.083 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0256362
	speed: 0.0336s/iter; left time: 1329.1549s
	iters: 200, epoch: 5 | loss: 0.0015214
	speed: 0.0106s/iter; left time: 417.6031s
	iters: 300, epoch: 5 | loss: 0.0572419
	speed: 0.0101s/iter; left time: 397.8342s
	iters: 400, epoch: 5 | loss: 0.0409473
	speed: 0.0105s/iter; left time: 413.2659s
Epoch: 5 cost time: 4.6509130001068115
Epoch: 5, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.075 Vali Acc: 0.972 Test Loss: 0.075 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0074682
	speed: 0.0395s/iter; left time: 1545.0247s
	iters: 200, epoch: 6 | loss: 0.0006409
	speed: 0.0107s/iter; left time: 418.3188s
	iters: 300, epoch: 6 | loss: 0.0008648
	speed: 0.0102s/iter; left time: 398.7484s
	iters: 400, epoch: 6 | loss: 0.1010497
	speed: 0.0098s/iter; left time: 382.1427s
Epoch: 6 cost time: 4.5708231925964355
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.968 Test Loss: 0.120 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0025432
	speed: 0.0418s/iter; left time: 1620.3025s
	iters: 200, epoch: 7 | loss: 0.0027039
	speed: 0.0110s/iter; left time: 425.3649s
	iters: 300, epoch: 7 | loss: 0.0005183
	speed: 0.0114s/iter; left time: 437.9008s
	iters: 400, epoch: 7 | loss: 0.0432041
	speed: 0.0111s/iter; left time: 427.9397s
Epoch: 7 cost time: 4.9296510219573975
Epoch: 7, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.961 Test Loss: 0.115 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0004965
	speed: 0.0425s/iter; left time: 1626.6804s
	iters: 200, epoch: 8 | loss: 0.0063973
	speed: 0.0105s/iter; left time: 402.9476s
	iters: 300, epoch: 8 | loss: 0.0079905
	speed: 0.0111s/iter; left time: 423.8868s
	iters: 400, epoch: 8 | loss: 0.0087118
	speed: 0.0104s/iter; left time: 394.1821s
Epoch: 8 cost time: 4.651586055755615
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0185802
	speed: 0.0367s/iter; left time: 1390.9455s
	iters: 200, epoch: 9 | loss: 0.0072956
	speed: 0.0101s/iter; left time: 379.9003s
	iters: 300, epoch: 9 | loss: 0.0772329
	speed: 0.0105s/iter; left time: 397.4786s
	iters: 400, epoch: 9 | loss: 0.0000092
	speed: 0.0103s/iter; left time: 387.7247s
Epoch: 9 cost time: 4.491292238235474
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0000619
	speed: 0.0367s/iter; left time: 1373.9227s
	iters: 200, epoch: 10 | loss: 0.0046041
	speed: 0.0106s/iter; left time: 397.0994s
	iters: 300, epoch: 10 | loss: 0.0036815
	speed: 0.0110s/iter; left time: 411.4814s
	iters: 400, epoch: 10 | loss: 0.0089080
	speed: 0.0095s/iter; left time: 355.0489s
Epoch: 10 cost time: 4.66937518119812
Epoch: 10, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0001550
	speed: 0.0423s/iter; left time: 1569.8433s
	iters: 200, epoch: 11 | loss: 0.0047163
	speed: 0.0102s/iter; left time: 378.0858s
	iters: 300, epoch: 11 | loss: 0.0000179
	speed: 0.0102s/iter; left time: 375.6861s
	iters: 400, epoch: 11 | loss: 0.0011821
	speed: 0.0101s/iter; left time: 371.5247s
Epoch: 11 cost time: 4.590282201766968
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.974988 --> -0.976352).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0012498
	speed: 0.0382s/iter; left time: 1401.2534s
	iters: 200, epoch: 12 | loss: 0.0000334
	speed: 0.0100s/iter; left time: 365.3980s
	iters: 300, epoch: 12 | loss: 0.0018731
	speed: 0.0104s/iter; left time: 378.7203s
	iters: 400, epoch: 12 | loss: 0.2040940
	speed: 0.0105s/iter; left time: 382.8828s
Epoch: 12 cost time: 4.649402856826782
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0004585
	speed: 0.0383s/iter; left time: 1387.4534s
	iters: 200, epoch: 13 | loss: 0.0000055
	speed: 0.0098s/iter; left time: 355.4295s
	iters: 300, epoch: 13 | loss: 0.0627258
	speed: 0.0101s/iter; left time: 365.7499s
	iters: 400, epoch: 13 | loss: 0.0000464
	speed: 0.0104s/iter; left time: 374.7540s
Epoch: 13 cost time: 4.437798261642456
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0000046
	speed: 0.0340s/iter; left time: 1219.3079s
	iters: 200, epoch: 14 | loss: 0.0082059
	speed: 0.0100s/iter; left time: 357.7800s
	iters: 300, epoch: 14 | loss: 0.2524459
	speed: 0.0102s/iter; left time: 362.4146s
	iters: 400, epoch: 14 | loss: 0.0000419
	speed: 0.0101s/iter; left time: 358.7126s
Epoch: 14 cost time: 4.483056306838989
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0023121
	speed: 0.0350s/iter; left time: 1240.9032s
	iters: 200, epoch: 15 | loss: 0.0006974
	speed: 0.0102s/iter; left time: 359.6523s
	iters: 300, epoch: 15 | loss: 0.0007551
	speed: 0.0105s/iter; left time: 370.8146s
	iters: 400, epoch: 15 | loss: 0.0093266
	speed: 0.0111s/iter; left time: 388.7361s
Epoch: 15 cost time: 4.674180030822754
Epoch: 15, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0000200
	speed: 0.0435s/iter; left time: 1522.2431s
	iters: 200, epoch: 16 | loss: 0.0000225
	speed: 0.0112s/iter; left time: 391.5545s
	iters: 300, epoch: 16 | loss: 0.0001641
	speed: 0.0108s/iter; left time: 377.2976s
	iters: 400, epoch: 16 | loss: 0.0004116
	speed: 0.0108s/iter; left time: 374.3278s
Epoch: 16 cost time: 4.857988595962524
Epoch: 16, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000005
	speed: 0.0404s/iter; left time: 1396.4110s
	iters: 200, epoch: 17 | loss: 0.0000059
	speed: 0.0107s/iter; left time: 368.4161s
	iters: 300, epoch: 17 | loss: 0.0000209
	speed: 0.0108s/iter; left time: 372.5760s
	iters: 400, epoch: 17 | loss: 0.0000746
	speed: 0.0107s/iter; left time: 366.5582s
Epoch: 17 cost time: 4.763316869735718
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.975 Test Loss: 0.128 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0018614
	speed: 0.0401s/iter; left time: 1370.7190s
	iters: 200, epoch: 18 | loss: 0.0003712
	speed: 0.0098s/iter; left time: 335.3954s
	iters: 300, epoch: 18 | loss: 0.0000009
	speed: 0.0097s/iter; left time: 328.4510s
	iters: 400, epoch: 18 | loss: 0.0087334
	speed: 0.0110s/iter; left time: 372.6529s
Epoch: 18 cost time: 4.433058500289917
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 19 | loss: 0.0046710
	speed: 0.0319s/iter; left time: 1075.5826s
	iters: 200, epoch: 19 | loss: 0.0001029
	speed: 0.0105s/iter; left time: 353.3496s
	iters: 300, epoch: 19 | loss: 0.0000410
	speed: 0.0106s/iter; left time: 354.8011s
	iters: 400, epoch: 19 | loss: 0.0033676
	speed: 0.0099s/iter; left time: 332.4590s
Epoch: 19 cost time: 4.50941801071167
Epoch: 19, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.283 Vali Acc: 0.957 Test Loss: 0.283 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 20 | loss: 0.0000346
	speed: 0.0325s/iter; left time: 1083.6525s
	iters: 200, epoch: 20 | loss: 0.0000960
	speed: 0.0105s/iter; left time: 348.9797s
	iters: 300, epoch: 20 | loss: 0.0000012
	speed: 0.0106s/iter; left time: 351.4148s
	iters: 400, epoch: 20 | loss: 0.0000247
	speed: 0.0105s/iter; left time: 348.1955s
Epoch: 20 cost time: 4.58690333366394
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 21 | loss: 0.0000034
	speed: 0.0422s/iter; left time: 1388.8481s
	iters: 200, epoch: 21 | loss: 0.0000019
	speed: 0.0111s/iter; left time: 365.3623s
	iters: 300, epoch: 21 | loss: 0.0119407
	speed: 0.0105s/iter; left time: 345.0568s
	iters: 400, epoch: 21 | loss: 0.0000253
	speed: 0.0110s/iter; left time: 359.4542s
Epoch: 21 cost time: 4.931323766708374
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.966 Test Loss: 0.235 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 24398
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1818442
	speed: 0.0225s/iter; left time: 928.2640s
	iters: 200, epoch: 1 | loss: 0.2529836
	speed: 0.0103s/iter; left time: 424.4669s
	iters: 300, epoch: 1 | loss: 0.2427750
	speed: 0.0107s/iter; left time: 439.7914s
	iters: 400, epoch: 1 | loss: 0.1920537
	speed: 0.0109s/iter; left time: 447.3498s
Epoch: 1 cost time: 5.629135608673096
Epoch: 1, Steps: 413 | Train Loss: 0.786 Vali Loss: 0.152 Vali Acc: 0.955 Test Loss: 0.152 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0444533
	speed: 0.0359s/iter; left time: 1464.3246s
	iters: 200, epoch: 2 | loss: 0.2164829
	speed: 0.0102s/iter; left time: 416.2826s
	iters: 300, epoch: 2 | loss: 0.0729723
	speed: 0.0106s/iter; left time: 429.9473s
	iters: 400, epoch: 2 | loss: 0.1640935
	speed: 0.0105s/iter; left time: 424.6885s
Epoch: 2 cost time: 4.594322919845581
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.113 Vali Acc: 0.964 Test Loss: 0.113 Test Acc: 0.964
Validation loss decreased (-0.955433 --> -0.964073).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0838362
	speed: 0.0385s/iter; left time: 1552.7127s
	iters: 200, epoch: 3 | loss: 0.0124249
	speed: 0.0112s/iter; left time: 450.1743s
	iters: 300, epoch: 3 | loss: 0.0735426
	speed: 0.0113s/iter; left time: 453.6162s
	iters: 400, epoch: 3 | loss: 0.0432506
	speed: 0.0108s/iter; left time: 431.9155s
Epoch: 3 cost time: 4.7980382442474365
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.964073 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0277969
	speed: 0.0447s/iter; left time: 1785.9558s
	iters: 200, epoch: 4 | loss: 0.0228471
	speed: 0.0111s/iter; left time: 443.0242s
	iters: 300, epoch: 4 | loss: 0.4041448
	speed: 0.0104s/iter; left time: 412.5221s
	iters: 400, epoch: 4 | loss: 0.1007448
	speed: 0.0107s/iter; left time: 425.0167s
Epoch: 4 cost time: 4.7945334911346436
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0035515
	speed: 0.0455s/iter; left time: 1801.0937s
	iters: 200, epoch: 5 | loss: 0.0134067
	speed: 0.0110s/iter; left time: 433.6095s
	iters: 300, epoch: 5 | loss: 0.0151091
	speed: 0.0112s/iter; left time: 439.7729s
	iters: 400, epoch: 5 | loss: 0.0480925
	speed: 0.0100s/iter; left time: 391.8163s
Epoch: 5 cost time: 4.860018014907837
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.969985 --> -0.970440).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0391763
	speed: 0.0336s/iter; left time: 1313.7368s
	iters: 200, epoch: 6 | loss: 0.0292996
	speed: 0.0105s/iter; left time: 410.0659s
	iters: 300, epoch: 6 | loss: 0.0014250
	speed: 0.0105s/iter; left time: 408.7722s
	iters: 400, epoch: 6 | loss: 0.0241699
	speed: 0.0102s/iter; left time: 394.5541s
Epoch: 6 cost time: 4.500306606292725
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0042030
	speed: 0.0336s/iter; left time: 1300.7799s
	iters: 200, epoch: 7 | loss: 0.0077715
	speed: 0.0109s/iter; left time: 420.4291s
	iters: 300, epoch: 7 | loss: 0.0097501
	speed: 0.0110s/iter; left time: 423.3576s
	iters: 400, epoch: 7 | loss: 0.2668749
	speed: 0.0105s/iter; left time: 405.0708s
Epoch: 7 cost time: 4.6291797161102295
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.961 Test Loss: 0.120 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0746577
	speed: 0.0355s/iter; left time: 1358.6245s
	iters: 200, epoch: 8 | loss: 0.0017694
	speed: 0.0109s/iter; left time: 414.8431s
	iters: 300, epoch: 8 | loss: 0.0006494
	speed: 0.0109s/iter; left time: 414.9732s
	iters: 400, epoch: 8 | loss: 0.0966315
	speed: 0.0109s/iter; left time: 415.2938s
Epoch: 8 cost time: 4.755120277404785
Epoch: 8, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0017894
	speed: 0.0372s/iter; left time: 1408.7125s
	iters: 200, epoch: 9 | loss: 0.0662679
	speed: 0.0106s/iter; left time: 400.4105s
	iters: 300, epoch: 9 | loss: 0.0043871
	speed: 0.0109s/iter; left time: 412.1099s
	iters: 400, epoch: 9 | loss: 0.0048137
	speed: 0.0099s/iter; left time: 372.4720s
Epoch: 9 cost time: 4.658533334732056
Epoch: 9, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0001809
	speed: 0.0386s/iter; left time: 1445.9136s
	iters: 200, epoch: 10 | loss: 0.0062701
	speed: 0.0109s/iter; left time: 407.8420s
	iters: 300, epoch: 10 | loss: 0.0177509
	speed: 0.0105s/iter; left time: 392.7842s
	iters: 400, epoch: 10 | loss: 0.1563390
	speed: 0.0107s/iter; left time: 397.3284s
Epoch: 10 cost time: 4.829912424087524
Epoch: 10, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.142 Vali Acc: 0.958 Test Loss: 0.142 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.2751605
	speed: 0.0346s/iter; left time: 1281.3609s
	iters: 200, epoch: 11 | loss: 0.1905977
	speed: 0.0099s/iter; left time: 366.4030s
	iters: 300, epoch: 11 | loss: 0.0143365
	speed: 0.0106s/iter; left time: 390.2440s
	iters: 400, epoch: 11 | loss: 0.1303902
	speed: 0.0105s/iter; left time: 386.3596s
Epoch: 11 cost time: 4.5606465339660645
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0010539
	speed: 0.0453s/iter; left time: 1659.7661s
	iters: 200, epoch: 12 | loss: 0.0001862
	speed: 0.0112s/iter; left time: 409.6954s
	iters: 300, epoch: 12 | loss: 0.0186975
	speed: 0.0115s/iter; left time: 417.9591s
	iters: 400, epoch: 12 | loss: 0.0000606
	speed: 0.0119s/iter; left time: 431.5563s
Epoch: 12 cost time: 5.1987245082855225
Epoch: 12, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0016006
	speed: 0.0460s/iter; left time: 1665.8939s
	iters: 200, epoch: 13 | loss: 0.0005583
	speed: 0.0134s/iter; left time: 484.7949s
	iters: 300, epoch: 13 | loss: 0.0000119
	speed: 0.0119s/iter; left time: 427.1984s
	iters: 400, epoch: 13 | loss: 0.0003426
	speed: 0.0126s/iter; left time: 453.5305s
Epoch: 13 cost time: 5.56035041809082
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0001994
	speed: 0.0490s/iter; left time: 1757.5279s
	iters: 200, epoch: 14 | loss: 0.0000264
	speed: 0.0115s/iter; left time: 410.6328s
	iters: 300, epoch: 14 | loss: 0.0299205
	speed: 0.0112s/iter; left time: 398.0098s
	iters: 400, epoch: 14 | loss: 0.0000285
	speed: 0.0118s/iter; left time: 420.8720s
Epoch: 14 cost time: 5.201638698577881
Epoch: 14, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0087403
	speed: 0.0399s/iter; left time: 1411.4852s
	iters: 200, epoch: 15 | loss: 0.0000776
	speed: 0.0105s/iter; left time: 370.8755s
	iters: 300, epoch: 15 | loss: 0.0003010
	speed: 0.0105s/iter; left time: 368.2045s
	iters: 400, epoch: 15 | loss: 0.0001793
	speed: 0.0111s/iter; left time: 388.5107s
Epoch: 15 cost time: 4.765446424484253
Epoch: 15, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
Validation loss decreased (-0.970440 --> -0.971349).  Saving model ...
	iters: 100, epoch: 16 | loss: 0.0000051
	speed: 0.0317s/iter; left time: 1109.6613s
	iters: 200, epoch: 16 | loss: 0.0000045
	speed: 0.0099s/iter; left time: 347.1871s
	iters: 300, epoch: 16 | loss: 0.0015349
	speed: 0.0099s/iter; left time: 346.2334s
	iters: 400, epoch: 16 | loss: 0.6708375
	speed: 0.0112s/iter; left time: 390.4249s
Epoch: 16 cost time: 4.5872087478637695
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 17 | loss: 0.0011467
	speed: 0.0351s/iter; left time: 1214.0653s
	iters: 200, epoch: 17 | loss: 0.0000324
	speed: 0.0110s/iter; left time: 378.7901s
	iters: 300, epoch: 17 | loss: 0.1963307
	speed: 0.0111s/iter; left time: 381.4891s
	iters: 400, epoch: 17 | loss: 0.0001408
	speed: 0.0117s/iter; left time: 401.2366s
Epoch: 17 cost time: 5.000431299209595
Epoch: 17, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.966 Test Loss: 0.191 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 18 | loss: 0.0000113
	speed: 0.0404s/iter; left time: 1380.4448s
	iters: 200, epoch: 18 | loss: 0.0011518
	speed: 0.0110s/iter; left time: 374.3512s
	iters: 300, epoch: 18 | loss: 0.0433761
	speed: 0.0106s/iter; left time: 358.7362s
	iters: 400, epoch: 18 | loss: 0.0053838
	speed: 0.0111s/iter; left time: 375.3559s
Epoch: 18 cost time: 4.772603273391724
Epoch: 18, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.251 Vali Acc: 0.960 Test Loss: 0.251 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 19 | loss: 0.0000053
	speed: 0.0458s/iter; left time: 1545.9334s
	iters: 200, epoch: 19 | loss: 0.0000107
	speed: 0.0101s/iter; left time: 341.5671s
	iters: 300, epoch: 19 | loss: 0.0001462
	speed: 0.0102s/iter; left time: 341.9860s
	iters: 400, epoch: 19 | loss: 0.0000024
	speed: 0.0114s/iter; left time: 382.5988s
Epoch: 19 cost time: 4.8887529373168945
Epoch: 19, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.961 Test Loss: 0.249 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 20 | loss: 0.0000368
	speed: 0.0350s/iter; left time: 1165.7526s
	iters: 200, epoch: 20 | loss: 0.0000386
	speed: 0.0101s/iter; left time: 334.3838s
	iters: 300, epoch: 20 | loss: 0.0016502
	speed: 0.0111s/iter; left time: 368.9428s
	iters: 400, epoch: 20 | loss: 0.0001287
	speed: 0.0106s/iter; left time: 348.9188s
Epoch: 20 cost time: 4.661824941635132
Epoch: 20, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 21 | loss: 0.0000035
	speed: 0.0352s/iter; left time: 1159.6927s
	iters: 200, epoch: 21 | loss: 0.0005603
	speed: 0.0107s/iter; left time: 350.5951s
	iters: 300, epoch: 21 | loss: 0.0006226
	speed: 0.0098s/iter; left time: 321.0841s
	iters: 400, epoch: 21 | loss: 0.0001074
	speed: 0.0104s/iter; left time: 340.3609s
Epoch: 21 cost time: 4.620189666748047
Epoch: 21, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.280 Vali Acc: 0.958 Test Loss: 0.280 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 22 | loss: 0.0000548
	speed: 0.0357s/iter; left time: 1160.5279s
	iters: 200, epoch: 22 | loss: 0.0000012
	speed: 0.0110s/iter; left time: 355.6963s
	iters: 300, epoch: 22 | loss: 0.0009265
	speed: 0.0113s/iter; left time: 365.2476s
	iters: 400, epoch: 22 | loss: 0.0000002
	speed: 0.0113s/iter; left time: 364.9351s
Epoch: 22 cost time: 4.9583375453948975
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.263 Vali Acc: 0.960 Test Loss: 0.263 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 23 | loss: 0.0000473
	speed: 0.0434s/iter; left time: 1394.7706s
	iters: 200, epoch: 23 | loss: 0.0006248
	speed: 0.0110s/iter; left time: 352.2821s
	iters: 300, epoch: 23 | loss: 0.0000214
	speed: 0.0105s/iter; left time: 334.8811s
	iters: 400, epoch: 23 | loss: 0.0000454
	speed: 0.0113s/iter; left time: 358.8555s
Epoch: 23 cost time: 4.853308200836182
Epoch: 23, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.239 Vali Acc: 0.965 Test Loss: 0.239 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 24 | loss: 0.0002322
	speed: 0.0444s/iter; left time: 1408.3380s
	iters: 200, epoch: 24 | loss: 0.0000015
	speed: 0.0105s/iter; left time: 331.1598s
	iters: 300, epoch: 24 | loss: 0.0551054
	speed: 0.0114s/iter; left time: 360.6093s
	iters: 400, epoch: 24 | loss: 0.0022075
	speed: 0.0111s/iter; left time: 349.3246s
Epoch: 24 cost time: 4.9708757400512695
Epoch: 24, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.959 Test Loss: 0.253 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 25 | loss: 0.0000841
	speed: 0.0358s/iter; left time: 1119.1550s
	iters: 200, epoch: 25 | loss: 0.0054843
	speed: 0.0103s/iter; left time: 322.7665s
	iters: 300, epoch: 25 | loss: 0.0000000
	speed: 0.0101s/iter; left time: 315.5061s
	iters: 400, epoch: 25 | loss: 0.0000006
	speed: 0.0105s/iter; left time: 324.7028s
Epoch: 25 cost time: 4.62559962272644
Epoch: 25, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.966 Test Loss: 0.250 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9713506139154161
model parameter : 24550
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2886990
	speed: 0.0234s/iter; left time: 963.8987s
	iters: 200, epoch: 1 | loss: 0.2237307
	speed: 0.0108s/iter; left time: 443.4501s
	iters: 300, epoch: 1 | loss: 0.3508102
	speed: 0.0109s/iter; left time: 445.3228s
	iters: 400, epoch: 1 | loss: 0.3728617
	speed: 0.0107s/iter; left time: 438.6094s
Epoch: 1 cost time: 5.770142316818237
Epoch: 1, Steps: 413 | Train Loss: 0.770 Vali Loss: 0.147 Vali Acc: 0.956 Test Loss: 0.147 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0832559
	speed: 0.0433s/iter; left time: 1764.9052s
	iters: 200, epoch: 2 | loss: 0.0613299
	speed: 0.0100s/iter; left time: 405.5520s
	iters: 300, epoch: 2 | loss: 0.0207347
	speed: 0.0110s/iter; left time: 445.1110s
	iters: 400, epoch: 2 | loss: 0.1764809
	speed: 0.0102s/iter; left time: 411.4935s
Epoch: 2 cost time: 4.712006092071533
Epoch: 2, Steps: 413 | Train Loss: 0.124 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 3 | loss: 0.1153593
	speed: 0.0334s/iter; left time: 1349.8977s
	iters: 200, epoch: 3 | loss: 0.0172477
	speed: 0.0103s/iter; left time: 414.2026s
	iters: 300, epoch: 3 | loss: 0.0702222
	speed: 0.0112s/iter; left time: 451.8102s
	iters: 400, epoch: 3 | loss: 0.0401096
	speed: 0.0100s/iter; left time: 400.1771s
Epoch: 3 cost time: 4.6083738803863525
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.075 Vali Acc: 0.975 Test Loss: 0.075 Test Acc: 0.975
Validation loss decreased (-0.955888 --> -0.975443).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0163621
	speed: 0.0333s/iter; left time: 1331.9729s
	iters: 200, epoch: 4 | loss: 0.0035215
	speed: 0.0108s/iter; left time: 429.4767s
	iters: 300, epoch: 4 | loss: 0.0367818
	speed: 0.0104s/iter; left time: 415.1940s
	iters: 400, epoch: 4 | loss: 0.0088995
	speed: 0.0109s/iter; left time: 432.2423s
Epoch: 4 cost time: 4.628893613815308
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.083 Vali Acc: 0.966 Test Loss: 0.083 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0097036
	speed: 0.0331s/iter; left time: 1309.6918s
	iters: 200, epoch: 5 | loss: 0.0314432
	speed: 0.0109s/iter; left time: 431.1512s
	iters: 300, epoch: 5 | loss: 0.4448992
	speed: 0.0110s/iter; left time: 433.0420s
	iters: 400, epoch: 5 | loss: 0.0025929
	speed: 0.0104s/iter; left time: 408.9824s
Epoch: 5 cost time: 4.842829704284668
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0036070
	speed: 0.0415s/iter; left time: 1625.7947s
	iters: 200, epoch: 6 | loss: 0.0039712
	speed: 0.0106s/iter; left time: 412.0461s
	iters: 300, epoch: 6 | loss: 0.0284803
	speed: 0.0106s/iter; left time: 413.1102s
	iters: 400, epoch: 6 | loss: 0.0051574
	speed: 0.0111s/iter; left time: 430.0976s
Epoch: 6 cost time: 4.73481011390686
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0008774
	speed: 0.0424s/iter; left time: 1640.3820s
	iters: 200, epoch: 7 | loss: 0.1059374
	speed: 0.0102s/iter; left time: 394.8293s
	iters: 300, epoch: 7 | loss: 0.0090671
	speed: 0.0106s/iter; left time: 409.1985s
	iters: 400, epoch: 7 | loss: 0.0013119
	speed: 0.0110s/iter; left time: 420.9694s
Epoch: 7 cost time: 4.859659194946289
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0012080
	speed: 0.0328s/iter; left time: 1255.0784s
	iters: 200, epoch: 8 | loss: 0.0007625
	speed: 0.0110s/iter; left time: 422.1617s
	iters: 300, epoch: 8 | loss: 0.0020503
	speed: 0.0106s/iter; left time: 402.1178s
	iters: 400, epoch: 8 | loss: 0.0008644
	speed: 0.0103s/iter; left time: 392.4774s
Epoch: 8 cost time: 4.568517208099365
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.116 Vali Acc: 0.965 Test Loss: 0.116 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0028051
	speed: 0.0334s/iter; left time: 1265.5572s
	iters: 200, epoch: 9 | loss: 0.0036601
	speed: 0.0102s/iter; left time: 384.6316s
	iters: 300, epoch: 9 | loss: 0.0325213
	speed: 0.0101s/iter; left time: 379.1910s
	iters: 400, epoch: 9 | loss: 0.0028477
	speed: 0.0103s/iter; left time: 386.7264s
Epoch: 9 cost time: 4.484313011169434
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0001568
	speed: 0.0343s/iter; left time: 1285.5186s
	iters: 200, epoch: 10 | loss: 0.0000548
	speed: 0.0113s/iter; left time: 421.3202s
	iters: 300, epoch: 10 | loss: 0.0007486
	speed: 0.0110s/iter; left time: 410.7624s
	iters: 400, epoch: 10 | loss: 0.0837295
	speed: 0.0115s/iter; left time: 428.6021s
Epoch: 10 cost time: 4.869978189468384
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0040016
	speed: 0.0431s/iter; left time: 1599.2935s
	iters: 200, epoch: 11 | loss: 0.0000509
	speed: 0.0105s/iter; left time: 389.6970s
	iters: 300, epoch: 11 | loss: 0.0004046
	speed: 0.0109s/iter; left time: 401.6716s
	iters: 400, epoch: 11 | loss: 0.0000736
	speed: 0.0104s/iter; left time: 381.0166s
Epoch: 11 cost time: 4.792549133300781
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0005165
	speed: 0.0422s/iter; left time: 1547.0743s
	iters: 200, epoch: 12 | loss: 0.0001360
	speed: 0.0112s/iter; left time: 407.6986s
	iters: 300, epoch: 12 | loss: 0.0065851
	speed: 0.0114s/iter; left time: 416.1182s
	iters: 400, epoch: 12 | loss: 0.0010103
	speed: 0.0106s/iter; left time: 385.5561s
Epoch: 12 cost time: 4.9439380168914795
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0017927
	speed: 0.0340s/iter; left time: 1233.7037s
	iters: 200, epoch: 13 | loss: 0.0003257
	speed: 0.0109s/iter; left time: 392.6066s
	iters: 300, epoch: 13 | loss: 0.0008084
	speed: 0.0113s/iter; left time: 406.1000s
	iters: 400, epoch: 13 | loss: 0.0013967
	speed: 0.0102s/iter; left time: 367.2154s
Epoch: 13 cost time: 4.628951549530029
Epoch: 13, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 24334
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0813332
	speed: 0.0259s/iter; left time: 1066.2985s
	iters: 200, epoch: 1 | loss: 0.5984654
	speed: 0.0108s/iter; left time: 441.9739s
	iters: 300, epoch: 1 | loss: 0.2059272
	speed: 0.0112s/iter; left time: 457.4851s
	iters: 400, epoch: 1 | loss: 0.1877745
	speed: 0.0109s/iter; left time: 447.4391s
Epoch: 1 cost time: 6.0610387325286865
Epoch: 1, Steps: 413 | Train Loss: 0.757 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
Validation loss decreased (inf --> -0.955888).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0980329
	speed: 0.0400s/iter; left time: 1630.5692s
	iters: 200, epoch: 2 | loss: 0.2265697
	speed: 0.0106s/iter; left time: 431.0230s
	iters: 300, epoch: 2 | loss: 0.1145677
	speed: 0.0113s/iter; left time: 459.3462s
	iters: 400, epoch: 2 | loss: 0.0398213
	speed: 0.0107s/iter; left time: 433.1109s
Epoch: 2 cost time: 4.808541297912598
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.087 Vali Acc: 0.975 Test Loss: 0.087 Test Acc: 0.975
Validation loss decreased (-0.955888 --> -0.974988).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0046226
	speed: 0.0432s/iter; left time: 1745.6356s
	iters: 200, epoch: 3 | loss: 0.0131333
	speed: 0.0098s/iter; left time: 394.0296s
	iters: 300, epoch: 3 | loss: 0.0032095
	speed: 0.0103s/iter; left time: 414.2878s
	iters: 400, epoch: 3 | loss: 0.0377440
	speed: 0.0099s/iter; left time: 396.7554s
Epoch: 3 cost time: 4.42008376121521
Epoch: 3, Steps: 413 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.965 Test Loss: 0.103 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0022808
	speed: 0.0343s/iter; left time: 1370.7337s
	iters: 200, epoch: 4 | loss: 0.2719119
	speed: 0.0104s/iter; left time: 416.2970s
	iters: 300, epoch: 4 | loss: 0.0040360
	speed: 0.0099s/iter; left time: 395.0399s
	iters: 400, epoch: 4 | loss: 0.0201983
	speed: 0.0107s/iter; left time: 425.7891s
Epoch: 4 cost time: 4.5674028396606445
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.959 Test Loss: 0.107 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0071531
	speed: 0.0358s/iter; left time: 1415.1427s
	iters: 200, epoch: 5 | loss: 0.0291166
	speed: 0.0096s/iter; left time: 379.1558s
	iters: 300, epoch: 5 | loss: 0.0491038
	speed: 0.0105s/iter; left time: 414.9469s
	iters: 400, epoch: 5 | loss: 0.1941573
	speed: 0.0103s/iter; left time: 405.2403s
Epoch: 5 cost time: 4.512115001678467
Epoch: 5, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.955 Test Loss: 0.159 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0222643
	speed: 0.0342s/iter; left time: 1336.7252s
	iters: 200, epoch: 6 | loss: 0.0224983
	speed: 0.0115s/iter; left time: 448.7774s
	iters: 300, epoch: 6 | loss: 0.0121032
	speed: 0.0105s/iter; left time: 409.0929s
	iters: 400, epoch: 6 | loss: 0.3106751
	speed: 0.0104s/iter; left time: 403.4024s
Epoch: 6 cost time: 4.7881855964660645
Epoch: 6, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.952 Test Loss: 0.147 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0198354
	speed: 0.0428s/iter; left time: 1656.7129s
	iters: 200, epoch: 7 | loss: 0.0004300
	speed: 0.0098s/iter; left time: 378.9830s
	iters: 300, epoch: 7 | loss: 0.0015728
	speed: 0.0106s/iter; left time: 408.3333s
	iters: 400, epoch: 7 | loss: 0.2813890
	speed: 0.0113s/iter; left time: 432.7052s
Epoch: 7 cost time: 4.6773457527160645
Epoch: 7, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0093409
	speed: 0.0443s/iter; left time: 1698.8917s
	iters: 200, epoch: 8 | loss: 0.0628168
	speed: 0.0105s/iter; left time: 400.7636s
	iters: 300, epoch: 8 | loss: 0.0055566
	speed: 0.0110s/iter; left time: 417.9220s
	iters: 400, epoch: 8 | loss: 0.0591640
	speed: 0.0103s/iter; left time: 390.7505s
Epoch: 8 cost time: 4.8006861209869385
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.129 Vali Acc: 0.966 Test Loss: 0.129 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0001365
	speed: 0.0328s/iter; left time: 1244.0456s
	iters: 200, epoch: 9 | loss: 0.0182262
	speed: 0.0095s/iter; left time: 358.9002s
	iters: 300, epoch: 9 | loss: 0.0000134
	speed: 0.0098s/iter; left time: 367.7559s
	iters: 400, epoch: 9 | loss: 0.0129615
	speed: 0.0107s/iter; left time: 403.7938s
Epoch: 9 cost time: 4.366261720657349
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.960 Test Loss: 0.145 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0003454
	speed: 0.0346s/iter; left time: 1297.9608s
	iters: 200, epoch: 10 | loss: 0.0001125
	speed: 0.0099s/iter; left time: 371.6313s
	iters: 300, epoch: 10 | loss: 0.1561691
	speed: 0.0102s/iter; left time: 379.6848s
	iters: 400, epoch: 10 | loss: 0.1216772
	speed: 0.0100s/iter; left time: 373.0301s
Epoch: 10 cost time: 4.459479808807373
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0004756
	speed: 0.0349s/iter; left time: 1294.3268s
	iters: 200, epoch: 11 | loss: 0.0083566
	speed: 0.0102s/iter; left time: 375.9296s
	iters: 300, epoch: 11 | loss: 0.2487743
	speed: 0.0104s/iter; left time: 384.8550s
	iters: 400, epoch: 11 | loss: 0.0004614
	speed: 0.0103s/iter; left time: 380.0327s
Epoch: 11 cost time: 4.541381597518921
Epoch: 11, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0001861
	speed: 0.0444s/iter; left time: 1627.4538s
	iters: 200, epoch: 12 | loss: 0.0009921
	speed: 0.0103s/iter; left time: 376.8939s
	iters: 300, epoch: 12 | loss: 0.0000257
	speed: 0.0117s/iter; left time: 426.2270s
	iters: 400, epoch: 12 | loss: 0.0085934
	speed: 0.0116s/iter; left time: 421.1625s
Epoch: 12 cost time: 4.945355176925659
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9749886311959982
model parameter : 24619
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4019263
	speed: 0.0206s/iter; left time: 847.2429s
	iters: 200, epoch: 1 | loss: 0.5963153
	speed: 0.0100s/iter; left time: 412.2846s
	iters: 300, epoch: 1 | loss: 0.1133925
	speed: 0.0098s/iter; left time: 402.9175s
	iters: 400, epoch: 1 | loss: 0.1429444
	speed: 0.0106s/iter; left time: 432.8817s
Epoch: 1 cost time: 5.265522241592407
Epoch: 1, Steps: 413 | Train Loss: 0.795 Vali Loss: 0.152 Vali Acc: 0.950 Test Loss: 0.152 Test Acc: 0.950
Validation loss decreased (inf --> -0.949976).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0784176
	speed: 0.0336s/iter; left time: 1368.8076s
	iters: 200, epoch: 2 | loss: 0.0340748
	speed: 0.0105s/iter; left time: 427.1667s
	iters: 300, epoch: 2 | loss: 0.0430077
	speed: 0.0107s/iter; left time: 435.9605s
	iters: 400, epoch: 2 | loss: 0.0421009
	speed: 0.0111s/iter; left time: 448.6312s
Epoch: 2 cost time: 4.604896306991577
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.104 Vali Acc: 0.959 Test Loss: 0.104 Test Acc: 0.959
Validation loss decreased (-0.949976 --> -0.958617).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0696976
	speed: 0.0350s/iter; left time: 1414.0505s
	iters: 200, epoch: 3 | loss: 0.0074222
	speed: 0.0110s/iter; left time: 442.5147s
	iters: 300, epoch: 3 | loss: 0.0511797
	speed: 0.0111s/iter; left time: 446.5134s
	iters: 400, epoch: 3 | loss: 0.0437277
	speed: 0.0112s/iter; left time: 449.4069s
Epoch: 3 cost time: 4.878402233123779
Epoch: 3, Steps: 413 | Train Loss: 0.075 Vali Loss: 0.083 Vali Acc: 0.973 Test Loss: 0.083 Test Acc: 0.973
Validation loss decreased (-0.958617 --> -0.972714).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1823224
	speed: 0.0462s/iter; left time: 1848.1042s
	iters: 200, epoch: 4 | loss: 0.0016958
	speed: 0.0105s/iter; left time: 418.7070s
	iters: 300, epoch: 4 | loss: 0.0115758
	speed: 0.0108s/iter; left time: 428.4785s
	iters: 400, epoch: 4 | loss: 0.0079630
	speed: 0.0107s/iter; left time: 423.4284s
Epoch: 4 cost time: 4.743486166000366
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.071 Vali Acc: 0.978 Test Loss: 0.071 Test Acc: 0.978
Validation loss decreased (-0.972714 --> -0.977716).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0010978
	speed: 0.0429s/iter; left time: 1696.5074s
	iters: 200, epoch: 5 | loss: 0.0680580
	speed: 0.0103s/iter; left time: 404.6928s
	iters: 300, epoch: 5 | loss: 0.0031379
	speed: 0.0106s/iter; left time: 416.1057s
	iters: 400, epoch: 5 | loss: 0.0383615
	speed: 0.0102s/iter; left time: 398.5761s
Epoch: 5 cost time: 4.655414819717407
Epoch: 5, Steps: 413 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.1160399
	speed: 0.0308s/iter; left time: 1203.8092s
	iters: 200, epoch: 6 | loss: 0.0090413
	speed: 0.0107s/iter; left time: 416.9468s
	iters: 300, epoch: 6 | loss: 0.0139776
	speed: 0.0102s/iter; left time: 397.3311s
	iters: 400, epoch: 6 | loss: 0.0008308
	speed: 0.0112s/iter; left time: 434.4743s
Epoch: 6 cost time: 4.648716449737549
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.102 Vali Acc: 0.967 Test Loss: 0.102 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0006678
	speed: 0.0311s/iter; left time: 1204.5564s
	iters: 200, epoch: 7 | loss: 0.0002524
	speed: 0.0120s/iter; left time: 464.5323s
	iters: 300, epoch: 7 | loss: 0.0008772
	speed: 0.0106s/iter; left time: 409.4056s
	iters: 400, epoch: 7 | loss: 0.1365766
	speed: 0.0105s/iter; left time: 402.0335s
Epoch: 7 cost time: 4.669144153594971
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0008678
	speed: 0.0315s/iter; left time: 1208.1200s
	iters: 200, epoch: 8 | loss: 0.0231828
	speed: 0.0107s/iter; left time: 407.0356s
	iters: 300, epoch: 8 | loss: 0.0598185
	speed: 0.0108s/iter; left time: 412.1802s
	iters: 400, epoch: 8 | loss: 0.0443804
	speed: 0.0105s/iter; left time: 399.1521s
Epoch: 8 cost time: 4.662614107131958
Epoch: 8, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0016321
	speed: 0.0440s/iter; left time: 1666.2843s
	iters: 200, epoch: 9 | loss: 0.0102983
	speed: 0.0114s/iter; left time: 431.9084s
	iters: 300, epoch: 9 | loss: 0.0244794
	speed: 0.0114s/iter; left time: 431.6195s
	iters: 400, epoch: 9 | loss: 0.0017121
	speed: 0.0104s/iter; left time: 390.1214s
Epoch: 9 cost time: 4.889567136764526
Epoch: 9, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.0084221
	speed: 0.0442s/iter; left time: 1657.4476s
	iters: 200, epoch: 10 | loss: 0.0000405
	speed: 0.0112s/iter; left time: 420.0948s
	iters: 300, epoch: 10 | loss: 0.1930218
	speed: 0.0109s/iter; left time: 407.0753s
	iters: 400, epoch: 10 | loss: 0.0336283
	speed: 0.0113s/iter; left time: 418.7301s
Epoch: 10 cost time: 4.930708885192871
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0000017
	speed: 0.0349s/iter; left time: 1295.4924s
	iters: 200, epoch: 11 | loss: 0.0125361
	speed: 0.0107s/iter; left time: 394.4597s
	iters: 300, epoch: 11 | loss: 0.0541103
	speed: 0.0102s/iter; left time: 374.8581s
	iters: 400, epoch: 11 | loss: 0.0000627
	speed: 0.0104s/iter; left time: 382.6704s
Epoch: 11 cost time: 4.687772750854492
Epoch: 11, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0002424
	speed: 0.0357s/iter; left time: 1308.0584s
	iters: 200, epoch: 12 | loss: 0.0079619
	speed: 0.0098s/iter; left time: 357.3164s
	iters: 300, epoch: 12 | loss: 0.0001176
	speed: 0.0100s/iter; left time: 366.3805s
	iters: 400, epoch: 12 | loss: 0.0000018
	speed: 0.0098s/iter; left time: 357.0757s
Epoch: 12 cost time: 4.465763807296753
Epoch: 12, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1156941
	speed: 0.0356s/iter; left time: 1290.2134s
	iters: 200, epoch: 13 | loss: 0.0042845
	speed: 0.0104s/iter; left time: 374.7894s
	iters: 300, epoch: 13 | loss: 0.0305617
	speed: 0.0113s/iter; left time: 408.0329s
	iters: 400, epoch: 13 | loss: 0.1247135
	speed: 0.0104s/iter; left time: 375.0514s
Epoch: 13 cost time: 4.798173189163208
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.5950797
	speed: 0.0445s/iter; left time: 1595.2490s
	iters: 200, epoch: 14 | loss: 0.4373991
	speed: 0.0109s/iter; left time: 388.7753s
	iters: 300, epoch: 14 | loss: 0.0000086
	speed: 0.0108s/iter; left time: 386.4814s
	iters: 400, epoch: 14 | loss: 0.0000692
	speed: 0.0114s/iter; left time: 403.9048s
Epoch: 14 cost time: 4.904970169067383
Epoch: 14, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 24722
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3211629
	speed: 0.0226s/iter; left time: 929.8377s
	iters: 200, epoch: 1 | loss: 0.5447387
	speed: 0.0110s/iter; left time: 450.4804s
	iters: 300, epoch: 1 | loss: 0.2913074
	speed: 0.0108s/iter; left time: 441.5747s
	iters: 400, epoch: 1 | loss: 0.1835212
	speed: 0.0115s/iter; left time: 472.2880s
Epoch: 1 cost time: 5.773563623428345
Epoch: 1, Steps: 413 | Train Loss: 0.769 Vali Loss: 0.148 Vali Acc: 0.955 Test Loss: 0.148 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0664326
	speed: 0.0347s/iter; left time: 1415.0926s
	iters: 200, epoch: 2 | loss: 0.2115589
	speed: 0.0111s/iter; left time: 451.5147s
	iters: 300, epoch: 2 | loss: 0.0745870
	speed: 0.0106s/iter; left time: 432.2147s
	iters: 400, epoch: 2 | loss: 0.1548693
	speed: 0.0114s/iter; left time: 461.1559s
Epoch: 2 cost time: 4.864243984222412
Epoch: 2, Steps: 413 | Train Loss: 0.120 Vali Loss: 0.125 Vali Acc: 0.961 Test Loss: 0.125 Test Acc: 0.961
Validation loss decreased (-0.954978 --> -0.961345).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0459868
	speed: 0.0382s/iter; left time: 1543.9131s
	iters: 200, epoch: 3 | loss: 0.0299520
	speed: 0.0115s/iter; left time: 464.9559s
	iters: 300, epoch: 3 | loss: 0.0497209
	speed: 0.0107s/iter; left time: 430.9160s
	iters: 400, epoch: 3 | loss: 0.8360462
	speed: 0.0115s/iter; left time: 459.7727s
Epoch: 3 cost time: 5.039659261703491
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.112 Vali Acc: 0.957 Test Loss: 0.112 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0179413
	speed: 0.0407s/iter; left time: 1624.7710s
	iters: 200, epoch: 4 | loss: 0.0152722
	speed: 0.0111s/iter; left time: 441.9197s
	iters: 300, epoch: 4 | loss: 0.0146269
	speed: 0.0119s/iter; left time: 473.1415s
	iters: 400, epoch: 4 | loss: 0.0893842
	speed: 0.0112s/iter; left time: 444.7083s
Epoch: 4 cost time: 4.963865756988525
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.086 Vali Acc: 0.969 Test Loss: 0.086 Test Acc: 0.969
Validation loss decreased (-0.961345 --> -0.968621).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0204253
	speed: 0.0441s/iter; left time: 1743.0559s
	iters: 200, epoch: 5 | loss: 0.0344622
	speed: 0.0110s/iter; left time: 435.7385s
	iters: 300, epoch: 5 | loss: 0.0028643
	speed: 0.0112s/iter; left time: 441.9383s
	iters: 400, epoch: 5 | loss: 0.0112733
	speed: 0.0117s/iter; left time: 457.9373s
Epoch: 5 cost time: 4.918460369110107
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.098 Vali Acc: 0.963 Test Loss: 0.098 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0008673
	speed: 0.0344s/iter; left time: 1345.0534s
	iters: 200, epoch: 6 | loss: 0.0009776
	speed: 0.0111s/iter; left time: 432.1477s
	iters: 300, epoch: 6 | loss: 0.0000753
	speed: 0.0110s/iter; left time: 426.9440s
	iters: 400, epoch: 6 | loss: 0.0232581
	speed: 0.0112s/iter; left time: 436.2056s
Epoch: 6 cost time: 4.7783966064453125
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.968 Test Loss: 0.104 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0056933
	speed: 0.0330s/iter; left time: 1277.3864s
	iters: 200, epoch: 7 | loss: 0.0003514
	speed: 0.0112s/iter; left time: 430.9370s
	iters: 300, epoch: 7 | loss: 0.0042248
	speed: 0.0113s/iter; left time: 436.8023s
	iters: 400, epoch: 7 | loss: 0.4033672
	speed: 0.0110s/iter; left time: 423.8576s
Epoch: 7 cost time: 4.7877209186553955
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0004234
	speed: 0.0426s/iter; left time: 1631.2241s
	iters: 200, epoch: 8 | loss: 0.0265192
	speed: 0.0113s/iter; left time: 433.3117s
	iters: 300, epoch: 8 | loss: 0.0320198
	speed: 0.0117s/iter; left time: 446.0910s
	iters: 400, epoch: 8 | loss: 0.0285816
	speed: 0.0122s/iter; left time: 462.6663s
Epoch: 8 cost time: 5.187756776809692
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.096 Vali Acc: 0.969 Test Loss: 0.096 Test Acc: 0.969
Validation loss decreased (-0.968621 --> -0.969076).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0308862
	speed: 0.0438s/iter; left time: 1659.7705s
	iters: 200, epoch: 9 | loss: 0.0032558
	speed: 0.0118s/iter; left time: 446.8258s
	iters: 300, epoch: 9 | loss: 0.0002404
	speed: 0.0111s/iter; left time: 418.4696s
	iters: 400, epoch: 9 | loss: 0.0037821
	speed: 0.0116s/iter; left time: 437.3444s
Epoch: 9 cost time: 5.026746034622192
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0080577
	speed: 0.0456s/iter; left time: 1709.0138s
	iters: 200, epoch: 10 | loss: 0.0008111
	speed: 0.0107s/iter; left time: 398.7626s
	iters: 300, epoch: 10 | loss: 0.0010148
	speed: 0.0110s/iter; left time: 409.8106s
	iters: 400, epoch: 10 | loss: 0.0000403
	speed: 0.0105s/iter; left time: 390.4346s
Epoch: 10 cost time: 4.8594183921813965
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.969076 --> -0.971804).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.0005514
	speed: 0.0363s/iter; left time: 1344.8304s
	iters: 200, epoch: 11 | loss: 0.0001527
	speed: 0.0110s/iter; left time: 408.1610s
	iters: 300, epoch: 11 | loss: 0.0002867
	speed: 0.0109s/iter; left time: 403.2294s
	iters: 400, epoch: 11 | loss: 0.0271495
	speed: 0.0110s/iter; left time: 405.3348s
Epoch: 11 cost time: 4.925189018249512
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 12 | loss: 0.0004354
	speed: 0.0361s/iter; left time: 1324.7129s
	iters: 200, epoch: 12 | loss: 0.0061008
	speed: 0.0110s/iter; left time: 401.1024s
	iters: 300, epoch: 12 | loss: 0.0001840
	speed: 0.0110s/iter; left time: 400.1317s
	iters: 400, epoch: 12 | loss: 0.0059882
	speed: 0.0109s/iter; left time: 396.2469s
Epoch: 12 cost time: 4.711003541946411
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.971804 --> -0.973623).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0014184
	speed: 0.0372s/iter; left time: 1347.8434s
	iters: 200, epoch: 13 | loss: 0.0008480
	speed: 0.0113s/iter; left time: 407.3092s
	iters: 300, epoch: 13 | loss: 0.0080542
	speed: 0.0110s/iter; left time: 397.3559s
	iters: 400, epoch: 13 | loss: 0.0018150
	speed: 0.0118s/iter; left time: 425.2329s
Epoch: 13 cost time: 5.071539640426636
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0024321
	speed: 0.0437s/iter; left time: 1567.2312s
	iters: 200, epoch: 14 | loss: 0.0529766
	speed: 0.0117s/iter; left time: 419.4349s
	iters: 300, epoch: 14 | loss: 0.0011424
	speed: 0.0114s/iter; left time: 404.4787s
	iters: 400, epoch: 14 | loss: 0.0001586
	speed: 0.0109s/iter; left time: 386.1519s
Epoch: 14 cost time: 5.064676523208618
Epoch: 14, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0038087
	speed: 0.0440s/iter; left time: 1557.0760s
	iters: 200, epoch: 15 | loss: 0.0092312
	speed: 0.0109s/iter; left time: 384.9214s
	iters: 300, epoch: 15 | loss: 0.0027207
	speed: 0.0100s/iter; left time: 352.2634s
	iters: 400, epoch: 15 | loss: 0.0189860
	speed: 0.0110s/iter; left time: 386.6657s
Epoch: 15 cost time: 4.9253926277160645
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000607
	speed: 0.0360s/iter; left time: 1260.9055s
	iters: 200, epoch: 16 | loss: 0.0004857
	speed: 0.0103s/iter; left time: 357.8524s
	iters: 300, epoch: 16 | loss: 0.0249411
	speed: 0.0109s/iter; left time: 378.9480s
	iters: 400, epoch: 16 | loss: 0.0922245
	speed: 0.0110s/iter; left time: 380.3947s
Epoch: 16 cost time: 4.7000815868377686
Epoch: 16, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 17 | loss: 0.0006830
	speed: 0.0370s/iter; left time: 1279.5133s
	iters: 200, epoch: 17 | loss: 0.0048461
	speed: 0.0105s/iter; left time: 363.4803s
	iters: 300, epoch: 17 | loss: 0.0000015
	speed: 0.0114s/iter; left time: 393.3406s
	iters: 400, epoch: 17 | loss: 0.1049940
	speed: 0.0111s/iter; left time: 380.9182s
Epoch: 17 cost time: 4.854945182800293
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 18 | loss: 0.0014340
	speed: 0.0360s/iter; left time: 1229.0914s
	iters: 200, epoch: 18 | loss: 0.0000012
	speed: 0.0112s/iter; left time: 381.2024s
	iters: 300, epoch: 18 | loss: 0.0000645
	speed: 0.0110s/iter; left time: 372.3970s
	iters: 400, epoch: 18 | loss: 0.0044706
	speed: 0.0113s/iter; left time: 381.1909s
Epoch: 18 cost time: 4.8609232902526855
Epoch: 18, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 19 | loss: 0.0003199
	speed: 0.0410s/iter; left time: 1385.8810s
	iters: 200, epoch: 19 | loss: 0.0003957
	speed: 0.0106s/iter; left time: 357.5159s
	iters: 300, epoch: 19 | loss: 0.0000024
	speed: 0.0111s/iter; left time: 373.7780s
	iters: 400, epoch: 19 | loss: 0.0000057
	speed: 0.0107s/iter; left time: 358.9372s
Epoch: 19 cost time: 4.783573865890503
Epoch: 19, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.961 Test Loss: 0.249 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 20 | loss: 0.0000002
	speed: 0.0362s/iter; left time: 1208.6369s
	iters: 200, epoch: 20 | loss: 0.0000010
	speed: 0.0108s/iter; left time: 358.6257s
	iters: 300, epoch: 20 | loss: 0.0033112
	speed: 0.0108s/iter; left time: 356.4472s
	iters: 400, epoch: 20 | loss: 0.0569080
	speed: 0.0104s/iter; left time: 344.0928s
Epoch: 20 cost time: 4.76412034034729
Epoch: 20, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 21 | loss: 0.0000023
	speed: 0.0366s/iter; left time: 1207.0109s
	iters: 200, epoch: 21 | loss: 0.0000429
	speed: 0.0113s/iter; left time: 370.5748s
	iters: 300, epoch: 21 | loss: 0.0000011
	speed: 0.0104s/iter; left time: 341.9096s
	iters: 400, epoch: 21 | loss: 0.0000052
	speed: 0.0110s/iter; left time: 357.5067s
Epoch: 21 cost time: 4.7780983448028564
Epoch: 21, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
Validation loss decreased (-0.973623 --> -0.974532).  Saving model ...
	iters: 100, epoch: 22 | loss: 0.0181980
	speed: 0.0458s/iter; left time: 1488.6054s
	iters: 200, epoch: 22 | loss: 0.0561422
	speed: 0.0119s/iter; left time: 384.4701s
	iters: 300, epoch: 22 | loss: 0.0000334
	speed: 0.0113s/iter; left time: 365.5531s
	iters: 400, epoch: 22 | loss: 0.0000393
	speed: 0.0110s/iter; left time: 354.5762s
Epoch: 22 cost time: 5.153076887130737
Epoch: 22, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 23 | loss: 0.0003569
	speed: 0.0462s/iter; left time: 1484.8039s
	iters: 200, epoch: 23 | loss: 0.0010735
	speed: 0.0118s/iter; left time: 376.6744s
	iters: 300, epoch: 23 | loss: 0.0001945
	speed: 0.0116s/iter; left time: 371.5431s
	iters: 400, epoch: 23 | loss: 0.0003283
	speed: 0.0112s/iter; left time: 357.4526s
Epoch: 23 cost time: 5.1100592613220215
Epoch: 23, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.968 Test Loss: 0.189 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0372s/iter; left time: 1180.7095s
	iters: 200, epoch: 24 | loss: 0.0000003
	speed: 0.0108s/iter; left time: 342.3590s
	iters: 300, epoch: 24 | loss: 0.0026868
	speed: 0.0111s/iter; left time: 350.8499s
	iters: 400, epoch: 24 | loss: 0.0004677
	speed: 0.0103s/iter; left time: 321.8744s
Epoch: 24 cost time: 4.772361516952515
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 25 | loss: 0.0000104
	speed: 0.0359s/iter; left time: 1122.5832s
	iters: 200, epoch: 25 | loss: 0.0003135
	speed: 0.0107s/iter; left time: 333.5554s
	iters: 300, epoch: 25 | loss: 0.0002169
	speed: 0.0113s/iter; left time: 352.2962s
	iters: 400, epoch: 25 | loss: 0.1648302
	speed: 0.0110s/iter; left time: 339.4460s
Epoch: 25 cost time: 4.7961745262146
Epoch: 25, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 26 | loss: 0.0031440
	speed: 0.0331s/iter; left time: 1021.1763s
	iters: 200, epoch: 26 | loss: 0.0000049
	speed: 0.0118s/iter; left time: 361.7587s
	iters: 300, epoch: 26 | loss: 0.0000386
	speed: 0.0106s/iter; left time: 324.3932s
	iters: 400, epoch: 26 | loss: 0.0000007
	speed: 0.0119s/iter; left time: 364.2593s
Epoch: 26 cost time: 4.988651990890503
Epoch: 26, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.391 Vali Acc: 0.956 Test Loss: 0.391 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 27 | loss: 0.0001562
	speed: 0.0436s/iter; left time: 1328.6665s
	iters: 200, epoch: 27 | loss: 0.0000003
	speed: 0.0107s/iter; left time: 324.7168s
	iters: 300, epoch: 27 | loss: 0.0002965
	speed: 0.0111s/iter; left time: 334.8944s
	iters: 400, epoch: 27 | loss: 0.0000903
	speed: 0.0125s/iter; left time: 377.2081s
Epoch: 27 cost time: 5.111321926116943
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.239 Vali Acc: 0.968 Test Loss: 0.239 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 28 | loss: 0.0002538
	speed: 0.0437s/iter; left time: 1314.0813s
	iters: 200, epoch: 28 | loss: 0.0000275
	speed: 0.0116s/iter; left time: 347.3713s
	iters: 300, epoch: 28 | loss: 0.0002745
	speed: 0.0108s/iter; left time: 323.6522s
	iters: 400, epoch: 28 | loss: 0.0054355
	speed: 0.0113s/iter; left time: 336.5261s
Epoch: 28 cost time: 5.134100437164307
Epoch: 28, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 29 | loss: 0.0001053
	speed: 0.0354s/iter; left time: 1048.4664s
	iters: 200, epoch: 29 | loss: 0.0000000
	speed: 0.0104s/iter; left time: 306.0859s
	iters: 300, epoch: 29 | loss: 0.0000014
	speed: 0.0109s/iter; left time: 319.9428s
	iters: 400, epoch: 29 | loss: 0.0000214
	speed: 0.0106s/iter; left time: 310.5550s
Epoch: 29 cost time: 4.708753347396851
Epoch: 29, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.274 Vali Acc: 0.963 Test Loss: 0.274 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 30 | loss: 0.0000047
	speed: 0.0352s/iter; left time: 1027.5880s
	iters: 200, epoch: 30 | loss: 0.0000002
	speed: 0.0115s/iter; left time: 334.6389s
	iters: 300, epoch: 30 | loss: 0.0000008
	speed: 0.0108s/iter; left time: 312.8255s
	iters: 400, epoch: 30 | loss: 0.0000029
	speed: 0.0107s/iter; left time: 309.1260s
Epoch: 30 cost time: 4.865903854370117
Epoch: 30, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.959 Test Loss: 0.312 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 31 | loss: 0.0000000
	speed: 0.0385s/iter; left time: 1110.6464s
	iters: 200, epoch: 31 | loss: 0.0003207
	speed: 0.0106s/iter; left time: 303.8067s
	iters: 300, epoch: 31 | loss: 0.0000000
	speed: 0.0103s/iter; left time: 293.5398s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0110s/iter; left time: 313.3894s
Epoch: 31 cost time: 4.771513223648071
Epoch: 31, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.275 Vali Acc: 0.964 Test Loss: 0.275 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 24643
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1631027
	speed: 0.0232s/iter; left time: 956.2191s
	iters: 200, epoch: 1 | loss: 0.3570242
	speed: 0.0101s/iter; left time: 414.4056s
	iters: 300, epoch: 1 | loss: 0.1262693
	speed: 0.0104s/iter; left time: 424.8150s
	iters: 400, epoch: 1 | loss: 0.1301730
	speed: 0.0097s/iter; left time: 395.7586s
Epoch: 1 cost time: 5.512723445892334
Epoch: 1, Steps: 413 | Train Loss: 0.755 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0793115
	speed: 0.0334s/iter; left time: 1361.1712s
	iters: 200, epoch: 2 | loss: 0.1789891
	speed: 0.0104s/iter; left time: 422.8556s
	iters: 300, epoch: 2 | loss: 0.0211445
	speed: 0.0105s/iter; left time: 427.5029s
	iters: 400, epoch: 2 | loss: 0.0297317
	speed: 0.0105s/iter; left time: 423.4740s
Epoch: 2 cost time: 4.504699945449829
Epoch: 2, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.952704 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0336451
	speed: 0.0343s/iter; left time: 1384.0863s
	iters: 200, epoch: 3 | loss: 0.1837058
	speed: 0.0106s/iter; left time: 425.4003s
	iters: 300, epoch: 3 | loss: 0.0258763
	speed: 0.0113s/iter; left time: 454.6028s
	iters: 400, epoch: 3 | loss: 0.1792995
	speed: 0.0117s/iter; left time: 466.9299s
Epoch: 3 cost time: 4.819109201431274
Epoch: 3, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.108 Vali Acc: 0.958 Test Loss: 0.108 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0142200
	speed: 0.0406s/iter; left time: 1621.7988s
	iters: 200, epoch: 4 | loss: 0.0662961
	speed: 0.0106s/iter; left time: 422.6244s
	iters: 300, epoch: 4 | loss: 0.0120701
	speed: 0.0106s/iter; left time: 420.0906s
	iters: 400, epoch: 4 | loss: 0.0221775
	speed: 0.0101s/iter; left time: 400.4892s
Epoch: 4 cost time: 4.655893802642822
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.080 Vali Acc: 0.970 Test Loss: 0.080 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0089054
	speed: 0.0405s/iter; left time: 1602.6578s
	iters: 200, epoch: 5 | loss: 0.0025248
	speed: 0.0108s/iter; left time: 425.9008s
	iters: 300, epoch: 5 | loss: 0.0171771
	speed: 0.0103s/iter; left time: 404.5990s
	iters: 400, epoch: 5 | loss: 0.0067830
	speed: 0.0101s/iter; left time: 396.6933s
Epoch: 5 cost time: 4.614953279495239
Epoch: 5, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.071 Vali Acc: 0.976 Test Loss: 0.071 Test Acc: 0.976
Validation loss decreased (-0.970440 --> -0.975897).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0170474
	speed: 0.0316s/iter; left time: 1236.5988s
	iters: 200, epoch: 6 | loss: 0.0122464
	speed: 0.0110s/iter; left time: 431.0196s
	iters: 300, epoch: 6 | loss: 0.0054270
	speed: 0.0112s/iter; left time: 434.2885s
	iters: 400, epoch: 6 | loss: 0.1615919
	speed: 0.0106s/iter; left time: 410.1976s
Epoch: 6 cost time: 4.722992181777954
Epoch: 6, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.108 Vali Acc: 0.965 Test Loss: 0.108 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0064763
	speed: 0.0318s/iter; left time: 1229.9084s
	iters: 200, epoch: 7 | loss: 0.0014057
	speed: 0.0107s/iter; left time: 412.1198s
	iters: 300, epoch: 7 | loss: 0.0174668
	speed: 0.0104s/iter; left time: 401.0511s
	iters: 400, epoch: 7 | loss: 0.0104829
	speed: 0.0105s/iter; left time: 405.1279s
Epoch: 7 cost time: 4.6765456199646
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.100 Vali Acc: 0.966 Test Loss: 0.100 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.1395298
	speed: 0.0337s/iter; left time: 1289.2593s
	iters: 200, epoch: 8 | loss: 0.0004172
	speed: 0.0096s/iter; left time: 366.1129s
	iters: 300, epoch: 8 | loss: 0.0005914
	speed: 0.0101s/iter; left time: 384.6108s
	iters: 400, epoch: 8 | loss: 0.0114967
	speed: 0.0111s/iter; left time: 422.7791s
Epoch: 8 cost time: 4.488292694091797
Epoch: 8, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.105 Vali Acc: 0.965 Test Loss: 0.105 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0051033
	speed: 0.0457s/iter; left time: 1732.8382s
	iters: 200, epoch: 9 | loss: 0.0028846
	speed: 0.0119s/iter; left time: 448.5533s
	iters: 300, epoch: 9 | loss: 0.6088661
	speed: 0.0115s/iter; left time: 434.2338s
	iters: 400, epoch: 9 | loss: 0.0092293
	speed: 0.0110s/iter; left time: 411.9651s
Epoch: 9 cost time: 5.075415372848511
Epoch: 9, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0002428
	speed: 0.0420s/iter; left time: 1575.8063s
	iters: 200, epoch: 10 | loss: 0.0779459
	speed: 0.0108s/iter; left time: 403.5994s
	iters: 300, epoch: 10 | loss: 0.0024453
	speed: 0.0108s/iter; left time: 402.4101s
	iters: 400, epoch: 10 | loss: 0.0420869
	speed: 0.0109s/iter; left time: 403.9344s
Epoch: 10 cost time: 4.836695194244385
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0011751
	speed: 0.0391s/iter; left time: 1449.8669s
	iters: 200, epoch: 11 | loss: 0.0005138
	speed: 0.0098s/iter; left time: 361.6365s
	iters: 300, epoch: 11 | loss: 0.0001339
	speed: 0.0100s/iter; left time: 369.2670s
	iters: 400, epoch: 11 | loss: 0.0000863
	speed: 0.0105s/iter; left time: 385.6802s
Epoch: 11 cost time: 4.394277334213257
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0004980
	speed: 0.0309s/iter; left time: 1134.3476s
	iters: 200, epoch: 12 | loss: 0.0004783
	speed: 0.0097s/iter; left time: 353.1791s
	iters: 300, epoch: 12 | loss: 0.0000854
	speed: 0.0102s/iter; left time: 371.0733s
	iters: 400, epoch: 12 | loss: 0.0040804
	speed: 0.0104s/iter; left time: 379.3179s
Epoch: 12 cost time: 4.494275093078613
Epoch: 12, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.967 Test Loss: 0.119 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000513
	speed: 0.0331s/iter; left time: 1199.3818s
	iters: 200, epoch: 13 | loss: 0.0042961
	speed: 0.0097s/iter; left time: 350.5321s
	iters: 300, epoch: 13 | loss: 0.0000010
	speed: 0.0098s/iter; left time: 352.3688s
	iters: 400, epoch: 13 | loss: 0.0098119
	speed: 0.0106s/iter; left time: 382.0859s
Epoch: 13 cost time: 4.492467880249023
Epoch: 13, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0464260
	speed: 0.0371s/iter; left time: 1330.7767s
	iters: 200, epoch: 14 | loss: 0.0000074
	speed: 0.0107s/iter; left time: 382.8077s
	iters: 300, epoch: 14 | loss: 0.0022629
	speed: 0.0103s/iter; left time: 367.1042s
	iters: 400, epoch: 14 | loss: 0.2395485
	speed: 0.0117s/iter; left time: 414.9299s
Epoch: 14 cost time: 4.9826953411102295
Epoch: 14, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0034891
	speed: 0.0449s/iter; left time: 1591.8336s
	iters: 200, epoch: 15 | loss: 0.0039845
	speed: 0.0106s/iter; left time: 373.1056s
	iters: 300, epoch: 15 | loss: 0.0012525
	speed: 0.0107s/iter; left time: 377.8161s
	iters: 400, epoch: 15 | loss: 0.0001357
	speed: 0.0114s/iter; left time: 400.9173s
Epoch: 15 cost time: 4.854074001312256
Epoch: 15, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.175 Vali Acc: 0.966 Test Loss: 0.175 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9758981355161437
model parameter : 24382
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2203122
	speed: 0.0216s/iter; left time: 889.1903s
	iters: 200, epoch: 1 | loss: 0.4925818
	speed: 0.0103s/iter; left time: 423.5623s
	iters: 300, epoch: 1 | loss: 0.1527053
	speed: 0.0105s/iter; left time: 432.0598s
	iters: 400, epoch: 1 | loss: 0.1044624
	speed: 0.0114s/iter; left time: 465.6989s
Epoch: 1 cost time: 5.615464687347412
Epoch: 1, Steps: 413 | Train Loss: 0.752 Vali Loss: 0.143 Vali Acc: 0.951 Test Loss: 0.143 Test Acc: 0.951
Validation loss decreased (inf --> -0.951340).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3106531
	speed: 0.0326s/iter; left time: 1328.2960s
	iters: 200, epoch: 2 | loss: 0.0266511
	speed: 0.0102s/iter; left time: 415.4256s
	iters: 300, epoch: 2 | loss: 0.0115459
	speed: 0.0100s/iter; left time: 406.1776s
	iters: 400, epoch: 2 | loss: 0.0111934
	speed: 0.0098s/iter; left time: 398.7813s
Epoch: 2 cost time: 4.423600196838379
Epoch: 2, Steps: 413 | Train Loss: 0.116 Vali Loss: 0.087 Vali Acc: 0.970 Test Loss: 0.087 Test Acc: 0.970
Validation loss decreased (-0.951340 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0085403
	speed: 0.0450s/iter; left time: 1817.2969s
	iters: 200, epoch: 3 | loss: 0.0499703
	speed: 0.0108s/iter; left time: 435.3246s
	iters: 300, epoch: 3 | loss: 0.1750175
	speed: 0.0106s/iter; left time: 426.1884s
	iters: 400, epoch: 3 | loss: 0.1576556
	speed: 0.0115s/iter; left time: 461.3574s
Epoch: 3 cost time: 4.818197011947632
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.121 Vali Acc: 0.960 Test Loss: 0.121 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0030234
	speed: 0.0424s/iter; left time: 1693.7895s
	iters: 200, epoch: 4 | loss: 0.0411980
	speed: 0.0113s/iter; left time: 451.3836s
	iters: 300, epoch: 4 | loss: 0.0799552
	speed: 0.0104s/iter; left time: 413.8779s
	iters: 400, epoch: 4 | loss: 0.0022197
	speed: 0.0109s/iter; left time: 431.2582s
Epoch: 4 cost time: 4.886009931564331
Epoch: 4, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.132 Vali Acc: 0.955 Test Loss: 0.132 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0374950
	speed: 0.0446s/iter; left time: 1764.6356s
	iters: 200, epoch: 5 | loss: 0.0099972
	speed: 0.0101s/iter; left time: 396.6746s
	iters: 300, epoch: 5 | loss: 0.2257971
	speed: 0.0099s/iter; left time: 389.5319s
	iters: 400, epoch: 5 | loss: 0.0034225
	speed: 0.0104s/iter; left time: 408.3671s
Epoch: 5 cost time: 4.567257881164551
Epoch: 5, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.965 Test Loss: 0.111 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0001760
	speed: 0.0378s/iter; left time: 1481.2401s
	iters: 200, epoch: 6 | loss: 0.0029729
	speed: 0.0106s/iter; left time: 413.2493s
	iters: 300, epoch: 6 | loss: 0.0067984
	speed: 0.0105s/iter; left time: 408.6118s
	iters: 400, epoch: 6 | loss: 0.0568466
	speed: 0.0103s/iter; left time: 398.6038s
Epoch: 6 cost time: 4.533318758010864
Epoch: 6, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0049324
	speed: 0.0320s/iter; left time: 1239.5536s
	iters: 200, epoch: 7 | loss: 0.0006783
	speed: 0.0105s/iter; left time: 403.7224s
	iters: 300, epoch: 7 | loss: 0.0012136
	speed: 0.0095s/iter; left time: 365.2339s
	iters: 400, epoch: 7 | loss: 0.0001267
	speed: 0.0108s/iter; left time: 416.0153s
Epoch: 7 cost time: 4.450582981109619
Epoch: 7, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.120 Vali Acc: 0.963 Test Loss: 0.120 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0003369
	speed: 0.0347s/iter; left time: 1329.6339s
	iters: 200, epoch: 8 | loss: 0.0001146
	speed: 0.0109s/iter; left time: 415.7738s
	iters: 300, epoch: 8 | loss: 0.0132022
	speed: 0.0110s/iter; left time: 418.8783s
	iters: 400, epoch: 8 | loss: 0.0778428
	speed: 0.0111s/iter; left time: 421.9644s
Epoch: 8 cost time: 4.900745391845703
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.972 Test Loss: 0.100 Test Acc: 0.972
Validation loss decreased (-0.969985 --> -0.972259).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0014746
	speed: 0.0448s/iter; left time: 1697.6520s
	iters: 200, epoch: 9 | loss: 0.0037336
	speed: 0.0104s/iter; left time: 393.9728s
	iters: 300, epoch: 9 | loss: 0.0037593
	speed: 0.0112s/iter; left time: 423.5306s
	iters: 400, epoch: 9 | loss: 0.0021818
	speed: 0.0104s/iter; left time: 390.2544s
Epoch: 9 cost time: 4.883420467376709
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0001357
	speed: 0.0453s/iter; left time: 1699.2507s
	iters: 200, epoch: 10 | loss: 0.0000305
	speed: 0.0102s/iter; left time: 382.9317s
	iters: 300, epoch: 10 | loss: 0.0616917
	speed: 0.0117s/iter; left time: 434.7667s
	iters: 400, epoch: 10 | loss: 0.0230187
	speed: 0.0093s/iter; left time: 346.9634s
Epoch: 10 cost time: 4.704913377761841
Epoch: 10, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.0008314
	speed: 0.0338s/iter; left time: 1252.5280s
	iters: 200, epoch: 11 | loss: 0.0072504
	speed: 0.0102s/iter; left time: 378.0878s
	iters: 300, epoch: 11 | loss: 0.0003845
	speed: 0.0112s/iter; left time: 412.5155s
	iters: 400, epoch: 11 | loss: 0.0022527
	speed: 0.0106s/iter; left time: 391.3294s
Epoch: 11 cost time: 4.678797960281372
Epoch: 11, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000642
	speed: 0.0342s/iter; left time: 1253.1410s
	iters: 200, epoch: 12 | loss: 0.0498836
	speed: 0.0105s/iter; left time: 383.1854s
	iters: 300, epoch: 12 | loss: 0.0020434
	speed: 0.0104s/iter; left time: 379.6088s
	iters: 400, epoch: 12 | loss: 0.0067814
	speed: 0.0104s/iter; left time: 377.5518s
Epoch: 12 cost time: 4.513735055923462
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.961 Test Loss: 0.181 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0000022
	speed: 0.0303s/iter; left time: 1099.6683s
	iters: 200, epoch: 13 | loss: 0.0039055
	speed: 0.0102s/iter; left time: 368.6691s
	iters: 300, epoch: 13 | loss: 0.0078682
	speed: 0.0104s/iter; left time: 375.2044s
	iters: 400, epoch: 13 | loss: 0.0000014
	speed: 0.0104s/iter; left time: 372.1005s
Epoch: 13 cost time: 4.4124064445495605
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.154 Vali Acc: 0.968 Test Loss: 0.154 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0550738
	speed: 0.0407s/iter; left time: 1458.9673s
	iters: 200, epoch: 14 | loss: 0.0000399
	speed: 0.0105s/iter; left time: 376.6474s
	iters: 300, epoch: 14 | loss: 0.0000169
	speed: 0.0092s/iter; left time: 329.4845s
	iters: 400, epoch: 14 | loss: 0.0181524
	speed: 0.0099s/iter; left time: 351.9587s
Epoch: 14 cost time: 4.457612991333008
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.968 Test Loss: 0.175 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0000085
	speed: 0.0414s/iter; left time: 1466.6825s
	iters: 200, epoch: 15 | loss: 0.0003246
	speed: 0.0103s/iter; left time: 363.4521s
	iters: 300, epoch: 15 | loss: 0.0001321
	speed: 0.0105s/iter; left time: 368.9260s
	iters: 400, epoch: 15 | loss: 0.0012384
	speed: 0.0108s/iter; left time: 380.2698s
Epoch: 15 cost time: 4.651726245880127
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.968 Test Loss: 0.140 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0113117
	speed: 0.0348s/iter; left time: 1217.8286s
	iters: 200, epoch: 16 | loss: 0.0000084
	speed: 0.0098s/iter; left time: 340.4741s
	iters: 300, epoch: 16 | loss: 0.0124350
	speed: 0.0102s/iter; left time: 354.6938s
	iters: 400, epoch: 16 | loss: 0.0000163
	speed: 0.0106s/iter; left time: 369.1713s
Epoch: 16 cost time: 4.53388524055481
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.966 Test Loss: 0.168 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0516786
	speed: 0.0372s/iter; left time: 1285.3831s
	iters: 200, epoch: 17 | loss: 0.0003451
	speed: 0.0099s/iter; left time: 340.4789s
	iters: 300, epoch: 17 | loss: 0.0003445
	speed: 0.0109s/iter; left time: 373.8692s
	iters: 400, epoch: 17 | loss: 0.0462532
	speed: 0.0100s/iter; left time: 343.8999s
Epoch: 17 cost time: 4.486597299575806
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0008963
	speed: 0.0325s/iter; left time: 1109.5560s
	iters: 200, epoch: 18 | loss: 0.0000077
	speed: 0.0097s/iter; left time: 330.2152s
	iters: 300, epoch: 18 | loss: 0.0001044
	speed: 0.0095s/iter; left time: 324.0716s
	iters: 400, epoch: 18 | loss: 0.0000795
	speed: 0.0104s/iter; left time: 352.5422s
Epoch: 18 cost time: 4.338244199752808
Epoch: 18, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.972259 --> -0.975897).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0000026
	speed: 0.0409s/iter; left time: 1380.1295s
	iters: 200, epoch: 19 | loss: 0.0209387
	speed: 0.0102s/iter; left time: 344.8812s
	iters: 300, epoch: 19 | loss: 0.0032504
	speed: 0.0101s/iter; left time: 338.7652s
	iters: 400, epoch: 19 | loss: 0.0000106
	speed: 0.0099s/iter; left time: 331.4617s
Epoch: 19 cost time: 4.5510413646698
Epoch: 19, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.966 Test Loss: 0.237 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0000226
	speed: 0.0397s/iter; left time: 1322.6873s
	iters: 200, epoch: 20 | loss: 0.0000263
	speed: 0.0102s/iter; left time: 340.7071s
	iters: 300, epoch: 20 | loss: 0.0002932
	speed: 0.0107s/iter; left time: 354.7655s
	iters: 400, epoch: 20 | loss: 0.0001243
	speed: 0.0093s/iter; left time: 308.5430s
Epoch: 20 cost time: 4.517226219177246
Epoch: 20, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.967 Test Loss: 0.233 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0000140
	speed: 0.0317s/iter; left time: 1043.7928s
	iters: 200, epoch: 21 | loss: 0.2518651
	speed: 0.0096s/iter; left time: 314.2616s
	iters: 300, epoch: 21 | loss: 0.0000042
	speed: 0.0103s/iter; left time: 338.4047s
	iters: 400, epoch: 21 | loss: 0.0000532
	speed: 0.0100s/iter; left time: 326.6036s
Epoch: 21 cost time: 4.4797210693359375
Epoch: 21, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0028693
	speed: 0.0349s/iter; left time: 1134.5316s
	iters: 200, epoch: 22 | loss: 0.0022496
	speed: 0.0103s/iter; left time: 332.9725s
	iters: 300, epoch: 22 | loss: 0.0000006
	speed: 0.0101s/iter; left time: 325.4418s
	iters: 400, epoch: 22 | loss: 0.0000027
	speed: 0.0110s/iter; left time: 354.6487s
Epoch: 22 cost time: 4.6539061069488525
Epoch: 22, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 23 | loss: 0.0001466
	speed: 0.0362s/iter; left time: 1161.6411s
	iters: 200, epoch: 23 | loss: 0.0000000
	speed: 0.0100s/iter; left time: 321.3403s
	iters: 300, epoch: 23 | loss: 0.0000300
	speed: 0.0109s/iter; left time: 349.1383s
	iters: 400, epoch: 23 | loss: 0.0014909
	speed: 0.0107s/iter; left time: 341.4383s
Epoch: 23 cost time: 4.844634771347046
Epoch: 23, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.249 Vali Acc: 0.963 Test Loss: 0.249 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 24 | loss: 0.0000000
	speed: 0.0457s/iter; left time: 1449.2569s
	iters: 200, epoch: 24 | loss: 0.0000001
	speed: 0.0107s/iter; left time: 337.4552s
	iters: 300, epoch: 24 | loss: 0.6114743
	speed: 0.0107s/iter; left time: 337.6907s
	iters: 400, epoch: 24 | loss: 0.0000005
	speed: 0.0110s/iter; left time: 346.9255s
Epoch: 24 cost time: 4.965930461883545
Epoch: 24, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 25 | loss: 0.0000333
	speed: 0.0410s/iter; left time: 1282.1372s
	iters: 200, epoch: 25 | loss: 0.0000144
	speed: 0.0103s/iter; left time: 320.9095s
	iters: 300, epoch: 25 | loss: 0.0000992
	speed: 0.0101s/iter; left time: 314.3757s
	iters: 400, epoch: 25 | loss: 0.0427352
	speed: 0.0117s/iter; left time: 362.6343s
Epoch: 25 cost time: 4.752299070358276
Epoch: 25, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.972 Test Loss: 0.217 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 26 | loss: 0.0000000
	speed: 0.0324s/iter; left time: 1001.1090s
	iters: 200, epoch: 26 | loss: 0.0000526
	speed: 0.0120s/iter; left time: 370.3151s
	iters: 300, epoch: 26 | loss: 0.0000030
	speed: 0.0095s/iter; left time: 292.9085s
	iters: 400, epoch: 26 | loss: 0.0000007
	speed: 0.0118s/iter; left time: 359.9453s
Epoch: 26 cost time: 4.880665302276611
Epoch: 26, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.978 Test Loss: 0.162 Test Acc: 0.978
Validation loss decreased (-0.975897 --> -0.978170).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0004053
	speed: 0.0372s/iter; left time: 1133.1570s
	iters: 200, epoch: 27 | loss: 0.0000128
	speed: 0.0101s/iter; left time: 307.5147s
	iters: 300, epoch: 27 | loss: 0.0000000
	speed: 0.0111s/iter; left time: 334.4366s
	iters: 400, epoch: 27 | loss: 0.0000473
	speed: 0.0097s/iter; left time: 293.1623s
Epoch: 27 cost time: 4.570416450500488
Epoch: 27, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 28 | loss: 0.0000002
	speed: 0.0372s/iter; left time: 1117.9266s
	iters: 200, epoch: 28 | loss: 0.0001092
	speed: 0.0111s/iter; left time: 332.5143s
	iters: 300, epoch: 28 | loss: 0.0000000
	speed: 0.0113s/iter; left time: 336.4520s
	iters: 400, epoch: 28 | loss: 0.0000000
	speed: 0.0117s/iter; left time: 348.7013s
Epoch: 28 cost time: 4.9421892166137695
Epoch: 28, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.975 Test Loss: 0.207 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 29 | loss: 0.0000019
	speed: 0.0448s/iter; left time: 1327.5133s
	iters: 200, epoch: 29 | loss: 0.0000003
	speed: 0.0110s/iter; left time: 323.4637s
	iters: 300, epoch: 29 | loss: 0.0000602
	speed: 0.0108s/iter; left time: 317.9233s
	iters: 400, epoch: 29 | loss: 0.0000000
	speed: 0.0101s/iter; left time: 295.4409s
Epoch: 29 cost time: 4.904365301132202
Epoch: 29, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 30 | loss: 0.0000272
	speed: 0.0446s/iter; left time: 1304.6347s
	iters: 200, epoch: 30 | loss: 0.0000019
	speed: 0.0106s/iter; left time: 308.2223s
	iters: 300, epoch: 30 | loss: 0.0000356
	speed: 0.0109s/iter; left time: 317.7044s
	iters: 400, epoch: 30 | loss: 0.0000266
	speed: 0.0106s/iter; left time: 307.8801s
Epoch: 30 cost time: 4.78889012336731
Epoch: 30, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.974 Test Loss: 0.197 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 31 | loss: 0.0000014
	speed: 0.0339s/iter; left time: 976.8274s
	iters: 200, epoch: 31 | loss: 0.0000044
	speed: 0.0101s/iter; left time: 288.9870s
	iters: 300, epoch: 31 | loss: 0.0000003
	speed: 0.0098s/iter; left time: 280.9476s
	iters: 400, epoch: 31 | loss: 0.0000000
	speed: 0.0103s/iter; left time: 292.4334s
Epoch: 31 cost time: 4.505640745162964
Epoch: 31, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.975 Test Loss: 0.195 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 32 | loss: 0.0000003
	speed: 0.0351s/iter; left time: 995.8300s
	iters: 200, epoch: 32 | loss: 0.0000000
	speed: 0.0104s/iter; left time: 294.8194s
	iters: 300, epoch: 32 | loss: 0.0000041
	speed: 0.0102s/iter; left time: 287.7884s
	iters: 400, epoch: 32 | loss: 0.0000326
	speed: 0.0111s/iter; left time: 313.1559s
Epoch: 32 cost time: 4.697822570800781
Epoch: 32, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.976 Test Loss: 0.194 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 33 | loss: 0.0000000
	speed: 0.0342s/iter; left time: 957.3292s
	iters: 200, epoch: 33 | loss: 0.0000001
	speed: 0.0109s/iter; left time: 305.2725s
	iters: 300, epoch: 33 | loss: 0.0000052
	speed: 0.0103s/iter; left time: 286.3603s
	iters: 400, epoch: 33 | loss: 0.0000001
	speed: 0.0110s/iter; left time: 303.2988s
Epoch: 33 cost time: 4.720882177352905
Epoch: 33, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 34 | loss: 0.0000020
	speed: 0.0426s/iter; left time: 1175.0866s
	iters: 200, epoch: 34 | loss: 0.0000033
	speed: 0.0110s/iter; left time: 302.6146s
	iters: 300, epoch: 34 | loss: 0.0000311
	speed: 0.0106s/iter; left time: 291.4948s
	iters: 400, epoch: 34 | loss: 0.0000720
	speed: 0.0100s/iter; left time: 271.7255s
Epoch: 34 cost time: 4.753616809844971
Epoch: 34, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.976 Test Loss: 0.191 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 35 | loss: 0.0000000
	speed: 0.0444s/iter; left time: 1205.6560s
	iters: 200, epoch: 35 | loss: 0.0000215
	speed: 0.0108s/iter; left time: 293.0304s
	iters: 300, epoch: 35 | loss: 0.0000013
	speed: 0.0102s/iter; left time: 275.1808s
	iters: 400, epoch: 35 | loss: 0.0000001
	speed: 0.0104s/iter; left time: 279.1445s
Epoch: 35 cost time: 4.738595247268677
Epoch: 35, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.975 Test Loss: 0.191 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 36 | loss: 0.0000000
	speed: 0.0343s/iter; left time: 918.2871s
	iters: 200, epoch: 36 | loss: 0.0000032
	speed: 0.0106s/iter; left time: 283.5169s
	iters: 300, epoch: 36 | loss: 0.0000013
	speed: 0.0111s/iter; left time: 295.4942s
	iters: 400, epoch: 36 | loss: 0.0000001
	speed: 0.0102s/iter; left time: 270.9093s
Epoch: 36 cost time: 4.7501912117004395
Epoch: 36, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9781718963165075
model parameter : 24648
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0927593
	speed: 0.0215s/iter; left time: 884.6295s
	iters: 200, epoch: 1 | loss: 0.4225902
	speed: 0.0116s/iter; left time: 476.3028s
	iters: 300, epoch: 1 | loss: 0.2076850
	speed: 0.0105s/iter; left time: 431.1900s
	iters: 400, epoch: 1 | loss: 0.2377765
	speed: 0.0106s/iter; left time: 431.6497s
Epoch: 1 cost time: 5.5894935131073
Epoch: 1, Steps: 413 | Train Loss: 0.739 Vali Loss: 0.162 Vali Acc: 0.946 Test Loss: 0.162 Test Acc: 0.946
Validation loss decreased (inf --> -0.946338).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0993873
	speed: 0.0370s/iter; left time: 1509.7649s
	iters: 200, epoch: 2 | loss: 0.0491419
	speed: 0.0107s/iter; left time: 436.4790s
	iters: 300, epoch: 2 | loss: 0.0921651
	speed: 0.0107s/iter; left time: 434.6538s
	iters: 400, epoch: 2 | loss: 0.1190097
	speed: 0.0102s/iter; left time: 414.8912s
Epoch: 2 cost time: 4.656468868255615
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.121 Vali Acc: 0.958 Test Loss: 0.121 Test Acc: 0.958
Validation loss decreased (-0.946338 --> -0.958162).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0339996
	speed: 0.0365s/iter; left time: 1473.8361s
	iters: 200, epoch: 3 | loss: 0.0275975
	speed: 0.0102s/iter; left time: 410.2607s
	iters: 300, epoch: 3 | loss: 0.4279571
	speed: 0.0107s/iter; left time: 428.4392s
	iters: 400, epoch: 3 | loss: 0.0338559
	speed: 0.0103s/iter; left time: 411.8397s
Epoch: 3 cost time: 4.55927586555481
Epoch: 3, Steps: 413 | Train Loss: 0.080 Vali Loss: 0.106 Vali Acc: 0.965 Test Loss: 0.106 Test Acc: 0.965
Validation loss decreased (-0.958162 --> -0.965438).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0057625
	speed: 0.0362s/iter; left time: 1447.6457s
	iters: 200, epoch: 4 | loss: 0.0093649
	speed: 0.0116s/iter; left time: 461.2727s
	iters: 300, epoch: 4 | loss: 0.0242879
	speed: 0.0114s/iter; left time: 452.7889s
	iters: 400, epoch: 4 | loss: 0.0451525
	speed: 0.0105s/iter; left time: 416.5978s
Epoch: 4 cost time: 4.9038238525390625
Epoch: 4, Steps: 413 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0080791
	speed: 0.0426s/iter; left time: 1686.3466s
	iters: 200, epoch: 5 | loss: 0.0044261
	speed: 0.0104s/iter; left time: 409.8700s
	iters: 300, epoch: 5 | loss: 0.1338240
	speed: 0.0110s/iter; left time: 432.7439s
	iters: 400, epoch: 5 | loss: 0.0059423
	speed: 0.0113s/iter; left time: 442.7333s
Epoch: 5 cost time: 4.795008420944214
Epoch: 5, Steps: 413 | Train Loss: 0.044 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0040804
	speed: 0.0458s/iter; left time: 1792.8523s
	iters: 200, epoch: 6 | loss: 0.0431562
	speed: 0.0109s/iter; left time: 425.7003s
	iters: 300, epoch: 6 | loss: 0.0061086
	speed: 0.0100s/iter; left time: 389.0318s
	iters: 400, epoch: 6 | loss: 0.8688518
	speed: 0.0096s/iter; left time: 374.5951s
Epoch: 6 cost time: 4.661652088165283
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.098 Vali Acc: 0.967 Test Loss: 0.098 Test Acc: 0.967
Validation loss decreased (-0.965438 --> -0.967257).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5122946
	speed: 0.0325s/iter; left time: 1260.2331s
	iters: 200, epoch: 7 | loss: 0.0049573
	speed: 0.0100s/iter; left time: 386.7623s
	iters: 300, epoch: 7 | loss: 0.0013219
	speed: 0.0105s/iter; left time: 404.5439s
	iters: 400, epoch: 7 | loss: 0.0020450
	speed: 0.0104s/iter; left time: 399.8004s
Epoch: 7 cost time: 4.519974946975708
Epoch: 7, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.085 Vali Acc: 0.976 Test Loss: 0.085 Test Acc: 0.976
Validation loss decreased (-0.967257 --> -0.976352).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0009773
	speed: 0.0325s/iter; left time: 1246.3134s
	iters: 200, epoch: 8 | loss: 0.0350357
	speed: 0.0102s/iter; left time: 390.7371s
	iters: 300, epoch: 8 | loss: 0.0110681
	speed: 0.0102s/iter; left time: 389.9551s
	iters: 400, epoch: 8 | loss: 0.0037937
	speed: 0.0104s/iter; left time: 395.7353s
Epoch: 8 cost time: 4.471742391586304
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.168 Vali Acc: 0.957 Test Loss: 0.168 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0000138
	speed: 0.0370s/iter; left time: 1403.5684s
	iters: 200, epoch: 9 | loss: 0.0094343
	speed: 0.0107s/iter; left time: 403.6961s
	iters: 300, epoch: 9 | loss: 0.0218323
	speed: 0.0111s/iter; left time: 419.1910s
	iters: 400, epoch: 9 | loss: 0.0027312
	speed: 0.0117s/iter; left time: 440.8362s
Epoch: 9 cost time: 4.85107684135437
Epoch: 9, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.1047761
	speed: 0.0459s/iter; left time: 1721.4288s
	iters: 200, epoch: 10 | loss: 0.0019757
	speed: 0.0114s/iter; left time: 427.1657s
	iters: 300, epoch: 10 | loss: 0.0002122
	speed: 0.0110s/iter; left time: 411.4091s
	iters: 400, epoch: 10 | loss: 0.0049503
	speed: 0.0119s/iter; left time: 441.9149s
Epoch: 10 cost time: 5.131930828094482
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0031856
	speed: 0.0453s/iter; left time: 1680.2229s
	iters: 200, epoch: 11 | loss: 0.0001739
	speed: 0.0116s/iter; left time: 429.3759s
	iters: 300, epoch: 11 | loss: 0.0007251
	speed: 0.0115s/iter; left time: 422.4084s
	iters: 400, epoch: 11 | loss: 0.0003526
	speed: 0.0102s/iter; left time: 376.6696s
Epoch: 11 cost time: 4.915857315063477
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0002731
	speed: 0.0356s/iter; left time: 1303.6075s
	iters: 200, epoch: 12 | loss: 0.0001010
	speed: 0.0097s/iter; left time: 353.5552s
	iters: 300, epoch: 12 | loss: 0.0000574
	speed: 0.0111s/iter; left time: 404.6168s
	iters: 400, epoch: 12 | loss: 0.0075992
	speed: 0.0110s/iter; left time: 399.2139s
Epoch: 12 cost time: 4.643970966339111
Epoch: 12, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0000026
	speed: 0.0350s/iter; left time: 1268.7458s
	iters: 200, epoch: 13 | loss: 0.0010025
	speed: 0.0107s/iter; left time: 385.9835s
	iters: 300, epoch: 13 | loss: 0.0048830
	speed: 0.0106s/iter; left time: 380.6590s
	iters: 400, epoch: 13 | loss: 0.0000879
	speed: 0.0108s/iter; left time: 387.1526s
Epoch: 13 cost time: 4.702441453933716
Epoch: 13, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0081875
	speed: 0.0354s/iter; left time: 1269.8340s
	iters: 200, epoch: 14 | loss: 0.0003008
	speed: 0.0103s/iter; left time: 369.4059s
	iters: 300, epoch: 14 | loss: 0.0000442
	speed: 0.0112s/iter; left time: 399.9714s
	iters: 400, epoch: 14 | loss: 0.0000176
	speed: 0.0111s/iter; left time: 396.1010s
Epoch: 14 cost time: 4.787812948226929
Epoch: 14, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.964 Test Loss: 0.178 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0824970
	speed: 0.0438s/iter; left time: 1551.2297s
	iters: 200, epoch: 15 | loss: 0.0000004
	speed: 0.0109s/iter; left time: 386.6410s
	iters: 300, epoch: 15 | loss: 0.0025800
	speed: 0.0103s/iter; left time: 362.4752s
	iters: 400, epoch: 15 | loss: 0.0002512
	speed: 0.0101s/iter; left time: 354.2454s
Epoch: 15 cost time: 4.717851638793945
Epoch: 15, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0016298
	speed: 0.0455s/iter; left time: 1593.2879s
	iters: 200, epoch: 16 | loss: 0.0001136
	speed: 0.0108s/iter; left time: 377.8460s
	iters: 300, epoch: 16 | loss: 0.0610849
	speed: 0.0109s/iter; left time: 381.0692s
	iters: 400, epoch: 16 | loss: 0.0000513
	speed: 0.0101s/iter; left time: 349.7494s
Epoch: 16 cost time: 4.7428810596466064
Epoch: 16, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.964 Test Loss: 0.165 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0002649
	speed: 0.0342s/iter; left time: 1184.7174s
	iters: 200, epoch: 17 | loss: 0.0001958
	speed: 0.0100s/iter; left time: 344.4619s
	iters: 300, epoch: 17 | loss: 0.0041315
	speed: 0.0106s/iter; left time: 366.2650s
	iters: 400, epoch: 17 | loss: 0.0000166
	speed: 0.0112s/iter; left time: 382.6216s
Epoch: 17 cost time: 4.729589939117432
Epoch: 17, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 24558
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2852616
	speed: 0.0250s/iter; left time: 1028.2748s
	iters: 200, epoch: 1 | loss: 0.3895194
	speed: 0.0106s/iter; left time: 437.1234s
	iters: 300, epoch: 1 | loss: 0.1284346
	speed: 0.0107s/iter; left time: 440.2970s
	iters: 400, epoch: 1 | loss: 0.0664348
	speed: 0.0107s/iter; left time: 437.9779s
Epoch: 1 cost time: 5.894129753112793
Epoch: 1, Steps: 413 | Train Loss: 0.764 Vali Loss: 0.155 Vali Acc: 0.953 Test Loss: 0.155 Test Acc: 0.953
Validation loss decreased (inf --> -0.952704).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0297396
	speed: 0.0448s/iter; left time: 1825.6353s
	iters: 200, epoch: 2 | loss: 0.0097942
	speed: 0.0112s/iter; left time: 455.7550s
	iters: 300, epoch: 2 | loss: 0.1545512
	speed: 0.0110s/iter; left time: 445.3136s
	iters: 400, epoch: 2 | loss: 0.2116490
	speed: 0.0095s/iter; left time: 385.2589s
Epoch: 2 cost time: 4.8326661586761475
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.114 Vali Acc: 0.962 Test Loss: 0.114 Test Acc: 0.962
Validation loss decreased (-0.952704 --> -0.961800).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0416673
	speed: 0.0324s/iter; left time: 1306.4581s
	iters: 200, epoch: 3 | loss: 0.0114207
	speed: 0.0102s/iter; left time: 410.5287s
	iters: 300, epoch: 3 | loss: 0.0132909
	speed: 0.0109s/iter; left time: 436.3464s
	iters: 400, epoch: 3 | loss: 0.1453631
	speed: 0.0112s/iter; left time: 450.2362s
Epoch: 3 cost time: 4.701451778411865
Epoch: 3, Steps: 413 | Train Loss: 0.068 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.961800 --> -0.968166).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0051560
	speed: 0.0345s/iter; left time: 1378.5279s
	iters: 200, epoch: 4 | loss: 0.3284322
	speed: 0.0107s/iter; left time: 427.9230s
	iters: 300, epoch: 4 | loss: 0.0307430
	speed: 0.0095s/iter; left time: 377.8523s
	iters: 400, epoch: 4 | loss: 0.0265738
	speed: 0.0099s/iter; left time: 393.1577s
Epoch: 4 cost time: 4.464046239852905
Epoch: 4, Steps: 413 | Train Loss: 0.048 Vali Loss: 0.109 Vali Acc: 0.964 Test Loss: 0.109 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0845223
	speed: 0.0344s/iter; left time: 1361.7320s
	iters: 200, epoch: 5 | loss: 0.0012006
	speed: 0.0103s/iter; left time: 405.2665s
	iters: 300, epoch: 5 | loss: 0.0773577
	speed: 0.0101s/iter; left time: 397.0661s
	iters: 400, epoch: 5 | loss: 0.0058015
	speed: 0.0104s/iter; left time: 409.7071s
Epoch: 5 cost time: 4.537694692611694
Epoch: 5, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0012757
	speed: 0.0459s/iter; left time: 1796.4797s
	iters: 200, epoch: 6 | loss: 0.0007846
	speed: 0.0107s/iter; left time: 417.3135s
	iters: 300, epoch: 6 | loss: 0.0673337
	speed: 0.0110s/iter; left time: 428.9258s
	iters: 400, epoch: 6 | loss: 0.0026164
	speed: 0.0104s/iter; left time: 404.0140s
Epoch: 6 cost time: 4.756672382354736
Epoch: 6, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.103 Vali Acc: 0.968 Test Loss: 0.103 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0003674
	speed: 0.0438s/iter; left time: 1694.3150s
	iters: 200, epoch: 7 | loss: 0.0169497
	speed: 0.0110s/iter; left time: 425.8999s
	iters: 300, epoch: 7 | loss: 0.0050266
	speed: 0.0108s/iter; left time: 417.5134s
	iters: 400, epoch: 7 | loss: 0.0394698
	speed: 0.0105s/iter; left time: 404.2722s
Epoch: 7 cost time: 4.793177366256714
Epoch: 7, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0013348
	speed: 0.0348s/iter; left time: 1331.7017s
	iters: 200, epoch: 8 | loss: 0.0176928
	speed: 0.0099s/iter; left time: 376.7535s
	iters: 300, epoch: 8 | loss: 0.0001615
	speed: 0.0102s/iter; left time: 387.0257s
	iters: 400, epoch: 8 | loss: 0.0230799
	speed: 0.0107s/iter; left time: 406.0190s
Epoch: 8 cost time: 4.524369955062866
Epoch: 8, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0046193
	speed: 0.0353s/iter; left time: 1338.1902s
	iters: 200, epoch: 9 | loss: 0.0000848
	speed: 0.0105s/iter; left time: 395.4894s
	iters: 300, epoch: 9 | loss: 0.0000009
	speed: 0.0105s/iter; left time: 394.7188s
	iters: 400, epoch: 9 | loss: 0.0000977
	speed: 0.0095s/iter; left time: 356.3344s
Epoch: 9 cost time: 4.389028787612915
Epoch: 9, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.111 Vali Acc: 0.966 Test Loss: 0.111 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0044778
	speed: 0.0327s/iter; left time: 1225.4456s
	iters: 200, epoch: 10 | loss: 0.0052768
	speed: 0.0096s/iter; left time: 357.9385s
	iters: 300, epoch: 10 | loss: 0.0008644
	speed: 0.0099s/iter; left time: 369.7666s
	iters: 400, epoch: 10 | loss: 0.1745429
	speed: 0.0110s/iter; left time: 409.0699s
Epoch: 10 cost time: 4.466309309005737
Epoch: 10, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.2930489
	speed: 0.0438s/iter; left time: 1623.5170s
	iters: 200, epoch: 11 | loss: 0.0028746
	speed: 0.0112s/iter; left time: 412.4441s
	iters: 300, epoch: 11 | loss: 0.0001523
	speed: 0.0108s/iter; left time: 399.3104s
	iters: 400, epoch: 11 | loss: 0.0000415
	speed: 0.0111s/iter; left time: 407.9962s
Epoch: 11 cost time: 4.895434379577637
Epoch: 11, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.961 Test Loss: 0.173 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0000306
	speed: 0.0435s/iter; left time: 1594.3303s
	iters: 200, epoch: 12 | loss: 0.0004702
	speed: 0.0111s/iter; left time: 406.8451s
	iters: 300, epoch: 12 | loss: 0.0013834
	speed: 0.0109s/iter; left time: 397.1353s
	iters: 400, epoch: 12 | loss: 0.0000204
	speed: 0.0112s/iter; left time: 405.4569s
Epoch: 12 cost time: 4.877029895782471
Epoch: 12, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0000473
	speed: 0.0452s/iter; left time: 1637.0672s
	iters: 200, epoch: 13 | loss: 0.0000068
	speed: 0.0107s/iter; left time: 387.4705s
	iters: 300, epoch: 13 | loss: 0.0001114
	speed: 0.0104s/iter; left time: 373.3309s
	iters: 400, epoch: 13 | loss: 0.0043447
	speed: 0.0103s/iter; left time: 372.0077s
Epoch: 13 cost time: 4.825337648391724
Epoch: 13, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9681673487949067
model parameter : 24655
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs47_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2669302
	speed: 0.0218s/iter; left time: 896.4678s
	iters: 200, epoch: 1 | loss: 0.4219546
	speed: 0.0109s/iter; left time: 447.0030s
	iters: 300, epoch: 1 | loss: 0.1516385
	speed: 0.0108s/iter; left time: 442.5380s
	iters: 400, epoch: 1 | loss: 0.0763271
	speed: 0.0111s/iter; left time: 453.0789s
Epoch: 1 cost time: 5.633371829986572
Epoch: 1, Steps: 413 | Train Loss: 0.767 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0638745
	speed: 0.0408s/iter; left time: 1664.0609s
	iters: 200, epoch: 2 | loss: 0.0990528
	speed: 0.0115s/iter; left time: 467.8772s
	iters: 300, epoch: 2 | loss: 0.0283596
	speed: 0.0119s/iter; left time: 482.5951s
	iters: 400, epoch: 2 | loss: 0.0659476
	speed: 0.0114s/iter; left time: 461.8568s
Epoch: 2 cost time: 4.974895238876343
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.116 Vali Acc: 0.966 Test Loss: 0.116 Test Acc: 0.966
Validation loss decreased (-0.959071 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0154024
	speed: 0.0464s/iter; left time: 1871.8957s
	iters: 200, epoch: 3 | loss: 0.0116757
	speed: 0.0107s/iter; left time: 430.3986s
	iters: 300, epoch: 3 | loss: 0.0083529
	speed: 0.0103s/iter; left time: 413.7707s
	iters: 400, epoch: 3 | loss: 0.0164299
	speed: 0.0107s/iter; left time: 427.5987s
Epoch: 3 cost time: 4.828038692474365
Epoch: 3, Steps: 413 | Train Loss: 0.078 Vali Loss: 0.094 Vali Acc: 0.970 Test Loss: 0.094 Test Acc: 0.970
Validation loss decreased (-0.966347 --> -0.970440).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0041133
	speed: 0.0348s/iter; left time: 1390.3345s
	iters: 200, epoch: 4 | loss: 0.0024220
	speed: 0.0106s/iter; left time: 422.2104s
	iters: 300, epoch: 4 | loss: 0.0549609
	speed: 0.0106s/iter; left time: 420.6320s
	iters: 400, epoch: 4 | loss: 0.0195638
	speed: 0.0107s/iter; left time: 426.0856s
Epoch: 4 cost time: 4.696375370025635
Epoch: 4, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.112 Vali Acc: 0.965 Test Loss: 0.112 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0171661
	speed: 0.0374s/iter; left time: 1479.0216s
	iters: 200, epoch: 5 | loss: 0.0068592
	speed: 0.0103s/iter; left time: 405.4146s
	iters: 300, epoch: 5 | loss: 0.0062006
	speed: 0.0107s/iter; left time: 422.4428s
	iters: 400, epoch: 5 | loss: 0.0096303
	speed: 0.0105s/iter; left time: 413.5351s
Epoch: 5 cost time: 4.641880512237549
Epoch: 5, Steps: 413 | Train Loss: 0.046 Vali Loss: 0.111 Vali Acc: 0.964 Test Loss: 0.111 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0068031
	speed: 0.0366s/iter; left time: 1431.1312s
	iters: 200, epoch: 6 | loss: 0.0194775
	speed: 0.0113s/iter; left time: 440.4929s
	iters: 300, epoch: 6 | loss: 0.0008921
	speed: 0.0112s/iter; left time: 434.5074s
	iters: 400, epoch: 6 | loss: 0.0411152
	speed: 0.0109s/iter; left time: 423.4913s
Epoch: 6 cost time: 4.95813512802124
Epoch: 6, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.965 Test Loss: 0.110 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 7 | loss: 0.0024111
	speed: 0.0443s/iter; left time: 1715.8374s
	iters: 200, epoch: 7 | loss: 0.0048214
	speed: 0.0113s/iter; left time: 436.4900s
	iters: 300, epoch: 7 | loss: 0.0030487
	speed: 0.0113s/iter; left time: 435.1139s
	iters: 400, epoch: 7 | loss: 0.0113969
	speed: 0.0114s/iter; left time: 439.7241s
Epoch: 7 cost time: 5.094408750534058
Epoch: 7, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 8 | loss: 0.0016520
	speed: 0.0449s/iter; left time: 1721.9059s
	iters: 200, epoch: 8 | loss: 0.0466503
	speed: 0.0101s/iter; left time: 386.7885s
	iters: 300, epoch: 8 | loss: 0.0005446
	speed: 0.0106s/iter; left time: 403.6099s
	iters: 400, epoch: 8 | loss: 0.0000198
	speed: 0.0107s/iter; left time: 407.9776s
Epoch: 8 cost time: 4.792927503585815
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 9 | loss: 0.0009272
	speed: 0.0336s/iter; left time: 1272.6733s
	iters: 200, epoch: 9 | loss: 0.0019718
	speed: 0.0106s/iter; left time: 401.1405s
	iters: 300, epoch: 9 | loss: 0.0017705
	speed: 0.0102s/iter; left time: 384.9883s
	iters: 400, epoch: 9 | loss: 0.0503416
	speed: 0.0103s/iter; left time: 386.4869s
Epoch: 9 cost time: 4.578056812286377
Epoch: 9, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 10 | loss: 0.0075563
	speed: 0.0360s/iter; left time: 1350.3751s
	iters: 200, epoch: 10 | loss: 0.0105705
	speed: 0.0102s/iter; left time: 380.0211s
	iters: 300, epoch: 10 | loss: 0.0343354
	speed: 0.0103s/iter; left time: 385.3547s
	iters: 400, epoch: 10 | loss: 0.0014582
	speed: 0.0112s/iter; left time: 418.3170s
Epoch: 10 cost time: 4.684709787368774
Epoch: 10, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.963 Test Loss: 0.145 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 11 | loss: 0.0002964
	speed: 0.0364s/iter; left time: 1348.6355s
	iters: 200, epoch: 11 | loss: 0.0004767
	speed: 0.0125s/iter; left time: 463.0617s
	iters: 300, epoch: 11 | loss: 0.0008771
	speed: 0.0118s/iter; left time: 433.9858s
	iters: 400, epoch: 11 | loss: 0.0034467
	speed: 0.0109s/iter; left time: 401.7681s
Epoch: 11 cost time: 5.1366376876831055
Epoch: 11, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.953 Test Loss: 0.218 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 12 | loss: 0.0085970
	speed: 0.0487s/iter; left time: 1783.8700s
	iters: 200, epoch: 12 | loss: 0.0228166
	speed: 0.0114s/iter; left time: 415.6579s
	iters: 300, epoch: 12 | loss: 0.0252163
	speed: 0.0137s/iter; left time: 499.9261s
	iters: 400, epoch: 12 | loss: 0.0012258
	speed: 0.0124s/iter; left time: 450.5419s
Epoch: 12 cost time: 5.407705068588257
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 13 | loss: 0.0003738
	speed: 0.0457s/iter; left time: 1655.5226s
	iters: 200, epoch: 13 | loss: 0.0572299
	speed: 0.0123s/iter; left time: 443.4701s
	iters: 300, epoch: 13 | loss: 0.0000750
	speed: 0.0118s/iter; left time: 424.2160s
	iters: 400, epoch: 13 | loss: 0.0000613
	speed: 0.0109s/iter; left time: 391.8990s
Epoch: 13 cost time: 5.140302896499634
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs47_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9704411095952705
model parameter : 22792
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2371728
	speed: 0.0229s/iter; left time: 944.7188s
	iters: 200, epoch: 1 | loss: 0.4116192
	speed: 0.0113s/iter; left time: 462.8505s
	iters: 300, epoch: 1 | loss: 0.0871731
	speed: 0.0119s/iter; left time: 489.4914s
	iters: 400, epoch: 1 | loss: 0.1689237
	speed: 0.0128s/iter; left time: 524.9866s
Epoch: 1 cost time: 6.075846433639526
Epoch: 1, Steps: 413 | Train Loss: 0.784 Vali Loss: 0.156 Vali Acc: 0.960 Test Loss: 0.156 Test Acc: 0.960
Validation loss decreased (inf --> -0.959525).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6863434
	speed: 0.0514s/iter; left time: 2096.4656s
	iters: 200, epoch: 2 | loss: 0.0375500
	speed: 0.0120s/iter; left time: 487.5483s
	iters: 300, epoch: 2 | loss: 0.1132040
	speed: 0.0106s/iter; left time: 429.5094s
	iters: 400, epoch: 2 | loss: 0.0347366
	speed: 0.0113s/iter; left time: 459.5381s
Epoch: 2 cost time: 5.16620659828186
Epoch: 2, Steps: 413 | Train Loss: 0.123 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.959525 --> -0.977716).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0224862
	speed: 0.0485s/iter; left time: 1957.7793s
	iters: 200, epoch: 3 | loss: 0.0133172
	speed: 0.0121s/iter; left time: 486.5642s
	iters: 300, epoch: 3 | loss: 0.0780528
	speed: 0.0117s/iter; left time: 468.9868s
	iters: 400, epoch: 3 | loss: 0.0519089
	speed: 0.0112s/iter; left time: 449.4441s
Epoch: 3 cost time: 5.216836214065552
Epoch: 3, Steps: 413 | Train Loss: 0.076 Vali Loss: 0.089 Vali Acc: 0.975 Test Loss: 0.089 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0951347
	speed: 0.0415s/iter; left time: 1657.8736s
	iters: 200, epoch: 4 | loss: 0.0074054
	speed: 0.0101s/iter; left time: 403.0431s
	iters: 300, epoch: 4 | loss: 0.0201372
	speed: 0.0102s/iter; left time: 407.4627s
	iters: 400, epoch: 4 | loss: 0.0056095
	speed: 0.0103s/iter; left time: 407.9485s
Epoch: 4 cost time: 4.540771245956421
Epoch: 4, Steps: 413 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0176124
	speed: 0.0319s/iter; left time: 1261.7282s
	iters: 200, epoch: 5 | loss: 0.0096285
	speed: 0.0106s/iter; left time: 419.1473s
	iters: 300, epoch: 5 | loss: 0.2188628
	speed: 0.0109s/iter; left time: 427.8872s
	iters: 400, epoch: 5 | loss: 0.0468889
	speed: 0.0101s/iter; left time: 394.7885s
Epoch: 5 cost time: 4.567498445510864
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.104 Vali Acc: 0.967 Test Loss: 0.104 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0166495
	speed: 0.0321s/iter; left time: 1254.3655s
	iters: 200, epoch: 6 | loss: 0.0591974
	speed: 0.0111s/iter; left time: 432.3894s
	iters: 300, epoch: 6 | loss: 0.0018394
	speed: 0.0113s/iter; left time: 441.2043s
	iters: 400, epoch: 6 | loss: 0.0371786
	speed: 0.0110s/iter; left time: 425.2683s
Epoch: 6 cost time: 4.823267698287964
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.955 Test Loss: 0.171 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0422311
	speed: 0.0414s/iter; left time: 1602.1443s
	iters: 200, epoch: 7 | loss: 0.0006740
	speed: 0.0109s/iter; left time: 419.0915s
	iters: 300, epoch: 7 | loss: 0.0021297
	speed: 0.0110s/iter; left time: 422.2320s
	iters: 400, epoch: 7 | loss: 0.0743424
	speed: 0.0106s/iter; left time: 405.9778s
Epoch: 7 cost time: 4.859024524688721
Epoch: 7, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0010142
	speed: 0.0449s/iter; left time: 1718.4549s
	iters: 200, epoch: 8 | loss: 0.0021466
	speed: 0.0115s/iter; left time: 439.1059s
	iters: 300, epoch: 8 | loss: 0.0038962
	speed: 0.0111s/iter; left time: 423.1804s
	iters: 400, epoch: 8 | loss: 0.0009535
	speed: 0.0108s/iter; left time: 411.3424s
Epoch: 8 cost time: 5.02493691444397
Epoch: 8, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.966 Test Loss: 0.128 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0027785
	speed: 0.0383s/iter; left time: 1452.8923s
	iters: 200, epoch: 9 | loss: 0.0014880
	speed: 0.0109s/iter; left time: 411.5560s
	iters: 300, epoch: 9 | loss: 0.0050287
	speed: 0.0105s/iter; left time: 394.3796s
	iters: 400, epoch: 9 | loss: 0.0020903
	speed: 0.0106s/iter; left time: 398.4678s
Epoch: 9 cost time: 4.708733320236206
Epoch: 9, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002112
	speed: 0.0383s/iter; left time: 1434.3924s
	iters: 200, epoch: 10 | loss: 0.1154673
	speed: 0.0110s/iter; left time: 412.0804s
	iters: 300, epoch: 10 | loss: 0.0003551
	speed: 0.0115s/iter; left time: 427.5879s
	iters: 400, epoch: 10 | loss: 0.0001235
	speed: 0.0116s/iter; left time: 430.5274s
Epoch: 10 cost time: 4.893616676330566
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0014240
	speed: 0.0361s/iter; left time: 1336.4951s
	iters: 200, epoch: 11 | loss: 0.0011416
	speed: 0.0097s/iter; left time: 357.4820s
	iters: 300, epoch: 11 | loss: 0.0057277
	speed: 0.0118s/iter; left time: 435.8521s
	iters: 400, epoch: 11 | loss: 0.0563149
	speed: 0.0118s/iter; left time: 432.3987s
Epoch: 11 cost time: 4.789653778076172
Epoch: 11, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0068532
	speed: 0.0457s/iter; left time: 1677.0006s
	iters: 200, epoch: 12 | loss: 0.0012043
	speed: 0.0106s/iter; left time: 387.7981s
	iters: 300, epoch: 12 | loss: 0.0882657
	speed: 0.0101s/iter; left time: 368.8207s
	iters: 400, epoch: 12 | loss: 0.0122822
	speed: 0.0108s/iter; left time: 393.5736s
Epoch: 12 cost time: 4.769027233123779
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.965 Test Loss: 0.187 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9777171441564347
model parameter : 22457
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1993649
	speed: 0.0225s/iter; left time: 927.0419s
	iters: 200, epoch: 1 | loss: 0.3679853
	speed: 0.0103s/iter; left time: 421.6242s
	iters: 300, epoch: 1 | loss: 0.3366051
	speed: 0.0106s/iter; left time: 433.8836s
	iters: 400, epoch: 1 | loss: 0.0853464
	speed: 0.0107s/iter; left time: 436.7484s
Epoch: 1 cost time: 5.565589666366577
Epoch: 1, Steps: 413 | Train Loss: 0.784 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0313951
	speed: 0.0362s/iter; left time: 1477.8114s
	iters: 200, epoch: 2 | loss: 0.0445635
	speed: 0.0102s/iter; left time: 416.1591s
	iters: 300, epoch: 2 | loss: 0.2370940
	speed: 0.0114s/iter; left time: 463.7849s
	iters: 400, epoch: 2 | loss: 0.2887779
	speed: 0.0116s/iter; left time: 467.9526s
Epoch: 2 cost time: 4.912286758422852
Epoch: 2, Steps: 413 | Train Loss: 0.125 Vali Loss: 0.090 Vali Acc: 0.970 Test Loss: 0.090 Test Acc: 0.970
Validation loss decreased (-0.960435 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0073476
	speed: 0.0441s/iter; left time: 1778.5290s
	iters: 200, epoch: 3 | loss: 0.0338635
	speed: 0.0108s/iter; left time: 433.2587s
	iters: 300, epoch: 3 | loss: 0.1083503
	speed: 0.0106s/iter; left time: 425.1044s
	iters: 400, epoch: 3 | loss: 0.8093583
	speed: 0.0105s/iter; left time: 422.0909s
Epoch: 3 cost time: 4.847218751907349
Epoch: 3, Steps: 413 | Train Loss: 0.077 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0094069
	speed: 0.0433s/iter; left time: 1730.7536s
	iters: 200, epoch: 4 | loss: 0.1011797
	speed: 0.0112s/iter; left time: 444.6973s
	iters: 300, epoch: 4 | loss: 0.0158383
	speed: 0.0115s/iter; left time: 458.2359s
	iters: 400, epoch: 4 | loss: 0.0122482
	speed: 0.0105s/iter; left time: 417.7903s
Epoch: 4 cost time: 4.873424053192139
Epoch: 4, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.114 Vali Acc: 0.965 Test Loss: 0.114 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0069022
	speed: 0.0326s/iter; left time: 1290.2172s
	iters: 200, epoch: 5 | loss: 0.0532569
	speed: 0.0109s/iter; left time: 428.6537s
	iters: 300, epoch: 5 | loss: 0.1691823
	speed: 0.0113s/iter; left time: 444.7058s
	iters: 400, epoch: 5 | loss: 0.0014601
	speed: 0.0112s/iter; left time: 441.3926s
Epoch: 5 cost time: 4.872710227966309
Epoch: 5, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.075 Vali Acc: 0.973 Test Loss: 0.075 Test Acc: 0.973
Validation loss decreased (-0.969985 --> -0.972714).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0307822
	speed: 0.0318s/iter; left time: 1245.8382s
	iters: 200, epoch: 6 | loss: 0.0006622
	speed: 0.0100s/iter; left time: 389.7858s
	iters: 300, epoch: 6 | loss: 0.0020073
	speed: 0.0104s/iter; left time: 404.0667s
	iters: 400, epoch: 6 | loss: 0.0021245
	speed: 0.0110s/iter; left time: 425.6844s
Epoch: 6 cost time: 4.5584189891815186
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.968 Test Loss: 0.102 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0012782
	speed: 0.0351s/iter; left time: 1358.4606s
	iters: 200, epoch: 7 | loss: 0.0014122
	speed: 0.0125s/iter; left time: 481.4768s
	iters: 300, epoch: 7 | loss: 0.0015873
	speed: 0.0118s/iter; left time: 454.2719s
	iters: 400, epoch: 7 | loss: 0.0046193
	speed: 0.0116s/iter; left time: 445.6561s
Epoch: 7 cost time: 5.075360536575317
Epoch: 7, Steps: 413 | Train Loss: 0.033 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0016672
	speed: 0.0462s/iter; left time: 1768.2659s
	iters: 200, epoch: 8 | loss: 0.0449038
	speed: 0.0116s/iter; left time: 442.4692s
	iters: 300, epoch: 8 | loss: 0.1687979
	speed: 0.0108s/iter; left time: 410.9507s
	iters: 400, epoch: 8 | loss: 0.0014735
	speed: 0.0110s/iter; left time: 419.3125s
Epoch: 8 cost time: 5.029035329818726
Epoch: 8, Steps: 413 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0084736
	speed: 0.0450s/iter; left time: 1705.1211s
	iters: 200, epoch: 9 | loss: 0.0538184
	speed: 0.0115s/iter; left time: 434.6452s
	iters: 300, epoch: 9 | loss: 0.0003819
	speed: 0.0110s/iter; left time: 413.8270s
	iters: 400, epoch: 9 | loss: 0.0027848
	speed: 0.0108s/iter; left time: 406.1940s
Epoch: 9 cost time: 5.057475328445435
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0153966
	speed: 0.0367s/iter; left time: 1376.0028s
	iters: 200, epoch: 10 | loss: 0.2041998
	speed: 0.0109s/iter; left time: 408.5853s
	iters: 300, epoch: 10 | loss: 0.0088707
	speed: 0.0110s/iter; left time: 408.4596s
	iters: 400, epoch: 10 | loss: 0.0242613
	speed: 0.0108s/iter; left time: 402.1344s
Epoch: 10 cost time: 4.691372394561768
Epoch: 10, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0001063
	speed: 0.0350s/iter; left time: 1296.7832s
	iters: 200, epoch: 11 | loss: 0.0334674
	speed: 0.0107s/iter; left time: 394.8084s
	iters: 300, epoch: 11 | loss: 0.0000149
	speed: 0.0107s/iter; left time: 393.3864s
	iters: 400, epoch: 11 | loss: 0.0053836
	speed: 0.0104s/iter; left time: 382.3266s
Epoch: 11 cost time: 4.677895545959473
Epoch: 11, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0012925
	speed: 0.0337s/iter; left time: 1233.6024s
	iters: 200, epoch: 12 | loss: 0.0000878
	speed: 0.0103s/iter; left time: 375.8648s
	iters: 300, epoch: 12 | loss: 0.0022987
	speed: 0.0100s/iter; left time: 362.8220s
	iters: 400, epoch: 12 | loss: 0.1306773
	speed: 0.0110s/iter; left time: 400.3641s
Epoch: 12 cost time: 4.577625751495361
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0120103
	speed: 0.0437s/iter; left time: 1583.4012s
	iters: 200, epoch: 13 | loss: 0.0070600
	speed: 0.0111s/iter; left time: 403.0040s
	iters: 300, epoch: 13 | loss: 0.0014452
	speed: 0.0104s/iter; left time: 375.7275s
	iters: 400, epoch: 13 | loss: 0.0005972
	speed: 0.0098s/iter; left time: 352.2621s
Epoch: 13 cost time: 4.693347930908203
Epoch: 13, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0002009
	speed: 0.0419s/iter; left time: 1502.4226s
	iters: 200, epoch: 14 | loss: 0.0088990
	speed: 0.0110s/iter; left time: 394.1365s
	iters: 300, epoch: 14 | loss: 0.0011395
	speed: 0.0125s/iter; left time: 447.1712s
	iters: 400, epoch: 14 | loss: 0.0002616
	speed: 0.0113s/iter; left time: 401.7006s
Epoch: 14 cost time: 5.115945100784302
Epoch: 14, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000117
	speed: 0.0358s/iter; left time: 1267.6715s
	iters: 200, epoch: 15 | loss: 0.0000731
	speed: 0.0100s/iter; left time: 353.9455s
	iters: 300, epoch: 15 | loss: 0.0001622
	speed: 0.0106s/iter; left time: 372.2373s
	iters: 400, epoch: 15 | loss: 0.0007703
	speed: 0.0101s/iter; left time: 353.1109s
Epoch: 15 cost time: 4.56247615814209
Epoch: 15, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.955 Test Loss: 0.214 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 22642
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0719466
	speed: 0.0261s/iter; left time: 1077.3737s
	iters: 200, epoch: 1 | loss: 0.5402305
	speed: 0.0100s/iter; left time: 410.5414s
	iters: 300, epoch: 1 | loss: 0.5069608
	speed: 0.0102s/iter; left time: 420.0724s
	iters: 400, epoch: 1 | loss: 0.1541308
	speed: 0.0111s/iter; left time: 452.3553s
Epoch: 1 cost time: 5.924170970916748
Epoch: 1, Steps: 413 | Train Loss: 0.776 Vali Loss: 0.152 Vali Acc: 0.953 Test Loss: 0.152 Test Acc: 0.953
Validation loss decreased (inf --> -0.953159).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.3181233
	speed: 0.0359s/iter; left time: 1464.1212s
	iters: 200, epoch: 2 | loss: 0.0714651
	speed: 0.0107s/iter; left time: 437.1883s
	iters: 300, epoch: 2 | loss: 0.0627246
	speed: 0.0102s/iter; left time: 414.6948s
	iters: 400, epoch: 2 | loss: 0.0650130
	speed: 0.0098s/iter; left time: 397.7244s
Epoch: 2 cost time: 4.492162227630615
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.110 Vali Acc: 0.963 Test Loss: 0.110 Test Acc: 0.963
Validation loss decreased (-0.953159 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0110617
	speed: 0.0352s/iter; left time: 1420.7211s
	iters: 200, epoch: 3 | loss: 0.0772537
	speed: 0.0101s/iter; left time: 406.4081s
	iters: 300, epoch: 3 | loss: 0.0902355
	speed: 0.0106s/iter; left time: 423.8549s
	iters: 400, epoch: 3 | loss: 0.0616808
	speed: 0.0107s/iter; left time: 429.8000s
Epoch: 3 cost time: 4.649375915527344
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.104 Vali Acc: 0.966 Test Loss: 0.104 Test Acc: 0.966
Validation loss decreased (-0.962709 --> -0.965893).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0936876
	speed: 0.0441s/iter; left time: 1763.8224s
	iters: 200, epoch: 4 | loss: 0.2274833
	speed: 0.0116s/iter; left time: 463.6582s
	iters: 300, epoch: 4 | loss: 0.0017376
	speed: 0.0114s/iter; left time: 453.4884s
	iters: 400, epoch: 4 | loss: 0.0063723
	speed: 0.0115s/iter; left time: 456.2569s
Epoch: 4 cost time: 5.145193576812744
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.108 Vali Acc: 0.960 Test Loss: 0.108 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0641317
	speed: 0.0466s/iter; left time: 1842.6734s
	iters: 200, epoch: 5 | loss: 0.0369623
	speed: 0.0115s/iter; left time: 452.0810s
	iters: 300, epoch: 5 | loss: 0.0008217
	speed: 0.0112s/iter; left time: 440.0524s
	iters: 400, epoch: 5 | loss: 0.0040707
	speed: 0.0117s/iter; left time: 460.2493s
Epoch: 5 cost time: 5.224483013153076
Epoch: 5, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.957 Test Loss: 0.146 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 6 | loss: 0.0591675
	speed: 0.0446s/iter; left time: 1744.1728s
	iters: 200, epoch: 6 | loss: 0.0083109
	speed: 0.0100s/iter; left time: 391.8926s
	iters: 300, epoch: 6 | loss: 0.0393139
	speed: 0.0105s/iter; left time: 408.1530s
	iters: 400, epoch: 6 | loss: 0.0027346
	speed: 0.0104s/iter; left time: 404.2376s
Epoch: 6 cost time: 4.648691654205322
Epoch: 6, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.103 Vali Acc: 0.970 Test Loss: 0.103 Test Acc: 0.970
Validation loss decreased (-0.965893 --> -0.969531).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.0025840
	speed: 0.0342s/iter; left time: 1323.2461s
	iters: 200, epoch: 7 | loss: 0.0069911
	speed: 0.0101s/iter; left time: 389.4648s
	iters: 300, epoch: 7 | loss: 0.0109278
	speed: 0.0105s/iter; left time: 406.3356s
	iters: 400, epoch: 7 | loss: 0.0026794
	speed: 0.0108s/iter; left time: 413.1491s
Epoch: 7 cost time: 4.628892421722412
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 8 | loss: 0.0025516
	speed: 0.0347s/iter; left time: 1329.2206s
	iters: 200, epoch: 8 | loss: 0.0016070
	speed: 0.0108s/iter; left time: 413.9718s
	iters: 300, epoch: 8 | loss: 0.0375314
	speed: 0.0113s/iter; left time: 432.1960s
	iters: 400, epoch: 8 | loss: 0.0237567
	speed: 0.0109s/iter; left time: 413.3124s
Epoch: 8 cost time: 4.793680667877197
Epoch: 8, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.973 Test Loss: 0.099 Test Acc: 0.973
Validation loss decreased (-0.969531 --> -0.972714).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.0035393
	speed: 0.0463s/iter; left time: 1752.9960s
	iters: 200, epoch: 9 | loss: 0.0104128
	speed: 0.0120s/iter; left time: 452.4962s
	iters: 300, epoch: 9 | loss: 0.0012098
	speed: 0.0115s/iter; left time: 434.2493s
	iters: 400, epoch: 9 | loss: 0.0120207
	speed: 0.0119s/iter; left time: 446.8081s
Epoch: 9 cost time: 5.218628644943237
Epoch: 9, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.958 Test Loss: 0.135 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 10 | loss: 0.0022370
	speed: 0.0431s/iter; left time: 1617.1055s
	iters: 200, epoch: 10 | loss: 0.0160993
	speed: 0.0109s/iter; left time: 405.6291s
	iters: 300, epoch: 10 | loss: 0.0224419
	speed: 0.0112s/iter; left time: 417.7934s
	iters: 400, epoch: 10 | loss: 0.0004024
	speed: 0.0113s/iter; left time: 420.1754s
Epoch: 10 cost time: 4.96315598487854
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 11 | loss: 0.1019019
	speed: 0.0422s/iter; left time: 1566.1058s
	iters: 200, epoch: 11 | loss: 0.0332084
	speed: 0.0105s/iter; left time: 387.1965s
	iters: 300, epoch: 11 | loss: 0.0086247
	speed: 0.0108s/iter; left time: 399.9034s
	iters: 400, epoch: 11 | loss: 0.0002874
	speed: 0.0112s/iter; left time: 410.6665s
Epoch: 11 cost time: 4.713721036911011
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 12 | loss: 0.0000374
	speed: 0.0368s/iter; left time: 1347.6839s
	iters: 200, epoch: 12 | loss: 0.0371956
	speed: 0.0111s/iter; left time: 405.3957s
	iters: 300, epoch: 12 | loss: 0.0076945
	speed: 0.0104s/iter; left time: 377.3965s
	iters: 400, epoch: 12 | loss: 0.0004609
	speed: 0.0106s/iter; left time: 385.6218s
Epoch: 12 cost time: 4.737073183059692
Epoch: 12, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 13 | loss: 0.0024573
	speed: 0.0361s/iter; left time: 1306.8896s
	iters: 200, epoch: 13 | loss: 0.0000474
	speed: 0.0108s/iter; left time: 390.9527s
	iters: 300, epoch: 13 | loss: 0.0014889
	speed: 0.0116s/iter; left time: 417.4558s
	iters: 400, epoch: 13 | loss: 0.0000017
	speed: 0.0111s/iter; left time: 399.2670s
Epoch: 13 cost time: 4.857067346572876
Epoch: 13, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 14 | loss: 0.0000382
	speed: 0.0455s/iter; left time: 1629.8046s
	iters: 200, epoch: 14 | loss: 0.0000327
	speed: 0.0103s/iter; left time: 368.1911s
	iters: 300, epoch: 14 | loss: 0.0002424
	speed: 0.0109s/iter; left time: 386.8506s
	iters: 400, epoch: 14 | loss: 0.0000649
	speed: 0.0108s/iter; left time: 382.1559s
Epoch: 14 cost time: 4.832357406616211
Epoch: 14, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 15 | loss: 0.0011337
	speed: 0.0450s/iter; left time: 1593.2242s
	iters: 200, epoch: 15 | loss: 0.0000082
	speed: 0.0108s/iter; left time: 381.5898s
	iters: 300, epoch: 15 | loss: 0.0124068
	speed: 0.0105s/iter; left time: 371.3517s
	iters: 400, epoch: 15 | loss: 0.1320772
	speed: 0.0108s/iter; left time: 379.0419s
Epoch: 15 cost time: 4.793798208236694
Epoch: 15, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 16 | loss: 0.0009715
	speed: 0.0335s/iter; left time: 1173.1998s
	iters: 200, epoch: 16 | loss: 0.0086250
	speed: 0.0097s/iter; left time: 336.8698s
	iters: 300, epoch: 16 | loss: 0.0000042
	speed: 0.0103s/iter; left time: 357.3395s
	iters: 400, epoch: 16 | loss: 0.0000821
	speed: 0.0104s/iter; left time: 360.0027s
Epoch: 16 cost time: 4.473722696304321
Epoch: 16, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 17 | loss: 0.0000006
	speed: 0.0348s/iter; left time: 1205.3628s
	iters: 200, epoch: 17 | loss: 0.0015732
	speed: 0.0101s/iter; left time: 346.9612s
	iters: 300, epoch: 17 | loss: 0.0003275
	speed: 0.0119s/iter; left time: 408.0155s
	iters: 400, epoch: 17 | loss: 0.0000260
	speed: 0.0104s/iter; left time: 355.4959s
Epoch: 17 cost time: 4.745928525924683
Epoch: 17, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 18 | loss: 0.0000008
	speed: 0.0336s/iter; left time: 1147.9179s
	iters: 200, epoch: 18 | loss: 0.0000004
	speed: 0.0106s/iter; left time: 359.7489s
	iters: 300, epoch: 18 | loss: 0.0170885
	speed: 0.0109s/iter; left time: 371.2277s
	iters: 400, epoch: 18 | loss: 0.0213763
	speed: 0.0104s/iter; left time: 352.8767s
Epoch: 18 cost time: 4.654207706451416
Epoch: 18, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.958 Test Loss: 0.204 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 22491
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9900080
	speed: 0.0203s/iter; left time: 837.5280s
	iters: 200, epoch: 1 | loss: 0.3159412
	speed: 0.0099s/iter; left time: 406.3549s
	iters: 300, epoch: 1 | loss: 0.2679236
	speed: 0.0114s/iter; left time: 468.0599s
	iters: 400, epoch: 1 | loss: 0.2350011
	speed: 0.0093s/iter; left time: 379.3842s
Epoch: 1 cost time: 5.270211696624756
Epoch: 1, Steps: 413 | Train Loss: 0.755 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (inf --> -0.960435).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1086355
	speed: 0.0352s/iter; left time: 1436.8110s
	iters: 200, epoch: 2 | loss: 0.0810483
	speed: 0.0110s/iter; left time: 448.3102s
	iters: 300, epoch: 2 | loss: 0.0418579
	speed: 0.0099s/iter; left time: 402.4463s
	iters: 400, epoch: 2 | loss: 0.0719687
	speed: 0.0106s/iter; left time: 428.4174s
Epoch: 2 cost time: 4.658510684967041
Epoch: 2, Steps: 413 | Train Loss: 0.131 Vali Loss: 0.097 Vali Acc: 0.969 Test Loss: 0.097 Test Acc: 0.969
Validation loss decreased (-0.960435 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0183767
	speed: 0.0373s/iter; left time: 1504.8391s
	iters: 200, epoch: 3 | loss: 0.0921471
	speed: 0.0111s/iter; left time: 445.9677s
	iters: 300, epoch: 3 | loss: 0.0198915
	speed: 0.0116s/iter; left time: 466.3565s
	iters: 400, epoch: 3 | loss: 0.0022005
	speed: 0.0114s/iter; left time: 456.7667s
Epoch: 3 cost time: 4.796773433685303
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.090 Vali Acc: 0.973 Test Loss: 0.090 Test Acc: 0.973
Validation loss decreased (-0.968621 --> -0.973169).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0094904
	speed: 0.0468s/iter; left time: 1868.7201s
	iters: 200, epoch: 4 | loss: 0.0326118
	speed: 0.0101s/iter; left time: 401.1325s
	iters: 300, epoch: 4 | loss: 0.0172231
	speed: 0.0104s/iter; left time: 413.0277s
	iters: 400, epoch: 4 | loss: 0.0475818
	speed: 0.0106s/iter; left time: 421.8931s
Epoch: 4 cost time: 4.713247299194336
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0899675
	speed: 0.0428s/iter; left time: 1692.0269s
	iters: 200, epoch: 5 | loss: 0.0402950
	speed: 0.0104s/iter; left time: 409.9607s
	iters: 300, epoch: 5 | loss: 0.1863384
	speed: 0.0096s/iter; left time: 377.6103s
	iters: 400, epoch: 5 | loss: 0.0449332
	speed: 0.0093s/iter; left time: 364.1674s
Epoch: 5 cost time: 4.420773506164551
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.078 Vali Acc: 0.975 Test Loss: 0.078 Test Acc: 0.975
Validation loss decreased (-0.973169 --> -0.974533).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0355212
	speed: 0.0342s/iter; left time: 1339.3313s
	iters: 200, epoch: 6 | loss: 0.0024766
	speed: 0.0110s/iter; left time: 428.3946s
	iters: 300, epoch: 6 | loss: 0.0028081
	speed: 0.0106s/iter; left time: 410.8902s
	iters: 400, epoch: 6 | loss: 0.0165498
	speed: 0.0100s/iter; left time: 390.0657s
Epoch: 6 cost time: 4.62451434135437
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0042882
	speed: 0.0325s/iter; left time: 1256.7135s
	iters: 200, epoch: 7 | loss: 0.0106843
	speed: 0.0104s/iter; left time: 403.3376s
	iters: 300, epoch: 7 | loss: 0.0026562
	speed: 0.0101s/iter; left time: 388.2575s
	iters: 400, epoch: 7 | loss: 0.0103511
	speed: 0.0096s/iter; left time: 367.6023s
Epoch: 7 cost time: 4.54068660736084
Epoch: 7, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.107 Vali Acc: 0.965 Test Loss: 0.107 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0024839
	speed: 0.0313s/iter; left time: 1200.0014s
	iters: 200, epoch: 8 | loss: 0.0082759
	speed: 0.0103s/iter; left time: 391.8748s
	iters: 300, epoch: 8 | loss: 0.0229735
	speed: 0.0104s/iter; left time: 398.2276s
	iters: 400, epoch: 8 | loss: 0.0009939
	speed: 0.0106s/iter; left time: 401.1140s
Epoch: 8 cost time: 4.492931604385376
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0028179
	speed: 0.0421s/iter; left time: 1596.6080s
	iters: 200, epoch: 9 | loss: 0.1396112
	speed: 0.0099s/iter; left time: 373.7191s
	iters: 300, epoch: 9 | loss: 0.0000729
	speed: 0.0099s/iter; left time: 371.7320s
	iters: 400, epoch: 9 | loss: 0.0018551
	speed: 0.0103s/iter; left time: 388.9325s
Epoch: 9 cost time: 4.580176830291748
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.967 Test Loss: 0.111 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0011094
	speed: 0.0431s/iter; left time: 1615.1539s
	iters: 200, epoch: 10 | loss: 0.0000184
	speed: 0.0108s/iter; left time: 403.7312s
	iters: 300, epoch: 10 | loss: 0.0275745
	speed: 0.0112s/iter; left time: 416.1395s
	iters: 400, epoch: 10 | loss: 0.0001495
	speed: 0.0094s/iter; left time: 348.6258s
Epoch: 10 cost time: 4.6621339321136475
Epoch: 10, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0011593
	speed: 0.0325s/iter; left time: 1205.0003s
	iters: 200, epoch: 11 | loss: 0.0000893
	speed: 0.0095s/iter; left time: 349.7256s
	iters: 300, epoch: 11 | loss: 0.0835444
	speed: 0.0108s/iter; left time: 396.4494s
	iters: 400, epoch: 11 | loss: 0.0002497
	speed: 0.0095s/iter; left time: 348.4163s
Epoch: 11 cost time: 4.376336097717285
Epoch: 11, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0003815
	speed: 0.0312s/iter; left time: 1143.6154s
	iters: 200, epoch: 12 | loss: 0.0000218
	speed: 0.0105s/iter; left time: 385.0069s
	iters: 300, epoch: 12 | loss: 0.0257566
	speed: 0.0107s/iter; left time: 390.4817s
	iters: 400, epoch: 12 | loss: 0.0503458
	speed: 0.0107s/iter; left time: 389.0249s
Epoch: 12 cost time: 4.533098936080933
Epoch: 12, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0001263
	speed: 0.0371s/iter; left time: 1344.0492s
	iters: 200, epoch: 13 | loss: 0.0020160
	speed: 0.0118s/iter; left time: 428.2167s
	iters: 300, epoch: 13 | loss: 0.0522993
	speed: 0.0106s/iter; left time: 380.9361s
	iters: 400, epoch: 13 | loss: 0.3758658
	speed: 0.0107s/iter; left time: 382.9211s
Epoch: 13 cost time: 4.769356727600098
Epoch: 13, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0002466
	speed: 0.0437s/iter; left time: 1566.0522s
	iters: 200, epoch: 14 | loss: 0.1513802
	speed: 0.0102s/iter; left time: 363.2739s
	iters: 300, epoch: 14 | loss: 0.0002160
	speed: 0.0106s/iter; left time: 375.9671s
	iters: 400, epoch: 14 | loss: 0.0002199
	speed: 0.0108s/iter; left time: 382.5161s
Epoch: 14 cost time: 4.826696395874023
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000328
	speed: 0.0431s/iter; left time: 1527.9862s
	iters: 200, epoch: 15 | loss: 0.0009574
	speed: 0.0103s/iter; left time: 365.1406s
	iters: 300, epoch: 15 | loss: 0.0001591
	speed: 0.0104s/iter; left time: 366.4980s
	iters: 400, epoch: 15 | loss: 0.0000167
	speed: 0.0090s/iter; left time: 316.7167s
Epoch: 15 cost time: 4.510228157043457
Epoch: 15, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9745338790359254
model parameter : 22562
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.4457171
	speed: 0.0226s/iter; left time: 931.2837s
	iters: 200, epoch: 1 | loss: 1.0075458
	speed: 0.0103s/iter; left time: 423.3681s
	iters: 300, epoch: 1 | loss: 0.1960589
	speed: 0.0116s/iter; left time: 474.4500s
	iters: 400, epoch: 1 | loss: 0.0768195
	speed: 0.0117s/iter; left time: 477.6164s
Epoch: 1 cost time: 5.829033374786377
Epoch: 1, Steps: 413 | Train Loss: 0.770 Vali Loss: 0.163 Vali Acc: 0.955 Test Loss: 0.163 Test Acc: 0.955
Validation loss decreased (inf --> -0.955433).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0774193
	speed: 0.0476s/iter; left time: 1940.4104s
	iters: 200, epoch: 2 | loss: 0.1155501
	speed: 0.0120s/iter; left time: 489.2314s
	iters: 300, epoch: 2 | loss: 0.1799402
	speed: 0.0116s/iter; left time: 472.6417s
	iters: 400, epoch: 2 | loss: 0.0366083
	speed: 0.0106s/iter; left time: 428.2840s
Epoch: 2 cost time: 5.084607362747192
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
Validation loss decreased (-0.955433 --> -0.962709).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0412499
	speed: 0.0454s/iter; left time: 1833.5325s
	iters: 200, epoch: 3 | loss: 0.0169212
	speed: 0.0118s/iter; left time: 474.2087s
	iters: 300, epoch: 3 | loss: 0.1572186
	speed: 0.0121s/iter; left time: 486.1540s
	iters: 400, epoch: 3 | loss: 0.0485180
	speed: 0.0108s/iter; left time: 432.2931s
Epoch: 3 cost time: 5.060911655426025
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.099 Vali Acc: 0.966 Test Loss: 0.099 Test Acc: 0.966
Validation loss decreased (-0.962709 --> -0.965893).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0314655
	speed: 0.0320s/iter; left time: 1278.0848s
	iters: 200, epoch: 4 | loss: 0.0197319
	speed: 0.0110s/iter; left time: 437.1686s
	iters: 300, epoch: 4 | loss: 0.0035642
	speed: 0.0106s/iter; left time: 422.0421s
	iters: 400, epoch: 4 | loss: 0.0306556
	speed: 0.0108s/iter; left time: 426.7753s
Epoch: 4 cost time: 4.6770360469818115
Epoch: 4, Steps: 413 | Train Loss: 0.063 Vali Loss: 0.086 Vali Acc: 0.970 Test Loss: 0.086 Test Acc: 0.970
Validation loss decreased (-0.965893 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0967541
	speed: 0.0334s/iter; left time: 1319.4493s
	iters: 200, epoch: 5 | loss: 0.0043998
	speed: 0.0103s/iter; left time: 406.5365s
	iters: 300, epoch: 5 | loss: 0.0146483
	speed: 0.0106s/iter; left time: 418.8678s
	iters: 400, epoch: 5 | loss: 0.0027600
	speed: 0.0110s/iter; left time: 432.5871s
Epoch: 5 cost time: 4.596181392669678
Epoch: 5, Steps: 413 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.965 Test Loss: 0.109 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0517639
	speed: 0.0338s/iter; left time: 1322.4900s
	iters: 200, epoch: 6 | loss: 0.0032949
	speed: 0.0114s/iter; left time: 445.1258s
	iters: 300, epoch: 6 | loss: 0.0455077
	speed: 0.0114s/iter; left time: 445.7738s
	iters: 400, epoch: 6 | loss: 0.0510435
	speed: 0.0116s/iter; left time: 450.6765s
Epoch: 6 cost time: 4.930269956588745
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.964 Test Loss: 0.120 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0916638
	speed: 0.0493s/iter; left time: 1908.1064s
	iters: 200, epoch: 7 | loss: 0.0003972
	speed: 0.0118s/iter; left time: 456.3123s
	iters: 300, epoch: 7 | loss: 0.0118870
	speed: 0.0124s/iter; left time: 476.5189s
	iters: 400, epoch: 7 | loss: 0.0002682
	speed: 0.0123s/iter; left time: 474.3334s
Epoch: 7 cost time: 5.453359127044678
Epoch: 7, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.084 Vali Acc: 0.973 Test Loss: 0.084 Test Acc: 0.973
Validation loss decreased (-0.970440 --> -0.972714).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0043530
	speed: 0.0515s/iter; left time: 1974.7132s
	iters: 200, epoch: 8 | loss: 0.0068594
	speed: 0.0122s/iter; left time: 465.9069s
	iters: 300, epoch: 8 | loss: 0.0274366
	speed: 0.0124s/iter; left time: 472.0531s
	iters: 400, epoch: 8 | loss: 0.0006292
	speed: 0.0124s/iter; left time: 470.3260s
Epoch: 8 cost time: 5.49429178237915
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.132 Vali Acc: 0.961 Test Loss: 0.132 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0002950
	speed: 0.0370s/iter; left time: 1401.1412s
	iters: 200, epoch: 9 | loss: 0.0247090
	speed: 0.0103s/iter; left time: 389.8324s
	iters: 300, epoch: 9 | loss: 0.0003100
	speed: 0.0105s/iter; left time: 395.8581s
	iters: 400, epoch: 9 | loss: 0.0007101
	speed: 0.0112s/iter; left time: 419.5675s
Epoch: 9 cost time: 4.649864435195923
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.968 Test Loss: 0.117 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0002645
	speed: 0.0351s/iter; left time: 1314.9525s
	iters: 200, epoch: 10 | loss: 0.0075001
	speed: 0.0106s/iter; left time: 395.2669s
	iters: 300, epoch: 10 | loss: 0.0003502
	speed: 0.0107s/iter; left time: 399.7686s
	iters: 400, epoch: 10 | loss: 0.0002962
	speed: 0.0108s/iter; left time: 401.5553s
Epoch: 10 cost time: 4.684322834014893
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0027890
	speed: 0.0342s/iter; left time: 1268.7182s
	iters: 200, epoch: 11 | loss: 0.0038767
	speed: 0.0114s/iter; left time: 421.7154s
	iters: 300, epoch: 11 | loss: 0.0073852
	speed: 0.0117s/iter; left time: 432.4844s
	iters: 400, epoch: 11 | loss: 0.0133759
	speed: 0.0117s/iter; left time: 430.0048s
Epoch: 11 cost time: 5.007777690887451
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0013779
	speed: 0.0456s/iter; left time: 1671.8771s
	iters: 200, epoch: 12 | loss: 0.0000072
	speed: 0.0107s/iter; left time: 391.2879s
	iters: 300, epoch: 12 | loss: 0.0078711
	speed: 0.0114s/iter; left time: 416.6437s
	iters: 400, epoch: 12 | loss: 0.0397871
	speed: 0.0120s/iter; left time: 435.5626s
Epoch: 12 cost time: 5.022431373596191
Epoch: 12, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.972714 --> -0.974078).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.0006883
	speed: 0.0493s/iter; left time: 1787.1364s
	iters: 200, epoch: 13 | loss: 0.0034658
	speed: 0.0118s/iter; left time: 425.9486s
	iters: 300, epoch: 13 | loss: 0.0000069
	speed: 0.0115s/iter; left time: 412.7368s
	iters: 400, epoch: 13 | loss: 0.0000154
	speed: 0.0105s/iter; left time: 376.4560s
Epoch: 13 cost time: 5.111191749572754
Epoch: 13, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 14 | loss: 0.0000043
	speed: 0.0373s/iter; left time: 1335.7887s
	iters: 200, epoch: 14 | loss: 0.0010638
	speed: 0.0106s/iter; left time: 377.6283s
	iters: 300, epoch: 14 | loss: 0.0372197
	speed: 0.0110s/iter; left time: 391.1674s
	iters: 400, epoch: 14 | loss: 0.0005553
	speed: 0.0111s/iter; left time: 394.0500s
Epoch: 14 cost time: 4.797968626022339
Epoch: 14, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 15 | loss: 0.0003523
	speed: 0.0416s/iter; left time: 1474.0774s
	iters: 200, epoch: 15 | loss: 0.0001367
	speed: 0.0111s/iter; left time: 390.6352s
	iters: 300, epoch: 15 | loss: 0.0015410
	speed: 0.0108s/iter; left time: 379.9412s
	iters: 400, epoch: 15 | loss: 0.0010975
	speed: 0.0104s/iter; left time: 365.4810s
Epoch: 15 cost time: 4.909933805465698
Epoch: 15, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 16 | loss: 0.0000396
	speed: 0.0348s/iter; left time: 1216.7924s
	iters: 200, epoch: 16 | loss: 0.0024041
	speed: 0.0104s/iter; left time: 363.2143s
	iters: 300, epoch: 16 | loss: 0.0028545
	speed: 0.0107s/iter; left time: 373.7053s
	iters: 400, epoch: 16 | loss: 0.0012367
	speed: 0.0108s/iter; left time: 374.7439s
Epoch: 16 cost time: 4.824530839920044
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
Validation loss decreased (-0.974078 --> -0.975442).  Saving model ...
	iters: 100, epoch: 17 | loss: 0.0082736
	speed: 0.0415s/iter; left time: 1435.1747s
	iters: 200, epoch: 17 | loss: 0.0003974
	speed: 0.0105s/iter; left time: 363.3579s
	iters: 300, epoch: 17 | loss: 0.0024855
	speed: 0.0112s/iter; left time: 386.3040s
	iters: 400, epoch: 17 | loss: 0.0103281
	speed: 0.0120s/iter; left time: 411.5896s
Epoch: 17 cost time: 4.941421031951904
Epoch: 17, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.972 Test Loss: 0.125 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 18 | loss: 0.0000191
	speed: 0.0443s/iter; left time: 1512.9561s
	iters: 200, epoch: 18 | loss: 0.0007082
	speed: 0.0108s/iter; left time: 367.6835s
	iters: 300, epoch: 18 | loss: 0.1268492
	speed: 0.0107s/iter; left time: 363.9075s
	iters: 400, epoch: 18 | loss: 0.0281786
	speed: 0.0097s/iter; left time: 327.3717s
Epoch: 18 cost time: 4.759939432144165
Epoch: 18, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 19 | loss: 0.0001594
	speed: 0.0327s/iter; left time: 1105.3616s
	iters: 200, epoch: 19 | loss: 0.0000620
	speed: 0.0103s/iter; left time: 346.1455s
	iters: 300, epoch: 19 | loss: 0.0001972
	speed: 0.0097s/iter; left time: 325.3701s
	iters: 400, epoch: 19 | loss: 0.0000019
	speed: 0.0099s/iter; left time: 331.0550s
Epoch: 19 cost time: 4.4383721351623535
Epoch: 19, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 20 | loss: 0.0009619
	speed: 0.0370s/iter; left time: 1233.5756s
	iters: 200, epoch: 20 | loss: 0.0001488
	speed: 0.0103s/iter; left time: 341.9397s
	iters: 300, epoch: 20 | loss: 0.0000385
	speed: 0.0103s/iter; left time: 342.1558s
	iters: 400, epoch: 20 | loss: 0.0231511
	speed: 0.0103s/iter; left time: 341.5381s
Epoch: 20 cost time: 4.58642840385437
Epoch: 20, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 21 | loss: 0.0000101
	speed: 0.0413s/iter; left time: 1359.9492s
	iters: 200, epoch: 21 | loss: 0.0000136
	speed: 0.0112s/iter; left time: 369.4540s
	iters: 300, epoch: 21 | loss: 0.0012416
	speed: 0.0112s/iter; left time: 366.6280s
	iters: 400, epoch: 21 | loss: 0.0044646
	speed: 0.0116s/iter; left time: 379.8679s
Epoch: 21 cost time: 5.085066795349121
Epoch: 21, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 22 | loss: 0.0000111
	speed: 0.0432s/iter; left time: 1405.3673s
	iters: 200, epoch: 22 | loss: 0.0000117
	speed: 0.0111s/iter; left time: 361.3140s
	iters: 300, epoch: 22 | loss: 0.0001072
	speed: 0.0109s/iter; left time: 353.2850s
	iters: 400, epoch: 22 | loss: 0.0068373
	speed: 0.0112s/iter; left time: 360.0983s
Epoch: 22 cost time: 4.9584059715271
Epoch: 22, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.966 Test Loss: 0.194 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 23 | loss: 0.0000013
	speed: 0.0414s/iter; left time: 1329.9203s
	iters: 200, epoch: 23 | loss: 0.0000086
	speed: 0.0103s/iter; left time: 328.5260s
	iters: 300, epoch: 23 | loss: 0.0000007
	speed: 0.0100s/iter; left time: 317.6776s
	iters: 400, epoch: 23 | loss: 0.0000005
	speed: 0.0114s/iter; left time: 361.2982s
Epoch: 23 cost time: 4.632663726806641
Epoch: 23, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
Validation loss decreased (-0.975442 --> -0.976806).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0002344
	speed: 0.0341s/iter; left time: 1080.6000s
	iters: 200, epoch: 24 | loss: 0.0000090
	speed: 0.0107s/iter; left time: 337.8059s
	iters: 300, epoch: 24 | loss: 0.0000002
	speed: 0.0103s/iter; left time: 325.7089s
	iters: 400, epoch: 24 | loss: 0.0015688
	speed: 0.0098s/iter; left time: 306.7747s
Epoch: 24 cost time: 4.510143756866455
Epoch: 24, Steps: 413 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0313s/iter; left time: 980.2509s
	iters: 200, epoch: 25 | loss: 0.0004680
	speed: 0.0105s/iter; left time: 328.1845s
	iters: 300, epoch: 25 | loss: 0.0000023
	speed: 0.0105s/iter; left time: 325.5801s
	iters: 400, epoch: 25 | loss: 0.0000664
	speed: 0.0110s/iter; left time: 339.9950s
Epoch: 25 cost time: 4.598040342330933
Epoch: 25, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.969 Test Loss: 0.214 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 26 | loss: 0.0000045
	speed: 0.0418s/iter; left time: 1290.3659s
	iters: 200, epoch: 26 | loss: 0.0039308
	speed: 0.0109s/iter; left time: 336.8618s
	iters: 300, epoch: 26 | loss: 0.0010998
	speed: 0.0105s/iter; left time: 322.2181s
	iters: 400, epoch: 26 | loss: 0.0001727
	speed: 0.0103s/iter; left time: 314.4747s
Epoch: 26 cost time: 4.745471477508545
Epoch: 26, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.965 Test Loss: 0.228 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 27 | loss: 0.0000525
	speed: 0.0405s/iter; left time: 1232.9390s
	iters: 200, epoch: 27 | loss: 0.0024264
	speed: 0.0101s/iter; left time: 307.7202s
	iters: 300, epoch: 27 | loss: 0.0000737
	speed: 0.0107s/iter; left time: 324.4295s
	iters: 400, epoch: 27 | loss: 0.0000016
	speed: 0.0108s/iter; left time: 325.6045s
Epoch: 27 cost time: 4.801591873168945
Epoch: 27, Steps: 413 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 28 | loss: 0.0000003
	speed: 0.0374s/iter; left time: 1122.8666s
	iters: 200, epoch: 28 | loss: 0.0000001
	speed: 0.0115s/iter; left time: 345.0431s
	iters: 300, epoch: 28 | loss: 0.0000055
	speed: 0.0099s/iter; left time: 296.6744s
	iters: 400, epoch: 28 | loss: 0.0000521
	speed: 0.0109s/iter; left time: 325.7016s
Epoch: 28 cost time: 4.684653282165527
Epoch: 28, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 29 | loss: 0.0000268
	speed: 0.0361s/iter; left time: 1068.9632s
	iters: 200, epoch: 29 | loss: 0.0000010
	speed: 0.0100s/iter; left time: 294.6609s
	iters: 300, epoch: 29 | loss: 0.0000003
	speed: 0.0111s/iter; left time: 326.2449s
	iters: 400, epoch: 29 | loss: 0.0000005
	speed: 0.0102s/iter; left time: 298.7410s
Epoch: 29 cost time: 4.544747352600098
Epoch: 29, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.974 Test Loss: 0.180 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 30 | loss: 0.0000834
	speed: 0.0354s/iter; left time: 1033.4484s
	iters: 200, epoch: 30 | loss: 0.0000002
	speed: 0.0100s/iter; left time: 291.4342s
	iters: 300, epoch: 30 | loss: 0.0002383
	speed: 0.0101s/iter; left time: 292.4840s
	iters: 400, epoch: 30 | loss: 0.0002546
	speed: 0.0107s/iter; left time: 310.6617s
Epoch: 30 cost time: 4.592501640319824
Epoch: 30, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 31 | loss: 0.0000095
	speed: 0.0452s/iter; left time: 1302.0546s
	iters: 200, epoch: 31 | loss: 0.0000021
	speed: 0.0106s/iter; left time: 305.6780s
	iters: 300, epoch: 31 | loss: 0.0000001
	speed: 0.0107s/iter; left time: 306.3292s
	iters: 400, epoch: 31 | loss: 0.0000005
	speed: 0.0102s/iter; left time: 291.5605s
Epoch: 31 cost time: 4.747844696044922
Epoch: 31, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 32 | loss: 0.0000144
	speed: 0.0413s/iter; left time: 1174.1273s
	iters: 200, epoch: 32 | loss: 0.0000041
	speed: 0.0109s/iter; left time: 307.3377s
	iters: 300, epoch: 32 | loss: 0.0000090
	speed: 0.0105s/iter; left time: 296.6871s
	iters: 400, epoch: 32 | loss: 0.0000000
	speed: 0.0108s/iter; left time: 302.6203s
Epoch: 32 cost time: 4.7432849407196045
Epoch: 32, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 33 | loss: 0.0000007
	speed: 0.0332s/iter; left time: 929.6783s
	iters: 200, epoch: 33 | loss: 0.0000017
	speed: 0.0100s/iter; left time: 278.9568s
	iters: 300, epoch: 33 | loss: 0.0000076
	speed: 0.0102s/iter; left time: 282.1998s
	iters: 400, epoch: 33 | loss: 0.0002202
	speed: 0.0110s/iter; left time: 303.8018s
Epoch: 33 cost time: 4.62261438369751
Epoch: 33, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.975 Test Loss: 0.174 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9768076398362893
model parameter : 22746
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 0.9931504
	speed: 0.0204s/iter; left time: 839.3788s
	iters: 200, epoch: 1 | loss: 0.3178096
	speed: 0.0098s/iter; left time: 402.2875s
	iters: 300, epoch: 1 | loss: 0.2694398
	speed: 0.0104s/iter; left time: 425.8254s
	iters: 400, epoch: 1 | loss: 0.2345736
	speed: 0.0109s/iter; left time: 446.9068s
Epoch: 1 cost time: 5.316851615905762
Epoch: 1, Steps: 413 | Train Loss: 0.757 Vali Loss: 0.150 Vali Acc: 0.959 Test Loss: 0.150 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1096662
	speed: 0.0340s/iter; left time: 1385.0018s
	iters: 200, epoch: 2 | loss: 0.0833636
	speed: 0.0104s/iter; left time: 422.4451s
	iters: 300, epoch: 2 | loss: 0.0470075
	speed: 0.0105s/iter; left time: 425.7554s
	iters: 400, epoch: 2 | loss: 0.0698987
	speed: 0.0102s/iter; left time: 411.4396s
Epoch: 2 cost time: 4.562674283981323
Epoch: 2, Steps: 413 | Train Loss: 0.132 Vali Loss: 0.099 Vali Acc: 0.970 Test Loss: 0.099 Test Acc: 0.970
Validation loss decreased (-0.959071 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0188688
	speed: 0.0356s/iter; left time: 1435.9952s
	iters: 200, epoch: 3 | loss: 0.0700655
	speed: 0.0106s/iter; left time: 426.1080s
	iters: 300, epoch: 3 | loss: 0.0184267
	speed: 0.0103s/iter; left time: 412.7361s
	iters: 400, epoch: 3 | loss: 0.0022045
	speed: 0.0101s/iter; left time: 405.1391s
Epoch: 3 cost time: 4.556545972824097
Epoch: 3, Steps: 413 | Train Loss: 0.085 Vali Loss: 0.096 Vali Acc: 0.971 Test Loss: 0.096 Test Acc: 0.971
Validation loss decreased (-0.969985 --> -0.971350).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0109362
	speed: 0.0374s/iter; left time: 1493.0335s
	iters: 200, epoch: 4 | loss: 0.0462979
	speed: 0.0113s/iter; left time: 449.8051s
	iters: 300, epoch: 4 | loss: 0.0487130
	speed: 0.0110s/iter; left time: 437.8341s
	iters: 400, epoch: 4 | loss: 0.0556314
	speed: 0.0111s/iter; left time: 439.0135s
Epoch: 4 cost time: 4.900369882583618
Epoch: 4, Steps: 413 | Train Loss: 0.062 Vali Loss: 0.125 Vali Acc: 0.960 Test Loss: 0.125 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 5 | loss: 0.0572532
	speed: 0.0419s/iter; left time: 1656.4831s
	iters: 200, epoch: 5 | loss: 0.0542132
	speed: 0.0106s/iter; left time: 419.2760s
	iters: 300, epoch: 5 | loss: 0.1429695
	speed: 0.0111s/iter; left time: 436.4507s
	iters: 400, epoch: 5 | loss: 0.0739335
	speed: 0.0113s/iter; left time: 443.8238s
Epoch: 5 cost time: 4.9949164390563965
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.071 Vali Acc: 0.975 Test Loss: 0.071 Test Acc: 0.975
Validation loss decreased (-0.971350 --> -0.975443).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0847360
	speed: 0.0441s/iter; left time: 1725.4324s
	iters: 200, epoch: 6 | loss: 0.0061274
	speed: 0.0104s/iter; left time: 404.8628s
	iters: 300, epoch: 6 | loss: 0.0022069
	speed: 0.0113s/iter; left time: 441.8043s
	iters: 400, epoch: 6 | loss: 0.0093437
	speed: 0.0101s/iter; left time: 393.1006s
Epoch: 6 cost time: 4.621145963668823
Epoch: 6, Steps: 413 | Train Loss: 0.036 Vali Loss: 0.081 Vali Acc: 0.973 Test Loss: 0.081 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0047504
	speed: 0.0369s/iter; left time: 1427.7030s
	iters: 200, epoch: 7 | loss: 0.0022805
	speed: 0.0101s/iter; left time: 388.4539s
	iters: 300, epoch: 7 | loss: 0.0013773
	speed: 0.0104s/iter; left time: 401.8255s
	iters: 400, epoch: 7 | loss: 0.0378319
	speed: 0.0106s/iter; left time: 406.3529s
Epoch: 7 cost time: 4.606763124465942
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.079 Vali Acc: 0.973 Test Loss: 0.079 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0048833
	speed: 0.0337s/iter; left time: 1289.1478s
	iters: 200, epoch: 8 | loss: 0.0006504
	speed: 0.0096s/iter; left time: 365.9928s
	iters: 300, epoch: 8 | loss: 0.0032384
	speed: 0.0104s/iter; left time: 394.4521s
	iters: 400, epoch: 8 | loss: 0.0000687
	speed: 0.0105s/iter; left time: 399.6735s
Epoch: 8 cost time: 4.496568441390991
Epoch: 8, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.093 Vali Acc: 0.968 Test Loss: 0.093 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0708969
	speed: 0.0455s/iter; left time: 1724.9880s
	iters: 200, epoch: 9 | loss: 0.2517943
	speed: 0.0110s/iter; left time: 414.6014s
	iters: 300, epoch: 9 | loss: 0.0012380
	speed: 0.0111s/iter; left time: 418.3436s
	iters: 400, epoch: 9 | loss: 0.0000525
	speed: 0.0107s/iter; left time: 401.1149s
Epoch: 9 cost time: 4.837353944778442
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.097 Vali Acc: 0.968 Test Loss: 0.097 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.1224742
	speed: 0.0461s/iter; left time: 1728.2356s
	iters: 200, epoch: 10 | loss: 0.0004518
	speed: 0.0110s/iter; left time: 411.9451s
	iters: 300, epoch: 10 | loss: 0.0393668
	speed: 0.0111s/iter; left time: 414.6927s
	iters: 400, epoch: 10 | loss: 0.0001026
	speed: 0.0111s/iter; left time: 413.5529s
Epoch: 10 cost time: 4.961307525634766
Epoch: 10, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0002430
	speed: 0.0405s/iter; left time: 1501.2931s
	iters: 200, epoch: 11 | loss: 0.0001135
	speed: 0.0100s/iter; left time: 368.5722s
	iters: 300, epoch: 11 | loss: 0.0123932
	speed: 0.0104s/iter; left time: 384.4656s
	iters: 400, epoch: 11 | loss: 0.0001757
	speed: 0.0106s/iter; left time: 390.7544s
Epoch: 11 cost time: 4.539469242095947
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.083 Vali Acc: 0.972 Test Loss: 0.083 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0004362
	speed: 0.0334s/iter; left time: 1225.1861s
	iters: 200, epoch: 12 | loss: 0.0528073
	speed: 0.0101s/iter; left time: 368.3052s
	iters: 300, epoch: 12 | loss: 0.0208826
	speed: 0.0107s/iter; left time: 389.8597s
	iters: 400, epoch: 12 | loss: 0.0439031
	speed: 0.0099s/iter; left time: 360.5828s
Epoch: 12 cost time: 4.428319454193115
Epoch: 12, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0000288
	speed: 0.0338s/iter; left time: 1226.4975s
	iters: 200, epoch: 13 | loss: 0.0000138
	speed: 0.0103s/iter; left time: 370.8530s
	iters: 300, epoch: 13 | loss: 0.0000531
	speed: 0.0116s/iter; left time: 418.0773s
	iters: 400, epoch: 13 | loss: 0.2784223
	speed: 0.0108s/iter; left time: 389.7031s
Epoch: 13 cost time: 4.745867013931274
Epoch: 13, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0008593
	speed: 0.0468s/iter; left time: 1676.8779s
	iters: 200, epoch: 14 | loss: 0.0024572
	speed: 0.0124s/iter; left time: 444.2177s
	iters: 300, epoch: 14 | loss: 0.0005069
	speed: 0.0110s/iter; left time: 390.7966s
	iters: 400, epoch: 14 | loss: 0.0000180
	speed: 0.0109s/iter; left time: 388.6070s
Epoch: 14 cost time: 5.038506746292114
Epoch: 14, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0000164
	speed: 0.0480s/iter; left time: 1699.3142s
	iters: 200, epoch: 15 | loss: 0.0007735
	speed: 0.0112s/iter; left time: 395.5908s
	iters: 300, epoch: 15 | loss: 0.0000076
	speed: 0.0112s/iter; left time: 394.0379s
	iters: 400, epoch: 15 | loss: 0.0003137
	speed: 0.0112s/iter; left time: 392.7816s
Epoch: 15 cost time: 4.9937450885772705
Epoch: 15, Steps: 413 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.975443383356071
model parameter : 22562
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1853464
	speed: 0.0223s/iter; left time: 919.0175s
	iters: 200, epoch: 1 | loss: 0.4519930
	speed: 0.0113s/iter; left time: 465.5041s
	iters: 300, epoch: 1 | loss: 0.1042612
	speed: 0.0105s/iter; left time: 430.0620s
	iters: 400, epoch: 1 | loss: 0.0744075
	speed: 0.0108s/iter; left time: 440.2306s
Epoch: 1 cost time: 5.6653664112091064
Epoch: 1, Steps: 413 | Train Loss: 0.761 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
Validation loss decreased (inf --> -0.949066).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2887893
	speed: 0.0439s/iter; left time: 1792.0912s
	iters: 200, epoch: 2 | loss: 0.0794865
	speed: 0.0111s/iter; left time: 450.8952s
	iters: 300, epoch: 2 | loss: 0.1724702
	speed: 0.0111s/iter; left time: 449.2274s
	iters: 400, epoch: 2 | loss: 0.0697899
	speed: 0.0108s/iter; left time: 438.5413s
Epoch: 2 cost time: 4.888309717178345
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.092 Vali Acc: 0.970 Test Loss: 0.092 Test Acc: 0.970
Validation loss decreased (-0.949066 --> -0.969985).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1313834
	speed: 0.0435s/iter; left time: 1757.4039s
	iters: 200, epoch: 3 | loss: 0.0385078
	speed: 0.0107s/iter; left time: 430.2641s
	iters: 300, epoch: 3 | loss: 0.0559742
	speed: 0.0109s/iter; left time: 437.4108s
	iters: 400, epoch: 3 | loss: 0.0473556
	speed: 0.0110s/iter; left time: 442.7936s
Epoch: 3 cost time: 4.885793685913086
Epoch: 3, Steps: 413 | Train Loss: 0.083 Vali Loss: 0.099 Vali Acc: 0.967 Test Loss: 0.099 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0249411
	speed: 0.0387s/iter; left time: 1547.4862s
	iters: 200, epoch: 4 | loss: 0.0279115
	speed: 0.0105s/iter; left time: 420.2439s
	iters: 300, epoch: 4 | loss: 0.0394001
	speed: 0.0105s/iter; left time: 418.9306s
	iters: 400, epoch: 4 | loss: 0.2769203
	speed: 0.0097s/iter; left time: 383.4340s
Epoch: 4 cost time: 4.545807600021362
Epoch: 4, Steps: 413 | Train Loss: 0.060 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0063617
	speed: 0.0357s/iter; left time: 1410.5319s
	iters: 200, epoch: 5 | loss: 0.0406909
	speed: 0.0104s/iter; left time: 408.3326s
	iters: 300, epoch: 5 | loss: 0.0588865
	speed: 0.0099s/iter; left time: 390.4654s
	iters: 400, epoch: 5 | loss: 0.1257890
	speed: 0.0102s/iter; left time: 399.7664s
Epoch: 5 cost time: 4.63614296913147
Epoch: 5, Steps: 413 | Train Loss: 0.053 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0012804
	speed: 0.0329s/iter; left time: 1287.4564s
	iters: 200, epoch: 6 | loss: 0.0360940
	speed: 0.0100s/iter; left time: 388.5554s
	iters: 300, epoch: 6 | loss: 0.0323522
	speed: 0.0109s/iter; left time: 426.0414s
	iters: 400, epoch: 6 | loss: 0.0334066
	speed: 0.0118s/iter; left time: 456.9181s
Epoch: 6 cost time: 4.784318447113037
Epoch: 6, Steps: 413 | Train Loss: 0.040 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0018759
	speed: 0.0465s/iter; left time: 1800.1396s
	iters: 200, epoch: 7 | loss: 0.0505107
	speed: 0.0116s/iter; left time: 448.0345s
	iters: 300, epoch: 7 | loss: 0.0023872
	speed: 0.0104s/iter; left time: 400.7183s
	iters: 400, epoch: 7 | loss: 0.0165625
	speed: 0.0111s/iter; left time: 427.0253s
Epoch: 7 cost time: 5.015368700027466
Epoch: 7, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.961 Test Loss: 0.117 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000861
	speed: 0.0456s/iter; left time: 1748.6680s
	iters: 200, epoch: 8 | loss: 0.0383200
	speed: 0.0103s/iter; left time: 394.2391s
	iters: 300, epoch: 8 | loss: 0.0009314
	speed: 0.0109s/iter; left time: 415.9827s
	iters: 400, epoch: 8 | loss: 0.0261022
	speed: 0.0107s/iter; left time: 406.3281s
Epoch: 8 cost time: 4.7838521003723145
Epoch: 8, Steps: 413 | Train Loss: 0.028 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0008197
	speed: 0.0345s/iter; left time: 1307.7283s
	iters: 200, epoch: 9 | loss: 0.0030912
	speed: 0.0103s/iter; left time: 390.9294s
	iters: 300, epoch: 9 | loss: 0.0009262
	speed: 0.0104s/iter; left time: 393.3271s
	iters: 400, epoch: 9 | loss: 0.0103804
	speed: 0.0102s/iter; left time: 385.3101s
Epoch: 9 cost time: 4.500654458999634
Epoch: 9, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0082694
	speed: 0.0320s/iter; left time: 1201.1718s
	iters: 200, epoch: 10 | loss: 0.0006306
	speed: 0.0105s/iter; left time: 390.7676s
	iters: 300, epoch: 10 | loss: 0.0576589
	speed: 0.0114s/iter; left time: 425.4714s
	iters: 400, epoch: 10 | loss: 0.0450026
	speed: 0.0105s/iter; left time: 388.7338s
Epoch: 10 cost time: 4.693723678588867
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.182 Vali Acc: 0.950 Test Loss: 0.182 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0027587
	speed: 0.0340s/iter; left time: 1260.8777s
	iters: 200, epoch: 11 | loss: 0.0011504
	speed: 0.0107s/iter; left time: 397.2762s
	iters: 300, epoch: 11 | loss: 0.0001037
	speed: 0.0115s/iter; left time: 425.5748s
	iters: 400, epoch: 11 | loss: 0.1033974
	speed: 0.0117s/iter; left time: 429.0390s
Epoch: 11 cost time: 4.905372619628906
Epoch: 11, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.172 Vali Acc: 0.958 Test Loss: 0.172 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0411168
	speed: 0.0464s/iter; left time: 1701.9636s
	iters: 200, epoch: 12 | loss: 0.3351852
	speed: 0.0108s/iter; left time: 395.7629s
	iters: 300, epoch: 12 | loss: 0.0031420
	speed: 0.0120s/iter; left time: 435.9307s
	iters: 400, epoch: 12 | loss: 0.0000989
	speed: 0.0116s/iter; left time: 423.5629s
Epoch: 12 cost time: 5.177653074264526
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9699863574351978
model parameter : 22863
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3654059
	speed: 0.0204s/iter; left time: 839.9795s
	iters: 200, epoch: 1 | loss: 0.3926506
	speed: 0.0106s/iter; left time: 434.8486s
	iters: 300, epoch: 1 | loss: 0.2433148
	speed: 0.0105s/iter; left time: 429.3893s
	iters: 400, epoch: 1 | loss: 0.1470116
	speed: 0.0101s/iter; left time: 413.5900s
Epoch: 1 cost time: 5.330708026885986
Epoch: 1, Steps: 413 | Train Loss: 0.751 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (inf --> -0.963164).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0527561
	speed: 0.0302s/iter; left time: 1231.9911s
	iters: 200, epoch: 2 | loss: 0.0657656
	speed: 0.0104s/iter; left time: 421.4233s
	iters: 300, epoch: 2 | loss: 0.0221784
	speed: 0.0100s/iter; left time: 407.2665s
	iters: 400, epoch: 2 | loss: 0.3383302
	speed: 0.0104s/iter; left time: 422.0330s
Epoch: 2 cost time: 4.481199026107788
Epoch: 2, Steps: 413 | Train Loss: 0.130 Vali Loss: 0.095 Vali Acc: 0.973 Test Loss: 0.095 Test Acc: 0.973
Validation loss decreased (-0.963164 --> -0.972714).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0080335
	speed: 0.0408s/iter; left time: 1648.0669s
	iters: 200, epoch: 3 | loss: 0.1768259
	speed: 0.0108s/iter; left time: 436.1558s
	iters: 300, epoch: 3 | loss: 0.0358207
	speed: 0.0100s/iter; left time: 403.7251s
	iters: 400, epoch: 3 | loss: 0.0055756
	speed: 0.0107s/iter; left time: 427.2047s
Epoch: 3 cost time: 4.714975357055664
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.105 Vali Acc: 0.968 Test Loss: 0.105 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0102526
	speed: 0.0431s/iter; left time: 1721.4466s
	iters: 200, epoch: 4 | loss: 0.0298523
	speed: 0.0117s/iter; left time: 465.2494s
	iters: 300, epoch: 4 | loss: 0.0325137
	speed: 0.0091s/iter; left time: 363.0019s
	iters: 400, epoch: 4 | loss: 0.0317188
	speed: 0.0097s/iter; left time: 386.4392s
Epoch: 4 cost time: 4.612590312957764
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.082 Vali Acc: 0.973 Test Loss: 0.082 Test Acc: 0.973
Validation loss decreased (-0.972714 --> -0.972714).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.2325727
	speed: 0.0336s/iter; left time: 1327.4199s
	iters: 200, epoch: 5 | loss: 0.0439969
	speed: 0.0100s/iter; left time: 393.8580s
	iters: 300, epoch: 5 | loss: 0.0014663
	speed: 0.0105s/iter; left time: 414.3186s
	iters: 400, epoch: 5 | loss: 0.0040262
	speed: 0.0102s/iter; left time: 399.8003s
Epoch: 5 cost time: 4.553001880645752
Epoch: 5, Steps: 413 | Train Loss: 0.051 Vali Loss: 0.123 Vali Acc: 0.962 Test Loss: 0.123 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0054515
	speed: 0.0352s/iter; left time: 1378.9507s
	iters: 200, epoch: 6 | loss: 0.0007322
	speed: 0.0112s/iter; left time: 435.3336s
	iters: 300, epoch: 6 | loss: 0.0023135
	speed: 0.0122s/iter; left time: 476.2818s
	iters: 400, epoch: 6 | loss: 0.0034639
	speed: 0.0107s/iter; left time: 416.0755s
Epoch: 6 cost time: 4.996648788452148
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.961 Test Loss: 0.131 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.3050799
	speed: 0.0426s/iter; left time: 1651.2415s
	iters: 200, epoch: 7 | loss: 0.0760830
	speed: 0.0116s/iter; left time: 448.8580s
	iters: 300, epoch: 7 | loss: 0.0133960
	speed: 0.0117s/iter; left time: 450.6446s
	iters: 400, epoch: 7 | loss: 0.0174607
	speed: 0.0110s/iter; left time: 423.7392s
Epoch: 7 cost time: 5.081789493560791
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.970 Test Loss: 0.105 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 8 | loss: 0.0248144
	speed: 0.0379s/iter; left time: 1451.3910s
	iters: 200, epoch: 8 | loss: 0.0199005
	speed: 0.0109s/iter; left time: 414.7768s
	iters: 300, epoch: 8 | loss: 0.0033499
	speed: 0.0110s/iter; left time: 418.4952s
	iters: 400, epoch: 8 | loss: 0.0017775
	speed: 0.0108s/iter; left time: 410.7817s
Epoch: 8 cost time: 4.78633975982666
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.126 Vali Acc: 0.962 Test Loss: 0.126 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 9 | loss: 0.0040845
	speed: 0.0360s/iter; left time: 1363.0707s
	iters: 200, epoch: 9 | loss: 0.0008551
	speed: 0.0090s/iter; left time: 341.6114s
	iters: 300, epoch: 9 | loss: 0.0024515
	speed: 0.0101s/iter; left time: 382.6171s
	iters: 400, epoch: 9 | loss: 0.2690072
	speed: 0.0103s/iter; left time: 387.9200s
Epoch: 9 cost time: 4.369802474975586
Epoch: 9, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 10 | loss: 0.1796196
	speed: 0.0315s/iter; left time: 1181.0394s
	iters: 200, epoch: 10 | loss: 0.0001268
	speed: 0.0108s/iter; left time: 402.0141s
	iters: 300, epoch: 10 | loss: 0.0053434
	speed: 0.0103s/iter; left time: 384.1419s
	iters: 400, epoch: 10 | loss: 0.0435841
	speed: 0.0106s/iter; left time: 395.5075s
Epoch: 10 cost time: 4.606769800186157
Epoch: 10, Steps: 413 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.955 Test Loss: 0.191 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 11 | loss: 0.0056797
	speed: 0.0330s/iter; left time: 1224.6678s
	iters: 200, epoch: 11 | loss: 0.0164786
	speed: 0.0100s/iter; left time: 369.1850s
	iters: 300, epoch: 11 | loss: 0.0384860
	speed: 0.0109s/iter; left time: 403.5188s
	iters: 400, epoch: 11 | loss: 0.3791339
	speed: 0.0111s/iter; left time: 408.4578s
Epoch: 11 cost time: 4.624677658081055
Epoch: 11, Steps: 413 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 12 | loss: 0.0090132
	speed: 0.0479s/iter; left time: 1757.5244s
	iters: 200, epoch: 12 | loss: 0.0000438
	speed: 0.0115s/iter; left time: 418.7331s
	iters: 300, epoch: 12 | loss: 0.0017864
	speed: 0.0118s/iter; left time: 430.9068s
	iters: 400, epoch: 12 | loss: 0.0000465
	speed: 0.0115s/iter; left time: 418.4536s
Epoch: 12 cost time: 5.232839822769165
Epoch: 12, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 13 | loss: 0.1664650
	speed: 0.0459s/iter; left time: 1664.6857s
	iters: 200, epoch: 13 | loss: 0.0025634
	speed: 0.0110s/iter; left time: 397.2472s
	iters: 300, epoch: 13 | loss: 0.0007035
	speed: 0.0115s/iter; left time: 416.0177s
	iters: 400, epoch: 13 | loss: 0.0037137
	speed: 0.0109s/iter; left time: 392.2963s
Epoch: 13 cost time: 4.957351207733154
Epoch: 13, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.963 Test Loss: 0.203 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 14 | loss: 0.0002384
	speed: 0.0321s/iter; left time: 1150.6093s
	iters: 200, epoch: 14 | loss: 0.0001110
	speed: 0.0102s/iter; left time: 363.8859s
	iters: 300, epoch: 14 | loss: 0.0009355
	speed: 0.0110s/iter; left time: 393.0075s
	iters: 400, epoch: 14 | loss: 0.0006169
	speed: 0.0107s/iter; left time: 381.5378s
Epoch: 14 cost time: 4.6679322719573975
Epoch: 14, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.965 Test Loss: 0.185 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9727148703956344
model parameter : 22982
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.0794272
	speed: 0.0234s/iter; left time: 965.2760s
	iters: 200, epoch: 1 | loss: 0.5475381
	speed: 0.0113s/iter; left time: 462.4631s
	iters: 300, epoch: 1 | loss: 0.5107105
	speed: 0.0107s/iter; left time: 440.5962s
	iters: 400, epoch: 1 | loss: 0.3916250
	speed: 0.0106s/iter; left time: 431.7305s
Epoch: 1 cost time: 5.800179481506348
Epoch: 1, Steps: 413 | Train Loss: 0.790 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (inf --> -0.959526).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0931609
	speed: 0.0424s/iter; left time: 1729.5310s
	iters: 200, epoch: 2 | loss: 0.0345972
	speed: 0.0116s/iter; left time: 472.9851s
	iters: 300, epoch: 2 | loss: 0.1148824
	speed: 0.0113s/iter; left time: 459.2670s
	iters: 400, epoch: 2 | loss: 0.0607350
	speed: 0.0112s/iter; left time: 452.3676s
Epoch: 2 cost time: 5.020848035812378
Epoch: 2, Steps: 413 | Train Loss: 0.128 Vali Loss: 0.107 Vali Acc: 0.966 Test Loss: 0.107 Test Acc: 0.966
Validation loss decreased (-0.959526 --> -0.966347).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0853240
	speed: 0.0337s/iter; left time: 1359.0576s
	iters: 200, epoch: 3 | loss: 0.0785582
	speed: 0.0108s/iter; left time: 433.7164s
	iters: 300, epoch: 3 | loss: 0.0393441
	speed: 0.0106s/iter; left time: 425.7814s
	iters: 400, epoch: 3 | loss: 0.9576526
	speed: 0.0099s/iter; left time: 397.9486s
Epoch: 3 cost time: 4.529719829559326
Epoch: 3, Steps: 413 | Train Loss: 0.081 Vali Loss: 0.115 Vali Acc: 0.964 Test Loss: 0.115 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0263931
	speed: 0.0329s/iter; left time: 1316.4890s
	iters: 200, epoch: 4 | loss: 0.0161271
	speed: 0.0100s/iter; left time: 397.9921s
	iters: 300, epoch: 4 | loss: 0.0088434
	speed: 0.0104s/iter; left time: 412.3262s
	iters: 400, epoch: 4 | loss: 0.0326296
	speed: 0.0109s/iter; left time: 430.6958s
Epoch: 4 cost time: 4.50051736831665
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0813522
	speed: 0.0339s/iter; left time: 1340.0102s
	iters: 200, epoch: 5 | loss: 0.6479433
	speed: 0.0098s/iter; left time: 386.8933s
	iters: 300, epoch: 5 | loss: 0.0499942
	speed: 0.0114s/iter; left time: 450.2961s
	iters: 400, epoch: 5 | loss: 0.0047744
	speed: 0.0110s/iter; left time: 432.9515s
Epoch: 5 cost time: 4.644883632659912
Epoch: 5, Steps: 413 | Train Loss: 0.061 Vali Loss: 0.090 Vali Acc: 0.969 Test Loss: 0.090 Test Acc: 0.969
Validation loss decreased (-0.966347 --> -0.969076).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0084565
	speed: 0.0461s/iter; left time: 1804.0815s
	iters: 200, epoch: 6 | loss: 0.0073276
	speed: 0.0121s/iter; left time: 473.0606s
	iters: 300, epoch: 6 | loss: 0.0451093
	speed: 0.0108s/iter; left time: 419.0139s
	iters: 400, epoch: 6 | loss: 0.0124081
	speed: 0.0120s/iter; left time: 464.8623s
Epoch: 6 cost time: 5.202584981918335
Epoch: 6, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.145 Vali Acc: 0.955 Test Loss: 0.145 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0207250
	speed: 0.0474s/iter; left time: 1834.5738s
	iters: 200, epoch: 7 | loss: 0.0219494
	speed: 0.0107s/iter; left time: 413.8000s
	iters: 300, epoch: 7 | loss: 0.0108986
	speed: 0.0113s/iter; left time: 436.1709s
	iters: 400, epoch: 7 | loss: 0.0314776
	speed: 0.0118s/iter; left time: 453.0290s
Epoch: 7 cost time: 5.069904804229736
Epoch: 7, Steps: 413 | Train Loss: 0.041 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0113277
	speed: 0.0364s/iter; left time: 1392.9992s
	iters: 200, epoch: 8 | loss: 0.0086238
	speed: 0.0097s/iter; left time: 370.4007s
	iters: 300, epoch: 8 | loss: 0.0019837
	speed: 0.0099s/iter; left time: 376.3100s
	iters: 400, epoch: 8 | loss: 0.0070542
	speed: 0.0100s/iter; left time: 380.0640s
Epoch: 8 cost time: 4.4357993602752686
Epoch: 8, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0067965
	speed: 0.0351s/iter; left time: 1328.5884s
	iters: 200, epoch: 9 | loss: 0.0027711
	speed: 0.0110s/iter; left time: 416.9389s
	iters: 300, epoch: 9 | loss: 0.0924835
	speed: 0.0106s/iter; left time: 399.9044s
	iters: 400, epoch: 9 | loss: 0.0003869
	speed: 0.0107s/iter; left time: 401.4817s
Epoch: 9 cost time: 4.688939809799194
Epoch: 9, Steps: 413 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0208126
	speed: 0.0337s/iter; left time: 1264.8583s
	iters: 200, epoch: 10 | loss: 0.0000789
	speed: 0.0115s/iter; left time: 429.0867s
	iters: 300, epoch: 10 | loss: 0.0004266
	speed: 0.0119s/iter; left time: 444.0196s
	iters: 400, epoch: 10 | loss: 0.0064604
	speed: 0.0115s/iter; left time: 429.2458s
Epoch: 10 cost time: 4.926451921463013
Epoch: 10, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0000807
	speed: 0.0466s/iter; left time: 1727.5028s
	iters: 200, epoch: 11 | loss: 0.0021301
	speed: 0.0112s/iter; left time: 413.3665s
	iters: 300, epoch: 11 | loss: 0.0021595
	speed: 0.0100s/iter; left time: 368.6170s
	iters: 400, epoch: 11 | loss: 0.1731170
	speed: 0.0106s/iter; left time: 389.2365s
Epoch: 11 cost time: 4.735986709594727
Epoch: 11, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0275392
	speed: 0.0462s/iter; left time: 1692.1025s
	iters: 200, epoch: 12 | loss: 0.0342261
	speed: 0.0110s/iter; left time: 402.1960s
	iters: 300, epoch: 12 | loss: 0.0000673
	speed: 0.0112s/iter; left time: 408.0406s
	iters: 400, epoch: 12 | loss: 0.1211519
	speed: 0.0119s/iter; left time: 431.9803s
Epoch: 12 cost time: 5.043244123458862
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.964 Test Loss: 0.186 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0381141
	speed: 0.0369s/iter; left time: 1337.5552s
	iters: 200, epoch: 13 | loss: 0.0020024
	speed: 0.0102s/iter; left time: 370.2427s
	iters: 300, epoch: 13 | loss: 0.0003461
	speed: 0.0104s/iter; left time: 375.1197s
	iters: 400, epoch: 13 | loss: 0.0000221
	speed: 0.0105s/iter; left time: 376.1000s
Epoch: 13 cost time: 4.54174017906189
Epoch: 13, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0040345
	speed: 0.0359s/iter; left time: 1285.4426s
	iters: 200, epoch: 14 | loss: 0.0212613
	speed: 0.0102s/iter; left time: 364.2965s
	iters: 300, epoch: 14 | loss: 0.0339070
	speed: 0.0100s/iter; left time: 357.9065s
	iters: 400, epoch: 14 | loss: 0.0020774
	speed: 0.0097s/iter; left time: 345.1091s
Epoch: 14 cost time: 4.552850961685181
Epoch: 14, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0002127
	speed: 0.0339s/iter; left time: 1201.6616s
	iters: 200, epoch: 15 | loss: 0.0000543
	speed: 0.0118s/iter; left time: 418.0613s
	iters: 300, epoch: 15 | loss: 0.0113593
	speed: 0.0115s/iter; left time: 405.0431s
	iters: 400, epoch: 15 | loss: 0.0002331
	speed: 0.0110s/iter; left time: 385.7774s
Epoch: 15 cost time: 4.954829692840576
Epoch: 15, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9690768531150523
model parameter : 22919
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.2082139
	speed: 0.0229s/iter; left time: 942.6617s
	iters: 200, epoch: 1 | loss: 0.3994109
	speed: 0.0104s/iter; left time: 426.2255s
	iters: 300, epoch: 1 | loss: 0.4284140
	speed: 0.0100s/iter; left time: 411.0159s
	iters: 400, epoch: 1 | loss: 0.0508949
	speed: 0.0108s/iter; left time: 443.6595s
Epoch: 1 cost time: 5.578685522079468
Epoch: 1, Steps: 413 | Train Loss: 0.760 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (inf --> -0.959980).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0330909
	speed: 0.0338s/iter; left time: 1377.7204s
	iters: 200, epoch: 2 | loss: 0.0706471
	speed: 0.0114s/iter; left time: 464.4850s
	iters: 300, epoch: 2 | loss: 0.0235293
	speed: 0.0104s/iter; left time: 421.7144s
	iters: 400, epoch: 2 | loss: 0.0260944
	speed: 0.0112s/iter; left time: 452.2941s
Epoch: 2 cost time: 4.822643280029297
Epoch: 2, Steps: 413 | Train Loss: 0.127 Vali Loss: 0.101 Vali Acc: 0.969 Test Loss: 0.101 Test Acc: 0.969
Validation loss decreased (-0.959980 --> -0.969076).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0204188
	speed: 0.0330s/iter; left time: 1331.2586s
	iters: 200, epoch: 3 | loss: 0.0661727
	speed: 0.0111s/iter; left time: 446.4505s
	iters: 300, epoch: 3 | loss: 0.0187053
	speed: 0.0103s/iter; left time: 412.2295s
	iters: 400, epoch: 3 | loss: 0.1631652
	speed: 0.0111s/iter; left time: 446.5769s
Epoch: 3 cost time: 4.658562421798706
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.100 Vali Acc: 0.968 Test Loss: 0.100 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0164017
	speed: 0.0404s/iter; left time: 1614.7459s
	iters: 200, epoch: 4 | loss: 0.1364329
	speed: 0.0113s/iter; left time: 450.9050s
	iters: 300, epoch: 4 | loss: 0.0349739
	speed: 0.0114s/iter; left time: 452.1874s
	iters: 400, epoch: 4 | loss: 0.0294835
	speed: 0.0103s/iter; left time: 406.6974s
Epoch: 4 cost time: 4.960467338562012
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.106 Vali Acc: 0.963 Test Loss: 0.106 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0199290
	speed: 0.0431s/iter; left time: 1704.2133s
	iters: 200, epoch: 5 | loss: 0.0803110
	speed: 0.0110s/iter; left time: 435.2891s
	iters: 300, epoch: 5 | loss: 0.0046953
	speed: 0.0111s/iter; left time: 437.7032s
	iters: 400, epoch: 5 | loss: 0.0057627
	speed: 0.0108s/iter; left time: 425.4884s
Epoch: 5 cost time: 4.867220878601074
Epoch: 5, Steps: 413 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.955 Test Loss: 0.144 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0331628
	speed: 0.0359s/iter; left time: 1404.4417s
	iters: 200, epoch: 6 | loss: 0.0784861
	speed: 0.0099s/iter; left time: 387.9222s
	iters: 300, epoch: 6 | loss: 0.0376611
	speed: 0.0104s/iter; left time: 405.1582s
	iters: 400, epoch: 6 | loss: 0.1793630
	speed: 0.0109s/iter; left time: 423.1690s
Epoch: 6 cost time: 4.628607749938965
Epoch: 6, Steps: 413 | Train Loss: 0.039 Vali Loss: 0.120 Vali Acc: 0.959 Test Loss: 0.120 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0005856
	speed: 0.0341s/iter; left time: 1320.3094s
	iters: 200, epoch: 7 | loss: 0.0026602
	speed: 0.0099s/iter; left time: 383.6049s
	iters: 300, epoch: 7 | loss: 0.0069211
	speed: 0.0112s/iter; left time: 429.6767s
	iters: 400, epoch: 7 | loss: 0.0811169
	speed: 0.0105s/iter; left time: 402.2366s
Epoch: 7 cost time: 4.583835601806641
Epoch: 7, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
Validation loss decreased (-0.969076 --> -0.969530).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0032591
	speed: 0.0318s/iter; left time: 1218.9069s
	iters: 200, epoch: 8 | loss: 0.0022159
	speed: 0.0102s/iter; left time: 391.4679s
	iters: 300, epoch: 8 | loss: 0.0005920
	speed: 0.0107s/iter; left time: 407.8940s
	iters: 400, epoch: 8 | loss: 0.1868245
	speed: 0.0107s/iter; left time: 406.9470s
Epoch: 8 cost time: 4.636789321899414
Epoch: 8, Steps: 413 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0041937
	speed: 0.0326s/iter; left time: 1237.3002s
	iters: 200, epoch: 9 | loss: 0.0004158
	speed: 0.0097s/iter; left time: 367.1817s
	iters: 300, epoch: 9 | loss: 0.0685706
	speed: 0.0113s/iter; left time: 424.4284s
	iters: 400, epoch: 9 | loss: 0.0012080
	speed: 0.0105s/iter; left time: 394.4893s
Epoch: 9 cost time: 4.578573226928711
Epoch: 9, Steps: 413 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0012924
	speed: 0.0385s/iter; left time: 1444.4749s
	iters: 200, epoch: 10 | loss: 0.0231216
	speed: 0.0102s/iter; left time: 382.0401s
	iters: 300, epoch: 10 | loss: 0.0010372
	speed: 0.0109s/iter; left time: 406.3877s
	iters: 400, epoch: 10 | loss: 0.0046755
	speed: 0.0103s/iter; left time: 384.5894s
Epoch: 10 cost time: 4.696842670440674
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0004048
	speed: 0.0385s/iter; left time: 1426.8470s
	iters: 200, epoch: 11 | loss: 0.0366421
	speed: 0.0114s/iter; left time: 423.1371s
	iters: 300, epoch: 11 | loss: 0.0036085
	speed: 0.0095s/iter; left time: 350.3522s
	iters: 400, epoch: 11 | loss: 0.0000671
	speed: 0.0103s/iter; left time: 378.4751s
Epoch: 11 cost time: 4.737960577011108
Epoch: 11, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
Validation loss decreased (-0.969530 --> -0.972259).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.0009773
	speed: 0.0402s/iter; left time: 1473.9879s
	iters: 200, epoch: 12 | loss: 0.0000160
	speed: 0.0107s/iter; left time: 392.6291s
	iters: 300, epoch: 12 | loss: 0.0004343
	speed: 0.0107s/iter; left time: 390.1112s
	iters: 400, epoch: 12 | loss: 0.0000125
	speed: 0.0115s/iter; left time: 418.6390s
Epoch: 12 cost time: 4.883920431137085
Epoch: 12, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 13 | loss: 0.0007567
	speed: 0.0494s/iter; left time: 1791.8572s
	iters: 200, epoch: 13 | loss: 0.0000470
	speed: 0.0117s/iter; left time: 422.1421s
	iters: 300, epoch: 13 | loss: 0.0000205
	speed: 0.0119s/iter; left time: 427.5180s
	iters: 400, epoch: 13 | loss: 0.0001817
	speed: 0.0110s/iter; left time: 396.6354s
Epoch: 13 cost time: 5.096665382385254
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.972 Test Loss: 0.156 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 14 | loss: 0.0022814
	speed: 0.0428s/iter; left time: 1531.9835s
	iters: 200, epoch: 14 | loss: 0.0002680
	speed: 0.0115s/iter; left time: 410.9217s
	iters: 300, epoch: 14 | loss: 0.0004752
	speed: 0.0116s/iter; left time: 411.9604s
	iters: 400, epoch: 14 | loss: 0.0002336
	speed: 0.0120s/iter; left time: 427.8587s
Epoch: 14 cost time: 5.202287435531616
Epoch: 14, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 15 | loss: 0.0005849
	speed: 0.0458s/iter; left time: 1623.2153s
	iters: 200, epoch: 15 | loss: 0.0013926
	speed: 0.0110s/iter; left time: 389.6837s
	iters: 300, epoch: 15 | loss: 0.0015114
	speed: 0.0112s/iter; left time: 393.8566s
	iters: 400, epoch: 15 | loss: 0.0143227
	speed: 0.0109s/iter; left time: 384.4187s
Epoch: 15 cost time: 4.880725860595703
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 16 | loss: 0.0075198
	speed: 0.0374s/iter; left time: 1309.5955s
	iters: 200, epoch: 16 | loss: 0.0003318
	speed: 0.0115s/iter; left time: 400.1941s
	iters: 300, epoch: 16 | loss: 0.0001570
	speed: 0.0108s/iter; left time: 377.3731s
	iters: 400, epoch: 16 | loss: 0.0001109
	speed: 0.0106s/iter; left time: 366.4474s
Epoch: 16 cost time: 4.891611337661743
Epoch: 16, Steps: 413 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.964 Test Loss: 0.215 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 17 | loss: 0.0000447
	speed: 0.0376s/iter; left time: 1301.3572s
	iters: 200, epoch: 17 | loss: 0.0004481
	speed: 0.0101s/iter; left time: 347.8193s
	iters: 300, epoch: 17 | loss: 0.0008406
	speed: 0.0115s/iter; left time: 395.0667s
	iters: 400, epoch: 17 | loss: 0.0282569
	speed: 0.0117s/iter; left time: 401.6404s
Epoch: 17 cost time: 4.815756559371948
Epoch: 17, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.966 Test Loss: 0.187 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 18 | loss: 0.0000758
	speed: 0.0392s/iter; left time: 1339.8498s
	iters: 200, epoch: 18 | loss: 0.0000420
	speed: 0.0113s/iter; left time: 386.6157s
	iters: 300, epoch: 18 | loss: 0.0000063
	speed: 0.0121s/iter; left time: 412.6923s
	iters: 400, epoch: 18 | loss: 0.0003117
	speed: 0.0121s/iter; left time: 408.9472s
Epoch: 18 cost time: 5.1422951221466064
Epoch: 18, Steps: 413 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.972259 --> -0.972713).  Saving model ...
	iters: 100, epoch: 19 | loss: 0.0003056
	speed: 0.0521s/iter; left time: 1758.5242s
	iters: 200, epoch: 19 | loss: 0.0001729
	speed: 0.0118s/iter; left time: 398.5648s
	iters: 300, epoch: 19 | loss: 0.0000344
	speed: 0.0105s/iter; left time: 351.1948s
	iters: 400, epoch: 19 | loss: 0.0000055
	speed: 0.0120s/iter; left time: 401.9304s
Epoch: 19 cost time: 5.10334849357605
Epoch: 19, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.964 Test Loss: 0.234 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 20 | loss: 0.0004246
	speed: 0.0513s/iter; left time: 1712.3397s
	iters: 200, epoch: 20 | loss: 0.0007985
	speed: 0.0116s/iter; left time: 384.8802s
	iters: 300, epoch: 20 | loss: 0.0170791
	speed: 0.0115s/iter; left time: 380.2081s
	iters: 400, epoch: 20 | loss: 0.0000092
	speed: 0.0117s/iter; left time: 385.2187s
Epoch: 20 cost time: 5.315247058868408
Epoch: 20, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.968 Test Loss: 0.202 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 21 | loss: 0.0348869
	speed: 0.0421s/iter; left time: 1385.1843s
	iters: 200, epoch: 21 | loss: 0.0003062
	speed: 0.0103s/iter; left time: 338.5141s
	iters: 300, epoch: 21 | loss: 0.0025622
	speed: 0.0100s/iter; left time: 327.2917s
	iters: 400, epoch: 21 | loss: 0.0056433
	speed: 0.0105s/iter; left time: 343.6854s
Epoch: 21 cost time: 4.616555690765381
Epoch: 21, Steps: 413 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.970 Test Loss: 0.244 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 22 | loss: 0.0000235
	speed: 0.0359s/iter; left time: 1167.6043s
	iters: 200, epoch: 22 | loss: 0.0044865
	speed: 0.0100s/iter; left time: 324.4966s
	iters: 300, epoch: 22 | loss: 0.0000646
	speed: 0.0104s/iter; left time: 335.8877s
	iters: 400, epoch: 22 | loss: 0.0024187
	speed: 0.0105s/iter; left time: 339.9096s
Epoch: 22 cost time: 4.580822467803955
Epoch: 22, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
Validation loss decreased (-0.972713 --> -0.974077).  Saving model ...
	iters: 100, epoch: 23 | loss: 0.0001879
	speed: 0.0355s/iter; left time: 1141.5808s
	iters: 200, epoch: 23 | loss: 0.0000313
	speed: 0.0102s/iter; left time: 325.4651s
	iters: 300, epoch: 23 | loss: 0.0003015
	speed: 0.0110s/iter; left time: 350.2732s
	iters: 400, epoch: 23 | loss: 0.0002104
	speed: 0.0112s/iter; left time: 356.0656s
Epoch: 23 cost time: 4.676619291305542
Epoch: 23, Steps: 413 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
Validation loss decreased (-0.974077 --> -0.974077).  Saving model ...
	iters: 100, epoch: 24 | loss: 0.0000512
	speed: 0.0385s/iter; left time: 1220.0952s
	iters: 200, epoch: 24 | loss: 0.0000105
	speed: 0.0123s/iter; left time: 387.5455s
	iters: 300, epoch: 24 | loss: 0.0000035
	speed: 0.0126s/iter; left time: 396.2695s
	iters: 400, epoch: 24 | loss: 0.0000154
	speed: 0.0126s/iter; left time: 394.2021s
Epoch: 24 cost time: 5.530703067779541
Epoch: 24, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.974077 --> -0.975442).  Saving model ...
	iters: 100, epoch: 25 | loss: 0.0000001
	speed: 0.0545s/iter; left time: 1706.7257s
	iters: 200, epoch: 25 | loss: 0.0000740
	speed: 0.0122s/iter; left time: 381.4020s
	iters: 300, epoch: 25 | loss: 0.0000040
	speed: 0.0129s/iter; left time: 401.1596s
	iters: 400, epoch: 25 | loss: 0.0001044
	speed: 0.0132s/iter; left time: 408.8875s
Epoch: 25 cost time: 5.800175666809082
Epoch: 25, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 26 | loss: 0.0000013
	speed: 0.0511s/iter; left time: 1577.8268s
	iters: 200, epoch: 26 | loss: 0.0000031
	speed: 0.0132s/iter; left time: 406.5619s
	iters: 300, epoch: 26 | loss: 0.0000238
	speed: 0.0119s/iter; left time: 365.7447s
	iters: 400, epoch: 26 | loss: 0.0000109
	speed: 0.0118s/iter; left time: 361.9371s
Epoch: 26 cost time: 5.446731328964233
Epoch: 26, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
Validation loss decreased (-0.975442 --> -0.975896).  Saving model ...
	iters: 100, epoch: 27 | loss: 0.0000084
	speed: 0.0430s/iter; left time: 1309.3377s
	iters: 200, epoch: 27 | loss: 0.0001281
	speed: 0.0116s/iter; left time: 351.0592s
	iters: 300, epoch: 27 | loss: 0.0000867
	speed: 0.0112s/iter; left time: 338.6606s
	iters: 400, epoch: 27 | loss: 0.0000393
	speed: 0.0119s/iter; left time: 360.3315s
Epoch: 27 cost time: 5.127121925354004
Epoch: 27, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
Validation loss decreased (-0.975896 --> -0.976351).  Saving model ...
	iters: 100, epoch: 28 | loss: 0.0000110
	speed: 0.0407s/iter; left time: 1224.2645s
	iters: 200, epoch: 28 | loss: 0.0000033
	speed: 0.0121s/iter; left time: 362.3879s
	iters: 300, epoch: 28 | loss: 0.0000001
	speed: 0.0119s/iter; left time: 354.5788s
	iters: 400, epoch: 28 | loss: 0.0000087
	speed: 0.0103s/iter; left time: 306.0125s
Epoch: 28 cost time: 4.88386869430542
Epoch: 28, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 29 | loss: 0.0002943
	speed: 0.0372s/iter; left time: 1103.2802s
	iters: 200, epoch: 29 | loss: 0.0000065
	speed: 0.0118s/iter; left time: 349.0316s
	iters: 300, epoch: 29 | loss: 0.0001456
	speed: 0.0112s/iter; left time: 330.0972s
	iters: 400, epoch: 29 | loss: 0.0000273
	speed: 0.0113s/iter; left time: 332.2258s
Epoch: 29 cost time: 4.998513221740723
Epoch: 29, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 30 | loss: 0.0000072
	speed: 0.0495s/iter; left time: 1446.1775s
	iters: 200, epoch: 30 | loss: 0.0000008
	speed: 0.0119s/iter; left time: 346.1516s
	iters: 300, epoch: 30 | loss: 0.0000037
	speed: 0.0117s/iter; left time: 339.2302s
	iters: 400, epoch: 30 | loss: 0.0000167
	speed: 0.0119s/iter; left time: 343.8172s
Epoch: 30 cost time: 5.162919998168945
Epoch: 30, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.976 Test Loss: 0.176 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 31 | loss: 0.0000179
	speed: 0.0410s/iter; left time: 1182.2111s
	iters: 200, epoch: 31 | loss: 0.0000002
	speed: 0.0123s/iter; left time: 353.3291s
	iters: 300, epoch: 31 | loss: 0.0000009
	speed: 0.0118s/iter; left time: 337.2404s
	iters: 400, epoch: 31 | loss: 0.0001782
	speed: 0.0114s/iter; left time: 326.3147s
Epoch: 31 cost time: 5.20251202583313
Epoch: 31, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.975 Test Loss: 0.178 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 32 | loss: 0.0000005
	speed: 0.0489s/iter; left time: 1389.3230s
	iters: 200, epoch: 32 | loss: 0.0000014
	speed: 0.0116s/iter; left time: 329.5985s
	iters: 300, epoch: 32 | loss: 0.0000524
	speed: 0.0109s/iter; left time: 307.9461s
	iters: 400, epoch: 32 | loss: 0.0000059
	speed: 0.0105s/iter; left time: 296.0690s
Epoch: 32 cost time: 4.958349943161011
Epoch: 32, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 33 | loss: 0.0000480
	speed: 0.0408s/iter; left time: 1143.1398s
	iters: 200, epoch: 33 | loss: 0.0000014
	speed: 0.0107s/iter; left time: 298.0764s
	iters: 300, epoch: 33 | loss: 0.0000014
	speed: 0.0105s/iter; left time: 292.7210s
	iters: 400, epoch: 33 | loss: 0.0000211
	speed: 0.0107s/iter; left time: 295.5756s
Epoch: 33 cost time: 4.746459484100342
Epoch: 33, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.975 Test Loss: 0.175 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 34 | loss: 0.0000004
	speed: 0.0390s/iter; left time: 1075.6769s
	iters: 200, epoch: 34 | loss: 0.0000037
	speed: 0.0100s/iter; left time: 274.5692s
	iters: 300, epoch: 34 | loss: 0.0000017
	speed: 0.0100s/iter; left time: 272.4918s
	iters: 400, epoch: 34 | loss: 0.0000552
	speed: 0.0100s/iter; left time: 274.0596s
Epoch: 34 cost time: 4.4953248500823975
Epoch: 34, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 35 | loss: 0.0000013
	speed: 0.0384s/iter; left time: 1044.0873s
	iters: 200, epoch: 35 | loss: 0.0000523
	speed: 0.0106s/iter; left time: 287.6983s
	iters: 300, epoch: 35 | loss: 0.0000105
	speed: 0.0102s/iter; left time: 274.6116s
	iters: 400, epoch: 35 | loss: 0.0000140
	speed: 0.0117s/iter; left time: 313.2915s
Epoch: 35 cost time: 4.771308660507202
Epoch: 35, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 36 | loss: 0.0000042
	speed: 0.0465s/iter; left time: 1243.5345s
	iters: 200, epoch: 36 | loss: 0.0000134
	speed: 0.0115s/iter; left time: 306.7951s
	iters: 300, epoch: 36 | loss: 0.0000001
	speed: 0.0115s/iter; left time: 306.3043s
	iters: 400, epoch: 36 | loss: 0.0000019
	speed: 0.0115s/iter; left time: 305.3499s
Epoch: 36 cost time: 5.1235692501068115
Epoch: 36, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.974 Test Loss: 0.173 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 37 | loss: 0.0000110
	speed: 0.0441s/iter; left time: 1160.7242s
	iters: 200, epoch: 37 | loss: 0.0000076
	speed: 0.0112s/iter; left time: 292.7620s
	iters: 300, epoch: 37 | loss: 0.0000004
	speed: 0.0114s/iter; left time: 298.3322s
	iters: 400, epoch: 37 | loss: 0.0000468
	speed: 0.0116s/iter; left time: 301.4379s
Epoch: 37 cost time: 5.0896594524383545
Epoch: 37, Steps: 413 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9763528876762164
model parameter : 22674
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3112426
	speed: 0.0224s/iter; left time: 924.9210s
	iters: 200, epoch: 1 | loss: 0.4620060
	speed: 0.0107s/iter; left time: 440.1867s
	iters: 300, epoch: 1 | loss: 0.7034979
	speed: 0.0106s/iter; left time: 432.7029s
	iters: 400, epoch: 1 | loss: 0.3747772
	speed: 0.0109s/iter; left time: 446.9480s
Epoch: 1 cost time: 5.648319959640503
Epoch: 1, Steps: 413 | Train Loss: 0.800 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
Validation loss decreased (inf --> -0.959071).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1371101
	speed: 0.0384s/iter; left time: 1568.0199s
	iters: 200, epoch: 2 | loss: 0.1855959
	speed: 0.0103s/iter; left time: 417.4433s
	iters: 300, epoch: 2 | loss: 0.1090180
	speed: 0.0104s/iter; left time: 420.6012s
	iters: 400, epoch: 2 | loss: 0.1973208
	speed: 0.0119s/iter; left time: 482.7031s
Epoch: 2 cost time: 4.743239879608154
Epoch: 2, Steps: 413 | Train Loss: 0.129 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
Validation loss decreased (-0.959071 --> -0.962254).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0732813
	speed: 0.0463s/iter; left time: 1867.9163s
	iters: 200, epoch: 3 | loss: 0.0366152
	speed: 0.0121s/iter; left time: 485.6458s
	iters: 300, epoch: 3 | loss: 0.0207289
	speed: 0.0117s/iter; left time: 471.0454s
	iters: 400, epoch: 3 | loss: 0.0017933
	speed: 0.0107s/iter; left time: 427.9413s
Epoch: 3 cost time: 5.099682569503784
Epoch: 3, Steps: 413 | Train Loss: 0.086 Vali Loss: 0.097 Vali Acc: 0.970 Test Loss: 0.097 Test Acc: 0.970
Validation loss decreased (-0.962254 --> -0.969985).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.0271653
	speed: 0.0431s/iter; left time: 1721.2202s
	iters: 200, epoch: 4 | loss: 0.0166351
	speed: 0.0106s/iter; left time: 422.8732s
	iters: 300, epoch: 4 | loss: 0.0722762
	speed: 0.0110s/iter; left time: 438.1331s
	iters: 400, epoch: 4 | loss: 0.0247789
	speed: 0.0114s/iter; left time: 452.6685s
Epoch: 4 cost time: 5.019046306610107
Epoch: 4, Steps: 413 | Train Loss: 0.066 Vali Loss: 0.091 Vali Acc: 0.970 Test Loss: 0.091 Test Acc: 0.970
Validation loss decreased (-0.969985 --> -0.970440).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.0054783
	speed: 0.0457s/iter; left time: 1806.6989s
	iters: 200, epoch: 5 | loss: 0.0029862
	speed: 0.0099s/iter; left time: 389.9789s
	iters: 300, epoch: 5 | loss: 0.0208227
	speed: 0.0097s/iter; left time: 380.3693s
	iters: 400, epoch: 5 | loss: 0.0549972
	speed: 0.0095s/iter; left time: 371.8329s
Epoch: 5 cost time: 4.426582336425781
Epoch: 5, Steps: 413 | Train Loss: 0.056 Vali Loss: 0.098 Vali Acc: 0.965 Test Loss: 0.098 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 6 | loss: 0.0050328
	speed: 0.0393s/iter; left time: 1538.8626s
	iters: 200, epoch: 6 | loss: 0.0015188
	speed: 0.0104s/iter; left time: 407.6908s
	iters: 300, epoch: 6 | loss: 0.0288304
	speed: 0.0108s/iter; left time: 421.0373s
	iters: 400, epoch: 6 | loss: 0.1317507
	speed: 0.0108s/iter; left time: 419.1815s
Epoch: 6 cost time: 4.791767358779907
Epoch: 6, Steps: 413 | Train Loss: 0.045 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 7 | loss: 0.0205098
	speed: 0.0396s/iter; left time: 1535.2961s
	iters: 200, epoch: 7 | loss: 0.0044418
	speed: 0.0104s/iter; left time: 400.4157s
	iters: 300, epoch: 7 | loss: 0.0059898
	speed: 0.0105s/iter; left time: 403.3744s
	iters: 400, epoch: 7 | loss: 0.1689264
	speed: 0.0102s/iter; left time: 390.8223s
Epoch: 7 cost time: 4.659899473190308
Epoch: 7, Steps: 413 | Train Loss: 0.038 Vali Loss: 0.102 Vali Acc: 0.972 Test Loss: 0.102 Test Acc: 0.972
Validation loss decreased (-0.970440 --> -0.971804).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.0000766
	speed: 0.0388s/iter; left time: 1484.9526s
	iters: 200, epoch: 8 | loss: 0.0289305
	speed: 0.0109s/iter; left time: 416.2293s
	iters: 300, epoch: 8 | loss: 0.2539497
	speed: 0.0112s/iter; left time: 425.7819s
	iters: 400, epoch: 8 | loss: 0.0384224
	speed: 0.0113s/iter; left time: 428.6581s
Epoch: 8 cost time: 4.723229885101318
Epoch: 8, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.955 Test Loss: 0.170 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 9 | loss: 0.0830797
	speed: 0.0488s/iter; left time: 1847.8871s
	iters: 200, epoch: 9 | loss: 0.0021433
	speed: 0.0112s/iter; left time: 422.8329s
	iters: 300, epoch: 9 | loss: 0.0107698
	speed: 0.0113s/iter; left time: 425.3436s
	iters: 400, epoch: 9 | loss: 0.0006358
	speed: 0.0106s/iter; left time: 398.1670s
Epoch: 9 cost time: 4.88715934753418
Epoch: 9, Steps: 413 | Train Loss: 0.034 Vali Loss: 0.112 Vali Acc: 0.966 Test Loss: 0.112 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 10 | loss: 0.0001937
	speed: 0.0453s/iter; left time: 1696.3462s
	iters: 200, epoch: 10 | loss: 0.0619389
	speed: 0.0117s/iter; left time: 438.9465s
	iters: 300, epoch: 10 | loss: 0.0009564
	speed: 0.0116s/iter; left time: 431.5695s
	iters: 400, epoch: 10 | loss: 0.0001515
	speed: 0.0116s/iter; left time: 432.0067s
Epoch: 10 cost time: 5.123013973236084
Epoch: 10, Steps: 413 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 11 | loss: 0.0190816
	speed: 0.0418s/iter; left time: 1550.2359s
	iters: 200, epoch: 11 | loss: 0.0127779
	speed: 0.0098s/iter; left time: 363.9178s
	iters: 300, epoch: 11 | loss: 0.0774193
	speed: 0.0103s/iter; left time: 378.8911s
	iters: 400, epoch: 11 | loss: 0.0026439
	speed: 0.0102s/iter; left time: 375.3006s
Epoch: 11 cost time: 4.512402534484863
Epoch: 11, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.135 Vali Acc: 0.959 Test Loss: 0.135 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 12 | loss: 0.0008409
	speed: 0.0359s/iter; left time: 1314.8478s
	iters: 200, epoch: 12 | loss: 0.0082698
	speed: 0.0105s/iter; left time: 383.0051s
	iters: 300, epoch: 12 | loss: 0.0038893
	speed: 0.0102s/iter; left time: 370.3446s
	iters: 400, epoch: 12 | loss: 0.0341903
	speed: 0.0102s/iter; left time: 370.7085s
Epoch: 12 cost time: 4.527774333953857
Epoch: 12, Steps: 413 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 13 | loss: 0.0026095
	speed: 0.0353s/iter; left time: 1279.4882s
	iters: 200, epoch: 13 | loss: 0.0010124
	speed: 0.0104s/iter; left time: 376.2451s
	iters: 300, epoch: 13 | loss: 0.0002304
	speed: 0.0103s/iter; left time: 371.1109s
	iters: 400, epoch: 13 | loss: 0.0761452
	speed: 0.0106s/iter; left time: 381.5715s
Epoch: 13 cost time: 4.559292793273926
Epoch: 13, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 14 | loss: 0.0000959
	speed: 0.0377s/iter; left time: 1351.0868s
	iters: 200, epoch: 14 | loss: 0.0000758
	speed: 0.0109s/iter; left time: 387.9229s
	iters: 300, epoch: 14 | loss: 0.0010072
	speed: 0.0108s/iter; left time: 383.8021s
	iters: 400, epoch: 14 | loss: 0.0000253
	speed: 0.0116s/iter; left time: 412.2737s
Epoch: 14 cost time: 4.926810264587402
Epoch: 14, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.965 Test Loss: 0.166 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 15 | loss: 0.0014052
	speed: 0.0486s/iter; left time: 1722.9597s
	iters: 200, epoch: 15 | loss: 0.0002791
	speed: 0.0108s/iter; left time: 382.7193s
	iters: 300, epoch: 15 | loss: 0.0131277
	speed: 0.0119s/iter; left time: 419.0819s
	iters: 400, epoch: 15 | loss: 0.0002967
	speed: 0.0116s/iter; left time: 409.0058s
Epoch: 15 cost time: 5.113006591796875
Epoch: 15, Steps: 413 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 16 | loss: 0.0017308
	speed: 0.0493s/iter; left time: 1724.9633s
	iters: 200, epoch: 16 | loss: 0.0000055
	speed: 0.0114s/iter; left time: 398.9295s
	iters: 300, epoch: 16 | loss: 0.0000009
	speed: 0.0109s/iter; left time: 380.0341s
	iters: 400, epoch: 16 | loss: 0.0064919
	speed: 0.0105s/iter; left time: 363.5457s
Epoch: 16 cost time: 5.054409980773926
Epoch: 16, Steps: 413 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 17 | loss: 0.0001011
	speed: 0.0361s/iter; left time: 1247.1128s
	iters: 200, epoch: 17 | loss: 0.0000020
	speed: 0.0103s/iter; left time: 354.7993s
	iters: 300, epoch: 17 | loss: 0.0000953
	speed: 0.0101s/iter; left time: 346.6964s
	iters: 400, epoch: 17 | loss: 0.0012140
	speed: 0.0109s/iter; left time: 373.0798s
Epoch: 17 cost time: 4.549855709075928
Epoch: 17, Steps: 413 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9718053660754888
model parameter : 22956
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.3807437
	speed: 0.0247s/iter; left time: 1016.5730s
	iters: 200, epoch: 1 | loss: 0.7360592
	speed: 0.0118s/iter; left time: 485.5440s
	iters: 300, epoch: 1 | loss: 0.6351354
	speed: 0.0120s/iter; left time: 493.6919s
	iters: 400, epoch: 1 | loss: 0.2393190
	speed: 0.0119s/iter; left time: 486.3652s
Epoch: 1 cost time: 6.263876914978027
Epoch: 1, Steps: 413 | Train Loss: 0.758 Vali Loss: 0.143 Vali Acc: 0.955 Test Loss: 0.143 Test Acc: 0.955
Validation loss decreased (inf --> -0.954978).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1203916
	speed: 0.0457s/iter; left time: 1865.0432s
	iters: 200, epoch: 2 | loss: 0.0885420
	speed: 0.0125s/iter; left time: 507.4198s
	iters: 300, epoch: 2 | loss: 0.0489602
	speed: 0.0125s/iter; left time: 508.0179s
	iters: 400, epoch: 2 | loss: 0.0382597
	speed: 0.0130s/iter; left time: 524.6414s
Epoch: 2 cost time: 5.5443055629730225
Epoch: 2, Steps: 413 | Train Loss: 0.121 Vali Loss: 0.099 Vali Acc: 0.969 Test Loss: 0.099 Test Acc: 0.969
Validation loss decreased (-0.954978 --> -0.968621).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2342463
	speed: 0.0544s/iter; left time: 2198.3152s
	iters: 200, epoch: 3 | loss: 0.0522708
	speed: 0.0119s/iter; left time: 480.2365s
	iters: 300, epoch: 3 | loss: 0.1743042
	speed: 0.0100s/iter; left time: 400.5279s
	iters: 400, epoch: 3 | loss: 0.4372602
	speed: 0.0114s/iter; left time: 455.2073s
Epoch: 3 cost time: 5.092432975769043
Epoch: 3, Steps: 413 | Train Loss: 0.070 Vali Loss: 0.106 Vali Acc: 0.962 Test Loss: 0.106 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0714255
	speed: 0.0365s/iter; left time: 1457.2796s
	iters: 200, epoch: 4 | loss: 0.0087179
	speed: 0.0110s/iter; left time: 438.2306s
	iters: 300, epoch: 4 | loss: 0.0051546
	speed: 0.0100s/iter; left time: 396.1625s
	iters: 400, epoch: 4 | loss: 0.0620624
	speed: 0.0107s/iter; left time: 423.2288s
Epoch: 4 cost time: 4.783999681472778
Epoch: 4, Steps: 413 | Train Loss: 0.054 Vali Loss: 0.102 Vali Acc: 0.966 Test Loss: 0.102 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0949939
	speed: 0.0368s/iter; left time: 1454.1720s
	iters: 200, epoch: 5 | loss: 0.0024038
	speed: 0.0102s/iter; left time: 403.5032s
	iters: 300, epoch: 5 | loss: 0.0612607
	speed: 0.0108s/iter; left time: 424.0762s
	iters: 400, epoch: 5 | loss: 0.0285696
	speed: 0.0109s/iter; left time: 426.9827s
Epoch: 5 cost time: 4.669442176818848
Epoch: 5, Steps: 413 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 6 | loss: 0.0006945
	speed: 0.0369s/iter; left time: 1444.2334s
	iters: 200, epoch: 6 | loss: 0.0035198
	speed: 0.0102s/iter; left time: 399.5028s
	iters: 300, epoch: 6 | loss: 0.0139464
	speed: 0.0118s/iter; left time: 457.8580s
	iters: 400, epoch: 6 | loss: 0.0067893
	speed: 0.0120s/iter; left time: 464.2682s
Epoch: 6 cost time: 4.842130422592163
Epoch: 6, Steps: 413 | Train Loss: 0.035 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 7 | loss: 0.0753782
	speed: 0.0501s/iter; left time: 1941.7004s
	iters: 200, epoch: 7 | loss: 0.0005608
	speed: 0.0119s/iter; left time: 459.9063s
	iters: 300, epoch: 7 | loss: 0.0511931
	speed: 0.0119s/iter; left time: 458.9032s
	iters: 400, epoch: 7 | loss: 0.0245466
	speed: 0.0127s/iter; left time: 486.3112s
Epoch: 7 cost time: 5.395669937133789
Epoch: 7, Steps: 413 | Train Loss: 0.030 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 8 | loss: 0.0000561
	speed: 0.0506s/iter; left time: 1938.7973s
	iters: 200, epoch: 8 | loss: 0.0008132
	speed: 0.0126s/iter; left time: 481.6024s
	iters: 300, epoch: 8 | loss: 0.0006888
	speed: 0.0142s/iter; left time: 539.9747s
	iters: 400, epoch: 8 | loss: 0.0071418
	speed: 0.0129s/iter; left time: 490.0428s
Epoch: 8 cost time: 5.805498361587524
Epoch: 8, Steps: 413 | Train Loss: 0.023 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 9 | loss: 0.0014284
	speed: 0.0499s/iter; left time: 1891.3711s
	iters: 200, epoch: 9 | loss: 0.0098878
	speed: 0.0104s/iter; left time: 393.9731s
	iters: 300, epoch: 9 | loss: 0.0094816
	speed: 0.0101s/iter; left time: 382.2984s
	iters: 400, epoch: 9 | loss: 0.0028638
	speed: 0.0100s/iter; left time: 377.3264s
Epoch: 9 cost time: 4.653006553649902
Epoch: 9, Steps: 413 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.958 Test Loss: 0.154 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 10 | loss: 0.0002363
	speed: 0.0379s/iter; left time: 1420.3736s
	iters: 200, epoch: 10 | loss: 0.1365643
	speed: 0.0107s/iter; left time: 401.8253s
	iters: 300, epoch: 10 | loss: 0.0009461
	speed: 0.0102s/iter; left time: 381.7800s
	iters: 400, epoch: 10 | loss: 0.0000834
	speed: 0.0107s/iter; left time: 397.4159s
Epoch: 10 cost time: 4.688712120056152
Epoch: 10, Steps: 413 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 11 | loss: 0.0022655
	speed: 0.0380s/iter; left time: 1408.0020s
	iters: 200, epoch: 11 | loss: 0.0033069
	speed: 0.0127s/iter; left time: 468.4521s
	iters: 300, epoch: 11 | loss: 0.0896323
	speed: 0.0101s/iter; left time: 372.2375s
	iters: 400, epoch: 11 | loss: 0.0052589
	speed: 0.0107s/iter; left time: 392.7795s
Epoch: 11 cost time: 4.7092273235321045
Epoch: 11, Steps: 413 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 12 | loss: 0.0792566
	speed: 0.0407s/iter; left time: 1492.0107s
	iters: 200, epoch: 12 | loss: 0.0156303
	speed: 0.0114s/iter; left time: 416.9254s
	iters: 300, epoch: 12 | loss: 0.0003368
	speed: 0.0107s/iter; left time: 390.9295s
	iters: 400, epoch: 12 | loss: 0.0001036
	speed: 0.0122s/iter; left time: 444.8680s
Epoch: 12 cost time: 5.077249526977539
Epoch: 12, Steps: 413 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9686221009549796
model parameter : 22882
model size : 0.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_SpokenArabicDigitsModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/SpokenArabicDigits/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             13                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

6599
2199
>>>>>>>start training : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
6599
2199
2199
	iters: 100, epoch: 1 | loss: 1.1506193
	speed: 0.0255s/iter; left time: 1049.9357s
	iters: 200, epoch: 1 | loss: 0.5490474
	speed: 0.0122s/iter; left time: 500.2350s
	iters: 300, epoch: 1 | loss: 0.1094640
	speed: 0.0121s/iter; left time: 495.7234s
	iters: 400, epoch: 1 | loss: 0.1967484
	speed: 0.0107s/iter; left time: 439.4663s
Epoch: 1 cost time: 6.229391098022461
Epoch: 1, Steps: 413 | Train Loss: 0.780 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (inf --> -0.955887).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2146650
	speed: 0.0382s/iter; left time: 1559.8597s
	iters: 200, epoch: 2 | loss: 0.1769778
	speed: 0.0103s/iter; left time: 419.3877s
	iters: 300, epoch: 2 | loss: 0.1126247
	speed: 0.0104s/iter; left time: 422.1289s
	iters: 400, epoch: 2 | loss: 0.2423599
	speed: 0.0101s/iter; left time: 408.3938s
Epoch: 2 cost time: 4.587190389633179
Epoch: 2, Steps: 413 | Train Loss: 0.126 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
Validation loss decreased (-0.955887 --> -0.969531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0459970
	speed: 0.0395s/iter; left time: 1595.3361s
	iters: 200, epoch: 3 | loss: 0.0826966
	speed: 0.0101s/iter; left time: 406.2972s
	iters: 300, epoch: 3 | loss: 0.0196057
	speed: 0.0108s/iter; left time: 434.5872s
	iters: 400, epoch: 3 | loss: 0.0067348
	speed: 0.0104s/iter; left time: 418.0587s
Epoch: 3 cost time: 4.606104373931885
Epoch: 3, Steps: 413 | Train Loss: 0.084 Vali Loss: 0.101 Vali Acc: 0.961 Test Loss: 0.101 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 4 | loss: 0.0066134
	speed: 0.0408s/iter; left time: 1632.3382s
	iters: 200, epoch: 4 | loss: 0.0073320
	speed: 0.0104s/iter; left time: 415.8021s
	iters: 300, epoch: 4 | loss: 0.0117932
	speed: 0.0104s/iter; left time: 415.1614s
	iters: 400, epoch: 4 | loss: 0.1259067
	speed: 0.0108s/iter; left time: 426.9382s
Epoch: 4 cost time: 4.81441330909729
Epoch: 4, Steps: 413 | Train Loss: 0.064 Vali Loss: 0.112 Vali Acc: 0.964 Test Loss: 0.112 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 5 | loss: 0.0067259
	speed: 0.0489s/iter; left time: 1934.5535s
	iters: 200, epoch: 5 | loss: 0.0129265
	speed: 0.0123s/iter; left time: 485.3737s
	iters: 300, epoch: 5 | loss: 0.0680578
	speed: 0.0121s/iter; left time: 474.6808s
	iters: 400, epoch: 5 | loss: 0.0081016
	speed: 0.0123s/iter; left time: 481.5327s
Epoch: 5 cost time: 5.384454727172852
Epoch: 5, Steps: 413 | Train Loss: 0.049 Vali Loss: 0.085 Vali Acc: 0.974 Test Loss: 0.085 Test Acc: 0.974
Validation loss decreased (-0.969531 --> -0.974078).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0045598
	speed: 0.0471s/iter; left time: 1841.7714s
	iters: 200, epoch: 6 | loss: 0.0015940
	speed: 0.0127s/iter; left time: 496.2928s
	iters: 300, epoch: 6 | loss: 0.0001609
	speed: 0.0128s/iter; left time: 499.8576s
	iters: 400, epoch: 6 | loss: 0.1557715
	speed: 0.0119s/iter; left time: 461.5862s
Epoch: 6 cost time: 5.345015287399292
Epoch: 6, Steps: 413 | Train Loss: 0.037 Vali Loss: 0.085 Vali Acc: 0.969 Test Loss: 0.085 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
	iters: 100, epoch: 7 | loss: 0.0028667
	speed: 0.0518s/iter; left time: 2006.7663s
	iters: 200, epoch: 7 | loss: 0.0008149
	speed: 0.0124s/iter; left time: 478.7072s
	iters: 300, epoch: 7 | loss: 0.0024457
	speed: 0.0108s/iter; left time: 414.9875s
	iters: 400, epoch: 7 | loss: 0.7674318
	speed: 0.0107s/iter; left time: 410.9943s
Epoch: 7 cost time: 5.139630079269409
Epoch: 7, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.099 Vali Acc: 0.972 Test Loss: 0.099 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
	iters: 100, epoch: 8 | loss: 0.0187954
	speed: 0.0416s/iter; left time: 1594.5193s
	iters: 200, epoch: 8 | loss: 0.0035747
	speed: 0.0110s/iter; left time: 418.4494s
	iters: 300, epoch: 8 | loss: 0.0356953
	speed: 0.0112s/iter; left time: 426.0270s
	iters: 400, epoch: 8 | loss: 0.0004233
	speed: 0.0106s/iter; left time: 404.5168s
Epoch: 8 cost time: 4.879862308502197
Epoch: 8, Steps: 413 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
	iters: 100, epoch: 9 | loss: 0.0005311
	speed: 0.0395s/iter; left time: 1497.2613s
	iters: 200, epoch: 9 | loss: 0.0446527
	speed: 0.0102s/iter; left time: 387.1875s
	iters: 300, epoch: 9 | loss: 0.0160135
	speed: 0.0109s/iter; left time: 410.0705s
	iters: 400, epoch: 9 | loss: 0.0075030
	speed: 0.0106s/iter; left time: 399.5639s
Epoch: 9 cost time: 4.648926019668579
Epoch: 9, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.100 Vali Acc: 0.970 Test Loss: 0.100 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
	iters: 100, epoch: 10 | loss: 0.0000395
	speed: 0.0362s/iter; left time: 1356.7948s
	iters: 200, epoch: 10 | loss: 0.0022549
	speed: 0.0098s/iter; left time: 366.6949s
	iters: 300, epoch: 10 | loss: 0.0005747
	speed: 0.0096s/iter; left time: 359.6224s
	iters: 400, epoch: 10 | loss: 0.0326221
	speed: 0.0108s/iter; left time: 399.9229s
Epoch: 10 cost time: 4.474885702133179
Epoch: 10, Steps: 413 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
	iters: 100, epoch: 11 | loss: 0.0074408
	speed: 0.0449s/iter; left time: 1666.2742s
	iters: 200, epoch: 11 | loss: 0.0010197
	speed: 0.0107s/iter; left time: 395.7375s
	iters: 300, epoch: 11 | loss: 0.0001364
	speed: 0.0111s/iter; left time: 407.8338s
	iters: 400, epoch: 11 | loss: 0.0003593
	speed: 0.0110s/iter; left time: 404.8618s
Epoch: 11 cost time: 4.808940649032593
Epoch: 11, Steps: 413 | Train Loss: 0.018 Vali Loss: 0.189 Vali Acc: 0.959 Test Loss: 0.189 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
	iters: 100, epoch: 12 | loss: 0.0000604
	speed: 0.0456s/iter; left time: 1670.5524s
	iters: 200, epoch: 12 | loss: 0.0013282
	speed: 0.0109s/iter; left time: 398.2800s
	iters: 300, epoch: 12 | loss: 0.0083080
	speed: 0.0106s/iter; left time: 386.3052s
	iters: 400, epoch: 12 | loss: 0.0014989
	speed: 0.0109s/iter; left time: 396.0552s
Epoch: 12 cost time: 4.795435428619385
Epoch: 12, Steps: 413 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
	iters: 100, epoch: 13 | loss: 0.0273462
	speed: 0.0383s/iter; left time: 1389.6944s
	iters: 200, epoch: 13 | loss: 0.0009157
	speed: 0.0131s/iter; left time: 473.0810s
	iters: 300, epoch: 13 | loss: 0.0002383
	speed: 0.0107s/iter; left time: 385.2622s
	iters: 400, epoch: 13 | loss: 0.0000315
	speed: 0.0107s/iter; left time: 385.9898s
Epoch: 13 cost time: 4.98711085319519
Epoch: 13, Steps: 413 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
	iters: 100, epoch: 14 | loss: 0.0003243
	speed: 0.0439s/iter; left time: 1571.3743s
	iters: 200, epoch: 14 | loss: 0.0030114
	speed: 0.0100s/iter; left time: 356.9445s
	iters: 300, epoch: 14 | loss: 0.0002448
	speed: 0.0103s/iter; left time: 368.5320s
	iters: 400, epoch: 14 | loss: 0.0000142
	speed: 0.0105s/iter; left time: 371.9220s
Epoch: 14 cost time: 4.641951560974121
Epoch: 14, Steps: 413 | Train Loss: 0.009 Vali Loss: 0.230 Vali Acc: 0.963 Test Loss: 0.230 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
	iters: 100, epoch: 15 | loss: 0.0005562
	speed: 0.0365s/iter; left time: 1293.7271s
	iters: 200, epoch: 15 | loss: 0.0080768
	speed: 0.0103s/iter; left time: 365.2467s
	iters: 300, epoch: 15 | loss: 0.0001999
	speed: 0.0096s/iter; left time: 338.6181s
	iters: 400, epoch: 15 | loss: 0.0000702
	speed: 0.0099s/iter; left time: 348.5718s
Epoch: 15 cost time: 4.478470802307129
Epoch: 15, Steps: 413 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_SpokenArabicDigits_LightTS_UEA_ftM_sl93_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
2199
test shape: torch.Size([2199, 10]) torch.Size([2199, 1])
accuracy:0.9740791268758526
model parameter : 22995
model size : 0.10MB
