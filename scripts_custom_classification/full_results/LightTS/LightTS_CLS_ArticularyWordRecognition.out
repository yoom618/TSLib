Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.6959524154663086
Epoch: 1, Steps: 18 | Train Loss: 3.225 Vali Loss: 3.057 Vali Acc: 0.150 Test Loss: 3.057 Test Acc: 0.150
Validation loss decreased (inf --> -0.149969).  Saving model ...
Epoch: 2 cost time: 0.4971954822540283
Epoch: 2, Steps: 18 | Train Loss: 2.844 Vali Loss: 2.566 Vali Acc: 0.543 Test Loss: 2.566 Test Acc: 0.543
Validation loss decreased (-0.149969 --> -0.543308).  Saving model ...
Epoch: 3 cost time: 0.5344803333282471
Epoch: 3, Steps: 18 | Train Loss: 2.235 Vali Loss: 1.926 Vali Acc: 0.810 Test Loss: 1.926 Test Acc: 0.810
Validation loss decreased (-0.543308 --> -0.809981).  Saving model ...
Epoch: 4 cost time: 0.49193692207336426
Epoch: 4, Steps: 18 | Train Loss: 1.479 Vali Loss: 1.149 Vali Acc: 0.897 Test Loss: 1.149 Test Acc: 0.897
Validation loss decreased (-0.809981 --> -0.896655).  Saving model ...
Epoch: 5 cost time: 0.5175373554229736
Epoch: 5, Steps: 18 | Train Loss: 0.719 Vali Loss: 0.507 Vali Acc: 0.947 Test Loss: 0.507 Test Acc: 0.947
Validation loss decreased (-0.896655 --> -0.946662).  Saving model ...
Epoch: 6 cost time: 0.5007178783416748
Epoch: 6, Steps: 18 | Train Loss: 0.246 Vali Loss: 0.262 Vali Acc: 0.950 Test Loss: 0.262 Test Acc: 0.950
Validation loss decreased (-0.946662 --> -0.949997).  Saving model ...
Epoch: 7 cost time: 0.5146892070770264
Epoch: 7, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.223 Vali Acc: 0.953 Test Loss: 0.223 Test Acc: 0.953
Validation loss decreased (-0.949997 --> -0.953331).  Saving model ...
Epoch: 8 cost time: 0.5492839813232422
Epoch: 8, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.953331 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.4760749340057373
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5721781253814697
Epoch: 10, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4762284755706787
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5143766403198242
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.51131272315979
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.545753002166748
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5294480323791504
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5560877323150635
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6442158222198486
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.610680103302002
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.970 Test Loss: 0.203 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 180405
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7894554138183594
Epoch: 1, Steps: 18 | Train Loss: 3.174 Vali Loss: 3.010 Vali Acc: 0.167 Test Loss: 3.010 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 0.4702420234680176
Epoch: 2, Steps: 18 | Train Loss: 2.823 Vali Loss: 2.561 Vali Acc: 0.547 Test Loss: 2.561 Test Acc: 0.547
Validation loss decreased (-0.166637 --> -0.546641).  Saving model ...
Epoch: 3 cost time: 0.551785945892334
Epoch: 3, Steps: 18 | Train Loss: 2.254 Vali Loss: 1.935 Vali Acc: 0.813 Test Loss: 1.935 Test Acc: 0.813
Validation loss decreased (-0.546641 --> -0.813314).  Saving model ...
Epoch: 4 cost time: 0.5130565166473389
Epoch: 4, Steps: 18 | Train Loss: 1.526 Vali Loss: 1.212 Vali Acc: 0.910 Test Loss: 1.212 Test Acc: 0.910
Validation loss decreased (-0.813314 --> -0.909988).  Saving model ...
Epoch: 5 cost time: 0.577946662902832
Epoch: 5, Steps: 18 | Train Loss: 0.790 Vali Loss: 0.573 Vali Acc: 0.930 Test Loss: 0.573 Test Acc: 0.930
Validation loss decreased (-0.909988 --> -0.929994).  Saving model ...
Epoch: 6 cost time: 0.5154521465301514
Epoch: 6, Steps: 18 | Train Loss: 0.290 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.929994 --> -0.933330).  Saving model ...
Epoch: 7 cost time: 0.698615550994873
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.319 Vali Acc: 0.917 Test Loss: 0.319 Test Acc: 0.917
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5880377292633057
Epoch: 8, Steps: 18 | Train Loss: 0.072 Vali Loss: 0.307 Vali Acc: 0.923 Test Loss: 0.307 Test Acc: 0.923
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5956757068634033
Epoch: 9, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.936664).  Saving model ...
Epoch: 10 cost time: 0.6191811561584473
Epoch: 10, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.301 Vali Acc: 0.927 Test Loss: 0.301 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5733692646026611
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6584043502807617
Epoch: 12, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.315 Vali Acc: 0.920 Test Loss: 0.315 Test Acc: 0.920
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.48879265785217285
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6672277450561523
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6961157321929932
Epoch: 15, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5515477657318115
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.327 Vali Acc: 0.943 Test Loss: 0.327 Test Acc: 0.943
Validation loss decreased (-0.936664 --> -0.943330).  Saving model ...
Epoch: 17 cost time: 0.6148712635040283
Epoch: 17, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.312 Vali Acc: 0.940 Test Loss: 0.312 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6992378234863281
Epoch: 18, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6161963939666748
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8934974670410156
Epoch: 20, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.389 Vali Acc: 0.920 Test Loss: 0.389 Test Acc: 0.920
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6431238651275635
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.301 Vali Acc: 0.943 Test Loss: 0.301 Test Acc: 0.943
Validation loss decreased (-0.943330 --> -0.943330).  Saving model ...
Epoch: 22 cost time: 0.8046751022338867
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.940 Test Loss: 0.313 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7901558876037598
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.323 Vali Acc: 0.943 Test Loss: 0.323 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6177971363067627
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.332 Vali Acc: 0.943 Test Loss: 0.332 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7842504978179932
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.943 Test Loss: 0.338 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.620441198348999
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.345 Vali Acc: 0.943 Test Loss: 0.345 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7775957584381104
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.351 Vali Acc: 0.940 Test Loss: 0.351 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7011077404022217
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.357 Vali Acc: 0.940 Test Loss: 0.357 Test Acc: 0.940
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6366653442382812
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.363 Vali Acc: 0.940 Test Loss: 0.363 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8560528755187988
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7519123554229736
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.375 Vali Acc: 0.940 Test Loss: 0.375 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9433333333333334
model parameter : 174275
model size : 0.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.038752555847168
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 2.999 Vali Acc: 0.173 Test Loss: 2.999 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 0.6980092525482178
Epoch: 2, Steps: 18 | Train Loss: 2.785 Vali Loss: 2.527 Vali Acc: 0.537 Test Loss: 2.527 Test Acc: 0.537
Validation loss decreased (-0.173303 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 0.7854554653167725
Epoch: 3, Steps: 18 | Train Loss: 2.210 Vali Loss: 1.893 Vali Acc: 0.837 Test Loss: 1.893 Test Acc: 0.837
Validation loss decreased (-0.536641 --> -0.836648).  Saving model ...
Epoch: 4 cost time: 0.7749936580657959
Epoch: 4, Steps: 18 | Train Loss: 1.454 Vali Loss: 1.144 Vali Acc: 0.913 Test Loss: 1.144 Test Acc: 0.913
Validation loss decreased (-0.836648 --> -0.913322).  Saving model ...
Epoch: 5 cost time: 0.7294352054595947
Epoch: 5, Steps: 18 | Train Loss: 0.708 Vali Loss: 0.470 Vali Acc: 0.940 Test Loss: 0.470 Test Acc: 0.940
Validation loss decreased (-0.913322 --> -0.939995).  Saving model ...
Epoch: 6 cost time: 0.6407828330993652
Epoch: 6, Steps: 18 | Train Loss: 0.216 Vali Loss: 0.215 Vali Acc: 0.960 Test Loss: 0.215 Test Acc: 0.960
Validation loss decreased (-0.939995 --> -0.959998).  Saving model ...
Epoch: 7 cost time: 0.6543738842010498
Epoch: 7, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7960169315338135
Epoch: 8, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6951584815979004
Epoch: 9, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6710121631622314
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7870683670043945
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6509389877319336
Epoch: 12, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7478275299072266
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.953 Test Loss: 0.181 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7463738918304443
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7303898334503174
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.953 Test Loss: 0.198 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7025392055511475
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.957 Test Loss: 0.183 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6737897396087646
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.960 Test Loss: 0.171 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.8437509536743164
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 171221
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0852808952331543
Epoch: 1, Steps: 18 | Train Loss: 3.168 Vali Loss: 3.013 Vali Acc: 0.147 Test Loss: 3.013 Test Acc: 0.147
Validation loss decreased (inf --> -0.146637).  Saving model ...
Epoch: 2 cost time: 0.8027114868164062
Epoch: 2, Steps: 18 | Train Loss: 2.787 Vali Loss: 2.529 Vali Acc: 0.457 Test Loss: 2.529 Test Acc: 0.457
Validation loss decreased (-0.146637 --> -0.456641).  Saving model ...
Epoch: 3 cost time: 0.7166783809661865
Epoch: 3, Steps: 18 | Train Loss: 2.201 Vali Loss: 1.910 Vali Acc: 0.793 Test Loss: 1.910 Test Acc: 0.793
Validation loss decreased (-0.456641 --> -0.793314).  Saving model ...
Epoch: 4 cost time: 0.849733829498291
Epoch: 4, Steps: 18 | Train Loss: 1.493 Vali Loss: 1.195 Vali Acc: 0.907 Test Loss: 1.195 Test Acc: 0.907
Validation loss decreased (-0.793314 --> -0.906655).  Saving model ...
Epoch: 5 cost time: 0.8751349449157715
Epoch: 5, Steps: 18 | Train Loss: 0.765 Vali Loss: 0.566 Vali Acc: 0.943 Test Loss: 0.566 Test Acc: 0.943
Validation loss decreased (-0.906655 --> -0.943328).  Saving model ...
Epoch: 6 cost time: 0.7885358333587646
Epoch: 6, Steps: 18 | Train Loss: 0.277 Vali Loss: 0.277 Vali Acc: 0.953 Test Loss: 0.277 Test Acc: 0.953
Validation loss decreased (-0.943328 --> -0.953331).  Saving model ...
Epoch: 7 cost time: 0.6623446941375732
Epoch: 7, Steps: 18 | Train Loss: 0.097 Vali Loss: 0.225 Vali Acc: 0.947 Test Loss: 0.225 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7604970932006836
Epoch: 8, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 9 cost time: 0.7104647159576416
Epoch: 9, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 10 cost time: 0.8571906089782715
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7219381332397461
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.950 Test Loss: 0.198 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.806865930557251
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.957 Test Loss: 0.202 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 13 cost time: 0.7212209701538086
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.953 Test Loss: 0.208 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8494699001312256
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.950 Test Loss: 0.216 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8723649978637695
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.953 Test Loss: 0.212 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6824707984924316
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6561422348022461
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6149814128875732
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.953 Test Loss: 0.229 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8677313327789307
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8095738887786865
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.957 Test Loss: 0.238 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7461371421813965
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.953 Test Loss: 0.238 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6673183441162109
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.953 Test Loss: 0.246 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 169595
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0865023136138916
Epoch: 1, Steps: 18 | Train Loss: 3.252 Vali Loss: 3.079 Vali Acc: 0.127 Test Loss: 3.079 Test Acc: 0.127
Validation loss decreased (inf --> -0.126636).  Saving model ...
Epoch: 2 cost time: 0.717240571975708
Epoch: 2, Steps: 18 | Train Loss: 2.866 Vali Loss: 2.605 Vali Acc: 0.457 Test Loss: 2.605 Test Acc: 0.457
Validation loss decreased (-0.126636 --> -0.456641).  Saving model ...
Epoch: 3 cost time: 0.7809984683990479
Epoch: 3, Steps: 18 | Train Loss: 2.295 Vali Loss: 1.956 Vali Acc: 0.770 Test Loss: 1.956 Test Acc: 0.770
Validation loss decreased (-0.456641 --> -0.769980).  Saving model ...
Epoch: 4 cost time: 0.623340368270874
Epoch: 4, Steps: 18 | Train Loss: 1.530 Vali Loss: 1.202 Vali Acc: 0.907 Test Loss: 1.202 Test Acc: 0.907
Validation loss decreased (-0.769980 --> -0.906655).  Saving model ...
Epoch: 5 cost time: 0.8715026378631592
Epoch: 5, Steps: 18 | Train Loss: 0.771 Vali Loss: 0.537 Vali Acc: 0.933 Test Loss: 0.537 Test Acc: 0.933
Validation loss decreased (-0.906655 --> -0.933328).  Saving model ...
Epoch: 6 cost time: 0.6604931354522705
Epoch: 6, Steps: 18 | Train Loss: 0.278 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.936664).  Saving model ...
Epoch: 7 cost time: 0.7646675109863281
Epoch: 7, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.215 Vali Acc: 0.953 Test Loss: 0.215 Test Acc: 0.953
Validation loss decreased (-0.936664 --> -0.953331).  Saving model ...
Epoch: 8 cost time: 0.6850101947784424
Epoch: 8, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.947 Test Loss: 0.204 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6942136287689209
Epoch: 9, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.185 Vali Acc: 0.960 Test Loss: 0.185 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 0.67830491065979
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.959998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.664738655090332
Epoch: 11, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6933419704437256
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.787114143371582
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7261264324188232
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6382007598876953
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7910559177398682
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7134509086608887
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.963 Test Loss: 0.193 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.782536506652832
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7536332607269287
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7721962928771973
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 168197
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9533984661102295
Epoch: 1, Steps: 18 | Train Loss: 3.132 Vali Loss: 3.004 Vali Acc: 0.140 Test Loss: 3.004 Test Acc: 0.140
Validation loss decreased (inf --> -0.139970).  Saving model ...
Epoch: 2 cost time: 0.7453806400299072
Epoch: 2, Steps: 18 | Train Loss: 2.754 Vali Loss: 2.530 Vali Acc: 0.483 Test Loss: 2.530 Test Acc: 0.483
Validation loss decreased (-0.139970 --> -0.483308).  Saving model ...
Epoch: 3 cost time: 0.612053632736206
Epoch: 3, Steps: 18 | Train Loss: 2.204 Vali Loss: 1.886 Vali Acc: 0.787 Test Loss: 1.886 Test Acc: 0.787
Validation loss decreased (-0.483308 --> -0.786648).  Saving model ...
Epoch: 4 cost time: 0.6492583751678467
Epoch: 4, Steps: 18 | Train Loss: 1.454 Vali Loss: 1.157 Vali Acc: 0.887 Test Loss: 1.157 Test Acc: 0.887
Validation loss decreased (-0.786648 --> -0.886655).  Saving model ...
Epoch: 5 cost time: 0.799727201461792
Epoch: 5, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.556 Vali Acc: 0.943 Test Loss: 0.556 Test Acc: 0.943
Validation loss decreased (-0.886655 --> -0.943328).  Saving model ...
Epoch: 6 cost time: 0.7225415706634521
Epoch: 6, Steps: 18 | Train Loss: 0.279 Vali Loss: 0.279 Vali Acc: 0.950 Test Loss: 0.279 Test Acc: 0.950
Validation loss decreased (-0.943328 --> -0.949997).  Saving model ...
Epoch: 7 cost time: 0.8016221523284912
Epoch: 7, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.240 Vali Acc: 0.950 Test Loss: 0.240 Test Acc: 0.950
Validation loss decreased (-0.949997 --> -0.949998).  Saving model ...
Epoch: 8 cost time: 0.8770458698272705
Epoch: 8, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
Validation loss decreased (-0.949998 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.7322113513946533
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.953 Test Loss: 0.238 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7827825546264648
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7730975151062012
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.245 Vali Acc: 0.950 Test Loss: 0.245 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6775674819946289
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.261 Vali Acc: 0.947 Test Loss: 0.261 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6579947471618652
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.268 Vali Acc: 0.947 Test Loss: 0.268 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6065926551818848
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.947 Test Loss: 0.282 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7102038860321045
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.947 Test Loss: 0.294 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8668320178985596
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.943 Test Loss: 0.305 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8714778423309326
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.943 Test Loss: 0.313 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7377567291259766
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.317 Vali Acc: 0.947 Test Loss: 0.317 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 167891
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.059422492980957
Epoch: 1, Steps: 18 | Train Loss: 3.179 Vali Loss: 3.005 Vali Acc: 0.173 Test Loss: 3.005 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 0.8310701847076416
Epoch: 2, Steps: 18 | Train Loss: 2.768 Vali Loss: 2.526 Vali Acc: 0.547 Test Loss: 2.526 Test Acc: 0.547
Validation loss decreased (-0.173303 --> -0.546641).  Saving model ...
Epoch: 3 cost time: 0.7012960910797119
Epoch: 3, Steps: 18 | Train Loss: 2.189 Vali Loss: 1.889 Vali Acc: 0.833 Test Loss: 1.889 Test Acc: 0.833
Validation loss decreased (-0.546641 --> -0.833314).  Saving model ...
Epoch: 4 cost time: 0.7568747997283936
Epoch: 4, Steps: 18 | Train Loss: 1.465 Vali Loss: 1.158 Vali Acc: 0.900 Test Loss: 1.158 Test Acc: 0.900
Validation loss decreased (-0.833314 --> -0.899988).  Saving model ...
Epoch: 5 cost time: 0.6760635375976562
Epoch: 5, Steps: 18 | Train Loss: 0.727 Vali Loss: 0.531 Vali Acc: 0.947 Test Loss: 0.531 Test Acc: 0.947
Validation loss decreased (-0.899988 --> -0.946661).  Saving model ...
Epoch: 6 cost time: 0.7155601978302002
Epoch: 6, Steps: 18 | Train Loss: 0.265 Vali Loss: 0.266 Vali Acc: 0.943 Test Loss: 0.266 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7210497856140137
Epoch: 7, Steps: 18 | Train Loss: 0.144 Vali Loss: 0.245 Vali Acc: 0.927 Test Loss: 0.245 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7322671413421631
Epoch: 8, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.946661 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.7059259414672852
Epoch: 9, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7411642074584961
Epoch: 10, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.8641219139099121
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7227551937103271
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7364239692687988
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.709479808807373
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6706626415252686
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8032605648040771
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6341938972473145
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7042877674102783
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7053420543670654
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7451267242431641
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.973 Test Loss: 0.170 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7809717655181885
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7705018520355225
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 166725
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0795769691467285
Epoch: 1, Steps: 18 | Train Loss: 3.140 Vali Loss: 2.974 Vali Acc: 0.143 Test Loss: 2.974 Test Acc: 0.143
Validation loss decreased (inf --> -0.143304).  Saving model ...
Epoch: 2 cost time: 0.9592559337615967
Epoch: 2, Steps: 18 | Train Loss: 2.753 Vali Loss: 2.467 Vali Acc: 0.580 Test Loss: 2.467 Test Acc: 0.580
Validation loss decreased (-0.143304 --> -0.579975).  Saving model ...
Epoch: 3 cost time: 0.615180492401123
Epoch: 3, Steps: 18 | Train Loss: 2.123 Vali Loss: 1.763 Vali Acc: 0.823 Test Loss: 1.763 Test Acc: 0.823
Validation loss decreased (-0.579975 --> -0.823316).  Saving model ...
Epoch: 4 cost time: 0.6682004928588867
Epoch: 4, Steps: 18 | Train Loss: 1.287 Vali Loss: 0.923 Vali Acc: 0.913 Test Loss: 0.923 Test Acc: 0.913
Validation loss decreased (-0.823316 --> -0.913324).  Saving model ...
Epoch: 5 cost time: 0.6590096950531006
Epoch: 5, Steps: 18 | Train Loss: 0.534 Vali Loss: 0.416 Vali Acc: 0.917 Test Loss: 0.416 Test Acc: 0.917
Validation loss decreased (-0.913324 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.6858172416687012
Epoch: 6, Steps: 18 | Train Loss: 0.257 Vali Loss: 0.294 Vali Acc: 0.920 Test Loss: 0.294 Test Acc: 0.920
Validation loss decreased (-0.916663 --> -0.919997).  Saving model ...
Epoch: 7 cost time: 0.6011126041412354
Epoch: 7, Steps: 18 | Train Loss: 0.093 Vali Loss: 0.251 Vali Acc: 0.927 Test Loss: 0.251 Test Acc: 0.927
Validation loss decreased (-0.919997 --> -0.926664).  Saving model ...
Epoch: 8 cost time: 0.6483933925628662
Epoch: 8, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.261 Vali Acc: 0.913 Test Loss: 0.261 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6597092151641846
Epoch: 9, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.190 Vali Acc: 0.953 Test Loss: 0.190 Test Acc: 0.953
Validation loss decreased (-0.926664 --> -0.953331).  Saving model ...
Epoch: 10 cost time: 0.8152320384979248
Epoch: 10, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956665).  Saving model ...
Epoch: 11 cost time: 0.6989169120788574
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6916587352752686
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.953 Test Loss: 0.205 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.722712516784668
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 14 cost time: 0.833486795425415
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.957 Test Loss: 0.205 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7425756454467773
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.960 Test Loss: 0.211 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7000970840454102
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7464008331298828
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.960 Test Loss: 0.204 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6972198486328125
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.960 Test Loss: 0.209 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7830326557159424
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7319381237030029
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.960 Test Loss: 0.219 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7432224750518799
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7315695285797119
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.960 Test Loss: 0.226 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.752915620803833
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.960 Test Loss: 0.228 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 166251
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8751416206359863
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 3.106 Vali Acc: 0.073 Test Loss: 3.106 Test Acc: 0.073
Validation loss decreased (inf --> -0.073302).  Saving model ...
Epoch: 2 cost time: 0.6911411285400391
Epoch: 2, Steps: 18 | Train Loss: 2.857 Vali Loss: 2.639 Vali Acc: 0.473 Test Loss: 2.639 Test Acc: 0.473
Validation loss decreased (-0.073302 --> -0.473307).  Saving model ...
Epoch: 3 cost time: 0.8181521892547607
Epoch: 3, Steps: 18 | Train Loss: 2.274 Vali Loss: 1.990 Vali Acc: 0.793 Test Loss: 1.990 Test Acc: 0.793
Validation loss decreased (-0.473307 --> -0.793313).  Saving model ...
Epoch: 4 cost time: 0.6797394752502441
Epoch: 4, Steps: 18 | Train Loss: 1.504 Vali Loss: 1.151 Vali Acc: 0.890 Test Loss: 1.151 Test Acc: 0.890
Validation loss decreased (-0.793313 --> -0.889988).  Saving model ...
Epoch: 5 cost time: 0.6208822727203369
Epoch: 5, Steps: 18 | Train Loss: 0.662 Vali Loss: 0.419 Vali Acc: 0.930 Test Loss: 0.419 Test Acc: 0.930
Validation loss decreased (-0.889988 --> -0.929996).  Saving model ...
Epoch: 6 cost time: 0.8034684658050537
Epoch: 6, Steps: 18 | Train Loss: 0.185 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
Validation loss decreased (-0.929996 --> -0.956665).  Saving model ...
Epoch: 7 cost time: 0.7480251789093018
Epoch: 7, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.167 Vali Acc: 0.957 Test Loss: 0.167 Test Acc: 0.957
Validation loss decreased (-0.956665 --> -0.956665).  Saving model ...
Epoch: 8 cost time: 0.7173047065734863
Epoch: 8, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.940 Test Loss: 0.186 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7553346157073975
Epoch: 9, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 0.6953539848327637
Epoch: 10, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.957 Test Loss: 0.166 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9899802207946777
Epoch: 11, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6568295955657959
Epoch: 12, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.957 Test Loss: 0.169 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8692700862884521
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.678314208984375
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.214 Vali Acc: 0.947 Test Loss: 0.214 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6844935417175293
Epoch: 15, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.943 Test Loss: 0.204 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6879713535308838
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.957 Test Loss: 0.176 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6669902801513672
Epoch: 17, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.947 Test Loss: 0.211 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7559621334075928
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.193 Vali Acc: 0.950 Test Loss: 0.193 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7404048442840576
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 166901
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9333882331848145
Epoch: 1, Steps: 18 | Train Loss: 3.177 Vali Loss: 3.003 Vali Acc: 0.157 Test Loss: 3.003 Test Acc: 0.157
Validation loss decreased (inf --> -0.156637).  Saving model ...
Epoch: 2 cost time: 0.7423458099365234
Epoch: 2, Steps: 18 | Train Loss: 2.800 Vali Loss: 2.500 Vali Acc: 0.610 Test Loss: 2.500 Test Acc: 0.610
Validation loss decreased (-0.156637 --> -0.609975).  Saving model ...
Epoch: 3 cost time: 0.6468355655670166
Epoch: 3, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.765 Vali Acc: 0.843 Test Loss: 1.765 Test Acc: 0.843
Validation loss decreased (-0.609975 --> -0.843316).  Saving model ...
Epoch: 4 cost time: 0.8784995079040527
Epoch: 4, Steps: 18 | Train Loss: 1.264 Vali Loss: 0.822 Vali Acc: 0.907 Test Loss: 0.822 Test Acc: 0.907
Validation loss decreased (-0.843316 --> -0.906658).  Saving model ...
Epoch: 5 cost time: 0.8163342475891113
Epoch: 5, Steps: 18 | Train Loss: 0.458 Vali Loss: 0.344 Vali Acc: 0.940 Test Loss: 0.344 Test Acc: 0.940
Validation loss decreased (-0.906658 --> -0.939997).  Saving model ...
Epoch: 6 cost time: 0.8005335330963135
Epoch: 6, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.242 Vali Acc: 0.957 Test Loss: 0.242 Test Acc: 0.957
Validation loss decreased (-0.939997 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 0.6947133541107178
Epoch: 7, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8268313407897949
Epoch: 8, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 9 cost time: 0.8674671649932861
Epoch: 9, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.956665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7131674289703369
Epoch: 10, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.947 Test Loss: 0.230 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8074278831481934
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8463902473449707
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7184336185455322
Epoch: 13, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.746762752532959
Epoch: 14, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6942780017852783
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8190326690673828
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8517796993255615
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.963 Test Loss: 0.210 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7397856712341309
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.963 Test Loss: 0.211 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7727887630462646
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 167267
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.994868516921997
Epoch: 1, Steps: 18 | Train Loss: 3.169 Vali Loss: 3.027 Vali Acc: 0.083 Test Loss: 3.027 Test Acc: 0.083
Validation loss decreased (inf --> -0.083303).  Saving model ...
Epoch: 2 cost time: 0.6881058216094971
Epoch: 2, Steps: 18 | Train Loss: 2.788 Vali Loss: 2.546 Vali Acc: 0.587 Test Loss: 2.546 Test Acc: 0.587
Validation loss decreased (-0.083303 --> -0.586641).  Saving model ...
Epoch: 3 cost time: 0.8737859725952148
Epoch: 3, Steps: 18 | Train Loss: 2.202 Vali Loss: 1.896 Vali Acc: 0.840 Test Loss: 1.896 Test Acc: 0.840
Validation loss decreased (-0.586641 --> -0.839981).  Saving model ...
Epoch: 4 cost time: 0.700939416885376
Epoch: 4, Steps: 18 | Train Loss: 1.444 Vali Loss: 1.062 Vali Acc: 0.907 Test Loss: 1.062 Test Acc: 0.907
Validation loss decreased (-0.839981 --> -0.906656).  Saving model ...
Epoch: 5 cost time: 0.7725327014923096
Epoch: 5, Steps: 18 | Train Loss: 0.611 Vali Loss: 0.436 Vali Acc: 0.920 Test Loss: 0.436 Test Acc: 0.920
Validation loss decreased (-0.906656 --> -0.919996).  Saving model ...
Epoch: 6 cost time: 0.7420659065246582
Epoch: 6, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.919996 --> -0.929997).  Saving model ...
Epoch: 7 cost time: 0.7260427474975586
Epoch: 7, Steps: 18 | Train Loss: 0.094 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929997 --> -0.929997).  Saving model ...
Epoch: 8 cost time: 0.7211360931396484
Epoch: 8, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.248 Vali Acc: 0.927 Test Loss: 0.248 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8828802108764648
Epoch: 9, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.940 Test Loss: 0.222 Test Acc: 0.940
Validation loss decreased (-0.929997 --> -0.939998).  Saving model ...
Epoch: 10 cost time: 0.7614970207214355
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
Validation loss decreased (-0.939998 --> -0.953331).  Saving model ...
Epoch: 11 cost time: 0.756077766418457
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.950 Test Loss: 0.210 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7119941711425781
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7690820693969727
Epoch: 13, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.950 Test Loss: 0.226 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9517393112182617
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.233 Vali Acc: 0.950 Test Loss: 0.233 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.909923791885376
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7548208236694336
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.249 Vali Acc: 0.943 Test Loss: 0.249 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.877589225769043
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6940631866455078
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.947 Test Loss: 0.265 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8714301586151123
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.947 Test Loss: 0.270 Test Acc: 0.947
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7475259304046631
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.276 Vali Acc: 0.943 Test Loss: 0.276 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9533333333333334
model parameter : 165365
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.072599411010742
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 3.006 Vali Acc: 0.117 Test Loss: 3.006 Test Acc: 0.117
Validation loss decreased (inf --> -0.116637).  Saving model ...
Epoch: 2 cost time: 0.8039405345916748
Epoch: 2, Steps: 18 | Train Loss: 2.794 Vali Loss: 2.514 Vali Acc: 0.590 Test Loss: 2.514 Test Acc: 0.590
Validation loss decreased (-0.116637 --> -0.589975).  Saving model ...
Epoch: 3 cost time: 0.7561783790588379
Epoch: 3, Steps: 18 | Train Loss: 2.189 Vali Loss: 1.821 Vali Acc: 0.880 Test Loss: 1.821 Test Acc: 0.880
Validation loss decreased (-0.589975 --> -0.879982).  Saving model ...
Epoch: 4 cost time: 0.8192946910858154
Epoch: 4, Steps: 18 | Train Loss: 1.355 Vali Loss: 0.929 Vali Acc: 0.913 Test Loss: 0.929 Test Acc: 0.913
Validation loss decreased (-0.879982 --> -0.913324).  Saving model ...
Epoch: 5 cost time: 0.7784521579742432
Epoch: 5, Steps: 18 | Train Loss: 0.537 Vali Loss: 0.379 Vali Acc: 0.917 Test Loss: 0.379 Test Acc: 0.917
Validation loss decreased (-0.913324 --> -0.916663).  Saving model ...
Epoch: 6 cost time: 0.6706044673919678
Epoch: 6, Steps: 18 | Train Loss: 0.253 Vali Loss: 0.309 Vali Acc: 0.907 Test Loss: 0.309 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8549823760986328
Epoch: 7, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.238 Vali Acc: 0.923 Test Loss: 0.238 Test Acc: 0.923
Validation loss decreased (-0.916663 --> -0.923331).  Saving model ...
Epoch: 8 cost time: 0.6988892555236816
Epoch: 8, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.910 Test Loss: 0.274 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8206081390380859
Epoch: 9, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.923331 --> -0.929998).  Saving model ...
Epoch: 10 cost time: 0.7625758647918701
Epoch: 10, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.940 Test Loss: 0.248 Test Acc: 0.940
Validation loss decreased (-0.929998 --> -0.939998).  Saving model ...
Epoch: 11 cost time: 0.6694345474243164
Epoch: 11, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7632613182067871
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8482465744018555
Epoch: 13, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.709730863571167
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.312 Vali Acc: 0.927 Test Loss: 0.312 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8240787982940674
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6401734352111816
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7473349571228027
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6267330646514893
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.305 Vali Acc: 0.940 Test Loss: 0.305 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.798558235168457
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.313 Vali Acc: 0.940 Test Loss: 0.313 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7056970596313477
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.302 Vali Acc: 0.947 Test Loss: 0.302 Test Acc: 0.947
Validation loss decreased (-0.939998 --> -0.946664).  Saving model ...
Epoch: 21 cost time: 0.7042934894561768
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.314 Vali Acc: 0.940 Test Loss: 0.314 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6788554191589355
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.322 Vali Acc: 0.940 Test Loss: 0.322 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.629256010055542
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8052358627319336
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6437523365020752
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.335 Vali Acc: 0.940 Test Loss: 0.335 Test Acc: 0.940
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6545305252075195
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8016362190246582
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.681678056716919
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.937 Test Loss: 0.342 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.800368070602417
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.863689661026001
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9466666666666667
model parameter : 166661
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0117239952087402
Epoch: 1, Steps: 18 | Train Loss: 3.213 Vali Loss: 3.051 Vali Acc: 0.153 Test Loss: 3.051 Test Acc: 0.153
Validation loss decreased (inf --> -0.153303).  Saving model ...
Epoch: 2 cost time: 0.7506988048553467
Epoch: 2, Steps: 18 | Train Loss: 2.836 Vali Loss: 2.605 Vali Acc: 0.490 Test Loss: 2.605 Test Acc: 0.490
Validation loss decreased (-0.153303 --> -0.489974).  Saving model ...
Epoch: 3 cost time: 0.9717216491699219
Epoch: 3, Steps: 18 | Train Loss: 2.267 Vali Loss: 1.955 Vali Acc: 0.820 Test Loss: 1.955 Test Acc: 0.820
Validation loss decreased (-0.489974 --> -0.819980).  Saving model ...
Epoch: 4 cost time: 0.6348800659179688
Epoch: 4, Steps: 18 | Train Loss: 1.489 Vali Loss: 1.111 Vali Acc: 0.903 Test Loss: 1.111 Test Acc: 0.903
Validation loss decreased (-0.819980 --> -0.903322).  Saving model ...
Epoch: 5 cost time: 0.7700130939483643
Epoch: 5, Steps: 18 | Train Loss: 0.632 Vali Loss: 0.410 Vali Acc: 0.943 Test Loss: 0.410 Test Acc: 0.943
Validation loss decreased (-0.903322 --> -0.943329).  Saving model ...
Epoch: 6 cost time: 0.7493560314178467
Epoch: 6, Steps: 18 | Train Loss: 0.176 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
Validation loss decreased (-0.943329 --> -0.953331).  Saving model ...
Epoch: 7 cost time: 0.7383005619049072
Epoch: 7, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.920 Test Loss: 0.261 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7260715961456299
Epoch: 8, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
Validation loss decreased (-0.953331 --> -0.953331).  Saving model ...
Epoch: 9 cost time: 0.6989288330078125
Epoch: 9, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6571311950683594
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7426419258117676
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.291 Vali Acc: 0.940 Test Loss: 0.291 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6399166584014893
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.953 Test Loss: 0.253 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.809964656829834
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7162494659423828
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.278 Vali Acc: 0.947 Test Loss: 0.278 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6941087245941162
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.334 Vali Acc: 0.943 Test Loss: 0.334 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.7219359874725342
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
Validation loss decreased (-0.953331 --> -0.956664).  Saving model ...
Epoch: 17 cost time: 0.6995542049407959
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.248 Vali Acc: 0.957 Test Loss: 0.248 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956664).  Saving model ...
Epoch: 18 cost time: 0.8529348373413086
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.297 Vali Acc: 0.953 Test Loss: 0.297 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6871592998504639
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7656280994415283
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.395 Vali Acc: 0.937 Test Loss: 0.395 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7845649719238281
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.288 Vali Acc: 0.950 Test Loss: 0.288 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7528860569000244
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.287 Vali Acc: 0.963 Test Loss: 0.287 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963330).  Saving model ...
Epoch: 23 cost time: 0.8357820510864258
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.294 Vali Acc: 0.957 Test Loss: 0.294 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6453142166137695
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.957 Test Loss: 0.301 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.832268238067627
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.303 Vali Acc: 0.957 Test Loss: 0.303 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6801719665527344
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.307 Vali Acc: 0.957 Test Loss: 0.307 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7593154907226562
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.311 Vali Acc: 0.957 Test Loss: 0.311 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7213678359985352
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.313 Vali Acc: 0.957 Test Loss: 0.313 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7202861309051514
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.318 Vali Acc: 0.953 Test Loss: 0.318 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7790896892547607
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6555130481719971
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.957 Test Loss: 0.324 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7585408687591553
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.326 Vali Acc: 0.957 Test Loss: 0.326 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 165891
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9437229633331299
Epoch: 1, Steps: 18 | Train Loss: 3.227 Vali Loss: 3.054 Vali Acc: 0.147 Test Loss: 3.054 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 0.7259624004364014
Epoch: 2, Steps: 18 | Train Loss: 2.814 Vali Loss: 2.567 Vali Acc: 0.477 Test Loss: 2.567 Test Acc: 0.477
Validation loss decreased (-0.146636 --> -0.476641).  Saving model ...
Epoch: 3 cost time: 0.7375755310058594
Epoch: 3, Steps: 18 | Train Loss: 2.249 Vali Loss: 1.924 Vali Acc: 0.810 Test Loss: 1.924 Test Acc: 0.810
Validation loss decreased (-0.476641 --> -0.809981).  Saving model ...
Epoch: 4 cost time: 0.7465369701385498
Epoch: 4, Steps: 18 | Train Loss: 1.472 Vali Loss: 1.117 Vali Acc: 0.913 Test Loss: 1.117 Test Acc: 0.913
Validation loss decreased (-0.809981 --> -0.913322).  Saving model ...
Epoch: 5 cost time: 0.7767374515533447
Epoch: 5, Steps: 18 | Train Loss: 0.661 Vali Loss: 0.461 Vali Acc: 0.943 Test Loss: 0.461 Test Acc: 0.943
Validation loss decreased (-0.913322 --> -0.943329).  Saving model ...
Epoch: 6 cost time: 0.799706220626831
Epoch: 6, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.255 Vali Acc: 0.940 Test Loss: 0.255 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7194077968597412
Epoch: 7, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.718559980392456
Epoch: 8, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
Validation loss decreased (-0.943329 --> -0.956665).  Saving model ...
Epoch: 9 cost time: 0.8007650375366211
Epoch: 9, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6699938774108887
Epoch: 10, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8637263774871826
Epoch: 11, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7044374942779541
Epoch: 12, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7817986011505127
Epoch: 13, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.953 Test Loss: 0.245 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9032633304595947
Epoch: 14, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.251 Vali Acc: 0.953 Test Loss: 0.251 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7609529495239258
Epoch: 15, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.258 Vali Acc: 0.953 Test Loss: 0.258 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8761920928955078
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.260 Vali Acc: 0.953 Test Loss: 0.260 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7665300369262695
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7633953094482422
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 164837
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.052528142929077
Epoch: 1, Steps: 18 | Train Loss: 3.237 Vali Loss: 3.038 Vali Acc: 0.130 Test Loss: 3.038 Test Acc: 0.130
Validation loss decreased (inf --> -0.129970).  Saving model ...
Epoch: 2 cost time: 0.6797735691070557
Epoch: 2, Steps: 18 | Train Loss: 2.859 Vali Loss: 2.561 Vali Acc: 0.483 Test Loss: 2.561 Test Acc: 0.483
Validation loss decreased (-0.129970 --> -0.483308).  Saving model ...
Epoch: 3 cost time: 0.6287329196929932
Epoch: 3, Steps: 18 | Train Loss: 2.273 Vali Loss: 1.923 Vali Acc: 0.830 Test Loss: 1.923 Test Acc: 0.830
Validation loss decreased (-0.483308 --> -0.829981).  Saving model ...
Epoch: 4 cost time: 0.6346161365509033
Epoch: 4, Steps: 18 | Train Loss: 1.511 Vali Loss: 1.158 Vali Acc: 0.920 Test Loss: 1.158 Test Acc: 0.920
Validation loss decreased (-0.829981 --> -0.919988).  Saving model ...
Epoch: 5 cost time: 0.8424403667449951
Epoch: 5, Steps: 18 | Train Loss: 0.736 Vali Loss: 0.519 Vali Acc: 0.937 Test Loss: 0.519 Test Acc: 0.937
Validation loss decreased (-0.919988 --> -0.936661).  Saving model ...
Epoch: 6 cost time: 0.7544271945953369
Epoch: 6, Steps: 18 | Train Loss: 0.275 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8029139041900635
Epoch: 7, Steps: 18 | Train Loss: 0.147 Vali Loss: 0.268 Vali Acc: 0.943 Test Loss: 0.268 Test Acc: 0.943
Validation loss decreased (-0.936661 --> -0.943331).  Saving model ...
Epoch: 8 cost time: 0.6951720714569092
Epoch: 8, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.250 Vali Acc: 0.927 Test Loss: 0.250 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8099980354309082
Epoch: 9, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7348220348358154
Epoch: 10, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
Validation loss decreased (-0.943331 --> -0.949998).  Saving model ...
Epoch: 11 cost time: 0.7483217716217041
Epoch: 11, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.953 Test Loss: 0.225 Test Acc: 0.953
Validation loss decreased (-0.949998 --> -0.953331).  Saving model ...
Epoch: 12 cost time: 0.7264242172241211
Epoch: 12, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.247 Vali Acc: 0.950 Test Loss: 0.247 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6664993762969971
Epoch: 13, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.250 Vali Acc: 0.960 Test Loss: 0.250 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959997).  Saving model ...
Epoch: 14 cost time: 0.7128956317901611
Epoch: 14, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.276 Vali Acc: 0.947 Test Loss: 0.276 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6720573902130127
Epoch: 15, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.273 Vali Acc: 0.950 Test Loss: 0.273 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7648017406463623
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.314 Vali Acc: 0.943 Test Loss: 0.314 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8116023540496826
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.435 Vali Acc: 0.937 Test Loss: 0.435 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8692750930786133
Epoch: 18, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.290 Vali Acc: 0.950 Test Loss: 0.290 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7122135162353516
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.338 Vali Acc: 0.947 Test Loss: 0.338 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7519092559814453
Epoch: 20, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.255 Vali Acc: 0.947 Test Loss: 0.255 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7608373165130615
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.378 Vali Acc: 0.917 Test Loss: 0.378 Test Acc: 0.917
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6688828468322754
Epoch: 22, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7773828506469727
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.245 Vali Acc: 0.953 Test Loss: 0.245 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 164725
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0314528942108154
Epoch: 1, Steps: 18 | Train Loss: 3.208 Vali Loss: 3.033 Vali Acc: 0.133 Test Loss: 3.033 Test Acc: 0.133
Validation loss decreased (inf --> -0.133303).  Saving model ...
Epoch: 2 cost time: 0.7088003158569336
Epoch: 2, Steps: 18 | Train Loss: 2.830 Vali Loss: 2.552 Vali Acc: 0.533 Test Loss: 2.552 Test Acc: 0.533
Validation loss decreased (-0.133303 --> -0.533308).  Saving model ...
Epoch: 3 cost time: 0.7197449207305908
Epoch: 3, Steps: 18 | Train Loss: 2.260 Vali Loss: 1.902 Vali Acc: 0.807 Test Loss: 1.902 Test Acc: 0.807
Validation loss decreased (-0.533308 --> -0.806648).  Saving model ...
Epoch: 4 cost time: 0.8444490432739258
Epoch: 4, Steps: 18 | Train Loss: 1.497 Vali Loss: 1.084 Vali Acc: 0.913 Test Loss: 1.084 Test Acc: 0.913
Validation loss decreased (-0.806648 --> -0.913322).  Saving model ...
Epoch: 5 cost time: 0.8007173538208008
Epoch: 5, Steps: 18 | Train Loss: 0.634 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
Validation loss decreased (-0.913322 --> -0.936663).  Saving model ...
Epoch: 6 cost time: 0.7114078998565674
Epoch: 6, Steps: 18 | Train Loss: 0.168 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
Validation loss decreased (-0.936663 --> -0.943331).  Saving model ...
Epoch: 7 cost time: 0.7295107841491699
Epoch: 7, Steps: 18 | Train Loss: 0.068 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
Validation loss decreased (-0.943331 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 0.8338062763214111
Epoch: 8, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.953 Test Loss: 0.209 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7176616191864014
Epoch: 9, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8048398494720459
Epoch: 10, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 11 cost time: 0.9359557628631592
Epoch: 11, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.242 Vali Acc: 0.947 Test Loss: 0.242 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9030411243438721
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.947 Test Loss: 0.273 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8973689079284668
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.940 Test Loss: 0.294 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7790958881378174
Epoch: 14, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 15 cost time: 0.7725248336791992
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 0.7711343765258789
Epoch: 16, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7409179210662842
Epoch: 17, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7467906475067139
Epoch: 18, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7918462753295898
Epoch: 19, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6807515621185303
Epoch: 20, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5570886135101318
Epoch: 21, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8492250442504883
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.970 Test Loss: 0.188 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 23 cost time: 0.6253194808959961
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.792961835861206
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8397328853607178
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7068207263946533
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7503829002380371
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8889350891113281
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8862333297729492
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.793203592300415
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.822638750076294
Epoch: 31, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.970 Test Loss: 0.198 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7151200771331787
Epoch: 32, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 165147
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.119164228439331
Epoch: 1, Steps: 18 | Train Loss: 3.194 Vali Loss: 3.023 Vali Acc: 0.200 Test Loss: 3.023 Test Acc: 0.200
Validation loss decreased (inf --> -0.199970).  Saving model ...
Epoch: 2 cost time: 0.7487697601318359
Epoch: 2, Steps: 18 | Train Loss: 2.815 Vali Loss: 2.533 Vali Acc: 0.533 Test Loss: 2.533 Test Acc: 0.533
Validation loss decreased (-0.199970 --> -0.533308).  Saving model ...
Epoch: 3 cost time: 0.7123143672943115
Epoch: 3, Steps: 18 | Train Loss: 2.221 Vali Loss: 1.899 Vali Acc: 0.823 Test Loss: 1.899 Test Acc: 0.823
Validation loss decreased (-0.533308 --> -0.823314).  Saving model ...
Epoch: 4 cost time: 0.6954362392425537
Epoch: 4, Steps: 18 | Train Loss: 1.454 Vali Loss: 1.166 Vali Acc: 0.910 Test Loss: 1.166 Test Acc: 0.910
Validation loss decreased (-0.823314 --> -0.909988).  Saving model ...
Epoch: 5 cost time: 0.8394026756286621
Epoch: 5, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.583 Vali Acc: 0.943 Test Loss: 0.583 Test Acc: 0.943
Validation loss decreased (-0.909988 --> -0.943328).  Saving model ...
Epoch: 6 cost time: 0.8325803279876709
Epoch: 6, Steps: 18 | Train Loss: 0.304 Vali Loss: 0.311 Vali Acc: 0.960 Test Loss: 0.311 Test Acc: 0.960
Validation loss decreased (-0.943328 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 0.8330748081207275
Epoch: 7, Steps: 18 | Train Loss: 0.162 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7160067558288574
Epoch: 8, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.211 Vali Acc: 0.953 Test Loss: 0.211 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7337894439697266
Epoch: 9, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.692051887512207
Epoch: 10, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6326403617858887
Epoch: 11, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6997668743133545
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.960 Test Loss: 0.191 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 13 cost time: 0.6692564487457275
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6596081256866455
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 15 cost time: 0.6619265079498291
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7269408702850342
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6371822357177734
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6878988742828369
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.957 Test Loss: 0.215 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.779280424118042
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6197011470794678
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.223 Vali Acc: 0.957 Test Loss: 0.223 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7288830280303955
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.957 Test Loss: 0.226 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7261545658111572
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.230 Vali Acc: 0.957 Test Loss: 0.230 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8662974834442139
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.957 Test Loss: 0.235 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8312637805938721
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.240 Vali Acc: 0.957 Test Loss: 0.240 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9633333333333334
model parameter : 92405
model size : 0.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8321528434753418
Epoch: 1, Steps: 18 | Train Loss: 3.142 Vali Loss: 2.981 Vali Acc: 0.190 Test Loss: 2.981 Test Acc: 0.190
Validation loss decreased (inf --> -0.189970).  Saving model ...
Epoch: 2 cost time: 0.7826664447784424
Epoch: 2, Steps: 18 | Train Loss: 2.800 Vali Loss: 2.522 Vali Acc: 0.523 Test Loss: 2.522 Test Acc: 0.523
Validation loss decreased (-0.189970 --> -0.523308).  Saving model ...
Epoch: 3 cost time: 0.7264113426208496
Epoch: 3, Steps: 18 | Train Loss: 2.226 Vali Loss: 1.906 Vali Acc: 0.817 Test Loss: 1.906 Test Acc: 0.817
Validation loss decreased (-0.523308 --> -0.816648).  Saving model ...
Epoch: 4 cost time: 0.7812063694000244
Epoch: 4, Steps: 18 | Train Loss: 1.509 Vali Loss: 1.221 Vali Acc: 0.893 Test Loss: 1.221 Test Acc: 0.893
Validation loss decreased (-0.816648 --> -0.893321).  Saving model ...
Epoch: 5 cost time: 0.6821334362030029
Epoch: 5, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.638 Vali Acc: 0.953 Test Loss: 0.638 Test Acc: 0.953
Validation loss decreased (-0.893321 --> -0.953327).  Saving model ...
Epoch: 6 cost time: 0.8154077529907227
Epoch: 6, Steps: 18 | Train Loss: 0.393 Vali Loss: 0.365 Vali Acc: 0.953 Test Loss: 0.365 Test Acc: 0.953
Validation loss decreased (-0.953327 --> -0.953330).  Saving model ...
Epoch: 7 cost time: 0.8108201026916504
Epoch: 7, Steps: 18 | Train Loss: 0.195 Vali Loss: 0.253 Vali Acc: 0.963 Test Loss: 0.253 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.7277369499206543
Epoch: 8, Steps: 18 | Train Loss: 0.104 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6143848896026611
Epoch: 9, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7247262001037598
Epoch: 10, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7397522926330566
Epoch: 11, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7203085422515869
Epoch: 12, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5579149723052979
Epoch: 13, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.960 Test Loss: 0.198 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8292655944824219
Epoch: 14, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5889730453491211
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8418769836425781
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7411665916442871
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6621711254119873
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.224 Vali Acc: 0.960 Test Loss: 0.224 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6948220729827881
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.231 Vali Acc: 0.963 Test Loss: 0.231 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6016538143157959
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.237 Vali Acc: 0.950 Test Loss: 0.237 Test Acc: 0.950
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 89347
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.066516399383545
Epoch: 1, Steps: 18 | Train Loss: 3.150 Vali Loss: 3.027 Vali Acc: 0.143 Test Loss: 3.027 Test Acc: 0.143
Validation loss decreased (inf --> -0.143303).  Saving model ...
Epoch: 2 cost time: 0.7057816982269287
Epoch: 2, Steps: 18 | Train Loss: 2.785 Vali Loss: 2.538 Vali Acc: 0.470 Test Loss: 2.538 Test Acc: 0.470
Validation loss decreased (-0.143303 --> -0.469975).  Saving model ...
Epoch: 3 cost time: 0.6764194965362549
Epoch: 3, Steps: 18 | Train Loss: 2.173 Vali Loss: 1.910 Vali Acc: 0.763 Test Loss: 1.910 Test Acc: 0.763
Validation loss decreased (-0.469975 --> -0.763314).  Saving model ...
Epoch: 4 cost time: 0.6922390460968018
Epoch: 4, Steps: 18 | Train Loss: 1.470 Vali Loss: 1.210 Vali Acc: 0.903 Test Loss: 1.210 Test Acc: 0.903
Validation loss decreased (-0.763314 --> -0.903321).  Saving model ...
Epoch: 5 cost time: 0.76930832862854
Epoch: 5, Steps: 18 | Train Loss: 0.798 Vali Loss: 0.652 Vali Acc: 0.943 Test Loss: 0.652 Test Acc: 0.943
Validation loss decreased (-0.903321 --> -0.943327).  Saving model ...
Epoch: 6 cost time: 0.7506134510040283
Epoch: 6, Steps: 18 | Train Loss: 0.358 Vali Loss: 0.358 Vali Acc: 0.953 Test Loss: 0.358 Test Acc: 0.953
Validation loss decreased (-0.943327 --> -0.953330).  Saving model ...
Epoch: 7 cost time: 0.7296676635742188
Epoch: 7, Steps: 18 | Train Loss: 0.161 Vali Loss: 0.234 Vali Acc: 0.960 Test Loss: 0.234 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 0.6813430786132812
Epoch: 8, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.708327054977417
Epoch: 9, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963332).  Saving model ...
Epoch: 10 cost time: 0.8996984958648682
Epoch: 10, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.963332 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.6465942859649658
Epoch: 11, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.70554518699646
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6550781726837158
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6719844341278076
Epoch: 14, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 0.6529889106750488
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7053453922271729
Epoch: 16, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7866978645324707
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7109179496765137
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7868616580963135
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7963838577270508
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7207508087158203
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7908225059509277
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.957 Test Loss: 0.206 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7535078525543213
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6877024173736572
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 87829
model size : 0.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7506656646728516
Epoch: 1, Steps: 18 | Train Loss: 3.250 Vali Loss: 3.057 Vali Acc: 0.107 Test Loss: 3.057 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 0.6046524047851562
Epoch: 2, Steps: 18 | Train Loss: 2.867 Vali Loss: 2.589 Vali Acc: 0.507 Test Loss: 2.589 Test Acc: 0.507
Validation loss decreased (-0.106636 --> -0.506641).  Saving model ...
Epoch: 3 cost time: 0.6694681644439697
Epoch: 3, Steps: 18 | Train Loss: 2.289 Vali Loss: 1.966 Vali Acc: 0.797 Test Loss: 1.966 Test Acc: 0.797
Validation loss decreased (-0.506641 --> -0.796647).  Saving model ...
Epoch: 4 cost time: 0.6956498622894287
Epoch: 4, Steps: 18 | Train Loss: 1.542 Vali Loss: 1.233 Vali Acc: 0.913 Test Loss: 1.233 Test Acc: 0.913
Validation loss decreased (-0.796647 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 0.9058811664581299
Epoch: 5, Steps: 18 | Train Loss: 0.833 Vali Loss: 0.624 Vali Acc: 0.943 Test Loss: 0.624 Test Acc: 0.943
Validation loss decreased (-0.913321 --> -0.943327).  Saving model ...
Epoch: 6 cost time: 0.7197027206420898
Epoch: 6, Steps: 18 | Train Loss: 0.353 Vali Loss: 0.346 Vali Acc: 0.957 Test Loss: 0.346 Test Acc: 0.957
Validation loss decreased (-0.943327 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.6784567832946777
Epoch: 7, Steps: 18 | Train Loss: 0.150 Vali Loss: 0.248 Vali Acc: 0.953 Test Loss: 0.248 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.585033655166626
Epoch: 8, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.940 Test Loss: 0.238 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7260162830352783
Epoch: 9, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8165287971496582
Epoch: 10, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956665).  Saving model ...
Epoch: 11 cost time: 0.7370660305023193
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.960 Test Loss: 0.208 Test Acc: 0.960
Validation loss decreased (-0.956665 --> -0.959998).  Saving model ...
Epoch: 12 cost time: 0.7343072891235352
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.950 Test Loss: 0.227 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6845252513885498
Epoch: 13, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5590119361877441
Epoch: 14, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.724250078201294
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.953 Test Loss: 0.227 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6564538478851318
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.236 Vali Acc: 0.957 Test Loss: 0.236 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6368372440338135
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.249 Vali Acc: 0.950 Test Loss: 0.249 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.600111722946167
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.251 Vali Acc: 0.957 Test Loss: 0.251 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6814393997192383
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.259 Vali Acc: 0.953 Test Loss: 0.259 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6348421573638916
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.264 Vali Acc: 0.953 Test Loss: 0.264 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8298442363739014
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.272 Vali Acc: 0.953 Test Loss: 0.272 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 87099
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.105006217956543
Epoch: 1, Steps: 18 | Train Loss: 3.224 Vali Loss: 3.047 Vali Acc: 0.147 Test Loss: 3.047 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 0.8738696575164795
Epoch: 2, Steps: 18 | Train Loss: 2.826 Vali Loss: 2.563 Vali Acc: 0.513 Test Loss: 2.563 Test Acc: 0.513
Validation loss decreased (-0.146636 --> -0.513308).  Saving model ...
Epoch: 3 cost time: 0.6727943420410156
Epoch: 3, Steps: 18 | Train Loss: 2.258 Vali Loss: 1.935 Vali Acc: 0.843 Test Loss: 1.935 Test Acc: 0.843
Validation loss decreased (-0.513308 --> -0.843314).  Saving model ...
Epoch: 4 cost time: 0.6913237571716309
Epoch: 4, Steps: 18 | Train Loss: 1.547 Vali Loss: 1.224 Vali Acc: 0.900 Test Loss: 1.224 Test Acc: 0.900
Validation loss decreased (-0.843314 --> -0.899988).  Saving model ...
Epoch: 5 cost time: 0.688204288482666
Epoch: 5, Steps: 18 | Train Loss: 0.845 Vali Loss: 0.635 Vali Acc: 0.943 Test Loss: 0.635 Test Acc: 0.943
Validation loss decreased (-0.899988 --> -0.943327).  Saving model ...
Epoch: 6 cost time: 0.7897286415100098
Epoch: 6, Steps: 18 | Train Loss: 0.351 Vali Loss: 0.349 Vali Acc: 0.953 Test Loss: 0.349 Test Acc: 0.953
Validation loss decreased (-0.943327 --> -0.953330).  Saving model ...
Epoch: 7 cost time: 0.7109963893890381
Epoch: 7, Steps: 18 | Train Loss: 0.163 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
Validation loss decreased (-0.953330 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 0.7442147731781006
Epoch: 8, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7878909111022949
Epoch: 9, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.8004467487335205
Epoch: 10, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7514605522155762
Epoch: 11, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7008287906646729
Epoch: 12, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6284465789794922
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6631057262420654
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.967 Test Loss: 0.207 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6903510093688965
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.960 Test Loss: 0.212 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7531900405883789
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.594954252243042
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.957 Test Loss: 0.228 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6163058280944824
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.238 Vali Acc: 0.963 Test Loss: 0.238 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7067468166351318
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6986539363861084
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 86341
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8732123374938965
Epoch: 1, Steps: 18 | Train Loss: 3.228 Vali Loss: 3.043 Vali Acc: 0.110 Test Loss: 3.043 Test Acc: 0.110
Validation loss decreased (inf --> -0.109970).  Saving model ...
Epoch: 2 cost time: 0.678483247756958
Epoch: 2, Steps: 18 | Train Loss: 2.850 Vali Loss: 2.569 Vali Acc: 0.500 Test Loss: 2.569 Test Acc: 0.500
Validation loss decreased (-0.109970 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 0.7728924751281738
Epoch: 3, Steps: 18 | Train Loss: 2.243 Vali Loss: 1.946 Vali Acc: 0.803 Test Loss: 1.946 Test Acc: 0.803
Validation loss decreased (-0.499974 --> -0.803314).  Saving model ...
Epoch: 4 cost time: 0.7473006248474121
Epoch: 4, Steps: 18 | Train Loss: 1.563 Vali Loss: 1.238 Vali Acc: 0.920 Test Loss: 1.238 Test Acc: 0.920
Validation loss decreased (-0.803314 --> -0.919988).  Saving model ...
Epoch: 5 cost time: 0.6694512367248535
Epoch: 5, Steps: 18 | Train Loss: 0.840 Vali Loss: 0.651 Vali Acc: 0.950 Test Loss: 0.651 Test Acc: 0.950
Validation loss decreased (-0.919988 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.7376446723937988
Epoch: 6, Steps: 18 | Train Loss: 0.399 Vali Loss: 0.352 Vali Acc: 0.957 Test Loss: 0.352 Test Acc: 0.957
Validation loss decreased (-0.949993 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.9147937297821045
Epoch: 7, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.236 Vali Acc: 0.960 Test Loss: 0.236 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959998).  Saving model ...
Epoch: 8 cost time: 0.8134846687316895
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7569887638092041
Epoch: 9, Steps: 18 | Train Loss: 0.048 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8043482303619385
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 11 cost time: 0.7824139595031738
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.8108434677124023
Epoch: 12, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8309566974639893
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7302000522613525
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6918864250183105
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6518661975860596
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.6806118488311768
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7855215072631836
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7167801856994629
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.963 Test Loss: 0.192 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.765500545501709
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8329126834869385
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 86419
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2151312828063965
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.037 Vali Acc: 0.150 Test Loss: 3.037 Test Acc: 0.150
Validation loss decreased (inf --> -0.149970).  Saving model ...
Epoch: 2 cost time: 0.7329127788543701
Epoch: 2, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.576 Vali Acc: 0.433 Test Loss: 2.576 Test Acc: 0.433
Validation loss decreased (-0.149970 --> -0.433308).  Saving model ...
Epoch: 3 cost time: 0.7522132396697998
Epoch: 3, Steps: 18 | Train Loss: 2.238 Vali Loss: 1.967 Vali Acc: 0.787 Test Loss: 1.967 Test Acc: 0.787
Validation loss decreased (-0.433308 --> -0.786647).  Saving model ...
Epoch: 4 cost time: 0.835848331451416
Epoch: 4, Steps: 18 | Train Loss: 1.571 Vali Loss: 1.250 Vali Acc: 0.933 Test Loss: 1.250 Test Acc: 0.933
Validation loss decreased (-0.786647 --> -0.933321).  Saving model ...
Epoch: 5 cost time: 0.7117490768432617
Epoch: 5, Steps: 18 | Train Loss: 0.833 Vali Loss: 0.654 Vali Acc: 0.960 Test Loss: 0.654 Test Acc: 0.960
Validation loss decreased (-0.933321 --> -0.959993).  Saving model ...
Epoch: 6 cost time: 0.9195971488952637
Epoch: 6, Steps: 18 | Train Loss: 0.367 Vali Loss: 0.360 Vali Acc: 0.960 Test Loss: 0.360 Test Acc: 0.960
Validation loss decreased (-0.959993 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.6716647148132324
Epoch: 7, Steps: 18 | Train Loss: 0.172 Vali Loss: 0.254 Vali Acc: 0.957 Test Loss: 0.254 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6881270408630371
Epoch: 8, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.203 Vali Acc: 0.967 Test Loss: 0.203 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7291491031646729
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6549410820007324
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6693408489227295
Epoch: 11, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6530206203460693
Epoch: 12, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.7539839744567871
Epoch: 13, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8482894897460938
Epoch: 14, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6553409099578857
Epoch: 15, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7632291316986084
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.677943229675293
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7180025577545166
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.867018461227417
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7298314571380615
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7575409412384033
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6856396198272705
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 85637
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0424001216888428
Epoch: 1, Steps: 18 | Train Loss: 3.262 Vali Loss: 3.068 Vali Acc: 0.090 Test Loss: 3.068 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 0.7688395977020264
Epoch: 2, Steps: 18 | Train Loss: 2.874 Vali Loss: 2.610 Vali Acc: 0.467 Test Loss: 2.610 Test Acc: 0.467
Validation loss decreased (-0.089969 --> -0.466641).  Saving model ...
Epoch: 3 cost time: 0.7878952026367188
Epoch: 3, Steps: 18 | Train Loss: 2.314 Vali Loss: 1.997 Vali Acc: 0.780 Test Loss: 1.997 Test Acc: 0.780
Validation loss decreased (-0.466641 --> -0.779980).  Saving model ...
Epoch: 4 cost time: 0.8165161609649658
Epoch: 4, Steps: 18 | Train Loss: 1.617 Vali Loss: 1.275 Vali Acc: 0.920 Test Loss: 1.275 Test Acc: 0.920
Validation loss decreased (-0.779980 --> -0.919987).  Saving model ...
Epoch: 5 cost time: 0.7207067012786865
Epoch: 5, Steps: 18 | Train Loss: 0.871 Vali Loss: 0.666 Vali Acc: 0.937 Test Loss: 0.666 Test Acc: 0.937
Validation loss decreased (-0.919987 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 0.8388843536376953
Epoch: 6, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.345 Vali Acc: 0.960 Test Loss: 0.345 Test Acc: 0.960
Validation loss decreased (-0.936660 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 0.6719744205474854
Epoch: 7, Steps: 18 | Train Loss: 0.173 Vali Loss: 0.213 Vali Acc: 0.973 Test Loss: 0.213 Test Acc: 0.973
Validation loss decreased (-0.959997 --> -0.973331).  Saving model ...
Epoch: 8 cost time: 0.6270034313201904
Epoch: 8, Steps: 18 | Train Loss: 0.088 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6624855995178223
Epoch: 9, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 10 cost time: 0.6529123783111572
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7712588310241699
Epoch: 11, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7889788150787354
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7090845108032227
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.680469274520874
Epoch: 14, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.963 Test Loss: 0.130 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6856083869934082
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8914635181427002
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.963 Test Loss: 0.127 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6785986423492432
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.701481819152832
Epoch: 18, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6775107383728027
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.963 Test Loss: 0.136 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6852858066558838
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6726553440093994
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.680518388748169
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6765396595001221
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 85419
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.102196455001831
Epoch: 1, Steps: 18 | Train Loss: 3.166 Vali Loss: 3.017 Vali Acc: 0.147 Test Loss: 3.017 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 0.7710630893707275
Epoch: 2, Steps: 18 | Train Loss: 2.814 Vali Loss: 2.559 Vali Acc: 0.447 Test Loss: 2.559 Test Acc: 0.447
Validation loss decreased (-0.146636 --> -0.446641).  Saving model ...
Epoch: 3 cost time: 0.7544112205505371
Epoch: 3, Steps: 18 | Train Loss: 2.253 Vali Loss: 1.940 Vali Acc: 0.810 Test Loss: 1.940 Test Acc: 0.810
Validation loss decreased (-0.446641 --> -0.809981).  Saving model ...
Epoch: 4 cost time: 0.6793253421783447
Epoch: 4, Steps: 18 | Train Loss: 1.532 Vali Loss: 1.221 Vali Acc: 0.917 Test Loss: 1.221 Test Acc: 0.917
Validation loss decreased (-0.809981 --> -0.916654).  Saving model ...
Epoch: 5 cost time: 0.7984509468078613
Epoch: 5, Steps: 18 | Train Loss: 0.811 Vali Loss: 0.622 Vali Acc: 0.943 Test Loss: 0.622 Test Acc: 0.943
Validation loss decreased (-0.916654 --> -0.943327).  Saving model ...
Epoch: 6 cost time: 0.6874966621398926
Epoch: 6, Steps: 18 | Train Loss: 0.341 Vali Loss: 0.328 Vali Acc: 0.957 Test Loss: 0.328 Test Acc: 0.957
Validation loss decreased (-0.943327 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.6819970607757568
Epoch: 7, Steps: 18 | Train Loss: 0.155 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.6898186206817627
Epoch: 8, Steps: 18 | Train Loss: 0.070 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8209123611450195
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.947 Test Loss: 0.198 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7869157791137695
Epoch: 10, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.655036449432373
Epoch: 11, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.950 Test Loss: 0.195 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.837101936340332
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7361660003662109
Epoch: 13, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.957 Test Loss: 0.207 Test Acc: 0.957
Validation loss decreased (-0.956664 --> -0.956665).  Saving model ...
Epoch: 14 cost time: 0.7538959980010986
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.801123857498169
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.957 Test Loss: 0.217 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.804349422454834
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.222 Vali Acc: 0.957 Test Loss: 0.222 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8897051811218262
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6435775756835938
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.232 Vali Acc: 0.957 Test Loss: 0.232 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7703008651733398
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.953 Test Loss: 0.235 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.697850227355957
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.239 Vali Acc: 0.953 Test Loss: 0.239 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7560214996337891
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.246 Vali Acc: 0.957 Test Loss: 0.246 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7473349571228027
Epoch: 22, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6261599063873291
Epoch: 23, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.249 Vali Acc: 0.957 Test Loss: 0.249 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9566666666666667
model parameter : 86197
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.052321195602417
Epoch: 1, Steps: 18 | Train Loss: 3.162 Vali Loss: 2.995 Vali Acc: 0.183 Test Loss: 2.995 Test Acc: 0.183
Validation loss decreased (inf --> -0.183303).  Saving model ...
Epoch: 2 cost time: 0.6559486389160156
Epoch: 2, Steps: 18 | Train Loss: 2.803 Vali Loss: 2.534 Vali Acc: 0.613 Test Loss: 2.534 Test Acc: 0.613
Validation loss decreased (-0.183303 --> -0.613308).  Saving model ...
Epoch: 3 cost time: 0.6856033802032471
Epoch: 3, Steps: 18 | Train Loss: 2.226 Vali Loss: 1.910 Vali Acc: 0.807 Test Loss: 1.910 Test Acc: 0.807
Validation loss decreased (-0.613308 --> -0.806648).  Saving model ...
Epoch: 4 cost time: 0.6815359592437744
Epoch: 4, Steps: 18 | Train Loss: 1.501 Vali Loss: 1.176 Vali Acc: 0.890 Test Loss: 1.176 Test Acc: 0.890
Validation loss decreased (-0.806648 --> -0.889988).  Saving model ...
Epoch: 5 cost time: 0.622037410736084
Epoch: 5, Steps: 18 | Train Loss: 0.762 Vali Loss: 0.568 Vali Acc: 0.943 Test Loss: 0.568 Test Acc: 0.943
Validation loss decreased (-0.889988 --> -0.943328).  Saving model ...
Epoch: 6 cost time: 0.613438606262207
Epoch: 6, Steps: 18 | Train Loss: 0.296 Vali Loss: 0.294 Vali Acc: 0.950 Test Loss: 0.294 Test Acc: 0.950
Validation loss decreased (-0.943328 --> -0.949997).  Saving model ...
Epoch: 7 cost time: 0.6581840515136719
Epoch: 7, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.233 Vali Acc: 0.947 Test Loss: 0.233 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6697070598602295
Epoch: 8, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.949997 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.6907885074615479
Epoch: 9, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 0.6338186264038086
Epoch: 10, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.947 Test Loss: 0.180 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6160757541656494
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6919097900390625
Epoch: 12, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6562254428863525
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.622978925704956
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.196 Vali Acc: 0.950 Test Loss: 0.196 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5751888751983643
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7173678874969482
Epoch: 16, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.6475894451141357
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.957 Test Loss: 0.197 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6077361106872559
Epoch: 18, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.755814790725708
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.96
model parameter : 86691
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9579720497131348
Epoch: 1, Steps: 18 | Train Loss: 3.182 Vali Loss: 3.001 Vali Acc: 0.173 Test Loss: 3.001 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 0.7044856548309326
Epoch: 2, Steps: 18 | Train Loss: 2.797 Vali Loss: 2.536 Vali Acc: 0.537 Test Loss: 2.536 Test Acc: 0.537
Validation loss decreased (-0.173303 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 0.7886958122253418
Epoch: 3, Steps: 18 | Train Loss: 2.237 Vali Loss: 1.917 Vali Acc: 0.837 Test Loss: 1.917 Test Acc: 0.837
Validation loss decreased (-0.536641 --> -0.836647).  Saving model ...
Epoch: 4 cost time: 0.6630494594573975
Epoch: 4, Steps: 18 | Train Loss: 1.523 Vali Loss: 1.220 Vali Acc: 0.920 Test Loss: 1.220 Test Acc: 0.920
Validation loss decreased (-0.836647 --> -0.919988).  Saving model ...
Epoch: 5 cost time: 0.7686202526092529
Epoch: 5, Steps: 18 | Train Loss: 0.840 Vali Loss: 0.646 Vali Acc: 0.960 Test Loss: 0.646 Test Acc: 0.960
Validation loss decreased (-0.919988 --> -0.959994).  Saving model ...
Epoch: 6 cost time: 0.7219505310058594
Epoch: 6, Steps: 18 | Train Loss: 0.373 Vali Loss: 0.359 Vali Acc: 0.960 Test Loss: 0.359 Test Acc: 0.960
Validation loss decreased (-0.959994 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7602105140686035
Epoch: 7, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.8214828968048096
Epoch: 8, Steps: 18 | Train Loss: 0.099 Vali Loss: 0.191 Vali Acc: 0.970 Test Loss: 0.191 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6972339153289795
Epoch: 9, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.785214900970459
Epoch: 10, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7448563575744629
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.957 Test Loss: 0.159 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8047306537628174
Epoch: 12, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7597880363464355
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.170 Vali Acc: 0.957 Test Loss: 0.170 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7842121124267578
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.960 Test Loss: 0.154 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7115285396575928
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.950 Test Loss: 0.185 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8019583225250244
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6059696674346924
Epoch: 17, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.242 Vali Acc: 0.943 Test Loss: 0.242 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6919784545898438
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6743943691253662
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.950 Test Loss: 0.205 Test Acc: 0.950
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6738414764404297
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.957 Test Loss: 0.186 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 85045
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0137078762054443
Epoch: 1, Steps: 18 | Train Loss: 3.138 Vali Loss: 2.960 Vali Acc: 0.240 Test Loss: 2.960 Test Acc: 0.240
Validation loss decreased (inf --> -0.239970).  Saving model ...
Epoch: 2 cost time: 0.6613965034484863
Epoch: 2, Steps: 18 | Train Loss: 2.787 Vali Loss: 2.502 Vali Acc: 0.530 Test Loss: 2.502 Test Acc: 0.530
Validation loss decreased (-0.239970 --> -0.529975).  Saving model ...
Epoch: 3 cost time: 0.940880298614502
Epoch: 3, Steps: 18 | Train Loss: 2.229 Vali Loss: 1.876 Vali Acc: 0.807 Test Loss: 1.876 Test Acc: 0.807
Validation loss decreased (-0.529975 --> -0.806648).  Saving model ...
Epoch: 4 cost time: 0.696406364440918
Epoch: 4, Steps: 18 | Train Loss: 1.489 Vali Loss: 1.160 Vali Acc: 0.913 Test Loss: 1.160 Test Acc: 0.913
Validation loss decreased (-0.806648 --> -0.913322).  Saving model ...
Epoch: 5 cost time: 0.7437808513641357
Epoch: 5, Steps: 18 | Train Loss: 0.787 Vali Loss: 0.565 Vali Acc: 0.940 Test Loss: 0.565 Test Acc: 0.940
Validation loss decreased (-0.913322 --> -0.939994).  Saving model ...
Epoch: 6 cost time: 0.775531530380249
Epoch: 6, Steps: 18 | Train Loss: 0.326 Vali Loss: 0.286 Vali Acc: 0.960 Test Loss: 0.286 Test Acc: 0.960
Validation loss decreased (-0.939994 --> -0.959997).  Saving model ...
Epoch: 7 cost time: 0.6947112083435059
Epoch: 7, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 8 cost time: 0.7387480735778809
Epoch: 8, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7492368221282959
Epoch: 9, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7351830005645752
Epoch: 10, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.7876052856445312
Epoch: 11, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7235782146453857
Epoch: 12, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.957 Test Loss: 0.191 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8133008480072021
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6868326663970947
Epoch: 14, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6675124168395996
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8625679016113281
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7532229423522949
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7843365669250488
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7006731033325195
Epoch: 19, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6642556190490723
Epoch: 20, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9666666666666667
model parameter : 86469
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.960200548171997
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.120 Vali Acc: 0.027 Test Loss: 3.120 Test Acc: 0.027
Validation loss decreased (inf --> -0.026635).  Saving model ...
Epoch: 2 cost time: 0.5305156707763672
Epoch: 2, Steps: 18 | Train Loss: 2.905 Vali Loss: 2.663 Vali Acc: 0.473 Test Loss: 2.663 Test Acc: 0.473
Validation loss decreased (-0.026635 --> -0.473307).  Saving model ...
Epoch: 3 cost time: 0.727461576461792
Epoch: 3, Steps: 18 | Train Loss: 2.335 Vali Loss: 2.072 Vali Acc: 0.803 Test Loss: 2.072 Test Acc: 0.803
Validation loss decreased (-0.473307 --> -0.803313).  Saving model ...
Epoch: 4 cost time: 0.7399678230285645
Epoch: 4, Steps: 18 | Train Loss: 1.676 Vali Loss: 1.349 Vali Acc: 0.903 Test Loss: 1.349 Test Acc: 0.903
Validation loss decreased (-0.803313 --> -0.903320).  Saving model ...
Epoch: 5 cost time: 0.7297577857971191
Epoch: 5, Steps: 18 | Train Loss: 0.924 Vali Loss: 0.740 Vali Acc: 0.937 Test Loss: 0.740 Test Acc: 0.937
Validation loss decreased (-0.903320 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 0.6882359981536865
Epoch: 6, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.402 Vali Acc: 0.957 Test Loss: 0.402 Test Acc: 0.957
Validation loss decreased (-0.936659 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.7043466567993164
Epoch: 7, Steps: 18 | Train Loss: 0.205 Vali Loss: 0.277 Vali Acc: 0.957 Test Loss: 0.277 Test Acc: 0.957
Validation loss decreased (-0.956663 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.7283430099487305
Epoch: 8, Steps: 18 | Train Loss: 0.108 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.7368946075439453
Epoch: 9, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.187 Vali Acc: 0.963 Test Loss: 0.187 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.7294905185699463
Epoch: 10, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.177 Vali Acc: 0.960 Test Loss: 0.177 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7244729995727539
Epoch: 11, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 12 cost time: 0.6649889945983887
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.8411190509796143
Epoch: 13, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7535967826843262
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 0.8929486274719238
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7534575462341309
Epoch: 16, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.723851203918457
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8202807903289795
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7397608757019043
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6743254661560059
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7090208530426025
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.963 Test Loss: 0.182 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6757020950317383
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8114469051361084
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7786922454833984
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 85827
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9282891750335693
Epoch: 1, Steps: 18 | Train Loss: 3.201 Vali Loss: 3.056 Vali Acc: 0.103 Test Loss: 3.056 Test Acc: 0.103
Validation loss decreased (inf --> -0.103303).  Saving model ...
Epoch: 2 cost time: 0.6935582160949707
Epoch: 2, Steps: 18 | Train Loss: 2.846 Vali Loss: 2.603 Vali Acc: 0.477 Test Loss: 2.603 Test Acc: 0.477
Validation loss decreased (-0.103303 --> -0.476641).  Saving model ...
Epoch: 3 cost time: 0.630897045135498
Epoch: 3, Steps: 18 | Train Loss: 2.284 Vali Loss: 1.988 Vali Acc: 0.777 Test Loss: 1.988 Test Acc: 0.777
Validation loss decreased (-0.476641 --> -0.776647).  Saving model ...
Epoch: 4 cost time: 0.7925612926483154
Epoch: 4, Steps: 18 | Train Loss: 1.551 Vali Loss: 1.271 Vali Acc: 0.903 Test Loss: 1.271 Test Acc: 0.903
Validation loss decreased (-0.776647 --> -0.903321).  Saving model ...
Epoch: 5 cost time: 0.686314582824707
Epoch: 5, Steps: 18 | Train Loss: 0.900 Vali Loss: 0.677 Vali Acc: 0.947 Test Loss: 0.677 Test Acc: 0.947
Validation loss decreased (-0.903321 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.6895999908447266
Epoch: 6, Steps: 18 | Train Loss: 0.384 Vali Loss: 0.362 Vali Acc: 0.960 Test Loss: 0.362 Test Acc: 0.960
Validation loss decreased (-0.946660 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.6757404804229736
Epoch: 7, Steps: 18 | Train Loss: 0.181 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.7346401214599609
Epoch: 8, Steps: 18 | Train Loss: 0.091 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7562093734741211
Epoch: 9, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6711578369140625
Epoch: 10, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.8773806095123291
Epoch: 11, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.7384393215179443
Epoch: 12, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7877123355865479
Epoch: 13, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9189937114715576
Epoch: 14, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 0.7173399925231934
Epoch: 15, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.858342170715332
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7366046905517578
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9001753330230713
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.694817304611206
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7972149848937988
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7706844806671143
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.764291524887085
Epoch: 22, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9824314117431641
Epoch: 23, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.74906325340271
Epoch: 24, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.970 Test Loss: 0.186 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6721677780151367
Epoch: 25, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7403135299682617
Epoch: 26, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.670968770980835
Epoch: 27, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7497832775115967
Epoch: 28, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.970 Test Loss: 0.197 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7046394348144531
Epoch: 29, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7497150897979736
Epoch: 30, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.970 Test Loss: 0.202 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 84901
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0438573360443115
Epoch: 1, Steps: 18 | Train Loss: 3.267 Vali Loss: 3.089 Vali Acc: 0.100 Test Loss: 3.089 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 0.6533420085906982
Epoch: 2, Steps: 18 | Train Loss: 2.877 Vali Loss: 2.608 Vali Acc: 0.467 Test Loss: 2.608 Test Acc: 0.467
Validation loss decreased (-0.099969 --> -0.466641).  Saving model ...
Epoch: 3 cost time: 0.947808027267456
Epoch: 3, Steps: 18 | Train Loss: 2.317 Vali Loss: 1.975 Vali Acc: 0.793 Test Loss: 1.975 Test Acc: 0.793
Validation loss decreased (-0.466641 --> -0.793314).  Saving model ...
Epoch: 4 cost time: 0.6876628398895264
Epoch: 4, Steps: 18 | Train Loss: 1.552 Vali Loss: 1.216 Vali Acc: 0.910 Test Loss: 1.216 Test Acc: 0.910
Validation loss decreased (-0.793314 --> -0.909988).  Saving model ...
Epoch: 5 cost time: 0.8067231178283691
Epoch: 5, Steps: 18 | Train Loss: 0.814 Vali Loss: 0.591 Vali Acc: 0.933 Test Loss: 0.591 Test Acc: 0.933
Validation loss decreased (-0.909988 --> -0.933327).  Saving model ...
Epoch: 6 cost time: 0.7548062801361084
Epoch: 6, Steps: 18 | Train Loss: 0.308 Vali Loss: 0.300 Vali Acc: 0.957 Test Loss: 0.300 Test Acc: 0.957
Validation loss decreased (-0.933327 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 0.7107157707214355
Epoch: 7, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.214 Vali Acc: 0.963 Test Loss: 0.214 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.6826462745666504
Epoch: 8, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.700777530670166
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.7274477481842041
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8524141311645508
Epoch: 11, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8257565498352051
Epoch: 12, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6863038539886475
Epoch: 13, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8001003265380859
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7432162761688232
Epoch: 15, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7010402679443359
Epoch: 16, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7682754993438721
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8302993774414062
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.973 Test Loss: 0.175 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7423787117004395
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.973 Test Loss: 0.176 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7803866863250732
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 84917
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.863797903060913
Epoch: 1, Steps: 18 | Train Loss: 3.081 Vali Loss: 2.967 Vali Acc: 0.183 Test Loss: 2.967 Test Acc: 0.183
Validation loss decreased (inf --> -0.183304).  Saving model ...
Epoch: 2 cost time: 0.6816701889038086
Epoch: 2, Steps: 18 | Train Loss: 2.729 Vali Loss: 2.509 Vali Acc: 0.567 Test Loss: 2.509 Test Acc: 0.567
Validation loss decreased (-0.183304 --> -0.566642).  Saving model ...
Epoch: 3 cost time: 0.6893479824066162
Epoch: 3, Steps: 18 | Train Loss: 2.159 Vali Loss: 1.888 Vali Acc: 0.823 Test Loss: 1.888 Test Acc: 0.823
Validation loss decreased (-0.566642 --> -0.823314).  Saving model ...
Epoch: 4 cost time: 0.656735897064209
Epoch: 4, Steps: 18 | Train Loss: 1.439 Vali Loss: 1.181 Vali Acc: 0.927 Test Loss: 1.181 Test Acc: 0.927
Validation loss decreased (-0.823314 --> -0.926655).  Saving model ...
Epoch: 5 cost time: 0.7168886661529541
Epoch: 5, Steps: 18 | Train Loss: 0.745 Vali Loss: 0.592 Vali Acc: 0.947 Test Loss: 0.592 Test Acc: 0.947
Validation loss decreased (-0.926655 --> -0.946661).  Saving model ...
Epoch: 6 cost time: 0.5357038974761963
Epoch: 6, Steps: 18 | Train Loss: 0.306 Vali Loss: 0.301 Vali Acc: 0.957 Test Loss: 0.301 Test Acc: 0.957
Validation loss decreased (-0.946661 --> -0.956664).  Saving model ...
Epoch: 7 cost time: 0.7356743812561035
Epoch: 7, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.6868159770965576
Epoch: 8, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.177 Vali Acc: 0.967 Test Loss: 0.177 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6889150142669678
Epoch: 9, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.6318912506103516
Epoch: 10, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6163873672485352
Epoch: 11, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.165 Vali Acc: 0.973 Test Loss: 0.165 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.621781587600708
Epoch: 12, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.726355791091919
Epoch: 13, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6779346466064453
Epoch: 14, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7410545349121094
Epoch: 15, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.973 Test Loss: 0.172 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6710927486419678
Epoch: 16, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7391040325164795
Epoch: 17, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.960 Test Loss: 0.186 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7153022289276123
Epoch: 18, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.973 Test Loss: 0.178 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7256226539611816
Epoch: 19, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.6861622333526611
Epoch: 20, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7200851440429688
Epoch: 21, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 85467
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.1203601360321045
Epoch: 1, Steps: 18 | Train Loss: 3.200 Vali Loss: 3.048 Vali Acc: 0.147 Test Loss: 3.048 Test Acc: 0.147
Validation loss decreased (inf --> -0.146636).  Saving model ...
Epoch: 2 cost time: 0.7440590858459473
Epoch: 2, Steps: 18 | Train Loss: 2.843 Vali Loss: 2.583 Vali Acc: 0.453 Test Loss: 2.583 Test Acc: 0.453
Validation loss decreased (-0.146636 --> -0.453308).  Saving model ...
Epoch: 3 cost time: 0.6454331874847412
Epoch: 3, Steps: 18 | Train Loss: 2.266 Vali Loss: 1.977 Vali Acc: 0.790 Test Loss: 1.977 Test Acc: 0.790
Validation loss decreased (-0.453308 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.7130262851715088
Epoch: 4, Steps: 18 | Train Loss: 1.601 Vali Loss: 1.267 Vali Acc: 0.893 Test Loss: 1.267 Test Acc: 0.893
Validation loss decreased (-0.789980 --> -0.893321).  Saving model ...
Epoch: 5 cost time: 0.7928919792175293
Epoch: 5, Steps: 18 | Train Loss: 0.860 Vali Loss: 0.671 Vali Acc: 0.947 Test Loss: 0.671 Test Acc: 0.947
Validation loss decreased (-0.893321 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.7729594707489014
Epoch: 6, Steps: 18 | Train Loss: 0.394 Vali Loss: 0.372 Vali Acc: 0.960 Test Loss: 0.372 Test Acc: 0.960
Validation loss decreased (-0.946660 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.702641487121582
Epoch: 7, Steps: 18 | Train Loss: 0.188 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.690596342086792
Epoch: 8, Steps: 18 | Train Loss: 0.112 Vali Loss: 0.205 Vali Acc: 0.963 Test Loss: 0.205 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.638350248336792
Epoch: 9, Steps: 18 | Train Loss: 0.074 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.6576254367828369
Epoch: 10, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7554638385772705
Epoch: 11, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.6972270011901855
Epoch: 12, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.6707782745361328
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.7605373859405518
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6508255004882812
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.8346326351165771
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8678560256958008
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.65708327293396
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6585643291473389
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8508319854736328
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6989617347717285
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6298544406890869
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6533217430114746
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7648608684539795
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7355141639709473
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7716596126556396
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7067921161651611
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 66837
model size : 0.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0220134258270264
Epoch: 1, Steps: 18 | Train Loss: 3.259 Vali Loss: 3.124 Vali Acc: 0.087 Test Loss: 3.124 Test Acc: 0.087
Validation loss decreased (inf --> -0.086635).  Saving model ...
Epoch: 2 cost time: 0.7441611289978027
Epoch: 2, Steps: 18 | Train Loss: 2.902 Vali Loss: 2.677 Vali Acc: 0.407 Test Loss: 2.677 Test Acc: 0.407
Validation loss decreased (-0.086635 --> -0.406640).  Saving model ...
Epoch: 3 cost time: 0.8100626468658447
Epoch: 3, Steps: 18 | Train Loss: 2.346 Vali Loss: 2.073 Vali Acc: 0.743 Test Loss: 2.073 Test Acc: 0.743
Validation loss decreased (-0.406640 --> -0.743313).  Saving model ...
Epoch: 4 cost time: 0.7098021507263184
Epoch: 4, Steps: 18 | Train Loss: 1.663 Vali Loss: 1.362 Vali Acc: 0.890 Test Loss: 1.362 Test Acc: 0.890
Validation loss decreased (-0.743313 --> -0.889986).  Saving model ...
Epoch: 5 cost time: 0.7915151119232178
Epoch: 5, Steps: 18 | Train Loss: 0.940 Vali Loss: 0.741 Vali Acc: 0.943 Test Loss: 0.741 Test Acc: 0.943
Validation loss decreased (-0.889986 --> -0.943326).  Saving model ...
Epoch: 6 cost time: 0.790846586227417
Epoch: 6, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.407 Vali Acc: 0.960 Test Loss: 0.407 Test Acc: 0.960
Validation loss decreased (-0.943326 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7893328666687012
Epoch: 7, Steps: 18 | Train Loss: 0.258 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
Validation loss decreased (-0.959996 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 0.7933573722839355
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.8100018501281738
Epoch: 9, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.179 Vali Acc: 0.970 Test Loss: 0.179 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7094991207122803
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.161 Vali Acc: 0.977 Test Loss: 0.161 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 11 cost time: 0.6539084911346436
Epoch: 11, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.705162763595581
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7075943946838379
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.833251953125
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.805260181427002
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.6465044021606445
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7353131771087646
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7593302726745605
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.753803014755249
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6368849277496338
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8574304580688477
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.6799881458282471
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7741501331329346
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7876601219177246
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.664517879486084
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8849437236785889
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6545059680938721
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7391037940979004
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.622488260269165
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6769225597381592
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7759320735931396
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 65315
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7730834484100342
Epoch: 1, Steps: 18 | Train Loss: 3.226 Vali Loss: 3.055 Vali Acc: 0.143 Test Loss: 3.055 Test Acc: 0.143
Validation loss decreased (inf --> -0.143303).  Saving model ...
Epoch: 2 cost time: 0.5827474594116211
Epoch: 2, Steps: 18 | Train Loss: 2.873 Vali Loss: 2.617 Vali Acc: 0.457 Test Loss: 2.617 Test Acc: 0.457
Validation loss decreased (-0.143303 --> -0.456640).  Saving model ...
Epoch: 3 cost time: 0.8360352516174316
Epoch: 3, Steps: 18 | Train Loss: 2.334 Vali Loss: 2.019 Vali Acc: 0.813 Test Loss: 2.019 Test Acc: 0.813
Validation loss decreased (-0.456640 --> -0.813313).  Saving model ...
Epoch: 4 cost time: 0.6827647686004639
Epoch: 4, Steps: 18 | Train Loss: 1.620 Vali Loss: 1.315 Vali Acc: 0.903 Test Loss: 1.315 Test Acc: 0.903
Validation loss decreased (-0.813313 --> -0.903320).  Saving model ...
Epoch: 5 cost time: 0.6417105197906494
Epoch: 5, Steps: 18 | Train Loss: 0.906 Vali Loss: 0.719 Vali Acc: 0.940 Test Loss: 0.719 Test Acc: 0.940
Validation loss decreased (-0.903320 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.6670572757720947
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.400 Vali Acc: 0.953 Test Loss: 0.400 Test Acc: 0.953
Validation loss decreased (-0.939993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.7262518405914307
Epoch: 7, Steps: 18 | Train Loss: 0.217 Vali Loss: 0.268 Vali Acc: 0.960 Test Loss: 0.268 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.9749257564544678
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.754664421081543
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6923344135284424
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7122035026550293
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.8461487293243408
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6646158695220947
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.7855021953582764
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6855874061584473
Epoch: 15, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.6667702198028564
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.646813154220581
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7401437759399414
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7203295230865479
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7600753307342529
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8890490531921387
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7622475624084473
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9025697708129883
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7010467052459717
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6893460750579834
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.973 Test Loss: 0.157 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 64565
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.981635332107544
Epoch: 1, Steps: 18 | Train Loss: 3.179 Vali Loss: 3.028 Vali Acc: 0.123 Test Loss: 3.028 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.8821158409118652
Epoch: 2, Steps: 18 | Train Loss: 2.832 Vali Loss: 2.565 Vali Acc: 0.563 Test Loss: 2.565 Test Acc: 0.563
Validation loss decreased (-0.123303 --> -0.563308).  Saving model ...
Epoch: 3 cost time: 0.8455440998077393
Epoch: 3, Steps: 18 | Train Loss: 2.245 Vali Loss: 1.953 Vali Acc: 0.800 Test Loss: 1.953 Test Acc: 0.800
Validation loss decreased (-0.563308 --> -0.799980).  Saving model ...
Epoch: 4 cost time: 0.750291109085083
Epoch: 4, Steps: 18 | Train Loss: 1.552 Vali Loss: 1.242 Vali Acc: 0.910 Test Loss: 1.242 Test Acc: 0.910
Validation loss decreased (-0.799980 --> -0.909988).  Saving model ...
Epoch: 5 cost time: 0.7594475746154785
Epoch: 5, Steps: 18 | Train Loss: 0.853 Vali Loss: 0.670 Vali Acc: 0.953 Test Loss: 0.670 Test Acc: 0.953
Validation loss decreased (-0.909988 --> -0.953327).  Saving model ...
Epoch: 6 cost time: 0.7493996620178223
Epoch: 6, Steps: 18 | Train Loss: 0.398 Vali Loss: 0.379 Vali Acc: 0.963 Test Loss: 0.379 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.6771385669708252
Epoch: 7, Steps: 18 | Train Loss: 0.203 Vali Loss: 0.259 Vali Acc: 0.970 Test Loss: 0.259 Test Acc: 0.970
Validation loss decreased (-0.963330 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 0.6691575050354004
Epoch: 8, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.210 Vali Acc: 0.973 Test Loss: 0.210 Test Acc: 0.973
Validation loss decreased (-0.969997 --> -0.973331).  Saving model ...
Epoch: 9 cost time: 0.6749711036682129
Epoch: 9, Steps: 18 | Train Loss: 0.073 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8513541221618652
Epoch: 10, Steps: 18 | Train Loss: 0.050 Vali Loss: 0.163 Vali Acc: 0.973 Test Loss: 0.163 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6895978450775146
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6371073722839355
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7247314453125
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.728407621383667
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7189602851867676
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7403922080993652
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6560907363891602
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.9019668102264404
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6816174983978271
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7455241680145264
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9497981071472168
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9330461025238037
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8447010517120361
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7355897426605225
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 0.7164256572723389
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6784684658050537
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8217887878417969
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7153470516204834
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7749252319335938
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6516585350036621
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9089038372039795
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7271337509155273
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7750027179718018
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7633161544799805
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 64283
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.260451078414917
Epoch: 1, Steps: 18 | Train Loss: 3.211 Vali Loss: 3.050 Vali Acc: 0.110 Test Loss: 3.050 Test Acc: 0.110
Validation loss decreased (inf --> -0.109970).  Saving model ...
Epoch: 2 cost time: 0.6321225166320801
Epoch: 2, Steps: 18 | Train Loss: 2.853 Vali Loss: 2.598 Vali Acc: 0.503 Test Loss: 2.598 Test Acc: 0.503
Validation loss decreased (-0.109970 --> -0.503307).  Saving model ...
Epoch: 3 cost time: 0.6653013229370117
Epoch: 3, Steps: 18 | Train Loss: 2.304 Vali Loss: 2.005 Vali Acc: 0.763 Test Loss: 2.005 Test Acc: 0.763
Validation loss decreased (-0.503307 --> -0.763313).  Saving model ...
Epoch: 4 cost time: 0.7451517581939697
Epoch: 4, Steps: 18 | Train Loss: 1.608 Vali Loss: 1.305 Vali Acc: 0.903 Test Loss: 1.305 Test Acc: 0.903
Validation loss decreased (-0.763313 --> -0.903320).  Saving model ...
Epoch: 5 cost time: 0.8416833877563477
Epoch: 5, Steps: 18 | Train Loss: 0.923 Vali Loss: 0.716 Vali Acc: 0.947 Test Loss: 0.716 Test Acc: 0.947
Validation loss decreased (-0.903320 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.7406249046325684
Epoch: 6, Steps: 18 | Train Loss: 0.452 Vali Loss: 0.404 Vali Acc: 0.953 Test Loss: 0.404 Test Acc: 0.953
Validation loss decreased (-0.946660 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.6574995517730713
Epoch: 7, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.281 Vali Acc: 0.953 Test Loss: 0.281 Test Acc: 0.953
Validation loss decreased (-0.953329 --> -0.953331).  Saving model ...
Epoch: 8 cost time: 0.7589359283447266
Epoch: 8, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
Validation loss decreased (-0.953331 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.7339599132537842
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 0.7306132316589355
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 11 cost time: 0.6911237239837646
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 12 cost time: 0.6955075263977051
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 13 cost time: 0.7999491691589355
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.7888576984405518
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6956093311309814
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6843976974487305
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7657463550567627
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.7220408916473389
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7778363227844238
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 0.7235758304595947
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6908442974090576
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 22 cost time: 0.8039047718048096
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7402431964874268
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7741894721984863
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6447398662567139
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6541976928710938
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8219046592712402
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6621088981628418
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.738593339920044
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7169115543365479
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8242723941802979
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 63845
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9627094268798828
Epoch: 1, Steps: 18 | Train Loss: 3.172 Vali Loss: 3.009 Vali Acc: 0.160 Test Loss: 3.009 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 0.8011717796325684
Epoch: 2, Steps: 18 | Train Loss: 2.813 Vali Loss: 2.562 Vali Acc: 0.553 Test Loss: 2.562 Test Acc: 0.553
Validation loss decreased (-0.159970 --> -0.553308).  Saving model ...
Epoch: 3 cost time: 0.7276730537414551
Epoch: 3, Steps: 18 | Train Loss: 2.256 Vali Loss: 1.969 Vali Acc: 0.790 Test Loss: 1.969 Test Acc: 0.790
Validation loss decreased (-0.553308 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.7844493389129639
Epoch: 4, Steps: 18 | Train Loss: 1.569 Vali Loss: 1.277 Vali Acc: 0.887 Test Loss: 1.277 Test Acc: 0.887
Validation loss decreased (-0.789980 --> -0.886654).  Saving model ...
Epoch: 5 cost time: 0.7578001022338867
Epoch: 5, Steps: 18 | Train Loss: 0.885 Vali Loss: 0.707 Vali Acc: 0.943 Test Loss: 0.707 Test Acc: 0.943
Validation loss decreased (-0.886654 --> -0.943326).  Saving model ...
Epoch: 6 cost time: 0.7810773849487305
Epoch: 6, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.399 Vali Acc: 0.963 Test Loss: 0.399 Test Acc: 0.963
Validation loss decreased (-0.943326 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 0.8656942844390869
Epoch: 7, Steps: 18 | Train Loss: 0.281 Vali Loss: 0.281 Vali Acc: 0.957 Test Loss: 0.281 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7335128784179688
Epoch: 8, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7201402187347412
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.184 Vali Acc: 0.970 Test Loss: 0.184 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.7610988616943359
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7693004608154297
Epoch: 11, Steps: 18 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.6866798400878906
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.8330864906311035
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8952031135559082
Epoch: 14, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.6708261966705322
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.6701512336730957
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7947976589202881
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.8033268451690674
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 19 cost time: 0.7701990604400635
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 20 cost time: 0.73030686378479
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8304233551025391
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7244915962219238
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7686703205108643
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7179229259490967
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.7315261363983154
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.9070131778717041
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8110997676849365
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.702122688293457
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6725149154663086
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6501162052154541
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6802108287811279
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7167251110076904
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6622841358184814
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6576118469238281
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7153658866882324
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 64115
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0431606769561768
Epoch: 1, Steps: 18 | Train Loss: 3.100 Vali Loss: 2.967 Vali Acc: 0.193 Test Loss: 2.967 Test Acc: 0.193
Validation loss decreased (inf --> -0.193304).  Saving model ...
Epoch: 2 cost time: 0.7562563419342041
Epoch: 2, Steps: 18 | Train Loss: 2.750 Vali Loss: 2.516 Vali Acc: 0.557 Test Loss: 2.516 Test Acc: 0.557
Validation loss decreased (-0.193304 --> -0.556642).  Saving model ...
Epoch: 3 cost time: 0.7075753211975098
Epoch: 3, Steps: 18 | Train Loss: 2.197 Vali Loss: 1.913 Vali Acc: 0.780 Test Loss: 1.913 Test Acc: 0.780
Validation loss decreased (-0.556642 --> -0.779981).  Saving model ...
Epoch: 4 cost time: 0.7826039791107178
Epoch: 4, Steps: 18 | Train Loss: 1.494 Vali Loss: 1.220 Vali Acc: 0.883 Test Loss: 1.220 Test Acc: 0.883
Validation loss decreased (-0.779981 --> -0.883321).  Saving model ...
Epoch: 5 cost time: 0.6904656887054443
Epoch: 5, Steps: 18 | Train Loss: 0.825 Vali Loss: 0.654 Vali Acc: 0.950 Test Loss: 0.654 Test Acc: 0.950
Validation loss decreased (-0.883321 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.8343167304992676
Epoch: 6, Steps: 18 | Train Loss: 0.387 Vali Loss: 0.378 Vali Acc: 0.960 Test Loss: 0.378 Test Acc: 0.960
Validation loss decreased (-0.949993 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7900669574737549
Epoch: 7, Steps: 18 | Train Loss: 0.194 Vali Loss: 0.264 Vali Acc: 0.963 Test Loss: 0.264 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.8540818691253662
Epoch: 8, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7577290534973145
Epoch: 9, Steps: 18 | Train Loss: 0.078 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.654881477355957
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.167 Vali Acc: 0.970 Test Loss: 0.167 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.8346221446990967
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.721043586730957
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.796405553817749
Epoch: 13, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.729351282119751
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.8156483173370361
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 16 cost time: 0.7840712070465088
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.784686803817749
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7247002124786377
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7798664569854736
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 20 cost time: 0.902656078338623
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7840456962585449
Epoch: 21, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.979999 --> -0.983332).  Saving model ...
Epoch: 22 cost time: 0.6680283546447754
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 23 cost time: 0.7942483425140381
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 24 cost time: 0.7253050804138184
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.983332 --> -0.983332).  Saving model ...
Epoch: 25 cost time: 0.7405714988708496
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7289440631866455
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7327077388763428
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7275204658508301
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7660617828369141
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7686119079589844
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8082728385925293
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.779517650604248
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7328944206237793
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9702394008636475
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9833333333333333
model parameter : 63525
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.028749942779541
Epoch: 1, Steps: 18 | Train Loss: 3.160 Vali Loss: 3.004 Vali Acc: 0.167 Test Loss: 3.004 Test Acc: 0.167
Validation loss decreased (inf --> -0.166637).  Saving model ...
Epoch: 2 cost time: 0.8630454540252686
Epoch: 2, Steps: 18 | Train Loss: 2.786 Vali Loss: 2.553 Vali Acc: 0.483 Test Loss: 2.553 Test Acc: 0.483
Validation loss decreased (-0.166637 --> -0.483308).  Saving model ...
Epoch: 3 cost time: 0.696768045425415
Epoch: 3, Steps: 18 | Train Loss: 2.243 Vali Loss: 1.955 Vali Acc: 0.760 Test Loss: 1.955 Test Acc: 0.760
Validation loss decreased (-0.483308 --> -0.759980).  Saving model ...
Epoch: 4 cost time: 0.7440617084503174
Epoch: 4, Steps: 18 | Train Loss: 1.582 Vali Loss: 1.288 Vali Acc: 0.903 Test Loss: 1.288 Test Acc: 0.903
Validation loss decreased (-0.759980 --> -0.903320).  Saving model ...
Epoch: 5 cost time: 0.6834790706634521
Epoch: 5, Steps: 18 | Train Loss: 0.890 Vali Loss: 0.739 Vali Acc: 0.933 Test Loss: 0.739 Test Acc: 0.933
Validation loss decreased (-0.903320 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 0.765477180480957
Epoch: 6, Steps: 18 | Train Loss: 0.447 Vali Loss: 0.424 Vali Acc: 0.957 Test Loss: 0.424 Test Acc: 0.957
Validation loss decreased (-0.933326 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 0.6756737232208252
Epoch: 7, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.298 Vali Acc: 0.950 Test Loss: 0.298 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6470510959625244
Epoch: 8, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
Validation loss decreased (-0.956662 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.8869872093200684
Epoch: 9, Steps: 18 | Train Loss: 0.095 Vali Loss: 0.198 Vali Acc: 0.957 Test Loss: 0.198 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7085187435150146
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.877920389175415
Epoch: 11, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 12 cost time: 0.6829767227172852
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.8832423686981201
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.8043930530548096
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6992330551147461
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.823340892791748
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7266333103179932
Epoch: 17, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8272602558135986
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8058657646179199
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.862022876739502
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.853935956954956
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7658638954162598
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8874106407165527
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 63435
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9601523876190186
Epoch: 1, Steps: 18 | Train Loss: 3.207 Vali Loss: 3.041 Vali Acc: 0.150 Test Loss: 3.041 Test Acc: 0.150
Validation loss decreased (inf --> -0.149970).  Saving model ...
Epoch: 2 cost time: 0.68166184425354
Epoch: 2, Steps: 18 | Train Loss: 2.857 Vali Loss: 2.594 Vali Acc: 0.490 Test Loss: 2.594 Test Acc: 0.490
Validation loss decreased (-0.149970 --> -0.489974).  Saving model ...
Epoch: 3 cost time: 0.6587772369384766
Epoch: 3, Steps: 18 | Train Loss: 2.305 Vali Loss: 1.991 Vali Acc: 0.770 Test Loss: 1.991 Test Acc: 0.770
Validation loss decreased (-0.489974 --> -0.769980).  Saving model ...
Epoch: 4 cost time: 0.7056524753570557
Epoch: 4, Steps: 18 | Train Loss: 1.610 Vali Loss: 1.300 Vali Acc: 0.913 Test Loss: 1.300 Test Acc: 0.913
Validation loss decreased (-0.769980 --> -0.913320).  Saving model ...
Epoch: 5 cost time: 0.7818160057067871
Epoch: 5, Steps: 18 | Train Loss: 0.918 Vali Loss: 0.714 Vali Acc: 0.933 Test Loss: 0.714 Test Acc: 0.933
Validation loss decreased (-0.913320 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 0.7610034942626953
Epoch: 6, Steps: 18 | Train Loss: 0.433 Vali Loss: 0.397 Vali Acc: 0.947 Test Loss: 0.397 Test Acc: 0.947
Validation loss decreased (-0.933326 --> -0.946663).  Saving model ...
Epoch: 7 cost time: 0.7263689041137695
Epoch: 7, Steps: 18 | Train Loss: 0.227 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
Validation loss decreased (-0.946663 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.7332415580749512
Epoch: 8, Steps: 18 | Train Loss: 0.134 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.8014998435974121
Epoch: 9, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.8477189540863037
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.681502103805542
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7025763988494873
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.8091022968292236
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8299171924591064
Epoch: 14, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6772058010101318
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7627503871917725
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7527873516082764
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.8132081031799316
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9425289630889893
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.969999 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.8356420993804932
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.8583025932312012
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7912285327911377
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8480257987976074
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8440115451812744
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.73335862159729
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8655812740325928
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9948680400848389
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8025617599487305
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7050220966339111
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7228717803955078
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 64277
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9911561012268066
Epoch: 1, Steps: 18 | Train Loss: 3.227 Vali Loss: 3.060 Vali Acc: 0.153 Test Loss: 3.060 Test Acc: 0.153
Validation loss decreased (inf --> -0.153303).  Saving model ...
Epoch: 2 cost time: 0.6878292560577393
Epoch: 2, Steps: 18 | Train Loss: 2.864 Vali Loss: 2.614 Vali Acc: 0.480 Test Loss: 2.614 Test Acc: 0.480
Validation loss decreased (-0.153303 --> -0.479974).  Saving model ...
Epoch: 3 cost time: 0.6991002559661865
Epoch: 3, Steps: 18 | Train Loss: 2.323 Vali Loss: 2.017 Vali Acc: 0.760 Test Loss: 2.017 Test Acc: 0.760
Validation loss decreased (-0.479974 --> -0.759980).  Saving model ...
Epoch: 4 cost time: 0.693096399307251
Epoch: 4, Steps: 18 | Train Loss: 1.612 Vali Loss: 1.330 Vali Acc: 0.867 Test Loss: 1.330 Test Acc: 0.867
Validation loss decreased (-0.759980 --> -0.866653).  Saving model ...
Epoch: 5 cost time: 0.7685749530792236
Epoch: 5, Steps: 18 | Train Loss: 0.919 Vali Loss: 0.741 Vali Acc: 0.917 Test Loss: 0.741 Test Acc: 0.917
Validation loss decreased (-0.866653 --> -0.916659).  Saving model ...
Epoch: 6 cost time: 0.7471029758453369
Epoch: 6, Steps: 18 | Train Loss: 0.457 Vali Loss: 0.418 Vali Acc: 0.947 Test Loss: 0.418 Test Acc: 0.947
Validation loss decreased (-0.916659 --> -0.946662).  Saving model ...
Epoch: 7 cost time: 0.7038536071777344
Epoch: 7, Steps: 18 | Train Loss: 0.230 Vali Loss: 0.286 Vali Acc: 0.967 Test Loss: 0.286 Test Acc: 0.967
Validation loss decreased (-0.946662 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.7694945335388184
Epoch: 8, Steps: 18 | Train Loss: 0.139 Vali Loss: 0.230 Vali Acc: 0.963 Test Loss: 0.230 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8102664947509766
Epoch: 9, Steps: 18 | Train Loss: 0.092 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.7537391185760498
Epoch: 10, Steps: 18 | Train Loss: 0.069 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7159204483032227
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6964349746704102
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8121318817138672
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.6418752670288086
Epoch: 14, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6235008239746094
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6885230541229248
Epoch: 16, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.7244813442230225
Epoch: 17, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8466267585754395
Epoch: 18, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8063538074493408
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8283648490905762
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8251571655273438
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7639274597167969
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7496256828308105
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6558194160461426
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.963 Test Loss: 0.169 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6693193912506104
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.797736644744873
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 64835
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.274862289428711
Epoch: 1, Steps: 18 | Train Loss: 3.251 Vali Loss: 3.038 Vali Acc: 0.173 Test Loss: 3.038 Test Acc: 0.173
Validation loss decreased (inf --> -0.173303).  Saving model ...
Epoch: 2 cost time: 0.6379828453063965
Epoch: 2, Steps: 18 | Train Loss: 2.903 Vali Loss: 2.584 Vali Acc: 0.513 Test Loss: 2.584 Test Acc: 0.513
Validation loss decreased (-0.173303 --> -0.513307).  Saving model ...
Epoch: 3 cost time: 0.7728910446166992
Epoch: 3, Steps: 18 | Train Loss: 2.327 Vali Loss: 1.971 Vali Acc: 0.820 Test Loss: 1.971 Test Acc: 0.820
Validation loss decreased (-0.513307 --> -0.819980).  Saving model ...
Epoch: 4 cost time: 0.7545135021209717
Epoch: 4, Steps: 18 | Train Loss: 1.656 Vali Loss: 1.248 Vali Acc: 0.917 Test Loss: 1.248 Test Acc: 0.917
Validation loss decreased (-0.819980 --> -0.916654).  Saving model ...
Epoch: 5 cost time: 0.7188138961791992
Epoch: 5, Steps: 18 | Train Loss: 0.873 Vali Loss: 0.655 Vali Acc: 0.950 Test Loss: 0.655 Test Acc: 0.950
Validation loss decreased (-0.916654 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.770035982131958
Epoch: 6, Steps: 18 | Train Loss: 0.426 Vali Loss: 0.358 Vali Acc: 0.960 Test Loss: 0.358 Test Acc: 0.960
Validation loss decreased (-0.949993 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7301435470581055
Epoch: 7, Steps: 18 | Train Loss: 0.193 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
Validation loss decreased (-0.959996 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.6759006977081299
Epoch: 8, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7468326091766357
Epoch: 9, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.165 Vali Acc: 0.970 Test Loss: 0.165 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.5818278789520264
Epoch: 10, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.6699144840240479
Epoch: 11, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6979918479919434
Epoch: 12, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6865584850311279
Epoch: 13, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7164468765258789
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6690256595611572
Epoch: 15, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.001122236251831
Epoch: 16, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7180273532867432
Epoch: 17, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7440283298492432
Epoch: 18, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.960 Test Loss: 0.140 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7025821208953857
Epoch: 19, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.648665189743042
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.6498837471008301
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.150 Vali Acc: 0.960 Test Loss: 0.150 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 63317
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.2633440494537354
Epoch: 1, Steps: 18 | Train Loss: 3.158 Vali Loss: 3.031 Vali Acc: 0.137 Test Loss: 3.031 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 0.6405601501464844
Epoch: 2, Steps: 18 | Train Loss: 2.830 Vali Loss: 2.599 Vali Acc: 0.460 Test Loss: 2.599 Test Acc: 0.460
Validation loss decreased (-0.136636 --> -0.459974).  Saving model ...
Epoch: 3 cost time: 0.7149696350097656
Epoch: 3, Steps: 18 | Train Loss: 2.280 Vali Loss: 2.024 Vali Acc: 0.800 Test Loss: 2.024 Test Acc: 0.800
Validation loss decreased (-0.459974 --> -0.799980).  Saving model ...
Epoch: 4 cost time: 0.6714370250701904
Epoch: 4, Steps: 18 | Train Loss: 1.631 Vali Loss: 1.339 Vali Acc: 0.887 Test Loss: 1.339 Test Acc: 0.887
Validation loss decreased (-0.799980 --> -0.886653).  Saving model ...
Epoch: 5 cost time: 0.7466309070587158
Epoch: 5, Steps: 18 | Train Loss: 0.909 Vali Loss: 0.734 Vali Acc: 0.937 Test Loss: 0.734 Test Acc: 0.937
Validation loss decreased (-0.886653 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 0.716515064239502
Epoch: 6, Steps: 18 | Train Loss: 0.444 Vali Loss: 0.412 Vali Acc: 0.960 Test Loss: 0.412 Test Acc: 0.960
Validation loss decreased (-0.936659 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.6311721801757812
Epoch: 7, Steps: 18 | Train Loss: 0.225 Vali Loss: 0.286 Vali Acc: 0.960 Test Loss: 0.286 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.7457475662231445
Epoch: 8, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7366504669189453
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.8327007293701172
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6895864009857178
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.7547109127044678
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7966341972351074
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.6680126190185547
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6798086166381836
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.7409985065460205
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7091138362884521
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8561406135559082
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7092263698577881
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7750539779663086
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.781764030456543
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.963 Test Loss: 0.138 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9574952125549316
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7313783168792725
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6884713172912598
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6646382808685303
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7522504329681396
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 64805
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8738539218902588
Epoch: 1, Steps: 18 | Train Loss: 3.227 Vali Loss: 3.070 Vali Acc: 0.113 Test Loss: 3.070 Test Acc: 0.113
Validation loss decreased (inf --> -0.113303).  Saving model ...
Epoch: 2 cost time: 0.8051185607910156
Epoch: 2, Steps: 18 | Train Loss: 2.849 Vali Loss: 2.607 Vali Acc: 0.523 Test Loss: 2.607 Test Acc: 0.523
Validation loss decreased (-0.113303 --> -0.523307).  Saving model ...
Epoch: 3 cost time: 0.6776638031005859
Epoch: 3, Steps: 18 | Train Loss: 2.300 Vali Loss: 1.995 Vali Acc: 0.820 Test Loss: 1.995 Test Acc: 0.820
Validation loss decreased (-0.523307 --> -0.819980).  Saving model ...
Epoch: 4 cost time: 0.6904537677764893
Epoch: 4, Steps: 18 | Train Loss: 1.589 Vali Loss: 1.301 Vali Acc: 0.900 Test Loss: 1.301 Test Acc: 0.900
Validation loss decreased (-0.819980 --> -0.899987).  Saving model ...
Epoch: 5 cost time: 0.587670087814331
Epoch: 5, Steps: 18 | Train Loss: 0.883 Vali Loss: 0.693 Vali Acc: 0.953 Test Loss: 0.693 Test Acc: 0.953
Validation loss decreased (-0.899987 --> -0.953326).  Saving model ...
Epoch: 6 cost time: 0.7515749931335449
Epoch: 6, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.388 Vali Acc: 0.967 Test Loss: 0.388 Test Acc: 0.967
Validation loss decreased (-0.953326 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 0.6578524112701416
Epoch: 7, Steps: 18 | Train Loss: 0.214 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.5934712886810303
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.7643494606018066
Epoch: 9, Steps: 18 | Train Loss: 0.107 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.5909020900726318
Epoch: 10, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.162 Vali Acc: 0.970 Test Loss: 0.162 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.6317768096923828
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 12 cost time: 0.6603703498840332
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.6308751106262207
Epoch: 13, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.7396540641784668
Epoch: 14, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.618654727935791
Epoch: 15, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.7386236190795898
Epoch: 16, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7754929065704346
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6614217758178711
Epoch: 18, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.770089864730835
Epoch: 19, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.750441312789917
Epoch: 20, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7231721878051758
Epoch: 21, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8516533374786377
Epoch: 22, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7646181583404541
Epoch: 23, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7625246047973633
Epoch: 24, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7102682590484619
Epoch: 25, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7895224094390869
Epoch: 26, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 64227
model size : 0.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9258959293365479
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.136 Vali Acc: 0.060 Test Loss: 3.136 Test Acc: 0.060
Validation loss decreased (inf --> -0.059969).  Saving model ...
Epoch: 2 cost time: 0.7360198497772217
Epoch: 2, Steps: 18 | Train Loss: 2.926 Vali Loss: 2.669 Vali Acc: 0.440 Test Loss: 2.669 Test Acc: 0.440
Validation loss decreased (-0.059969 --> -0.439973).  Saving model ...
Epoch: 3 cost time: 0.7358129024505615
Epoch: 3, Steps: 18 | Train Loss: 2.352 Vali Loss: 2.063 Vali Acc: 0.780 Test Loss: 2.063 Test Acc: 0.780
Validation loss decreased (-0.439973 --> -0.779979).  Saving model ...
Epoch: 4 cost time: 0.7130453586578369
Epoch: 4, Steps: 18 | Train Loss: 1.639 Vali Loss: 1.355 Vali Acc: 0.887 Test Loss: 1.355 Test Acc: 0.887
Validation loss decreased (-0.779979 --> -0.886653).  Saving model ...
Epoch: 5 cost time: 0.7536513805389404
Epoch: 5, Steps: 18 | Train Loss: 0.932 Vali Loss: 0.750 Vali Acc: 0.923 Test Loss: 0.750 Test Acc: 0.923
Validation loss decreased (-0.886653 --> -0.923326).  Saving model ...
Epoch: 6 cost time: 0.62127685546875
Epoch: 6, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
Validation loss decreased (-0.923326 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.8222675323486328
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.280 Vali Acc: 0.960 Test Loss: 0.280 Test Acc: 0.960
Validation loss decreased (-0.949996 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.7417945861816406
Epoch: 8, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.223 Vali Acc: 0.960 Test Loss: 0.223 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.8089516162872314
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.7915582656860352
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.170 Vali Acc: 0.963 Test Loss: 0.170 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 11 cost time: 0.6801884174346924
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.9318375587463379
Epoch: 12, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.6249151229858398
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.8516659736633301
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6633620262145996
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.6933472156524658
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7470221519470215
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6860980987548828
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.737900972366333
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.765779972076416
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 21 cost time: 0.764474630355835
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7110099792480469
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9274842739105225
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.720670223236084
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.810046911239624
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8587722778320312
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8271605968475342
Epoch: 27, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.723705530166626
Epoch: 28, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6547231674194336
Epoch: 29, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.814206600189209
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.731379508972168
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 63365
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9789741039276123
Epoch: 1, Steps: 18 | Train Loss: 3.164 Vali Loss: 3.018 Vali Acc: 0.153 Test Loss: 3.018 Test Acc: 0.153
Validation loss decreased (inf --> -0.153303).  Saving model ...
Epoch: 2 cost time: 0.7121536731719971
Epoch: 2, Steps: 18 | Train Loss: 2.805 Vali Loss: 2.566 Vali Acc: 0.470 Test Loss: 2.566 Test Acc: 0.470
Validation loss decreased (-0.153303 --> -0.469974).  Saving model ...
Epoch: 3 cost time: 0.7443563938140869
Epoch: 3, Steps: 18 | Train Loss: 2.241 Vali Loss: 1.955 Vali Acc: 0.767 Test Loss: 1.955 Test Acc: 0.767
Validation loss decreased (-0.469974 --> -0.766647).  Saving model ...
Epoch: 4 cost time: 0.7182412147521973
Epoch: 4, Steps: 18 | Train Loss: 1.537 Vali Loss: 1.273 Vali Acc: 0.900 Test Loss: 1.273 Test Acc: 0.900
Validation loss decreased (-0.766647 --> -0.899987).  Saving model ...
Epoch: 5 cost time: 0.5969288349151611
Epoch: 5, Steps: 18 | Train Loss: 0.860 Vali Loss: 0.694 Vali Acc: 0.953 Test Loss: 0.694 Test Acc: 0.953
Validation loss decreased (-0.899987 --> -0.953326).  Saving model ...
Epoch: 6 cost time: 0.7035558223724365
Epoch: 6, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.388 Vali Acc: 0.960 Test Loss: 0.388 Test Acc: 0.960
Validation loss decreased (-0.953326 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7269964218139648
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.6528246402740479
Epoch: 8, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7130975723266602
Epoch: 9, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.6659157276153564
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7547991275787354
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7577652931213379
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7938218116760254
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8318309783935547
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7856035232543945
Epoch: 15, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7096245288848877
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7470059394836426
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8055706024169922
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7979025840759277
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6975431442260742
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.970 Test Loss: 0.117 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8083715438842773
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7285430431365967
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6606271266937256
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7745225429534912
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.663949728012085
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.970 Test Loss: 0.114 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7200331687927246
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.967 Test Loss: 0.117 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 63445
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8338868618011475
Epoch: 1, Steps: 18 | Train Loss: 3.248 Vali Loss: 3.093 Vali Acc: 0.090 Test Loss: 3.093 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 0.6525838375091553
Epoch: 2, Steps: 18 | Train Loss: 2.884 Vali Loss: 2.630 Vali Acc: 0.517 Test Loss: 2.630 Test Acc: 0.517
Validation loss decreased (-0.089969 --> -0.516640).  Saving model ...
Epoch: 3 cost time: 0.8094549179077148
Epoch: 3, Steps: 18 | Train Loss: 2.330 Vali Loss: 2.017 Vali Acc: 0.783 Test Loss: 2.017 Test Acc: 0.783
Validation loss decreased (-0.516640 --> -0.783313).  Saving model ...
Epoch: 4 cost time: 0.9487183094024658
Epoch: 4, Steps: 18 | Train Loss: 1.624 Vali Loss: 1.307 Vali Acc: 0.907 Test Loss: 1.307 Test Acc: 0.907
Validation loss decreased (-0.783313 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 0.7561321258544922
Epoch: 5, Steps: 18 | Train Loss: 0.889 Vali Loss: 0.713 Vali Acc: 0.947 Test Loss: 0.713 Test Acc: 0.947
Validation loss decreased (-0.906654 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.9485161304473877
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.406 Vali Acc: 0.960 Test Loss: 0.406 Test Acc: 0.960
Validation loss decreased (-0.946660 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7107527256011963
Epoch: 7, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.272 Vali Acc: 0.970 Test Loss: 0.272 Test Acc: 0.970
Validation loss decreased (-0.959996 --> -0.969997).  Saving model ...
Epoch: 8 cost time: 0.7937660217285156
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
Validation loss decreased (-0.969997 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6180145740509033
Epoch: 9, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.192 Vali Acc: 0.973 Test Loss: 0.192 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.7681758403778076
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6920111179351807
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7552416324615479
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7106552124023438
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6525375843048096
Epoch: 14, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.6733171939849854
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6178319454193115
Epoch: 16, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7333090305328369
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7165677547454834
Epoch: 18, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7436542510986328
Epoch: 19, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.781233549118042
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.801072359085083
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7081596851348877
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7037868499755859
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7922711372375488
Epoch: 24, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8844175338745117
Epoch: 25, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.891127347946167
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.9305241107940674
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 64059
model size : 0.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.055844783782959
Epoch: 1, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.094 Vali Acc: 0.107 Test Loss: 3.094 Test Acc: 0.107
Validation loss decreased (inf --> -0.106636).  Saving model ...
Epoch: 2 cost time: 0.7237720489501953
Epoch: 2, Steps: 18 | Train Loss: 2.859 Vali Loss: 2.645 Vali Acc: 0.403 Test Loss: 2.645 Test Acc: 0.403
Validation loss decreased (-0.106636 --> -0.403307).  Saving model ...
Epoch: 3 cost time: 0.659353494644165
Epoch: 3, Steps: 18 | Train Loss: 2.302 Vali Loss: 2.038 Vali Acc: 0.763 Test Loss: 2.038 Test Acc: 0.763
Validation loss decreased (-0.403307 --> -0.763313).  Saving model ...
Epoch: 4 cost time: 0.8158564567565918
Epoch: 4, Steps: 18 | Train Loss: 1.610 Vali Loss: 1.324 Vali Acc: 0.893 Test Loss: 1.324 Test Acc: 0.893
Validation loss decreased (-0.763313 --> -0.893320).  Saving model ...
Epoch: 5 cost time: 0.7318344116210938
Epoch: 5, Steps: 18 | Train Loss: 0.889 Vali Loss: 0.723 Vali Acc: 0.940 Test Loss: 0.723 Test Acc: 0.940
Validation loss decreased (-0.893320 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.8878834247589111
Epoch: 6, Steps: 18 | Train Loss: 0.437 Vali Loss: 0.406 Vali Acc: 0.960 Test Loss: 0.406 Test Acc: 0.960
Validation loss decreased (-0.939993 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.7742762565612793
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.277 Vali Acc: 0.963 Test Loss: 0.277 Test Acc: 0.963
Validation loss decreased (-0.959996 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.6986043453216553
Epoch: 8, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.226 Vali Acc: 0.967 Test Loss: 0.226 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.6990041732788086
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.191 Vali Acc: 0.967 Test Loss: 0.191 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.704885721206665
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.174 Vali Acc: 0.967 Test Loss: 0.174 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6626532077789307
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8119995594024658
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7029342651367188
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.8446688652038574
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.71258544921875
Epoch: 15, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7408480644226074
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7267019748687744
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7238540649414062
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.6420507431030273
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6629204750061035
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.8352756500244141
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8717436790466309
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.8305799961090088
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.7770183086395264
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7377197742462158
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7360742092132568
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.8343133926391602
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.718508243560791
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7398531436920166
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8380725383758545
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6827573776245117
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7146220207214355
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.678886890411377
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6606345176696777
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7238967418670654
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6918323040008545
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 58661
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.372767686843872
Epoch: 1, Steps: 18 | Train Loss: 3.177 Vali Loss: 3.012 Vali Acc: 0.123 Test Loss: 3.012 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.7304940223693848
Epoch: 2, Steps: 18 | Train Loss: 2.810 Vali Loss: 2.556 Vali Acc: 0.490 Test Loss: 2.556 Test Acc: 0.490
Validation loss decreased (-0.123303 --> -0.489974).  Saving model ...
Epoch: 3 cost time: 0.6470286846160889
Epoch: 3, Steps: 18 | Train Loss: 2.268 Vali Loss: 1.967 Vali Acc: 0.780 Test Loss: 1.967 Test Acc: 0.780
Validation loss decreased (-0.489974 --> -0.779980).  Saving model ...
Epoch: 4 cost time: 0.7733211517333984
Epoch: 4, Steps: 18 | Train Loss: 1.577 Vali Loss: 1.286 Vali Acc: 0.890 Test Loss: 1.286 Test Acc: 0.890
Validation loss decreased (-0.779980 --> -0.889987).  Saving model ...
Epoch: 5 cost time: 0.6781330108642578
Epoch: 5, Steps: 18 | Train Loss: 0.898 Vali Loss: 0.710 Vali Acc: 0.943 Test Loss: 0.710 Test Acc: 0.943
Validation loss decreased (-0.889987 --> -0.943326).  Saving model ...
Epoch: 6 cost time: 0.8313889503479004
Epoch: 6, Steps: 18 | Train Loss: 0.428 Vali Loss: 0.408 Vali Acc: 0.950 Test Loss: 0.408 Test Acc: 0.950
Validation loss decreased (-0.943326 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7075843811035156
Epoch: 7, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.282 Vali Acc: 0.957 Test Loss: 0.282 Test Acc: 0.957
Validation loss decreased (-0.949996 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.7219753265380859
Epoch: 8, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
Validation loss decreased (-0.956664 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7506241798400879
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.201 Vali Acc: 0.967 Test Loss: 0.201 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7140095233917236
Epoch: 10, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.8092753887176514
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.7348501682281494
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.8188326358795166
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 0.8245899677276611
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 0.713367223739624
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 0.7310044765472412
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 17 cost time: 0.6888446807861328
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.711021900177002
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.967 Test Loss: 0.135 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7288224697113037
Epoch: 19, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 0.6449887752532959
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7117674350738525
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.7523488998413086
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6660330295562744
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6752309799194336
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.7095925807952881
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.602825403213501
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.6608152389526367
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6856017112731934
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.7355327606201172
Epoch: 29, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6634624004364014
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6837844848632812
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.7930259704589844
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.7770919799804688
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.6887142658233643
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 0.755486249923706
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.6422550678253174
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7195086479187012
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 0.6636793613433838
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 39 cost time: 0.7827415466308594
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 40 cost time: 0.625770092010498
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 41 cost time: 0.7133951187133789
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7807602882385254
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 43 cost time: 0.7555444240570068
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8421146869659424
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 45 cost time: 0.6062219142913818
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7879784107208252
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6879377365112305
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 48 cost time: 0.8022232055664062
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 49 cost time: 0.6712665557861328
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 50 cost time: 0.6526014804840088
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7773406505584717
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9071111679077148
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8369724750518799
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.925225019454956
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9396255016326904
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8340208530426025
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7920181751251221
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.9649708271026611
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.784074068069458
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 60 cost time: 0.8550410270690918
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8253624439239502
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1041157245635986
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 0.8675930500030518
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 64 cost time: 0.8093619346618652
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.7834041118621826
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8485515117645264
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6445820331573486
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.8497209548950195
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 69 cost time: 0.6941432952880859
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 0.8732001781463623
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8357558250427246
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 0.7018148899078369
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.6874628067016602
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 0.6246066093444824
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 0.7377958297729492
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8018267154693604
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 0.6579115390777588
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.7160181999206543
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 0.7987651824951172
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 0.891331672668457
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 0.8031067848205566
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 0.8120098114013672
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 83 cost time: 0.9701724052429199
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 84 cost time: 0.6799106597900391
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 85 cost time: 0.8129532337188721
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 86 cost time: 0.7329905033111572
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.710982084274292
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 88 cost time: 0.8012354373931885
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7185676097869873
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 90 cost time: 0.8864922523498535
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 91 cost time: 0.699235200881958
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 0.7598721981048584
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 93 cost time: 0.8230297565460205
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 0.7583978176116943
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 0.7284705638885498
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 0.8057162761688232
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8189046382904053
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 0.5782694816589355
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 0.7136046886444092
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.7517426013946533
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 57907
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9504551887512207
Epoch: 1, Steps: 18 | Train Loss: 3.235 Vali Loss: 3.059 Vali Acc: 0.123 Test Loss: 3.059 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.8205146789550781
Epoch: 2, Steps: 18 | Train Loss: 2.857 Vali Loss: 2.588 Vali Acc: 0.523 Test Loss: 2.588 Test Acc: 0.523
Validation loss decreased (-0.123303 --> -0.523307).  Saving model ...
Epoch: 3 cost time: 0.794276237487793
Epoch: 3, Steps: 18 | Train Loss: 2.267 Vali Loss: 1.968 Vali Acc: 0.753 Test Loss: 1.968 Test Acc: 0.753
Validation loss decreased (-0.523307 --> -0.753314).  Saving model ...
Epoch: 4 cost time: 0.7091095447540283
Epoch: 4, Steps: 18 | Train Loss: 1.561 Vali Loss: 1.274 Vali Acc: 0.877 Test Loss: 1.274 Test Acc: 0.877
Validation loss decreased (-0.753314 --> -0.876654).  Saving model ...
Epoch: 5 cost time: 0.7093868255615234
Epoch: 5, Steps: 18 | Train Loss: 0.874 Vali Loss: 0.703 Vali Acc: 0.950 Test Loss: 0.703 Test Acc: 0.950
Validation loss decreased (-0.876654 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.6900112628936768
Epoch: 6, Steps: 18 | Train Loss: 0.420 Vali Loss: 0.406 Vali Acc: 0.950 Test Loss: 0.406 Test Acc: 0.950
Validation loss decreased (-0.949993 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.6750187873840332
Epoch: 7, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.286 Vali Acc: 0.953 Test Loss: 0.286 Test Acc: 0.953
Validation loss decreased (-0.949996 --> -0.953330).  Saving model ...
Epoch: 8 cost time: 0.722245454788208
Epoch: 8, Steps: 18 | Train Loss: 0.130 Vali Loss: 0.232 Vali Acc: 0.963 Test Loss: 0.232 Test Acc: 0.963
Validation loss decreased (-0.953330 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.7327141761779785
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.195 Vali Acc: 0.973 Test Loss: 0.195 Test Acc: 0.973
Validation loss decreased (-0.963331 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.8964169025421143
Epoch: 10, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.8139002323150635
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7166974544525146
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.692096471786499
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7316274642944336
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7289559841156006
Epoch: 15, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.7469954490661621
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7533321380615234
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7588949203491211
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.7332911491394043
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7529270648956299
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.8745226860046387
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.7252037525177002
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.667191743850708
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.7200312614440918
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.8287765979766846
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.6678462028503418
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.6396925449371338
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 0.6138086318969727
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 0.7381281852722168
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 0.6974959373474121
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.7592098712921143
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6624274253845215
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9633402824401855
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.828660249710083
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8462989330291748
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.797297477722168
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7531533241271973
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 0.8323252201080322
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 39 cost time: 0.7221884727478027
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7824547290802002
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 41 cost time: 0.7769157886505127
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 0.6750369071960449
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7211475372314453
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7460665702819824
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7604637145996094
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6729810237884521
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 47 cost time: 0.6921391487121582
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6901664733886719
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9300391674041748
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7316718101501465
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8864374160766602
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.79830002784729
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7590136528015137
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8084077835083008
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7314789295196533
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7863466739654541
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 57541
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.8478367328643799
Epoch: 1, Steps: 18 | Train Loss: 3.230 Vali Loss: 3.068 Vali Acc: 0.103 Test Loss: 3.068 Test Acc: 0.103
Validation loss decreased (inf --> -0.103303).  Saving model ...
Epoch: 2 cost time: 0.6764225959777832
Epoch: 2, Steps: 18 | Train Loss: 2.869 Vali Loss: 2.611 Vali Acc: 0.473 Test Loss: 2.611 Test Acc: 0.473
Validation loss decreased (-0.103303 --> -0.473307).  Saving model ...
Epoch: 3 cost time: 0.6106088161468506
Epoch: 3, Steps: 18 | Train Loss: 2.309 Vali Loss: 2.000 Vali Acc: 0.790 Test Loss: 2.000 Test Acc: 0.790
Validation loss decreased (-0.473307 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.7483599185943604
Epoch: 4, Steps: 18 | Train Loss: 1.624 Vali Loss: 1.311 Vali Acc: 0.897 Test Loss: 1.311 Test Acc: 0.897
Validation loss decreased (-0.789980 --> -0.896654).  Saving model ...
Epoch: 5 cost time: 0.6380720138549805
Epoch: 5, Steps: 18 | Train Loss: 0.910 Vali Loss: 0.719 Vali Acc: 0.940 Test Loss: 0.719 Test Acc: 0.940
Validation loss decreased (-0.896654 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.6318671703338623
Epoch: 6, Steps: 18 | Train Loss: 0.427 Vali Loss: 0.405 Vali Acc: 0.950 Test Loss: 0.405 Test Acc: 0.950
Validation loss decreased (-0.939993 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.698235273361206
Epoch: 7, Steps: 18 | Train Loss: 0.220 Vali Loss: 0.286 Vali Acc: 0.957 Test Loss: 0.286 Test Acc: 0.957
Validation loss decreased (-0.949996 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.6761481761932373
Epoch: 8, Steps: 18 | Train Loss: 0.133 Vali Loss: 0.233 Vali Acc: 0.960 Test Loss: 0.233 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.7202398777008057
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
Validation loss decreased (-0.959998 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.6577634811401367
Epoch: 10, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.7531478404998779
Epoch: 11, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.176 Vali Acc: 0.970 Test Loss: 0.176 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.7437591552734375
Epoch: 12, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.6425025463104248
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 0.8026430606842041
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 15 cost time: 0.8446226119995117
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 0.8257591724395752
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.7465837001800537
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 0.7221097946166992
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.7652077674865723
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.6966297626495361
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7198748588562012
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.6427469253540039
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.708667516708374
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.7276182174682617
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7774851322174072
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.769728422164917
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 0.7338769435882568
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.756497859954834
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7616667747497559
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6243231296539307
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6223888397216797
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5855586528778076
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6754803657531738
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5949113368988037
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6019525527954102
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.152 Vali Acc: 0.977 Test Loss: 0.152 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.645277738571167
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 57483
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0141642093658447
Epoch: 1, Steps: 18 | Train Loss: 3.255 Vali Loss: 3.104 Vali Acc: 0.120 Test Loss: 3.104 Test Acc: 0.120
Validation loss decreased (inf --> -0.119969).  Saving model ...
Epoch: 2 cost time: 0.7530262470245361
Epoch: 2, Steps: 18 | Train Loss: 2.897 Vali Loss: 2.637 Vali Acc: 0.463 Test Loss: 2.637 Test Acc: 0.463
Validation loss decreased (-0.119969 --> -0.463307).  Saving model ...
Epoch: 3 cost time: 0.643272876739502
Epoch: 3, Steps: 18 | Train Loss: 2.327 Vali Loss: 2.017 Vali Acc: 0.770 Test Loss: 2.017 Test Acc: 0.770
Validation loss decreased (-0.463307 --> -0.769980).  Saving model ...
Epoch: 4 cost time: 0.7531154155731201
Epoch: 4, Steps: 18 | Train Loss: 1.636 Vali Loss: 1.309 Vali Acc: 0.880 Test Loss: 1.309 Test Acc: 0.880
Validation loss decreased (-0.769980 --> -0.879987).  Saving model ...
Epoch: 5 cost time: 0.6913862228393555
Epoch: 5, Steps: 18 | Train Loss: 0.890 Vali Loss: 0.703 Vali Acc: 0.937 Test Loss: 0.703 Test Acc: 0.937
Validation loss decreased (-0.879987 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 0.7460901737213135
Epoch: 6, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.393 Vali Acc: 0.967 Test Loss: 0.393 Test Acc: 0.967
Validation loss decreased (-0.936660 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 0.7794828414916992
Epoch: 7, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.281 Vali Acc: 0.963 Test Loss: 0.281 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7193262577056885
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.6936442852020264
Epoch: 9, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6530928611755371
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7746133804321289
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7132792472839355
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6947627067565918
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6452312469482422
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.66499924659729
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8069703578948975
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7052702903747559
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7069029808044434
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.7553822994232178
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6363034248352051
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7648003101348877
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.897573709487915
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.6346373558044434
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6675677299499512
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.6251449584960938
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7290663719177246
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.7390429973602295
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7034530639648438
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.7289738655090332
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7032184600830078
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.7043464183807373
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.810234546661377
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6918458938598633
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7116177082061768
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6738121509552002
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7589397430419922
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7962193489074707
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.784264326095581
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7264688014984131
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6760270595550537
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7587251663208008
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 57205
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.152381658554077
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 3.090 Vali Acc: 0.113 Test Loss: 3.090 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 0.7138445377349854
Epoch: 2, Steps: 18 | Train Loss: 2.904 Vali Loss: 2.621 Vali Acc: 0.443 Test Loss: 2.621 Test Acc: 0.443
Validation loss decreased (-0.113302 --> -0.443307).  Saving model ...
Epoch: 3 cost time: 0.7889399528503418
Epoch: 3, Steps: 18 | Train Loss: 2.309 Vali Loss: 2.010 Vali Acc: 0.827 Test Loss: 2.010 Test Acc: 0.827
Validation loss decreased (-0.443307 --> -0.826647).  Saving model ...
Epoch: 4 cost time: 0.7692058086395264
Epoch: 4, Steps: 18 | Train Loss: 1.600 Vali Loss: 1.307 Vali Acc: 0.890 Test Loss: 1.307 Test Acc: 0.890
Validation loss decreased (-0.826647 --> -0.889987).  Saving model ...
Epoch: 5 cost time: 0.6411316394805908
Epoch: 5, Steps: 18 | Train Loss: 0.920 Vali Loss: 0.708 Vali Acc: 0.930 Test Loss: 0.708 Test Acc: 0.930
Validation loss decreased (-0.889987 --> -0.929993).  Saving model ...
Epoch: 6 cost time: 0.7263116836547852
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.409 Vali Acc: 0.937 Test Loss: 0.409 Test Acc: 0.937
Validation loss decreased (-0.929993 --> -0.936663).  Saving model ...
Epoch: 7 cost time: 0.738121509552002
Epoch: 7, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.274 Vali Acc: 0.967 Test Loss: 0.274 Test Acc: 0.967
Validation loss decreased (-0.936663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.777069091796875
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7659866809844971
Epoch: 9, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.197 Vali Acc: 0.960 Test Loss: 0.197 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7978541851043701
Epoch: 10, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.7448115348815918
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6771790981292725
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7763354778289795
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.781409502029419
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.7146878242492676
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8730189800262451
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7516331672668457
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8045027256011963
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8283288478851318
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.7837517261505127
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7704911231994629
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.7808754444122314
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8180599212646484
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.9074046611785889
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7152879238128662
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7004942893981934
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.7579736709594727
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7658782005310059
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6572613716125488
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.7822244167327881
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.7375431060791016
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.7288143634796143
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7369112968444824
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6880838871002197
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7895598411560059
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7178881168365479
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7349863052368164
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7754795551300049
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.726959228515625
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7352988719940186
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7143535614013672
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 57571
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0786311626434326
Epoch: 1, Steps: 18 | Train Loss: 3.236 Vali Loss: 3.091 Vali Acc: 0.093 Test Loss: 3.091 Test Acc: 0.093
Validation loss decreased (inf --> -0.093302).  Saving model ...
Epoch: 2 cost time: 0.6213688850402832
Epoch: 2, Steps: 18 | Train Loss: 2.886 Vali Loss: 2.626 Vali Acc: 0.460 Test Loss: 2.626 Test Acc: 0.460
Validation loss decreased (-0.093302 --> -0.459974).  Saving model ...
Epoch: 3 cost time: 0.821284294128418
Epoch: 3, Steps: 18 | Train Loss: 2.330 Vali Loss: 2.022 Vali Acc: 0.790 Test Loss: 2.022 Test Acc: 0.790
Validation loss decreased (-0.459974 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.628826379776001
Epoch: 4, Steps: 18 | Train Loss: 1.616 Vali Loss: 1.314 Vali Acc: 0.873 Test Loss: 1.314 Test Acc: 0.873
Validation loss decreased (-0.789980 --> -0.873320).  Saving model ...
Epoch: 5 cost time: 0.8188817501068115
Epoch: 5, Steps: 18 | Train Loss: 0.942 Vali Loss: 0.711 Vali Acc: 0.937 Test Loss: 0.711 Test Acc: 0.937
Validation loss decreased (-0.873320 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 0.7253410816192627
Epoch: 6, Steps: 18 | Train Loss: 0.422 Vali Loss: 0.408 Vali Acc: 0.967 Test Loss: 0.408 Test Acc: 0.967
Validation loss decreased (-0.936660 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 0.6630706787109375
Epoch: 7, Steps: 18 | Train Loss: 0.213 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.7082381248474121
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.219 Vali Acc: 0.967 Test Loss: 0.219 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7493112087249756
Epoch: 9, Steps: 18 | Train Loss: 0.080 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8334252834320068
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8102385997772217
Epoch: 11, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8009829521179199
Epoch: 12, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.977 Test Loss: 0.151 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7902438640594482
Epoch: 13, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7970080375671387
Epoch: 14, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7717256546020508
Epoch: 15, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.721050500869751
Epoch: 16, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.7778410911560059
Epoch: 17, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7603070735931396
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.7215452194213867
Epoch: 19, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8159980773925781
Epoch: 20, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.7800817489624023
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.948066234588623
Epoch: 22, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9413619041442871
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8308384418487549
Epoch: 24, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.953284502029419
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7524867057800293
Epoch: 26, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8966641426086426
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.145 Vali Acc: 0.977 Test Loss: 0.145 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7870774269104004
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.146 Vali Acc: 0.977 Test Loss: 0.146 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8546221256256104
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8935582637786865
Epoch: 30, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9144527912139893
Epoch: 31, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979998).  Saving model ...
Epoch: 32 cost time: 0.7937428951263428
Epoch: 32, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.153 Vali Acc: 0.980 Test Loss: 0.153 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.961186408996582
Epoch: 33, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8177580833435059
Epoch: 34, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8131601810455322
Epoch: 35, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.980 Test Loss: 0.157 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9471197128295898
Epoch: 36, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.980 Test Loss: 0.158 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8635745048522949
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.980 Test Loss: 0.161 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.921196460723877
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.980 Test Loss: 0.163 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7922706604003906
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.980 Test Loss: 0.165 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0200488567352295
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0540733337402344
Epoch: 41, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 57077
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9680440425872803
Epoch: 1, Steps: 18 | Train Loss: 3.204 Vali Loss: 3.070 Vali Acc: 0.123 Test Loss: 3.070 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.6228692531585693
Epoch: 2, Steps: 18 | Train Loss: 2.860 Vali Loss: 2.615 Vali Acc: 0.500 Test Loss: 2.615 Test Acc: 0.500
Validation loss decreased (-0.123303 --> -0.499974).  Saving model ...
Epoch: 3 cost time: 0.6218428611755371
Epoch: 3, Steps: 18 | Train Loss: 2.287 Vali Loss: 2.014 Vali Acc: 0.810 Test Loss: 2.014 Test Acc: 0.810
Validation loss decreased (-0.499974 --> -0.809980).  Saving model ...
Epoch: 4 cost time: 0.7446627616882324
Epoch: 4, Steps: 18 | Train Loss: 1.613 Vali Loss: 1.318 Vali Acc: 0.887 Test Loss: 1.318 Test Acc: 0.887
Validation loss decreased (-0.809980 --> -0.886653).  Saving model ...
Epoch: 5 cost time: 0.7381021976470947
Epoch: 5, Steps: 18 | Train Loss: 0.911 Vali Loss: 0.727 Vali Acc: 0.933 Test Loss: 0.727 Test Acc: 0.933
Validation loss decreased (-0.886653 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 0.6776533126831055
Epoch: 6, Steps: 18 | Train Loss: 0.425 Vali Loss: 0.401 Vali Acc: 0.960 Test Loss: 0.401 Test Acc: 0.960
Validation loss decreased (-0.933326 --> -0.959996).  Saving model ...
Epoch: 7 cost time: 0.6721744537353516
Epoch: 7, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.282 Vali Acc: 0.960 Test Loss: 0.282 Test Acc: 0.960
Validation loss decreased (-0.959996 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.7082259654998779
Epoch: 8, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.223 Vali Acc: 0.963 Test Loss: 0.223 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.7684640884399414
Epoch: 9, Steps: 18 | Train Loss: 0.090 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.680351972579956
Epoch: 10, Steps: 18 | Train Loss: 0.066 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.7881381511688232
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.7973203659057617
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.695418119430542
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.630030632019043
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.738269567489624
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6765670776367188
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6373715400695801
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6768112182617188
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6716501712799072
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6672117710113525
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.7480318546295166
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.6916546821594238
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6737091541290283
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.6900486946105957
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.8288602828979492
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7035038471221924
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.7610821723937988
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8635339736938477
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.699211597442627
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.8465816974639893
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.730212926864624
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8700971603393555
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.842160701751709
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8255527019500732
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7496564388275146
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7212610244750977
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.806541919708252
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7327494621276855
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7060680389404297
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 57051
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.3195674419403076
Epoch: 1, Steps: 18 | Train Loss: 3.218 Vali Loss: 3.065 Vali Acc: 0.120 Test Loss: 3.065 Test Acc: 0.120
Validation loss decreased (inf --> -0.119969).  Saving model ...
Epoch: 2 cost time: 0.8561232089996338
Epoch: 2, Steps: 18 | Train Loss: 2.857 Vali Loss: 2.614 Vali Acc: 0.470 Test Loss: 2.614 Test Acc: 0.470
Validation loss decreased (-0.119969 --> -0.469974).  Saving model ...
Epoch: 3 cost time: 0.8233473300933838
Epoch: 3, Steps: 18 | Train Loss: 2.292 Vali Loss: 2.028 Vali Acc: 0.790 Test Loss: 2.028 Test Acc: 0.790
Validation loss decreased (-0.469974 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.755267858505249
Epoch: 4, Steps: 18 | Train Loss: 1.626 Vali Loss: 1.341 Vali Acc: 0.910 Test Loss: 1.341 Test Acc: 0.910
Validation loss decreased (-0.789980 --> -0.909987).  Saving model ...
Epoch: 5 cost time: 0.6994390487670898
Epoch: 5, Steps: 18 | Train Loss: 0.912 Vali Loss: 0.738 Vali Acc: 0.947 Test Loss: 0.738 Test Acc: 0.947
Validation loss decreased (-0.909987 --> -0.946659).  Saving model ...
Epoch: 6 cost time: 0.7209005355834961
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.405 Vali Acc: 0.963 Test Loss: 0.405 Test Acc: 0.963
Validation loss decreased (-0.946659 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 0.8223049640655518
Epoch: 7, Steps: 18 | Train Loss: 0.223 Vali Loss: 0.278 Vali Acc: 0.960 Test Loss: 0.278 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7823867797851562
Epoch: 8, Steps: 18 | Train Loss: 0.123 Vali Loss: 0.221 Vali Acc: 0.967 Test Loss: 0.221 Test Acc: 0.967
Validation loss decreased (-0.963329 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7418458461761475
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.8007454872131348
Epoch: 10, Steps: 18 | Train Loss: 0.059 Vali Loss: 0.171 Vali Acc: 0.973 Test Loss: 0.171 Test Acc: 0.973
Validation loss decreased (-0.973331 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7138726711273193
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.6948678493499756
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
Validation loss decreased (-0.973332 --> -0.979998).  Saving model ...
Epoch: 13 cost time: 0.7014575004577637
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6380472183227539
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8048219680786133
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7263014316558838
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6825392246246338
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7572596073150635
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7243225574493408
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7751462459564209
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6843791007995605
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7517549991607666
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 57925
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9698588848114014
Epoch: 1, Steps: 18 | Train Loss: 3.234 Vali Loss: 3.097 Vali Acc: 0.100 Test Loss: 3.097 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 0.6727864742279053
Epoch: 2, Steps: 18 | Train Loss: 2.890 Vali Loss: 2.658 Vali Acc: 0.450 Test Loss: 2.658 Test Acc: 0.450
Validation loss decreased (-0.099969 --> -0.449973).  Saving model ...
Epoch: 3 cost time: 0.7104096412658691
Epoch: 3, Steps: 18 | Train Loss: 2.335 Vali Loss: 2.065 Vali Acc: 0.763 Test Loss: 2.065 Test Acc: 0.763
Validation loss decreased (-0.449973 --> -0.763313).  Saving model ...
Epoch: 4 cost time: 0.7287948131561279
Epoch: 4, Steps: 18 | Train Loss: 1.669 Vali Loss: 1.370 Vali Acc: 0.910 Test Loss: 1.370 Test Acc: 0.910
Validation loss decreased (-0.763313 --> -0.909986).  Saving model ...
Epoch: 5 cost time: 0.7851834297180176
Epoch: 5, Steps: 18 | Train Loss: 0.959 Vali Loss: 0.749 Vali Acc: 0.950 Test Loss: 0.749 Test Acc: 0.950
Validation loss decreased (-0.909986 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.6939985752105713
Epoch: 6, Steps: 18 | Train Loss: 0.456 Vali Loss: 0.418 Vali Acc: 0.957 Test Loss: 0.418 Test Acc: 0.957
Validation loss decreased (-0.949993 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 0.7046475410461426
Epoch: 7, Steps: 18 | Train Loss: 0.226 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.6114315986633301
Epoch: 8, Steps: 18 | Train Loss: 0.132 Vali Loss: 0.222 Vali Acc: 0.960 Test Loss: 0.222 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7666075229644775
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.193 Vali Acc: 0.970 Test Loss: 0.193 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.6648967266082764
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7867445945739746
Epoch: 11, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8076047897338867
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7253568172454834
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.6583998203277588
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.826094388961792
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.6510694026947021
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7773013114929199
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7083652019500732
Epoch: 18, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.7134926319122314
Epoch: 19, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6698250770568848
Epoch: 20, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7543947696685791
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6221261024475098
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6808173656463623
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.649766206741333
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 0.5412261486053467
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.6286647319793701
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5329184532165527
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 0.5683887004852295
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6805074214935303
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5924475193023682
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7132883071899414
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6222693920135498
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6678884029388428
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6831755638122559
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6386368274688721
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.707223653793335
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.5900595188140869
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 58515
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.7620325088500977
Epoch: 1, Steps: 18 | Train Loss: 3.213 Vali Loss: 3.058 Vali Acc: 0.117 Test Loss: 3.058 Test Acc: 0.117
Validation loss decreased (inf --> -0.116636).  Saving model ...
Epoch: 2 cost time: 0.6788020133972168
Epoch: 2, Steps: 18 | Train Loss: 2.842 Vali Loss: 2.592 Vali Acc: 0.490 Test Loss: 2.592 Test Acc: 0.490
Validation loss decreased (-0.116636 --> -0.489974).  Saving model ...
Epoch: 3 cost time: 0.6230640411376953
Epoch: 3, Steps: 18 | Train Loss: 2.271 Vali Loss: 2.002 Vali Acc: 0.803 Test Loss: 2.002 Test Acc: 0.803
Validation loss decreased (-0.489974 --> -0.803313).  Saving model ...
Epoch: 4 cost time: 0.691500186920166
Epoch: 4, Steps: 18 | Train Loss: 1.596 Vali Loss: 1.310 Vali Acc: 0.883 Test Loss: 1.310 Test Acc: 0.883
Validation loss decreased (-0.803313 --> -0.883320).  Saving model ...
Epoch: 5 cost time: 0.6036694049835205
Epoch: 5, Steps: 18 | Train Loss: 0.916 Vali Loss: 0.732 Vali Acc: 0.930 Test Loss: 0.732 Test Acc: 0.930
Validation loss decreased (-0.883320 --> -0.929993).  Saving model ...
Epoch: 6 cost time: 0.5280606746673584
Epoch: 6, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.405 Vali Acc: 0.957 Test Loss: 0.405 Test Acc: 0.957
Validation loss decreased (-0.929993 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.6250252723693848
Epoch: 7, Steps: 18 | Train Loss: 0.236 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.6003601551055908
Epoch: 8, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7302167415618896
Epoch: 9, Steps: 18 | Train Loss: 0.081 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6734967231750488
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7312276363372803
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7620410919189453
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.650266170501709
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.7473571300506592
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7012336254119873
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6743156909942627
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7257463932037354
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.6107234954833984
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.6830494403839111
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.6302216053009033
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6729609966278076
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.6752591133117676
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.7044188976287842
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.7661325931549072
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.7013216018676758
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6080751419067383
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.650252103805542
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.6335456371307373
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.6418688297271729
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6723623275756836
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.7652385234832764
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8350222110748291
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.7740607261657715
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.655421257019043
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 35 cost time: 0.7951605319976807
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 0.6878385543823242
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 37 cost time: 0.7431759834289551
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.759953498840332
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7686104774475098
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8070354461669922
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7553749084472656
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7479188442230225
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6864039897918701
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8094415664672852
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7050457000732422
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.758070707321167
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 57061
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.991701364517212
Epoch: 1, Steps: 18 | Train Loss: 3.247 Vali Loss: 3.064 Vali Acc: 0.073 Test Loss: 3.064 Test Acc: 0.073
Validation loss decreased (inf --> -0.073303).  Saving model ...
Epoch: 2 cost time: 0.659168004989624
Epoch: 2, Steps: 18 | Train Loss: 2.879 Vali Loss: 2.614 Vali Acc: 0.490 Test Loss: 2.614 Test Acc: 0.490
Validation loss decreased (-0.073303 --> -0.489974).  Saving model ...
Epoch: 3 cost time: 0.7057945728302002
Epoch: 3, Steps: 18 | Train Loss: 2.333 Vali Loss: 2.014 Vali Acc: 0.823 Test Loss: 2.014 Test Acc: 0.823
Validation loss decreased (-0.489974 --> -0.823313).  Saving model ...
Epoch: 4 cost time: 0.7020201683044434
Epoch: 4, Steps: 18 | Train Loss: 1.626 Vali Loss: 1.321 Vali Acc: 0.917 Test Loss: 1.321 Test Acc: 0.917
Validation loss decreased (-0.823313 --> -0.916653).  Saving model ...
Epoch: 5 cost time: 0.681333065032959
Epoch: 5, Steps: 18 | Train Loss: 0.923 Vali Loss: 0.726 Vali Acc: 0.940 Test Loss: 0.726 Test Acc: 0.940
Validation loss decreased (-0.916653 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.7351024150848389
Epoch: 6, Steps: 18 | Train Loss: 0.435 Vali Loss: 0.413 Vali Acc: 0.953 Test Loss: 0.413 Test Acc: 0.953
Validation loss decreased (-0.939993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.6357545852661133
Epoch: 7, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.6590538024902344
Epoch: 8, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.225 Vali Acc: 0.957 Test Loss: 0.225 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8384499549865723
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
Validation loss decreased (-0.959997 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6509206295013428
Epoch: 10, Steps: 18 | Train Loss: 0.064 Vali Loss: 0.177 Vali Acc: 0.963 Test Loss: 0.177 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8393211364746094
Epoch: 11, Steps: 18 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.6355624198913574
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.7866528034210205
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.5989158153533936
Epoch: 14, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.7300572395324707
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.687608003616333
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7524962425231934
Epoch: 17, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.7675635814666748
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6816134452819824
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 0.856830358505249
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.6701152324676514
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.7303340435028076
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7568800449371338
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.6375021934509277
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 25 cost time: 0.7501211166381836
Epoch: 25, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.659083366394043
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.6904010772705078
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7359087467193604
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.6975746154785156
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8991987705230713
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6702396869659424
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8135817050933838
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7403085231781006
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8488306999206543
Epoch: 34, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6483790874481201
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6440668106079102
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6960411071777344
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7269587516784668
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 58581
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.937067985534668
Epoch: 1, Steps: 18 | Train Loss: 3.227 Vali Loss: 3.071 Vali Acc: 0.100 Test Loss: 3.071 Test Acc: 0.100
Validation loss decreased (inf --> -0.099969).  Saving model ...
Epoch: 2 cost time: 0.6957077980041504
Epoch: 2, Steps: 18 | Train Loss: 2.860 Vali Loss: 2.615 Vali Acc: 0.467 Test Loss: 2.615 Test Acc: 0.467
Validation loss decreased (-0.099969 --> -0.466641).  Saving model ...
Epoch: 3 cost time: 0.6252884864807129
Epoch: 3, Steps: 18 | Train Loss: 2.311 Vali Loss: 1.994 Vali Acc: 0.800 Test Loss: 1.994 Test Acc: 0.800
Validation loss decreased (-0.466641 --> -0.799980).  Saving model ...
Epoch: 4 cost time: 0.7181386947631836
Epoch: 4, Steps: 18 | Train Loss: 1.591 Vali Loss: 1.283 Vali Acc: 0.910 Test Loss: 1.283 Test Acc: 0.910
Validation loss decreased (-0.799980 --> -0.909987).  Saving model ...
Epoch: 5 cost time: 0.637237548828125
Epoch: 5, Steps: 18 | Train Loss: 0.884 Vali Loss: 0.707 Vali Acc: 0.950 Test Loss: 0.707 Test Acc: 0.950
Validation loss decreased (-0.909987 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.6940743923187256
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.403 Vali Acc: 0.957 Test Loss: 0.403 Test Acc: 0.957
Validation loss decreased (-0.949993 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.6610252857208252
Epoch: 7, Steps: 18 | Train Loss: 0.221 Vali Loss: 0.274 Vali Acc: 0.963 Test Loss: 0.274 Test Acc: 0.963
Validation loss decreased (-0.956663 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.647174596786499
Epoch: 8, Steps: 18 | Train Loss: 0.131 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.8335075378417969
Epoch: 9, Steps: 18 | Train Loss: 0.086 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.6833198070526123
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6548635959625244
Epoch: 11, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.6420221328735352
Epoch: 12, Steps: 18 | Train Loss: 0.037 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 0.6452276706695557
Epoch: 13, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
Validation loss decreased (-0.966665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.8047394752502441
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7508153915405273
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7382986545562744
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7058546543121338
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7259871959686279
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8111517429351807
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.7802910804748535
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.7208139896392822
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 22 cost time: 0.7301599979400635
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.6999733448028564
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.7429325580596924
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.6601307392120361
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7391290664672852
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.7911419868469238
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6591038703918457
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7574515342712402
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8329954147338867
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7944087982177734
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 32 cost time: 0.727363109588623
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7599198818206787
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 34 cost time: 0.7132539749145508
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7489161491394043
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7594914436340332
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7485260963439941
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6734466552734375
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8172817230224609
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6894118785858154
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7719669342041016
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7368371486663818
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6540923118591309
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 58035
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9565098285675049
Epoch: 1, Steps: 18 | Train Loss: 3.240 Vali Loss: 3.090 Vali Acc: 0.110 Test Loss: 3.090 Test Acc: 0.110
Validation loss decreased (inf --> -0.109969).  Saving model ...
Epoch: 2 cost time: 0.6194596290588379
Epoch: 2, Steps: 18 | Train Loss: 2.886 Vali Loss: 2.626 Vali Acc: 0.467 Test Loss: 2.626 Test Acc: 0.467
Validation loss decreased (-0.109969 --> -0.466640).  Saving model ...
Epoch: 3 cost time: 0.7144947052001953
Epoch: 3, Steps: 18 | Train Loss: 2.316 Vali Loss: 2.004 Vali Acc: 0.767 Test Loss: 2.004 Test Acc: 0.767
Validation loss decreased (-0.466640 --> -0.766647).  Saving model ...
Epoch: 4 cost time: 0.7908370494842529
Epoch: 4, Steps: 18 | Train Loss: 1.622 Vali Loss: 1.294 Vali Acc: 0.887 Test Loss: 1.294 Test Acc: 0.887
Validation loss decreased (-0.766647 --> -0.886654).  Saving model ...
Epoch: 5 cost time: 0.7436907291412354
Epoch: 5, Steps: 18 | Train Loss: 0.878 Vali Loss: 0.693 Vali Acc: 0.937 Test Loss: 0.693 Test Acc: 0.937
Validation loss decreased (-0.886654 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 0.747096061706543
Epoch: 6, Steps: 18 | Train Loss: 0.408 Vali Loss: 0.389 Vali Acc: 0.963 Test Loss: 0.389 Test Acc: 0.963
Validation loss decreased (-0.936660 --> -0.963329).  Saving model ...
Epoch: 7 cost time: 0.6698360443115234
Epoch: 7, Steps: 18 | Train Loss: 0.208 Vali Loss: 0.279 Vali Acc: 0.963 Test Loss: 0.279 Test Acc: 0.963
Validation loss decreased (-0.963329 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.7146003246307373
Epoch: 8, Steps: 18 | Train Loss: 0.120 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966664).  Saving model ...
Epoch: 9 cost time: 0.7401163578033447
Epoch: 9, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.7017593383789062
Epoch: 10, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6217555999755859
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.161 Vali Acc: 0.973 Test Loss: 0.161 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.8015141487121582
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7449126243591309
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.7371654510498047
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.7284035682678223
Epoch: 15, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7865793704986572
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7852563858032227
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.8134891986846924
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7423510551452637
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.7598786354064941
Epoch: 20, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6794040203094482
Epoch: 21, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6953563690185547
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6868884563446045
Epoch: 23, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6528289318084717
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7488157749176025
Epoch: 25, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6018295288085938
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7120044231414795
Epoch: 27, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6946759223937988
Epoch: 28, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7394306659698486
Epoch: 29, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 57205
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0424790382385254
Epoch: 1, Steps: 18 | Train Loss: 3.165 Vali Loss: 3.035 Vali Acc: 0.123 Test Loss: 3.035 Test Acc: 0.123
Validation loss decreased (inf --> -0.123303).  Saving model ...
Epoch: 2 cost time: 0.5993013381958008
Epoch: 2, Steps: 18 | Train Loss: 2.780 Vali Loss: 2.541 Vali Acc: 0.570 Test Loss: 2.541 Test Acc: 0.570
Validation loss decreased (-0.123303 --> -0.569975).  Saving model ...
Epoch: 3 cost time: 0.7151157855987549
Epoch: 3, Steps: 18 | Train Loss: 2.188 Vali Loss: 1.917 Vali Acc: 0.807 Test Loss: 1.917 Test Acc: 0.807
Validation loss decreased (-0.569975 --> -0.806647).  Saving model ...
Epoch: 4 cost time: 0.7225205898284912
Epoch: 4, Steps: 18 | Train Loss: 1.508 Vali Loss: 1.220 Vali Acc: 0.903 Test Loss: 1.220 Test Acc: 0.903
Validation loss decreased (-0.806647 --> -0.903321).  Saving model ...
Epoch: 5 cost time: 0.6679160594940186
Epoch: 5, Steps: 18 | Train Loss: 0.812 Vali Loss: 0.652 Vali Acc: 0.933 Test Loss: 0.652 Test Acc: 0.933
Validation loss decreased (-0.903321 --> -0.933327).  Saving model ...
Epoch: 6 cost time: 0.7131457328796387
Epoch: 6, Steps: 18 | Train Loss: 0.362 Vali Loss: 0.368 Vali Acc: 0.953 Test Loss: 0.368 Test Acc: 0.953
Validation loss decreased (-0.933327 --> -0.953330).  Saving model ...
Epoch: 7 cost time: 0.7400040626525879
Epoch: 7, Steps: 18 | Train Loss: 0.171 Vali Loss: 0.260 Vali Acc: 0.957 Test Loss: 0.260 Test Acc: 0.957
Validation loss decreased (-0.953330 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.8898863792419434
Epoch: 8, Steps: 18 | Train Loss: 0.103 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.68845534324646
Epoch: 9, Steps: 18 | Train Loss: 0.065 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
Validation loss decreased (-0.959998 --> -0.959998).  Saving model ...
Epoch: 10 cost time: 0.7717843055725098
Epoch: 10, Steps: 18 | Train Loss: 0.045 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.677562952041626
Epoch: 11, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8587031364440918
Epoch: 12, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6639413833618164
Epoch: 13, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.798424243927002
Epoch: 14, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.72428297996521
Epoch: 15, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 16 cost time: 0.8128678798675537
Epoch: 16, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6712377071380615
Epoch: 17, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.957 Test Loss: 0.177 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7829649448394775
Epoch: 18, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7714390754699707
Epoch: 19, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8084108829498291
Epoch: 20, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.963 Test Loss: 0.186 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7213888168334961
Epoch: 21, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.963 Test Loss: 0.191 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6764178276062012
Epoch: 22, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7378425598144531
Epoch: 23, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.960 Test Loss: 0.202 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.766855001449585
Epoch: 24, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.235 Vali Acc: 0.943 Test Loss: 0.235 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.836923360824585
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.97
model parameter : 57317
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0549187660217285
Epoch: 1, Steps: 18 | Train Loss: 3.137 Vali Loss: 2.977 Vali Acc: 0.190 Test Loss: 2.977 Test Acc: 0.190
Validation loss decreased (inf --> -0.189970).  Saving model ...
Epoch: 2 cost time: 0.7856316566467285
Epoch: 2, Steps: 18 | Train Loss: 2.761 Vali Loss: 2.520 Vali Acc: 0.540 Test Loss: 2.520 Test Acc: 0.540
Validation loss decreased (-0.189970 --> -0.539975).  Saving model ...
Epoch: 3 cost time: 0.773698091506958
Epoch: 3, Steps: 18 | Train Loss: 2.211 Vali Loss: 1.892 Vali Acc: 0.833 Test Loss: 1.892 Test Acc: 0.833
Validation loss decreased (-0.539975 --> -0.833314).  Saving model ...
Epoch: 4 cost time: 0.7229633331298828
Epoch: 4, Steps: 18 | Train Loss: 1.488 Vali Loss: 1.207 Vali Acc: 0.893 Test Loss: 1.207 Test Acc: 0.893
Validation loss decreased (-0.833314 --> -0.893321).  Saving model ...
Epoch: 5 cost time: 0.7485709190368652
Epoch: 5, Steps: 18 | Train Loss: 0.820 Vali Loss: 0.678 Vali Acc: 0.943 Test Loss: 0.678 Test Acc: 0.943
Validation loss decreased (-0.893321 --> -0.943327).  Saving model ...
Epoch: 6 cost time: 0.7193222045898438
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.403 Vali Acc: 0.950 Test Loss: 0.403 Test Acc: 0.950
Validation loss decreased (-0.943327 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 0.7158005237579346
Epoch: 7, Steps: 18 | Train Loss: 0.211 Vali Loss: 0.283 Vali Acc: 0.960 Test Loss: 0.283 Test Acc: 0.960
Validation loss decreased (-0.949996 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.733938455581665
Epoch: 8, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.229 Vali Acc: 0.963 Test Loss: 0.229 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.6655645370483398
Epoch: 9, Steps: 18 | Train Loss: 0.085 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6604938507080078
Epoch: 10, Steps: 18 | Train Loss: 0.060 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.732733964920044
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8643286228179932
Epoch: 12, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7337172031402588
Epoch: 13, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 0.8688890933990479
Epoch: 14, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.7322850227355957
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8145411014556885
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6628684997558594
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.883629322052002
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.8994467258453369
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.8253517150878906
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8390424251556396
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0481765270233154
Epoch: 22, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 0.9360756874084473
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.7658267021179199
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 0.7738466262817383
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.8353707790374756
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 0.8501787185668945
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 0.7772331237792969
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 0.8288342952728271
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9432458877563477
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.7961986064910889
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.8987448215484619
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 33 cost time: 0.9835302829742432
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 34 cost time: 0.8525865077972412
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9494364261627197
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 0.8385627269744873
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8345894813537598
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 0.7858676910400391
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0602316856384277
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7948017120361328
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 41 cost time: 0.8490049839019775
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 0.7887163162231445
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 43 cost time: 0.8376936912536621
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8168294429779053
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7703065872192383
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.759777307510376
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8645241260528564
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7220444679260254
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0222103595733643
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8917303085327148
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.9381544589996338
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7685415744781494
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 0.9362926483154297
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9135763645172119
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8053712844848633
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.7893905639648438
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.1024014949798584
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 0.8000292778015137
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 0.8002207279205322
Epoch: 59, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8421528339385986
Epoch: 60, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.0527043342590332
Epoch: 61, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9043631553649902
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 63 cost time: 1.0005602836608887
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8591279983520508
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 0.9573588371276855
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8434274196624756
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 0.917107105255127
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 0.7692975997924805
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 69 cost time: 0.7903554439544678
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 70 cost time: 0.9770529270172119
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8776178359985352
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9187271595001221
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9299120903015137
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 74 cost time: 0.9585416316986084
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.7471892833709717
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.9615426063537598
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.9316654205322266
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.898334264755249
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.7445387840270996
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.8901419639587402
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.9705312252044678
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.918414831161499
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.8380281925201416
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 57963
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9037103652954102
Epoch: 1, Steps: 18 | Train Loss: 3.139 Vali Loss: 3.018 Vali Acc: 0.153 Test Loss: 3.018 Test Acc: 0.153
Validation loss decreased (inf --> -0.153303).  Saving model ...
Epoch: 2 cost time: 0.5694453716278076
Epoch: 2, Steps: 18 | Train Loss: 2.789 Vali Loss: 2.563 Vali Acc: 0.447 Test Loss: 2.563 Test Acc: 0.447
Validation loss decreased (-0.153303 --> -0.446641).  Saving model ...
Epoch: 3 cost time: 0.6856484413146973
Epoch: 3, Steps: 18 | Train Loss: 2.258 Vali Loss: 1.958 Vali Acc: 0.760 Test Loss: 1.958 Test Acc: 0.760
Validation loss decreased (-0.446641 --> -0.759980).  Saving model ...
Epoch: 4 cost time: 0.6213347911834717
Epoch: 4, Steps: 18 | Train Loss: 1.538 Vali Loss: 1.262 Vali Acc: 0.880 Test Loss: 1.262 Test Acc: 0.880
Validation loss decreased (-0.759980 --> -0.879987).  Saving model ...
Epoch: 5 cost time: 0.6311485767364502
Epoch: 5, Steps: 18 | Train Loss: 0.839 Vali Loss: 0.695 Vali Acc: 0.937 Test Loss: 0.695 Test Acc: 0.937
Validation loss decreased (-0.879987 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 0.6582388877868652
Epoch: 6, Steps: 18 | Train Loss: 0.410 Vali Loss: 0.412 Vali Acc: 0.940 Test Loss: 0.412 Test Acc: 0.940
Validation loss decreased (-0.936660 --> -0.939996).  Saving model ...
Epoch: 7 cost time: 0.6000254154205322
Epoch: 7, Steps: 18 | Train Loss: 0.218 Vali Loss: 0.292 Vali Acc: 0.947 Test Loss: 0.292 Test Acc: 0.947
Validation loss decreased (-0.939996 --> -0.946664).  Saving model ...
Epoch: 8 cost time: 0.7099688053131104
Epoch: 8, Steps: 18 | Train Loss: 0.141 Vali Loss: 0.235 Vali Acc: 0.960 Test Loss: 0.235 Test Acc: 0.960
Validation loss decreased (-0.946664 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.6362617015838623
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6912069320678711
Epoch: 10, Steps: 18 | Train Loss: 0.063 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 0.6660387516021729
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5666310787200928
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.6130573749542236
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.152 Vali Acc: 0.970 Test Loss: 0.152 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 14 cost time: 0.7705276012420654
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 0.6013493537902832
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.6875905990600586
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.7370965480804443
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6719210147857666
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.738696813583374
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7409148216247559
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.657257080078125
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6605379581451416
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.6799063682556152
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.6534368991851807
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6759796142578125
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 26 cost time: 0.7032389640808105
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6930978298187256
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.7650997638702393
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.8006641864776611
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 30 cost time: 0.7727959156036377
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.973 Test Loss: 0.129 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.7870984077453613
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 0.7230715751647949
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 33 cost time: 0.6869163513183594
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 34 cost time: 0.6498606204986572
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6045858860015869
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6773273944854736
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6299343109130859
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7236075401306152
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 39 cost time: 0.7887845039367676
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7838442325592041
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6468815803527832
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7536895275115967
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6550328731536865
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8256330490112305
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 45 cost time: 0.6500241756439209
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.980 Test Loss: 0.131 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 46 cost time: 0.6371195316314697
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6869533061981201
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7036917209625244
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.766826868057251
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6554949283599854
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6537759304046631
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.7484545707702637
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.136 Vali Acc: 0.980 Test Loss: 0.136 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7275955677032471
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6809816360473633
Epoch: 54, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.6807951927185059
Epoch: 55, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.980 Test Loss: 0.138 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 55725
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.786803960800171
Epoch: 1, Steps: 18 | Train Loss: 3.320 Vali Loss: 3.168 Vali Acc: 0.137 Test Loss: 3.168 Test Acc: 0.137
Validation loss decreased (inf --> -0.136635).  Saving model ...
Epoch: 2 cost time: 0.7439301013946533
Epoch: 2, Steps: 18 | Train Loss: 2.940 Vali Loss: 2.689 Vali Acc: 0.453 Test Loss: 2.689 Test Acc: 0.453
Validation loss decreased (-0.136635 --> -0.453306).  Saving model ...
Epoch: 3 cost time: 0.610924482345581
Epoch: 3, Steps: 18 | Train Loss: 2.359 Vali Loss: 2.074 Vali Acc: 0.800 Test Loss: 2.074 Test Acc: 0.800
Validation loss decreased (-0.453306 --> -0.799979).  Saving model ...
Epoch: 4 cost time: 0.8207862377166748
Epoch: 4, Steps: 18 | Train Loss: 1.642 Vali Loss: 1.351 Vali Acc: 0.910 Test Loss: 1.351 Test Acc: 0.910
Validation loss decreased (-0.799979 --> -0.909986).  Saving model ...
Epoch: 5 cost time: 0.6792874336242676
Epoch: 5, Steps: 18 | Train Loss: 0.952 Vali Loss: 0.749 Vali Acc: 0.940 Test Loss: 0.749 Test Acc: 0.940
Validation loss decreased (-0.909986 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 0.8435328006744385
Epoch: 6, Steps: 18 | Train Loss: 0.459 Vali Loss: 0.414 Vali Acc: 0.953 Test Loss: 0.414 Test Acc: 0.953
Validation loss decreased (-0.939993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.7496044635772705
Epoch: 7, Steps: 18 | Train Loss: 0.234 Vali Loss: 0.289 Vali Acc: 0.960 Test Loss: 0.289 Test Acc: 0.960
Validation loss decreased (-0.953329 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.99996018409729
Epoch: 8, Steps: 18 | Train Loss: 0.128 Vali Loss: 0.226 Vali Acc: 0.963 Test Loss: 0.226 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.7788691520690918
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.6326744556427002
Epoch: 10, Steps: 18 | Train Loss: 0.062 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.6440634727478027
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.6456127166748047
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.7090389728546143
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.969998 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.6938211917877197
Epoch: 14, Steps: 18 | Train Loss: 0.023 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7138237953186035
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8623135089874268
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.8593795299530029
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7091784477233887
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.7575116157531738
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.6227505207061768
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.7852940559387207
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.7673704624176025
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7568755149841309
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.674943208694458
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6851024627685547
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.758080244064331
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 0.6925191879272461
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7764384746551514
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 0.7266232967376709
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 0.7644176483154297
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.7863028049468994
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.6889703273773193
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7822544574737549
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7156651020050049
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 35 cost time: 0.8200888633728027
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 36 cost time: 0.8510794639587402
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8792002201080322
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9733395576477051
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8333909511566162
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7042074203491211
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.980 Test Loss: 0.120 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9742114543914795
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.7617497444152832
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7550694942474365
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.814795970916748
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.8679518699645996
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 55355
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.146434783935547
Epoch: 1, Steps: 18 | Train Loss: 3.301 Vali Loss: 3.113 Vali Acc: 0.137 Test Loss: 3.113 Test Acc: 0.137
Validation loss decreased (inf --> -0.136636).  Saving model ...
Epoch: 2 cost time: 0.6692805290222168
Epoch: 2, Steps: 18 | Train Loss: 2.944 Vali Loss: 2.654 Vali Acc: 0.463 Test Loss: 2.654 Test Acc: 0.463
Validation loss decreased (-0.136636 --> -0.463307).  Saving model ...
Epoch: 3 cost time: 0.8907556533813477
Epoch: 3, Steps: 18 | Train Loss: 2.381 Vali Loss: 2.056 Vali Acc: 0.797 Test Loss: 2.056 Test Acc: 0.797
Validation loss decreased (-0.463307 --> -0.796646).  Saving model ...
Epoch: 4 cost time: 0.8457825183868408
Epoch: 4, Steps: 18 | Train Loss: 1.694 Vali Loss: 1.351 Vali Acc: 0.930 Test Loss: 1.351 Test Acc: 0.930
Validation loss decreased (-0.796646 --> -0.929986).  Saving model ...
Epoch: 5 cost time: 0.9426724910736084
Epoch: 5, Steps: 18 | Train Loss: 0.958 Vali Loss: 0.723 Vali Acc: 0.937 Test Loss: 0.723 Test Acc: 0.937
Validation loss decreased (-0.929986 --> -0.936659).  Saving model ...
Epoch: 6 cost time: 0.7441003322601318
Epoch: 6, Steps: 18 | Train Loss: 0.449 Vali Loss: 0.379 Vali Acc: 0.967 Test Loss: 0.379 Test Acc: 0.967
Validation loss decreased (-0.936659 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 0.7019858360290527
Epoch: 7, Steps: 18 | Train Loss: 0.207 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.8761048316955566
Epoch: 8, Steps: 18 | Train Loss: 0.127 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.6845419406890869
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.8097488880157471
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.155 Vali Acc: 0.973 Test Loss: 0.155 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.7125225067138672
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.7942924499511719
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.714587926864624
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.7270898818969727
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8355350494384766
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.6901745796203613
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.976665 --> -0.979999).  Saving model ...
Epoch: 17 cost time: 0.8596153259277344
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9263346195220947
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 19 cost time: 0.7200860977172852
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8916070461273193
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 21 cost time: 0.7964482307434082
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.980 Test Loss: 0.115 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8493525981903076
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 23 cost time: 0.7194228172302246
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 24 cost time: 0.7908251285552979
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8382339477539062
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9578971862792969
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 27 cost time: 0.759033203125
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0084521770477295
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6666879653930664
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 30 cost time: 0.6418662071228027
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 31 cost time: 0.6991658210754395
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7742540836334229
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8541550636291504
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8885011672973633
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8138220310211182
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.69317626953125
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8323192596435547
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7634453773498535
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7655923366546631
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7398269176483154
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 55181
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.258296489715576
Epoch: 1, Steps: 18 | Train Loss: 3.305 Vali Loss: 3.103 Vali Acc: 0.133 Test Loss: 3.103 Test Acc: 0.133
Validation loss decreased (inf --> -0.133302).  Saving model ...
Epoch: 2 cost time: 0.67494797706604
Epoch: 2, Steps: 18 | Train Loss: 2.915 Vali Loss: 2.620 Vali Acc: 0.433 Test Loss: 2.620 Test Acc: 0.433
Validation loss decreased (-0.133302 --> -0.433307).  Saving model ...
Epoch: 3 cost time: 0.6155908107757568
Epoch: 3, Steps: 18 | Train Loss: 2.351 Vali Loss: 2.005 Vali Acc: 0.833 Test Loss: 2.005 Test Acc: 0.833
Validation loss decreased (-0.433307 --> -0.833313).  Saving model ...
Epoch: 4 cost time: 0.8095648288726807
Epoch: 4, Steps: 18 | Train Loss: 1.625 Vali Loss: 1.296 Vali Acc: 0.907 Test Loss: 1.296 Test Acc: 0.907
Validation loss decreased (-0.833313 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 0.6810581684112549
Epoch: 5, Steps: 18 | Train Loss: 0.920 Vali Loss: 0.688 Vali Acc: 0.947 Test Loss: 0.688 Test Acc: 0.947
Validation loss decreased (-0.906654 --> -0.946660).  Saving model ...
Epoch: 6 cost time: 0.7360959053039551
Epoch: 6, Steps: 18 | Train Loss: 0.424 Vali Loss: 0.378 Vali Acc: 0.957 Test Loss: 0.378 Test Acc: 0.957
Validation loss decreased (-0.946660 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.7955508232116699
Epoch: 7, Steps: 18 | Train Loss: 0.210 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.7539358139038086
Epoch: 8, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6501874923706055
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6655678749084473
Epoch: 10, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.7375531196594238
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.6023342609405518
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.7015752792358398
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 14 cost time: 0.6140305995941162
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 15 cost time: 0.663421630859375
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.720374345779419
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7368550300598145
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.6898114681243896
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7037389278411865
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.5785214900970459
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.6527023315429688
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7180490493774414
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 0.8086729049682617
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 0.6967930793762207
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 25 cost time: 0.682487964630127
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 26 cost time: 0.7124285697937012
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 27 cost time: 0.6842992305755615
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 28 cost time: 0.7923364639282227
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 29 cost time: 0.769641637802124
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6375439167022705
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.720165491104126
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7437238693237305
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 0.8085863590240479
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6616501808166504
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 0.702125072479248
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 36 cost time: 0.7523910999298096
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6908905506134033
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7215254306793213
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7668070793151855
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7675166130065918
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8145105838775635
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6425337791442871
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6356778144836426
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6631817817687988
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6984763145446777
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55235
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.0282411575317383
Epoch: 1, Steps: 18 | Train Loss: 3.195 Vali Loss: 3.030 Vali Acc: 0.150 Test Loss: 3.030 Test Acc: 0.150
Validation loss decreased (inf --> -0.149970).  Saving model ...
Epoch: 2 cost time: 0.6682145595550537
Epoch: 2, Steps: 18 | Train Loss: 2.823 Vali Loss: 2.577 Vali Acc: 0.447 Test Loss: 2.577 Test Acc: 0.447
Validation loss decreased (-0.149970 --> -0.446641).  Saving model ...
Epoch: 3 cost time: 0.673870325088501
Epoch: 3, Steps: 18 | Train Loss: 2.277 Vali Loss: 1.974 Vali Acc: 0.713 Test Loss: 1.974 Test Acc: 0.713
Validation loss decreased (-0.446641 --> -0.713314).  Saving model ...
Epoch: 4 cost time: 0.7221534252166748
Epoch: 4, Steps: 18 | Train Loss: 1.575 Vali Loss: 1.289 Vali Acc: 0.900 Test Loss: 1.289 Test Acc: 0.900
Validation loss decreased (-0.713314 --> -0.899987).  Saving model ...
Epoch: 5 cost time: 0.8017492294311523
Epoch: 5, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.701 Vali Acc: 0.950 Test Loss: 0.701 Test Acc: 0.950
Validation loss decreased (-0.899987 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 0.7017717361450195
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.393 Vali Acc: 0.967 Test Loss: 0.393 Test Acc: 0.967
Validation loss decreased (-0.949993 --> -0.966663).  Saving model ...
Epoch: 7 cost time: 0.7795605659484863
Epoch: 7, Steps: 18 | Train Loss: 0.212 Vali Loss: 0.272 Vali Acc: 0.967 Test Loss: 0.272 Test Acc: 0.967
Validation loss decreased (-0.966663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.587446928024292
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8065028190612793
Epoch: 9, Steps: 18 | Train Loss: 0.084 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
Validation loss decreased (-0.966664 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 0.7349667549133301
Epoch: 10, Steps: 18 | Train Loss: 0.082 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.840151309967041
Epoch: 11, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7212209701538086
Epoch: 12, Steps: 18 | Train Loss: 0.031 Vali Loss: 0.149 Vali Acc: 0.977 Test Loss: 0.149 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7433273792266846
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8242402076721191
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.924426794052124
Epoch: 15, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7812459468841553
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.6189272403717041
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.7274892330169678
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.8089916706085205
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6926360130310059
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.7518892288208008
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.6931726932525635
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 0.752234697341919
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.8166253566741943
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 0.6461277008056641
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.8688087463378906
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 0.7201237678527832
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 0.6423804759979248
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 0.7416248321533203
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.6688563823699951
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.6729412078857422
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7004773616790771
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6981959342956543
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 0.6641848087310791
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6873805522918701
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8285338878631592
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.80892014503479
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 38 cost time: 0.8799495697021484
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7283005714416504
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7285711765289307
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 41 cost time: 0.7957332134246826
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 42 cost time: 0.9254741668701172
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7405350208282471
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.163956642150879
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7197065353393555
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.757509708404541
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9019339084625244
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7483625411987305
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7824125289916992
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.914923906326294
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.7785005569458008
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55037
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 1.9962124824523926
Epoch: 1, Steps: 18 | Train Loss: 3.355 Vali Loss: 3.188 Vali Acc: 0.100 Test Loss: 3.188 Test Acc: 0.100
Validation loss decreased (inf --> -0.099968).  Saving model ...
Epoch: 2 cost time: 0.756342887878418
Epoch: 2, Steps: 18 | Train Loss: 3.018 Vali Loss: 2.740 Vali Acc: 0.370 Test Loss: 2.740 Test Acc: 0.370
Validation loss decreased (-0.099968 --> -0.369973).  Saving model ...
Epoch: 3 cost time: 0.8548412322998047
Epoch: 3, Steps: 18 | Train Loss: 2.461 Vali Loss: 2.152 Vali Acc: 0.720 Test Loss: 2.152 Test Acc: 0.720
Validation loss decreased (-0.369973 --> -0.719978).  Saving model ...
Epoch: 4 cost time: 0.6673135757446289
Epoch: 4, Steps: 18 | Train Loss: 1.753 Vali Loss: 1.464 Vali Acc: 0.873 Test Loss: 1.464 Test Acc: 0.873
Validation loss decreased (-0.719978 --> -0.873319).  Saving model ...
Epoch: 5 cost time: 0.7115805149078369
Epoch: 5, Steps: 18 | Train Loss: 1.061 Vali Loss: 0.825 Vali Acc: 0.933 Test Loss: 0.825 Test Acc: 0.933
Validation loss decreased (-0.873319 --> -0.933325).  Saving model ...
Epoch: 6 cost time: 0.6762549877166748
Epoch: 6, Steps: 18 | Train Loss: 0.510 Vali Loss: 0.444 Vali Acc: 0.957 Test Loss: 0.444 Test Acc: 0.957
Validation loss decreased (-0.933325 --> -0.956662).  Saving model ...
Epoch: 7 cost time: 0.8670127391815186
Epoch: 7, Steps: 18 | Train Loss: 0.252 Vali Loss: 0.282 Vali Acc: 0.967 Test Loss: 0.282 Test Acc: 0.967
Validation loss decreased (-0.956662 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.7818121910095215
Epoch: 8, Steps: 18 | Train Loss: 0.136 Vali Loss: 0.222 Vali Acc: 0.970 Test Loss: 0.222 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.969998).  Saving model ...
Epoch: 9 cost time: 0.6945524215698242
Epoch: 9, Steps: 18 | Train Loss: 0.100 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.7678601741790771
Epoch: 10, Steps: 18 | Train Loss: 0.061 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 11 cost time: 0.5969984531402588
Epoch: 11, Steps: 18 | Train Loss: 0.046 Vali Loss: 0.158 Vali Acc: 0.977 Test Loss: 0.158 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 12 cost time: 0.7487833499908447
Epoch: 12, Steps: 18 | Train Loss: 0.036 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 13 cost time: 0.7963011264801025
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.139 Vali Acc: 0.977 Test Loss: 0.139 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.7299978733062744
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.6662194728851318
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 16 cost time: 0.7680113315582275
Epoch: 16, Steps: 18 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.805534839630127
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 18 cost time: 0.8582613468170166
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.977 Test Loss: 0.125 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 19 cost time: 0.6800472736358643
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.8010120391845703
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.7095026969909668
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.7846248149871826
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7327861785888672
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.6583225727081299
Epoch: 24, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.659583330154419
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.8752968311309814
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 0.7795865535736084
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 28 cost time: 0.7418613433837891
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 1.13816237449646
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7279322147369385
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8787665367126465
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.9375317096710205
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8338415622711182
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.855074405670166
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8700199127197266
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 36 cost time: 0.8963639736175537
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8989207744598389
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.083967685699463
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2712743282318115
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7753736972808838
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7949120998382568
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.869049072265625
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9387867450714111
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9582207202911377
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.814342737197876
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55451
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.534228801727295
Epoch: 1, Steps: 18 | Train Loss: 3.186 Vali Loss: 3.047 Vali Acc: 0.167 Test Loss: 3.047 Test Acc: 0.167
Validation loss decreased (inf --> -0.166636).  Saving model ...
Epoch: 2 cost time: 0.9242584705352783
Epoch: 2, Steps: 18 | Train Loss: 2.823 Vali Loss: 2.559 Vali Acc: 0.473 Test Loss: 2.559 Test Acc: 0.473
Validation loss decreased (-0.166636 --> -0.473308).  Saving model ...
Epoch: 3 cost time: 0.766211986541748
Epoch: 3, Steps: 18 | Train Loss: 2.234 Vali Loss: 1.930 Vali Acc: 0.783 Test Loss: 1.930 Test Acc: 0.783
Validation loss decreased (-0.473308 --> -0.783314).  Saving model ...
Epoch: 4 cost time: 1.0201923847198486
Epoch: 4, Steps: 18 | Train Loss: 1.523 Vali Loss: 1.238 Vali Acc: 0.913 Test Loss: 1.238 Test Acc: 0.913
Validation loss decreased (-0.783314 --> -0.913321).  Saving model ...
Epoch: 5 cost time: 0.9588148593902588
Epoch: 5, Steps: 18 | Train Loss: 0.838 Vali Loss: 0.690 Vali Acc: 0.930 Test Loss: 0.690 Test Acc: 0.930
Validation loss decreased (-0.913321 --> -0.929993).  Saving model ...
Epoch: 6 cost time: 0.8306665420532227
Epoch: 6, Steps: 18 | Train Loss: 0.417 Vali Loss: 0.393 Vali Acc: 0.953 Test Loss: 0.393 Test Acc: 0.953
Validation loss decreased (-0.929993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 0.911750078201294
Epoch: 7, Steps: 18 | Train Loss: 0.209 Vali Loss: 0.273 Vali Acc: 0.957 Test Loss: 0.273 Test Acc: 0.957
Validation loss decreased (-0.953329 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 0.9461483955383301
Epoch: 8, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.956664 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.9615323543548584
Epoch: 9, Steps: 18 | Train Loss: 0.075 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.9000298976898193
Epoch: 10, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963332).  Saving model ...
Epoch: 11 cost time: 0.9345207214355469
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 12 cost time: 0.7542445659637451
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 13 cost time: 1.0849220752716064
Epoch: 13, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 14 cost time: 0.8179342746734619
Epoch: 14, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.963 Test Loss: 0.144 Test Acc: 0.963
Validation loss decreased (-0.963332 --> -0.963332).  Saving model ...
Epoch: 15 cost time: 0.7711002826690674
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.963332 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 0.8943755626678467
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 0.8050098419189453
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8419473171234131
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.951401948928833
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.029106855392456
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 1.0328118801116943
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.8432266712188721
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 23 cost time: 0.8983154296875
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8789670467376709
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8643770217895508
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 26 cost time: 0.9085102081298828
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.853050708770752
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9664819240570068
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 29 cost time: 1.1657764911651611
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 1.0484538078308105
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9253389835357666
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.872844934463501
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9825999736785889
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 34 cost time: 1.0115282535552979
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 35 cost time: 1.1855530738830566
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.308570384979248
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.085040807723999
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 1.2171423435211182
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1337058544158936
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0352957248687744
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9919247627258301
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 42 cost time: 1.0911779403686523
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0051705837249756
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0796902179718018
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 45 cost time: 1.178532600402832
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 46 cost time: 0.859295129776001
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 47 cost time: 1.0365731716156006
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2050888538360596
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 49 cost time: 0.9279546737670898
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0452146530151367
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 51 cost time: 0.9435012340545654
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.3096706867218018
Epoch: 52, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 53 cost time: 1.214750051498413
Epoch: 53, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0607013702392578
Epoch: 54, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 55 cost time: 1.4124655723571777
Epoch: 55, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 56 cost time: 0.8756084442138672
Epoch: 56, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 57 cost time: 1.1074273586273193
Epoch: 57, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 58 cost time: 1.4680721759796143
Epoch: 58, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 59 cost time: 1.1084568500518799
Epoch: 59, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.2846686840057373
Epoch: 60, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 61 cost time: 1.0319807529449463
Epoch: 61, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 62 cost time: 1.1485717296600342
Epoch: 62, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.2426502704620361
Epoch: 63, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 1.0706300735473633
Epoch: 64, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 65 cost time: 1.103276014328003
Epoch: 65, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0801565647125244
Epoch: 66, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 67 cost time: 1.268326759338379
Epoch: 67, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 68 cost time: 1.1445882320404053
Epoch: 68, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1465904712677002
Epoch: 69, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 70 cost time: 1.1881067752838135
Epoch: 70, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 71 cost time: 1.108668565750122
Epoch: 71, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 72 cost time: 1.1198749542236328
Epoch: 72, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 73 cost time: 0.8880364894866943
Epoch: 73, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 74 cost time: 1.1769986152648926
Epoch: 74, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 75 cost time: 0.9723310470581055
Epoch: 75, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 76 cost time: 1.3457577228546143
Epoch: 76, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 77 cost time: 1.063978672027588
Epoch: 77, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 78 cost time: 0.9854762554168701
Epoch: 78, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 79 cost time: 1.2036006450653076
Epoch: 79, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 80 cost time: 1.2448506355285645
Epoch: 80, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 81 cost time: 1.1667907238006592
Epoch: 81, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 82 cost time: 1.3291113376617432
Epoch: 82, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1602795124053955
Epoch: 83, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
Validation loss decreased (-0.976666 --> -0.979999).  Saving model ...
Epoch: 84 cost time: 1.3291442394256592
Epoch: 84, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 85 cost time: 1.1730432510375977
Epoch: 85, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 86 cost time: 1.2585437297821045
Epoch: 86, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 87 cost time: 1.2443022727966309
Epoch: 87, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 88 cost time: 1.0629336833953857
Epoch: 88, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 89 cost time: 1.168900728225708
Epoch: 89, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 90 cost time: 1.1321370601654053
Epoch: 90, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 91 cost time: 1.1470649242401123
Epoch: 91, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 92 cost time: 1.3531875610351562
Epoch: 92, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.4244418144226074
Epoch: 93, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 94 cost time: 1.0464589595794678
Epoch: 94, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 95 cost time: 1.042567491531372
Epoch: 95, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 96 cost time: 1.0716700553894043
Epoch: 96, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 97 cost time: 1.0245184898376465
Epoch: 97, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 98 cost time: 1.3061120510101318
Epoch: 98, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 99 cost time: 1.0305914878845215
Epoch: 99, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
Epoch: 100 cost time: 1.4380395412445068
Epoch: 100, Steps: 18 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979999 --> -0.979999).  Saving model ...
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.98
model parameter : 55005
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.400022506713867
Epoch: 1, Steps: 18 | Train Loss: 3.166 Vali Loss: 3.008 Vali Acc: 0.140 Test Loss: 3.008 Test Acc: 0.140
Validation loss decreased (inf --> -0.139970).  Saving model ...
Epoch: 2 cost time: 0.7236671447753906
Epoch: 2, Steps: 18 | Train Loss: 2.784 Vali Loss: 2.525 Vali Acc: 0.583 Test Loss: 2.525 Test Acc: 0.583
Validation loss decreased (-0.139970 --> -0.583308).  Saving model ...
Epoch: 3 cost time: 0.7169816493988037
Epoch: 3, Steps: 18 | Train Loss: 2.174 Vali Loss: 1.880 Vali Acc: 0.853 Test Loss: 1.880 Test Acc: 0.853
Validation loss decreased (-0.583308 --> -0.853315).  Saving model ...
Epoch: 4 cost time: 1.2300121784210205
Epoch: 4, Steps: 18 | Train Loss: 1.476 Vali Loss: 1.177 Vali Acc: 0.927 Test Loss: 1.177 Test Acc: 0.927
Validation loss decreased (-0.853315 --> -0.926655).  Saving model ...
Epoch: 5 cost time: 1.2022814750671387
Epoch: 5, Steps: 18 | Train Loss: 0.804 Vali Loss: 0.649 Vali Acc: 0.927 Test Loss: 0.649 Test Acc: 0.927
Validation loss decreased (-0.926655 --> -0.926660).  Saving model ...
Epoch: 6 cost time: 1.0432507991790771
Epoch: 6, Steps: 18 | Train Loss: 0.381 Vali Loss: 0.373 Vali Acc: 0.957 Test Loss: 0.373 Test Acc: 0.957
Validation loss decreased (-0.926660 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 1.3395423889160156
Epoch: 7, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.262 Vali Acc: 0.967 Test Loss: 0.262 Test Acc: 0.967
Validation loss decreased (-0.956663 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 0.8342962265014648
Epoch: 8, Steps: 18 | Train Loss: 0.117 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0340046882629395
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.188 Vali Acc: 0.967 Test Loss: 0.188 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 1.1463348865509033
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.970 Test Loss: 0.172 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.9506266117095947
Epoch: 11, Steps: 18 | Train Loss: 0.044 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0755870342254639
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.034226417541504
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9927613735198975
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.1420812606811523
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8523232936859131
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.9419832229614258
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.9120662212371826
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1594958305358887
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.447986364364624
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 1.389754056930542
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 1.0533816814422607
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 0.8821587562561035
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9557955265045166
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.0086517333984375
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0601043701171875
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.0783069133758545
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9235413074493408
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0714292526245117
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 30 cost time: 1.0656211376190186
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 0.8716044425964355
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 32 cost time: 0.8964152336120605
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 33 cost time: 0.8622004985809326
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8181016445159912
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 35 cost time: 0.86965012550354
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9515204429626465
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 37 cost time: 1.3426201343536377
Epoch: 37, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 38 cost time: 0.9362578392028809
Epoch: 38, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8875195980072021
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9370660781860352
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.159639835357666
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0000033378601074
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8826758861541748
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8502178192138672
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9451193809509277
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9754350185394287
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1560556888580322
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55011
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.0097851753234863
Epoch: 1, Steps: 18 | Train Loss: 3.220 Vali Loss: 3.062 Vali Acc: 0.150 Test Loss: 3.062 Test Acc: 0.150
Validation loss decreased (inf --> -0.149969).  Saving model ...
Epoch: 2 cost time: 1.1416904926300049
Epoch: 2, Steps: 18 | Train Loss: 2.844 Vali Loss: 2.612 Vali Acc: 0.537 Test Loss: 2.612 Test Acc: 0.537
Validation loss decreased (-0.149969 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 0.9954798221588135
Epoch: 3, Steps: 18 | Train Loss: 2.296 Vali Loss: 1.997 Vali Acc: 0.823 Test Loss: 1.997 Test Acc: 0.823
Validation loss decreased (-0.536641 --> -0.823313).  Saving model ...
Epoch: 4 cost time: 0.9898560047149658
Epoch: 4, Steps: 18 | Train Loss: 1.613 Vali Loss: 1.291 Vali Acc: 0.897 Test Loss: 1.291 Test Acc: 0.897
Validation loss decreased (-0.823313 --> -0.896654).  Saving model ...
Epoch: 5 cost time: 1.207932949066162
Epoch: 5, Steps: 18 | Train Loss: 0.893 Vali Loss: 0.695 Vali Acc: 0.943 Test Loss: 0.695 Test Acc: 0.943
Validation loss decreased (-0.896654 --> -0.943326).  Saving model ...
Epoch: 6 cost time: 1.0531165599822998
Epoch: 6, Steps: 18 | Train Loss: 0.434 Vali Loss: 0.388 Vali Acc: 0.943 Test Loss: 0.388 Test Acc: 0.943
Validation loss decreased (-0.943326 --> -0.943329).  Saving model ...
Epoch: 7 cost time: 1.0797665119171143
Epoch: 7, Steps: 18 | Train Loss: 0.199 Vali Loss: 0.261 Vali Acc: 0.963 Test Loss: 0.261 Test Acc: 0.963
Validation loss decreased (-0.943329 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.2067935466766357
Epoch: 8, Steps: 18 | Train Loss: 0.126 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.131319284439087
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
Validation loss decreased (-0.963331 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.9737420082092285
Epoch: 10, Steps: 18 | Train Loss: 0.053 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8758978843688965
Epoch: 11, Steps: 18 | Train Loss: 0.039 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1262047290802002
Epoch: 12, Steps: 18 | Train Loss: 0.030 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9671657085418701
Epoch: 13, Steps: 18 | Train Loss: 0.028 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 1.1925296783447266
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1124300956726074
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 16 cost time: 0.9739089012145996
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.0165541172027588
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 18 cost time: 0.8703460693359375
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1794118881225586
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.9471883773803711
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 0.9174919128417969
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 0.9790079593658447
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976666).  Saving model ...
Epoch: 23 cost time: 1.0359175205230713
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 24 cost time: 1.0529091358184814
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9124279022216797
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9510517120361328
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8845565319061279
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8521547317504883
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9125690460205078
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 30 cost time: 0.9003579616546631
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 31 cost time: 0.9865932464599609
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0331690311431885
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 33 cost time: 1.0292303562164307
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 34 cost time: 1.0971312522888184
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.976666 --> -0.976666).  Saving model ...
Epoch: 35 cost time: 1.0519778728485107
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2009642124176025
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9169321060180664
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0075135231018066
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.010362148284912
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.090470790863037
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0363669395446777
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.147998332977295
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9299688339233398
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9742791652679443
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55901
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.739140510559082
Epoch: 1, Steps: 18 | Train Loss: 3.183 Vali Loss: 3.035 Vali Acc: 0.160 Test Loss: 3.035 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 0.9163353443145752
Epoch: 2, Steps: 18 | Train Loss: 2.817 Vali Loss: 2.570 Vali Acc: 0.563 Test Loss: 2.570 Test Acc: 0.563
Validation loss decreased (-0.159970 --> -0.563308).  Saving model ...
Epoch: 3 cost time: 0.9746301174163818
Epoch: 3, Steps: 18 | Train Loss: 2.242 Vali Loss: 1.960 Vali Acc: 0.790 Test Loss: 1.960 Test Acc: 0.790
Validation loss decreased (-0.563308 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 1.0289065837860107
Epoch: 4, Steps: 18 | Train Loss: 1.542 Vali Loss: 1.264 Vali Acc: 0.890 Test Loss: 1.264 Test Acc: 0.890
Validation loss decreased (-0.789980 --> -0.889987).  Saving model ...
Epoch: 5 cost time: 1.1497972011566162
Epoch: 5, Steps: 18 | Train Loss: 0.853 Vali Loss: 0.697 Vali Acc: 0.937 Test Loss: 0.697 Test Acc: 0.937
Validation loss decreased (-0.889987 --> -0.936660).  Saving model ...
Epoch: 6 cost time: 1.041971206665039
Epoch: 6, Steps: 18 | Train Loss: 0.406 Vali Loss: 0.399 Vali Acc: 0.950 Test Loss: 0.399 Test Acc: 0.950
Validation loss decreased (-0.936660 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 1.1617162227630615
Epoch: 7, Steps: 18 | Train Loss: 0.201 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
Validation loss decreased (-0.949996 --> -0.953331).  Saving model ...
Epoch: 8 cost time: 0.9888064861297607
Epoch: 8, Steps: 18 | Train Loss: 0.125 Vali Loss: 0.227 Vali Acc: 0.963 Test Loss: 0.227 Test Acc: 0.963
Validation loss decreased (-0.953331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.2453551292419434
Epoch: 9, Steps: 18 | Train Loss: 0.083 Vali Loss: 0.202 Vali Acc: 0.967 Test Loss: 0.202 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.9736723899841309
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.0494325160980225
Epoch: 11, Steps: 18 | Train Loss: 0.041 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 0.8825323581695557
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 13 cost time: 1.1090474128723145
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 14 cost time: 1.2944998741149902
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 15 cost time: 1.6279759407043457
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 16 cost time: 1.1528286933898926
Epoch: 16, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.0868158340454102
Epoch: 17, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0422914028167725
Epoch: 18, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.136 Vali Acc: 0.970 Test Loss: 0.136 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 19 cost time: 0.9709851741790771
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 20 cost time: 1.0787606239318848
Epoch: 20, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 21 cost time: 0.9120485782623291
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0541534423828125
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 23 cost time: 0.9630866050720215
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 24 cost time: 1.0123751163482666
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 25 cost time: 1.09035062789917
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 26 cost time: 0.9419946670532227
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 27 cost time: 1.0117661952972412
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0188713073730469
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.072784185409546
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8600339889526367
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 31 cost time: 0.9378442764282227
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 32 cost time: 0.8492224216461182
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 33 cost time: 0.9144771099090576
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 34 cost time: 1.1426091194152832
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0213401317596436
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8098483085632324
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9121887683868408
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 38 cost time: 1.0564172267913818
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0581092834472656
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0150811672210693
Epoch: 40, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9283912181854248
Epoch: 41, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 42 cost time: 1.043544054031372
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.187537670135498
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1552636623382568
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.3848083019256592
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9413597583770752
Epoch: 46, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.052741527557373
Epoch: 47, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9773602485656738
Epoch: 48, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9309418201446533
Epoch: 49, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9462411403656006
Epoch: 50, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.2297322750091553
Epoch: 51, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 56507
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.64121150970459
Epoch: 1, Steps: 18 | Train Loss: 3.223 Vali Loss: 3.076 Vali Acc: 0.120 Test Loss: 3.076 Test Acc: 0.120
Validation loss decreased (inf --> -0.119969).  Saving model ...
Epoch: 2 cost time: 1.1302051544189453
Epoch: 2, Steps: 18 | Train Loss: 2.878 Vali Loss: 2.623 Vali Acc: 0.390 Test Loss: 2.623 Test Acc: 0.390
Validation loss decreased (-0.119969 --> -0.389974).  Saving model ...
Epoch: 3 cost time: 0.923642635345459
Epoch: 3, Steps: 18 | Train Loss: 2.342 Vali Loss: 2.012 Vali Acc: 0.790 Test Loss: 2.012 Test Acc: 0.790
Validation loss decreased (-0.389974 --> -0.789980).  Saving model ...
Epoch: 4 cost time: 0.9340517520904541
Epoch: 4, Steps: 18 | Train Loss: 1.662 Vali Loss: 1.320 Vali Acc: 0.907 Test Loss: 1.320 Test Acc: 0.907
Validation loss decreased (-0.789980 --> -0.906653).  Saving model ...
Epoch: 5 cost time: 1.0883681774139404
Epoch: 5, Steps: 18 | Train Loss: 0.923 Vali Loss: 0.732 Vali Acc: 0.940 Test Loss: 0.732 Test Acc: 0.940
Validation loss decreased (-0.906653 --> -0.939993).  Saving model ...
Epoch: 6 cost time: 1.0669736862182617
Epoch: 6, Steps: 18 | Train Loss: 0.439 Vali Loss: 0.405 Vali Acc: 0.957 Test Loss: 0.405 Test Acc: 0.957
Validation loss decreased (-0.939993 --> -0.956663).  Saving model ...
Epoch: 7 cost time: 0.9290800094604492
Epoch: 7, Steps: 18 | Train Loss: 0.222 Vali Loss: 0.279 Vali Acc: 0.960 Test Loss: 0.279 Test Acc: 0.960
Validation loss decreased (-0.956663 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 0.8835868835449219
Epoch: 8, Steps: 18 | Train Loss: 0.121 Vali Loss: 0.219 Vali Acc: 0.963 Test Loss: 0.219 Test Acc: 0.963
Validation loss decreased (-0.959997 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.3562159538269043
Epoch: 9, Steps: 18 | Train Loss: 0.089 Vali Loss: 0.188 Vali Acc: 0.963 Test Loss: 0.188 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 10 cost time: 0.81315016746521
Epoch: 10, Steps: 18 | Train Loss: 0.058 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.126927375793457
Epoch: 11, Steps: 18 | Train Loss: 0.043 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.9884052276611328
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 0.9513003826141357
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 1.2176480293273926
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 15 cost time: 1.1207420825958252
Epoch: 15, Steps: 18 | Train Loss: 0.017 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 1.145517110824585
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0762419700622559
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8645615577697754
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.096329689025879
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.8177862167358398
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0881876945495605
Epoch: 21, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 22 cost time: 0.9123935699462891
Epoch: 22, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9854652881622314
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 24 cost time: 0.965418815612793
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0190799236297607
Epoch: 25, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2676968574523926
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.011066198348999
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 1.2324209213256836
Epoch: 28, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 29 cost time: 0.9828453063964844
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8678667545318604
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 31 cost time: 0.9798884391784668
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 32 cost time: 1.1201305389404297
Epoch: 32, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2357211112976074
Epoch: 33, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9406297206878662
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 35 cost time: 1.0626094341278076
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 36 cost time: 0.8522429466247559
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0011868476867676
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.072709560394287
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9896688461303711
Epoch: 39, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0839462280273438
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0946638584136963
Epoch: 41, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3219528198242188
Epoch: 42, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1175343990325928
Epoch: 43, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.135857343673706
Epoch: 44, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0105524063110352
Epoch: 45, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 55085
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.623612880706787
Epoch: 1, Steps: 18 | Train Loss: 3.245 Vali Loss: 3.103 Vali Acc: 0.113 Test Loss: 3.103 Test Acc: 0.113
Validation loss decreased (inf --> -0.113302).  Saving model ...
Epoch: 2 cost time: 0.9754571914672852
Epoch: 2, Steps: 18 | Train Loss: 2.912 Vali Loss: 2.664 Vali Acc: 0.460 Test Loss: 2.664 Test Acc: 0.460
Validation loss decreased (-0.113302 --> -0.459973).  Saving model ...
Epoch: 3 cost time: 0.8740081787109375
Epoch: 3, Steps: 18 | Train Loss: 2.361 Vali Loss: 2.080 Vali Acc: 0.763 Test Loss: 2.080 Test Acc: 0.763
Validation loss decreased (-0.459973 --> -0.763313).  Saving model ...
Epoch: 4 cost time: 1.2392430305480957
Epoch: 4, Steps: 18 | Train Loss: 1.657 Vali Loss: 1.367 Vali Acc: 0.913 Test Loss: 1.367 Test Acc: 0.913
Validation loss decreased (-0.763313 --> -0.913320).  Saving model ...
Epoch: 5 cost time: 1.089512586593628
Epoch: 5, Steps: 18 | Train Loss: 0.933 Vali Loss: 0.748 Vali Acc: 0.933 Test Loss: 0.748 Test Acc: 0.933
Validation loss decreased (-0.913320 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 1.1530110836029053
Epoch: 6, Steps: 18 | Train Loss: 0.429 Vali Loss: 0.404 Vali Acc: 0.950 Test Loss: 0.404 Test Acc: 0.950
Validation loss decreased (-0.933326 --> -0.949996).  Saving model ...
Epoch: 7 cost time: 1.1103181838989258
Epoch: 7, Steps: 18 | Train Loss: 0.206 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
Validation loss decreased (-0.949996 --> -0.959997).  Saving model ...
Epoch: 8 cost time: 1.0611519813537598
Epoch: 8, Steps: 18 | Train Loss: 0.115 Vali Loss: 0.216 Vali Acc: 0.960 Test Loss: 0.216 Test Acc: 0.960
Validation loss decreased (-0.959997 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.8836345672607422
Epoch: 9, Steps: 18 | Train Loss: 0.076 Vali Loss: 0.189 Vali Acc: 0.970 Test Loss: 0.189 Test Acc: 0.970
Validation loss decreased (-0.959998 --> -0.969998).  Saving model ...
Epoch: 10 cost time: 0.8811361789703369
Epoch: 10, Steps: 18 | Train Loss: 0.052 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.8145625591278076
Epoch: 11, Steps: 18 | Train Loss: 0.038 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 12 cost time: 0.8179304599761963
Epoch: 12, Steps: 18 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969998).  Saving model ...
Epoch: 13 cost time: 0.8281540870666504
Epoch: 13, Steps: 18 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.969998 --> -0.969999).  Saving model ...
Epoch: 14 cost time: 0.8194503784179688
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7583611011505127
Epoch: 15, Steps: 18 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 16 cost time: 0.8459172248840332
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 17 cost time: 0.8370776176452637
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9948742389678955
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.8449249267578125
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8929328918457031
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 21 cost time: 0.9515421390533447
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8591697216033936
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8833446502685547
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.041386365890503
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7239930629730225
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8927240371704102
Epoch: 26, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 27 cost time: 0.9709188938140869
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 28 cost time: 0.9200518131256104
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9125492572784424
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9086751937866211
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9745926856994629
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8893942832946777
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8381884098052979
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9181160926818848
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9841372966766357
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9928245544433594
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.901411771774292
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 56621
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.478856086730957
Epoch: 1, Steps: 18 | Train Loss: 3.271 Vali Loss: 3.100 Vali Acc: 0.090 Test Loss: 3.100 Test Acc: 0.090
Validation loss decreased (inf --> -0.089969).  Saving model ...
Epoch: 2 cost time: 0.7637269496917725
Epoch: 2, Steps: 18 | Train Loss: 2.902 Vali Loss: 2.629 Vali Acc: 0.487 Test Loss: 2.629 Test Acc: 0.487
Validation loss decreased (-0.089969 --> -0.486640).  Saving model ...
Epoch: 3 cost time: 0.9104135036468506
Epoch: 3, Steps: 18 | Train Loss: 2.316 Vali Loss: 2.021 Vali Acc: 0.827 Test Loss: 2.021 Test Acc: 0.827
Validation loss decreased (-0.486640 --> -0.826646).  Saving model ...
Epoch: 4 cost time: 0.9161820411682129
Epoch: 4, Steps: 18 | Train Loss: 1.632 Vali Loss: 1.306 Vali Acc: 0.890 Test Loss: 1.306 Test Acc: 0.890
Validation loss decreased (-0.826646 --> -0.889987).  Saving model ...
Epoch: 5 cost time: 1.1893134117126465
Epoch: 5, Steps: 18 | Train Loss: 0.894 Vali Loss: 0.703 Vali Acc: 0.933 Test Loss: 0.703 Test Acc: 0.933
Validation loss decreased (-0.889987 --> -0.933326).  Saving model ...
Epoch: 6 cost time: 0.7948389053344727
Epoch: 6, Steps: 18 | Train Loss: 0.419 Vali Loss: 0.400 Vali Acc: 0.943 Test Loss: 0.400 Test Acc: 0.943
Validation loss decreased (-0.933326 --> -0.943329).  Saving model ...
Epoch: 7 cost time: 0.9295730590820312
Epoch: 7, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.280 Vali Acc: 0.963 Test Loss: 0.280 Test Acc: 0.963
Validation loss decreased (-0.943329 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 0.7589390277862549
Epoch: 8, Steps: 18 | Train Loss: 0.124 Vali Loss: 0.225 Vali Acc: 0.963 Test Loss: 0.225 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 0.7530708312988281
Epoch: 9, Steps: 18 | Train Loss: 0.087 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.8847591876983643
Epoch: 10, Steps: 18 | Train Loss: 0.057 Vali Loss: 0.175 Vali Acc: 0.970 Test Loss: 0.175 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 1.0741972923278809
Epoch: 11, Steps: 18 | Train Loss: 0.047 Vali Loss: 0.162 Vali Acc: 0.973 Test Loss: 0.162 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.9172539710998535
Epoch: 12, Steps: 18 | Train Loss: 0.033 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 13 cost time: 0.7457859516143799
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9810848236083984
Epoch: 14, Steps: 18 | Train Loss: 0.019 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 15 cost time: 0.787783145904541
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9001579284667969
Epoch: 16, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 17 cost time: 0.9675309658050537
Epoch: 17, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9034557342529297
Epoch: 18, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1146388053894043
Epoch: 19, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 20 cost time: 0.8345894813537598
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0592882633209229
Epoch: 21, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9677269458770752
Epoch: 22, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9462459087371826
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 0.879401445388794
Epoch: 24, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 0.8486955165863037
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.892094612121582
Epoch: 26, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8408710956573486
Epoch: 27, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9095549583435059
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1191449165344238
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9742870330810547
Epoch: 30, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1269636154174805
Epoch: 31, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.977 Test Loss: 0.136 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9332232475280762
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0158512592315674
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9362952709197998
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 56091
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.077204942703247
Epoch: 1, Steps: 18 | Train Loss: 3.191 Vali Loss: 3.036 Vali Acc: 0.180 Test Loss: 3.036 Test Acc: 0.180
Validation loss decreased (inf --> -0.179970).  Saving model ...
Epoch: 2 cost time: 1.2258028984069824
Epoch: 2, Steps: 18 | Train Loss: 2.808 Vali Loss: 2.562 Vali Acc: 0.433 Test Loss: 2.562 Test Acc: 0.433
Validation loss decreased (-0.179970 --> -0.433308).  Saving model ...
Epoch: 3 cost time: 0.8137943744659424
Epoch: 3, Steps: 18 | Train Loss: 2.235 Vali Loss: 1.943 Vali Acc: 0.790 Test Loss: 1.943 Test Acc: 0.790
Validation loss decreased (-0.433308 --> -0.789981).  Saving model ...
Epoch: 4 cost time: 1.1734139919281006
Epoch: 4, Steps: 18 | Train Loss: 1.537 Vali Loss: 1.260 Vali Acc: 0.893 Test Loss: 1.260 Test Acc: 0.893
Validation loss decreased (-0.789981 --> -0.893321).  Saving model ...
Epoch: 5 cost time: 1.0835773944854736
Epoch: 5, Steps: 18 | Train Loss: 0.842 Vali Loss: 0.691 Vali Acc: 0.930 Test Loss: 0.691 Test Acc: 0.930
Validation loss decreased (-0.893321 --> -0.929993).  Saving model ...
Epoch: 6 cost time: 1.104018211364746
Epoch: 6, Steps: 18 | Train Loss: 0.436 Vali Loss: 0.385 Vali Acc: 0.953 Test Loss: 0.385 Test Acc: 0.953
Validation loss decreased (-0.929993 --> -0.953329).  Saving model ...
Epoch: 7 cost time: 1.5011851787567139
Epoch: 7, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
Validation loss decreased (-0.953329 --> -0.963331).  Saving model ...
Epoch: 8 cost time: 1.355933666229248
Epoch: 8, Steps: 18 | Train Loss: 0.116 Vali Loss: 0.217 Vali Acc: 0.963 Test Loss: 0.217 Test Acc: 0.963
Validation loss decreased (-0.963331 --> -0.963331).  Saving model ...
Epoch: 9 cost time: 1.274355411529541
Epoch: 9, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.963331 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.8810651302337646
Epoch: 10, Steps: 18 | Train Loss: 0.056 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 11 cost time: 1.268247127532959
Epoch: 11, Steps: 18 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 12 cost time: 1.3634331226348877
Epoch: 12, Steps: 18 | Train Loss: 0.032 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969999).  Saving model ...
Epoch: 13 cost time: 1.216893196105957
Epoch: 13, Steps: 18 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3663668632507324
Epoch: 14, Steps: 18 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4014487266540527
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3720412254333496
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 17 cost time: 1.0360116958618164
Epoch: 17, Steps: 18 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.969999 --> -0.969999).  Saving model ...
Epoch: 18 cost time: 1.0759992599487305
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.969999 --> -0.973332).  Saving model ...
Epoch: 19 cost time: 0.9771993160247803
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
Validation loss decreased (-0.973332 --> -0.973332).  Saving model ...
Epoch: 20 cost time: 1.2708113193511963
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.973332 --> -0.976665).  Saving model ...
Epoch: 21 cost time: 1.4905438423156738
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 22 cost time: 1.3603839874267578
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 23 cost time: 1.0362827777862549
Epoch: 23, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 24 cost time: 1.2298340797424316
Epoch: 24, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 25 cost time: 1.0625553131103516
Epoch: 25, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.965306282043457
Epoch: 26, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 27 cost time: 1.0306217670440674
Epoch: 27, Steps: 18 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0708160400390625
Epoch: 28, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3238520622253418
Epoch: 29, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.5780613422393799
Epoch: 30, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.976665 --> -0.976665).  Saving model ...
Epoch: 31 cost time: 1.2420644760131836
Epoch: 31, Steps: 18 | Train Loss: 0.003 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9793360233306885
Epoch: 32, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2396783828735352
Epoch: 33, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.151350736618042
Epoch: 34, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.3256127834320068
Epoch: 35, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3671813011169434
Epoch: 36, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2652935981750488
Epoch: 37, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7276756763458252
Epoch: 38, Steps: 18 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.1451923847198486
Epoch: 39, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.132392406463623
Epoch: 40, Steps: 18 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 55277
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 3.068852663040161
Epoch: 1, Steps: 18 | Train Loss: 3.205 Vali Loss: 3.011 Vali Acc: 0.160 Test Loss: 3.011 Test Acc: 0.160
Validation loss decreased (inf --> -0.159970).  Saving model ...
Epoch: 2 cost time: 0.8614826202392578
Epoch: 2, Steps: 18 | Train Loss: 2.835 Vali Loss: 2.533 Vali Acc: 0.537 Test Loss: 2.533 Test Acc: 0.537
Validation loss decreased (-0.159970 --> -0.536641).  Saving model ...
Epoch: 3 cost time: 0.9056494235992432
Epoch: 3, Steps: 18 | Train Loss: 2.237 Vali Loss: 1.921 Vali Acc: 0.803 Test Loss: 1.921 Test Acc: 0.803
Validation loss decreased (-0.536641 --> -0.803314).  Saving model ...
Epoch: 4 cost time: 1.0623130798339844
Epoch: 4, Steps: 18 | Train Loss: 1.527 Vali Loss: 1.219 Vali Acc: 0.907 Test Loss: 1.219 Test Acc: 0.907
Validation loss decreased (-0.803314 --> -0.906654).  Saving model ...
Epoch: 5 cost time: 1.1229791641235352
Epoch: 5, Steps: 18 | Train Loss: 0.834 Vali Loss: 0.663 Vali Acc: 0.950 Test Loss: 0.663 Test Acc: 0.950
Validation loss decreased (-0.906654 --> -0.949993).  Saving model ...
Epoch: 6 cost time: 1.0917494297027588
Epoch: 6, Steps: 18 | Train Loss: 0.412 Vali Loss: 0.386 Vali Acc: 0.947 Test Loss: 0.386 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8411557674407959
Epoch: 7, Steps: 18 | Train Loss: 0.204 Vali Loss: 0.271 Vali Acc: 0.957 Test Loss: 0.271 Test Acc: 0.957
Validation loss decreased (-0.949993 --> -0.956664).  Saving model ...
Epoch: 8 cost time: 1.0486416816711426
Epoch: 8, Steps: 18 | Train Loss: 0.122 Vali Loss: 0.220 Vali Acc: 0.960 Test Loss: 0.220 Test Acc: 0.960
Validation loss decreased (-0.956664 --> -0.959998).  Saving model ...
Epoch: 9 cost time: 0.9650614261627197
Epoch: 9, Steps: 18 | Train Loss: 0.077 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
Validation loss decreased (-0.959998 --> -0.966665).  Saving model ...
Epoch: 10 cost time: 0.9279823303222656
Epoch: 10, Steps: 18 | Train Loss: 0.071 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
Validation loss decreased (-0.966665 --> -0.969998).  Saving model ...
Epoch: 11 cost time: 0.9385635852813721
Epoch: 11, Steps: 18 | Train Loss: 0.054 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
Validation loss decreased (-0.969998 --> -0.973332).  Saving model ...
Epoch: 12 cost time: 0.9809648990631104
Epoch: 12, Steps: 18 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1772634983062744
Epoch: 13, Steps: 18 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9563353061676025
Epoch: 14, Steps: 18 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0086350440979004
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9257500171661377
Epoch: 16, Steps: 18 | Train Loss: 0.014 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9629981517791748
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9566786289215088
Epoch: 18, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9857792854309082
Epoch: 19, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.019911289215088
Epoch: 20, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9747040271759033
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9733333333333334
model parameter : 55405
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ArticularyWordRecognitionModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ArticularyWordRecognition
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             9                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

275
300
>>>>>>>start training : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
275
300
300
Epoch: 1 cost time: 2.680657148361206
Epoch: 1, Steps: 18 | Train Loss: 3.153 Vali Loss: 3.010 Vali Acc: 0.107 Test Loss: 3.010 Test Acc: 0.107
Validation loss decreased (inf --> -0.106637).  Saving model ...
Epoch: 2 cost time: 1.0030934810638428
Epoch: 2, Steps: 18 | Train Loss: 2.794 Vali Loss: 2.542 Vali Acc: 0.520 Test Loss: 2.542 Test Acc: 0.520
Validation loss decreased (-0.106637 --> -0.519975).  Saving model ...
Epoch: 3 cost time: 1.061323642730713
Epoch: 3, Steps: 18 | Train Loss: 2.231 Vali Loss: 1.932 Vali Acc: 0.850 Test Loss: 1.932 Test Acc: 0.850
Validation loss decreased (-0.519975 --> -0.849981).  Saving model ...
Epoch: 4 cost time: 0.9560132026672363
Epoch: 4, Steps: 18 | Train Loss: 1.544 Vali Loss: 1.255 Vali Acc: 0.940 Test Loss: 1.255 Test Acc: 0.940
Validation loss decreased (-0.849981 --> -0.939987).  Saving model ...
Epoch: 5 cost time: 1.0304925441741943
Epoch: 5, Steps: 18 | Train Loss: 0.855 Vali Loss: 0.680 Vali Acc: 0.953 Test Loss: 0.680 Test Acc: 0.953
Validation loss decreased (-0.939987 --> -0.953327).  Saving model ...
Epoch: 6 cost time: 0.959585428237915
Epoch: 6, Steps: 18 | Train Loss: 0.400 Vali Loss: 0.381 Vali Acc: 0.963 Test Loss: 0.381 Test Acc: 0.963
Validation loss decreased (-0.953327 --> -0.963330).  Saving model ...
Epoch: 7 cost time: 0.9136824607849121
Epoch: 7, Steps: 18 | Train Loss: 0.198 Vali Loss: 0.269 Vali Acc: 0.967 Test Loss: 0.269 Test Acc: 0.967
Validation loss decreased (-0.963330 --> -0.966664).  Saving model ...
Epoch: 8 cost time: 1.2126922607421875
Epoch: 8, Steps: 18 | Train Loss: 0.110 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966665).  Saving model ...
Epoch: 9 cost time: 0.7776041030883789
Epoch: 9, Steps: 18 | Train Loss: 0.079 Vali Loss: 0.191 Vali Acc: 0.973 Test Loss: 0.191 Test Acc: 0.973
Validation loss decreased (-0.966665 --> -0.973331).  Saving model ...
Epoch: 10 cost time: 1.062978982925415
Epoch: 10, Steps: 18 | Train Loss: 0.055 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9223411083221436
Epoch: 11, Steps: 18 | Train Loss: 0.042 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9331943988800049
Epoch: 12, Steps: 18 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0433557033538818
Epoch: 13, Steps: 18 | Train Loss: 0.025 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.973331 --> -0.976665).  Saving model ...
Epoch: 14 cost time: 0.94223952293396
Epoch: 14, Steps: 18 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0560832023620605
Epoch: 15, Steps: 18 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9747006893157959
Epoch: 16, Steps: 18 | Train Loss: 0.013 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.00412917137146
Epoch: 17, Steps: 18 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9036953449249268
Epoch: 18, Steps: 18 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8235905170440674
Epoch: 19, Steps: 18 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0264012813568115
Epoch: 20, Steps: 18 | Train Loss: 0.008 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0550789833068848
Epoch: 21, Steps: 18 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1147983074188232
Epoch: 22, Steps: 18 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8986368179321289
Epoch: 23, Steps: 18 | Train Loss: 0.005 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ArticularyWordRecognition_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
300
test shape: torch.Size([300, 25]) torch.Size([300, 1])
accuracy:0.9766666666666667
model parameter : 56067
model size : 0.22MB
