Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6939797401428223
Epoch: 1, Steps: 1 | Train Loss: 1.157 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.479703426361084
Epoch: 2, Steps: 1 | Train Loss: 1.095 Vali Loss: 1.088 Vali Acc: 0.267 Test Loss: 1.088 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.46654772758483887
Epoch: 3, Steps: 1 | Train Loss: 1.037 Vali Loss: 1.085 Vali Acc: 0.267 Test Loss: 1.085 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4432234764099121
Epoch: 4, Steps: 1 | Train Loss: 0.982 Vali Loss: 1.081 Vali Acc: 0.267 Test Loss: 1.081 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.4394354820251465
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.078 Vali Acc: 0.267 Test Loss: 1.078 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.4535481929779053
Epoch: 6, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.072 Vali Acc: 0.533 Test Loss: 1.072 Test Acc: 0.533
Validation loss decreased (-0.266656 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.5161783695220947
Epoch: 7, Steps: 1 | Train Loss: 0.659 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6201376914978027
Epoch: 8, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5217752456665039
Epoch: 9, Steps: 1 | Train Loss: 0.343 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5090649127960205
Epoch: 10, Steps: 1 | Train Loss: 0.237 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.46343159675598145
Epoch: 11, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.46729230880737305
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4362356662750244
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.311 Vali Acc: 0.400 Test Loss: 1.311 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.45827198028564453
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.389 Vali Acc: 0.400 Test Loss: 1.389 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4858236312866211
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.470 Vali Acc: 0.400 Test Loss: 1.470 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.699904203414917
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6864241
model size : 26.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs834_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7815353870391846
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4300076961517334
Epoch: 2, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.40262413024902344
Epoch: 3, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4670290946960449
Epoch: 4, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.46837878227233887
Epoch: 5, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.31746697425842285
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.36269092559814453
Epoch: 7, Steps: 1 | Train Loss: 0.589 Vali Loss: 1.109 Vali Acc: 0.400 Test Loss: 1.109 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.42095041275024414
Epoch: 8, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.35863471031188965
Epoch: 9, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4089632034301758
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.42873477935791016
Epoch: 11, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.231 Vali Acc: 0.400 Test Loss: 1.231 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.36564087867736816
Epoch: 12, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.297 Vali Acc: 0.400 Test Loss: 1.297 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.3197154998779297
Epoch: 13, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.372 Vali Acc: 0.400 Test Loss: 1.372 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.48126697540283203
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.455 Vali Acc: 0.333 Test Loss: 1.455 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.3333156108856201
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.541 Vali Acc: 0.333 Test Loss: 1.541 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3343830108642578
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.628 Vali Acc: 0.333 Test Loss: 1.628 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs834_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6762759
model size : 25.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs625_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8272569179534912
Epoch: 1, Steps: 1 | Train Loss: 1.165 Vali Loss: 1.133 Vali Acc: 0.467 Test Loss: 1.133 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.466949462890625
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.130 Vali Acc: 0.467 Test Loss: 1.130 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4002671241760254
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.127 Vali Acc: 0.533 Test Loss: 1.127 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.42053985595703125
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.4981262683868408
Epoch: 5, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.121 Vali Acc: 0.533 Test Loss: 1.121 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.42258238792419434
Epoch: 6, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5440840721130371
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.121 Vali Acc: 0.333 Test Loss: 1.121 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4921433925628662
Epoch: 8, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5028786659240723
Epoch: 9, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4918022155761719
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.189 Vali Acc: 0.267 Test Loss: 1.189 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.48958253860473633
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.239 Vali Acc: 0.333 Test Loss: 1.239 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5761153697967529
Epoch: 12, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.301 Vali Acc: 0.200 Test Loss: 1.301 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5032494068145752
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.373 Vali Acc: 0.200 Test Loss: 1.373 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5627186298370361
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.451 Vali Acc: 0.200 Test Loss: 1.451 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6088192462921143
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.533 Vali Acc: 0.200 Test Loss: 1.533 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs625_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6704273
model size : 25.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7627007961273193
Epoch: 1, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.433518648147583
Epoch: 2, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.165 Vali Acc: 0.200 Test Loss: 1.165 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.3994102478027344
Epoch: 3, Steps: 1 | Train Loss: 0.968 Vali Loss: 1.162 Vali Acc: 0.200 Test Loss: 1.162 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.3974025249481201
Epoch: 4, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5197157859802246
Epoch: 5, Steps: 1 | Train Loss: 0.865 Vali Loss: 1.156 Vali Acc: 0.267 Test Loss: 1.156 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5454955101013184
Epoch: 6, Steps: 1 | Train Loss: 0.818 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.436612606048584
Epoch: 7, Steps: 1 | Train Loss: 0.605 Vali Loss: 1.167 Vali Acc: 0.333 Test Loss: 1.167 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.37514257431030273
Epoch: 8, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.38485026359558105
Epoch: 9, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.3722522258758545
Epoch: 10, Steps: 1 | Train Loss: 0.209 Vali Loss: 1.263 Vali Acc: 0.267 Test Loss: 1.263 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.37375950813293457
Epoch: 11, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5055723190307617
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.393 Vali Acc: 0.267 Test Loss: 1.393 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4709630012512207
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.471 Vali Acc: 0.200 Test Loss: 1.471 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4669036865234375
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.553 Vali Acc: 0.200 Test Loss: 1.553 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4466109275817871
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.639 Vali Acc: 0.200 Test Loss: 1.639 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.517014741897583
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.725 Vali Acc: 0.267 Test Loss: 1.725 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6672295
model size : 25.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7167069911956787
Epoch: 1, Steps: 1 | Train Loss: 1.130 Vali Loss: 1.063 Vali Acc: 0.400 Test Loss: 1.063 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5006809234619141
Epoch: 2, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.060 Vali Acc: 0.400 Test Loss: 1.060 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.610910177230835
Epoch: 3, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.057 Vali Acc: 0.400 Test Loss: 1.057 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5158100128173828
Epoch: 4, Steps: 1 | Train Loss: 0.958 Vali Loss: 1.054 Vali Acc: 0.400 Test Loss: 1.054 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.48916077613830566
Epoch: 5, Steps: 1 | Train Loss: 0.908 Vali Loss: 1.051 Vali Acc: 0.400 Test Loss: 1.051 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.516855001449585
Epoch: 6, Steps: 1 | Train Loss: 0.860 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.4293496608734131
Epoch: 7, Steps: 1 | Train Loss: 0.639 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.48810863494873047
Epoch: 8, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4332573413848877
Epoch: 9, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.42687153816223145
Epoch: 10, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5047380924224854
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.551170825958252
Epoch: 12, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5129146575927734
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.3977961540222168
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.325 Vali Acc: 0.400 Test Loss: 1.325 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5393009185791016
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.403 Vali Acc: 0.400 Test Loss: 1.403 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.49358677864074707
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.482 Vali Acc: 0.400 Test Loss: 1.482 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.3685736656188965
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.561 Vali Acc: 0.400 Test Loss: 1.561 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6656073
model size : 25.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7873930931091309
Epoch: 1, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5265634059906006
Epoch: 2, Steps: 1 | Train Loss: 1.150 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5016298294067383
Epoch: 3, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4546210765838623
Epoch: 4, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.119 Vali Acc: 0.467 Test Loss: 1.119 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.4528160095214844
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4909188747406006
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.5578889846801758
Epoch: 7, Steps: 1 | Train Loss: 0.684 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5994212627410889
Epoch: 8, Steps: 1 | Train Loss: 0.482 Vali Loss: 1.128 Vali Acc: 0.333 Test Loss: 1.128 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5253884792327881
Epoch: 9, Steps: 1 | Train Loss: 0.339 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.5395669937133789
Epoch: 10, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5337193012237549
Epoch: 11, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.251 Vali Acc: 0.400 Test Loss: 1.251 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5192439556121826
Epoch: 12, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.321 Vali Acc: 0.400 Test Loss: 1.321 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4565138816833496
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.400 Vali Acc: 0.333 Test Loss: 1.400 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.5980908870697021
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.484 Vali Acc: 0.333 Test Loss: 1.484 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6650999
model size : 25.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8910188674926758
Epoch: 1, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.47748351097106934
Epoch: 2, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.48877549171447754
Epoch: 3, Steps: 1 | Train Loss: 0.911 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4990255832672119
Epoch: 4, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.46460843086242676
Epoch: 5, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5330595970153809
Epoch: 6, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.094 Vali Acc: 0.400 Test Loss: 1.094 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4589674472808838
Epoch: 7, Steps: 1 | Train Loss: 0.571 Vali Loss: 1.096 Vali Acc: 0.400 Test Loss: 1.096 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4698350429534912
Epoch: 8, Steps: 1 | Train Loss: 0.407 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.41823577880859375
Epoch: 9, Steps: 1 | Train Loss: 0.287 Vali Loss: 1.133 Vali Acc: 0.400 Test Loss: 1.133 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.493762731552124
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.43778491020202637
Epoch: 11, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.227 Vali Acc: 0.267 Test Loss: 1.227 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4123568534851074
Epoch: 12, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4181501865386963
Epoch: 13, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.372 Vali Acc: 0.267 Test Loss: 1.372 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.41638946533203125
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.455 Vali Acc: 0.200 Test Loss: 1.455 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.41222405433654785
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.542 Vali Acc: 0.200 Test Loss: 1.542 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.44296860694885254
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.630 Vali Acc: 0.267 Test Loss: 1.630 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6634513
model size : 25.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9675209522247314
Epoch: 1, Steps: 1 | Train Loss: 1.232 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.49680471420288086
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.199 Vali Acc: 0.267 Test Loss: 1.199 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5656476020812988
Epoch: 3, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.6143946647644043
Epoch: 4, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5588662624359131
Epoch: 5, Steps: 1 | Train Loss: 0.987 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4491403102874756
Epoch: 6, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.4458804130554199
Epoch: 7, Steps: 1 | Train Loss: 0.682 Vali Loss: 1.208 Vali Acc: 0.333 Test Loss: 1.208 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5678229331970215
Epoch: 8, Steps: 1 | Train Loss: 0.477 Vali Loss: 1.230 Vali Acc: 0.400 Test Loss: 1.230 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5572819709777832
Epoch: 9, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.266 Vali Acc: 0.333 Test Loss: 1.266 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.49202752113342285
Epoch: 10, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5188114643096924
Epoch: 11, Steps: 1 | Train Loss: 0.155 Vali Loss: 1.385 Vali Acc: 0.200 Test Loss: 1.385 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.4811420440673828
Epoch: 12, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.463 Vali Acc: 0.267 Test Loss: 1.463 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.513765811920166
Epoch: 13, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.548 Vali Acc: 0.267 Test Loss: 1.548 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5453498363494873
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.639 Vali Acc: 0.267 Test Loss: 1.639 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5729444026947021
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.583824634552002
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5001184940338135
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.915 Vali Acc: 0.200 Test Loss: 1.915 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5129849910736084
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.004 Vali Acc: 0.200 Test Loss: 2.004 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6620591
model size : 25.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6946892738342285
Epoch: 1, Steps: 1 | Train Loss: 1.244 Vali Loss: 1.165 Vali Acc: 0.133 Test Loss: 1.165 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.490344762802124
Epoch: 2, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.160 Vali Acc: 0.200 Test Loss: 1.160 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.4122896194458008
Epoch: 3, Steps: 1 | Train Loss: 1.119 Vali Loss: 1.156 Vali Acc: 0.200 Test Loss: 1.156 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.447939395904541
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.38738036155700684
Epoch: 5, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.602391242980957
Epoch: 6, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.134 Vali Acc: 0.267 Test Loss: 1.134 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.46548008918762207
Epoch: 7, Steps: 1 | Train Loss: 0.705 Vali Loss: 1.124 Vali Acc: 0.267 Test Loss: 1.124 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 8 cost time: 0.42656803131103516
Epoch: 8, Steps: 1 | Train Loss: 0.499 Vali Loss: 1.122 Vali Acc: 0.267 Test Loss: 1.122 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.4336864948272705
Epoch: 9, Steps: 1 | Train Loss: 0.351 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.4653921127319336
Epoch: 10, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 11 cost time: 0.41919565200805664
Epoch: 11, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.204 Vali Acc: 0.333 Test Loss: 1.204 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5088810920715332
Epoch: 12, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.262 Vali Acc: 0.333 Test Loss: 1.262 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.48413896560668945
Epoch: 13, Steps: 1 | Train Loss: 0.058 Vali Loss: 1.330 Vali Acc: 0.333 Test Loss: 1.330 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5410599708557129
Epoch: 14, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.406 Vali Acc: 0.333 Test Loss: 1.406 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4265611171722412
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.486 Vali Acc: 0.333 Test Loss: 1.486 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.4703238010406494
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.568 Vali Acc: 0.333 Test Loss: 1.568 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.39087486267089844
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.650 Vali Acc: 0.333 Test Loss: 1.650 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5681087970733643
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.731 Vali Acc: 0.333 Test Loss: 1.731 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5541765689849854
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.811 Vali Acc: 0.333 Test Loss: 1.811 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4705662727355957
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.887 Vali Acc: 0.400 Test Loss: 1.887 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399981).  Saving model ...
Epoch: 21 cost time: 0.453291654586792
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.961 Vali Acc: 0.333 Test Loss: 1.961 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49149394035339355
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.032 Vali Acc: 0.333 Test Loss: 2.032 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.45583128929138184
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.099 Vali Acc: 0.333 Test Loss: 2.099 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.39207887649536133
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.163 Vali Acc: 0.333 Test Loss: 2.163 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4092133045196533
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.224 Vali Acc: 0.333 Test Loss: 2.224 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5774562358856201
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.281 Vali Acc: 0.333 Test Loss: 2.281 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5922610759735107
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.335 Vali Acc: 0.333 Test Loss: 2.335 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6330394744873047
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.385 Vali Acc: 0.333 Test Loss: 2.385 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5458710193634033
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.433 Vali Acc: 0.333 Test Loss: 2.433 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5592827796936035
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.477 Vali Acc: 0.333 Test Loss: 2.477 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6608465
model size : 25.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6546480655670166
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.069 Vali Acc: 0.333 Test Loss: 1.069 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5154867172241211
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.4636497497558594
Epoch: 3, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.064 Vali Acc: 0.333 Test Loss: 1.064 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.37142348289489746
Epoch: 4, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.43248605728149414
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.061 Vali Acc: 0.267 Test Loss: 1.061 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.4210782051086426
Epoch: 6, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.41907501220703125
Epoch: 7, Steps: 1 | Train Loss: 0.663 Vali Loss: 1.069 Vali Acc: 0.267 Test Loss: 1.069 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4174153804779053
Epoch: 8, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.37778735160827637
Epoch: 9, Steps: 1 | Train Loss: 0.328 Vali Loss: 1.116 Vali Acc: 0.267 Test Loss: 1.116 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.48773860931396484
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.42110586166381836
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4607422351837158
Epoch: 12, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.295 Vali Acc: 0.333 Test Loss: 1.295 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.46475911140441895
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.374 Vali Acc: 0.333 Test Loss: 1.374 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.49463534355163574
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.458 Vali Acc: 0.400 Test Loss: 1.458 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399985).  Saving model ...
Epoch: 15 cost time: 0.4614410400390625
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.544 Vali Acc: 0.467 Test Loss: 1.544 Test Acc: 0.467
Validation loss decreased (-0.399985 --> -0.466651).  Saving model ...
Epoch: 16 cost time: 0.3696434497833252
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.630 Vali Acc: 0.467 Test Loss: 1.630 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4475398063659668
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.715 Vali Acc: 0.467 Test Loss: 1.715 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.39971041679382324
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.799 Vali Acc: 0.467 Test Loss: 1.799 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.41121411323547363
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.879 Vali Acc: 0.467 Test Loss: 1.879 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.49396800994873047
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.957 Vali Acc: 0.467 Test Loss: 1.957 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.592458963394165
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.032 Vali Acc: 0.467 Test Loss: 2.032 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.45594072341918945
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.103 Vali Acc: 0.467 Test Loss: 2.103 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.49553728103637695
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.467 Test Loss: 2.171 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.5588631629943848
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.235 Vali Acc: 0.467 Test Loss: 2.235 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.48467302322387695
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.295 Vali Acc: 0.467 Test Loss: 2.295 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6622879
model size : 25.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5457513332366943
Epoch: 1, Steps: 1 | Train Loss: 1.172 Vali Loss: 1.040 Vali Acc: 0.333 Test Loss: 1.040 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5425312519073486
Epoch: 2, Steps: 1 | Train Loss: 1.109 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.5871634483337402
Epoch: 3, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.5959441661834717
Epoch: 4, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.5761146545410156
Epoch: 5, Steps: 1 | Train Loss: 0.938 Vali Loss: 1.033 Vali Acc: 0.400 Test Loss: 1.033 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.41770076751708984
Epoch: 6, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.036 Vali Acc: 0.400 Test Loss: 1.036 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4627418518066406
Epoch: 7, Steps: 1 | Train Loss: 0.651 Vali Loss: 1.044 Vali Acc: 0.400 Test Loss: 1.044 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5531301498413086
Epoch: 8, Steps: 1 | Train Loss: 0.461 Vali Loss: 1.062 Vali Acc: 0.467 Test Loss: 1.062 Test Acc: 0.467
Validation loss decreased (-0.399990 --> -0.466656).  Saving model ...
Epoch: 9 cost time: 0.5205848217010498
Epoch: 9, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.093 Vali Acc: 0.467 Test Loss: 1.093 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5633695125579834
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.140 Vali Acc: 0.467 Test Loss: 1.140 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5737571716308594
Epoch: 11, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.201 Vali Acc: 0.400 Test Loss: 1.201 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.46849942207336426
Epoch: 12, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.272 Vali Acc: 0.400 Test Loss: 1.272 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4199364185333252
Epoch: 13, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.352 Vali Acc: 0.400 Test Loss: 1.352 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4106295108795166
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.437 Vali Acc: 0.400 Test Loss: 1.437 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.49596357345581055
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.525 Vali Acc: 0.400 Test Loss: 1.525 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4587128162384033
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.613 Vali Acc: 0.400 Test Loss: 1.613 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.47347593307495117
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5515129566192627
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.787 Vali Acc: 0.400 Test Loss: 1.787 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6618065
model size : 25.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5713341236114502
Epoch: 1, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.065 Vali Acc: 0.600 Test Loss: 1.065 Test Acc: 0.600
Validation loss decreased (inf --> -0.599989).  Saving model ...
Epoch: 2 cost time: 0.561086893081665
Epoch: 2, Steps: 1 | Train Loss: 1.084 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 3 cost time: 0.5266764163970947
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.055 Vali Acc: 0.600 Test Loss: 1.055 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 4 cost time: 0.4833261966705322
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.050 Vali Acc: 0.600 Test Loss: 1.050 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 5 cost time: 0.46283411979675293
Epoch: 5, Steps: 1 | Train Loss: 0.919 Vali Loss: 1.046 Vali Acc: 0.600 Test Loss: 1.046 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.48181939125061035
Epoch: 6, Steps: 1 | Train Loss: 0.870 Vali Loss: 1.036 Vali Acc: 0.600 Test Loss: 1.036 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.4787888526916504
Epoch: 7, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.028 Vali Acc: 0.733 Test Loss: 1.028 Test Acc: 0.733
Validation loss decreased (-0.599990 --> -0.733323).  Saving model ...
Epoch: 8 cost time: 0.509812593460083
Epoch: 8, Steps: 1 | Train Loss: 0.455 Vali Loss: 1.027 Vali Acc: 0.667 Test Loss: 1.027 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.48121070861816406
Epoch: 9, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5164680480957031
Epoch: 10, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.45342564582824707
Epoch: 11, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.096 Vali Acc: 0.533 Test Loss: 1.096 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6042475700378418
Epoch: 12, Steps: 1 | Train Loss: 0.088 Vali Loss: 1.146 Vali Acc: 0.533 Test Loss: 1.146 Test Acc: 0.533
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.48766255378723145
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4363882541656494
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.275 Vali Acc: 0.400 Test Loss: 1.275 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.7121050357818604
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.348 Vali Acc: 0.333 Test Loss: 1.348 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.40427422523498535
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.424 Vali Acc: 0.333 Test Loss: 1.424 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.4165167808532715
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.501 Vali Acc: 0.333 Test Loss: 1.501 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.7333333333333333
model parameter : 6616523
model size : 25.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6578848361968994
Epoch: 1, Steps: 1 | Train Loss: 1.134 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.44817423820495605
Epoch: 2, Steps: 1 | Train Loss: 1.075 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.406588077545166
Epoch: 3, Steps: 1 | Train Loss: 1.019 Vali Loss: 1.144 Vali Acc: 0.467 Test Loss: 1.144 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.3393409252166748
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.4310569763183594
Epoch: 5, Steps: 1 | Train Loss: 0.916 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5111422538757324
Epoch: 6, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.139 Vali Acc: 0.400 Test Loss: 1.139 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.43007779121398926
Epoch: 7, Steps: 1 | Train Loss: 0.649 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5323894023895264
Epoch: 8, Steps: 1 | Train Loss: 0.463 Vali Loss: 1.160 Vali Acc: 0.400 Test Loss: 1.160 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.42765188217163086
Epoch: 9, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.3673820495605469
Epoch: 10, Steps: 1 | Train Loss: 0.222 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.36866331100463867
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.43628692626953125
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.355 Vali Acc: 0.267 Test Loss: 1.355 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.4128150939941406
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.431 Vali Acc: 0.267 Test Loss: 1.431 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6605497
model size : 25.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7048652172088623
Epoch: 1, Steps: 1 | Train Loss: 1.078 Vali Loss: 1.270 Vali Acc: 0.200 Test Loss: 1.270 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4522078037261963
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.267 Vali Acc: 0.200 Test Loss: 1.267 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.44034242630004883
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.5167298316955566
Epoch: 4, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.262 Vali Acc: 0.200 Test Loss: 1.262 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.46361517906188965
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.259 Vali Acc: 0.267 Test Loss: 1.259 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5249619483947754
Epoch: 6, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5497801303863525
Epoch: 7, Steps: 1 | Train Loss: 0.602 Vali Loss: 1.276 Vali Acc: 0.200 Test Loss: 1.276 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5003914833068848
Epoch: 8, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.300 Vali Acc: 0.200 Test Loss: 1.300 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5469999313354492
Epoch: 9, Steps: 1 | Train Loss: 0.297 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.461489200592041
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.394 Vali Acc: 0.333 Test Loss: 1.394 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47102808952331543
Epoch: 11, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.462 Vali Acc: 0.333 Test Loss: 1.462 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5275475978851318
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.540 Vali Acc: 0.333 Test Loss: 1.540 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4697611331939697
Epoch: 13, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.625 Vali Acc: 0.333 Test Loss: 1.625 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4353339672088623
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.714 Vali Acc: 0.333 Test Loss: 1.714 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5604500770568848
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.804 Vali Acc: 0.333 Test Loss: 1.804 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4452505111694336
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.893 Vali Acc: 0.333 Test Loss: 1.893 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.43021297454833984
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.981 Vali Acc: 0.333 Test Loss: 1.981 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.4808347225189209
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.067 Vali Acc: 0.333 Test Loss: 2.067 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.43097949028015137
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.149 Vali Acc: 0.333 Test Loss: 2.149 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6599987
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4885270595550537
Epoch: 1, Steps: 1 | Train Loss: 1.372 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5476408004760742
Epoch: 2, Steps: 1 | Train Loss: 1.302 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4465639591217041
Epoch: 3, Steps: 1 | Train Loss: 1.234 Vali Loss: 1.087 Vali Acc: 0.400 Test Loss: 1.087 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5157790184020996
Epoch: 4, Steps: 1 | Train Loss: 1.168 Vali Loss: 1.084 Vali Acc: 0.400 Test Loss: 1.084 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.491131067276001
Epoch: 5, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4294445514678955
Epoch: 6, Steps: 1 | Train Loss: 1.045 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4159867763519287
Epoch: 7, Steps: 1 | Train Loss: 0.762 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.3761632442474365
Epoch: 8, Steps: 1 | Train Loss: 0.525 Vali Loss: 1.082 Vali Acc: 0.267 Test Loss: 1.082 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5163736343383789
Epoch: 9, Steps: 1 | Train Loss: 0.364 Vali Loss: 1.101 Vali Acc: 0.267 Test Loss: 1.101 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4379234313964844
Epoch: 10, Steps: 1 | Train Loss: 0.253 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.46459078788757324
Epoch: 11, Steps: 1 | Train Loss: 0.169 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.44123291969299316
Epoch: 12, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.32691407203674316
Epoch: 13, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.331 Vali Acc: 0.333 Test Loss: 1.331 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.39876699447631836
Epoch: 14, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.415 Vali Acc: 0.333 Test Loss: 1.415 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4472019672393799
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.504 Vali Acc: 0.333 Test Loss: 1.504 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.3553907871246338
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.593 Vali Acc: 0.333 Test Loss: 1.593 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6614993
model size : 25.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6601464748382568
Epoch: 1, Steps: 1 | Train Loss: 1.115 Vali Loss: 1.129 Vali Acc: 0.333 Test Loss: 1.129 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5157914161682129
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.126 Vali Acc: 0.400 Test Loss: 1.126 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.633742094039917
Epoch: 3, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.40843939781188965
Epoch: 4, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.120 Vali Acc: 0.400 Test Loss: 1.120 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.43551015853881836
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.117 Vali Acc: 0.400 Test Loss: 1.117 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.49569082260131836
Epoch: 6, Steps: 1 | Train Loss: 0.846 Vali Loss: 1.114 Vali Acc: 0.533 Test Loss: 1.114 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.4037811756134033
Epoch: 7, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4371635913848877
Epoch: 8, Steps: 1 | Train Loss: 0.446 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4407684803009033
Epoch: 9, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.49248766899108887
Epoch: 10, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.203 Vali Acc: 0.467 Test Loss: 1.203 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5629763603210449
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.260 Vali Acc: 0.467 Test Loss: 1.260 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6144399642944336
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.47365856170654297
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.404 Vali Acc: 0.400 Test Loss: 1.404 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4812955856323242
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.483 Vali Acc: 0.467 Test Loss: 1.483 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.45781731605529785
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.564 Vali Acc: 0.467 Test Loss: 1.564 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.4611823558807373
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.645 Vali Acc: 0.467 Test Loss: 1.645 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6622759
model size : 25.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9250681400299072
Epoch: 1, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5518231391906738
Epoch: 2, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.036 Vali Acc: 0.467 Test Loss: 1.036 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4730689525604248
Epoch: 3, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.033 Vali Acc: 0.467 Test Loss: 1.033 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5001494884490967
Epoch: 4, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.44003820419311523
Epoch: 5, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.4383809566497803
Epoch: 6, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.024 Vali Acc: 0.533 Test Loss: 1.024 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.564305305480957
Epoch: 7, Steps: 1 | Train Loss: 0.669 Vali Loss: 1.026 Vali Acc: 0.533 Test Loss: 1.026 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6455421447753906
Epoch: 8, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.038 Vali Acc: 0.533 Test Loss: 1.038 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5075516700744629
Epoch: 9, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.064 Vali Acc: 0.600 Test Loss: 1.064 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 10 cost time: 0.520378589630127
Epoch: 10, Steps: 1 | Train Loss: 0.232 Vali Loss: 1.106 Vali Acc: 0.533 Test Loss: 1.106 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.47840261459350586
Epoch: 11, Steps: 1 | Train Loss: 0.153 Vali Loss: 1.163 Vali Acc: 0.533 Test Loss: 1.163 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.4350090026855469
Epoch: 12, Steps: 1 | Train Loss: 0.094 Vali Loss: 1.232 Vali Acc: 0.533 Test Loss: 1.232 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.39255619049072266
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.310 Vali Acc: 0.533 Test Loss: 1.310 Test Acc: 0.533
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5216035842895508
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.392 Vali Acc: 0.467 Test Loss: 1.392 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5518896579742432
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.478 Vali Acc: 0.467 Test Loss: 1.478 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.4878380298614502
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.563 Vali Acc: 0.467 Test Loss: 1.563 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5251739025115967
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.649 Vali Acc: 0.400 Test Loss: 1.649 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.48136186599731445
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.732 Vali Acc: 0.400 Test Loss: 1.732 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.46201658248901367
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.813 Vali Acc: 0.400 Test Loss: 1.813 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6585529
model size : 25.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8659758567810059
Epoch: 1, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.162 Vali Acc: 0.333 Test Loss: 1.162 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5095312595367432
Epoch: 2, Steps: 1 | Train Loss: 0.991 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5522136688232422
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.46878623962402344
Epoch: 4, Steps: 1 | Train Loss: 0.885 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.43645405769348145
Epoch: 5, Steps: 1 | Train Loss: 0.836 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6605451107025146
Epoch: 6, Steps: 1 | Train Loss: 0.790 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.5492875576019287
Epoch: 7, Steps: 1 | Train Loss: 0.579 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6024417877197266
Epoch: 8, Steps: 1 | Train Loss: 0.408 Vali Loss: 1.148 Vali Acc: 0.267 Test Loss: 1.148 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6743237972259521
Epoch: 9, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5652623176574707
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4617340564727783
Epoch: 11, Steps: 1 | Train Loss: 0.126 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.43932414054870605
Epoch: 12, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.321 Vali Acc: 0.333 Test Loss: 1.321 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5351381301879883
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5493416786193848
Epoch: 14, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.468 Vali Acc: 0.400 Test Loss: 1.468 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5558915138244629
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.547 Vali Acc: 0.400 Test Loss: 1.547 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.6063365936279297
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.628 Vali Acc: 0.400 Test Loss: 1.628 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5789971351623535
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.708 Vali Acc: 0.400 Test Loss: 1.708 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6598815
model size : 25.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7537050247192383
Epoch: 1, Steps: 1 | Train Loss: 0.972 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.42531681060791016
Epoch: 2, Steps: 1 | Train Loss: 0.920 Vali Loss: 1.125 Vali Acc: 0.333 Test Loss: 1.125 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5431137084960938
Epoch: 3, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.123 Vali Acc: 0.333 Test Loss: 1.123 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4296584129333496
Epoch: 4, Steps: 1 | Train Loss: 0.827 Vali Loss: 1.122 Vali Acc: 0.333 Test Loss: 1.122 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5277423858642578
Epoch: 5, Steps: 1 | Train Loss: 0.785 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5022172927856445
Epoch: 6, Steps: 1 | Train Loss: 0.745 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4880952835083008
Epoch: 7, Steps: 1 | Train Loss: 0.565 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4788815975189209
Epoch: 8, Steps: 1 | Train Loss: 0.413 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5405223369598389
Epoch: 9, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.203 Vali Acc: 0.333 Test Loss: 1.203 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5834333896636963
Epoch: 10, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.259 Vali Acc: 0.333 Test Loss: 1.259 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.4710538387298584
Epoch: 11, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.329 Vali Acc: 0.333 Test Loss: 1.329 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4388916492462158
Epoch: 12, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.410 Vali Acc: 0.333 Test Loss: 1.410 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5554912090301514
Epoch: 13, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.498 Vali Acc: 0.400 Test Loss: 1.498 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5973837375640869
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.591 Vali Acc: 0.333 Test Loss: 1.591 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5153625011444092
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.684 Vali Acc: 0.333 Test Loss: 1.684 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6577105
model size : 25.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.802736759185791
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.5346841812133789
Epoch: 2, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.238 Vali Acc: 0.267 Test Loss: 1.238 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.662102460861206
Epoch: 3, Steps: 1 | Train Loss: 0.992 Vali Loss: 1.236 Vali Acc: 0.267 Test Loss: 1.236 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.623274564743042
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.234 Vali Acc: 0.267 Test Loss: 1.234 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.49982643127441406
Epoch: 5, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.232 Vali Acc: 0.267 Test Loss: 1.232 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.6040868759155273
Epoch: 6, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.235 Vali Acc: 0.267 Test Loss: 1.235 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49034929275512695
Epoch: 7, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.244 Vali Acc: 0.133 Test Loss: 1.244 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5331158638000488
Epoch: 8, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.51338791847229
Epoch: 9, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.299 Vali Acc: 0.200 Test Loss: 1.299 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4844229221343994
Epoch: 10, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.349 Vali Acc: 0.267 Test Loss: 1.349 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7211589813232422
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.414 Vali Acc: 0.333 Test Loss: 1.414 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333319).  Saving model ...
Epoch: 12 cost time: 0.5428311824798584
Epoch: 12, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6501622200012207
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.575 Vali Acc: 0.333 Test Loss: 1.575 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.71360182762146
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.664 Vali Acc: 0.333 Test Loss: 1.664 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.4863433837890625
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.755 Vali Acc: 0.333 Test Loss: 1.755 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5838396549224854
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.846 Vali Acc: 0.333 Test Loss: 1.846 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5415337085723877
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.936 Vali Acc: 0.333 Test Loss: 1.936 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5787701606750488
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.024 Vali Acc: 0.333 Test Loss: 2.024 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6292724609375
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.109 Vali Acc: 0.333 Test Loss: 2.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.705010175704956
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.191 Vali Acc: 0.333 Test Loss: 2.191 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7746508121490479
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.270 Vali Acc: 0.333 Test Loss: 2.270 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm512_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6625911
model size : 25.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.877039909362793
Epoch: 1, Steps: 1 | Train Loss: 1.170 Vali Loss: 1.102 Vali Acc: 0.467 Test Loss: 1.102 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5827231407165527
Epoch: 2, Steps: 1 | Train Loss: 1.107 Vali Loss: 1.098 Vali Acc: 0.467 Test Loss: 1.098 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5307669639587402
Epoch: 3, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533322).  Saving model ...
Epoch: 4 cost time: 0.49086499214172363
Epoch: 4, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.089 Vali Acc: 0.533 Test Loss: 1.089 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 5 cost time: 0.572202205657959
Epoch: 5, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.085 Vali Acc: 0.533 Test Loss: 1.085 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 6 cost time: 0.49651479721069336
Epoch: 6, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.073 Vali Acc: 0.533 Test Loss: 1.073 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.5255436897277832
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.063 Vali Acc: 0.600 Test Loss: 1.063 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599989).  Saving model ...
Epoch: 8 cost time: 0.6385612487792969
Epoch: 8, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.060 Vali Acc: 0.600 Test Loss: 1.060 Test Acc: 0.600
Validation loss decreased (-0.599989 --> -0.599989).  Saving model ...
Epoch: 9 cost time: 0.5593280792236328
Epoch: 9, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6766650676727295
Epoch: 10, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.099 Vali Acc: 0.400 Test Loss: 1.099 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5240015983581543
Epoch: 11, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.142 Vali Acc: 0.400 Test Loss: 1.142 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.49506592750549316
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5814805030822754
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.267 Vali Acc: 0.333 Test Loss: 1.267 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6572530269622803
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5714514255523682
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6270256042480469
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.499 Vali Acc: 0.333 Test Loss: 1.499 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5541486740112305
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.578 Vali Acc: 0.333 Test Loss: 1.578 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5417547225952148
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.656 Vali Acc: 0.333 Test Loss: 1.656 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6550065
model size : 25.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs834_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.3180294036865234
Epoch: 1, Steps: 1 | Train Loss: 1.129 Vali Loss: 1.233 Vali Acc: 0.267 Test Loss: 1.233 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.6912014484405518
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.230 Vali Acc: 0.267 Test Loss: 1.230 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.7490124702453613
Epoch: 3, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.227 Vali Acc: 0.200 Test Loss: 1.227 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8710184097290039
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.224 Vali Acc: 0.200 Test Loss: 1.224 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.602515459060669
Epoch: 5, Steps: 1 | Train Loss: 0.894 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7122397422790527
Epoch: 6, Steps: 1 | Train Loss: 0.844 Vali Loss: 1.219 Vali Acc: 0.267 Test Loss: 1.219 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.6598882675170898
Epoch: 7, Steps: 1 | Train Loss: 0.616 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6425468921661377
Epoch: 8, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5158596038818359
Epoch: 9, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.255 Vali Acc: 0.400 Test Loss: 1.255 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399987).  Saving model ...
Epoch: 10 cost time: 0.4927051067352295
Epoch: 10, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.294 Vali Acc: 0.400 Test Loss: 1.294 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7669310569763184
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.348 Vali Acc: 0.400 Test Loss: 1.348 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5763626098632812
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.415 Vali Acc: 0.400 Test Loss: 1.415 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6469137668609619
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.491 Vali Acc: 0.400 Test Loss: 1.491 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.5270059108734131
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.572 Vali Acc: 0.400 Test Loss: 1.572 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.5698463916778564
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.657 Vali Acc: 0.400 Test Loss: 1.657 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.5142536163330078
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.742 Vali Acc: 0.333 Test Loss: 1.742 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5248503684997559
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.826 Vali Acc: 0.333 Test Loss: 1.826 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5114254951477051
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.909 Vali Acc: 0.333 Test Loss: 1.909 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5301787853240967
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.989 Vali Acc: 0.333 Test Loss: 1.989 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs834_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6501831
model size : 24.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs625_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8032958507537842
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.191 Vali Acc: 0.400 Test Loss: 1.191 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.6162781715393066
Epoch: 2, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.187 Vali Acc: 0.400 Test Loss: 1.187 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5238349437713623
Epoch: 3, Steps: 1 | Train Loss: 1.062 Vali Loss: 1.183 Vali Acc: 0.400 Test Loss: 1.183 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.6108882427215576
Epoch: 4, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.7329504489898682
Epoch: 5, Steps: 1 | Train Loss: 0.950 Vali Loss: 1.176 Vali Acc: 0.400 Test Loss: 1.176 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.7700295448303223
Epoch: 6, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.169 Vali Acc: 0.200 Test Loss: 1.169 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7255964279174805
Epoch: 7, Steps: 1 | Train Loss: 0.665 Vali Loss: 1.166 Vali Acc: 0.267 Test Loss: 1.166 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7179975509643555
Epoch: 8, Steps: 1 | Train Loss: 0.471 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5703983306884766
Epoch: 9, Steps: 1 | Train Loss: 0.331 Vali Loss: 1.194 Vali Acc: 0.200 Test Loss: 1.194 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5327019691467285
Epoch: 10, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.231 Vali Acc: 0.200 Test Loss: 1.231 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5719404220581055
Epoch: 11, Steps: 1 | Train Loss: 0.146 Vali Loss: 1.285 Vali Acc: 0.200 Test Loss: 1.285 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.743800163269043
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.351 Vali Acc: 0.200 Test Loss: 1.351 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6881849765777588
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.427 Vali Acc: 0.200 Test Loss: 1.427 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5480937957763672
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.509 Vali Acc: 0.267 Test Loss: 1.509 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7698721885681152
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.595 Vali Acc: 0.267 Test Loss: 1.595 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs625_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6470097
model size : 24.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.855219841003418
Epoch: 1, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.037 Vali Acc: 0.600 Test Loss: 1.037 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.5281679630279541
Epoch: 2, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.035 Vali Acc: 0.600 Test Loss: 1.035 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.6776471138000488
Epoch: 3, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.032 Vali Acc: 0.600 Test Loss: 1.032 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.5381677150726318
Epoch: 4, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.030 Vali Acc: 0.533 Test Loss: 1.030 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6604435443878174
Epoch: 5, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.028 Vali Acc: 0.533 Test Loss: 1.028 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.6164212226867676
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.027 Vali Acc: 0.533 Test Loss: 1.027 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5471162796020508
Epoch: 7, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.5139744281768799
Epoch: 8, Steps: 1 | Train Loss: 0.454 Vali Loss: 1.045 Vali Acc: 0.467 Test Loss: 1.045 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5094914436340332
Epoch: 9, Steps: 1 | Train Loss: 0.323 Vali Loss: 1.074 Vali Acc: 0.467 Test Loss: 1.074 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.5828070640563965
Epoch: 10, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.120 Vali Acc: 0.467 Test Loss: 1.120 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.6917200088500977
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.182 Vali Acc: 0.467 Test Loss: 1.182 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.6571958065032959
Epoch: 12, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.257 Vali Acc: 0.400 Test Loss: 1.257 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5570805072784424
Epoch: 13, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.341 Vali Acc: 0.333 Test Loss: 1.341 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6454119
model size : 24.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6214001178741455
Epoch: 1, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.245 Vali Acc: 0.333 Test Loss: 1.245 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.42964982986450195
Epoch: 2, Steps: 1 | Train Loss: 1.210 Vali Loss: 1.240 Vali Acc: 0.333 Test Loss: 1.240 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5250561237335205
Epoch: 3, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.235 Vali Acc: 0.333 Test Loss: 1.235 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5030925273895264
Epoch: 4, Steps: 1 | Train Loss: 1.087 Vali Loss: 1.231 Vali Acc: 0.333 Test Loss: 1.231 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.5024423599243164
Epoch: 5, Steps: 1 | Train Loss: 1.030 Vali Loss: 1.226 Vali Acc: 0.333 Test Loss: 1.226 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5134332180023193
Epoch: 6, Steps: 1 | Train Loss: 0.975 Vali Loss: 1.216 Vali Acc: 0.400 Test Loss: 1.216 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.5035586357116699
Epoch: 7, Steps: 1 | Train Loss: 0.725 Vali Loss: 1.208 Vali Acc: 0.400 Test Loss: 1.208 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.6477093696594238
Epoch: 8, Steps: 1 | Train Loss: 0.517 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5191330909729004
Epoch: 9, Steps: 1 | Train Loss: 0.369 Vali Loss: 1.223 Vali Acc: 0.267 Test Loss: 1.223 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6236884593963623
Epoch: 10, Steps: 1 | Train Loss: 0.258 Vali Loss: 1.252 Vali Acc: 0.333 Test Loss: 1.252 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6489405632019043
Epoch: 11, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.297 Vali Acc: 0.333 Test Loss: 1.297 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4549577236175537
Epoch: 12, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.576134204864502
Epoch: 13, Steps: 1 | Train Loss: 0.062 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4934728145599365
Epoch: 14, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.491 Vali Acc: 0.333 Test Loss: 1.491 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5544528961181641
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.566 Vali Acc: 0.400 Test Loss: 1.566 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5109670162200928
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.717409610748291
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.719 Vali Acc: 0.333 Test Loss: 1.719 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6448521
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.82413911819458
Epoch: 1, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.160 Vali Acc: 0.333 Test Loss: 1.160 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.48888611793518066
Epoch: 2, Steps: 1 | Train Loss: 1.250 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.501349687576294
Epoch: 3, Steps: 1 | Train Loss: 1.184 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5885918140411377
Epoch: 4, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.145 Vali Acc: 0.333 Test Loss: 1.145 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6330511569976807
Epoch: 5, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5266642570495605
Epoch: 6, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6028227806091309
Epoch: 7, Steps: 1 | Train Loss: 0.741 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6009421348571777
Epoch: 8, Steps: 1 | Train Loss: 0.520 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.46945905685424805
Epoch: 9, Steps: 1 | Train Loss: 0.365 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.49961400032043457
Epoch: 10, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.39281439781188965
Epoch: 11, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6754300594329834
Epoch: 12, Steps: 1 | Train Loss: 0.107 Vali Loss: 1.294 Vali Acc: 0.267 Test Loss: 1.294 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5521047115325928
Epoch: 13, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6558232307434082
Epoch: 14, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.447 Vali Acc: 0.333 Test Loss: 1.447 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5254638195037842
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.530 Vali Acc: 0.333 Test Loss: 1.530 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6450999
model size : 24.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7555625438690186
Epoch: 1, Steps: 1 | Train Loss: 1.214 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.5337851047515869
Epoch: 2, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.129 Vali Acc: 0.200 Test Loss: 1.129 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5551154613494873
Epoch: 3, Steps: 1 | Train Loss: 1.088 Vali Loss: 1.127 Vali Acc: 0.200 Test Loss: 1.127 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.48540544509887695
Epoch: 4, Steps: 1 | Train Loss: 1.029 Vali Loss: 1.125 Vali Acc: 0.200 Test Loss: 1.125 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 5 cost time: 0.5306107997894287
Epoch: 5, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.123 Vali Acc: 0.200 Test Loss: 1.123 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 6 cost time: 0.5348329544067383
Epoch: 6, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.126 Vali Acc: 0.200 Test Loss: 1.126 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5891454219818115
Epoch: 7, Steps: 1 | Train Loss: 0.681 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.199989 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4660043716430664
Epoch: 8, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.155 Vali Acc: 0.200 Test Loss: 1.155 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5219752788543701
Epoch: 9, Steps: 1 | Train Loss: 0.347 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5952339172363281
Epoch: 10, Steps: 1 | Train Loss: 0.241 Vali Loss: 1.241 Vali Acc: 0.267 Test Loss: 1.241 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5573267936706543
Epoch: 11, Steps: 1 | Train Loss: 0.158 Vali Loss: 1.308 Vali Acc: 0.400 Test Loss: 1.308 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399987).  Saving model ...
Epoch: 12 cost time: 0.6150736808776855
Epoch: 12, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.387 Vali Acc: 0.333 Test Loss: 1.387 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8094887733459473
Epoch: 13, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.475 Vali Acc: 0.333 Test Loss: 1.475 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5947084426879883
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.567 Vali Acc: 0.400 Test Loss: 1.567 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7263553142547607
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.660 Vali Acc: 0.400 Test Loss: 1.660 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5079846382141113
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.754 Vali Acc: 0.400 Test Loss: 1.754 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.5847034454345703
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.845 Vali Acc: 0.400 Test Loss: 1.845 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6610012054443359
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.935 Vali Acc: 0.400 Test Loss: 1.935 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6297557353973389
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.021 Vali Acc: 0.400 Test Loss: 2.021 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.545910120010376
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.104 Vali Acc: 0.400 Test Loss: 2.104 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5565431118011475
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.184 Vali Acc: 0.400 Test Loss: 2.184 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6440273
model size : 24.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8336198329925537
Epoch: 1, Steps: 1 | Train Loss: 1.222 Vali Loss: 1.319 Vali Acc: 0.200 Test Loss: 1.319 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.4533102512359619
Epoch: 2, Steps: 1 | Train Loss: 1.159 Vali Loss: 1.317 Vali Acc: 0.200 Test Loss: 1.317 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5077362060546875
Epoch: 3, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.315 Vali Acc: 0.200 Test Loss: 1.315 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.6400918960571289
Epoch: 4, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.314 Vali Acc: 0.200 Test Loss: 1.314 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.5140731334686279
Epoch: 5, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.312 Vali Acc: 0.200 Test Loss: 1.312 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.4889943599700928
Epoch: 6, Steps: 1 | Train Loss: 0.935 Vali Loss: 1.311 Vali Acc: 0.267 Test Loss: 1.311 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.585615873336792
Epoch: 7, Steps: 1 | Train Loss: 0.698 Vali Loss: 1.314 Vali Acc: 0.267 Test Loss: 1.314 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5280790328979492
Epoch: 8, Steps: 1 | Train Loss: 0.503 Vali Loss: 1.327 Vali Acc: 0.267 Test Loss: 1.327 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5215537548065186
Epoch: 9, Steps: 1 | Train Loss: 0.362 Vali Loss: 1.354 Vali Acc: 0.267 Test Loss: 1.354 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.41211438179016113
Epoch: 10, Steps: 1 | Train Loss: 0.254 Vali Loss: 1.396 Vali Acc: 0.200 Test Loss: 1.396 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5825247764587402
Epoch: 11, Steps: 1 | Train Loss: 0.167 Vali Loss: 1.455 Vali Acc: 0.200 Test Loss: 1.455 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5192000865936279
Epoch: 12, Steps: 1 | Train Loss: 0.103 Vali Loss: 1.528 Vali Acc: 0.200 Test Loss: 1.528 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5232772827148438
Epoch: 13, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.611 Vali Acc: 0.200 Test Loss: 1.611 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6392619609832764
Epoch: 14, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.701 Vali Acc: 0.200 Test Loss: 1.701 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6089565753936768
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.795 Vali Acc: 0.200 Test Loss: 1.795 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.76275634765625
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.889 Vali Acc: 0.200 Test Loss: 1.889 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.26666666666666666
model parameter : 6430831
model size : 24.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.78175687789917
Epoch: 1, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.093 Vali Acc: 0.400 Test Loss: 1.093 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5248053073883057
Epoch: 2, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6421949863433838
Epoch: 3, Steps: 1 | Train Loss: 1.025 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4952976703643799
Epoch: 4, Steps: 1 | Train Loss: 0.971 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5105452537536621
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.083 Vali Acc: 0.400 Test Loss: 1.083 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5120933055877686
Epoch: 6, Steps: 1 | Train Loss: 0.873 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.43613600730895996
Epoch: 7, Steps: 1 | Train Loss: 0.648 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5825197696685791
Epoch: 8, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.090 Vali Acc: 0.467 Test Loss: 1.090 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5641562938690186
Epoch: 9, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5997071266174316
Epoch: 10, Steps: 1 | Train Loss: 0.220 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5174298286437988
Epoch: 11, Steps: 1 | Train Loss: 0.144 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6019735336303711
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.270 Vali Acc: 0.333 Test Loss: 1.270 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5429656505584717
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.342 Vali Acc: 0.333 Test Loss: 1.342 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.534930944442749
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.419 Vali Acc: 0.400 Test Loss: 1.419 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6242108345031738
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.497 Vali Acc: 0.400 Test Loss: 1.497 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5653200149536133
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.577 Vali Acc: 0.400 Test Loss: 1.577 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48276281356811523
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.656 Vali Acc: 0.400 Test Loss: 1.656 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6422289
model size : 24.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0170469284057617
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.211 Vali Acc: 0.133 Test Loss: 1.211 Test Acc: 0.133
Validation loss decreased (inf --> -0.133321).  Saving model ...
Epoch: 2 cost time: 0.5053691864013672
Epoch: 2, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.207 Vali Acc: 0.133 Test Loss: 1.207 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 3 cost time: 0.5538461208343506
Epoch: 3, Steps: 1 | Train Loss: 1.005 Vali Loss: 1.203 Vali Acc: 0.200 Test Loss: 1.203 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.5781877040863037
Epoch: 4, Steps: 1 | Train Loss: 0.951 Vali Loss: 1.200 Vali Acc: 0.267 Test Loss: 1.200 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.575709342956543
Epoch: 5, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6190509796142578
Epoch: 6, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.190 Vali Acc: 0.200 Test Loss: 1.190 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.563805103302002
Epoch: 7, Steps: 1 | Train Loss: 0.634 Vali Loss: 1.188 Vali Acc: 0.200 Test Loss: 1.188 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5266146659851074
Epoch: 8, Steps: 1 | Train Loss: 0.453 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 9 cost time: 0.5883643627166748
Epoch: 9, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.212 Vali Acc: 0.267 Test Loss: 1.212 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47709012031555176
Epoch: 10, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.245 Vali Acc: 0.267 Test Loss: 1.245 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5217514038085938
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.292 Vali Acc: 0.267 Test Loss: 1.292 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6299488544464111
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.351 Vali Acc: 0.267 Test Loss: 1.351 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5120260715484619
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.420 Vali Acc: 0.267 Test Loss: 1.420 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5250759124755859
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.496 Vali Acc: 0.267 Test Loss: 1.496 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.46840691566467285
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.575 Vali Acc: 0.267 Test Loss: 1.575 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5288147926330566
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333317).  Saving model ...
Epoch: 17 cost time: 0.513451099395752
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.736 Vali Acc: 0.400 Test Loss: 1.736 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399983).  Saving model ...
Epoch: 18 cost time: 0.5827672481536865
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.815 Vali Acc: 0.400 Test Loss: 1.815 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.48338747024536133
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.892 Vali Acc: 0.400 Test Loss: 1.892 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5473096370697021
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.967 Vali Acc: 0.400 Test Loss: 1.967 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5164141654968262
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.038 Vali Acc: 0.400 Test Loss: 2.038 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.603752851486206
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.106 Vali Acc: 0.400 Test Loss: 2.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.4939413070678711
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.171 Vali Acc: 0.400 Test Loss: 2.171 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5183882713317871
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.233 Vali Acc: 0.400 Test Loss: 2.233 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.4743773937225342
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.291 Vali Acc: 0.400 Test Loss: 2.291 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.48161983489990234
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.346 Vali Acc: 0.400 Test Loss: 2.346 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6553170680999756
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.400 Test Loss: 2.397 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6439519
model size : 24.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.1655397415161133
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
Validation loss decreased (inf --> -0.533324).  Saving model ...
Epoch: 2 cost time: 0.614300012588501
Epoch: 2, Steps: 1 | Train Loss: 0.965 Vali Loss: 0.935 Vali Acc: 0.533 Test Loss: 0.935 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 3 cost time: 0.494049072265625
Epoch: 3, Steps: 1 | Train Loss: 0.917 Vali Loss: 0.932 Vali Acc: 0.533 Test Loss: 0.932 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 4 cost time: 0.7445809841156006
Epoch: 4, Steps: 1 | Train Loss: 0.871 Vali Loss: 0.930 Vali Acc: 0.533 Test Loss: 0.930 Test Acc: 0.533
Validation loss decreased (-0.533324 --> -0.533324).  Saving model ...
Epoch: 5 cost time: 0.8759145736694336
Epoch: 5, Steps: 1 | Train Loss: 0.827 Vali Loss: 0.927 Vali Acc: 0.600 Test Loss: 0.927 Test Acc: 0.600
Validation loss decreased (-0.533324 --> -0.599991).  Saving model ...
Epoch: 6 cost time: 0.7881252765655518
Epoch: 6, Steps: 1 | Train Loss: 0.787 Vali Loss: 0.924 Vali Acc: 0.533 Test Loss: 0.924 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6329305171966553
Epoch: 7, Steps: 1 | Train Loss: 0.593 Vali Loss: 0.926 Vali Acc: 0.533 Test Loss: 0.926 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7353787422180176
Epoch: 8, Steps: 1 | Train Loss: 0.429 Vali Loss: 0.937 Vali Acc: 0.533 Test Loss: 0.937 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6900882720947266
Epoch: 9, Steps: 1 | Train Loss: 0.302 Vali Loss: 0.962 Vali Acc: 0.400 Test Loss: 0.962 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6368939876556396
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.002 Vali Acc: 0.467 Test Loss: 1.002 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7332618236541748
Epoch: 11, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.058 Vali Acc: 0.467 Test Loss: 1.058 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8189103603363037
Epoch: 12, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.127 Vali Acc: 0.400 Test Loss: 1.127 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7196519374847412
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6110663414001465
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.288 Vali Acc: 0.400 Test Loss: 1.288 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5548994541168213
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.374 Vali Acc: 0.400 Test Loss: 1.374 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6437137
model size : 24.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.843548059463501
Epoch: 1, Steps: 1 | Train Loss: 1.033 Vali Loss: 0.998 Vali Acc: 0.667 Test Loss: 0.998 Test Acc: 0.667
Validation loss decreased (inf --> -0.666657).  Saving model ...
Epoch: 2 cost time: 0.5524759292602539
Epoch: 2, Steps: 1 | Train Loss: 0.977 Vali Loss: 0.996 Vali Acc: 0.667 Test Loss: 0.996 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666657).  Saving model ...
Epoch: 3 cost time: 0.5686869621276855
Epoch: 3, Steps: 1 | Train Loss: 0.923 Vali Loss: 0.994 Vali Acc: 0.533 Test Loss: 0.994 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5700664520263672
Epoch: 4, Steps: 1 | Train Loss: 0.872 Vali Loss: 0.993 Vali Acc: 0.533 Test Loss: 0.993 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.46650195121765137
Epoch: 5, Steps: 1 | Train Loss: 0.825 Vali Loss: 0.992 Vali Acc: 0.533 Test Loss: 0.992 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.4874691963195801
Epoch: 6, Steps: 1 | Train Loss: 0.781 Vali Loss: 0.993 Vali Acc: 0.400 Test Loss: 0.993 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.5240585803985596
Epoch: 7, Steps: 1 | Train Loss: 0.580 Vali Loss: 1.001 Vali Acc: 0.400 Test Loss: 1.001 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5945913791656494
Epoch: 8, Steps: 1 | Train Loss: 0.415 Vali Loss: 1.021 Vali Acc: 0.333 Test Loss: 1.021 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5449399948120117
Epoch: 9, Steps: 1 | Train Loss: 0.293 Vali Loss: 1.057 Vali Acc: 0.333 Test Loss: 1.057 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.594451904296875
Epoch: 10, Steps: 1 | Train Loss: 0.199 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5106911659240723
Epoch: 11, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.176 Vali Acc: 0.333 Test Loss: 1.176 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6010775566101074
Epoch: 12, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.253 Vali Acc: 0.333 Test Loss: 1.253 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 6437643
model size : 24.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.2511911392211914
Epoch: 1, Steps: 1 | Train Loss: 1.196 Vali Loss: 1.134 Vali Acc: 0.467 Test Loss: 1.134 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.6512084007263184
Epoch: 2, Steps: 1 | Train Loss: 1.132 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.8915121555328369
Epoch: 3, Steps: 1 | Train Loss: 1.072 Vali Loss: 1.128 Vali Acc: 0.467 Test Loss: 1.128 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.638099193572998
Epoch: 4, Steps: 1 | Train Loss: 1.014 Vali Loss: 1.125 Vali Acc: 0.467 Test Loss: 1.125 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.7048916816711426
Epoch: 5, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.122 Vali Acc: 0.467 Test Loss: 1.122 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.544856071472168
Epoch: 6, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.117 Vali Acc: 0.533 Test Loss: 1.117 Test Acc: 0.533
Validation loss decreased (-0.466655 --> -0.533322).  Saving model ...
Epoch: 7 cost time: 0.6445927619934082
Epoch: 7, Steps: 1 | Train Loss: 0.671 Vali Loss: 1.116 Vali Acc: 0.467 Test Loss: 1.116 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7891242504119873
Epoch: 8, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.123 Vali Acc: 0.533 Test Loss: 1.123 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5911076068878174
Epoch: 9, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.143 Vali Acc: 0.467 Test Loss: 1.143 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8306560516357422
Epoch: 10, Steps: 1 | Train Loss: 0.234 Vali Loss: 1.177 Vali Acc: 0.467 Test Loss: 1.177 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6037449836730957
Epoch: 11, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.226 Vali Acc: 0.400 Test Loss: 1.226 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.666128396987915
Epoch: 12, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.286 Vali Acc: 0.400 Test Loss: 1.286 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6733357906341553
Epoch: 13, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.356 Vali Acc: 0.467 Test Loss: 1.356 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6939907073974609
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.432 Vali Acc: 0.400 Test Loss: 1.432 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6319606304168701
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.512 Vali Acc: 0.400 Test Loss: 1.512 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6540124416351318
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.592 Vali Acc: 0.400 Test Loss: 1.592 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6428409
model size : 24.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6843979358673096
Epoch: 1, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.530693769454956
Epoch: 2, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.6018481254577637
Epoch: 3, Steps: 1 | Train Loss: 0.937 Vali Loss: 1.194 Vali Acc: 0.333 Test Loss: 1.194 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5782127380371094
Epoch: 4, Steps: 1 | Train Loss: 0.887 Vali Loss: 1.192 Vali Acc: 0.333 Test Loss: 1.192 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6263124942779541
Epoch: 5, Steps: 1 | Train Loss: 0.841 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.41808295249938965
Epoch: 6, Steps: 1 | Train Loss: 0.798 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5950748920440674
Epoch: 7, Steps: 1 | Train Loss: 0.596 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4819610118865967
Epoch: 8, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.234 Vali Acc: 0.400 Test Loss: 1.234 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.6360368728637695
Epoch: 9, Steps: 1 | Train Loss: 0.303 Vali Loss: 1.273 Vali Acc: 0.333 Test Loss: 1.273 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5363843441009521
Epoch: 10, Steps: 1 | Train Loss: 0.207 Vali Loss: 1.326 Vali Acc: 0.333 Test Loss: 1.326 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5829141139984131
Epoch: 11, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6625053882598877
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.468 Vali Acc: 0.267 Test Loss: 1.468 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5259852409362793
Epoch: 13, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.550 Vali Acc: 0.267 Test Loss: 1.550 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.4894998073577881
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.635 Vali Acc: 0.267 Test Loss: 1.635 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5088343620300293
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.723 Vali Acc: 0.267 Test Loss: 1.723 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6363327503204346
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.810 Vali Acc: 0.267 Test Loss: 1.810 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6582310199737549
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.897 Vali Acc: 0.267 Test Loss: 1.897 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7021565437316895
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.981 Vali Acc: 0.267 Test Loss: 1.981 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6424435
model size : 24.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9358997344970703
Epoch: 1, Steps: 1 | Train Loss: 1.122 Vali Loss: 1.086 Vali Acc: 0.267 Test Loss: 1.086 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6312124729156494
Epoch: 2, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.083 Vali Acc: 0.267 Test Loss: 1.083 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5318105220794678
Epoch: 3, Steps: 1 | Train Loss: 1.006 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.577183723449707
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.5497844219207764
Epoch: 5, Steps: 1 | Train Loss: 0.903 Vali Loss: 1.074 Vali Acc: 0.333 Test Loss: 1.074 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.47406554222106934
Epoch: 6, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.067 Vali Acc: 0.333 Test Loss: 1.067 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.4984462261199951
Epoch: 7, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.6891312599182129
Epoch: 8, Steps: 1 | Train Loss: 0.467 Vali Loss: 1.065 Vali Acc: 0.400 Test Loss: 1.065 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.6425204277038574
Epoch: 9, Steps: 1 | Train Loss: 0.335 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5572741031646729
Epoch: 10, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.100 Vali Acc: 0.400 Test Loss: 1.100 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5687823295593262
Epoch: 11, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.134 Vali Acc: 0.400 Test Loss: 1.134 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.528461217880249
Epoch: 12, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.180 Vali Acc: 0.400 Test Loss: 1.180 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5226001739501953
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.236 Vali Acc: 0.400 Test Loss: 1.236 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6493353843688965
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.300 Vali Acc: 0.400 Test Loss: 1.300 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4945991039276123
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5218949317932129
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.444 Vali Acc: 0.400 Test Loss: 1.444 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4744682312011719
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.520 Vali Acc: 0.467 Test Loss: 1.520 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466651).  Saving model ...
Epoch: 18 cost time: 0.5376238822937012
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.595 Vali Acc: 0.467 Test Loss: 1.595 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.47849059104919434
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.669 Vali Acc: 0.467 Test Loss: 1.669 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5211930274963379
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.741 Vali Acc: 0.467 Test Loss: 1.741 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6547892093658447
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.811 Vali Acc: 0.467 Test Loss: 1.811 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5487194061279297
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.878 Vali Acc: 0.467 Test Loss: 1.878 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5516417026519775
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 1.941 Vali Acc: 0.467 Test Loss: 1.941 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.48734045028686523
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.002 Vali Acc: 0.467 Test Loss: 2.002 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5341551303863525
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.059 Vali Acc: 0.467 Test Loss: 2.059 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.5108804702758789
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.113 Vali Acc: 0.467 Test Loss: 2.113 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6229748725891113
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.164 Vali Acc: 0.400 Test Loss: 2.164 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6440721
model size : 24.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7718896865844727
Epoch: 1, Steps: 1 | Train Loss: 1.034 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5206396579742432
Epoch: 2, Steps: 1 | Train Loss: 0.979 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.6194660663604736
Epoch: 3, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.113 Vali Acc: 0.333 Test Loss: 1.113 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.51922607421875
Epoch: 4, Steps: 1 | Train Loss: 0.877 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.4937930107116699
Epoch: 5, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5330681800842285
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5516211986541748
Epoch: 7, Steps: 1 | Train Loss: 0.591 Vali Loss: 1.126 Vali Acc: 0.333 Test Loss: 1.126 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6251723766326904
Epoch: 8, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.147 Vali Acc: 0.267 Test Loss: 1.147 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5421218872070312
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.181 Vali Acc: 0.267 Test Loss: 1.181 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.48668861389160156
Epoch: 10, Steps: 1 | Train Loss: 0.202 Vali Loss: 1.231 Vali Acc: 0.267 Test Loss: 1.231 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5864992141723633
Epoch: 11, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.295 Vali Acc: 0.267 Test Loss: 1.295 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5904548168182373
Epoch: 12, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.369 Vali Acc: 0.267 Test Loss: 1.369 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.48912596702575684
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.451 Vali Acc: 0.267 Test Loss: 1.451 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.45171666145324707
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.536 Vali Acc: 0.333 Test Loss: 1.536 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4604029655456543
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.622 Vali Acc: 0.333 Test Loss: 1.622 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6449639
model size : 24.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9362921714782715
Epoch: 1, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.082 Vali Acc: 0.400 Test Loss: 1.082 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5400350093841553
Epoch: 2, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6203334331512451
Epoch: 3, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4733443260192871
Epoch: 4, Steps: 1 | Train Loss: 0.907 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5475888252258301
Epoch: 5, Steps: 1 | Train Loss: 0.856 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5390808582305908
Epoch: 6, Steps: 1 | Train Loss: 0.809 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5914559364318848
Epoch: 7, Steps: 1 | Train Loss: 0.598 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.530102014541626
Epoch: 8, Steps: 1 | Train Loss: 0.430 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5177171230316162
Epoch: 9, Steps: 1 | Train Loss: 0.308 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5992190837860107
Epoch: 10, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5912554264068604
Epoch: 11, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5454311370849609
Epoch: 12, Steps: 1 | Train Loss: 0.083 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5427403450012207
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.46828484535217285
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.456 Vali Acc: 0.333 Test Loss: 1.456 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.41588282585144043
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.549 Vali Acc: 0.400 Test Loss: 1.549 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5625066757202148
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.643 Vali Acc: 0.467 Test Loss: 1.643 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6413561
model size : 24.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9839262962341309
Epoch: 1, Steps: 1 | Train Loss: 1.162 Vali Loss: 1.175 Vali Acc: 0.267 Test Loss: 1.175 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5616817474365234
Epoch: 2, Steps: 1 | Train Loss: 1.102 Vali Loss: 1.173 Vali Acc: 0.267 Test Loss: 1.173 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.533012866973877
Epoch: 3, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.171 Vali Acc: 0.267 Test Loss: 1.171 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5895507335662842
Epoch: 4, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5010581016540527
Epoch: 5, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5493419170379639
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5114178657531738
Epoch: 7, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6274621486663818
Epoch: 8, Steps: 1 | Train Loss: 0.485 Vali Loss: 1.200 Vali Acc: 0.200 Test Loss: 1.200 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5493295192718506
Epoch: 9, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.235 Vali Acc: 0.200 Test Loss: 1.235 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6103012561798096
Epoch: 10, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333320).  Saving model ...
Epoch: 11 cost time: 0.6451230049133301
Epoch: 11, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.356 Vali Acc: 0.333 Test Loss: 1.356 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6430461406707764
Epoch: 12, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.435 Vali Acc: 0.333 Test Loss: 1.435 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.4791390895843506
Epoch: 13, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.523 Vali Acc: 0.333 Test Loss: 1.523 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5818343162536621
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.795642614364624
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5569806098937988
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.800 Vali Acc: 0.333 Test Loss: 1.800 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5330984592437744
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.891 Vali Acc: 0.333 Test Loss: 1.891 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5152590274810791
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.979 Vali Acc: 0.333 Test Loss: 1.979 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5853469371795654
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.064 Vali Acc: 0.333 Test Loss: 2.064 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5833964347839355
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.146 Vali Acc: 0.267 Test Loss: 2.146 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6427743
model size : 24.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7147269248962402
Epoch: 1, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.180 Vali Acc: 0.133 Test Loss: 1.180 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.407120943069458
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.177 Vali Acc: 0.133 Test Loss: 1.177 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 3 cost time: 0.49230265617370605
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.174 Vali Acc: 0.133 Test Loss: 1.174 Test Acc: 0.133
Validation loss decreased (-0.133322 --> -0.133322).  Saving model ...
Epoch: 4 cost time: 0.6280043125152588
Epoch: 4, Steps: 1 | Train Loss: 0.906 Vali Loss: 1.171 Vali Acc: 0.200 Test Loss: 1.171 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5315577983856201
Epoch: 5, Steps: 1 | Train Loss: 0.859 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5372495651245117
Epoch: 6, Steps: 1 | Train Loss: 0.815 Vali Loss: 1.167 Vali Acc: 0.200 Test Loss: 1.167 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5712132453918457
Epoch: 7, Steps: 1 | Train Loss: 0.613 Vali Loss: 1.170 Vali Acc: 0.267 Test Loss: 1.170 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5607204437255859
Epoch: 8, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.183 Vali Acc: 0.267 Test Loss: 1.183 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4965641498565674
Epoch: 9, Steps: 1 | Train Loss: 0.317 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.4697849750518799
Epoch: 10, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 11 cost time: 0.6010112762451172
Epoch: 11, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5553131103515625
Epoch: 12, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.380 Vali Acc: 0.400 Test Loss: 1.380 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 0.5731964111328125
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.456 Vali Acc: 0.400 Test Loss: 1.456 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5020062923431396
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.535 Vali Acc: 0.400 Test Loss: 1.535 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5893044471740723
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5694215297698975
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.700 Vali Acc: 0.400 Test Loss: 1.700 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.44731998443603516
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.781 Vali Acc: 0.400 Test Loss: 1.781 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5168972015380859
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.861 Vali Acc: 0.400 Test Loss: 1.861 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.6270244121551514
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.939 Vali Acc: 0.400 Test Loss: 1.939 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6581168174743652
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.014 Vali Acc: 0.400 Test Loss: 2.014 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5649263858795166
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.086 Vali Acc: 0.400 Test Loss: 2.086 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5777828693389893
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.155 Vali Acc: 0.400 Test Loss: 2.155 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6406929
model size : 24.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7807836532592773
Epoch: 1, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.094 Vali Acc: 0.467 Test Loss: 1.094 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.44374513626098633
Epoch: 2, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.091 Vali Acc: 0.400 Test Loss: 1.091 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.464871883392334
Epoch: 3, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.088 Vali Acc: 0.400 Test Loss: 1.088 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4560229778289795
Epoch: 4, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6243324279785156
Epoch: 5, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.082 Vali Acc: 0.467 Test Loss: 1.082 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4676949977874756
Epoch: 6, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.075 Vali Acc: 0.467 Test Loss: 1.075 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5269885063171387
Epoch: 7, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.4553861618041992
Epoch: 8, Steps: 1 | Train Loss: 0.394 Vali Loss: 1.077 Vali Acc: 0.333 Test Loss: 1.077 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4942135810852051
Epoch: 9, Steps: 1 | Train Loss: 0.278 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.46669769287109375
Epoch: 10, Steps: 1 | Train Loss: 0.189 Vali Loss: 1.124 Vali Acc: 0.333 Test Loss: 1.124 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5328919887542725
Epoch: 11, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4472064971923828
Epoch: 12, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7001326084136963
Epoch: 13, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5432136058807373
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.365 Vali Acc: 0.333 Test Loss: 1.365 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6383762359619141
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.442 Vali Acc: 0.333 Test Loss: 1.442 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.440814733505249
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.520 Vali Acc: 0.333 Test Loss: 1.520 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.46898961067199707
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.600 Vali Acc: 0.333 Test Loss: 1.600 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm256_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6456375
model size : 24.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6703863143920898
Epoch: 1, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4999415874481201
Epoch: 2, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5796749591827393
Epoch: 3, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.094 Vali Acc: 0.267 Test Loss: 1.094 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4124302864074707
Epoch: 4, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.092 Vali Acc: 0.267 Test Loss: 1.092 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.49871110916137695
Epoch: 5, Steps: 1 | Train Loss: 0.832 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.3752923011779785
Epoch: 6, Steps: 1 | Train Loss: 0.788 Vali Loss: 1.094 Vali Acc: 0.333 Test Loss: 1.094 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.35172080993652344
Epoch: 7, Steps: 1 | Train Loss: 0.586 Vali Loss: 1.103 Vali Acc: 0.333 Test Loss: 1.103 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.40013790130615234
Epoch: 8, Steps: 1 | Train Loss: 0.421 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.3975834846496582
Epoch: 9, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.152 Vali Acc: 0.400 Test Loss: 1.152 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47968029975891113
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6176614761352539
Epoch: 11, Steps: 1 | Train Loss: 0.129 Vali Loss: 1.248 Vali Acc: 0.400 Test Loss: 1.248 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5432019233703613
Epoch: 12, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.313 Vali Acc: 0.400 Test Loss: 1.313 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4631679058074951
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.385 Vali Acc: 0.333 Test Loss: 1.385 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.425337553024292
Epoch: 14, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.464 Vali Acc: 0.333 Test Loss: 1.464 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4475429058074951
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.546 Vali Acc: 0.333 Test Loss: 1.546 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5299267768859863
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.631 Vali Acc: 0.333 Test Loss: 1.631 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.7334380149841309
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.716 Vali Acc: 0.333 Test Loss: 1.716 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.4569704532623291
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.800 Vali Acc: 0.333 Test Loss: 1.800 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6411409
model size : 24.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs834_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7587544918060303
Epoch: 1, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.639672040939331
Epoch: 2, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.117 Vali Acc: 0.267 Test Loss: 1.117 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5407688617706299
Epoch: 3, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.4837801456451416
Epoch: 4, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.111 Vali Acc: 0.267 Test Loss: 1.111 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.5356860160827637
Epoch: 5, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.43146276473999023
Epoch: 6, Steps: 1 | Train Loss: 0.751 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4912703037261963
Epoch: 7, Steps: 1 | Train Loss: 0.562 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4681098461151123
Epoch: 8, Steps: 1 | Train Loss: 0.405 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5187132358551025
Epoch: 9, Steps: 1 | Train Loss: 0.286 Vali Loss: 1.129 Vali Acc: 0.400 Test Loss: 1.129 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5597701072692871
Epoch: 10, Steps: 1 | Train Loss: 0.193 Vali Loss: 1.162 Vali Acc: 0.467 Test Loss: 1.162 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 11 cost time: 0.7951419353485107
Epoch: 11, Steps: 1 | Train Loss: 0.122 Vali Loss: 1.207 Vali Acc: 0.467 Test Loss: 1.207 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4849269390106201
Epoch: 12, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.263 Vali Acc: 0.467 Test Loss: 1.263 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.45177769660949707
Epoch: 13, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.329 Vali Acc: 0.400 Test Loss: 1.329 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5178987979888916
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.401 Vali Acc: 0.400 Test Loss: 1.401 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5315344333648682
Epoch: 15, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.479 Vali Acc: 0.400 Test Loss: 1.479 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.49788761138916016
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.558 Vali Acc: 0.400 Test Loss: 1.558 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5869936943054199
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.638 Vali Acc: 0.400 Test Loss: 1.638 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6032028198242188
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.400 Test Loss: 1.718 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6072220802307129
Epoch: 19, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.796 Vali Acc: 0.400 Test Loss: 1.796 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.4781827926635742
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.872 Vali Acc: 0.400 Test Loss: 1.872 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs834_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6389799
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs625_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5194015502929688
Epoch: 1, Steps: 1 | Train Loss: 1.178 Vali Loss: 1.072 Vali Acc: 0.467 Test Loss: 1.072 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5914914608001709
Epoch: 2, Steps: 1 | Train Loss: 1.114 Vali Loss: 1.071 Vali Acc: 0.467 Test Loss: 1.071 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5599372386932373
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.070 Vali Acc: 0.467 Test Loss: 1.070 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5077013969421387
Epoch: 4, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5011944770812988
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5597343444824219
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.073 Vali Acc: 0.333 Test Loss: 1.073 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.5408759117126465
Epoch: 7, Steps: 1 | Train Loss: 0.650 Vali Loss: 1.085 Vali Acc: 0.400 Test Loss: 1.085 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.4427483081817627
Epoch: 8, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.106 Vali Acc: 0.400 Test Loss: 1.106 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.5953223705291748
Epoch: 9, Steps: 1 | Train Loss: 0.322 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 0.47736263275146484
Epoch: 10, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 0.5277173519134521
Epoch: 11, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.248 Vali Acc: 0.333 Test Loss: 1.248 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.495589017868042
Epoch: 12, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.319 Vali Acc: 0.333 Test Loss: 1.319 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 0.5495362281799316
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.397 Vali Acc: 0.333 Test Loss: 1.397 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs625_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6371441
model size : 24.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.809995174407959
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.214 Vali Acc: 0.200 Test Loss: 1.214 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.47266221046447754
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.432828426361084
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.210 Vali Acc: 0.200 Test Loss: 1.210 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4747459888458252
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.44063639640808105
Epoch: 5, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.488710880279541
Epoch: 6, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.213 Vali Acc: 0.200 Test Loss: 1.213 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.47127819061279297
Epoch: 7, Steps: 1 | Train Loss: 0.621 Vali Loss: 1.227 Vali Acc: 0.133 Test Loss: 1.227 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.513547420501709
Epoch: 8, Steps: 1 | Train Loss: 0.447 Vali Loss: 1.253 Vali Acc: 0.267 Test Loss: 1.253 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 9 cost time: 0.4294607639312744
Epoch: 9, Steps: 1 | Train Loss: 0.318 Vali Loss: 1.293 Vali Acc: 0.333 Test Loss: 1.293 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333320).  Saving model ...
Epoch: 10 cost time: 0.3936750888824463
Epoch: 10, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.349 Vali Acc: 0.400 Test Loss: 1.349 Test Acc: 0.400
Validation loss decreased (-0.333320 --> -0.399987).  Saving model ...
Epoch: 11 cost time: 0.4327116012573242
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.417 Vali Acc: 0.400 Test Loss: 1.417 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5429556369781494
Epoch: 12, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.495 Vali Acc: 0.400 Test Loss: 1.495 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.44389843940734863
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.579 Vali Acc: 0.400 Test Loss: 1.579 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.4996304512023926
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.666 Vali Acc: 0.333 Test Loss: 1.666 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4875152111053467
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.754 Vali Acc: 0.333 Test Loss: 1.754 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5223920345306396
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.842 Vali Acc: 0.333 Test Loss: 1.842 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6309752464294434
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.928 Vali Acc: 0.333 Test Loss: 1.928 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.503892183303833
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.012 Vali Acc: 0.333 Test Loss: 2.012 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.578571081161499
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.093 Vali Acc: 0.333 Test Loss: 2.093 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5432746410369873
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.170 Vali Acc: 0.333 Test Loss: 2.170 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6363463
model size : 24.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9386062622070312
Epoch: 1, Steps: 1 | Train Loss: 1.171 Vali Loss: 1.391 Vali Acc: 0.067 Test Loss: 1.391 Test Acc: 0.067
Validation loss decreased (inf --> -0.066653).  Saving model ...
Epoch: 2 cost time: 0.6516375541687012
Epoch: 2, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.388 Vali Acc: 0.067 Test Loss: 1.388 Test Acc: 0.067
Validation loss decreased (-0.066653 --> -0.066653).  Saving model ...
Epoch: 3 cost time: 0.5074496269226074
Epoch: 3, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.385 Vali Acc: 0.133 Test Loss: 1.385 Test Acc: 0.133
Validation loss decreased (-0.066653 --> -0.133319).  Saving model ...
Epoch: 4 cost time: 0.5399506092071533
Epoch: 4, Steps: 1 | Train Loss: 0.981 Vali Loss: 1.382 Vali Acc: 0.133 Test Loss: 1.382 Test Acc: 0.133
Validation loss decreased (-0.133319 --> -0.133320).  Saving model ...
Epoch: 5 cost time: 0.5532636642456055
Epoch: 5, Steps: 1 | Train Loss: 0.924 Vali Loss: 1.379 Vali Acc: 0.133 Test Loss: 1.379 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 6 cost time: 0.49806976318359375
Epoch: 6, Steps: 1 | Train Loss: 0.869 Vali Loss: 1.376 Vali Acc: 0.133 Test Loss: 1.376 Test Acc: 0.133
Validation loss decreased (-0.133320 --> -0.133320).  Saving model ...
Epoch: 7 cost time: 0.5252509117126465
Epoch: 7, Steps: 1 | Train Loss: 0.627 Vali Loss: 1.378 Vali Acc: 0.133 Test Loss: 1.378 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5437023639678955
Epoch: 8, Steps: 1 | Train Loss: 0.435 Vali Loss: 1.390 Vali Acc: 0.200 Test Loss: 1.390 Test Acc: 0.200
Validation loss decreased (-0.133320 --> -0.199986).  Saving model ...
Epoch: 9 cost time: 0.5041921138763428
Epoch: 9, Steps: 1 | Train Loss: 0.305 Vali Loss: 1.417 Vali Acc: 0.200 Test Loss: 1.417 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5456771850585938
Epoch: 10, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.460 Vali Acc: 0.200 Test Loss: 1.460 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5746324062347412
Epoch: 11, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.517 Vali Acc: 0.267 Test Loss: 1.517 Test Acc: 0.267
Validation loss decreased (-0.199986 --> -0.266651).  Saving model ...
Epoch: 12 cost time: 0.6526393890380859
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.585 Vali Acc: 0.267 Test Loss: 1.585 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5508167743682861
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.659 Vali Acc: 0.267 Test Loss: 1.659 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6604180335998535
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.739 Vali Acc: 0.267 Test Loss: 1.739 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5234856605529785
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.820 Vali Acc: 0.333 Test Loss: 1.820 Test Acc: 0.333
Validation loss decreased (-0.266651 --> -0.333315).  Saving model ...
Epoch: 16 cost time: 0.5358982086181641
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.901 Vali Acc: 0.333 Test Loss: 1.901 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5159778594970703
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.982 Vali Acc: 0.333 Test Loss: 1.982 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6406641006469727
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 2.061 Vali Acc: 0.333 Test Loss: 2.061 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6534092426300049
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.138 Vali Acc: 0.333 Test Loss: 2.138 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5991489887237549
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.211 Vali Acc: 0.333 Test Loss: 2.211 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6430130004882812
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.282 Vali Acc: 0.400 Test Loss: 2.282 Test Acc: 0.400
Validation loss decreased (-0.333315 --> -0.399977).  Saving model ...
Epoch: 22 cost time: 0.7504653930664062
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.400 Test Loss: 2.350 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.44524693489074707
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.414 Vali Acc: 0.400 Test Loss: 2.414 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5686953067779541
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.475 Vali Acc: 0.400 Test Loss: 2.475 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.49768757820129395
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.533 Vali Acc: 0.400 Test Loss: 2.533 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.519439697265625
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.587 Vali Acc: 0.400 Test Loss: 2.587 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.563530683517456
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.639 Vali Acc: 0.400 Test Loss: 2.639 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5370445251464844
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.687 Vali Acc: 0.400 Test Loss: 2.687 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5864706039428711
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.732 Vali Acc: 0.400 Test Loss: 2.732 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6290638446807861
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.400 Test Loss: 2.774 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5446126461029053
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.400 Test Loss: 2.814 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6363177
model size : 24.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6226136684417725
Epoch: 1, Steps: 1 | Train Loss: 1.180 Vali Loss: 1.163 Vali Acc: 0.267 Test Loss: 1.163 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.6647286415100098
Epoch: 2, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5175001621246338
Epoch: 3, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.155 Vali Acc: 0.333 Test Loss: 1.155 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.46908092498779297
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.151 Vali Acc: 0.333 Test Loss: 1.151 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5567083358764648
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.147 Vali Acc: 0.333 Test Loss: 1.147 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4886472225189209
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.577106237411499
Epoch: 7, Steps: 1 | Train Loss: 0.654 Vali Loss: 1.141 Vali Acc: 0.333 Test Loss: 1.141 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.4189457893371582
Epoch: 8, Steps: 1 | Train Loss: 0.464 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6451730728149414
Epoch: 9, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.173 Vali Acc: 0.333 Test Loss: 1.173 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.48055195808410645
Epoch: 10, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.213 Vali Acc: 0.333 Test Loss: 1.213 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5651140213012695
Epoch: 11, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.269 Vali Acc: 0.333 Test Loss: 1.269 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5381784439086914
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.339 Vali Acc: 0.333 Test Loss: 1.339 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5923492908477783
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.418 Vali Acc: 0.333 Test Loss: 1.418 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6042733192443848
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5647234916687012
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.589 Vali Acc: 0.333 Test Loss: 1.589 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5214674472808838
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.675 Vali Acc: 0.333 Test Loss: 1.675 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5308675765991211
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.761 Vali Acc: 0.333 Test Loss: 1.761 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6369431
model size : 24.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.0315587520599365
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.099 Vali Acc: 0.333 Test Loss: 1.099 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.8293161392211914
Epoch: 2, Steps: 1 | Train Loss: 1.044 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5102832317352295
Epoch: 3, Steps: 1 | Train Loss: 0.990 Vali Loss: 1.093 Vali Acc: 0.267 Test Loss: 1.093 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6220378875732422
Epoch: 4, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.090 Vali Acc: 0.333 Test Loss: 1.090 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5835187435150146
Epoch: 5, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.087 Vali Acc: 0.333 Test Loss: 1.087 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5149075984954834
Epoch: 6, Steps: 1 | Train Loss: 0.845 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.594944953918457
Epoch: 7, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.082 Vali Acc: 0.333 Test Loss: 1.082 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 8 cost time: 0.6376852989196777
Epoch: 8, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.089 Vali Acc: 0.333 Test Loss: 1.089 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7621982097625732
Epoch: 9, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5969347953796387
Epoch: 10, Steps: 1 | Train Loss: 0.225 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6985037326812744
Epoch: 11, Steps: 1 | Train Loss: 0.145 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6293995380401611
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.261 Vali Acc: 0.400 Test Loss: 1.261 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399987).  Saving model ...
Epoch: 13 cost time: 0.6488046646118164
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.336 Vali Acc: 0.400 Test Loss: 1.336 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4437699317932129
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.418 Vali Acc: 0.400 Test Loss: 1.418 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6436688899993896
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.503 Vali Acc: 0.400 Test Loss: 1.503 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5736680030822754
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.589 Vali Acc: 0.400 Test Loss: 1.589 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5464611053466797
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.675 Vali Acc: 0.400 Test Loss: 1.675 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6157727241516113
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.759 Vali Acc: 0.400 Test Loss: 1.759 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.630319356918335
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.840 Vali Acc: 0.400 Test Loss: 1.840 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5458774566650391
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.918 Vali Acc: 0.400 Test Loss: 1.918 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5978336334228516
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.467 Test Loss: 1.992 Test Acc: 0.467
Validation loss decreased (-0.399987 --> -0.466647).  Saving model ...
Epoch: 22 cost time: 0.6275913715362549
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.064 Vali Acc: 0.467 Test Loss: 2.064 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8567495346069336
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.131 Vali Acc: 0.467 Test Loss: 2.131 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6680698394775391
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.196 Vali Acc: 0.467 Test Loss: 2.196 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6278183460235596
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.256 Vali Acc: 0.467 Test Loss: 2.256 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6763131618499756
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.313 Vali Acc: 0.467 Test Loss: 2.313 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6171209812164307
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.367 Vali Acc: 0.467 Test Loss: 2.367 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6980006694793701
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.417 Vali Acc: 0.467 Test Loss: 2.417 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7424120903015137
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.464 Vali Acc: 0.467 Test Loss: 2.464 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6483137607574463
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.508 Vali Acc: 0.467 Test Loss: 2.508 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5824704170227051
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.549 Vali Acc: 0.467 Test Loss: 2.549 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6361585
model size : 24.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7111763954162598
Epoch: 1, Steps: 1 | Train Loss: 1.155 Vali Loss: 1.270 Vali Acc: 0.267 Test Loss: 1.270 Test Acc: 0.267
Validation loss decreased (inf --> -0.266654).  Saving model ...
Epoch: 2 cost time: 0.527742862701416
Epoch: 2, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.45795178413391113
Epoch: 3, Steps: 1 | Train Loss: 1.032 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 4 cost time: 0.7346692085266113
Epoch: 4, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.258 Vali Acc: 0.267 Test Loss: 1.258 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 5 cost time: 0.600898027420044
Epoch: 5, Steps: 1 | Train Loss: 0.922 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.6380453109741211
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.6518902778625488
Epoch: 7, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.6137580871582031
Epoch: 8, Steps: 1 | Train Loss: 0.448 Vali Loss: 1.256 Vali Acc: 0.400 Test Loss: 1.256 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6454966068267822
Epoch: 9, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.279 Vali Acc: 0.267 Test Loss: 1.279 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5767700672149658
Epoch: 10, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6685268878936768
Epoch: 11, Steps: 1 | Train Loss: 0.139 Vali Loss: 1.373 Vali Acc: 0.267 Test Loss: 1.373 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6002721786499023
Epoch: 12, Steps: 1 | Train Loss: 0.087 Vali Loss: 1.441 Vali Acc: 0.267 Test Loss: 1.441 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5638370513916016
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.517 Vali Acc: 0.267 Test Loss: 1.517 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5030519962310791
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.600 Vali Acc: 0.267 Test Loss: 1.600 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5554430484771729
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.685 Vali Acc: 0.267 Test Loss: 1.685 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5636084079742432
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.770 Vali Acc: 0.267 Test Loss: 1.770 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7203421592712402
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.855 Vali Acc: 0.267 Test Loss: 1.855 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6354383
model size : 24.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9358866214752197
Epoch: 1, Steps: 1 | Train Loss: 1.173 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
Validation loss decreased (inf --> -0.466655).  Saving model ...
Epoch: 2 cost time: 0.59710693359375
Epoch: 2, Steps: 1 | Train Loss: 1.110 Vali Loss: 1.184 Vali Acc: 0.467 Test Loss: 1.184 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 3 cost time: 0.4572641849517822
Epoch: 3, Steps: 1 | Train Loss: 1.050 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5305154323577881
Epoch: 4, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.181 Vali Acc: 0.467 Test Loss: 1.181 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.6038327217102051
Epoch: 5, Steps: 1 | Train Loss: 0.939 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5729951858520508
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.179 Vali Acc: 0.467 Test Loss: 1.179 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.6100356578826904
Epoch: 7, Steps: 1 | Train Loss: 0.658 Vali Loss: 1.183 Vali Acc: 0.467 Test Loss: 1.183 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5855710506439209
Epoch: 8, Steps: 1 | Train Loss: 0.470 Vali Loss: 1.195 Vali Acc: 0.400 Test Loss: 1.195 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7195999622344971
Epoch: 9, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.515627384185791
Epoch: 10, Steps: 1 | Train Loss: 0.230 Vali Loss: 1.262 Vali Acc: 0.267 Test Loss: 1.262 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5326590538024902
Epoch: 11, Steps: 1 | Train Loss: 0.150 Vali Loss: 1.319 Vali Acc: 0.267 Test Loss: 1.319 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6244001388549805
Epoch: 12, Steps: 1 | Train Loss: 0.091 Vali Loss: 1.390 Vali Acc: 0.267 Test Loss: 1.390 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6471171379089355
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.472 Vali Acc: 0.267 Test Loss: 1.472 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5814776420593262
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.559 Vali Acc: 0.333 Test Loss: 1.559 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.8333568572998047
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.649 Vali Acc: 0.333 Test Loss: 1.649 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6451551914215088
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.740 Vali Acc: 0.333 Test Loss: 1.740 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6347633
model size : 24.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7896449565887451
Epoch: 1, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.202 Vali Acc: 0.267 Test Loss: 1.202 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.4669468402862549
Epoch: 2, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.596865177154541
Epoch: 3, Steps: 1 | Train Loss: 0.976 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.4858090877532959
Epoch: 4, Steps: 1 | Train Loss: 0.923 Vali Loss: 1.188 Vali Acc: 0.267 Test Loss: 1.188 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5061354637145996
Epoch: 5, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.184 Vali Acc: 0.267 Test Loss: 1.184 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5342831611633301
Epoch: 6, Steps: 1 | Train Loss: 0.825 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.4488406181335449
Epoch: 7, Steps: 1 | Train Loss: 0.612 Vali Loss: 1.175 Vali Acc: 0.400 Test Loss: 1.175 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.37659502029418945
Epoch: 8, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4591376781463623
Epoch: 9, Steps: 1 | Train Loss: 0.309 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.4314076900482178
Epoch: 10, Steps: 1 | Train Loss: 0.211 Vali Loss: 1.236 Vali Acc: 0.333 Test Loss: 1.236 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.3975846767425537
Epoch: 11, Steps: 1 | Train Loss: 0.134 Vali Loss: 1.287 Vali Acc: 0.267 Test Loss: 1.287 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5120940208435059
Epoch: 12, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.353 Vali Acc: 0.267 Test Loss: 1.353 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4908754825592041
Epoch: 13, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.429 Vali Acc: 0.333 Test Loss: 1.429 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.4794352054595947
Epoch: 14, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.513 Vali Acc: 0.333 Test Loss: 1.513 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4685344696044922
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.601 Vali Acc: 0.333 Test Loss: 1.601 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4342339038848877
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.690 Vali Acc: 0.333 Test Loss: 1.690 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.40769267082214355
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.778 Vali Acc: 0.333 Test Loss: 1.778 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6366271
model size : 24.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9575772285461426
Epoch: 1, Steps: 1 | Train Loss: 1.141 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4720916748046875
Epoch: 2, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.085 Vali Acc: 0.333 Test Loss: 1.085 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.49980998039245605
Epoch: 3, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.083 Vali Acc: 0.333 Test Loss: 1.083 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.6974794864654541
Epoch: 4, Steps: 1 | Train Loss: 0.966 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.5957090854644775
Epoch: 5, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.6699368953704834
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.628730297088623
Epoch: 7, Steps: 1 | Train Loss: 0.631 Vali Loss: 1.090 Vali Acc: 0.400 Test Loss: 1.090 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6041345596313477
Epoch: 8, Steps: 1 | Train Loss: 0.442 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6254680156707764
Epoch: 9, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.146 Vali Acc: 0.467 Test Loss: 1.146 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 10 cost time: 0.6707484722137451
Epoch: 10, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6860485076904297
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.266 Vali Acc: 0.400 Test Loss: 1.266 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5673301219940186
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.346 Vali Acc: 0.400 Test Loss: 1.346 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5897111892700195
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.433 Vali Acc: 0.400 Test Loss: 1.433 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7307097911834717
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.524 Vali Acc: 0.400 Test Loss: 1.524 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.624697208404541
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.617 Vali Acc: 0.400 Test Loss: 1.617 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7183551788330078
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.709 Vali Acc: 0.400 Test Loss: 1.709 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5129044055938721
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.799 Vali Acc: 0.400 Test Loss: 1.799 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.6160776615142822
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.887 Vali Acc: 0.400 Test Loss: 1.887 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5891580581665039
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.971 Vali Acc: 0.333 Test Loss: 1.971 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6365105
model size : 24.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9539594650268555
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.013 Vali Acc: 0.600 Test Loss: 1.013 Test Acc: 0.600
Validation loss decreased (inf --> -0.599990).  Saving model ...
Epoch: 2 cost time: 0.4268207550048828
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.011 Vali Acc: 0.600 Test Loss: 1.011 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 3 cost time: 0.4417853355407715
Epoch: 3, Steps: 1 | Train Loss: 0.986 Vali Loss: 1.009 Vali Acc: 0.600 Test Loss: 1.009 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 4 cost time: 0.5206358432769775
Epoch: 4, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 5 cost time: 0.5324306488037109
Epoch: 5, Steps: 1 | Train Loss: 0.881 Vali Loss: 1.005 Vali Acc: 0.600 Test Loss: 1.005 Test Acc: 0.600
Validation loss decreased (-0.599990 --> -0.599990).  Saving model ...
Epoch: 6 cost time: 0.598642110824585
Epoch: 6, Steps: 1 | Train Loss: 0.833 Vali Loss: 1.007 Vali Acc: 0.600 Test Loss: 1.007 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6633791923522949
Epoch: 7, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.014 Vali Acc: 0.600 Test Loss: 1.014 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5713531970977783
Epoch: 8, Steps: 1 | Train Loss: 0.428 Vali Loss: 1.032 Vali Acc: 0.533 Test Loss: 1.032 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7075331211090088
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.066 Vali Acc: 0.467 Test Loss: 1.066 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7219083309173584
Epoch: 10, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5777237415313721
Epoch: 11, Steps: 1 | Train Loss: 0.133 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5370817184448242
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.253 Vali Acc: 0.400 Test Loss: 1.253 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5201246738433838
Epoch: 13, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.335 Vali Acc: 0.400 Test Loss: 1.335 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6857736110687256
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.421 Vali Acc: 0.333 Test Loss: 1.421 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6143772602081299
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.509 Vali Acc: 0.333 Test Loss: 1.509 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6366635
model size : 24.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.735649585723877
Epoch: 1, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.292 Vali Acc: 0.200 Test Loss: 1.292 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.5505554676055908
Epoch: 2, Steps: 1 | Train Loss: 1.277 Vali Loss: 1.288 Vali Acc: 0.200 Test Loss: 1.288 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.49771785736083984
Epoch: 3, Steps: 1 | Train Loss: 1.212 Vali Loss: 1.283 Vali Acc: 0.200 Test Loss: 1.283 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.5022478103637695
Epoch: 4, Steps: 1 | Train Loss: 1.149 Vali Loss: 1.279 Vali Acc: 0.200 Test Loss: 1.279 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.47014379501342773
Epoch: 5, Steps: 1 | Train Loss: 1.090 Vali Loss: 1.275 Vali Acc: 0.200 Test Loss: 1.275 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 6 cost time: 0.4659543037414551
Epoch: 6, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.267 Vali Acc: 0.267 Test Loss: 1.267 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 7 cost time: 0.5240695476531982
Epoch: 7, Steps: 1 | Train Loss: 0.771 Vali Loss: 1.263 Vali Acc: 0.200 Test Loss: 1.263 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5079185962677002
Epoch: 8, Steps: 1 | Train Loss: 0.550 Vali Loss: 1.267 Vali Acc: 0.133 Test Loss: 1.267 Test Acc: 0.133
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5177152156829834
Epoch: 9, Steps: 1 | Train Loss: 0.390 Vali Loss: 1.285 Vali Acc: 0.133 Test Loss: 1.285 Test Acc: 0.133
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5346581935882568
Epoch: 10, Steps: 1 | Train Loss: 0.272 Vali Loss: 1.319 Vali Acc: 0.133 Test Loss: 1.319 Test Acc: 0.133
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.694943904876709
Epoch: 11, Steps: 1 | Train Loss: 0.179 Vali Loss: 1.371 Vali Acc: 0.133 Test Loss: 1.371 Test Acc: 0.133
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5081577301025391
Epoch: 12, Steps: 1 | Train Loss: 0.110 Vali Loss: 1.438 Vali Acc: 0.267 Test Loss: 1.438 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5537173748016357
Epoch: 13, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.515 Vali Acc: 0.267 Test Loss: 1.515 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5216639041900635
Epoch: 14, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.599 Vali Acc: 0.333 Test Loss: 1.599 Test Acc: 0.333
Validation loss decreased (-0.266654 --> -0.333317).  Saving model ...
Epoch: 15 cost time: 0.5295534133911133
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.686 Vali Acc: 0.333 Test Loss: 1.686 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5074312686920166
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.775 Vali Acc: 0.333 Test Loss: 1.775 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.526212215423584
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.863 Vali Acc: 0.333 Test Loss: 1.863 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5421397686004639
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.950 Vali Acc: 0.333 Test Loss: 1.950 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5512123107910156
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.034 Vali Acc: 0.333 Test Loss: 2.034 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.49588775634765625
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.115 Vali Acc: 0.333 Test Loss: 2.115 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5178332328796387
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.192 Vali Acc: 0.333 Test Loss: 2.192 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.4896862506866455
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.267 Vali Acc: 0.333 Test Loss: 2.267 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7089176177978516
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.337 Vali Acc: 0.333 Test Loss: 2.337 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5812487602233887
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.404 Vali Acc: 0.400 Test Loss: 2.404 Test Acc: 0.400
Validation loss decreased (-0.333317 --> -0.399976).  Saving model ...
Epoch: 25 cost time: 0.7349555492401123
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.467 Vali Acc: 0.400 Test Loss: 2.467 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6547541618347168
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.527 Vali Acc: 0.400 Test Loss: 2.527 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5149068832397461
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.583 Vali Acc: 0.400 Test Loss: 2.583 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7334372997283936
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.635 Vali Acc: 0.400 Test Loss: 2.635 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8258473873138428
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.685 Vali Acc: 0.400 Test Loss: 2.685 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5481245517730713
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.731 Vali Acc: 0.400 Test Loss: 2.731 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.620659351348877
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.774 Vali Acc: 0.400 Test Loss: 2.774 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.6200599670410156
Epoch: 32, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.814 Vali Acc: 0.400 Test Loss: 2.814 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5264565944671631
Epoch: 33, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.852 Vali Acc: 0.400 Test Loss: 2.852 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6608076095581055
Epoch: 34, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.887 Vali Acc: 0.400 Test Loss: 2.887 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6358297
model size : 24.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9476313591003418
Epoch: 1, Steps: 1 | Train Loss: 1.262 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5530219078063965
Epoch: 2, Steps: 1 | Train Loss: 1.195 Vali Loss: 1.162 Vali Acc: 0.267 Test Loss: 1.162 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5433130264282227
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5375549793243408
Epoch: 4, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5665886402130127
Epoch: 5, Steps: 1 | Train Loss: 1.011 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4847421646118164
Epoch: 6, Steps: 1 | Train Loss: 0.955 Vali Loss: 1.154 Vali Acc: 0.333 Test Loss: 1.154 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5154457092285156
Epoch: 7, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.159 Vali Acc: 0.467 Test Loss: 1.159 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6102855205535889
Epoch: 8, Steps: 1 | Train Loss: 0.498 Vali Loss: 1.173 Vali Acc: 0.467 Test Loss: 1.173 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5115642547607422
Epoch: 9, Steps: 1 | Train Loss: 0.354 Vali Loss: 1.200 Vali Acc: 0.467 Test Loss: 1.200 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5083723068237305
Epoch: 10, Steps: 1 | Train Loss: 0.247 Vali Loss: 1.242 Vali Acc: 0.467 Test Loss: 1.242 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5828967094421387
Epoch: 11, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.299 Vali Acc: 0.400 Test Loss: 1.299 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5393879413604736
Epoch: 12, Steps: 1 | Train Loss: 0.099 Vali Loss: 1.369 Vali Acc: 0.400 Test Loss: 1.369 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5082709789276123
Epoch: 13, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.449 Vali Acc: 0.400 Test Loss: 1.449 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5190622806549072
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.536 Vali Acc: 0.400 Test Loss: 1.536 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.529249906539917
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.626 Vali Acc: 0.400 Test Loss: 1.626 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5046069622039795
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.716 Vali Acc: 0.400 Test Loss: 1.716 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.38790249824523926
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.806 Vali Acc: 0.400 Test Loss: 1.806 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6355091
model size : 24.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8913192749023438
Epoch: 1, Steps: 1 | Train Loss: 0.997 Vali Loss: 1.066 Vali Acc: 0.400 Test Loss: 1.066 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.5769739151000977
Epoch: 2, Steps: 1 | Train Loss: 0.944 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.45134568214416504
Epoch: 3, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.055 Vali Acc: 0.467 Test Loss: 1.055 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4535808563232422
Epoch: 4, Steps: 1 | Train Loss: 0.848 Vali Loss: 1.051 Vali Acc: 0.467 Test Loss: 1.051 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.4642610549926758
Epoch: 5, Steps: 1 | Train Loss: 0.804 Vali Loss: 1.046 Vali Acc: 0.467 Test Loss: 1.046 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5567026138305664
Epoch: 6, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.037 Vali Acc: 0.400 Test Loss: 1.037 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4384446144104004
Epoch: 7, Steps: 1 | Train Loss: 0.572 Vali Loss: 1.032 Vali Acc: 0.400 Test Loss: 1.032 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.4611995220184326
Epoch: 8, Steps: 1 | Train Loss: 0.411 Vali Loss: 1.038 Vali Acc: 0.267 Test Loss: 1.038 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5324666500091553
Epoch: 9, Steps: 1 | Train Loss: 0.291 Vali Loss: 1.059 Vali Acc: 0.333 Test Loss: 1.059 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.47969818115234375
Epoch: 10, Steps: 1 | Train Loss: 0.198 Vali Loss: 1.096 Vali Acc: 0.333 Test Loss: 1.096 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5503828525543213
Epoch: 11, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.149 Vali Acc: 0.333 Test Loss: 1.149 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.47682929039001465
Epoch: 12, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.215 Vali Acc: 0.400 Test Loss: 1.215 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5339438915252686
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.49166107177734375
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.370 Vali Acc: 0.400 Test Loss: 1.370 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.47683191299438477
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.453 Vali Acc: 0.400 Test Loss: 1.453 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6372017
model size : 24.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6951937675476074
Epoch: 1, Steps: 1 | Train Loss: 1.230 Vali Loss: 1.145 Vali Acc: 0.200 Test Loss: 1.145 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.765981912612915
Epoch: 2, Steps: 1 | Train Loss: 1.166 Vali Loss: 1.143 Vali Acc: 0.200 Test Loss: 1.143 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 3 cost time: 0.5066013336181641
Epoch: 3, Steps: 1 | Train Loss: 1.106 Vali Loss: 1.141 Vali Acc: 0.200 Test Loss: 1.141 Test Acc: 0.200
Validation loss decreased (-0.199989 --> -0.199989).  Saving model ...
Epoch: 4 cost time: 0.4530222415924072
Epoch: 4, Steps: 1 | Train Loss: 1.048 Vali Loss: 1.139 Vali Acc: 0.267 Test Loss: 1.139 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5406651496887207
Epoch: 5, Steps: 1 | Train Loss: 0.993 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.4382312297821045
Epoch: 6, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.4366295337677002
Epoch: 7, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.138 Vali Acc: 0.267 Test Loss: 1.138 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.41347265243530273
Epoch: 8, Steps: 1 | Train Loss: 0.508 Vali Loss: 1.151 Vali Acc: 0.267 Test Loss: 1.151 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5274374485015869
Epoch: 9, Steps: 1 | Train Loss: 0.366 Vali Loss: 1.179 Vali Acc: 0.200 Test Loss: 1.179 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5096902847290039
Epoch: 10, Steps: 1 | Train Loss: 0.257 Vali Loss: 1.223 Vali Acc: 0.200 Test Loss: 1.223 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.4851677417755127
Epoch: 11, Steps: 1 | Train Loss: 0.170 Vali Loss: 1.282 Vali Acc: 0.200 Test Loss: 1.282 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.590216875076294
Epoch: 12, Steps: 1 | Train Loss: 0.105 Vali Loss: 1.355 Vali Acc: 0.200 Test Loss: 1.355 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.49061083793640137
Epoch: 13, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.437 Vali Acc: 0.200 Test Loss: 1.437 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5973031520843506
Epoch: 14, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.524 Vali Acc: 0.267 Test Loss: 1.524 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.41545963287353516
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.48349761962890625
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.705 Vali Acc: 0.333 Test Loss: 1.705 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6381511
model size : 24.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8855035305023193
Epoch: 1, Steps: 1 | Train Loss: 1.203 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.7346837520599365
Epoch: 2, Steps: 1 | Train Loss: 1.138 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.43623971939086914
Epoch: 3, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.205 Vali Acc: 0.333 Test Loss: 1.205 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.6186964511871338
Epoch: 4, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.199 Vali Acc: 0.333 Test Loss: 1.199 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.49697113037109375
Epoch: 5, Steps: 1 | Train Loss: 0.963 Vali Loss: 1.194 Vali Acc: 0.267 Test Loss: 1.194 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49609875679016113
Epoch: 6, Steps: 1 | Train Loss: 0.910 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.46039319038391113
Epoch: 7, Steps: 1 | Train Loss: 0.668 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.5957863330841064
Epoch: 8, Steps: 1 | Train Loss: 0.472 Vali Loss: 1.169 Vali Acc: 0.400 Test Loss: 1.169 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.631061315536499
Epoch: 9, Steps: 1 | Train Loss: 0.334 Vali Loss: 1.181 Vali Acc: 0.400 Test Loss: 1.181 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5208868980407715
Epoch: 10, Steps: 1 | Train Loss: 0.233 Vali Loss: 1.209 Vali Acc: 0.333 Test Loss: 1.209 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5004045963287354
Epoch: 11, Steps: 1 | Train Loss: 0.154 Vali Loss: 1.254 Vali Acc: 0.333 Test Loss: 1.254 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.535853385925293
Epoch: 12, Steps: 1 | Train Loss: 0.095 Vali Loss: 1.312 Vali Acc: 0.400 Test Loss: 1.312 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5117602348327637
Epoch: 13, Steps: 1 | Train Loss: 0.056 Vali Loss: 1.381 Vali Acc: 0.400 Test Loss: 1.381 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.49376440048217773
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.456 Vali Acc: 0.400 Test Loss: 1.456 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5116815567016602
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.534 Vali Acc: 0.467 Test Loss: 1.534 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466651).  Saving model ...
Epoch: 16 cost time: 0.49035096168518066
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.614 Vali Acc: 0.467 Test Loss: 1.614 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5061516761779785
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.693 Vali Acc: 0.467 Test Loss: 1.693 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.46239662170410156
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.771 Vali Acc: 0.533 Test Loss: 1.771 Test Acc: 0.533
Validation loss decreased (-0.466651 --> -0.533316).  Saving model ...
Epoch: 19 cost time: 0.5100600719451904
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.848 Vali Acc: 0.467 Test Loss: 1.848 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.486422061920166
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.921 Vali Acc: 0.467 Test Loss: 1.921 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5082221031188965
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 1.992 Vali Acc: 0.467 Test Loss: 1.992 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5335330963134766
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.060 Vali Acc: 0.467 Test Loss: 2.060 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6478824615478516
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.124 Vali Acc: 0.467 Test Loss: 2.124 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5960760116577148
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.185 Vali Acc: 0.467 Test Loss: 2.185 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6304960250854492
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.243 Vali Acc: 0.467 Test Loss: 2.243 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.5035698413848877
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.298 Vali Acc: 0.467 Test Loss: 2.298 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.555156946182251
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.350 Vali Acc: 0.467 Test Loss: 2.350 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.53706955909729
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.398 Vali Acc: 0.467 Test Loss: 2.398 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6346009
model size : 24.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7227661609649658
Epoch: 1, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.246 Vali Acc: 0.067 Test Loss: 1.246 Test Acc: 0.067
Validation loss decreased (inf --> -0.066654).  Saving model ...
Epoch: 2 cost time: 0.6064252853393555
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.243 Vali Acc: 0.067 Test Loss: 1.243 Test Acc: 0.067
Validation loss decreased (-0.066654 --> -0.066654).  Saving model ...
Epoch: 3 cost time: 0.6087541580200195
Epoch: 3, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.239 Vali Acc: 0.133 Test Loss: 1.239 Test Acc: 0.133
Validation loss decreased (-0.066654 --> -0.133321).  Saving model ...
Epoch: 4 cost time: 0.515061616897583
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.235 Vali Acc: 0.133 Test Loss: 1.235 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 5 cost time: 0.5006382465362549
Epoch: 5, Steps: 1 | Train Loss: 0.858 Vali Loss: 1.232 Vali Acc: 0.133 Test Loss: 1.232 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 6 cost time: 0.49888086318969727
Epoch: 6, Steps: 1 | Train Loss: 0.810 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 7 cost time: 0.5499615669250488
Epoch: 7, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.226 Vali Acc: 0.133 Test Loss: 1.226 Test Acc: 0.133
Validation loss decreased (-0.133321 --> -0.133321).  Saving model ...
Epoch: 8 cost time: 0.4949474334716797
Epoch: 8, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
Validation loss decreased (-0.133321 --> -0.199988).  Saving model ...
Epoch: 9 cost time: 0.5022344589233398
Epoch: 9, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.253 Vali Acc: 0.133 Test Loss: 1.253 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6405079364776611
Epoch: 10, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.288 Vali Acc: 0.200 Test Loss: 1.288 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.4985620975494385
Epoch: 11, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.337 Vali Acc: 0.200 Test Loss: 1.337 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6110217571258545
Epoch: 12, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.398 Vali Acc: 0.200 Test Loss: 1.398 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.4862082004547119
Epoch: 13, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.469 Vali Acc: 0.200 Test Loss: 1.469 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.7307415008544922
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.546 Vali Acc: 0.267 Test Loss: 1.546 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266651).  Saving model ...
Epoch: 15 cost time: 0.7218539714813232
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.626 Vali Acc: 0.267 Test Loss: 1.626 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.729201078414917
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.707 Vali Acc: 0.267 Test Loss: 1.707 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.609137773513794
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.788 Vali Acc: 0.333 Test Loss: 1.788 Test Acc: 0.333
Validation loss decreased (-0.266651 --> -0.333315).  Saving model ...
Epoch: 18 cost time: 0.6144130229949951
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.867 Vali Acc: 0.333 Test Loss: 1.867 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.607872724533081
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.944 Vali Acc: 0.333 Test Loss: 1.944 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6577243804931641
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.019 Vali Acc: 0.333 Test Loss: 2.019 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.548314094543457
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.090 Vali Acc: 0.333 Test Loss: 2.090 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6714539527893066
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.158 Vali Acc: 0.333 Test Loss: 2.158 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6290607452392578
Epoch: 23, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.223 Vali Acc: 0.333 Test Loss: 2.223 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7204923629760742
Epoch: 24, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.285 Vali Acc: 0.333 Test Loss: 2.285 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5689549446105957
Epoch: 25, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.343 Vali Acc: 0.333 Test Loss: 2.343 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6149418354034424
Epoch: 26, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.397 Vali Acc: 0.400 Test Loss: 2.397 Test Acc: 0.400
Validation loss decreased (-0.333315 --> -0.399976).  Saving model ...
Epoch: 27 cost time: 0.6473560333251953
Epoch: 27, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.449 Vali Acc: 0.400 Test Loss: 2.449 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6125013828277588
Epoch: 28, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.497 Vali Acc: 0.400 Test Loss: 2.497 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5593430995941162
Epoch: 29, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.543 Vali Acc: 0.400 Test Loss: 2.543 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6262729167938232
Epoch: 30, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.585 Vali Acc: 0.400 Test Loss: 2.585 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6110186576843262
Epoch: 31, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.625 Vali Acc: 0.400 Test Loss: 2.625 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5438835620880127
Epoch: 32, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.662 Vali Acc: 0.400 Test Loss: 2.662 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6375079154968262
Epoch: 33, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.697 Vali Acc: 0.400 Test Loss: 2.697 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5774283409118652
Epoch: 34, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.729 Vali Acc: 0.400 Test Loss: 2.729 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6187388896942139
Epoch: 35, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.759 Vali Acc: 0.400 Test Loss: 2.759 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7037193775177002
Epoch: 36, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.787 Vali Acc: 0.400 Test Loss: 2.787 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6360639
model size : 24.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.760829210281372
Epoch: 1, Steps: 1 | Train Loss: 1.104 Vali Loss: 1.133 Vali Acc: 0.267 Test Loss: 1.133 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.7919213771820068
Epoch: 2, Steps: 1 | Train Loss: 1.043 Vali Loss: 1.130 Vali Acc: 0.267 Test Loss: 1.130 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.6636521816253662
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5496673583984375
Epoch: 4, Steps: 1 | Train Loss: 0.930 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.562528133392334
Epoch: 5, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.120 Vali Acc: 0.267 Test Loss: 1.120 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5045666694641113
Epoch: 6, Steps: 1 | Train Loss: 0.829 Vali Loss: 1.117 Vali Acc: 0.333 Test Loss: 1.117 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5319173336029053
Epoch: 7, Steps: 1 | Train Loss: 0.604 Vali Loss: 1.118 Vali Acc: 0.333 Test Loss: 1.118 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6272985935211182
Epoch: 8, Steps: 1 | Train Loss: 0.423 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 9 cost time: 0.6140172481536865
Epoch: 9, Steps: 1 | Train Loss: 0.298 Vali Loss: 1.151 Vali Acc: 0.400 Test Loss: 1.151 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7696757316589355
Epoch: 10, Steps: 1 | Train Loss: 0.206 Vali Loss: 1.187 Vali Acc: 0.333 Test Loss: 1.187 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5694093704223633
Epoch: 11, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.237 Vali Acc: 0.267 Test Loss: 1.237 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.571427583694458
Epoch: 12, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.298 Vali Acc: 0.267 Test Loss: 1.298 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5917665958404541
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.367 Vali Acc: 0.267 Test Loss: 1.367 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5305752754211426
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.442 Vali Acc: 0.267 Test Loss: 1.442 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4664127826690674
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.521 Vali Acc: 0.267 Test Loss: 1.521 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5718002319335938
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.600 Vali Acc: 0.267 Test Loss: 1.600 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5916686058044434
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.680 Vali Acc: 0.267 Test Loss: 1.680 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5279541015625
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.758 Vali Acc: 0.267 Test Loss: 1.758 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6340273
model size : 24.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8014354705810547
Epoch: 1, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.182 Vali Acc: 0.133 Test Loss: 1.182 Test Acc: 0.133
Validation loss decreased (inf --> -0.133322).  Saving model ...
Epoch: 2 cost time: 0.4517638683319092
Epoch: 2, Steps: 1 | Train Loss: 1.060 Vali Loss: 1.180 Vali Acc: 0.200 Test Loss: 1.180 Test Acc: 0.200
Validation loss decreased (-0.133322 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.46361279487609863
Epoch: 3, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.178 Vali Acc: 0.200 Test Loss: 1.178 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.6972167491912842
Epoch: 4, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.177 Vali Acc: 0.200 Test Loss: 1.177 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.4702119827270508
Epoch: 5, Steps: 1 | Train Loss: 0.897 Vali Loss: 1.175 Vali Acc: 0.200 Test Loss: 1.175 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 6 cost time: 0.5322716236114502
Epoch: 6, Steps: 1 | Train Loss: 0.850 Vali Loss: 1.177 Vali Acc: 0.267 Test Loss: 1.177 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5994446277618408
Epoch: 7, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.186 Vali Acc: 0.267 Test Loss: 1.186 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.49311065673828125
Epoch: 8, Steps: 1 | Train Loss: 0.459 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5520071983337402
Epoch: 9, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.243 Vali Acc: 0.467 Test Loss: 1.243 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466654).  Saving model ...
Epoch: 10 cost time: 0.5892565250396729
Epoch: 10, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.298 Vali Acc: 0.467 Test Loss: 1.298 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.56638503074646
Epoch: 11, Steps: 1 | Train Loss: 0.149 Vali Loss: 1.367 Vali Acc: 0.467 Test Loss: 1.367 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5370714664459229
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.448 Vali Acc: 0.467 Test Loss: 1.448 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.4766225814819336
Epoch: 13, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.537 Vali Acc: 0.467 Test Loss: 1.537 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.48371171951293945
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.629 Vali Acc: 0.467 Test Loss: 1.629 Test Acc: 0.467
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6302595138549805
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.722 Vali Acc: 0.467 Test Loss: 1.722 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.6758537292480469
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.814 Vali Acc: 0.467 Test Loss: 1.814 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5486347675323486
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.905 Vali Acc: 0.467 Test Loss: 1.905 Test Acc: 0.467
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.5365374088287354
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.994 Vali Acc: 0.467 Test Loss: 1.994 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.657987117767334
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.079 Vali Acc: 0.467 Test Loss: 2.079 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm128_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6390039
model size : 24.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7350356578826904
Epoch: 1, Steps: 1 | Train Loss: 1.281 Vali Loss: 1.232 Vali Acc: 0.333 Test Loss: 1.232 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.45022130012512207
Epoch: 2, Steps: 1 | Train Loss: 1.211 Vali Loss: 1.225 Vali Acc: 0.400 Test Loss: 1.225 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5868368148803711
Epoch: 3, Steps: 1 | Train Loss: 1.145 Vali Loss: 1.217 Vali Acc: 0.400 Test Loss: 1.217 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5717594623565674
Epoch: 4, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.210 Vali Acc: 0.400 Test Loss: 1.210 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.593252420425415
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.204 Vali Acc: 0.400 Test Loss: 1.204 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 6 cost time: 0.4685225486755371
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.44610166549682617
Epoch: 7, Steps: 1 | Train Loss: 0.712 Vali Loss: 1.193 Vali Acc: 0.333 Test Loss: 1.193 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.45375895500183105
Epoch: 8, Steps: 1 | Train Loss: 0.505 Vali Loss: 1.199 Vali Acc: 0.467 Test Loss: 1.199 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 9 cost time: 0.4327864646911621
Epoch: 9, Steps: 1 | Train Loss: 0.361 Vali Loss: 1.219 Vali Acc: 0.467 Test Loss: 1.219 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7846295833587646
Epoch: 10, Steps: 1 | Train Loss: 0.255 Vali Loss: 1.256 Vali Acc: 0.267 Test Loss: 1.256 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8769245147705078
Epoch: 11, Steps: 1 | Train Loss: 0.171 Vali Loss: 1.311 Vali Acc: 0.333 Test Loss: 1.311 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6103236675262451
Epoch: 12, Steps: 1 | Train Loss: 0.106 Vali Loss: 1.380 Vali Acc: 0.267 Test Loss: 1.380 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6123907566070557
Epoch: 13, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.460 Vali Acc: 0.267 Test Loss: 1.460 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5224642753601074
Epoch: 14, Steps: 1 | Train Loss: 0.034 Vali Loss: 1.548 Vali Acc: 0.333 Test Loss: 1.548 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4534468650817871
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.639 Vali Acc: 0.333 Test Loss: 1.639 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5760531425476074
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.732 Vali Acc: 0.333 Test Loss: 1.732 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6192333698272705
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.824 Vali Acc: 0.333 Test Loss: 1.824 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6064996719360352
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.915 Vali Acc: 0.333 Test Loss: 1.915 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6346689
model size : 24.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs834_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9362378120422363
Epoch: 1, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4949607849121094
Epoch: 2, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5325102806091309
Epoch: 3, Steps: 1 | Train Loss: 1.063 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 4 cost time: 0.5938422679901123
Epoch: 4, Steps: 1 | Train Loss: 1.004 Vali Loss: 1.156 Vali Acc: 0.467 Test Loss: 1.156 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5985045433044434
Epoch: 5, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.5483107566833496
Epoch: 6, Steps: 1 | Train Loss: 0.895 Vali Loss: 1.155 Vali Acc: 0.467 Test Loss: 1.155 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5241553783416748
Epoch: 7, Steps: 1 | Train Loss: 0.653 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5203619003295898
Epoch: 8, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.178 Vali Acc: 0.400 Test Loss: 1.178 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5278987884521484
Epoch: 9, Steps: 1 | Train Loss: 0.325 Vali Loss: 1.209 Vali Acc: 0.400 Test Loss: 1.209 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5926291942596436
Epoch: 10, Steps: 1 | Train Loss: 0.226 Vali Loss: 1.255 Vali Acc: 0.333 Test Loss: 1.255 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5579707622528076
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.315 Vali Acc: 0.333 Test Loss: 1.315 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6216366291046143
Epoch: 12, Steps: 1 | Train Loss: 0.090 Vali Loss: 1.387 Vali Acc: 0.400 Test Loss: 1.387 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5734431743621826
Epoch: 13, Steps: 1 | Train Loss: 0.052 Vali Loss: 1.468 Vali Acc: 0.400 Test Loss: 1.468 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.721076250076294
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.553 Vali Acc: 0.400 Test Loss: 1.553 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.6544713973999023
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.642 Vali Acc: 0.267 Test Loss: 1.642 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs834_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6338391
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs625_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7232861518859863
Epoch: 1, Steps: 1 | Train Loss: 1.093 Vali Loss: 1.145 Vali Acc: 0.267 Test Loss: 1.145 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.5296003818511963
Epoch: 2, Steps: 1 | Train Loss: 1.035 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (-0.266655 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.48249125480651855
Epoch: 3, Steps: 1 | Train Loss: 0.980 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5310280323028564
Epoch: 4, Steps: 1 | Train Loss: 0.929 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.5148270130157471
Epoch: 5, Steps: 1 | Train Loss: 0.880 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5053672790527344
Epoch: 6, Steps: 1 | Train Loss: 0.835 Vali Loss: 1.124 Vali Acc: 0.467 Test Loss: 1.124 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5873944759368896
Epoch: 7, Steps: 1 | Train Loss: 0.628 Vali Loss: 1.126 Vali Acc: 0.267 Test Loss: 1.126 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.46608710289001465
Epoch: 8, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.140 Vali Acc: 0.267 Test Loss: 1.140 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5858509540557861
Epoch: 9, Steps: 1 | Train Loss: 0.329 Vali Loss: 1.168 Vali Acc: 0.267 Test Loss: 1.168 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5502200126647949
Epoch: 10, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.44557881355285645
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.271 Vali Acc: 0.400 Test Loss: 1.271 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.43277812004089355
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5922372341156006
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.418 Vali Acc: 0.333 Test Loss: 1.418 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.49303460121154785
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.502 Vali Acc: 0.333 Test Loss: 1.502 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5808722972869873
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.588 Vali Acc: 0.267 Test Loss: 1.588 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5023331642150879
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.676 Vali Acc: 0.267 Test Loss: 1.676 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs625_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6326721
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6882851123809814
Epoch: 1, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6158392429351807
Epoch: 2, Steps: 1 | Train Loss: 0.957 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.6775534152984619
Epoch: 3, Steps: 1 | Train Loss: 0.904 Vali Loss: 1.113 Vali Acc: 0.467 Test Loss: 1.113 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5506479740142822
Epoch: 4, Steps: 1 | Train Loss: 0.854 Vali Loss: 1.112 Vali Acc: 0.467 Test Loss: 1.112 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.47267961502075195
Epoch: 5, Steps: 1 | Train Loss: 0.807 Vali Loss: 1.111 Vali Acc: 0.467 Test Loss: 1.111 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5997099876403809
Epoch: 6, Steps: 1 | Train Loss: 0.763 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49902915954589844
Epoch: 7, Steps: 1 | Train Loss: 0.564 Vali Loss: 1.131 Vali Acc: 0.467 Test Loss: 1.131 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.39770007133483887
Epoch: 8, Steps: 1 | Train Loss: 0.403 Vali Loss: 1.154 Vali Acc: 0.467 Test Loss: 1.154 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5780324935913086
Epoch: 9, Steps: 1 | Train Loss: 0.285 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.47345399856567383
Epoch: 10, Steps: 1 | Train Loss: 0.195 Vali Loss: 1.240 Vali Acc: 0.400 Test Loss: 1.240 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5836343765258789
Epoch: 11, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.304 Vali Acc: 0.400 Test Loss: 1.304 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5788376331329346
Epoch: 12, Steps: 1 | Train Loss: 0.075 Vali Loss: 1.378 Vali Acc: 0.467 Test Loss: 1.378 Test Acc: 0.467
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.6792616844177246
Epoch: 13, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.460 Vali Acc: 0.400 Test Loss: 1.460 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5370481014251709
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.697228193283081
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.635 Vali Acc: 0.400 Test Loss: 1.635 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6322743
model size : 24.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.925499439239502
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (inf --> -0.266655).  Saving model ...
Epoch: 2 cost time: 0.547736406326294
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.159 Vali Acc: 0.267 Test Loss: 1.159 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5708184242248535
Epoch: 3, Steps: 1 | Train Loss: 1.028 Vali Loss: 1.153 Vali Acc: 0.333 Test Loss: 1.153 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.47371530532836914
Epoch: 4, Steps: 1 | Train Loss: 0.973 Vali Loss: 1.148 Vali Acc: 0.333 Test Loss: 1.148 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5479719638824463
Epoch: 5, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.144 Vali Acc: 0.400 Test Loss: 1.144 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5528793334960938
Epoch: 6, Steps: 1 | Train Loss: 0.872 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.543297290802002
Epoch: 7, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.131 Vali Acc: 0.200 Test Loss: 1.131 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.602607011795044
Epoch: 8, Steps: 1 | Train Loss: 0.457 Vali Loss: 1.133 Vali Acc: 0.200 Test Loss: 1.133 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.4616508483886719
Epoch: 9, Steps: 1 | Train Loss: 0.320 Vali Loss: 1.147 Vali Acc: 0.200 Test Loss: 1.147 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5028488636016846
Epoch: 10, Steps: 1 | Train Loss: 0.219 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5068697929382324
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.217 Vali Acc: 0.267 Test Loss: 1.217 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.4521329402923584
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.273 Vali Acc: 0.267 Test Loss: 1.273 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5193018913269043
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.338 Vali Acc: 0.267 Test Loss: 1.338 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5728745460510254
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.412 Vali Acc: 0.267 Test Loss: 1.412 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.5233585834503174
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.490 Vali Acc: 0.267 Test Loss: 1.490 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6325113
model size : 24.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.911914587020874
Epoch: 1, Steps: 1 | Train Loss: 1.081 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.5773816108703613
Epoch: 2, Steps: 1 | Train Loss: 1.022 Vali Loss: 1.105 Vali Acc: 0.467 Test Loss: 1.105 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.715369462966919
Epoch: 3, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.103 Vali Acc: 0.467 Test Loss: 1.103 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.5325911045074463
Epoch: 4, Steps: 1 | Train Loss: 0.915 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.5862424373626709
Epoch: 5, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.099 Vali Acc: 0.467 Test Loss: 1.099 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.48758649826049805
Epoch: 6, Steps: 1 | Train Loss: 0.821 Vali Loss: 1.101 Vali Acc: 0.467 Test Loss: 1.101 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.48200201988220215
Epoch: 7, Steps: 1 | Train Loss: 0.611 Vali Loss: 1.108 Vali Acc: 0.467 Test Loss: 1.108 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5112705230712891
Epoch: 8, Steps: 1 | Train Loss: 0.439 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5585005283355713
Epoch: 9, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.153 Vali Acc: 0.400 Test Loss: 1.153 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.49918556213378906
Epoch: 10, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.196 Vali Acc: 0.400 Test Loss: 1.196 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5459630489349365
Epoch: 11, Steps: 1 | Train Loss: 0.136 Vali Loss: 1.255 Vali Acc: 0.467 Test Loss: 1.255 Test Acc: 0.467
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6621148586273193
Epoch: 12, Steps: 1 | Train Loss: 0.081 Vali Loss: 1.327 Vali Acc: 0.333 Test Loss: 1.327 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.44202494621276855
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.410 Vali Acc: 0.333 Test Loss: 1.410 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5005242824554443
Epoch: 14, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.499 Vali Acc: 0.333 Test Loss: 1.499 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4797849655151367
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.593 Vali Acc: 0.333 Test Loss: 1.593 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6333255
model size : 24.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8878660202026367
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.123 Vali Acc: 0.400 Test Loss: 1.123 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.6235082149505615
Epoch: 2, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5501444339752197
Epoch: 3, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.115 Vali Acc: 0.333 Test Loss: 1.115 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5003974437713623
Epoch: 4, Steps: 1 | Train Loss: 0.913 Vali Loss: 1.112 Vali Acc: 0.333 Test Loss: 1.112 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5536177158355713
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7100157737731934
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.109 Vali Acc: 0.267 Test Loss: 1.109 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.7525668144226074
Epoch: 7, Steps: 1 | Train Loss: 0.608 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5568258762359619
Epoch: 8, Steps: 1 | Train Loss: 0.437 Vali Loss: 1.132 Vali Acc: 0.333 Test Loss: 1.132 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.5867021083831787
Epoch: 9, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5324795246124268
Epoch: 10, Steps: 1 | Train Loss: 0.215 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.54996657371521
Epoch: 11, Steps: 1 | Train Loss: 0.140 Vali Loss: 1.272 Vali Acc: 0.200 Test Loss: 1.272 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.6466429233551025
Epoch: 12, Steps: 1 | Train Loss: 0.086 Vali Loss: 1.344 Vali Acc: 0.333 Test Loss: 1.344 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6326849
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9907705783843994
Epoch: 1, Steps: 1 | Train Loss: 1.345 Vali Loss: 1.142 Vali Acc: 0.200 Test Loss: 1.142 Test Acc: 0.200
Validation loss decreased (inf --> -0.199989).  Saving model ...
Epoch: 2 cost time: 0.515117883682251
Epoch: 2, Steps: 1 | Train Loss: 1.275 Vali Loss: 1.137 Vali Acc: 0.267 Test Loss: 1.137 Test Acc: 0.267
Validation loss decreased (-0.199989 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5662808418273926
Epoch: 3, Steps: 1 | Train Loss: 1.208 Vali Loss: 1.132 Vali Acc: 0.267 Test Loss: 1.132 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5380308628082275
Epoch: 4, Steps: 1 | Train Loss: 1.143 Vali Loss: 1.128 Vali Acc: 0.267 Test Loss: 1.128 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.6188468933105469
Epoch: 5, Steps: 1 | Train Loss: 1.082 Vali Loss: 1.123 Vali Acc: 0.267 Test Loss: 1.123 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5788052082061768
Epoch: 6, Steps: 1 | Train Loss: 1.024 Vali Loss: 1.114 Vali Acc: 0.267 Test Loss: 1.114 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266656).  Saving model ...
Epoch: 7 cost time: 0.4767484664916992
Epoch: 7, Steps: 1 | Train Loss: 0.758 Vali Loss: 1.107 Vali Acc: 0.267 Test Loss: 1.107 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 8 cost time: 0.5661125183105469
Epoch: 8, Steps: 1 | Train Loss: 0.539 Vali Loss: 1.106 Vali Acc: 0.333 Test Loss: 1.106 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5214207172393799
Epoch: 9, Steps: 1 | Train Loss: 0.384 Vali Loss: 1.114 Vali Acc: 0.333 Test Loss: 1.114 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.534947395324707
Epoch: 10, Steps: 1 | Train Loss: 0.270 Vali Loss: 1.135 Vali Acc: 0.333 Test Loss: 1.135 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5303835868835449
Epoch: 11, Steps: 1 | Train Loss: 0.181 Vali Loss: 1.171 Vali Acc: 0.333 Test Loss: 1.171 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6016740798950195
Epoch: 12, Steps: 1 | Train Loss: 0.113 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5575845241546631
Epoch: 13, Steps: 1 | Train Loss: 0.066 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.640533447265625
Epoch: 14, Steps: 1 | Train Loss: 0.037 Vali Loss: 1.353 Vali Acc: 0.333 Test Loss: 1.353 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6003003120422363
Epoch: 15, Steps: 1 | Train Loss: 0.020 Vali Loss: 1.430 Vali Acc: 0.333 Test Loss: 1.430 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5743122100830078
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.511 Vali Acc: 0.333 Test Loss: 1.511 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5714349746704102
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.592 Vali Acc: 0.333 Test Loss: 1.592 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.630948543548584
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.674 Vali Acc: 0.333 Test Loss: 1.674 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6320767
model size : 24.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.835747241973877
Epoch: 1, Steps: 1 | Train Loss: 1.219 Vali Loss: 1.024 Vali Acc: 0.467 Test Loss: 1.024 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.6147005558013916
Epoch: 2, Steps: 1 | Train Loss: 1.154 Vali Loss: 1.019 Vali Acc: 0.467 Test Loss: 1.019 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.5254242420196533
Epoch: 3, Steps: 1 | Train Loss: 1.092 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.5298171043395996
Epoch: 4, Steps: 1 | Train Loss: 1.033 Vali Loss: 1.012 Vali Acc: 0.467 Test Loss: 1.012 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 0.5301258563995361
Epoch: 5, Steps: 1 | Train Loss: 0.978 Vali Loss: 1.009 Vali Acc: 0.467 Test Loss: 1.009 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.5840222835540771
Epoch: 6, Steps: 1 | Train Loss: 0.926 Vali Loss: 1.010 Vali Acc: 0.467 Test Loss: 1.010 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5371625423431396
Epoch: 7, Steps: 1 | Train Loss: 0.686 Vali Loss: 1.017 Vali Acc: 0.400 Test Loss: 1.017 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5734851360321045
Epoch: 8, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.034 Vali Acc: 0.333 Test Loss: 1.034 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.5870609283447266
Epoch: 9, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.063 Vali Acc: 0.333 Test Loss: 1.063 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5001184940338135
Epoch: 10, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.663933515548706
Epoch: 11, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.170 Vali Acc: 0.333 Test Loss: 1.170 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.5284781455993652
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5011508464813232
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.334 Vali Acc: 0.267 Test Loss: 1.334 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.6724433898925781
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.430 Vali Acc: 0.267 Test Loss: 1.430 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.4650099277496338
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.531 Vali Acc: 0.267 Test Loss: 1.531 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6314913
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6561410427093506
Epoch: 1, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.222 Vali Acc: 0.200 Test Loss: 1.222 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.4780690670013428
Epoch: 2, Steps: 1 | Train Loss: 1.113 Vali Loss: 1.218 Vali Acc: 0.267 Test Loss: 1.218 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266654).  Saving model ...
Epoch: 3 cost time: 0.48685121536254883
Epoch: 3, Steps: 1 | Train Loss: 1.049 Vali Loss: 1.214 Vali Acc: 0.267 Test Loss: 1.214 Test Acc: 0.267
Validation loss decreased (-0.266654 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.505906343460083
Epoch: 4, Steps: 1 | Train Loss: 0.988 Vali Loss: 1.211 Vali Acc: 0.267 Test Loss: 1.211 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5141870975494385
Epoch: 5, Steps: 1 | Train Loss: 0.931 Vali Loss: 1.208 Vali Acc: 0.267 Test Loss: 1.208 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.7900176048278809
Epoch: 6, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5659394264221191
Epoch: 7, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.209 Vali Acc: 0.267 Test Loss: 1.209 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6405949592590332
Epoch: 8, Steps: 1 | Train Loss: 0.452 Vali Loss: 1.221 Vali Acc: 0.267 Test Loss: 1.221 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6031858921051025
Epoch: 9, Steps: 1 | Train Loss: 0.321 Vali Loss: 1.246 Vali Acc: 0.333 Test Loss: 1.246 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 10 cost time: 0.5675232410430908
Epoch: 10, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.288 Vali Acc: 0.333 Test Loss: 1.288 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.48027586936950684
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.345 Vali Acc: 0.333 Test Loss: 1.345 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5825314521789551
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.416 Vali Acc: 0.400 Test Loss: 1.416 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399986).  Saving model ...
Epoch: 13 cost time: 0.5243988037109375
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.496 Vali Acc: 0.400 Test Loss: 1.496 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5740139484405518
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.580 Vali Acc: 0.333 Test Loss: 1.580 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5765314102172852
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.668 Vali Acc: 0.333 Test Loss: 1.668 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.544581413269043
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.755 Vali Acc: 0.333 Test Loss: 1.755 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5685374736785889
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.841 Vali Acc: 0.333 Test Loss: 1.841 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5952236652374268
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.925 Vali Acc: 0.333 Test Loss: 1.925 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5414736270904541
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 2.007 Vali Acc: 0.333 Test Loss: 2.007 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.5228536128997803
Epoch: 20, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.085 Vali Acc: 0.333 Test Loss: 2.085 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.4835660457611084
Epoch: 21, Steps: 1 | Train Loss: 0.001 Vali Loss: 2.160 Vali Acc: 0.333 Test Loss: 2.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.4495382308959961
Epoch: 22, Steps: 1 | Train Loss: 0.000 Vali Loss: 2.231 Vali Acc: 0.333 Test Loss: 2.231 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6334255
model size : 24.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9301528930664062
Epoch: 1, Steps: 1 | Train Loss: 1.051 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.4850289821624756
Epoch: 2, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.076 Vali Acc: 0.333 Test Loss: 1.076 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.5063626766204834
Epoch: 3, Steps: 1 | Train Loss: 0.941 Vali Loss: 1.072 Vali Acc: 0.333 Test Loss: 1.072 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.46337389945983887
Epoch: 4, Steps: 1 | Train Loss: 0.890 Vali Loss: 1.068 Vali Acc: 0.333 Test Loss: 1.068 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.530404806137085
Epoch: 5, Steps: 1 | Train Loss: 0.843 Vali Loss: 1.065 Vali Acc: 0.333 Test Loss: 1.065 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.5009815692901611
Epoch: 6, Steps: 1 | Train Loss: 0.799 Vali Loss: 1.065 Vali Acc: 0.467 Test Loss: 1.065 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5293076038360596
Epoch: 7, Steps: 1 | Train Loss: 0.595 Vali Loss: 1.070 Vali Acc: 0.533 Test Loss: 1.070 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5741360187530518
Epoch: 8, Steps: 1 | Train Loss: 0.425 Vali Loss: 1.086 Vali Acc: 0.533 Test Loss: 1.086 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6608057022094727
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5789709091186523
Epoch: 10, Steps: 1 | Train Loss: 0.205 Vali Loss: 1.158 Vali Acc: 0.400 Test Loss: 1.158 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6120538711547852
Epoch: 11, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5696773529052734
Epoch: 12, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.282 Vali Acc: 0.400 Test Loss: 1.282 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5323073863983154
Epoch: 13, Steps: 1 | Train Loss: 0.046 Vali Loss: 1.358 Vali Acc: 0.333 Test Loss: 1.358 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5947728157043457
Epoch: 14, Steps: 1 | Train Loss: 0.025 Vali Loss: 1.440 Vali Acc: 0.333 Test Loss: 1.440 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5767993927001953
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.526 Vali Acc: 0.333 Test Loss: 1.526 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5678155422210693
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.614 Vali Acc: 0.333 Test Loss: 1.614 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.6370868682861328
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.702 Vali Acc: 0.333 Test Loss: 1.702 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6333697
model size : 24.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6815433502197266
Epoch: 1, Steps: 1 | Train Loss: 1.083 Vali Loss: 1.219 Vali Acc: 0.200 Test Loss: 1.219 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.39794445037841797
Epoch: 2, Steps: 1 | Train Loss: 1.023 Vali Loss: 1.212 Vali Acc: 0.200 Test Loss: 1.212 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5593910217285156
Epoch: 3, Steps: 1 | Train Loss: 0.967 Vali Loss: 1.206 Vali Acc: 0.267 Test Loss: 1.206 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 4 cost time: 0.5127575397491455
Epoch: 4, Steps: 1 | Train Loss: 0.914 Vali Loss: 1.201 Vali Acc: 0.267 Test Loss: 1.201 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.540153980255127
Epoch: 5, Steps: 1 | Train Loss: 0.864 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.48792219161987305
Epoch: 6, Steps: 1 | Train Loss: 0.817 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.5717465877532959
Epoch: 7, Steps: 1 | Train Loss: 0.607 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 8 cost time: 0.48546814918518066
Epoch: 8, Steps: 1 | Train Loss: 0.432 Vali Loss: 1.194 Vali Acc: 0.400 Test Loss: 1.194 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 9 cost time: 0.5269596576690674
Epoch: 9, Steps: 1 | Train Loss: 0.304 Vali Loss: 1.218 Vali Acc: 0.400 Test Loss: 1.218 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.47976136207580566
Epoch: 10, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.260 Vali Acc: 0.333 Test Loss: 1.260 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5127847194671631
Epoch: 11, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.318 Vali Acc: 0.267 Test Loss: 1.318 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5706846714019775
Epoch: 12, Steps: 1 | Train Loss: 0.082 Vali Loss: 1.387 Vali Acc: 0.267 Test Loss: 1.387 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5464422702789307
Epoch: 13, Steps: 1 | Train Loss: 0.047 Vali Loss: 1.464 Vali Acc: 0.267 Test Loss: 1.464 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5816512107849121
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.547 Vali Acc: 0.267 Test Loss: 1.547 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6158204078674316
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.631 Vali Acc: 0.267 Test Loss: 1.631 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5063169002532959
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.716 Vali Acc: 0.267 Test Loss: 1.716 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.4893686771392822
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.800 Vali Acc: 0.267 Test Loss: 1.800 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5139260292053223
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.882 Vali Acc: 0.333 Test Loss: 1.882 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6335739
model size : 24.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.101087808609009
Epoch: 1, Steps: 1 | Train Loss: 1.125 Vali Loss: 1.188 Vali Acc: 0.333 Test Loss: 1.188 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.6347298622131348
Epoch: 2, Steps: 1 | Train Loss: 1.065 Vali Loss: 1.184 Vali Acc: 0.333 Test Loss: 1.184 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5893771648406982
Epoch: 3, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.181 Vali Acc: 0.333 Test Loss: 1.181 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5864455699920654
Epoch: 4, Steps: 1 | Train Loss: 0.953 Vali Loss: 1.177 Vali Acc: 0.333 Test Loss: 1.177 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.6512222290039062
Epoch: 5, Steps: 1 | Train Loss: 0.902 Vali Loss: 1.174 Vali Acc: 0.333 Test Loss: 1.174 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.5076718330383301
Epoch: 6, Steps: 1 | Train Loss: 0.853 Vali Loss: 1.169 Vali Acc: 0.467 Test Loss: 1.169 Test Acc: 0.467
Validation loss decreased (-0.333322 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.6764414310455322
Epoch: 7, Steps: 1 | Train Loss: 0.630 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.652296781539917
Epoch: 8, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7187376022338867
Epoch: 9, Steps: 1 | Train Loss: 0.311 Vali Loss: 1.196 Vali Acc: 0.333 Test Loss: 1.196 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5715529918670654
Epoch: 10, Steps: 1 | Train Loss: 0.213 Vali Loss: 1.230 Vali Acc: 0.333 Test Loss: 1.230 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6966290473937988
Epoch: 11, Steps: 1 | Train Loss: 0.138 Vali Loss: 1.279 Vali Acc: 0.333 Test Loss: 1.279 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5056946277618408
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.340 Vali Acc: 0.400 Test Loss: 1.340 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7009673118591309
Epoch: 13, Steps: 1 | Train Loss: 0.050 Vali Loss: 1.411 Vali Acc: 0.400 Test Loss: 1.411 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5824933052062988
Epoch: 14, Steps: 1 | Train Loss: 0.029 Vali Loss: 1.488 Vali Acc: 0.400 Test Loss: 1.488 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7451691627502441
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.568 Vali Acc: 0.400 Test Loss: 1.568 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0061118602752686
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.650 Vali Acc: 0.400 Test Loss: 1.650 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6327849
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.802544355392456
Epoch: 1, Steps: 1 | Train Loss: 1.251 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.509066104888916
Epoch: 2, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.074 Vali Acc: 0.400 Test Loss: 1.074 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4912405014038086
Epoch: 3, Steps: 1 | Train Loss: 1.121 Vali Loss: 1.069 Vali Acc: 0.400 Test Loss: 1.069 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5043933391571045
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.064 Vali Acc: 0.467 Test Loss: 1.064 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 5 cost time: 0.6951842308044434
Epoch: 5, Steps: 1 | Train Loss: 1.003 Vali Loss: 1.059 Vali Acc: 0.467 Test Loss: 1.059 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.5289678573608398
Epoch: 6, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.050 Vali Acc: 0.467 Test Loss: 1.050 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.751788854598999
Epoch: 7, Steps: 1 | Train Loss: 0.696 Vali Loss: 1.043 Vali Acc: 0.533 Test Loss: 1.043 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.5771892070770264
Epoch: 8, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.041 Vali Acc: 0.667 Test Loss: 1.041 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.5125281810760498
Epoch: 9, Steps: 1 | Train Loss: 0.345 Vali Loss: 1.048 Vali Acc: 0.600 Test Loss: 1.048 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5065784454345703
Epoch: 10, Steps: 1 | Train Loss: 0.242 Vali Loss: 1.069 Vali Acc: 0.467 Test Loss: 1.069 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5893955230712891
Epoch: 11, Steps: 1 | Train Loss: 0.161 Vali Loss: 1.103 Vali Acc: 0.400 Test Loss: 1.103 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.6461896896362305
Epoch: 12, Steps: 1 | Train Loss: 0.100 Vali Loss: 1.152 Vali Acc: 0.333 Test Loss: 1.152 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.682673454284668
Epoch: 13, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.212 Vali Acc: 0.333 Test Loss: 1.212 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6316835880279541
Epoch: 14, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.282 Vali Acc: 0.333 Test Loss: 1.282 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6021265983581543
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.357 Vali Acc: 0.333 Test Loss: 1.357 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5866498947143555
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.436 Vali Acc: 0.333 Test Loss: 1.436 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5945723056793213
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.515 Vali Acc: 0.333 Test Loss: 1.515 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6352603435516357
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.594 Vali Acc: 0.333 Test Loss: 1.594 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 6325027
model size : 24.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 2.104417085647583
Epoch: 1, Steps: 1 | Train Loss: 1.128 Vali Loss: 1.211 Vali Acc: 0.200 Test Loss: 1.211 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.6148560047149658
Epoch: 2, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.206 Vali Acc: 0.200 Test Loss: 1.206 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5593500137329102
Epoch: 3, Steps: 1 | Train Loss: 1.008 Vali Loss: 1.201 Vali Acc: 0.200 Test Loss: 1.201 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.4870486259460449
Epoch: 4, Steps: 1 | Train Loss: 0.952 Vali Loss: 1.196 Vali Acc: 0.267 Test Loss: 1.196 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.5499701499938965
Epoch: 5, Steps: 1 | Train Loss: 0.900 Vali Loss: 1.192 Vali Acc: 0.267 Test Loss: 1.192 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.47899699211120605
Epoch: 6, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.182 Vali Acc: 0.267 Test Loss: 1.182 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 7 cost time: 0.5002744197845459
Epoch: 7, Steps: 1 | Train Loss: 0.635 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 8 cost time: 0.7366762161254883
Epoch: 8, Steps: 1 | Train Loss: 0.456 Vali Loss: 1.175 Vali Acc: 0.333 Test Loss: 1.175 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 9 cost time: 0.5214493274688721
Epoch: 9, Steps: 1 | Train Loss: 0.324 Vali Loss: 1.185 Vali Acc: 0.333 Test Loss: 1.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6041765213012695
Epoch: 10, Steps: 1 | Train Loss: 0.221 Vali Loss: 1.210 Vali Acc: 0.333 Test Loss: 1.210 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5205950736999512
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.251 Vali Acc: 0.267 Test Loss: 1.251 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5364017486572266
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.306 Vali Acc: 0.333 Test Loss: 1.306 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5143535137176514
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.375 Vali Acc: 0.333 Test Loss: 1.375 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.44948768615722656
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.452 Vali Acc: 0.333 Test Loss: 1.452 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.549614667892456
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.535 Vali Acc: 0.333 Test Loss: 1.535 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5272483825683594
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.621 Vali Acc: 0.333 Test Loss: 1.621 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6279220581054688
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6971001625061035
Epoch: 18, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.794 Vali Acc: 0.333 Test Loss: 1.794 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6342273
model size : 24.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.809086561203003
Epoch: 1, Steps: 1 | Train Loss: 1.068 Vali Loss: 1.081 Vali Acc: 0.400 Test Loss: 1.081 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.7242560386657715
Epoch: 2, Steps: 1 | Train Loss: 1.009 Vali Loss: 1.078 Vali Acc: 0.400 Test Loss: 1.078 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.509544849395752
Epoch: 3, Steps: 1 | Train Loss: 0.954 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5043919086456299
Epoch: 4, Steps: 1 | Train Loss: 0.901 Vali Loss: 1.073 Vali Acc: 0.400 Test Loss: 1.073 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5798830986022949
Epoch: 5, Steps: 1 | Train Loss: 0.852 Vali Loss: 1.070 Vali Acc: 0.400 Test Loss: 1.070 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.6524143218994141
Epoch: 6, Steps: 1 | Train Loss: 0.805 Vali Loss: 1.071 Vali Acc: 0.400 Test Loss: 1.071 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5812342166900635
Epoch: 7, Steps: 1 | Train Loss: 0.593 Vali Loss: 1.077 Vali Acc: 0.400 Test Loss: 1.077 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5391545295715332
Epoch: 8, Steps: 1 | Train Loss: 0.417 Vali Loss: 1.092 Vali Acc: 0.333 Test Loss: 1.092 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7502608299255371
Epoch: 9, Steps: 1 | Train Loss: 0.289 Vali Loss: 1.121 Vali Acc: 0.400 Test Loss: 1.121 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.6585919857025146
Epoch: 10, Steps: 1 | Train Loss: 0.194 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.6093642711639404
Epoch: 11, Steps: 1 | Train Loss: 0.123 Vali Loss: 1.221 Vali Acc: 0.400 Test Loss: 1.221 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6173076629638672
Epoch: 12, Steps: 1 | Train Loss: 0.073 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.5790004730224609
Epoch: 13, Steps: 1 | Train Loss: 0.042 Vali Loss: 1.366 Vali Acc: 0.333 Test Loss: 1.366 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.5944454669952393
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.449 Vali Acc: 0.333 Test Loss: 1.449 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7040157318115234
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.535 Vali Acc: 0.333 Test Loss: 1.535 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6352055
model size : 24.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8353569507598877
Epoch: 1, Steps: 1 | Train Loss: 1.066 Vali Loss: 1.073 Vali Acc: 0.267 Test Loss: 1.073 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5187382698059082
Epoch: 2, Steps: 1 | Train Loss: 1.010 Vali Loss: 1.070 Vali Acc: 0.267 Test Loss: 1.070 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5451462268829346
Epoch: 3, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.067 Vali Acc: 0.267 Test Loss: 1.067 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.5457026958465576
Epoch: 4, Steps: 1 | Train Loss: 0.905 Vali Loss: 1.065 Vali Acc: 0.267 Test Loss: 1.065 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 5 cost time: 0.9804749488830566
Epoch: 5, Steps: 1 | Train Loss: 0.857 Vali Loss: 1.063 Vali Acc: 0.267 Test Loss: 1.063 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 6 cost time: 0.5710055828094482
Epoch: 6, Steps: 1 | Train Loss: 0.812 Vali Loss: 1.061 Vali Acc: 0.333 Test Loss: 1.061 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.6754007339477539
Epoch: 7, Steps: 1 | Train Loss: 0.603 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.5022969245910645
Epoch: 8, Steps: 1 | Train Loss: 0.429 Vali Loss: 1.075 Vali Acc: 0.333 Test Loss: 1.075 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5664317607879639
Epoch: 9, Steps: 1 | Train Loss: 0.300 Vali Loss: 1.097 Vali Acc: 0.267 Test Loss: 1.097 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7492849826812744
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.132 Vali Acc: 0.200 Test Loss: 1.132 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5926432609558105
Epoch: 11, Steps: 1 | Train Loss: 0.128 Vali Loss: 1.181 Vali Acc: 0.200 Test Loss: 1.181 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.688262939453125
Epoch: 12, Steps: 1 | Train Loss: 0.076 Vali Loss: 1.242 Vali Acc: 0.267 Test Loss: 1.242 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5520479679107666
Epoch: 13, Steps: 1 | Train Loss: 0.043 Vali Loss: 1.313 Vali Acc: 0.267 Test Loss: 1.313 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6635165214538574
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.390 Vali Acc: 0.267 Test Loss: 1.390 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6137683391571045
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.471 Vali Acc: 0.333 Test Loss: 1.471 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5653862953186035
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.554 Vali Acc: 0.333 Test Loss: 1.554 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.7105658054351807
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 1.636 Vali Acc: 0.333 Test Loss: 1.636 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6316841
model size : 24.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.876798391342163
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.216 Vali Acc: 0.333 Test Loss: 1.216 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.724717378616333
Epoch: 2, Steps: 1 | Train Loss: 1.207 Vali Loss: 1.211 Vali Acc: 0.333 Test Loss: 1.211 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 3 cost time: 0.5869905948638916
Epoch: 3, Steps: 1 | Train Loss: 1.142 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.537785530090332
Epoch: 4, Steps: 1 | Train Loss: 1.080 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.6844179630279541
Epoch: 5, Steps: 1 | Train Loss: 1.021 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6865501403808594
Epoch: 6, Steps: 1 | Train Loss: 0.965 Vali Loss: 1.192 Vali Acc: 0.467 Test Loss: 1.192 Test Acc: 0.467
Validation loss decreased (-0.333321 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.44986629486083984
Epoch: 7, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.7472236156463623
Epoch: 8, Steps: 1 | Train Loss: 0.486 Vali Loss: 1.198 Vali Acc: 0.467 Test Loss: 1.198 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5581879615783691
Epoch: 9, Steps: 1 | Train Loss: 0.337 Vali Loss: 1.221 Vali Acc: 0.467 Test Loss: 1.221 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7877383232116699
Epoch: 10, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.262 Vali Acc: 0.467 Test Loss: 1.262 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5284862518310547
Epoch: 11, Steps: 1 | Train Loss: 0.159 Vali Loss: 1.318 Vali Acc: 0.400 Test Loss: 1.318 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.510082483291626
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.386 Vali Acc: 0.400 Test Loss: 1.386 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6511473655700684
Epoch: 13, Steps: 1 | Train Loss: 0.061 Vali Loss: 1.463 Vali Acc: 0.333 Test Loss: 1.463 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.40497303009033203
Epoch: 14, Steps: 1 | Train Loss: 0.035 Vali Loss: 1.545 Vali Acc: 0.333 Test Loss: 1.545 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.4548470973968506
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.629 Vali Acc: 0.333 Test Loss: 1.629 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5531706809997559
Epoch: 16, Steps: 1 | Train Loss: 0.011 Vali Loss: 1.714 Vali Acc: 0.267 Test Loss: 1.714 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5293309688568115
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.798 Vali Acc: 0.267 Test Loss: 1.798 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6331695
model size : 24.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7063865661621094
Epoch: 1, Steps: 1 | Train Loss: 1.273 Vali Loss: 1.264 Vali Acc: 0.200 Test Loss: 1.264 Test Acc: 0.200
Validation loss decreased (inf --> -0.199987).  Saving model ...
Epoch: 2 cost time: 0.45997118949890137
Epoch: 2, Steps: 1 | Train Loss: 1.204 Vali Loss: 1.261 Vali Acc: 0.200 Test Loss: 1.261 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 3 cost time: 0.5797674655914307
Epoch: 3, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.259 Vali Acc: 0.200 Test Loss: 1.259 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 4 cost time: 0.48784685134887695
Epoch: 4, Steps: 1 | Train Loss: 1.074 Vali Loss: 1.256 Vali Acc: 0.200 Test Loss: 1.256 Test Acc: 0.200
Validation loss decreased (-0.199987 --> -0.199987).  Saving model ...
Epoch: 5 cost time: 0.49638938903808594
Epoch: 5, Steps: 1 | Train Loss: 1.013 Vali Loss: 1.254 Vali Acc: 0.267 Test Loss: 1.254 Test Acc: 0.267
Validation loss decreased (-0.199987 --> -0.266654).  Saving model ...
Epoch: 6 cost time: 0.5458371639251709
Epoch: 6, Steps: 1 | Train Loss: 0.956 Vali Loss: 1.247 Vali Acc: 0.400 Test Loss: 1.247 Test Acc: 0.400
Validation loss decreased (-0.266654 --> -0.399988).  Saving model ...
Epoch: 7 cost time: 0.48573923110961914
Epoch: 7, Steps: 1 | Train Loss: 0.699 Vali Loss: 1.244 Vali Acc: 0.400 Test Loss: 1.244 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.45148563385009766
Epoch: 8, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.249 Vali Acc: 0.400 Test Loss: 1.249 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4231700897216797
Epoch: 9, Steps: 1 | Train Loss: 0.344 Vali Loss: 1.265 Vali Acc: 0.400 Test Loss: 1.265 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6362369060516357
Epoch: 10, Steps: 1 | Train Loss: 0.239 Vali Loss: 1.298 Vali Acc: 0.400 Test Loss: 1.298 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5259196758270264
Epoch: 11, Steps: 1 | Train Loss: 0.157 Vali Loss: 1.347 Vali Acc: 0.400 Test Loss: 1.347 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5534372329711914
Epoch: 12, Steps: 1 | Train Loss: 0.097 Vali Loss: 1.410 Vali Acc: 0.400 Test Loss: 1.410 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6192309856414795
Epoch: 13, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.485 Vali Acc: 0.400 Test Loss: 1.485 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6097652912139893
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.568 Vali Acc: 0.400 Test Loss: 1.568 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5403051376342773
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.654 Vali Acc: 0.400 Test Loss: 1.654 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5971076488494873
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.741 Vali Acc: 0.400 Test Loss: 1.741 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5737707614898682
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.828 Vali Acc: 0.400 Test Loss: 1.828 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6311553
model size : 24.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5933058261871338
Epoch: 1, Steps: 1 | Train Loss: 1.260 Vali Loss: 1.096 Vali Acc: 0.267 Test Loss: 1.096 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.6398868560791016
Epoch: 2, Steps: 1 | Train Loss: 1.190 Vali Loss: 1.090 Vali Acc: 0.267 Test Loss: 1.090 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 3 cost time: 0.5693542957305908
Epoch: 3, Steps: 1 | Train Loss: 1.124 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (-0.266656 --> -0.266656).  Saving model ...
Epoch: 4 cost time: 0.5434024333953857
Epoch: 4, Steps: 1 | Train Loss: 1.061 Vali Loss: 1.078 Vali Acc: 0.200 Test Loss: 1.078 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5187361240386963
Epoch: 5, Steps: 1 | Train Loss: 1.001 Vali Loss: 1.073 Vali Acc: 0.200 Test Loss: 1.073 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.5566720962524414
Epoch: 6, Steps: 1 | Train Loss: 0.945 Vali Loss: 1.066 Vali Acc: 0.333 Test Loss: 1.066 Test Acc: 0.333
Validation loss decreased (-0.266656 --> -0.333323).  Saving model ...
Epoch: 7 cost time: 0.5423500537872314
Epoch: 7, Steps: 1 | Train Loss: 0.693 Vali Loss: 1.061 Vali Acc: 0.400 Test Loss: 1.061 Test Acc: 0.400
Validation loss decreased (-0.333323 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.6493163108825684
Epoch: 8, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.064 Vali Acc: 0.400 Test Loss: 1.064 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5496041774749756
Epoch: 9, Steps: 1 | Train Loss: 0.348 Vali Loss: 1.080 Vali Acc: 0.333 Test Loss: 1.080 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5007331371307373
Epoch: 10, Steps: 1 | Train Loss: 0.243 Vali Loss: 1.111 Vali Acc: 0.333 Test Loss: 1.111 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.574960470199585
Epoch: 11, Steps: 1 | Train Loss: 0.160 Vali Loss: 1.158 Vali Acc: 0.333 Test Loss: 1.158 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6689355373382568
Epoch: 12, Steps: 1 | Train Loss: 0.098 Vali Loss: 1.219 Vali Acc: 0.333 Test Loss: 1.219 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4803597927093506
Epoch: 13, Steps: 1 | Train Loss: 0.057 Vali Loss: 1.292 Vali Acc: 0.333 Test Loss: 1.292 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5984597206115723
Epoch: 14, Steps: 1 | Train Loss: 0.032 Vali Loss: 1.373 Vali Acc: 0.333 Test Loss: 1.373 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.6478874683380127
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.459 Vali Acc: 0.333 Test Loss: 1.459 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5937213897705078
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.548 Vali Acc: 0.333 Test Loss: 1.548 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5683832168579102
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.636 Vali Acc: 0.333 Test Loss: 1.636 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm64_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6361479
model size : 24.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs1250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7754650115966797
Epoch: 1, Steps: 1 | Train Loss: 1.148 Vali Loss: 1.142 Vali Acc: 0.333 Test Loss: 1.142 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4053962230682373
Epoch: 2, Steps: 1 | Train Loss: 1.086 Vali Loss: 1.139 Vali Acc: 0.333 Test Loss: 1.139 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.5569744110107422
Epoch: 3, Steps: 1 | Train Loss: 1.026 Vali Loss: 1.136 Vali Acc: 0.333 Test Loss: 1.136 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.5359885692596436
Epoch: 4, Steps: 1 | Train Loss: 0.970 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.5203611850738525
Epoch: 5, Steps: 1 | Train Loss: 0.917 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.4854564666748047
Epoch: 6, Steps: 1 | Train Loss: 0.866 Vali Loss: 1.122 Vali Acc: 0.400 Test Loss: 1.122 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4570040702819824
Epoch: 7, Steps: 1 | Train Loss: 0.640 Vali Loss: 1.116 Vali Acc: 0.400 Test Loss: 1.116 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 8 cost time: 0.4928429126739502
Epoch: 8, Steps: 1 | Train Loss: 0.458 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.399989 --> -0.533322).  Saving model ...
Epoch: 9 cost time: 0.5085911750793457
Epoch: 9, Steps: 1 | Train Loss: 0.327 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6158883571624756
Epoch: 10, Steps: 1 | Train Loss: 0.227 Vali Loss: 1.161 Vali Acc: 0.400 Test Loss: 1.161 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5845499038696289
Epoch: 11, Steps: 1 | Train Loss: 0.147 Vali Loss: 1.205 Vali Acc: 0.267 Test Loss: 1.205 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.636918306350708
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.264 Vali Acc: 0.267 Test Loss: 1.264 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7604005336761475
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.335 Vali Acc: 0.267 Test Loss: 1.335 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5716516971588135
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.413 Vali Acc: 0.267 Test Loss: 1.413 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5351741313934326
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.496 Vali Acc: 0.200 Test Loss: 1.496 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.46177220344543457
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.582 Vali Acc: 0.200 Test Loss: 1.582 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6484599113464355
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.668 Vali Acc: 0.200 Test Loss: 1.668 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6097118854522705
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs1250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6315481
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs834_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.816542387008667
Epoch: 1, Steps: 1 | Train Loss: 1.274 Vali Loss: 1.213 Vali Acc: 0.400 Test Loss: 1.213 Test Acc: 0.400
Validation loss decreased (inf --> -0.399988).  Saving model ...
Epoch: 2 cost time: 0.4485750198364258
Epoch: 2, Steps: 1 | Train Loss: 1.205 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.5370194911956787
Epoch: 3, Steps: 1 | Train Loss: 1.140 Vali Loss: 1.200 Vali Acc: 0.400 Test Loss: 1.200 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5360264778137207
Epoch: 4, Steps: 1 | Train Loss: 1.077 Vali Loss: 1.195 Vali Acc: 0.467 Test Loss: 1.195 Test Acc: 0.467
Validation loss decreased (-0.399988 --> -0.466655).  Saving model ...
Epoch: 5 cost time: 0.468090295791626
Epoch: 5, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.190 Vali Acc: 0.467 Test Loss: 1.190 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 6 cost time: 0.571049690246582
Epoch: 6, Steps: 1 | Train Loss: 0.962 Vali Loss: 1.179 Vali Acc: 0.400 Test Loss: 1.179 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5133218765258789
Epoch: 7, Steps: 1 | Train Loss: 0.703 Vali Loss: 1.170 Vali Acc: 0.467 Test Loss: 1.170 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466655).  Saving model ...
Epoch: 8 cost time: 0.6384780406951904
Epoch: 8, Steps: 1 | Train Loss: 0.489 Vali Loss: 1.168 Vali Acc: 0.333 Test Loss: 1.168 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.551659345626831
Epoch: 9, Steps: 1 | Train Loss: 0.341 Vali Loss: 1.179 Vali Acc: 0.333 Test Loss: 1.179 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5382428169250488
Epoch: 10, Steps: 1 | Train Loss: 0.236 Vali Loss: 1.207 Vali Acc: 0.333 Test Loss: 1.207 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.4830055236816406
Epoch: 11, Steps: 1 | Train Loss: 0.156 Vali Loss: 1.251 Vali Acc: 0.333 Test Loss: 1.251 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.535581111907959
Epoch: 12, Steps: 1 | Train Loss: 0.096 Vali Loss: 1.309 Vali Acc: 0.333 Test Loss: 1.309 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5982308387756348
Epoch: 13, Steps: 1 | Train Loss: 0.055 Vali Loss: 1.379 Vali Acc: 0.267 Test Loss: 1.379 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5110883712768555
Epoch: 14, Steps: 1 | Train Loss: 0.031 Vali Loss: 1.457 Vali Acc: 0.333 Test Loss: 1.457 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.47344040870666504
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.539 Vali Acc: 0.333 Test Loss: 1.539 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5406951904296875
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.624 Vali Acc: 0.333 Test Loss: 1.624 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5189120769500732
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.709 Vali Acc: 0.333 Test Loss: 1.709 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs834_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6313839
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs625_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6874253749847412
Epoch: 1, Steps: 1 | Train Loss: 1.017 Vali Loss: 1.215 Vali Acc: 0.200 Test Loss: 1.215 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.47756123542785645
Epoch: 2, Steps: 1 | Train Loss: 0.960 Vali Loss: 1.207 Vali Acc: 0.267 Test Loss: 1.207 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 3 cost time: 0.5749425888061523
Epoch: 3, Steps: 1 | Train Loss: 0.909 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333321).  Saving model ...
Epoch: 4 cost time: 0.5629832744598389
Epoch: 4, Steps: 1 | Train Loss: 0.862 Vali Loss: 1.198 Vali Acc: 0.333 Test Loss: 1.198 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 5 cost time: 0.4680747985839844
Epoch: 5, Steps: 1 | Train Loss: 0.819 Vali Loss: 1.195 Vali Acc: 0.333 Test Loss: 1.195 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.5474026203155518
Epoch: 6, Steps: 1 | Train Loss: 0.779 Vali Loss: 1.197 Vali Acc: 0.333 Test Loss: 1.197 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.4994335174560547
Epoch: 7, Steps: 1 | Train Loss: 0.588 Vali Loss: 1.206 Vali Acc: 0.400 Test Loss: 1.206 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 8 cost time: 0.5276393890380859
Epoch: 8, Steps: 1 | Train Loss: 0.426 Vali Loss: 1.228 Vali Acc: 0.333 Test Loss: 1.228 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.4648308753967285
Epoch: 9, Steps: 1 | Train Loss: 0.301 Vali Loss: 1.266 Vali Acc: 0.267 Test Loss: 1.266 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.48023533821105957
Epoch: 10, Steps: 1 | Train Loss: 0.203 Vali Loss: 1.322 Vali Acc: 0.267 Test Loss: 1.322 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8005602359771729
Epoch: 11, Steps: 1 | Train Loss: 0.127 Vali Loss: 1.397 Vali Acc: 0.267 Test Loss: 1.397 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5308301448822021
Epoch: 12, Steps: 1 | Train Loss: 0.074 Vali Loss: 1.489 Vali Acc: 0.267 Test Loss: 1.489 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6138365268707275
Epoch: 13, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.595 Vali Acc: 0.267 Test Loss: 1.595 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.6068742275238037
Epoch: 14, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.709 Vali Acc: 0.200 Test Loss: 1.709 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.609644889831543
Epoch: 15, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.829 Vali Acc: 0.200 Test Loss: 1.829 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5789730548858643
Epoch: 16, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.950 Vali Acc: 0.200 Test Loss: 1.950 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.5136072635650635
Epoch: 17, Steps: 1 | Train Loss: 0.004 Vali Loss: 2.071 Vali Acc: 0.200 Test Loss: 2.071 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs625_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6305513
model size : 24.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs500_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.920055627822876
Epoch: 1, Steps: 1 | Train Loss: 1.160 Vali Loss: 1.157 Vali Acc: 0.533 Test Loss: 1.157 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.38951826095581055
Epoch: 2, Steps: 1 | Train Loss: 1.098 Vali Loss: 1.152 Vali Acc: 0.467 Test Loss: 1.152 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5847811698913574
Epoch: 3, Steps: 1 | Train Loss: 1.039 Vali Loss: 1.147 Vali Acc: 0.467 Test Loss: 1.147 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4560239315032959
Epoch: 4, Steps: 1 | Train Loss: 0.984 Vali Loss: 1.142 Vali Acc: 0.467 Test Loss: 1.142 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6508350372314453
Epoch: 5, Steps: 1 | Train Loss: 0.932 Vali Loss: 1.138 Vali Acc: 0.467 Test Loss: 1.138 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.47473859786987305
Epoch: 6, Steps: 1 | Train Loss: 0.884 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.5459208488464355
Epoch: 7, Steps: 1 | Train Loss: 0.661 Vali Loss: 1.131 Vali Acc: 0.333 Test Loss: 1.131 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.4510493278503418
Epoch: 8, Steps: 1 | Train Loss: 0.476 Vali Loss: 1.138 Vali Acc: 0.400 Test Loss: 1.138 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.42945218086242676
Epoch: 9, Steps: 1 | Train Loss: 0.340 Vali Loss: 1.158 Vali Acc: 0.267 Test Loss: 1.158 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.5157938003540039
Epoch: 10, Steps: 1 | Train Loss: 0.235 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 0.4221012592315674
Epoch: 11, Steps: 1 | Train Loss: 0.152 Vali Loss: 1.244 Vali Acc: 0.267 Test Loss: 1.244 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs500_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6303535
model size : 24.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs417_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8037989139556885
Epoch: 1, Steps: 1 | Train Loss: 1.318 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4522433280944824
Epoch: 2, Steps: 1 | Train Loss: 1.248 Vali Loss: 1.136 Vali Acc: 0.400 Test Loss: 1.136 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5358419418334961
Epoch: 3, Steps: 1 | Train Loss: 1.181 Vali Loss: 1.131 Vali Acc: 0.400 Test Loss: 1.131 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.48340344429016113
Epoch: 4, Steps: 1 | Train Loss: 1.116 Vali Loss: 1.128 Vali Acc: 0.400 Test Loss: 1.128 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.6037039756774902
Epoch: 5, Steps: 1 | Train Loss: 1.054 Vali Loss: 1.124 Vali Acc: 0.400 Test Loss: 1.124 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.4384746551513672
Epoch: 6, Steps: 1 | Train Loss: 0.995 Vali Loss: 1.118 Vali Acc: 0.467 Test Loss: 1.118 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466655).  Saving model ...
Epoch: 7 cost time: 0.5043156147003174
Epoch: 7, Steps: 1 | Train Loss: 0.720 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.466655 --> -0.466656).  Saving model ...
Epoch: 8 cost time: 0.5063376426696777
Epoch: 8, Steps: 1 | Train Loss: 0.490 Vali Loss: 1.121 Vali Acc: 0.467 Test Loss: 1.121 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5247743129730225
Epoch: 9, Steps: 1 | Train Loss: 0.333 Vali Loss: 1.139 Vali Acc: 0.467 Test Loss: 1.139 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8793540000915527
Epoch: 10, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.174 Vali Acc: 0.400 Test Loss: 1.174 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5491366386413574
Epoch: 11, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.224 Vali Acc: 0.400 Test Loss: 1.224 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4894065856933594
Epoch: 12, Steps: 1 | Train Loss: 0.093 Vali Loss: 1.289 Vali Acc: 0.400 Test Loss: 1.289 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.4755287170410156
Epoch: 13, Steps: 1 | Train Loss: 0.054 Vali Loss: 1.365 Vali Acc: 0.400 Test Loss: 1.365 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.566107988357544
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.449 Vali Acc: 0.400 Test Loss: 1.449 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5612692832946777
Epoch: 15, Steps: 1 | Train Loss: 0.017 Vali Loss: 1.537 Vali Acc: 0.400 Test Loss: 1.537 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.49993419647216797
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.628 Vali Acc: 0.333 Test Loss: 1.628 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.591667890548706
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.719 Vali Acc: 0.333 Test Loss: 1.719 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs417_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6307233
model size : 24.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs358_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.686373233795166
Epoch: 1, Steps: 1 | Train Loss: 1.069 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
Validation loss decreased (inf --> -0.266656).  Saving model ...
Epoch: 2 cost time: 0.5711464881896973
Epoch: 2, Steps: 1 | Train Loss: 1.007 Vali Loss: 1.079 Vali Acc: 0.400 Test Loss: 1.079 Test Acc: 0.400
Validation loss decreased (-0.266656 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.5340261459350586
Epoch: 3, Steps: 1 | Train Loss: 0.948 Vali Loss: 1.075 Vali Acc: 0.400 Test Loss: 1.075 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.4968998432159424
Epoch: 4, Steps: 1 | Train Loss: 0.892 Vali Loss: 1.071 Vali Acc: 0.333 Test Loss: 1.071 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5693998336791992
Epoch: 5, Steps: 1 | Train Loss: 0.840 Vali Loss: 1.068 Vali Acc: 0.400 Test Loss: 1.068 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5176529884338379
Epoch: 6, Steps: 1 | Train Loss: 0.791 Vali Loss: 1.067 Vali Acc: 0.400 Test Loss: 1.067 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.46721577644348145
Epoch: 7, Steps: 1 | Train Loss: 0.574 Vali Loss: 1.071 Vali Acc: 0.267 Test Loss: 1.071 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5321371555328369
Epoch: 8, Steps: 1 | Train Loss: 0.399 Vali Loss: 1.086 Vali Acc: 0.333 Test Loss: 1.086 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5785138607025146
Epoch: 9, Steps: 1 | Train Loss: 0.279 Vali Loss: 1.116 Vali Acc: 0.333 Test Loss: 1.116 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5614528656005859
Epoch: 10, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.161 Vali Acc: 0.333 Test Loss: 1.161 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5448458194732666
Epoch: 11, Steps: 1 | Train Loss: 0.125 Vali Loss: 1.220 Vali Acc: 0.400 Test Loss: 1.220 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5122542381286621
Epoch: 12, Steps: 1 | Train Loss: 0.077 Vali Loss: 1.290 Vali Acc: 0.400 Test Loss: 1.290 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6426587104797363
Epoch: 13, Steps: 1 | Train Loss: 0.045 Vali Loss: 1.368 Vali Acc: 0.333 Test Loss: 1.368 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.42070841789245605
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.450 Vali Acc: 0.333 Test Loss: 1.450 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4993631839752197
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.536 Vali Acc: 0.333 Test Loss: 1.536 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5847887992858887
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.621 Vali Acc: 0.333 Test Loss: 1.621 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs358_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6316319
model size : 24.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs313_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6944124698638916
Epoch: 1, Steps: 1 | Train Loss: 1.185 Vali Loss: 1.088 Vali Acc: 0.333 Test Loss: 1.088 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.5220792293548584
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.084 Vali Acc: 0.267 Test Loss: 1.084 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5719625949859619
Epoch: 3, Steps: 1 | Train Loss: 1.053 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.4677550792694092
Epoch: 4, Steps: 1 | Train Loss: 0.994 Vali Loss: 1.079 Vali Acc: 0.333 Test Loss: 1.079 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.46201539039611816
Epoch: 5, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.078 Vali Acc: 0.467 Test Loss: 1.078 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 6 cost time: 0.4643387794494629
Epoch: 6, Steps: 1 | Train Loss: 0.889 Vali Loss: 1.076 Vali Acc: 0.467 Test Loss: 1.076 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.4390718936920166
Epoch: 7, Steps: 1 | Train Loss: 0.655 Vali Loss: 1.079 Vali Acc: 0.533 Test Loss: 1.079 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.44257569313049316
Epoch: 8, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.090 Vali Acc: 0.533 Test Loss: 1.090 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6261012554168701
Epoch: 9, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.113 Vali Acc: 0.400 Test Loss: 1.113 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6016461849212646
Epoch: 10, Steps: 1 | Train Loss: 0.228 Vali Loss: 1.150 Vali Acc: 0.400 Test Loss: 1.150 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.5271620750427246
Epoch: 11, Steps: 1 | Train Loss: 0.148 Vali Loss: 1.203 Vali Acc: 0.400 Test Loss: 1.203 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.4747462272644043
Epoch: 12, Steps: 1 | Train Loss: 0.089 Vali Loss: 1.272 Vali Acc: 0.267 Test Loss: 1.272 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.6373193264007568
Epoch: 13, Steps: 1 | Train Loss: 0.051 Vali Loss: 1.352 Vali Acc: 0.267 Test Loss: 1.352 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5581932067871094
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.442 Vali Acc: 0.267 Test Loss: 1.442 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5777928829193115
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.537 Vali Acc: 0.200 Test Loss: 1.537 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.4790823459625244
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.48348212242126465
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.734 Vali Acc: 0.200 Test Loss: 1.734 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs313_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6310633
model size : 24.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs278_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9831416606903076
Epoch: 1, Steps: 1 | Train Loss: 1.259 Vali Loss: 1.024 Vali Acc: 0.333 Test Loss: 1.024 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.5696749687194824
Epoch: 2, Steps: 1 | Train Loss: 1.194 Vali Loss: 1.020 Vali Acc: 0.333 Test Loss: 1.020 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.5422995090484619
Epoch: 3, Steps: 1 | Train Loss: 1.131 Vali Loss: 1.015 Vali Acc: 0.467 Test Loss: 1.015 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466657).  Saving model ...
Epoch: 4 cost time: 0.5116744041442871
Epoch: 4, Steps: 1 | Train Loss: 1.070 Vali Loss: 1.011 Vali Acc: 0.467 Test Loss: 1.011 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 5 cost time: 0.5792171955108643
Epoch: 5, Steps: 1 | Train Loss: 1.012 Vali Loss: 1.006 Vali Acc: 0.467 Test Loss: 1.006 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.5538911819458008
Epoch: 6, Steps: 1 | Train Loss: 0.957 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.5344161987304688
Epoch: 7, Steps: 1 | Train Loss: 0.704 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
Validation loss decreased (-0.466657 --> -0.466657).  Saving model ...
Epoch: 8 cost time: 0.4907557964324951
Epoch: 8, Steps: 1 | Train Loss: 0.494 Vali Loss: 0.989 Vali Acc: 0.467 Test Loss: 0.989 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5792582035064697
Epoch: 9, Steps: 1 | Train Loss: 0.349 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.466657 --> -0.533323).  Saving model ...
Epoch: 10 cost time: 0.5705218315124512
Epoch: 10, Steps: 1 | Train Loss: 0.244 Vali Loss: 1.032 Vali Acc: 0.467 Test Loss: 1.032 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6585257053375244
Epoch: 11, Steps: 1 | Train Loss: 0.162 Vali Loss: 1.079 Vali Acc: 0.467 Test Loss: 1.079 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5828256607055664
Epoch: 12, Steps: 1 | Train Loss: 0.101 Vali Loss: 1.140 Vali Acc: 0.400 Test Loss: 1.140 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5620872974395752
Epoch: 13, Steps: 1 | Train Loss: 0.059 Vali Loss: 1.212 Vali Acc: 0.400 Test Loss: 1.212 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.4553079605102539
Epoch: 14, Steps: 1 | Train Loss: 0.033 Vali Loss: 1.292 Vali Acc: 0.400 Test Loss: 1.292 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.54030442237854
Epoch: 15, Steps: 1 | Train Loss: 0.018 Vali Loss: 1.376 Vali Acc: 0.333 Test Loss: 1.376 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.694019079208374
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.462 Vali Acc: 0.333 Test Loss: 1.462 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.5442988872528076
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.549 Vali Acc: 0.333 Test Loss: 1.549 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7661640644073486
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.634 Vali Acc: 0.333 Test Loss: 1.634 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.5880935192108154
Epoch: 19, Steps: 1 | Train Loss: 0.002 Vali Loss: 1.718 Vali Acc: 0.333 Test Loss: 1.718 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs278_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6305111
model size : 24.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs250_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.4964380264282227
Epoch: 1, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.009 Vali Acc: 0.400 Test Loss: 1.009 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.5323114395141602
Epoch: 2, Steps: 1 | Train Loss: 1.016 Vali Loss: 1.002 Vali Acc: 0.533 Test Loss: 1.002 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 3 cost time: 0.5321085453033447
Epoch: 3, Steps: 1 | Train Loss: 0.961 Vali Loss: 0.996 Vali Acc: 0.533 Test Loss: 0.996 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 4 cost time: 0.5319743156433105
Epoch: 4, Steps: 1 | Train Loss: 0.909 Vali Loss: 0.991 Vali Acc: 0.533 Test Loss: 0.991 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 5 cost time: 0.45479583740234375
Epoch: 5, Steps: 1 | Train Loss: 0.862 Vali Loss: 0.987 Vali Acc: 0.533 Test Loss: 0.987 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 6 cost time: 0.3910861015319824
Epoch: 6, Steps: 1 | Train Loss: 0.819 Vali Loss: 0.977 Vali Acc: 0.600 Test Loss: 0.977 Test Acc: 0.600
Validation loss decreased (-0.533323 --> -0.599990).  Saving model ...
Epoch: 7 cost time: 0.4521520137786865
Epoch: 7, Steps: 1 | Train Loss: 0.617 Vali Loss: 0.972 Vali Acc: 0.533 Test Loss: 0.972 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4919753074645996
Epoch: 8, Steps: 1 | Train Loss: 0.451 Vali Loss: 0.977 Vali Acc: 0.467 Test Loss: 0.977 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.48038697242736816
Epoch: 9, Steps: 1 | Train Loss: 0.324 Vali Loss: 0.996 Vali Acc: 0.467 Test Loss: 0.996 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5270140171051025
Epoch: 10, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.031 Vali Acc: 0.467 Test Loss: 1.031 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.559063196182251
Epoch: 11, Steps: 1 | Train Loss: 0.142 Vali Loss: 1.081 Vali Acc: 0.333 Test Loss: 1.081 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6770486831665039
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.146 Vali Acc: 0.333 Test Loss: 1.146 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5790135860443115
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.221 Vali Acc: 0.333 Test Loss: 1.221 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5484113693237305
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.304 Vali Acc: 0.333 Test Loss: 1.304 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6088688373565674
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.392 Vali Acc: 0.333 Test Loss: 1.392 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.546079158782959
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.481 Vali Acc: 0.333 Test Loss: 1.481 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs250_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6
model parameter : 6299705
model size : 24.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs228_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8196818828582764
Epoch: 1, Steps: 1 | Train Loss: 1.105 Vali Loss: 1.164 Vali Acc: 0.533 Test Loss: 1.164 Test Acc: 0.533
Validation loss decreased (inf --> -0.533322).  Saving model ...
Epoch: 2 cost time: 0.5239832401275635
Epoch: 2, Steps: 1 | Train Loss: 1.042 Vali Loss: 1.156 Vali Acc: 0.533 Test Loss: 1.156 Test Acc: 0.533
Validation loss decreased (-0.533322 --> -0.533322).  Saving model ...
Epoch: 3 cost time: 0.5282351970672607
Epoch: 3, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.150 Vali Acc: 0.333 Test Loss: 1.150 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5802710056304932
Epoch: 4, Steps: 1 | Train Loss: 0.928 Vali Loss: 1.145 Vali Acc: 0.400 Test Loss: 1.145 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.47823143005371094
Epoch: 5, Steps: 1 | Train Loss: 0.878 Vali Loss: 1.141 Vali Acc: 0.400 Test Loss: 1.141 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.524993896484375
Epoch: 6, Steps: 1 | Train Loss: 0.831 Vali Loss: 1.140 Vali Acc: 0.333 Test Loss: 1.140 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.4532511234283447
Epoch: 7, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.144 Vali Acc: 0.333 Test Loss: 1.144 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.5422890186309814
Epoch: 8, Steps: 1 | Train Loss: 0.444 Vali Loss: 1.159 Vali Acc: 0.333 Test Loss: 1.159 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.6196579933166504
Epoch: 9, Steps: 1 | Train Loss: 0.313 Vali Loss: 1.190 Vali Acc: 0.333 Test Loss: 1.190 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.5070013999938965
Epoch: 10, Steps: 1 | Train Loss: 0.212 Vali Loss: 1.238 Vali Acc: 0.333 Test Loss: 1.238 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.5937340259552002
Epoch: 11, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.302 Vali Acc: 0.467 Test Loss: 1.302 Test Acc: 0.467
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.5472369194030762
Epoch: 12, Steps: 1 | Train Loss: 0.080 Vali Loss: 1.379 Vali Acc: 0.467 Test Loss: 1.379 Test Acc: 0.467
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs228_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6319399
model size : 24.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs209_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.8146946430206299
Epoch: 1, Steps: 1 | Train Loss: 1.101 Vali Loss: 1.109 Vali Acc: 0.333 Test Loss: 1.109 Test Acc: 0.333
Validation loss decreased (inf --> -0.333322).  Saving model ...
Epoch: 2 cost time: 0.4146699905395508
Epoch: 2, Steps: 1 | Train Loss: 1.041 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 3 cost time: 0.4814472198486328
Epoch: 3, Steps: 1 | Train Loss: 0.985 Vali Loss: 1.108 Vali Acc: 0.333 Test Loss: 1.108 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 4 cost time: 0.4505901336669922
Epoch: 4, Steps: 1 | Train Loss: 0.933 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 5 cost time: 0.506720781326294
Epoch: 5, Steps: 1 | Train Loss: 0.883 Vali Loss: 1.107 Vali Acc: 0.333 Test Loss: 1.107 Test Acc: 0.333
Validation loss decreased (-0.333322 --> -0.333322).  Saving model ...
Epoch: 6 cost time: 0.6629781723022461
Epoch: 6, Steps: 1 | Train Loss: 0.838 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.333322 --> -0.399989).  Saving model ...
Epoch: 7 cost time: 0.4662015438079834
Epoch: 7, Steps: 1 | Train Loss: 0.626 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4354116916656494
Epoch: 8, Steps: 1 | Train Loss: 0.451 Vali Loss: 1.130 Vali Acc: 0.333 Test Loss: 1.130 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.4458465576171875
Epoch: 9, Steps: 1 | Train Loss: 0.319 Vali Loss: 1.156 Vali Acc: 0.333 Test Loss: 1.156 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.39490342140197754
Epoch: 10, Steps: 1 | Train Loss: 0.216 Vali Loss: 1.196 Vali Acc: 0.200 Test Loss: 1.196 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.440126895904541
Epoch: 11, Steps: 1 | Train Loss: 0.135 Vali Loss: 1.249 Vali Acc: 0.267 Test Loss: 1.249 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4618651866912842
Epoch: 12, Steps: 1 | Train Loss: 0.079 Vali Loss: 1.315 Vali Acc: 0.267 Test Loss: 1.315 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5285923480987549
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.391 Vali Acc: 0.267 Test Loss: 1.391 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5511364936828613
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.474 Vali Acc: 0.267 Test Loss: 1.474 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5559573173522949
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.561 Vali Acc: 0.267 Test Loss: 1.561 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5882992744445801
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.651 Vali Acc: 0.267 Test Loss: 1.651 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs209_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6319145
model size : 24.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs193_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7015550136566162
Epoch: 1, Steps: 1 | Train Loss: 1.174 Vali Loss: 1.042 Vali Acc: 0.400 Test Loss: 1.042 Test Acc: 0.400
Validation loss decreased (inf --> -0.399990).  Saving model ...
Epoch: 2 cost time: 0.6661069393157959
Epoch: 2, Steps: 1 | Train Loss: 1.112 Vali Loss: 1.038 Vali Acc: 0.400 Test Loss: 1.038 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 3 cost time: 0.6060647964477539
Epoch: 3, Steps: 1 | Train Loss: 1.052 Vali Loss: 1.035 Vali Acc: 0.400 Test Loss: 1.035 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 4 cost time: 0.5747265815734863
Epoch: 4, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.031 Vali Acc: 0.400 Test Loss: 1.031 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 5 cost time: 0.49181342124938965
Epoch: 5, Steps: 1 | Train Loss: 0.942 Vali Loss: 1.028 Vali Acc: 0.400 Test Loss: 1.028 Test Acc: 0.400
Validation loss decreased (-0.399990 --> -0.399990).  Saving model ...
Epoch: 6 cost time: 0.4839041233062744
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.022 Vali Acc: 0.533 Test Loss: 1.022 Test Acc: 0.533
Validation loss decreased (-0.399990 --> -0.533323).  Saving model ...
Epoch: 7 cost time: 0.47817420959472656
Epoch: 7, Steps: 1 | Train Loss: 0.657 Vali Loss: 1.019 Vali Acc: 0.533 Test Loss: 1.019 Test Acc: 0.533
Validation loss decreased (-0.533323 --> -0.533323).  Saving model ...
Epoch: 8 cost time: 0.6113481521606445
Epoch: 8, Steps: 1 | Train Loss: 0.465 Vali Loss: 1.025 Vali Acc: 0.667 Test Loss: 1.025 Test Acc: 0.667
Validation loss decreased (-0.533323 --> -0.666656).  Saving model ...
Epoch: 9 cost time: 0.5892229080200195
Epoch: 9, Steps: 1 | Train Loss: 0.330 Vali Loss: 1.045 Vali Acc: 0.600 Test Loss: 1.045 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7148449420928955
Epoch: 10, Steps: 1 | Train Loss: 0.229 Vali Loss: 1.080 Vali Acc: 0.467 Test Loss: 1.080 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6128764152526855
Epoch: 11, Steps: 1 | Train Loss: 0.151 Vali Loss: 1.132 Vali Acc: 0.400 Test Loss: 1.132 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5523173809051514
Epoch: 12, Steps: 1 | Train Loss: 0.092 Vali Loss: 1.198 Vali Acc: 0.267 Test Loss: 1.198 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.5591170787811279
Epoch: 13, Steps: 1 | Train Loss: 0.053 Vali Loss: 1.276 Vali Acc: 0.267 Test Loss: 1.276 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.5562045574188232
Epoch: 14, Steps: 1 | Train Loss: 0.030 Vali Loss: 1.361 Vali Acc: 0.267 Test Loss: 1.361 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.5992200374603271
Epoch: 15, Steps: 1 | Train Loss: 0.016 Vali Loss: 1.450 Vali Acc: 0.267 Test Loss: 1.450 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5614888668060303
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.541 Vali Acc: 0.267 Test Loss: 1.541 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5755140781402588
Epoch: 17, Steps: 1 | Train Loss: 0.005 Vali Loss: 1.632 Vali Acc: 0.267 Test Loss: 1.632 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5958802700042725
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.722 Vali Acc: 0.333 Test Loss: 1.722 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs193_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.6666666666666666
model parameter : 6321443
model size : 24.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs179_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5984961986541748
Epoch: 1, Steps: 1 | Train Loss: 0.974 Vali Loss: 1.119 Vali Acc: 0.400 Test Loss: 1.119 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.4680655002593994
Epoch: 2, Steps: 1 | Train Loss: 0.921 Vali Loss: 1.115 Vali Acc: 0.400 Test Loss: 1.115 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4370708465576172
Epoch: 3, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.5001776218414307
Epoch: 4, Steps: 1 | Train Loss: 0.824 Vali Loss: 1.108 Vali Acc: 0.400 Test Loss: 1.108 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5735819339752197
Epoch: 5, Steps: 1 | Train Loss: 0.780 Vali Loss: 1.105 Vali Acc: 0.400 Test Loss: 1.105 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5023722648620605
Epoch: 6, Steps: 1 | Train Loss: 0.739 Vali Loss: 1.106 Vali Acc: 0.467 Test Loss: 1.106 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.6147005558013916
Epoch: 7, Steps: 1 | Train Loss: 0.554 Vali Loss: 1.114 Vali Acc: 0.467 Test Loss: 1.114 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4315340518951416
Epoch: 8, Steps: 1 | Train Loss: 0.401 Vali Loss: 1.133 Vali Acc: 0.333 Test Loss: 1.133 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5532500743865967
Epoch: 9, Steps: 1 | Train Loss: 0.284 Vali Loss: 1.169 Vali Acc: 0.333 Test Loss: 1.169 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4559156894683838
Epoch: 10, Steps: 1 | Train Loss: 0.192 Vali Loss: 1.220 Vali Acc: 0.333 Test Loss: 1.220 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.569575309753418
Epoch: 11, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.286 Vali Acc: 0.333 Test Loss: 1.286 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.4913814067840576
Epoch: 12, Steps: 1 | Train Loss: 0.071 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6235573291778564
Epoch: 13, Steps: 1 | Train Loss: 0.040 Vali Loss: 1.447 Vali Acc: 0.333 Test Loss: 1.447 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6125586032867432
Epoch: 14, Steps: 1 | Train Loss: 0.022 Vali Loss: 1.535 Vali Acc: 0.333 Test Loss: 1.535 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6226897239685059
Epoch: 15, Steps: 1 | Train Loss: 0.012 Vali Loss: 1.626 Vali Acc: 0.333 Test Loss: 1.626 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6067683696746826
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.716 Vali Acc: 0.333 Test Loss: 1.716 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs179_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6313777
model size : 24.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs167_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5009605884552002
Epoch: 1, Steps: 1 | Train Loss: 1.179 Vali Loss: 1.237 Vali Acc: 0.200 Test Loss: 1.237 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5307638645172119
Epoch: 2, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.233 Vali Acc: 0.200 Test Loss: 1.233 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.7858943939208984
Epoch: 3, Steps: 1 | Train Loss: 1.056 Vali Loss: 1.229 Vali Acc: 0.200 Test Loss: 1.229 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.7667109966278076
Epoch: 4, Steps: 1 | Train Loss: 0.998 Vali Loss: 1.226 Vali Acc: 0.200 Test Loss: 1.226 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 5 cost time: 0.5085742473602295
Epoch: 5, Steps: 1 | Train Loss: 0.943 Vali Loss: 1.222 Vali Acc: 0.333 Test Loss: 1.222 Test Acc: 0.333
Validation loss decreased (-0.199988 --> -0.333321).  Saving model ...
Epoch: 6 cost time: 0.6136229038238525
Epoch: 6, Steps: 1 | Train Loss: 0.891 Vali Loss: 1.217 Vali Acc: 0.333 Test Loss: 1.217 Test Acc: 0.333
Validation loss decreased (-0.333321 --> -0.333321).  Saving model ...
Epoch: 7 cost time: 0.4469645023345947
Epoch: 7, Steps: 1 | Train Loss: 0.646 Vali Loss: 1.216 Vali Acc: 0.267 Test Loss: 1.216 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.510939359664917
Epoch: 8, Steps: 1 | Train Loss: 0.445 Vali Loss: 1.224 Vali Acc: 0.267 Test Loss: 1.224 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5199871063232422
Epoch: 9, Steps: 1 | Train Loss: 0.307 Vali Loss: 1.246 Vali Acc: 0.267 Test Loss: 1.246 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5950660705566406
Epoch: 10, Steps: 1 | Train Loss: 0.210 Vali Loss: 1.285 Vali Acc: 0.267 Test Loss: 1.285 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6029412746429443
Epoch: 11, Steps: 1 | Train Loss: 0.137 Vali Loss: 1.339 Vali Acc: 0.267 Test Loss: 1.339 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5615618228912354
Epoch: 12, Steps: 1 | Train Loss: 0.084 Vali Loss: 1.406 Vali Acc: 0.267 Test Loss: 1.406 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.6278443336486816
Epoch: 13, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.483 Vali Acc: 0.200 Test Loss: 1.483 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5545947551727295
Epoch: 14, Steps: 1 | Train Loss: 0.028 Vali Loss: 1.566 Vali Acc: 0.267 Test Loss: 1.566 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.4953339099884033
Epoch: 15, Steps: 1 | Train Loss: 0.015 Vali Loss: 1.654 Vali Acc: 0.267 Test Loss: 1.654 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.49773502349853516
Epoch: 16, Steps: 1 | Train Loss: 0.009 Vali Loss: 1.742 Vali Acc: 0.267 Test Loss: 1.742 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs167_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6311147
model size : 24.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs157_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6999437808990479
Epoch: 1, Steps: 1 | Train Loss: 1.117 Vali Loss: 1.022 Vali Acc: 0.467 Test Loss: 1.022 Test Acc: 0.467
Validation loss decreased (inf --> -0.466656).  Saving model ...
Epoch: 2 cost time: 0.49433231353759766
Epoch: 2, Steps: 1 | Train Loss: 1.055 Vali Loss: 1.020 Vali Acc: 0.467 Test Loss: 1.020 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 3 cost time: 0.4889557361602783
Epoch: 3, Steps: 1 | Train Loss: 0.996 Vali Loss: 1.017 Vali Acc: 0.467 Test Loss: 1.017 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466656).  Saving model ...
Epoch: 4 cost time: 0.4064188003540039
Epoch: 4, Steps: 1 | Train Loss: 0.940 Vali Loss: 1.016 Vali Acc: 0.400 Test Loss: 1.016 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.48185086250305176
Epoch: 5, Steps: 1 | Train Loss: 0.888 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
Validation loss decreased (-0.466656 --> -0.466657).  Saving model ...
Epoch: 6 cost time: 0.5353667736053467
Epoch: 6, Steps: 1 | Train Loss: 0.839 Vali Loss: 1.011 Vali Acc: 0.400 Test Loss: 1.011 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.49309802055358887
Epoch: 7, Steps: 1 | Train Loss: 0.620 Vali Loss: 1.013 Vali Acc: 0.400 Test Loss: 1.013 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.5262267589569092
Epoch: 8, Steps: 1 | Train Loss: 0.443 Vali Loss: 1.027 Vali Acc: 0.400 Test Loss: 1.027 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.45886921882629395
Epoch: 9, Steps: 1 | Train Loss: 0.315 Vali Loss: 1.056 Vali Acc: 0.467 Test Loss: 1.056 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.5129754543304443
Epoch: 10, Steps: 1 | Train Loss: 0.218 Vali Loss: 1.102 Vali Acc: 0.400 Test Loss: 1.102 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.5724496841430664
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.164 Vali Acc: 0.400 Test Loss: 1.164 Test Acc: 0.400
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.6026666164398193
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.239 Vali Acc: 0.400 Test Loss: 1.239 Test Acc: 0.400
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.503288984298706
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.323 Vali Acc: 0.400 Test Loss: 1.323 Test Acc: 0.400
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.49262285232543945
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.414 Vali Acc: 0.400 Test Loss: 1.414 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.7367792129516602
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.508 Vali Acc: 0.400 Test Loss: 1.508 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs157_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6328553
model size : 24.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs148_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.7249553203582764
Epoch: 1, Steps: 1 | Train Loss: 1.354 Vali Loss: 1.062 Vali Acc: 0.333 Test Loss: 1.062 Test Acc: 0.333
Validation loss decreased (inf --> -0.333323).  Saving model ...
Epoch: 2 cost time: 0.49103212356567383
Epoch: 2, Steps: 1 | Train Loss: 1.282 Vali Loss: 1.054 Vali Acc: 0.333 Test Loss: 1.054 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 3 cost time: 0.4205317497253418
Epoch: 3, Steps: 1 | Train Loss: 1.213 Vali Loss: 1.048 Vali Acc: 0.333 Test Loss: 1.048 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 4 cost time: 0.5145218372344971
Epoch: 4, Steps: 1 | Train Loss: 1.147 Vali Loss: 1.043 Vali Acc: 0.333 Test Loss: 1.043 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.5237743854522705
Epoch: 5, Steps: 1 | Train Loss: 1.085 Vali Loss: 1.039 Vali Acc: 0.267 Test Loss: 1.039 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.5155801773071289
Epoch: 6, Steps: 1 | Train Loss: 1.027 Vali Loss: 1.038 Vali Acc: 0.467 Test Loss: 1.038 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.46189451217651367
Epoch: 7, Steps: 1 | Train Loss: 0.754 Vali Loss: 1.044 Vali Acc: 0.467 Test Loss: 1.044 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.47876572608947754
Epoch: 8, Steps: 1 | Train Loss: 0.529 Vali Loss: 1.060 Vali Acc: 0.533 Test Loss: 1.060 Test Acc: 0.533
Validation loss decreased (-0.466656 --> -0.533323).  Saving model ...
Epoch: 9 cost time: 0.5033800601959229
Epoch: 9, Steps: 1 | Train Loss: 0.375 Vali Loss: 1.088 Vali Acc: 0.467 Test Loss: 1.088 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5640909671783447
Epoch: 10, Steps: 1 | Train Loss: 0.265 Vali Loss: 1.130 Vali Acc: 0.400 Test Loss: 1.130 Test Acc: 0.400
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5101041793823242
Epoch: 11, Steps: 1 | Train Loss: 0.178 Vali Loss: 1.186 Vali Acc: 0.400 Test Loss: 1.186 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.44667792320251465
Epoch: 12, Steps: 1 | Train Loss: 0.111 Vali Loss: 1.254 Vali Acc: 0.400 Test Loss: 1.254 Test Acc: 0.400
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.49446892738342285
Epoch: 13, Steps: 1 | Train Loss: 0.064 Vali Loss: 1.332 Vali Acc: 0.400 Test Loss: 1.332 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.43616819381713867
Epoch: 14, Steps: 1 | Train Loss: 0.036 Vali Loss: 1.419 Vali Acc: 0.333 Test Loss: 1.419 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.4570040702819824
Epoch: 15, Steps: 1 | Train Loss: 0.019 Vali Loss: 1.511 Vali Acc: 0.267 Test Loss: 1.511 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.4007720947265625
Epoch: 16, Steps: 1 | Train Loss: 0.010 Vali Loss: 1.606 Vali Acc: 0.267 Test Loss: 1.606 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.5541915893554688
Epoch: 17, Steps: 1 | Train Loss: 0.006 Vali Loss: 1.701 Vali Acc: 0.267 Test Loss: 1.701 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.5379276275634766
Epoch: 18, Steps: 1 | Train Loss: 0.003 Vali Loss: 1.796 Vali Acc: 0.267 Test Loss: 1.796 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs148_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.5333333333333333
model parameter : 6338479
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs139_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6361753940582275
Epoch: 1, Steps: 1 | Train Loss: 1.046 Vali Loss: 1.233 Vali Acc: 0.333 Test Loss: 1.233 Test Acc: 0.333
Validation loss decreased (inf --> -0.333321).  Saving model ...
Epoch: 2 cost time: 0.4367961883544922
Epoch: 2, Steps: 1 | Train Loss: 0.983 Vali Loss: 1.223 Vali Acc: 0.400 Test Loss: 1.223 Test Acc: 0.400
Validation loss decreased (-0.333321 --> -0.399988).  Saving model ...
Epoch: 3 cost time: 0.40672874450683594
Epoch: 3, Steps: 1 | Train Loss: 0.925 Vali Loss: 1.214 Vali Acc: 0.400 Test Loss: 1.214 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 4 cost time: 0.5344035625457764
Epoch: 4, Steps: 1 | Train Loss: 0.871 Vali Loss: 1.207 Vali Acc: 0.400 Test Loss: 1.207 Test Acc: 0.400
Validation loss decreased (-0.399988 --> -0.399988).  Saving model ...
Epoch: 5 cost time: 0.5213415622711182
Epoch: 5, Steps: 1 | Train Loss: 0.822 Vali Loss: 1.201 Vali Acc: 0.333 Test Loss: 1.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.49678659439086914
Epoch: 6, Steps: 1 | Train Loss: 0.776 Vali Loss: 1.193 Vali Acc: 0.267 Test Loss: 1.193 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.627357006072998
Epoch: 7, Steps: 1 | Train Loss: 0.570 Vali Loss: 1.190 Vali Acc: 0.267 Test Loss: 1.190 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.5463190078735352
Epoch: 8, Steps: 1 | Train Loss: 0.404 Vali Loss: 1.197 Vali Acc: 0.267 Test Loss: 1.197 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.5215256214141846
Epoch: 9, Steps: 1 | Train Loss: 0.283 Vali Loss: 1.218 Vali Acc: 0.333 Test Loss: 1.218 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.4514472484588623
Epoch: 10, Steps: 1 | Train Loss: 0.191 Vali Loss: 1.257 Vali Acc: 0.333 Test Loss: 1.257 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.5084061622619629
Epoch: 11, Steps: 1 | Train Loss: 0.121 Vali Loss: 1.312 Vali Acc: 0.333 Test Loss: 1.312 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.5274813175201416
Epoch: 12, Steps: 1 | Train Loss: 0.072 Vali Loss: 1.381 Vali Acc: 0.267 Test Loss: 1.381 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.4885563850402832
Epoch: 13, Steps: 1 | Train Loss: 0.041 Vali Loss: 1.460 Vali Acc: 0.200 Test Loss: 1.460 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.47432541847229004
Epoch: 14, Steps: 1 | Train Loss: 0.023 Vali Loss: 1.547 Vali Acc: 0.267 Test Loss: 1.547 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs139_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4
model parameter : 6303409
model size : 24.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs132_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.9284164905548096
Epoch: 1, Steps: 1 | Train Loss: 1.137 Vali Loss: 1.173 Vali Acc: 0.200 Test Loss: 1.173 Test Acc: 0.200
Validation loss decreased (inf --> -0.199988).  Saving model ...
Epoch: 2 cost time: 0.5306506156921387
Epoch: 2, Steps: 1 | Train Loss: 1.076 Vali Loss: 1.170 Vali Acc: 0.200 Test Loss: 1.170 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 3 cost time: 0.5845053195953369
Epoch: 3, Steps: 1 | Train Loss: 1.018 Vali Loss: 1.168 Vali Acc: 0.200 Test Loss: 1.168 Test Acc: 0.200
Validation loss decreased (-0.199988 --> -0.199988).  Saving model ...
Epoch: 4 cost time: 0.45104002952575684
Epoch: 4, Steps: 1 | Train Loss: 0.964 Vali Loss: 1.165 Vali Acc: 0.267 Test Loss: 1.165 Test Acc: 0.267
Validation loss decreased (-0.199988 --> -0.266655).  Saving model ...
Epoch: 5 cost time: 0.695002555847168
Epoch: 5, Steps: 1 | Train Loss: 0.912 Vali Loss: 1.164 Vali Acc: 0.267 Test Loss: 1.164 Test Acc: 0.267
Validation loss decreased (-0.266655 --> -0.266655).  Saving model ...
Epoch: 6 cost time: 0.5873432159423828
Epoch: 6, Steps: 1 | Train Loss: 0.863 Vali Loss: 1.164 Vali Acc: 0.333 Test Loss: 1.164 Test Acc: 0.333
Validation loss decreased (-0.266655 --> -0.333322).  Saving model ...
Epoch: 7 cost time: 0.5754036903381348
Epoch: 7, Steps: 1 | Train Loss: 0.643 Vali Loss: 1.169 Vali Acc: 0.267 Test Loss: 1.169 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5612509250640869
Epoch: 8, Steps: 1 | Train Loss: 0.460 Vali Loss: 1.182 Vali Acc: 0.200 Test Loss: 1.182 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6970252990722656
Epoch: 9, Steps: 1 | Train Loss: 0.326 Vali Loss: 1.208 Vali Acc: 0.200 Test Loss: 1.208 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.566594123840332
Epoch: 10, Steps: 1 | Train Loss: 0.223 Vali Loss: 1.248 Vali Acc: 0.267 Test Loss: 1.248 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.579925537109375
Epoch: 11, Steps: 1 | Train Loss: 0.143 Vali Loss: 1.304 Vali Acc: 0.267 Test Loss: 1.304 Test Acc: 0.267
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.48503971099853516
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.375 Vali Acc: 0.267 Test Loss: 1.375 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.4925270080566406
Epoch: 13, Steps: 1 | Train Loss: 0.048 Vali Loss: 1.456 Vali Acc: 0.267 Test Loss: 1.456 Test Acc: 0.267
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.4296855926513672
Epoch: 14, Steps: 1 | Train Loss: 0.026 Vali Loss: 1.544 Vali Acc: 0.267 Test Loss: 1.544 Test Acc: 0.267
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.5749249458312988
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.637 Vali Acc: 0.267 Test Loss: 1.637 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.6036138534545898
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs132_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.3333333333333333
model parameter : 6318375
model size : 24.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs125_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.5965449810028076
Epoch: 1, Steps: 1 | Train Loss: 1.108 Vali Loss: 1.114 Vali Acc: 0.400 Test Loss: 1.114 Test Acc: 0.400
Validation loss decreased (inf --> -0.399989).  Saving model ...
Epoch: 2 cost time: 0.3936948776245117
Epoch: 2, Steps: 1 | Train Loss: 1.047 Vali Loss: 1.112 Vali Acc: 0.400 Test Loss: 1.112 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 3 cost time: 0.4620344638824463
Epoch: 3, Steps: 1 | Train Loss: 0.989 Vali Loss: 1.111 Vali Acc: 0.400 Test Loss: 1.111 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 4 cost time: 0.6571900844573975
Epoch: 4, Steps: 1 | Train Loss: 0.934 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 5 cost time: 0.5228269100189209
Epoch: 5, Steps: 1 | Train Loss: 0.882 Vali Loss: 1.110 Vali Acc: 0.400 Test Loss: 1.110 Test Acc: 0.400
Validation loss decreased (-0.399989 --> -0.399989).  Saving model ...
Epoch: 6 cost time: 0.5829591751098633
Epoch: 6, Steps: 1 | Train Loss: 0.834 Vali Loss: 1.115 Vali Acc: 0.467 Test Loss: 1.115 Test Acc: 0.467
Validation loss decreased (-0.399989 --> -0.466656).  Saving model ...
Epoch: 7 cost time: 0.5072567462921143
Epoch: 7, Steps: 1 | Train Loss: 0.615 Vali Loss: 1.127 Vali Acc: 0.467 Test Loss: 1.127 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.4758584499359131
Epoch: 8, Steps: 1 | Train Loss: 0.438 Vali Loss: 1.149 Vali Acc: 0.467 Test Loss: 1.149 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5398366451263428
Epoch: 9, Steps: 1 | Train Loss: 0.312 Vali Loss: 1.184 Vali Acc: 0.400 Test Loss: 1.184 Test Acc: 0.400
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5382888317108154
Epoch: 10, Steps: 1 | Train Loss: 0.217 Vali Loss: 1.233 Vali Acc: 0.467 Test Loss: 1.233 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6071085929870605
Epoch: 11, Steps: 1 | Train Loss: 0.141 Vali Loss: 1.295 Vali Acc: 0.400 Test Loss: 1.295 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.5747294425964355
Epoch: 12, Steps: 1 | Train Loss: 0.085 Vali Loss: 1.369 Vali Acc: 0.333 Test Loss: 1.369 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.5921564102172852
Epoch: 13, Steps: 1 | Train Loss: 0.049 Vali Loss: 1.452 Vali Acc: 0.333 Test Loss: 1.452 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5731778144836426
Epoch: 14, Steps: 1 | Train Loss: 0.027 Vali Loss: 1.542 Vali Acc: 0.333 Test Loss: 1.542 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.577552318572998
Epoch: 15, Steps: 1 | Train Loss: 0.014 Vali Loss: 1.636 Vali Acc: 0.333 Test Loss: 1.636 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.5115838050842285
Epoch: 16, Steps: 1 | Train Loss: 0.008 Vali Loss: 1.732 Vali Acc: 0.267 Test Loss: 1.732 Test Acc: 0.267
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs125_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6298345
model size : 24.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_StandWalkJump   Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/StandWalkJump
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

12
15
>>>>>>>start training : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs120_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
12
15
15
Epoch: 1 cost time: 1.6885902881622314
Epoch: 1, Steps: 1 | Train Loss: 1.079 Vali Loss: 1.003 Vali Acc: 0.267 Test Loss: 1.003 Test Acc: 0.267
Validation loss decreased (inf --> -0.266657).  Saving model ...
Epoch: 2 cost time: 0.4585244655609131
Epoch: 2, Steps: 1 | Train Loss: 1.020 Vali Loss: 1.001 Vali Acc: 0.267 Test Loss: 1.001 Test Acc: 0.267
Validation loss decreased (-0.266657 --> -0.266657).  Saving model ...
Epoch: 3 cost time: 0.48477911949157715
Epoch: 3, Steps: 1 | Train Loss: 0.964 Vali Loss: 0.999 Vali Acc: 0.267 Test Loss: 0.999 Test Acc: 0.267
Validation loss decreased (-0.266657 --> -0.266657).  Saving model ...
Epoch: 4 cost time: 0.5875637531280518
Epoch: 4, Steps: 1 | Train Loss: 0.912 Vali Loss: 0.997 Vali Acc: 0.333 Test Loss: 0.997 Test Acc: 0.333
Validation loss decreased (-0.266657 --> -0.333323).  Saving model ...
Epoch: 5 cost time: 0.5808553695678711
Epoch: 5, Steps: 1 | Train Loss: 0.863 Vali Loss: 0.995 Vali Acc: 0.333 Test Loss: 0.995 Test Acc: 0.333
Validation loss decreased (-0.333323 --> -0.333323).  Saving model ...
Epoch: 6 cost time: 0.4939882755279541
Epoch: 6, Steps: 1 | Train Loss: 0.817 Vali Loss: 0.995 Vali Acc: 0.467 Test Loss: 0.995 Test Acc: 0.467
Validation loss decreased (-0.333323 --> -0.466657).  Saving model ...
Epoch: 7 cost time: 0.4856252670288086
Epoch: 7, Steps: 1 | Train Loss: 0.606 Vali Loss: 1.000 Vali Acc: 0.467 Test Loss: 1.000 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5003330707550049
Epoch: 8, Steps: 1 | Train Loss: 0.433 Vali Loss: 1.014 Vali Acc: 0.467 Test Loss: 1.014 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.415132999420166
Epoch: 9, Steps: 1 | Train Loss: 0.306 Vali Loss: 1.040 Vali Acc: 0.467 Test Loss: 1.040 Test Acc: 0.467
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.4826676845550537
Epoch: 10, Steps: 1 | Train Loss: 0.208 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.5815284252166748
Epoch: 11, Steps: 1 | Train Loss: 0.132 Vali Loss: 1.135 Vali Acc: 0.400 Test Loss: 1.135 Test Acc: 0.400
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.518000602722168
Epoch: 12, Steps: 1 | Train Loss: 0.078 Vali Loss: 1.202 Vali Acc: 0.333 Test Loss: 1.202 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7132759094238281
Epoch: 13, Steps: 1 | Train Loss: 0.044 Vali Loss: 1.278 Vali Acc: 0.333 Test Loss: 1.278 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.5826380252838135
Epoch: 14, Steps: 1 | Train Loss: 0.024 Vali Loss: 1.362 Vali Acc: 0.333 Test Loss: 1.362 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6060450077056885
Epoch: 15, Steps: 1 | Train Loss: 0.013 Vali Loss: 1.450 Vali Acc: 0.333 Test Loss: 1.450 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.49948906898498535
Epoch: 16, Steps: 1 | Train Loss: 0.007 Vali Loss: 1.540 Vali Acc: 0.333 Test Loss: 1.540 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_StandWalkJump_LightTS_UEA_ftM_sl2500_ll0_pl0_dm32_cs120_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
15
test shape: torch.Size([15, 3]) torch.Size([15, 1])
accuracy:0.4666666666666667
model parameter : 6348351
model size : 24.23MB
