Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.658257484436035
Epoch: 1, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.760 Vali Acc: 0.033 Test Loss: 2.760 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 0.9258832931518555
Epoch: 2, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.724 Vali Acc: 0.039 Test Loss: 2.724 Test Acc: 0.039
Validation loss decreased (-0.033306 --> -0.038862).  Saving model ...
Epoch: 3 cost time: 0.8587617874145508
Epoch: 3, Steps: 12 | Train Loss: 2.671 Vali Loss: 2.676 Vali Acc: 0.056 Test Loss: 2.676 Test Acc: 0.056
Validation loss decreased (-0.038862 --> -0.055529).  Saving model ...
Epoch: 4 cost time: 1.2335145473480225
Epoch: 4, Steps: 12 | Train Loss: 2.623 Vali Loss: 2.620 Vali Acc: 0.094 Test Loss: 2.620 Test Acc: 0.094
Validation loss decreased (-0.055529 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.9606277942657471
Epoch: 5, Steps: 12 | Train Loss: 2.542 Vali Loss: 2.546 Vali Acc: 0.133 Test Loss: 2.546 Test Acc: 0.133
Validation loss decreased (-0.094418 --> -0.133308).  Saving model ...
Epoch: 6 cost time: 0.8030829429626465
Epoch: 6, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.448 Vali Acc: 0.244 Test Loss: 2.448 Test Acc: 0.244
Validation loss decreased (-0.133308 --> -0.244420).  Saving model ...
Epoch: 7 cost time: 1.1696951389312744
Epoch: 7, Steps: 12 | Train Loss: 2.320 Vali Loss: 2.287 Vali Acc: 0.322 Test Loss: 2.287 Test Acc: 0.322
Validation loss decreased (-0.244420 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 1.3075006008148193
Epoch: 8, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.075 Vali Acc: 0.344 Test Loss: 2.075 Test Acc: 0.344
Validation loss decreased (-0.322199 --> -0.344424).  Saving model ...
Epoch: 9 cost time: 1.108696460723877
Epoch: 9, Steps: 12 | Train Loss: 1.880 Vali Loss: 1.811 Vali Acc: 0.428 Test Loss: 1.811 Test Acc: 0.428
Validation loss decreased (-0.344424 --> -0.427760).  Saving model ...
Epoch: 10 cost time: 1.0770022869110107
Epoch: 10, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.562 Vali Acc: 0.489 Test Loss: 1.562 Test Acc: 0.489
Validation loss decreased (-0.427760 --> -0.488873).  Saving model ...
Epoch: 11 cost time: 1.417691707611084
Epoch: 11, Steps: 12 | Train Loss: 1.415 Vali Loss: 1.394 Vali Acc: 0.561 Test Loss: 1.394 Test Acc: 0.561
Validation loss decreased (-0.488873 --> -0.561097).  Saving model ...
Epoch: 12 cost time: 1.087278127670288
Epoch: 12, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.256 Vali Acc: 0.561 Test Loss: 1.256 Test Acc: 0.561
Validation loss decreased (-0.561097 --> -0.561099).  Saving model ...
Epoch: 13 cost time: 1.3924963474273682
Epoch: 13, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.153 Vali Acc: 0.617 Test Loss: 1.153 Test Acc: 0.617
Validation loss decreased (-0.561099 --> -0.616655).  Saving model ...
Epoch: 14 cost time: 0.9052484035491943
Epoch: 14, Steps: 12 | Train Loss: 0.990 Vali Loss: 1.075 Vali Acc: 0.611 Test Loss: 1.075 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9393284320831299
Epoch: 15, Steps: 12 | Train Loss: 0.879 Vali Loss: 1.024 Vali Acc: 0.678 Test Loss: 1.024 Test Acc: 0.678
Validation loss decreased (-0.616655 --> -0.677768).  Saving model ...
Epoch: 16 cost time: 1.1710290908813477
Epoch: 16, Steps: 12 | Train Loss: 0.848 Vali Loss: 0.976 Vali Acc: 0.622 Test Loss: 0.976 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4251539707183838
Epoch: 17, Steps: 12 | Train Loss: 0.750 Vali Loss: 0.910 Vali Acc: 0.656 Test Loss: 0.910 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2000694274902344
Epoch: 18, Steps: 12 | Train Loss: 0.720 Vali Loss: 0.913 Vali Acc: 0.667 Test Loss: 0.913 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2332890033721924
Epoch: 19, Steps: 12 | Train Loss: 0.690 Vali Loss: 0.854 Vali Acc: 0.667 Test Loss: 0.854 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.207625389099121
Epoch: 20, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.795 Vali Acc: 0.689 Test Loss: 0.795 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688881).  Saving model ...
Epoch: 21 cost time: 1.0940284729003906
Epoch: 21, Steps: 12 | Train Loss: 0.471 Vali Loss: 0.723 Vali Acc: 0.744 Test Loss: 0.723 Test Acc: 0.744
Validation loss decreased (-0.688881 --> -0.744437).  Saving model ...
Epoch: 22 cost time: 0.8499419689178467
Epoch: 22, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761105).  Saving model ...
Epoch: 23 cost time: 1.323678731918335
Epoch: 23, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.695 Vali Acc: 0.767 Test Loss: 0.695 Test Acc: 0.767
Validation loss decreased (-0.761105 --> -0.766660).  Saving model ...
Epoch: 24 cost time: 1.218597173690796
Epoch: 24, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.766 Vali Acc: 0.756 Test Loss: 0.766 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.383439540863037
Epoch: 25, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.703 Vali Acc: 0.761 Test Loss: 0.703 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3355932235717773
Epoch: 26, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.612 Vali Acc: 0.778 Test Loss: 0.612 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777772).  Saving model ...
Epoch: 27 cost time: 1.1355900764465332
Epoch: 27, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.643 Vali Acc: 0.778 Test Loss: 0.643 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2512540817260742
Epoch: 28, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.629 Vali Acc: 0.811 Test Loss: 0.629 Test Acc: 0.811
Validation loss decreased (-0.777772 --> -0.811105).  Saving model ...
Epoch: 29 cost time: 1.0651586055755615
Epoch: 29, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.703 Vali Acc: 0.772 Test Loss: 0.703 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8898935317993164
Epoch: 30, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.664 Vali Acc: 0.817 Test Loss: 0.664 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 31 cost time: 1.110062599182129
Epoch: 31, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.732 Vali Acc: 0.778 Test Loss: 0.732 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0558052062988281
Epoch: 32, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.731 Vali Acc: 0.806 Test Loss: 0.731 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4464988708496094
Epoch: 33, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.739 Vali Acc: 0.806 Test Loss: 0.739 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0066208839416504
Epoch: 34, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6901273727416992
Epoch: 35, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.888 Vali Acc: 0.806 Test Loss: 0.888 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8209874629974365
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1456272602081299
Epoch: 37, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.810 Vali Acc: 0.822 Test Loss: 0.810 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822214).  Saving model ...
Epoch: 38 cost time: 1.089942455291748
Epoch: 38, Steps: 12 | Train Loss: 0.055 Vali Loss: 0.941 Vali Acc: 0.789 Test Loss: 0.941 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9945745468139648
Epoch: 39, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.925 Vali Acc: 0.822 Test Loss: 0.925 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1699285507202148
Epoch: 40, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.016 Vali Acc: 0.794 Test Loss: 1.016 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.977747917175293
Epoch: 41, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.899 Vali Acc: 0.806 Test Loss: 0.899 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9508311748504639
Epoch: 42, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.030 Vali Acc: 0.817 Test Loss: 1.030 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.1173882484436035
Epoch: 43, Steps: 12 | Train Loss: 0.033 Vali Loss: 1.036 Vali Acc: 0.806 Test Loss: 1.036 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9742140769958496
Epoch: 44, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.044 Vali Acc: 0.783 Test Loss: 1.044 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9783647060394287
Epoch: 45, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.193 Vali Acc: 0.833 Test Loss: 1.193 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833321).  Saving model ...
Epoch: 46 cost time: 1.2264518737792969
Epoch: 46, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.222 Vali Acc: 0.817 Test Loss: 1.222 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0935087203979492
Epoch: 47, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.168 Vali Acc: 0.844 Test Loss: 1.168 Test Acc: 0.844
Validation loss decreased (-0.833321 --> -0.844433).  Saving model ...
Epoch: 48 cost time: 1.1348762512207031
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 1.162 Vali Acc: 0.833 Test Loss: 1.162 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.3358654975891113
Epoch: 49, Steps: 12 | Train Loss: 0.013 Vali Loss: 1.285 Vali Acc: 0.794 Test Loss: 1.285 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0894854068756104
Epoch: 50, Steps: 12 | Train Loss: 0.023 Vali Loss: 1.205 Vali Acc: 0.833 Test Loss: 1.205 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.1213698387145996
Epoch: 51, Steps: 12 | Train Loss: 0.016 Vali Loss: 1.232 Vali Acc: 0.839 Test Loss: 1.232 Test Acc: 0.839
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.2452898025512695
Epoch: 52, Steps: 12 | Train Loss: 0.010 Vali Loss: 1.213 Vali Acc: 0.839 Test Loss: 1.213 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.0981080532073975
Epoch: 53, Steps: 12 | Train Loss: 0.004 Vali Loss: 1.315 Vali Acc: 0.833 Test Loss: 1.315 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.9158430099487305
Epoch: 54, Steps: 12 | Train Loss: 0.005 Vali Loss: 1.308 Vali Acc: 0.828 Test Loss: 1.308 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.1055586338043213
Epoch: 55, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.286 Vali Acc: 0.839 Test Loss: 1.286 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.213200569152832
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.273 Vali Acc: 0.833 Test Loss: 1.273 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.0769963264465332
Epoch: 57, Steps: 12 | Train Loss: 0.002 Vali Loss: 1.291 Vali Acc: 0.844 Test Loss: 1.291 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 111517
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4109368324279785
Epoch: 1, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.843 Vali Acc: 0.028 Test Loss: 2.843 Test Acc: 0.028
Validation loss decreased (inf --> -0.027749).  Saving model ...
Epoch: 2 cost time: 1.1492292881011963
Epoch: 2, Steps: 12 | Train Loss: 2.805 Vali Loss: 2.789 Vali Acc: 0.083 Test Loss: 2.789 Test Acc: 0.083
Validation loss decreased (-0.027749 --> -0.083305).  Saving model ...
Epoch: 3 cost time: 1.097332239151001
Epoch: 3, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.727 Vali Acc: 0.117 Test Loss: 2.727 Test Acc: 0.117
Validation loss decreased (-0.083305 --> -0.116639).  Saving model ...
Epoch: 4 cost time: 1.0289313793182373
Epoch: 4, Steps: 12 | Train Loss: 2.647 Vali Loss: 2.657 Vali Acc: 0.139 Test Loss: 2.657 Test Acc: 0.139
Validation loss decreased (-0.116639 --> -0.138862).  Saving model ...
Epoch: 5 cost time: 1.1184561252593994
Epoch: 5, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.570 Vali Acc: 0.139 Test Loss: 2.570 Test Acc: 0.139
Validation loss decreased (-0.138862 --> -0.138863).  Saving model ...
Epoch: 6 cost time: 1.1871447563171387
Epoch: 6, Steps: 12 | Train Loss: 2.472 Vali Loss: 2.446 Vali Acc: 0.200 Test Loss: 2.446 Test Acc: 0.200
Validation loss decreased (-0.138863 --> -0.199976).  Saving model ...
Epoch: 7 cost time: 0.905890703201294
Epoch: 7, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.289 Vali Acc: 0.361 Test Loss: 2.289 Test Acc: 0.361
Validation loss decreased (-0.199976 --> -0.361088).  Saving model ...
Epoch: 8 cost time: 1.0482888221740723
Epoch: 8, Steps: 12 | Train Loss: 2.120 Vali Loss: 2.083 Vali Acc: 0.344 Test Loss: 2.083 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1515440940856934
Epoch: 9, Steps: 12 | Train Loss: 1.853 Vali Loss: 1.839 Vali Acc: 0.472 Test Loss: 1.839 Test Acc: 0.472
Validation loss decreased (-0.361088 --> -0.472204).  Saving model ...
Epoch: 10 cost time: 1.3394124507904053
Epoch: 10, Steps: 12 | Train Loss: 1.552 Vali Loss: 1.601 Vali Acc: 0.511 Test Loss: 1.601 Test Acc: 0.511
Validation loss decreased (-0.472204 --> -0.511095).  Saving model ...
Epoch: 11 cost time: 0.9289755821228027
Epoch: 11, Steps: 12 | Train Loss: 1.362 Vali Loss: 1.443 Vali Acc: 0.511 Test Loss: 1.443 Test Acc: 0.511
Validation loss decreased (-0.511095 --> -0.511097).  Saving model ...
Epoch: 12 cost time: 1.2544429302215576
Epoch: 12, Steps: 12 | Train Loss: 1.213 Vali Loss: 1.230 Vali Acc: 0.567 Test Loss: 1.230 Test Acc: 0.567
Validation loss decreased (-0.511097 --> -0.566654).  Saving model ...
Epoch: 13 cost time: 0.9972677230834961
Epoch: 13, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.130 Vali Acc: 0.594 Test Loss: 1.130 Test Acc: 0.594
Validation loss decreased (-0.566654 --> -0.594433).  Saving model ...
Epoch: 14 cost time: 0.8174967765808105
Epoch: 14, Steps: 12 | Train Loss: 0.862 Vali Loss: 1.059 Vali Acc: 0.628 Test Loss: 1.059 Test Acc: 0.628
Validation loss decreased (-0.594433 --> -0.627767).  Saving model ...
Epoch: 15 cost time: 0.9972193241119385
Epoch: 15, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.001 Vali Acc: 0.661 Test Loss: 1.001 Test Acc: 0.661
Validation loss decreased (-0.627767 --> -0.661101).  Saving model ...
Epoch: 16 cost time: 1.424912452697754
Epoch: 16, Steps: 12 | Train Loss: 0.687 Vali Loss: 0.897 Vali Acc: 0.694 Test Loss: 0.897 Test Acc: 0.694
Validation loss decreased (-0.661101 --> -0.694435).  Saving model ...
Epoch: 17 cost time: 1.041039228439331
Epoch: 17, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.856 Vali Acc: 0.750 Test Loss: 0.856 Test Acc: 0.750
Validation loss decreased (-0.694435 --> -0.749991).  Saving model ...
Epoch: 18 cost time: 1.3723669052124023
Epoch: 18, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.836 Vali Acc: 0.728 Test Loss: 0.836 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2002921104431152
Epoch: 19, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1584622859954834
Epoch: 20, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.854 Vali Acc: 0.694 Test Loss: 0.854 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.267458200454712
Epoch: 21, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.766 Vali Acc: 0.739 Test Loss: 0.766 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.3063693046569824
Epoch: 22, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.808 Vali Acc: 0.733 Test Loss: 0.808 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.928581714630127
Epoch: 23, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
Validation loss decreased (-0.749991 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 1.350665807723999
Epoch: 24, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2135300636291504
Epoch: 25, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.730 Vali Acc: 0.756 Test Loss: 0.730 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1278657913208008
Epoch: 26, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 27 cost time: 1.2150509357452393
Epoch: 27, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.933081865310669
Epoch: 28, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 29 cost time: 1.257502555847168
Epoch: 29, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.728 Vali Acc: 0.789 Test Loss: 0.728 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 30 cost time: 1.3285939693450928
Epoch: 30, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.710 Vali Acc: 0.778 Test Loss: 0.710 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2146971225738525
Epoch: 31, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8822591304779053
Epoch: 32, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 33 cost time: 1.3960142135620117
Epoch: 33, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.680 Vali Acc: 0.817 Test Loss: 0.680 Test Acc: 0.817
Validation loss decreased (-0.788882 --> -0.816660).  Saving model ...
Epoch: 34 cost time: 0.9506416320800781
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.706 Vali Acc: 0.811 Test Loss: 0.706 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.378000259399414
Epoch: 35, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.823 Vali Acc: 0.800 Test Loss: 0.823 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2519705295562744
Epoch: 36, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.804 Vali Acc: 0.806 Test Loss: 0.804 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1800596714019775
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.891 Vali Acc: 0.789 Test Loss: 0.891 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.0999422073364258
Epoch: 38, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.767 Vali Acc: 0.800 Test Loss: 0.767 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.125967264175415
Epoch: 39, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.882 Vali Acc: 0.794 Test Loss: 0.882 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0511772632598877
Epoch: 40, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.858 Vali Acc: 0.800 Test Loss: 0.858 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.0412018299102783
Epoch: 41, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.910 Vali Acc: 0.806 Test Loss: 0.910 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.422236442565918
Epoch: 42, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.876 Vali Acc: 0.794 Test Loss: 0.876 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.2998573780059814
Epoch: 43, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.008 Vali Acc: 0.800 Test Loss: 1.008 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 109438
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.369528293609619
Epoch: 1, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.695 Vali Acc: 0.083 Test Loss: 2.695 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 1.1104295253753662
Epoch: 2, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.652 Vali Acc: 0.083 Test Loss: 2.652 Test Acc: 0.083
Validation loss decreased (-0.083306 --> -0.083307).  Saving model ...
Epoch: 3 cost time: 1.1055710315704346
Epoch: 3, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.599 Vali Acc: 0.100 Test Loss: 2.599 Test Acc: 0.100
Validation loss decreased (-0.083307 --> -0.099974).  Saving model ...
Epoch: 4 cost time: 1.0390985012054443
Epoch: 4, Steps: 12 | Train Loss: 2.635 Vali Loss: 2.535 Vali Acc: 0.128 Test Loss: 2.535 Test Acc: 0.128
Validation loss decreased (-0.099974 --> -0.127752).  Saving model ...
Epoch: 5 cost time: 0.9879934787750244
Epoch: 5, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.456 Vali Acc: 0.217 Test Loss: 2.456 Test Acc: 0.217
Validation loss decreased (-0.127752 --> -0.216642).  Saving model ...
Epoch: 6 cost time: 0.9945955276489258
Epoch: 6, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.344 Vali Acc: 0.339 Test Loss: 2.344 Test Acc: 0.339
Validation loss decreased (-0.216642 --> -0.338865).  Saving model ...
Epoch: 7 cost time: 1.3769233226776123
Epoch: 7, Steps: 12 | Train Loss: 2.298 Vali Loss: 2.187 Vali Acc: 0.394 Test Loss: 2.187 Test Acc: 0.394
Validation loss decreased (-0.338865 --> -0.394423).  Saving model ...
Epoch: 8 cost time: 1.2160735130310059
Epoch: 8, Steps: 12 | Train Loss: 2.104 Vali Loss: 1.952 Vali Acc: 0.433 Test Loss: 1.952 Test Acc: 0.433
Validation loss decreased (-0.394423 --> -0.433314).  Saving model ...
Epoch: 9 cost time: 1.0545318126678467
Epoch: 9, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.701 Vali Acc: 0.494 Test Loss: 1.701 Test Acc: 0.494
Validation loss decreased (-0.433314 --> -0.494427).  Saving model ...
Epoch: 10 cost time: 1.0478894710540771
Epoch: 10, Steps: 12 | Train Loss: 1.514 Vali Loss: 1.451 Vali Acc: 0.506 Test Loss: 1.451 Test Acc: 0.506
Validation loss decreased (-0.494427 --> -0.505541).  Saving model ...
Epoch: 11 cost time: 1.1533231735229492
Epoch: 11, Steps: 12 | Train Loss: 1.274 Vali Loss: 1.194 Vali Acc: 0.589 Test Loss: 1.194 Test Acc: 0.589
Validation loss decreased (-0.505541 --> -0.588877).  Saving model ...
Epoch: 12 cost time: 1.044621229171753
Epoch: 12, Steps: 12 | Train Loss: 1.060 Vali Loss: 1.032 Vali Acc: 0.589 Test Loss: 1.032 Test Acc: 0.589
Validation loss decreased (-0.588877 --> -0.588879).  Saving model ...
Epoch: 13 cost time: 1.0733718872070312
Epoch: 13, Steps: 12 | Train Loss: 0.851 Vali Loss: 0.916 Vali Acc: 0.667 Test Loss: 0.916 Test Acc: 0.667
Validation loss decreased (-0.588879 --> -0.666658).  Saving model ...
Epoch: 14 cost time: 0.8131728172302246
Epoch: 14, Steps: 12 | Train Loss: 0.710 Vali Loss: 0.815 Vali Acc: 0.717 Test Loss: 0.815 Test Acc: 0.717
Validation loss decreased (-0.666658 --> -0.716659).  Saving model ...
Epoch: 15 cost time: 0.9101464748382568
Epoch: 15, Steps: 12 | Train Loss: 0.577 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8774728775024414
Epoch: 16, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
Validation loss decreased (-0.716659 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 1.1222245693206787
Epoch: 17, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.637 Vali Acc: 0.767 Test Loss: 0.637 Test Acc: 0.767
Validation loss decreased (-0.749993 --> -0.766660).  Saving model ...
Epoch: 18 cost time: 1.2181193828582764
Epoch: 18, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.611 Vali Acc: 0.772 Test Loss: 0.611 Test Acc: 0.772
Validation loss decreased (-0.766660 --> -0.772216).  Saving model ...
Epoch: 19 cost time: 1.1218836307525635
Epoch: 19, Steps: 12 | Train Loss: 0.337 Vali Loss: 0.574 Vali Acc: 0.778 Test Loss: 0.574 Test Acc: 0.778
Validation loss decreased (-0.772216 --> -0.777772).  Saving model ...
Epoch: 20 cost time: 1.2204246520996094
Epoch: 20, Steps: 12 | Train Loss: 0.320 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
Validation loss decreased (-0.777772 --> -0.783327).  Saving model ...
Epoch: 21 cost time: 0.8942954540252686
Epoch: 21, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.529 Vali Acc: 0.822 Test Loss: 0.529 Test Acc: 0.822
Validation loss decreased (-0.783327 --> -0.822217).  Saving model ...
Epoch: 22 cost time: 0.8630306720733643
Epoch: 22, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.531 Vali Acc: 0.800 Test Loss: 0.531 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1685543060302734
Epoch: 23, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.510 Vali Acc: 0.806 Test Loss: 0.510 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1301419734954834
Epoch: 24, Steps: 12 | Train Loss: 0.195 Vali Loss: 0.505 Vali Acc: 0.811 Test Loss: 0.505 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0853021144866943
Epoch: 25, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0570294857025146
Epoch: 26, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.613 Vali Acc: 0.783 Test Loss: 0.613 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1822805404663086
Epoch: 27, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.637 Vali Acc: 0.806 Test Loss: 0.637 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.096313714981079
Epoch: 28, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.201277256011963
Epoch: 29, Steps: 12 | Train Loss: 0.224 Vali Loss: 0.620 Vali Acc: 0.811 Test Loss: 0.620 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8884012699127197
Epoch: 30, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.605 Vali Acc: 0.828 Test Loss: 0.605 Test Acc: 0.828
Validation loss decreased (-0.822217 --> -0.827772).  Saving model ...
Epoch: 31 cost time: 1.101304531097412
Epoch: 31, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.652 Vali Acc: 0.794 Test Loss: 0.652 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0815157890319824
Epoch: 32, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.663 Vali Acc: 0.800 Test Loss: 0.663 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9497404098510742
Epoch: 33, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.650 Vali Acc: 0.806 Test Loss: 0.650 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1000115871429443
Epoch: 34, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.650 Vali Acc: 0.828 Test Loss: 0.650 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.174095630645752
Epoch: 35, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3079028129577637
Epoch: 36, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.637 Vali Acc: 0.794 Test Loss: 0.637 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1245136260986328
Epoch: 37, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
Validation loss decreased (-0.827772 --> -0.844437).  Saving model ...
Epoch: 38 cost time: 1.1379239559173584
Epoch: 38, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.779 Vali Acc: 0.778 Test Loss: 0.779 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9646651744842529
Epoch: 39, Steps: 12 | Train Loss: 0.046 Vali Loss: 0.760 Vali Acc: 0.794 Test Loss: 0.760 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.214083194732666
Epoch: 40, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.748 Vali Acc: 0.817 Test Loss: 0.748 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2510266304016113
Epoch: 41, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.795 Vali Acc: 0.817 Test Loss: 0.795 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8863568305969238
Epoch: 42, Steps: 12 | Train Loss: 0.025 Vali Loss: 0.802 Vali Acc: 0.800 Test Loss: 0.802 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.5387322902679443
Epoch: 43, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.817 Vali Acc: 0.811 Test Loss: 0.817 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.249418020248413
Epoch: 44, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.840 Vali Acc: 0.800 Test Loss: 0.840 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.3553588390350342
Epoch: 45, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.006 Vali Acc: 0.806 Test Loss: 1.006 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.137263536453247
Epoch: 46, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.883 Vali Acc: 0.806 Test Loss: 0.883 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.984684944152832
Epoch: 47, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.936 Vali Acc: 0.794 Test Loss: 0.936 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8444444444444444
model parameter : 108823
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.39998197555542
Epoch: 1, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.669 Vali Acc: 0.183 Test Loss: 2.669 Test Acc: 0.183
Validation loss decreased (inf --> -0.183307).  Saving model ...
Epoch: 2 cost time: 1.1499357223510742
Epoch: 2, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.642 Vali Acc: 0.178 Test Loss: 2.642 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.00209641456604
Epoch: 3, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.607 Vali Acc: 0.183 Test Loss: 2.607 Test Acc: 0.183
Validation loss decreased (-0.183307 --> -0.183307).  Saving model ...
Epoch: 4 cost time: 1.0480530261993408
Epoch: 4, Steps: 12 | Train Loss: 2.604 Vali Loss: 2.566 Vali Acc: 0.206 Test Loss: 2.566 Test Acc: 0.206
Validation loss decreased (-0.183307 --> -0.205530).  Saving model ...
Epoch: 5 cost time: 0.8608798980712891
Epoch: 5, Steps: 12 | Train Loss: 2.579 Vali Loss: 2.515 Vali Acc: 0.233 Test Loss: 2.515 Test Acc: 0.233
Validation loss decreased (-0.205530 --> -0.233308).  Saving model ...
Epoch: 6 cost time: 1.0048401355743408
Epoch: 6, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.449 Vali Acc: 0.289 Test Loss: 2.449 Test Acc: 0.289
Validation loss decreased (-0.233308 --> -0.288864).  Saving model ...
Epoch: 7 cost time: 1.0445516109466553
Epoch: 7, Steps: 12 | Train Loss: 2.399 Vali Loss: 2.368 Vali Acc: 0.317 Test Loss: 2.368 Test Acc: 0.317
Validation loss decreased (-0.288864 --> -0.316643).  Saving model ...
Epoch: 8 cost time: 1.2480478286743164
Epoch: 8, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.266 Vali Acc: 0.283 Test Loss: 2.266 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7674374580383301
Epoch: 9, Steps: 12 | Train Loss: 2.133 Vali Loss: 2.128 Vali Acc: 0.317 Test Loss: 2.128 Test Acc: 0.317
Validation loss decreased (-0.316643 --> -0.316645).  Saving model ...
Epoch: 10 cost time: 1.0366673469543457
Epoch: 10, Steps: 12 | Train Loss: 1.955 Vali Loss: 1.943 Vali Acc: 0.411 Test Loss: 1.943 Test Acc: 0.411
Validation loss decreased (-0.316645 --> -0.411092).  Saving model ...
Epoch: 11 cost time: 0.8383808135986328
Epoch: 11, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.720 Vali Acc: 0.494 Test Loss: 1.720 Test Acc: 0.494
Validation loss decreased (-0.411092 --> -0.494427).  Saving model ...
Epoch: 12 cost time: 0.8154697418212891
Epoch: 12, Steps: 12 | Train Loss: 1.493 Vali Loss: 1.545 Vali Acc: 0.517 Test Loss: 1.545 Test Acc: 0.517
Validation loss decreased (-0.494427 --> -0.516651).  Saving model ...
Epoch: 13 cost time: 0.8738088607788086
Epoch: 13, Steps: 12 | Train Loss: 1.416 Vali Loss: 1.312 Vali Acc: 0.611 Test Loss: 1.312 Test Acc: 0.611
Validation loss decreased (-0.516651 --> -0.611098).  Saving model ...
Epoch: 14 cost time: 1.152470350265503
Epoch: 14, Steps: 12 | Train Loss: 1.070 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622210).  Saving model ...
Epoch: 15 cost time: 0.9060420989990234
Epoch: 15, Steps: 12 | Train Loss: 0.946 Vali Loss: 1.082 Vali Acc: 0.606 Test Loss: 1.082 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9656562805175781
Epoch: 16, Steps: 12 | Train Loss: 0.789 Vali Loss: 0.993 Vali Acc: 0.639 Test Loss: 0.993 Test Acc: 0.639
Validation loss decreased (-0.622210 --> -0.638879).  Saving model ...
Epoch: 17 cost time: 1.0500397682189941
Epoch: 17, Steps: 12 | Train Loss: 0.631 Vali Loss: 0.860 Vali Acc: 0.694 Test Loss: 0.860 Test Acc: 0.694
Validation loss decreased (-0.638879 --> -0.694436).  Saving model ...
Epoch: 18 cost time: 0.9221553802490234
Epoch: 18, Steps: 12 | Train Loss: 0.551 Vali Loss: 0.808 Vali Acc: 0.728 Test Loss: 0.808 Test Acc: 0.728
Validation loss decreased (-0.694436 --> -0.727770).  Saving model ...
Epoch: 19 cost time: 0.9046368598937988
Epoch: 19, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.777 Vali Acc: 0.739 Test Loss: 0.777 Test Acc: 0.739
Validation loss decreased (-0.727770 --> -0.738881).  Saving model ...
Epoch: 20 cost time: 1.4312374591827393
Epoch: 20, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.778 Vali Acc: 0.744 Test Loss: 0.778 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 21 cost time: 1.2786946296691895
Epoch: 21, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.743 Vali Acc: 0.739 Test Loss: 0.743 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.049400806427002
Epoch: 22, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.712 Vali Acc: 0.767 Test Loss: 0.712 Test Acc: 0.767
Validation loss decreased (-0.744437 --> -0.766660).  Saving model ...
Epoch: 23 cost time: 1.1268315315246582
Epoch: 23, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.073998212814331
Epoch: 24, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.761 Vali Acc: 0.767 Test Loss: 0.761 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.066413402557373
Epoch: 25, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.713 Vali Acc: 0.778 Test Loss: 0.713 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 26 cost time: 1.155083417892456
Epoch: 26, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.768 Vali Acc: 0.778 Test Loss: 0.768 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.232816457748413
Epoch: 27, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.850 Vali Acc: 0.778 Test Loss: 0.850 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0293807983398438
Epoch: 28, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.803 Vali Acc: 0.806 Test Loss: 0.803 Test Acc: 0.806
Validation loss decreased (-0.777771 --> -0.805548).  Saving model ...
Epoch: 29 cost time: 1.0212047100067139
Epoch: 29, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.863 Vali Acc: 0.772 Test Loss: 0.863 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9832985401153564
Epoch: 30, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.875 Vali Acc: 0.772 Test Loss: 0.875 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1141886711120605
Epoch: 31, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.005 Vali Acc: 0.811 Test Loss: 1.005 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811101).  Saving model ...
Epoch: 32 cost time: 1.0049490928649902
Epoch: 32, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.854 Vali Acc: 0.806 Test Loss: 0.854 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.086895227432251
Epoch: 33, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.929 Vali Acc: 0.800 Test Loss: 0.929 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.168440818786621
Epoch: 34, Steps: 12 | Train Loss: 0.082 Vali Loss: 1.008 Vali Acc: 0.783 Test Loss: 1.008 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9779431819915771
Epoch: 35, Steps: 12 | Train Loss: 0.096 Vali Loss: 0.931 Vali Acc: 0.806 Test Loss: 0.931 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.919802188873291
Epoch: 36, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.118 Vali Acc: 0.783 Test Loss: 1.118 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.908677339553833
Epoch: 37, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.047 Vali Acc: 0.794 Test Loss: 1.047 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.1450393199920654
Epoch: 38, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.195 Vali Acc: 0.778 Test Loss: 1.195 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.1283469200134277
Epoch: 39, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.984 Vali Acc: 0.800 Test Loss: 0.984 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0110745429992676
Epoch: 40, Steps: 12 | Train Loss: 0.044 Vali Loss: 1.188 Vali Acc: 0.806 Test Loss: 1.188 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.3037583827972412
Epoch: 41, Steps: 12 | Train Loss: 0.048 Vali Loss: 1.128 Vali Acc: 0.822 Test Loss: 1.128 Test Acc: 0.822
Validation loss decreased (-0.811101 --> -0.822211).  Saving model ...
Epoch: 42 cost time: 0.9003064632415771
Epoch: 42, Steps: 12 | Train Loss: 0.020 Vali Loss: 1.181 Vali Acc: 0.794 Test Loss: 1.181 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0326995849609375
Epoch: 43, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.429 Vali Acc: 0.778 Test Loss: 1.429 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8721208572387695
Epoch: 44, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.352 Vali Acc: 0.767 Test Loss: 1.352 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2000033855438232
Epoch: 45, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.341 Vali Acc: 0.789 Test Loss: 1.341 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0436956882476807
Epoch: 46, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.466 Vali Acc: 0.789 Test Loss: 1.466 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.1570594310760498
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.542 Vali Acc: 0.789 Test Loss: 1.542 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0804474353790283
Epoch: 48, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.286 Vali Acc: 0.789 Test Loss: 1.286 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.748326301574707
Epoch: 49, Steps: 12 | Train Loss: 0.007 Vali Loss: 1.368 Vali Acc: 0.789 Test Loss: 1.368 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8844189643859863
Epoch: 50, Steps: 12 | Train Loss: 0.008 Vali Loss: 1.509 Vali Acc: 0.783 Test Loss: 1.509 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0126738548278809
Epoch: 51, Steps: 12 | Train Loss: 0.009 Vali Loss: 1.388 Vali Acc: 0.817 Test Loss: 1.388 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 107942
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.537189245223999
Epoch: 1, Steps: 12 | Train Loss: 2.838 Vali Loss: 2.806 Vali Acc: 0.050 Test Loss: 2.806 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.8565623760223389
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.776 Vali Acc: 0.044 Test Loss: 2.776 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8037340641021729
Epoch: 3, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.737 Vali Acc: 0.078 Test Loss: 2.737 Test Acc: 0.078
Validation loss decreased (-0.049972 --> -0.077750).  Saving model ...
Epoch: 4 cost time: 1.1006033420562744
Epoch: 4, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.692 Vali Acc: 0.128 Test Loss: 2.692 Test Acc: 0.128
Validation loss decreased (-0.077750 --> -0.127751).  Saving model ...
Epoch: 5 cost time: 0.9708950519561768
Epoch: 5, Steps: 12 | Train Loss: 2.657 Vali Loss: 2.640 Vali Acc: 0.178 Test Loss: 2.640 Test Acc: 0.178
Validation loss decreased (-0.127751 --> -0.177751).  Saving model ...
Epoch: 6 cost time: 0.825385570526123
Epoch: 6, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.578 Vali Acc: 0.217 Test Loss: 2.578 Test Acc: 0.217
Validation loss decreased (-0.177751 --> -0.216641).  Saving model ...
Epoch: 7 cost time: 0.859034538269043
Epoch: 7, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.501 Vali Acc: 0.250 Test Loss: 2.501 Test Acc: 0.250
Validation loss decreased (-0.216641 --> -0.249975).  Saving model ...
Epoch: 8 cost time: 1.0796031951904297
Epoch: 8, Steps: 12 | Train Loss: 2.402 Vali Loss: 2.387 Vali Acc: 0.317 Test Loss: 2.387 Test Acc: 0.317
Validation loss decreased (-0.249975 --> -0.316643).  Saving model ...
Epoch: 9 cost time: 0.95672607421875
Epoch: 9, Steps: 12 | Train Loss: 2.281 Vali Loss: 2.227 Vali Acc: 0.339 Test Loss: 2.227 Test Acc: 0.339
Validation loss decreased (-0.316643 --> -0.338867).  Saving model ...
Epoch: 10 cost time: 0.9502067565917969
Epoch: 10, Steps: 12 | Train Loss: 2.057 Vali Loss: 1.984 Vali Acc: 0.394 Test Loss: 1.984 Test Acc: 0.394
Validation loss decreased (-0.338867 --> -0.394425).  Saving model ...
Epoch: 11 cost time: 0.882166862487793
Epoch: 11, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.652 Vali Acc: 0.517 Test Loss: 1.652 Test Acc: 0.517
Validation loss decreased (-0.394425 --> -0.516650).  Saving model ...
Epoch: 12 cost time: 0.7993984222412109
Epoch: 12, Steps: 12 | Train Loss: 1.442 Vali Loss: 1.388 Vali Acc: 0.556 Test Loss: 1.388 Test Acc: 0.556
Validation loss decreased (-0.516650 --> -0.555542).  Saving model ...
Epoch: 13 cost time: 1.2706563472747803
Epoch: 13, Steps: 12 | Train Loss: 1.267 Vali Loss: 1.244 Vali Acc: 0.567 Test Loss: 1.244 Test Acc: 0.567
Validation loss decreased (-0.555542 --> -0.566654).  Saving model ...
Epoch: 14 cost time: 0.8738515377044678
Epoch: 14, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.030 Vali Acc: 0.611 Test Loss: 1.030 Test Acc: 0.611
Validation loss decreased (-0.566654 --> -0.611101).  Saving model ...
Epoch: 15 cost time: 0.8871092796325684
Epoch: 15, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.906 Vali Acc: 0.711 Test Loss: 0.906 Test Acc: 0.711
Validation loss decreased (-0.611101 --> -0.711102).  Saving model ...
Epoch: 16 cost time: 0.8310558795928955
Epoch: 16, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.830 Vali Acc: 0.722 Test Loss: 0.830 Test Acc: 0.722
Validation loss decreased (-0.711102 --> -0.722214).  Saving model ...
Epoch: 17 cost time: 1.059298038482666
Epoch: 17, Steps: 12 | Train Loss: 0.585 Vali Loss: 0.781 Vali Acc: 0.722 Test Loss: 0.781 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 18 cost time: 1.1264746189117432
Epoch: 18, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.734 Vali Acc: 0.728 Test Loss: 0.734 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 19 cost time: 0.9230985641479492
Epoch: 19, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.748 Vali Acc: 0.733 Test Loss: 0.748 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 20 cost time: 0.999610185623169
Epoch: 20, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.672 Vali Acc: 0.767 Test Loss: 0.672 Test Acc: 0.767
Validation loss decreased (-0.733326 --> -0.766660).  Saving model ...
Epoch: 21 cost time: 0.8292703628540039
Epoch: 21, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.676 Vali Acc: 0.739 Test Loss: 0.676 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.035405158996582
Epoch: 22, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.722 Vali Acc: 0.733 Test Loss: 0.722 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8581914901733398
Epoch: 23, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
Validation loss decreased (-0.766660 --> -0.783327).  Saving model ...
Epoch: 24 cost time: 1.1177620887756348
Epoch: 24, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.700 Vali Acc: 0.761 Test Loss: 0.700 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0185546875
Epoch: 25, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.657 Vali Acc: 0.761 Test Loss: 0.657 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0287630558013916
Epoch: 26, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
Validation loss decreased (-0.783327 --> -0.788882).  Saving model ...
Epoch: 27 cost time: 1.0614614486694336
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.637 Vali Acc: 0.761 Test Loss: 0.637 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9244062900543213
Epoch: 28, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.723 Vali Acc: 0.778 Test Loss: 0.723 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.038027048110962
Epoch: 29, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.662 Vali Acc: 0.772 Test Loss: 0.662 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9531543254852295
Epoch: 30, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9620356559753418
Epoch: 31, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.765 Vali Acc: 0.783 Test Loss: 0.765 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.364354133605957
Epoch: 32, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.748 Vali Acc: 0.778 Test Loss: 0.748 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9769225120544434
Epoch: 33, Steps: 12 | Train Loss: 0.135 Vali Loss: 0.788 Vali Acc: 0.806 Test Loss: 0.788 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805548).  Saving model ...
Epoch: 34 cost time: 1.154731035232544
Epoch: 34, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.757 Vali Acc: 0.811 Test Loss: 0.757 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811104).  Saving model ...
Epoch: 35 cost time: 0.9063022136688232
Epoch: 35, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.773 Vali Acc: 0.817 Test Loss: 0.773 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 36 cost time: 1.1587905883789062
Epoch: 36, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.747 Vali Acc: 0.828 Test Loss: 0.747 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 37 cost time: 0.9450149536132812
Epoch: 37, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8315155506134033
Epoch: 38, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.958 Vali Acc: 0.822 Test Loss: 0.958 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1855738162994385
Epoch: 39, Steps: 12 | Train Loss: 0.045 Vali Loss: 0.896 Vali Acc: 0.789 Test Loss: 0.896 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.926081657409668
Epoch: 40, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.814 Vali Acc: 0.839 Test Loss: 0.814 Test Acc: 0.839
Validation loss decreased (-0.827770 --> -0.838881).  Saving model ...
Epoch: 41 cost time: 0.9903173446655273
Epoch: 41, Steps: 12 | Train Loss: 0.047 Vali Loss: 0.821 Vali Acc: 0.817 Test Loss: 0.821 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0181522369384766
Epoch: 42, Steps: 12 | Train Loss: 0.024 Vali Loss: 0.884 Vali Acc: 0.811 Test Loss: 0.884 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0610969066619873
Epoch: 43, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.882 Vali Acc: 0.828 Test Loss: 0.882 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8181936740875244
Epoch: 44, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.936 Vali Acc: 0.828 Test Loss: 0.936 Test Acc: 0.828
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7546334266662598
Epoch: 45, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.146 Vali Acc: 0.772 Test Loss: 1.146 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9013848304748535
Epoch: 46, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.943 Vali Acc: 0.817 Test Loss: 0.943 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.0242812633514404
Epoch: 47, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.009 Vali Acc: 0.811 Test Loss: 1.009 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9818115234375
Epoch: 48, Steps: 12 | Train Loss: 0.009 Vali Loss: 0.953 Vali Acc: 0.833 Test Loss: 0.953 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0533969402313232
Epoch: 49, Steps: 12 | Train Loss: 0.016 Vali Loss: 0.999 Vali Acc: 0.789 Test Loss: 0.999 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9881048202514648
Epoch: 50, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.014 Vali Acc: 0.839 Test Loss: 1.014 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 107847
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.679326295852661
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.763 Vali Acc: 0.067 Test Loss: 2.763 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 1.1335692405700684
Epoch: 2, Steps: 12 | Train Loss: 2.725 Vali Loss: 2.729 Vali Acc: 0.078 Test Loss: 2.729 Test Acc: 0.078
Validation loss decreased (-0.066639 --> -0.077750).  Saving model ...
Epoch: 3 cost time: 1.0335757732391357
Epoch: 3, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.682 Vali Acc: 0.122 Test Loss: 2.682 Test Acc: 0.122
Validation loss decreased (-0.077750 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.9780120849609375
Epoch: 4, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.622 Vali Acc: 0.150 Test Loss: 2.622 Test Acc: 0.150
Validation loss decreased (-0.122195 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 0.999737024307251
Epoch: 5, Steps: 12 | Train Loss: 2.552 Vali Loss: 2.548 Vali Acc: 0.178 Test Loss: 2.548 Test Acc: 0.178
Validation loss decreased (-0.149974 --> -0.177752).  Saving model ...
Epoch: 6 cost time: 1.0605216026306152
Epoch: 6, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.446 Vali Acc: 0.233 Test Loss: 2.446 Test Acc: 0.233
Validation loss decreased (-0.177752 --> -0.233309).  Saving model ...
Epoch: 7 cost time: 0.841632604598999
Epoch: 7, Steps: 12 | Train Loss: 2.353 Vali Loss: 2.299 Vali Acc: 0.294 Test Loss: 2.299 Test Acc: 0.294
Validation loss decreased (-0.233309 --> -0.294421).  Saving model ...
Epoch: 8 cost time: 1.0697050094604492
Epoch: 8, Steps: 12 | Train Loss: 2.120 Vali Loss: 2.086 Vali Acc: 0.411 Test Loss: 2.086 Test Acc: 0.411
Validation loss decreased (-0.294421 --> -0.411090).  Saving model ...
Epoch: 9 cost time: 1.0050873756408691
Epoch: 9, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.843 Vali Acc: 0.444 Test Loss: 1.843 Test Acc: 0.444
Validation loss decreased (-0.411090 --> -0.444426).  Saving model ...
Epoch: 10 cost time: 1.2724597454071045
Epoch: 10, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.588 Vali Acc: 0.478 Test Loss: 1.588 Test Acc: 0.478
Validation loss decreased (-0.444426 --> -0.477762).  Saving model ...
Epoch: 11 cost time: 0.9211912155151367
Epoch: 11, Steps: 12 | Train Loss: 1.368 Vali Loss: 1.410 Vali Acc: 0.517 Test Loss: 1.410 Test Acc: 0.517
Validation loss decreased (-0.477762 --> -0.516653).  Saving model ...
Epoch: 12 cost time: 1.2094273567199707
Epoch: 12, Steps: 12 | Train Loss: 1.151 Vali Loss: 1.207 Vali Acc: 0.583 Test Loss: 1.207 Test Acc: 0.583
Validation loss decreased (-0.516653 --> -0.583321).  Saving model ...
Epoch: 13 cost time: 1.2418770790100098
Epoch: 13, Steps: 12 | Train Loss: 0.948 Vali Loss: 1.079 Vali Acc: 0.639 Test Loss: 1.079 Test Acc: 0.639
Validation loss decreased (-0.583321 --> -0.638878).  Saving model ...
Epoch: 14 cost time: 0.8978271484375
Epoch: 14, Steps: 12 | Train Loss: 0.880 Vali Loss: 0.989 Vali Acc: 0.667 Test Loss: 0.989 Test Acc: 0.667
Validation loss decreased (-0.638878 --> -0.666657).  Saving model ...
Epoch: 15 cost time: 1.236804723739624
Epoch: 15, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.875 Vali Acc: 0.667 Test Loss: 0.875 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 16 cost time: 1.0601084232330322
Epoch: 16, Steps: 12 | Train Loss: 0.715 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.666658 --> -0.744436).  Saving model ...
Epoch: 17 cost time: 1.0674338340759277
Epoch: 17, Steps: 12 | Train Loss: 0.567 Vali Loss: 0.757 Vali Acc: 0.744 Test Loss: 0.757 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 18 cost time: 1.2025320529937744
Epoch: 18, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.728 Vali Acc: 0.750 Test Loss: 0.728 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 19 cost time: 0.9731240272521973
Epoch: 19, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.711 Vali Acc: 0.756 Test Loss: 0.711 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 20 cost time: 1.140916347503662
Epoch: 20, Steps: 12 | Train Loss: 0.402 Vali Loss: 0.668 Vali Acc: 0.761 Test Loss: 0.668 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 21 cost time: 1.0660099983215332
Epoch: 21, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.733 Vali Acc: 0.783 Test Loss: 0.733 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783326).  Saving model ...
Epoch: 22 cost time: 1.1857576370239258
Epoch: 22, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.675 Vali Acc: 0.744 Test Loss: 0.675 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9487111568450928
Epoch: 23, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 24 cost time: 1.1915724277496338
Epoch: 24, Steps: 12 | Train Loss: 0.295 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1929969787597656
Epoch: 25, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.689 Vali Acc: 0.783 Test Loss: 0.689 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9796311855316162
Epoch: 26, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.664 Vali Acc: 0.756 Test Loss: 0.664 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9741337299346924
Epoch: 27, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 28 cost time: 0.8520770072937012
Epoch: 28, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.659 Vali Acc: 0.772 Test Loss: 0.659 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0907227993011475
Epoch: 29, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.673 Vali Acc: 0.806 Test Loss: 0.673 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 1.0510492324829102
Epoch: 30, Steps: 12 | Train Loss: 0.208 Vali Loss: 0.698 Vali Acc: 0.822 Test Loss: 0.698 Test Acc: 0.822
Validation loss decreased (-0.805549 --> -0.822215).  Saving model ...
Epoch: 31 cost time: 0.9886696338653564
Epoch: 31, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2051372528076172
Epoch: 32, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2008233070373535
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.697 Vali Acc: 0.772 Test Loss: 0.697 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8720648288726807
Epoch: 34, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.067694902420044
Epoch: 35, Steps: 12 | Train Loss: 0.089 Vali Loss: 0.707 Vali Acc: 0.806 Test Loss: 0.707 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1706831455230713
Epoch: 36, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.816 Vali Acc: 0.794 Test Loss: 0.816 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1324787139892578
Epoch: 37, Steps: 12 | Train Loss: 0.098 Vali Loss: 0.797 Vali Acc: 0.794 Test Loss: 0.797 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.4039905071258545
Epoch: 38, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.706 Vali Acc: 0.817 Test Loss: 0.706 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.423905611038208
Epoch: 39, Steps: 12 | Train Loss: 0.067 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.124772310256958
Epoch: 40, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.863 Vali Acc: 0.800 Test Loss: 0.863 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 107666
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1696815490722656
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.701 Vali Acc: 0.089 Test Loss: 2.701 Test Acc: 0.089
Validation loss decreased (inf --> -0.088862).  Saving model ...
Epoch: 2 cost time: 1.4434680938720703
Epoch: 2, Steps: 12 | Train Loss: 2.774 Vali Loss: 2.657 Vali Acc: 0.078 Test Loss: 2.657 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4300127029418945
Epoch: 3, Steps: 12 | Train Loss: 2.708 Vali Loss: 2.601 Vali Acc: 0.122 Test Loss: 2.601 Test Acc: 0.122
Validation loss decreased (-0.088862 --> -0.122196).  Saving model ...
Epoch: 4 cost time: 1.1002442836761475
Epoch: 4, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.530 Vali Acc: 0.156 Test Loss: 2.530 Test Acc: 0.156
Validation loss decreased (-0.122196 --> -0.155530).  Saving model ...
Epoch: 5 cost time: 1.089406967163086
Epoch: 5, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.440 Vali Acc: 0.222 Test Loss: 2.440 Test Acc: 0.222
Validation loss decreased (-0.155530 --> -0.222198).  Saving model ...
Epoch: 6 cost time: 1.3200104236602783
Epoch: 6, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.316 Vali Acc: 0.317 Test Loss: 2.316 Test Acc: 0.317
Validation loss decreased (-0.222198 --> -0.316644).  Saving model ...
Epoch: 7 cost time: 1.3599262237548828
Epoch: 7, Steps: 12 | Train Loss: 2.293 Vali Loss: 2.155 Vali Acc: 0.372 Test Loss: 2.155 Test Acc: 0.372
Validation loss decreased (-0.316644 --> -0.372201).  Saving model ...
Epoch: 8 cost time: 1.1744933128356934
Epoch: 8, Steps: 12 | Train Loss: 2.081 Vali Loss: 1.946 Vali Acc: 0.472 Test Loss: 1.946 Test Acc: 0.472
Validation loss decreased (-0.372201 --> -0.472203).  Saving model ...
Epoch: 9 cost time: 1.3168251514434814
Epoch: 9, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.685 Vali Acc: 0.539 Test Loss: 1.685 Test Acc: 0.539
Validation loss decreased (-0.472203 --> -0.538872).  Saving model ...
Epoch: 10 cost time: 1.3810501098632812
Epoch: 10, Steps: 12 | Train Loss: 1.513 Vali Loss: 1.453 Vali Acc: 0.594 Test Loss: 1.453 Test Acc: 0.594
Validation loss decreased (-0.538872 --> -0.594430).  Saving model ...
Epoch: 11 cost time: 0.9364907741546631
Epoch: 11, Steps: 12 | Train Loss: 1.216 Vali Loss: 1.264 Vali Acc: 0.639 Test Loss: 1.264 Test Acc: 0.639
Validation loss decreased (-0.594430 --> -0.638876).  Saving model ...
Epoch: 12 cost time: 1.0272173881530762
Epoch: 12, Steps: 12 | Train Loss: 1.025 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.638876 --> -0.677767).  Saving model ...
Epoch: 13 cost time: 0.9387843608856201
Epoch: 13, Steps: 12 | Train Loss: 0.861 Vali Loss: 1.005 Vali Acc: 0.694 Test Loss: 1.005 Test Acc: 0.694
Validation loss decreased (-0.677767 --> -0.694434).  Saving model ...
Epoch: 14 cost time: 1.224092721939087
Epoch: 14, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.899 Vali Acc: 0.706 Test Loss: 0.899 Test Acc: 0.706
Validation loss decreased (-0.694434 --> -0.705547).  Saving model ...
Epoch: 15 cost time: 1.2106192111968994
Epoch: 15, Steps: 12 | Train Loss: 0.587 Vali Loss: 0.838 Vali Acc: 0.700 Test Loss: 0.838 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0556213855743408
Epoch: 16, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.783 Vali Acc: 0.756 Test Loss: 0.783 Test Acc: 0.756
Validation loss decreased (-0.705547 --> -0.755548).  Saving model ...
Epoch: 17 cost time: 0.9991288185119629
Epoch: 17, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0336196422576904
Epoch: 18, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.732 Vali Acc: 0.761 Test Loss: 0.732 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 19 cost time: 0.9781999588012695
Epoch: 19, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9565527439117432
Epoch: 20, Steps: 12 | Train Loss: 0.339 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788882).  Saving model ...
Epoch: 21 cost time: 1.0155723094940186
Epoch: 21, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.665 Vali Acc: 0.800 Test Loss: 0.665 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 22 cost time: 1.0924971103668213
Epoch: 22, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.644 Vali Acc: 0.778 Test Loss: 0.644 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1982519626617432
Epoch: 23, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.707 Vali Acc: 0.794 Test Loss: 0.707 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6387698650360107
Epoch: 24, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1621465682983398
Epoch: 25, Steps: 12 | Train Loss: 0.173 Vali Loss: 0.819 Vali Acc: 0.756 Test Loss: 0.819 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.468925952911377
Epoch: 26, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.689 Vali Acc: 0.772 Test Loss: 0.689 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0228395462036133
Epoch: 27, Steps: 12 | Train Loss: 0.145 Vali Loss: 0.755 Vali Acc: 0.806 Test Loss: 0.755 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 28 cost time: 1.0167977809906006
Epoch: 28, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.797 Vali Acc: 0.772 Test Loss: 0.797 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3405499458312988
Epoch: 29, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.749 Vali Acc: 0.806 Test Loss: 0.749 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 30 cost time: 0.8916611671447754
Epoch: 30, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.788 Vali Acc: 0.800 Test Loss: 0.788 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9433984756469727
Epoch: 31, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2136030197143555
Epoch: 32, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.867 Vali Acc: 0.811 Test Loss: 0.867 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811102).  Saving model ...
Epoch: 33 cost time: 1.2711541652679443
Epoch: 33, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.849 Vali Acc: 0.811 Test Loss: 0.849 Test Acc: 0.811
Validation loss decreased (-0.811102 --> -0.811103).  Saving model ...
Epoch: 34 cost time: 1.0920393466949463
Epoch: 34, Steps: 12 | Train Loss: 0.041 Vali Loss: 0.895 Vali Acc: 0.783 Test Loss: 0.895 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.2004599571228027
Epoch: 35, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.978 Vali Acc: 0.811 Test Loss: 0.978 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.0211122035980225
Epoch: 36, Steps: 12 | Train Loss: 0.093 Vali Loss: 0.975 Vali Acc: 0.783 Test Loss: 0.975 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9569973945617676
Epoch: 37, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.020 Vali Acc: 0.800 Test Loss: 1.020 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.244999647140503
Epoch: 38, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.073 Vali Acc: 0.783 Test Loss: 1.073 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9201858043670654
Epoch: 39, Steps: 12 | Train Loss: 0.065 Vali Loss: 1.096 Vali Acc: 0.811 Test Loss: 1.096 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.1969273090362549
Epoch: 40, Steps: 12 | Train Loss: 0.038 Vali Loss: 1.085 Vali Acc: 0.789 Test Loss: 1.085 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.2307119369506836
Epoch: 41, Steps: 12 | Train Loss: 0.018 Vali Loss: 1.089 Vali Acc: 0.800 Test Loss: 1.089 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.1665706634521484
Epoch: 42, Steps: 12 | Train Loss: 0.030 Vali Loss: 1.157 Vali Acc: 0.794 Test Loss: 1.157 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.340893030166626
Epoch: 43, Steps: 12 | Train Loss: 0.014 Vali Loss: 1.185 Vali Acc: 0.778 Test Loss: 1.185 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 107399
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1334590911865234
Epoch: 1, Steps: 12 | Train Loss: 2.863 Vali Loss: 2.848 Vali Acc: 0.078 Test Loss: 2.848 Test Acc: 0.078
Validation loss decreased (inf --> -0.077749).  Saving model ...
Epoch: 2 cost time: 0.8511240482330322
Epoch: 2, Steps: 12 | Train Loss: 2.828 Vali Loss: 2.793 Vali Acc: 0.083 Test Loss: 2.793 Test Acc: 0.083
Validation loss decreased (-0.077749 --> -0.083305).  Saving model ...
Epoch: 3 cost time: 0.7910637855529785
Epoch: 3, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.721 Vali Acc: 0.111 Test Loss: 2.721 Test Acc: 0.111
Validation loss decreased (-0.083305 --> -0.111084).  Saving model ...
Epoch: 4 cost time: 0.7470419406890869
Epoch: 4, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.630 Vali Acc: 0.128 Test Loss: 2.630 Test Acc: 0.128
Validation loss decreased (-0.111084 --> -0.127751).  Saving model ...
Epoch: 5 cost time: 0.892791748046875
Epoch: 5, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.503 Vali Acc: 0.178 Test Loss: 2.503 Test Acc: 0.178
Validation loss decreased (-0.127751 --> -0.177753).  Saving model ...
Epoch: 6 cost time: 0.763577938079834
Epoch: 6, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.317 Vali Acc: 0.333 Test Loss: 2.317 Test Acc: 0.333
Validation loss decreased (-0.177753 --> -0.333310).  Saving model ...
Epoch: 7 cost time: 0.8539276123046875
Epoch: 7, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.071 Vali Acc: 0.333 Test Loss: 2.071 Test Acc: 0.333
Validation loss decreased (-0.333310 --> -0.333313).  Saving model ...
Epoch: 8 cost time: 1.1180179119110107
Epoch: 8, Steps: 12 | Train Loss: 1.903 Vali Loss: 1.774 Vali Acc: 0.406 Test Loss: 1.774 Test Acc: 0.406
Validation loss decreased (-0.333313 --> -0.405538).  Saving model ...
Epoch: 9 cost time: 0.9009425640106201
Epoch: 9, Steps: 12 | Train Loss: 1.504 Vali Loss: 1.474 Vali Acc: 0.550 Test Loss: 1.474 Test Acc: 0.550
Validation loss decreased (-0.405538 --> -0.549985).  Saving model ...
Epoch: 10 cost time: 1.0163204669952393
Epoch: 10, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.231 Vali Acc: 0.639 Test Loss: 1.231 Test Acc: 0.639
Validation loss decreased (-0.549985 --> -0.638877).  Saving model ...
Epoch: 11 cost time: 0.8114621639251709
Epoch: 11, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.057 Vali Acc: 0.661 Test Loss: 1.057 Test Acc: 0.661
Validation loss decreased (-0.638877 --> -0.661101).  Saving model ...
Epoch: 12 cost time: 0.956364631652832
Epoch: 12, Steps: 12 | Train Loss: 0.884 Vali Loss: 0.973 Vali Acc: 0.622 Test Loss: 0.973 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.03287935256958
Epoch: 13, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.910 Vali Acc: 0.700 Test Loss: 0.910 Test Acc: 0.700
Validation loss decreased (-0.661101 --> -0.699991).  Saving model ...
Epoch: 14 cost time: 0.912689208984375
Epoch: 14, Steps: 12 | Train Loss: 0.643 Vali Loss: 0.810 Vali Acc: 0.722 Test Loss: 0.810 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 15 cost time: 0.977346658706665
Epoch: 15, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.787 Vali Acc: 0.744 Test Loss: 0.787 Test Acc: 0.744
Validation loss decreased (-0.722214 --> -0.744437).  Saving model ...
Epoch: 16 cost time: 1.0058722496032715
Epoch: 16, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.749 Vali Acc: 0.739 Test Loss: 0.749 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9993414878845215
Epoch: 17, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.699 Vali Acc: 0.728 Test Loss: 0.699 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.412384271621704
Epoch: 18, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.751 Vali Acc: 0.717 Test Loss: 0.751 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1194806098937988
Epoch: 19, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.656 Vali Acc: 0.778 Test Loss: 0.656 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777771).  Saving model ...
Epoch: 20 cost time: 1.0895631313323975
Epoch: 20, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.741 Vali Acc: 0.744 Test Loss: 0.741 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.005333423614502
Epoch: 21, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.637 Vali Acc: 0.778 Test Loss: 0.637 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 22 cost time: 0.9247846603393555
Epoch: 22, Steps: 12 | Train Loss: 0.296 Vali Loss: 0.690 Vali Acc: 0.767 Test Loss: 0.690 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9122281074523926
Epoch: 23, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.695 Vali Acc: 0.783 Test Loss: 0.695 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783326).  Saving model ...
Epoch: 24 cost time: 1.0706257820129395
Epoch: 24, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.656 Vali Acc: 0.794 Test Loss: 0.656 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 1.0398919582366943
Epoch: 25, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1241836547851562
Epoch: 26, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.683 Vali Acc: 0.772 Test Loss: 0.683 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8337762355804443
Epoch: 27, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.734 Vali Acc: 0.778 Test Loss: 0.734 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8199219703674316
Epoch: 28, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.702 Vali Acc: 0.794 Test Loss: 0.702 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0852782726287842
Epoch: 29, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.742 Vali Acc: 0.778 Test Loss: 0.742 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0411617755889893
Epoch: 30, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.730 Vali Acc: 0.772 Test Loss: 0.730 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1283931732177734
Epoch: 31, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.743 Vali Acc: 0.772 Test Loss: 0.743 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.0826654434204102
Epoch: 32, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.820 Vali Acc: 0.772 Test Loss: 0.820 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8166937828063965
Epoch: 33, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.747 Vali Acc: 0.789 Test Loss: 0.747 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9386701583862305
Epoch: 34, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.831 Vali Acc: 0.761 Test Loss: 0.831 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 107046
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.1319408416748047
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.790 Vali Acc: 0.083 Test Loss: 2.790 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 0.8272936344146729
Epoch: 2, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.751 Vali Acc: 0.100 Test Loss: 2.751 Test Acc: 0.100
Validation loss decreased (-0.083305 --> -0.099972).  Saving model ...
Epoch: 3 cost time: 0.935713529586792
Epoch: 3, Steps: 12 | Train Loss: 2.772 Vali Loss: 2.698 Vali Acc: 0.133 Test Loss: 2.698 Test Acc: 0.133
Validation loss decreased (-0.099972 --> -0.133306).  Saving model ...
Epoch: 4 cost time: 1.1929802894592285
Epoch: 4, Steps: 12 | Train Loss: 2.716 Vali Loss: 2.632 Vali Acc: 0.156 Test Loss: 2.632 Test Acc: 0.156
Validation loss decreased (-0.133306 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 0.8771238327026367
Epoch: 5, Steps: 12 | Train Loss: 2.637 Vali Loss: 2.536 Vali Acc: 0.206 Test Loss: 2.536 Test Acc: 0.206
Validation loss decreased (-0.155529 --> -0.205530).  Saving model ...
Epoch: 6 cost time: 1.0307092666625977
Epoch: 6, Steps: 12 | Train Loss: 2.525 Vali Loss: 2.396 Vali Acc: 0.294 Test Loss: 2.396 Test Acc: 0.294
Validation loss decreased (-0.205530 --> -0.294420).  Saving model ...
Epoch: 7 cost time: 1.063927412033081
Epoch: 7, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.190 Vali Acc: 0.328 Test Loss: 2.190 Test Acc: 0.328
Validation loss decreased (-0.294420 --> -0.327756).  Saving model ...
Epoch: 8 cost time: 1.022428035736084
Epoch: 8, Steps: 12 | Train Loss: 2.132 Vali Loss: 1.960 Vali Acc: 0.333 Test Loss: 1.960 Test Acc: 0.333
Validation loss decreased (-0.327756 --> -0.333314).  Saving model ...
Epoch: 9 cost time: 1.0436906814575195
Epoch: 9, Steps: 12 | Train Loss: 1.840 Vali Loss: 1.735 Vali Acc: 0.411 Test Loss: 1.735 Test Acc: 0.411
Validation loss decreased (-0.333314 --> -0.411094).  Saving model ...
Epoch: 10 cost time: 0.7874798774719238
Epoch: 10, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.496 Vali Acc: 0.494 Test Loss: 1.496 Test Acc: 0.494
Validation loss decreased (-0.411094 --> -0.494429).  Saving model ...
Epoch: 11 cost time: 0.7992455959320068
Epoch: 11, Steps: 12 | Train Loss: 1.312 Vali Loss: 1.275 Vali Acc: 0.628 Test Loss: 1.275 Test Acc: 0.628
Validation loss decreased (-0.494429 --> -0.627765).  Saving model ...
Epoch: 12 cost time: 0.8370966911315918
Epoch: 12, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.107 Vali Acc: 0.656 Test Loss: 1.107 Test Acc: 0.656
Validation loss decreased (-0.627765 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 0.8245334625244141
Epoch: 13, Steps: 12 | Train Loss: 1.028 Vali Loss: 1.014 Vali Acc: 0.650 Test Loss: 1.014 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1256237030029297
Epoch: 14, Steps: 12 | Train Loss: 0.836 Vali Loss: 0.952 Vali Acc: 0.706 Test Loss: 0.952 Test Acc: 0.706
Validation loss decreased (-0.655544 --> -0.705546).  Saving model ...
Epoch: 15 cost time: 1.4221630096435547
Epoch: 15, Steps: 12 | Train Loss: 0.769 Vali Loss: 0.858 Vali Acc: 0.678 Test Loss: 0.858 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0476539134979248
Epoch: 16, Steps: 12 | Train Loss: 0.723 Vali Loss: 0.799 Vali Acc: 0.689 Test Loss: 0.799 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7413477897644043
Epoch: 17, Steps: 12 | Train Loss: 0.661 Vali Loss: 0.789 Vali Acc: 0.694 Test Loss: 0.789 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9062519073486328
Epoch: 18, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.722 Vali Acc: 0.728 Test Loss: 0.722 Test Acc: 0.728
Validation loss decreased (-0.705546 --> -0.727771).  Saving model ...
Epoch: 19 cost time: 1.2483830451965332
Epoch: 19, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.688 Vali Acc: 0.772 Test Loss: 0.688 Test Acc: 0.772
Validation loss decreased (-0.727771 --> -0.772215).  Saving model ...
Epoch: 20 cost time: 0.9073159694671631
Epoch: 20, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.635 Vali Acc: 0.739 Test Loss: 0.635 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4796338081359863
Epoch: 21, Steps: 12 | Train Loss: 0.407 Vali Loss: 0.600 Vali Acc: 0.767 Test Loss: 0.600 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9592924118041992
Epoch: 22, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.563 Vali Acc: 0.811 Test Loss: 0.563 Test Acc: 0.811
Validation loss decreased (-0.772215 --> -0.811105).  Saving model ...
Epoch: 23 cost time: 1.0403311252593994
Epoch: 23, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.556 Vali Acc: 0.794 Test Loss: 0.556 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2525238990783691
Epoch: 24, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.574 Vali Acc: 0.794 Test Loss: 0.574 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9747459888458252
Epoch: 25, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9014577865600586
Epoch: 26, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0583760738372803
Epoch: 27, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.682 Vali Acc: 0.744 Test Loss: 0.682 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1175312995910645
Epoch: 28, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.724 Vali Acc: 0.767 Test Loss: 0.724 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9685375690460205
Epoch: 29, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.580 Vali Acc: 0.778 Test Loss: 0.580 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0021989345550537
Epoch: 30, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.565 Vali Acc: 0.794 Test Loss: 0.565 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4595348834991455
Epoch: 31, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.591 Vali Acc: 0.800 Test Loss: 0.591 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5327723026275635
Epoch: 32, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 107063
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.3452625274658203
Epoch: 1, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.749 Vali Acc: 0.033 Test Loss: 2.749 Test Acc: 0.033
Validation loss decreased (inf --> -0.033306).  Saving model ...
Epoch: 2 cost time: 1.170874834060669
Epoch: 2, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.718 Vali Acc: 0.050 Test Loss: 2.718 Test Acc: 0.050
Validation loss decreased (-0.033306 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 0.8924577236175537
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.671 Vali Acc: 0.083 Test Loss: 2.671 Test Acc: 0.083
Validation loss decreased (-0.049973 --> -0.083307).  Saving model ...
Epoch: 4 cost time: 1.194918155670166
Epoch: 4, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.617 Vali Acc: 0.128 Test Loss: 2.617 Test Acc: 0.128
Validation loss decreased (-0.083307 --> -0.127752).  Saving model ...
Epoch: 5 cost time: 1.2067785263061523
Epoch: 5, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.552 Vali Acc: 0.244 Test Loss: 2.552 Test Acc: 0.244
Validation loss decreased (-0.127752 --> -0.244419).  Saving model ...
Epoch: 6 cost time: 1.257166862487793
Epoch: 6, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.461 Vali Acc: 0.356 Test Loss: 2.461 Test Acc: 0.356
Validation loss decreased (-0.244419 --> -0.355531).  Saving model ...
Epoch: 7 cost time: 0.7636945247650146
Epoch: 7, Steps: 12 | Train Loss: 2.346 Vali Loss: 2.322 Vali Acc: 0.383 Test Loss: 2.322 Test Acc: 0.383
Validation loss decreased (-0.355531 --> -0.383310).  Saving model ...
Epoch: 8 cost time: 1.202099084854126
Epoch: 8, Steps: 12 | Train Loss: 2.131 Vali Loss: 2.116 Vali Acc: 0.428 Test Loss: 2.116 Test Acc: 0.428
Validation loss decreased (-0.383310 --> -0.427757).  Saving model ...
Epoch: 9 cost time: 0.9937875270843506
Epoch: 9, Steps: 12 | Train Loss: 1.897 Vali Loss: 1.851 Vali Acc: 0.450 Test Loss: 1.851 Test Acc: 0.450
Validation loss decreased (-0.427757 --> -0.449981).  Saving model ...
Epoch: 10 cost time: 0.970026969909668
Epoch: 10, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.618 Vali Acc: 0.500 Test Loss: 1.618 Test Acc: 0.500
Validation loss decreased (-0.449981 --> -0.499984).  Saving model ...
Epoch: 11 cost time: 1.547705888748169
Epoch: 11, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.399 Vali Acc: 0.589 Test Loss: 1.399 Test Acc: 0.589
Validation loss decreased (-0.499984 --> -0.588875).  Saving model ...
Epoch: 12 cost time: 0.9759280681610107
Epoch: 12, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.249 Vali Acc: 0.578 Test Loss: 1.249 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.091106653213501
Epoch: 13, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.082 Vali Acc: 0.644 Test Loss: 1.082 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644434).  Saving model ...
Epoch: 14 cost time: 1.118060827255249
Epoch: 14, Steps: 12 | Train Loss: 0.762 Vali Loss: 0.993 Vali Acc: 0.656 Test Loss: 0.993 Test Acc: 0.656
Validation loss decreased (-0.644434 --> -0.655546).  Saving model ...
Epoch: 15 cost time: 1.1111688613891602
Epoch: 15, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.940 Vali Acc: 0.667 Test Loss: 0.940 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 16 cost time: 0.8053703308105469
Epoch: 16, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.832 Vali Acc: 0.700 Test Loss: 0.832 Test Acc: 0.700
Validation loss decreased (-0.666657 --> -0.699992).  Saving model ...
Epoch: 17 cost time: 0.9903111457824707
Epoch: 17, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.790 Vali Acc: 0.717 Test Loss: 0.790 Test Acc: 0.717
Validation loss decreased (-0.699992 --> -0.716659).  Saving model ...
Epoch: 18 cost time: 1.3760578632354736
Epoch: 18, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.753 Vali Acc: 0.756 Test Loss: 0.753 Test Acc: 0.756
Validation loss decreased (-0.716659 --> -0.755548).  Saving model ...
Epoch: 19 cost time: 1.016528844833374
Epoch: 19, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.672 Vali Acc: 0.772 Test Loss: 0.672 Test Acc: 0.772
Validation loss decreased (-0.755548 --> -0.772216).  Saving model ...
Epoch: 20 cost time: 1.2386512756347656
Epoch: 20, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.653 Vali Acc: 0.756 Test Loss: 0.653 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0679740905761719
Epoch: 21, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.646 Vali Acc: 0.772 Test Loss: 0.646 Test Acc: 0.772
Validation loss decreased (-0.772216 --> -0.772216).  Saving model ...
Epoch: 22 cost time: 0.8943946361541748
Epoch: 22, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.703 Vali Acc: 0.750 Test Loss: 0.703 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0316870212554932
Epoch: 23, Steps: 12 | Train Loss: 0.272 Vali Loss: 0.602 Vali Acc: 0.761 Test Loss: 0.602 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7709171772003174
Epoch: 24, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.637 Vali Acc: 0.794 Test Loss: 0.637 Test Acc: 0.794
Validation loss decreased (-0.772216 --> -0.794438).  Saving model ...
Epoch: 25 cost time: 0.9473979473114014
Epoch: 25, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.662 Vali Acc: 0.772 Test Loss: 0.662 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.176680326461792
Epoch: 26, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9863734245300293
Epoch: 27, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.602 Vali Acc: 0.778 Test Loss: 0.602 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1541876792907715
Epoch: 28, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.142960548400879
Epoch: 29, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1110875606536865
Epoch: 30, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.709 Vali Acc: 0.806 Test Loss: 0.709 Test Acc: 0.806
Validation loss decreased (-0.794438 --> -0.805548).  Saving model ...
Epoch: 31 cost time: 1.1196479797363281
Epoch: 31, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.758 Vali Acc: 0.817 Test Loss: 0.758 Test Acc: 0.817
Validation loss decreased (-0.805548 --> -0.816659).  Saving model ...
Epoch: 32 cost time: 1.105224609375
Epoch: 32, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.809 Vali Acc: 0.794 Test Loss: 0.809 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9304890632629395
Epoch: 33, Steps: 12 | Train Loss: 0.141 Vali Loss: 0.686 Vali Acc: 0.828 Test Loss: 0.686 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827771).  Saving model ...
Epoch: 34 cost time: 0.8327558040618896
Epoch: 34, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.737 Vali Acc: 0.806 Test Loss: 0.737 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0580987930297852
Epoch: 35, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.823 Vali Acc: 0.828 Test Loss: 0.823 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.010213851928711
Epoch: 36, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.2033047676086426
Epoch: 37, Steps: 12 | Train Loss: 0.122 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.102302074432373
Epoch: 38, Steps: 12 | Train Loss: 0.104 Vali Loss: 0.676 Vali Acc: 0.833 Test Loss: 0.676 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 39 cost time: 0.9579226970672607
Epoch: 39, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.915 Vali Acc: 0.783 Test Loss: 0.915 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1664674282073975
Epoch: 40, Steps: 12 | Train Loss: 0.072 Vali Loss: 0.682 Vali Acc: 0.806 Test Loss: 0.682 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8470511436462402
Epoch: 41, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.903 Vali Acc: 0.783 Test Loss: 0.903 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.3108389377593994
Epoch: 42, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.945 Vali Acc: 0.817 Test Loss: 0.945 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8631975650787354
Epoch: 43, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.954 Vali Acc: 0.789 Test Loss: 0.954 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9893889427185059
Epoch: 44, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.975 Vali Acc: 0.822 Test Loss: 0.975 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.1942322254180908
Epoch: 45, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.871 Vali Acc: 0.806 Test Loss: 0.871 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.3062045574188232
Epoch: 46, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.938 Vali Acc: 0.811 Test Loss: 0.938 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9210538864135742
Epoch: 47, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.918 Vali Acc: 0.839 Test Loss: 0.918 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838880).  Saving model ...
Epoch: 48 cost time: 0.8134419918060303
Epoch: 48, Steps: 12 | Train Loss: 0.037 Vali Loss: 1.168 Vali Acc: 0.772 Test Loss: 1.168 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8951828479766846
Epoch: 49, Steps: 12 | Train Loss: 0.041 Vali Loss: 1.148 Vali Acc: 0.789 Test Loss: 1.148 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7343142032623291
Epoch: 50, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.088 Vali Acc: 0.828 Test Loss: 1.088 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9337658882141113
Epoch: 51, Steps: 12 | Train Loss: 0.024 Vali Loss: 1.025 Vali Acc: 0.811 Test Loss: 1.025 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8205134868621826
Epoch: 52, Steps: 12 | Train Loss: 0.011 Vali Loss: 1.046 Vali Acc: 0.817 Test Loss: 1.046 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8326511383056641
Epoch: 53, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.058 Vali Acc: 0.817 Test Loss: 1.058 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8767657279968262
Epoch: 54, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.086 Vali Acc: 0.828 Test Loss: 1.086 Test Acc: 0.828
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8535053730010986
Epoch: 55, Steps: 12 | Train Loss: 0.006 Vali Loss: 1.107 Vali Acc: 0.839 Test Loss: 1.107 Test Acc: 0.839
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.9031727313995361
Epoch: 56, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.097 Vali Acc: 0.839 Test Loss: 1.097 Test Acc: 0.839
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.999762773513794
Epoch: 57, Steps: 12 | Train Loss: 0.003 Vali Loss: 1.116 Vali Acc: 0.839 Test Loss: 1.116 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm512_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 106846
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.913637638092041
Epoch: 1, Steps: 12 | Train Loss: 2.808 Vali Loss: 2.807 Vali Acc: 0.039 Test Loss: 2.807 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.8102321624755859
Epoch: 2, Steps: 12 | Train Loss: 2.747 Vali Loss: 2.777 Vali Acc: 0.039 Test Loss: 2.777 Test Acc: 0.039
Validation loss decreased (-0.038861 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 1.0745007991790771
Epoch: 3, Steps: 12 | Train Loss: 2.753 Vali Loss: 2.738 Vali Acc: 0.061 Test Loss: 2.738 Test Acc: 0.061
Validation loss decreased (-0.038861 --> -0.061084).  Saving model ...
Epoch: 4 cost time: 0.9306797981262207
Epoch: 4, Steps: 12 | Train Loss: 2.706 Vali Loss: 2.694 Vali Acc: 0.078 Test Loss: 2.694 Test Acc: 0.078
Validation loss decreased (-0.061084 --> -0.077751).  Saving model ...
Epoch: 5 cost time: 0.9817395210266113
Epoch: 5, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.645 Vali Acc: 0.100 Test Loss: 2.645 Test Acc: 0.100
Validation loss decreased (-0.077751 --> -0.099974).  Saving model ...
Epoch: 6 cost time: 1.1219332218170166
Epoch: 6, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.590 Vali Acc: 0.200 Test Loss: 2.590 Test Acc: 0.200
Validation loss decreased (-0.099974 --> -0.199974).  Saving model ...
Epoch: 7 cost time: 0.7064907550811768
Epoch: 7, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.534 Vali Acc: 0.267 Test Loss: 2.534 Test Acc: 0.267
Validation loss decreased (-0.199974 --> -0.266641).  Saving model ...
Epoch: 8 cost time: 0.952256441116333
Epoch: 8, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.462 Vali Acc: 0.272 Test Loss: 2.462 Test Acc: 0.272
Validation loss decreased (-0.266641 --> -0.272198).  Saving model ...
Epoch: 9 cost time: 0.7971715927124023
Epoch: 9, Steps: 12 | Train Loss: 2.400 Vali Loss: 2.388 Vali Acc: 0.322 Test Loss: 2.388 Test Acc: 0.322
Validation loss decreased (-0.272198 --> -0.322198).  Saving model ...
Epoch: 10 cost time: 0.8299868106842041
Epoch: 10, Steps: 12 | Train Loss: 2.331 Vali Loss: 2.301 Vali Acc: 0.372 Test Loss: 2.301 Test Acc: 0.372
Validation loss decreased (-0.322198 --> -0.372199).  Saving model ...
Epoch: 11 cost time: 0.7689964771270752
Epoch: 11, Steps: 12 | Train Loss: 2.234 Vali Loss: 2.203 Vali Acc: 0.394 Test Loss: 2.203 Test Acc: 0.394
Validation loss decreased (-0.372199 --> -0.394422).  Saving model ...
Epoch: 12 cost time: 0.9025568962097168
Epoch: 12, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.103 Vali Acc: 0.417 Test Loss: 2.103 Test Acc: 0.417
Validation loss decreased (-0.394422 --> -0.416646).  Saving model ...
Epoch: 13 cost time: 0.9847688674926758
Epoch: 13, Steps: 12 | Train Loss: 1.945 Vali Loss: 1.987 Vali Acc: 0.461 Test Loss: 1.987 Test Acc: 0.461
Validation loss decreased (-0.416646 --> -0.461091).  Saving model ...
Epoch: 14 cost time: 1.3301260471343994
Epoch: 14, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.862 Vali Acc: 0.467 Test Loss: 1.862 Test Acc: 0.467
Validation loss decreased (-0.461091 --> -0.466648).  Saving model ...
Epoch: 15 cost time: 0.8548417091369629
Epoch: 15, Steps: 12 | Train Loss: 1.723 Vali Loss: 1.727 Vali Acc: 0.489 Test Loss: 1.727 Test Acc: 0.489
Validation loss decreased (-0.466648 --> -0.488872).  Saving model ...
Epoch: 16 cost time: 0.8488190174102783
Epoch: 16, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.580 Vali Acc: 0.561 Test Loss: 1.580 Test Acc: 0.561
Validation loss decreased (-0.488872 --> -0.561095).  Saving model ...
Epoch: 17 cost time: 0.9034411907196045
Epoch: 17, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.451 Vali Acc: 0.528 Test Loss: 1.451 Test Acc: 0.528
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9258835315704346
Epoch: 18, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.316 Vali Acc: 0.583 Test Loss: 1.316 Test Acc: 0.583
Validation loss decreased (-0.561095 --> -0.583320).  Saving model ...
Epoch: 19 cost time: 1.0039644241333008
Epoch: 19, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.206 Vali Acc: 0.600 Test Loss: 1.206 Test Acc: 0.600
Validation loss decreased (-0.583320 --> -0.599988).  Saving model ...
Epoch: 20 cost time: 0.8066818714141846
Epoch: 20, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.090 Vali Acc: 0.633 Test Loss: 1.090 Test Acc: 0.633
Validation loss decreased (-0.599988 --> -0.633322).  Saving model ...
Epoch: 21 cost time: 1.0477983951568604
Epoch: 21, Steps: 12 | Train Loss: 0.826 Vali Loss: 0.987 Vali Acc: 0.644 Test Loss: 0.987 Test Acc: 0.644
Validation loss decreased (-0.633322 --> -0.644435).  Saving model ...
Epoch: 22 cost time: 0.9755959510803223
Epoch: 22, Steps: 12 | Train Loss: 0.689 Vali Loss: 0.925 Vali Acc: 0.678 Test Loss: 0.925 Test Acc: 0.678
Validation loss decreased (-0.644435 --> -0.677769).  Saving model ...
Epoch: 23 cost time: 0.9358594417572021
Epoch: 23, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.866 Vali Acc: 0.706 Test Loss: 0.866 Test Acc: 0.706
Validation loss decreased (-0.677769 --> -0.705547).  Saving model ...
Epoch: 24 cost time: 1.0734949111938477
Epoch: 24, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.823 Vali Acc: 0.706 Test Loss: 0.823 Test Acc: 0.706
Validation loss decreased (-0.705547 --> -0.705547).  Saving model ...
Epoch: 25 cost time: 0.9450342655181885
Epoch: 25, Steps: 12 | Train Loss: 0.485 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.705547 --> -0.749992).  Saving model ...
Epoch: 26 cost time: 0.7958838939666748
Epoch: 26, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.799 Vali Acc: 0.689 Test Loss: 0.799 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.045954942703247
Epoch: 27, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.758 Vali Acc: 0.744 Test Loss: 0.758 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1194510459899902
Epoch: 28, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.724 Vali Acc: 0.761 Test Loss: 0.724 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761104).  Saving model ...
Epoch: 29 cost time: 1.1682167053222656
Epoch: 29, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.725 Vali Acc: 0.739 Test Loss: 0.725 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8630380630493164
Epoch: 30, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.747 Vali Acc: 0.739 Test Loss: 0.747 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0006258487701416
Epoch: 31, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
Validation loss decreased (-0.761104 --> -0.783327).  Saving model ...
Epoch: 32 cost time: 0.808903694152832
Epoch: 32, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.750 Vali Acc: 0.772 Test Loss: 0.750 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0150833129882812
Epoch: 33, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.745 Vali Acc: 0.772 Test Loss: 0.745 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1004774570465088
Epoch: 34, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.687 Vali Acc: 0.772 Test Loss: 0.687 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0995497703552246
Epoch: 35, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.732 Vali Acc: 0.794 Test Loss: 0.732 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794437).  Saving model ...
Epoch: 36 cost time: 0.9199962615966797
Epoch: 36, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.710 Vali Acc: 0.789 Test Loss: 0.710 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7405197620391846
Epoch: 37, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.732 Vali Acc: 0.783 Test Loss: 0.732 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8725335597991943
Epoch: 38, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.733 Vali Acc: 0.794 Test Loss: 0.733 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.2526228427886963
Epoch: 39, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.744 Vali Acc: 0.822 Test Loss: 0.744 Test Acc: 0.822
Validation loss decreased (-0.794437 --> -0.822215).  Saving model ...
Epoch: 40 cost time: 1.0055410861968994
Epoch: 40, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.756 Vali Acc: 0.800 Test Loss: 0.756 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0715522766113281
Epoch: 41, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.738 Vali Acc: 0.811 Test Loss: 0.738 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9856746196746826
Epoch: 42, Steps: 12 | Train Loss: 0.035 Vali Loss: 0.751 Vali Acc: 0.789 Test Loss: 0.751 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.004377841949463
Epoch: 43, Steps: 12 | Train Loss: 0.036 Vali Loss: 0.764 Vali Acc: 0.817 Test Loss: 0.764 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0751690864562988
Epoch: 44, Steps: 12 | Train Loss: 0.050 Vali Loss: 0.806 Vali Acc: 0.794 Test Loss: 0.806 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.093914270401001
Epoch: 45, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.796 Vali Acc: 0.811 Test Loss: 0.796 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9613816738128662
Epoch: 46, Steps: 12 | Train Loss: 0.039 Vali Loss: 0.835 Vali Acc: 0.811 Test Loss: 0.835 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.9856371879577637
Epoch: 47, Steps: 12 | Train Loss: 0.022 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833325).  Saving model ...
Epoch: 48 cost time: 1.0783286094665527
Epoch: 48, Steps: 12 | Train Loss: 0.021 Vali Loss: 0.888 Vali Acc: 0.822 Test Loss: 0.888 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9155938625335693
Epoch: 49, Steps: 12 | Train Loss: 0.018 Vali Loss: 0.871 Vali Acc: 0.828 Test Loss: 0.871 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.0560133457183838
Epoch: 50, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.871 Vali Acc: 0.817 Test Loss: 0.871 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0123083591461182
Epoch: 51, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.915 Vali Acc: 0.822 Test Loss: 0.915 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8727633953094482
Epoch: 52, Steps: 12 | Train Loss: 0.012 Vali Loss: 0.921 Vali Acc: 0.806 Test Loss: 0.921 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1791081428527832
Epoch: 53, Steps: 12 | Train Loss: 0.015 Vali Loss: 0.928 Vali Acc: 0.822 Test Loss: 0.928 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.115105390548706
Epoch: 54, Steps: 12 | Train Loss: 0.010 Vali Loss: 0.952 Vali Acc: 0.806 Test Loss: 0.952 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.125455379486084
Epoch: 55, Steps: 12 | Train Loss: 0.007 Vali Loss: 0.956 Vali Acc: 0.806 Test Loss: 0.956 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.8280599117279053
Epoch: 56, Steps: 12 | Train Loss: 0.006 Vali Loss: 0.948 Vali Acc: 0.806 Test Loss: 0.948 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.8817620277404785
Epoch: 57, Steps: 12 | Train Loss: 0.011 Vali Loss: 0.974 Vali Acc: 0.806 Test Loss: 0.974 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 32957
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.894426107406616
Epoch: 1, Steps: 12 | Train Loss: 2.827 Vali Loss: 2.862 Vali Acc: 0.044 Test Loss: 2.862 Test Acc: 0.044
Validation loss decreased (inf --> -0.044416).  Saving model ...
Epoch: 2 cost time: 1.0635459423065186
Epoch: 2, Steps: 12 | Train Loss: 2.823 Vali Loss: 2.832 Vali Acc: 0.044 Test Loss: 2.832 Test Acc: 0.044
Validation loss decreased (-0.044416 --> -0.044416).  Saving model ...
Epoch: 3 cost time: 0.8213131427764893
Epoch: 3, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.789 Vali Acc: 0.056 Test Loss: 2.789 Test Acc: 0.056
Validation loss decreased (-0.044416 --> -0.055528).  Saving model ...
Epoch: 4 cost time: 1.1613578796386719
Epoch: 4, Steps: 12 | Train Loss: 2.742 Vali Loss: 2.741 Vali Acc: 0.067 Test Loss: 2.741 Test Acc: 0.067
Validation loss decreased (-0.055528 --> -0.066639).  Saving model ...
Epoch: 5 cost time: 0.9526004791259766
Epoch: 5, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.686 Vali Acc: 0.083 Test Loss: 2.686 Test Acc: 0.083
Validation loss decreased (-0.066639 --> -0.083306).  Saving model ...
Epoch: 6 cost time: 0.7828855514526367
Epoch: 6, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.629 Vali Acc: 0.128 Test Loss: 2.629 Test Acc: 0.128
Validation loss decreased (-0.083306 --> -0.127751).  Saving model ...
Epoch: 7 cost time: 0.8591852188110352
Epoch: 7, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.567 Vali Acc: 0.172 Test Loss: 2.567 Test Acc: 0.172
Validation loss decreased (-0.127751 --> -0.172197).  Saving model ...
Epoch: 8 cost time: 0.8071804046630859
Epoch: 8, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.495 Vali Acc: 0.206 Test Loss: 2.495 Test Acc: 0.206
Validation loss decreased (-0.172197 --> -0.205531).  Saving model ...
Epoch: 9 cost time: 0.8193557262420654
Epoch: 9, Steps: 12 | Train Loss: 2.398 Vali Loss: 2.403 Vali Acc: 0.261 Test Loss: 2.403 Test Acc: 0.261
Validation loss decreased (-0.205531 --> -0.261087).  Saving model ...
Epoch: 10 cost time: 0.7788810729980469
Epoch: 10, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.288 Vali Acc: 0.317 Test Loss: 2.288 Test Acc: 0.317
Validation loss decreased (-0.261087 --> -0.316644).  Saving model ...
Epoch: 11 cost time: 0.9840500354766846
Epoch: 11, Steps: 12 | Train Loss: 2.168 Vali Loss: 2.142 Vali Acc: 0.328 Test Loss: 2.142 Test Acc: 0.328
Validation loss decreased (-0.316644 --> -0.327756).  Saving model ...
Epoch: 12 cost time: 1.1984376907348633
Epoch: 12, Steps: 12 | Train Loss: 1.925 Vali Loss: 1.957 Vali Acc: 0.389 Test Loss: 1.957 Test Acc: 0.389
Validation loss decreased (-0.327756 --> -0.388869).  Saving model ...
Epoch: 13 cost time: 1.0582072734832764
Epoch: 13, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.777 Vali Acc: 0.406 Test Loss: 1.777 Test Acc: 0.406
Validation loss decreased (-0.388869 --> -0.405538).  Saving model ...
Epoch: 14 cost time: 0.9109508991241455
Epoch: 14, Steps: 12 | Train Loss: 1.540 Vali Loss: 1.584 Vali Acc: 0.467 Test Loss: 1.584 Test Acc: 0.467
Validation loss decreased (-0.405538 --> -0.466651).  Saving model ...
Epoch: 15 cost time: 0.8313651084899902
Epoch: 15, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.438 Vali Acc: 0.539 Test Loss: 1.438 Test Acc: 0.539
Validation loss decreased (-0.466651 --> -0.538875).  Saving model ...
Epoch: 16 cost time: 0.9922425746917725
Epoch: 16, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.343 Vali Acc: 0.561 Test Loss: 1.343 Test Acc: 0.561
Validation loss decreased (-0.538875 --> -0.561098).  Saving model ...
Epoch: 17 cost time: 0.8517982959747314
Epoch: 17, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.291 Vali Acc: 0.578 Test Loss: 1.291 Test Acc: 0.578
Validation loss decreased (-0.561098 --> -0.577765).  Saving model ...
Epoch: 18 cost time: 1.0329115390777588
Epoch: 18, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.234 Vali Acc: 0.583 Test Loss: 1.234 Test Acc: 0.583
Validation loss decreased (-0.577765 --> -0.583321).  Saving model ...
Epoch: 19 cost time: 0.9410066604614258
Epoch: 19, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.176 Vali Acc: 0.628 Test Loss: 1.176 Test Acc: 0.628
Validation loss decreased (-0.583321 --> -0.627766).  Saving model ...
Epoch: 20 cost time: 0.917487382888794
Epoch: 20, Steps: 12 | Train Loss: 0.863 Vali Loss: 1.142 Vali Acc: 0.611 Test Loss: 1.142 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9054896831512451
Epoch: 21, Steps: 12 | Train Loss: 0.776 Vali Loss: 1.085 Vali Acc: 0.661 Test Loss: 1.085 Test Acc: 0.661
Validation loss decreased (-0.627766 --> -0.661100).  Saving model ...
Epoch: 22 cost time: 1.0764617919921875
Epoch: 22, Steps: 12 | Train Loss: 0.715 Vali Loss: 1.033 Vali Acc: 0.644 Test Loss: 1.033 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8271830081939697
Epoch: 23, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.994 Vali Acc: 0.678 Test Loss: 0.994 Test Acc: 0.678
Validation loss decreased (-0.661100 --> -0.677768).  Saving model ...
Epoch: 24 cost time: 0.9023787975311279
Epoch: 24, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.952 Vali Acc: 0.672 Test Loss: 0.952 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.046527624130249
Epoch: 25, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.881 Vali Acc: 0.717 Test Loss: 0.881 Test Acc: 0.717
Validation loss decreased (-0.677768 --> -0.716658).  Saving model ...
Epoch: 26 cost time: 0.8821499347686768
Epoch: 26, Steps: 12 | Train Loss: 0.494 Vali Loss: 0.857 Vali Acc: 0.739 Test Loss: 0.857 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 27 cost time: 1.067215919494629
Epoch: 27, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.868 Vali Acc: 0.728 Test Loss: 0.868 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3592514991760254
Epoch: 28, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.823 Vali Acc: 0.744 Test Loss: 0.823 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 29 cost time: 0.9377951622009277
Epoch: 29, Steps: 12 | Train Loss: 0.386 Vali Loss: 0.767 Vali Acc: 0.744 Test Loss: 0.767 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 30 cost time: 1.151491403579712
Epoch: 30, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 31 cost time: 1.2005963325500488
Epoch: 31, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.790 Vali Acc: 0.744 Test Loss: 0.790 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9407577514648438
Epoch: 32, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788881).  Saving model ...
Epoch: 33 cost time: 1.0838477611541748
Epoch: 33, Steps: 12 | Train Loss: 0.324 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.894770622253418
Epoch: 34, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8783755302429199
Epoch: 35, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.796 Vali Acc: 0.744 Test Loss: 0.796 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0555729866027832
Epoch: 36, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.788881 --> -0.799993).  Saving model ...
Epoch: 37 cost time: 1.0184032917022705
Epoch: 37, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0997612476348877
Epoch: 38, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.727 Vali Acc: 0.811 Test Loss: 0.727 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 39 cost time: 1.3891716003417969
Epoch: 39, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.769 Vali Acc: 0.778 Test Loss: 0.769 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0812504291534424
Epoch: 40, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.790 Vali Acc: 0.794 Test Loss: 0.790 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8733651638031006
Epoch: 41, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.822 Vali Acc: 0.778 Test Loss: 0.822 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.049651861190796
Epoch: 42, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.789 Vali Acc: 0.800 Test Loss: 0.789 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8965127468109131
Epoch: 43, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.805 Vali Acc: 0.806 Test Loss: 0.805 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9981167316436768
Epoch: 44, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.839 Vali Acc: 0.806 Test Loss: 0.839 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9398720264434814
Epoch: 45, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0396482944488525
Epoch: 46, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.914 Vali Acc: 0.794 Test Loss: 0.914 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0529260635375977
Epoch: 47, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.897 Vali Acc: 0.806 Test Loss: 0.897 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.0202322006225586
Epoch: 48, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.981 Vali Acc: 0.800 Test Loss: 0.981 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 31902
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.5451974868774414
Epoch: 1, Steps: 12 | Train Loss: 2.795 Vali Loss: 2.830 Vali Acc: 0.050 Test Loss: 2.830 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.9196360111236572
Epoch: 2, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.799 Vali Acc: 0.050 Test Loss: 2.799 Test Acc: 0.050
Validation loss decreased (-0.049972 --> -0.049972).  Saving model ...
Epoch: 3 cost time: 0.888613224029541
Epoch: 3, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.759 Vali Acc: 0.061 Test Loss: 2.759 Test Acc: 0.061
Validation loss decreased (-0.049972 --> -0.061084).  Saving model ...
Epoch: 4 cost time: 1.2702903747558594
Epoch: 4, Steps: 12 | Train Loss: 2.691 Vali Loss: 2.711 Vali Acc: 0.067 Test Loss: 2.711 Test Acc: 0.067
Validation loss decreased (-0.061084 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 0.9941260814666748
Epoch: 5, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.657 Vali Acc: 0.089 Test Loss: 2.657 Test Acc: 0.089
Validation loss decreased (-0.066640 --> -0.088862).  Saving model ...
Epoch: 6 cost time: 0.7743117809295654
Epoch: 6, Steps: 12 | Train Loss: 2.590 Vali Loss: 2.598 Vali Acc: 0.094 Test Loss: 2.598 Test Acc: 0.094
Validation loss decreased (-0.088862 --> -0.094418).  Saving model ...
Epoch: 7 cost time: 1.2031800746917725
Epoch: 7, Steps: 12 | Train Loss: 2.512 Vali Loss: 2.529 Vali Acc: 0.128 Test Loss: 2.529 Test Acc: 0.128
Validation loss decreased (-0.094418 --> -0.127752).  Saving model ...
Epoch: 8 cost time: 1.0388994216918945
Epoch: 8, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.438 Vali Acc: 0.172 Test Loss: 2.438 Test Acc: 0.172
Validation loss decreased (-0.127752 --> -0.172198).  Saving model ...
Epoch: 9 cost time: 1.1372110843658447
Epoch: 9, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.337 Vali Acc: 0.233 Test Loss: 2.337 Test Acc: 0.233
Validation loss decreased (-0.172198 --> -0.233310).  Saving model ...
Epoch: 10 cost time: 1.4144320487976074
Epoch: 10, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.214 Vali Acc: 0.328 Test Loss: 2.214 Test Acc: 0.328
Validation loss decreased (-0.233310 --> -0.327756).  Saving model ...
Epoch: 11 cost time: 0.9173457622528076
Epoch: 11, Steps: 12 | Train Loss: 2.095 Vali Loss: 2.077 Vali Acc: 0.422 Test Loss: 2.077 Test Acc: 0.422
Validation loss decreased (-0.327756 --> -0.422201).  Saving model ...
Epoch: 12 cost time: 1.0707526206970215
Epoch: 12, Steps: 12 | Train Loss: 1.922 Vali Loss: 1.948 Vali Acc: 0.428 Test Loss: 1.948 Test Acc: 0.428
Validation loss decreased (-0.422201 --> -0.427758).  Saving model ...
Epoch: 13 cost time: 1.0165958404541016
Epoch: 13, Steps: 12 | Train Loss: 1.787 Vali Loss: 1.805 Vali Acc: 0.478 Test Loss: 1.805 Test Acc: 0.478
Validation loss decreased (-0.427758 --> -0.477760).  Saving model ...
Epoch: 14 cost time: 1.3126823902130127
Epoch: 14, Steps: 12 | Train Loss: 1.587 Vali Loss: 1.622 Vali Acc: 0.539 Test Loss: 1.622 Test Acc: 0.539
Validation loss decreased (-0.477760 --> -0.538873).  Saving model ...
Epoch: 15 cost time: 1.0590503215789795
Epoch: 15, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.468 Vali Acc: 0.589 Test Loss: 1.468 Test Acc: 0.589
Validation loss decreased (-0.538873 --> -0.588874).  Saving model ...
Epoch: 16 cost time: 1.094219446182251
Epoch: 16, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.309 Vali Acc: 0.589 Test Loss: 1.309 Test Acc: 0.589
Validation loss decreased (-0.588874 --> -0.588876).  Saving model ...
Epoch: 17 cost time: 1.093606948852539
Epoch: 17, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.234 Vali Acc: 0.583 Test Loss: 1.234 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.005918025970459
Epoch: 18, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.098 Vali Acc: 0.622 Test Loss: 1.098 Test Acc: 0.622
Validation loss decreased (-0.588876 --> -0.622211).  Saving model ...
Epoch: 19 cost time: 0.9443480968475342
Epoch: 19, Steps: 12 | Train Loss: 0.930 Vali Loss: 0.998 Vali Acc: 0.622 Test Loss: 0.998 Test Acc: 0.622
Validation loss decreased (-0.622211 --> -0.622212).  Saving model ...
Epoch: 20 cost time: 0.8105664253234863
Epoch: 20, Steps: 12 | Train Loss: 0.809 Vali Loss: 0.903 Vali Acc: 0.656 Test Loss: 0.903 Test Acc: 0.656
Validation loss decreased (-0.622212 --> -0.655547).  Saving model ...
Epoch: 21 cost time: 0.9263379573822021
Epoch: 21, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.802 Vali Acc: 0.711 Test Loss: 0.802 Test Acc: 0.711
Validation loss decreased (-0.655547 --> -0.711103).  Saving model ...
Epoch: 22 cost time: 0.8293862342834473
Epoch: 22, Steps: 12 | Train Loss: 0.647 Vali Loss: 0.729 Vali Acc: 0.728 Test Loss: 0.729 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727770).  Saving model ...
Epoch: 23 cost time: 0.8085145950317383
Epoch: 23, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
Validation loss decreased (-0.727770 --> -0.777771).  Saving model ...
Epoch: 24 cost time: 0.9561183452606201
Epoch: 24, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.617 Vali Acc: 0.778 Test Loss: 0.617 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777772).  Saving model ...
Epoch: 25 cost time: 0.8841145038604736
Epoch: 25, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
Validation loss decreased (-0.777772 --> -0.822217).  Saving model ...
Epoch: 26 cost time: 1.3079028129577637
Epoch: 26, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2850239276885986
Epoch: 27, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.528 Vali Acc: 0.811 Test Loss: 0.528 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0904178619384766
Epoch: 28, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.477 Vali Acc: 0.839 Test Loss: 0.477 Test Acc: 0.839
Validation loss decreased (-0.822217 --> -0.838884).  Saving model ...
Epoch: 29 cost time: 0.8473765850067139
Epoch: 29, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.470 Vali Acc: 0.806 Test Loss: 0.470 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1247825622558594
Epoch: 30, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.460 Vali Acc: 0.822 Test Loss: 0.460 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7432537078857422
Epoch: 31, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.444 Vali Acc: 0.844 Test Loss: 0.444 Test Acc: 0.844
Validation loss decreased (-0.838884 --> -0.844440).  Saving model ...
Epoch: 32 cost time: 0.8248291015625
Epoch: 32, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.453 Vali Acc: 0.844 Test Loss: 0.453 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1405799388885498
Epoch: 33, Steps: 12 | Train Loss: 0.226 Vali Loss: 0.452 Vali Acc: 0.839 Test Loss: 0.452 Test Acc: 0.839
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8782165050506592
Epoch: 34, Steps: 12 | Train Loss: 0.148 Vali Loss: 0.468 Vali Acc: 0.850 Test Loss: 0.468 Test Acc: 0.850
Validation loss decreased (-0.844440 --> -0.849995).  Saving model ...
Epoch: 35 cost time: 1.1335711479187012
Epoch: 35, Steps: 12 | Train Loss: 0.155 Vali Loss: 0.470 Vali Acc: 0.856 Test Loss: 0.470 Test Acc: 0.856
Validation loss decreased (-0.849995 --> -0.855551).  Saving model ...
Epoch: 36 cost time: 1.1165776252746582
Epoch: 36, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.443 Vali Acc: 0.861 Test Loss: 0.443 Test Acc: 0.861
Validation loss decreased (-0.855551 --> -0.861107).  Saving model ...
Epoch: 37 cost time: 1.0748693943023682
Epoch: 37, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.456 Vali Acc: 0.872 Test Loss: 0.456 Test Acc: 0.872
Validation loss decreased (-0.861107 --> -0.872218).  Saving model ...
Epoch: 38 cost time: 1.5062432289123535
Epoch: 38, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.465 Vali Acc: 0.850 Test Loss: 0.465 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9537897109985352
Epoch: 39, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.460 Vali Acc: 0.894 Test Loss: 0.460 Test Acc: 0.894
Validation loss decreased (-0.872218 --> -0.894440).  Saving model ...
Epoch: 40 cost time: 0.9417340755462646
Epoch: 40, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.472 Vali Acc: 0.878 Test Loss: 0.472 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8813040256500244
Epoch: 41, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.485 Vali Acc: 0.856 Test Loss: 0.485 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9843261241912842
Epoch: 42, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.498 Vali Acc: 0.872 Test Loss: 0.498 Test Acc: 0.872
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0836231708526611
Epoch: 43, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.503 Vali Acc: 0.872 Test Loss: 0.503 Test Acc: 0.872
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0137217044830322
Epoch: 44, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.561 Vali Acc: 0.872 Test Loss: 0.561 Test Acc: 0.872
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0972247123718262
Epoch: 45, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.512 Vali Acc: 0.867 Test Loss: 0.512 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0616481304168701
Epoch: 46, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.563 Vali Acc: 0.872 Test Loss: 0.563 Test Acc: 0.872
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.1432056427001953
Epoch: 47, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.523 Vali Acc: 0.883 Test Loss: 0.523 Test Acc: 0.883
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.8211510181427002
Epoch: 48, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.554 Vali Acc: 0.872 Test Loss: 0.554 Test Acc: 0.872
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.214989185333252
Epoch: 49, Steps: 12 | Train Loss: 0.051 Vali Loss: 0.604 Vali Acc: 0.850 Test Loss: 0.604 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8944444444444445
model parameter : 31671
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.8354172706604004
Epoch: 1, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.819 Vali Acc: 0.033 Test Loss: 2.819 Test Acc: 0.033
Validation loss decreased (inf --> -0.033305).  Saving model ...
Epoch: 2 cost time: 0.9722590446472168
Epoch: 2, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.789 Vali Acc: 0.039 Test Loss: 2.789 Test Acc: 0.039
Validation loss decreased (-0.033305 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 0.8258395195007324
Epoch: 3, Steps: 12 | Train Loss: 2.741 Vali Loss: 2.748 Vali Acc: 0.044 Test Loss: 2.748 Test Acc: 0.044
Validation loss decreased (-0.038861 --> -0.044417).  Saving model ...
Epoch: 4 cost time: 1.3739938735961914
Epoch: 4, Steps: 12 | Train Loss: 2.694 Vali Loss: 2.701 Vali Acc: 0.050 Test Loss: 2.701 Test Acc: 0.050
Validation loss decreased (-0.044417 --> -0.049973).  Saving model ...
Epoch: 5 cost time: 0.7338640689849854
Epoch: 5, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.646 Vali Acc: 0.072 Test Loss: 2.646 Test Acc: 0.072
Validation loss decreased (-0.049973 --> -0.072196).  Saving model ...
Epoch: 6 cost time: 0.9808552265167236
Epoch: 6, Steps: 12 | Train Loss: 2.581 Vali Loss: 2.583 Vali Acc: 0.128 Test Loss: 2.583 Test Acc: 0.128
Validation loss decreased (-0.072196 --> -0.127752).  Saving model ...
Epoch: 7 cost time: 0.8629150390625
Epoch: 7, Steps: 12 | Train Loss: 2.520 Vali Loss: 2.511 Vali Acc: 0.167 Test Loss: 2.511 Test Acc: 0.167
Validation loss decreased (-0.127752 --> -0.166642).  Saving model ...
Epoch: 8 cost time: 0.9668996334075928
Epoch: 8, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.427 Vali Acc: 0.194 Test Loss: 2.427 Test Acc: 0.194
Validation loss decreased (-0.166642 --> -0.194420).  Saving model ...
Epoch: 9 cost time: 0.8338525295257568
Epoch: 9, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.323 Vali Acc: 0.244 Test Loss: 2.323 Test Acc: 0.244
Validation loss decreased (-0.194420 --> -0.244421).  Saving model ...
Epoch: 10 cost time: 1.2743439674377441
Epoch: 10, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.187 Vali Acc: 0.333 Test Loss: 2.187 Test Acc: 0.333
Validation loss decreased (-0.244421 --> -0.333311).  Saving model ...
Epoch: 11 cost time: 1.1632156372070312
Epoch: 11, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.028 Vali Acc: 0.400 Test Loss: 2.028 Test Acc: 0.400
Validation loss decreased (-0.333311 --> -0.399980).  Saving model ...
Epoch: 12 cost time: 0.9109764099121094
Epoch: 12, Steps: 12 | Train Loss: 1.905 Vali Loss: 1.847 Vali Acc: 0.444 Test Loss: 1.847 Test Acc: 0.444
Validation loss decreased (-0.399980 --> -0.444426).  Saving model ...
Epoch: 13 cost time: 0.779064416885376
Epoch: 13, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.658 Vali Acc: 0.500 Test Loss: 1.658 Test Acc: 0.500
Validation loss decreased (-0.444426 --> -0.499983).  Saving model ...
Epoch: 14 cost time: 0.9044816493988037
Epoch: 14, Steps: 12 | Train Loss: 1.470 Vali Loss: 1.500 Vali Acc: 0.528 Test Loss: 1.500 Test Acc: 0.528
Validation loss decreased (-0.499983 --> -0.527763).  Saving model ...
Epoch: 15 cost time: 0.9432134628295898
Epoch: 15, Steps: 12 | Train Loss: 1.296 Vali Loss: 1.338 Vali Acc: 0.594 Test Loss: 1.338 Test Acc: 0.594
Validation loss decreased (-0.527763 --> -0.594431).  Saving model ...
Epoch: 16 cost time: 0.8683242797851562
Epoch: 16, Steps: 12 | Train Loss: 1.139 Vali Loss: 1.201 Vali Acc: 0.606 Test Loss: 1.201 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605544).  Saving model ...
Epoch: 17 cost time: 1.0939993858337402
Epoch: 17, Steps: 12 | Train Loss: 1.053 Vali Loss: 1.126 Vali Acc: 0.617 Test Loss: 1.126 Test Acc: 0.617
Validation loss decreased (-0.605544 --> -0.616655).  Saving model ...
Epoch: 18 cost time: 1.1063103675842285
Epoch: 18, Steps: 12 | Train Loss: 0.942 Vali Loss: 1.002 Vali Acc: 0.661 Test Loss: 1.002 Test Acc: 0.661
Validation loss decreased (-0.616655 --> -0.661101).  Saving model ...
Epoch: 19 cost time: 1.0239336490631104
Epoch: 19, Steps: 12 | Train Loss: 0.833 Vali Loss: 0.947 Vali Acc: 0.661 Test Loss: 0.947 Test Acc: 0.661
Validation loss decreased (-0.661101 --> -0.661102).  Saving model ...
Epoch: 20 cost time: 1.2352757453918457
Epoch: 20, Steps: 12 | Train Loss: 0.785 Vali Loss: 0.903 Vali Acc: 0.700 Test Loss: 0.903 Test Acc: 0.700
Validation loss decreased (-0.661102 --> -0.699991).  Saving model ...
Epoch: 21 cost time: 1.0594141483306885
Epoch: 21, Steps: 12 | Train Loss: 0.732 Vali Loss: 0.875 Vali Acc: 0.689 Test Loss: 0.875 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9865117073059082
Epoch: 22, Steps: 12 | Train Loss: 0.701 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
Validation loss decreased (-0.699991 --> -0.711103).  Saving model ...
Epoch: 23 cost time: 0.8464305400848389
Epoch: 23, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.815 Vali Acc: 0.722 Test Loss: 0.815 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 24 cost time: 0.9378690719604492
Epoch: 24, Steps: 12 | Train Loss: 0.682 Vali Loss: 0.777 Vali Acc: 0.756 Test Loss: 0.777 Test Acc: 0.756
Validation loss decreased (-0.722214 --> -0.755548).  Saving model ...
Epoch: 25 cost time: 0.7185375690460205
Epoch: 25, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.768 Vali Acc: 0.728 Test Loss: 0.768 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1102123260498047
Epoch: 26, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.736 Vali Acc: 0.744 Test Loss: 0.736 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0805284976959229
Epoch: 27, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.719 Vali Acc: 0.761 Test Loss: 0.719 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 28 cost time: 1.0954272747039795
Epoch: 28, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 29 cost time: 1.0393002033233643
Epoch: 29, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.712 Vali Acc: 0.778 Test Loss: 0.712 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777771).  Saving model ...
Epoch: 30 cost time: 0.7837495803833008
Epoch: 30, Steps: 12 | Train Loss: 0.409 Vali Loss: 0.679 Vali Acc: 0.756 Test Loss: 0.679 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7329757213592529
Epoch: 31, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 32 cost time: 0.8837196826934814
Epoch: 32, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.664 Vali Acc: 0.778 Test Loss: 0.664 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0070834159851074
Epoch: 33, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.673 Vali Acc: 0.761 Test Loss: 0.673 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2493467330932617
Epoch: 34, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.655 Vali Acc: 0.772 Test Loss: 0.655 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0992403030395508
Epoch: 35, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.654 Vali Acc: 0.778 Test Loss: 0.654 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8820285797119141
Epoch: 36, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
Validation loss decreased (-0.783327 --> -0.783327).  Saving model ...
Epoch: 37 cost time: 1.0093269348144531
Epoch: 37, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.632 Vali Acc: 0.794 Test Loss: 0.632 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 38 cost time: 0.9046156406402588
Epoch: 38, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.645 Vali Acc: 0.800 Test Loss: 0.645 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799994).  Saving model ...
Epoch: 39 cost time: 0.9876153469085693
Epoch: 39, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.602 Vali Acc: 0.800 Test Loss: 0.602 Test Acc: 0.800
Validation loss decreased (-0.799994 --> -0.799994).  Saving model ...
Epoch: 40 cost time: 0.8646211624145508
Epoch: 40, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.603 Vali Acc: 0.811 Test Loss: 0.603 Test Acc: 0.811
Validation loss decreased (-0.799994 --> -0.811105).  Saving model ...
Epoch: 41 cost time: 1.0514235496520996
Epoch: 41, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.602 Vali Acc: 0.794 Test Loss: 0.602 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.085141897201538
Epoch: 42, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.633 Vali Acc: 0.811 Test Loss: 0.633 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0011603832244873
Epoch: 43, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.625 Vali Acc: 0.811 Test Loss: 0.625 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.2886097431182861
Epoch: 44, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.690 Vali Acc: 0.806 Test Loss: 0.690 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1596779823303223
Epoch: 45, Steps: 12 | Train Loss: 0.166 Vali Loss: 0.625 Vali Acc: 0.806 Test Loss: 0.625 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1254949569702148
Epoch: 46, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.622 Vali Acc: 0.806 Test Loss: 0.622 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.999591588973999
Epoch: 47, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.651 Vali Acc: 0.806 Test Loss: 0.651 Test Acc: 0.806
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3546571731567383
Epoch: 48, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.674 Vali Acc: 0.800 Test Loss: 0.674 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.0119121074676514
Epoch: 49, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.714 Vali Acc: 0.828 Test Loss: 0.714 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827771).  Saving model ...
Epoch: 50 cost time: 1.1943728923797607
Epoch: 50, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.720 Vali Acc: 0.806 Test Loss: 0.720 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2933099269866943
Epoch: 51, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.713 Vali Acc: 0.817 Test Loss: 0.713 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.065262794494629
Epoch: 52, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2335624694824219
Epoch: 53, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.734 Vali Acc: 0.811 Test Loss: 0.734 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.8863766193389893
Epoch: 54, Steps: 12 | Train Loss: 0.070 Vali Loss: 0.828 Vali Acc: 0.817 Test Loss: 0.828 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8501839637756348
Epoch: 55, Steps: 12 | Train Loss: 0.076 Vali Loss: 0.860 Vali Acc: 0.794 Test Loss: 0.860 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0381207466125488
Epoch: 56, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.821 Vali Acc: 0.794 Test Loss: 0.821 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.2401819229125977
Epoch: 57, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.824 Vali Acc: 0.822 Test Loss: 0.824 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.0549452304840088
Epoch: 58, Steps: 12 | Train Loss: 0.071 Vali Loss: 0.856 Vali Acc: 0.811 Test Loss: 0.856 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.164405107498169
Epoch: 59, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.935 Vali Acc: 0.800 Test Loss: 0.935 Test Acc: 0.800
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 31174
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0433406829833984
Epoch: 1, Steps: 12 | Train Loss: 2.834 Vali Loss: 2.857 Vali Acc: 0.083 Test Loss: 2.857 Test Acc: 0.083
Validation loss decreased (inf --> -0.083305).  Saving model ...
Epoch: 2 cost time: 0.9355740547180176
Epoch: 2, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.824 Vali Acc: 0.078 Test Loss: 2.824 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9063830375671387
Epoch: 3, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.783 Vali Acc: 0.083 Test Loss: 2.783 Test Acc: 0.083
Validation loss decreased (-0.083305 --> -0.083306).  Saving model ...
Epoch: 4 cost time: 1.0029494762420654
Epoch: 4, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.732 Vali Acc: 0.100 Test Loss: 2.732 Test Acc: 0.100
Validation loss decreased (-0.083306 --> -0.099973).  Saving model ...
Epoch: 5 cost time: 1.058140516281128
Epoch: 5, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.678 Vali Acc: 0.167 Test Loss: 2.678 Test Acc: 0.167
Validation loss decreased (-0.099973 --> -0.166640).  Saving model ...
Epoch: 6 cost time: 0.9709925651550293
Epoch: 6, Steps: 12 | Train Loss: 2.587 Vali Loss: 2.618 Vali Acc: 0.211 Test Loss: 2.618 Test Acc: 0.211
Validation loss decreased (-0.166640 --> -0.211085).  Saving model ...
Epoch: 7 cost time: 0.959712028503418
Epoch: 7, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.552 Vali Acc: 0.228 Test Loss: 2.552 Test Acc: 0.228
Validation loss decreased (-0.211085 --> -0.227752).  Saving model ...
Epoch: 8 cost time: 0.9574317932128906
Epoch: 8, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.478 Vali Acc: 0.239 Test Loss: 2.478 Test Acc: 0.239
Validation loss decreased (-0.227752 --> -0.238864).  Saving model ...
Epoch: 9 cost time: 1.0758235454559326
Epoch: 9, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.389 Vali Acc: 0.289 Test Loss: 2.389 Test Acc: 0.289
Validation loss decreased (-0.238864 --> -0.288865).  Saving model ...
Epoch: 10 cost time: 0.9187614917755127
Epoch: 10, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.279 Vali Acc: 0.328 Test Loss: 2.279 Test Acc: 0.328
Validation loss decreased (-0.288865 --> -0.327755).  Saving model ...
Epoch: 11 cost time: 0.8856737613677979
Epoch: 11, Steps: 12 | Train Loss: 2.142 Vali Loss: 2.157 Vali Acc: 0.394 Test Loss: 2.157 Test Acc: 0.394
Validation loss decreased (-0.327755 --> -0.394423).  Saving model ...
Epoch: 12 cost time: 0.9369816780090332
Epoch: 12, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.050 Vali Acc: 0.383 Test Loss: 2.050 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8117191791534424
Epoch: 13, Steps: 12 | Train Loss: 1.847 Vali Loss: 1.940 Vali Acc: 0.394 Test Loss: 1.940 Test Acc: 0.394
Validation loss decreased (-0.394423 --> -0.394425).  Saving model ...
Epoch: 14 cost time: 0.8747124671936035
Epoch: 14, Steps: 12 | Train Loss: 1.722 Vali Loss: 1.785 Vali Acc: 0.456 Test Loss: 1.785 Test Acc: 0.456
Validation loss decreased (-0.394425 --> -0.455538).  Saving model ...
Epoch: 15 cost time: 1.059697151184082
Epoch: 15, Steps: 12 | Train Loss: 1.555 Vali Loss: 1.724 Vali Acc: 0.511 Test Loss: 1.724 Test Acc: 0.511
Validation loss decreased (-0.455538 --> -0.511094).  Saving model ...
Epoch: 16 cost time: 0.7834610939025879
Epoch: 16, Steps: 12 | Train Loss: 1.391 Vali Loss: 1.555 Vali Acc: 0.550 Test Loss: 1.555 Test Acc: 0.550
Validation loss decreased (-0.511094 --> -0.549984).  Saving model ...
Epoch: 17 cost time: 1.0280466079711914
Epoch: 17, Steps: 12 | Train Loss: 1.286 Vali Loss: 1.475 Vali Acc: 0.556 Test Loss: 1.475 Test Acc: 0.556
Validation loss decreased (-0.549984 --> -0.555541).  Saving model ...
Epoch: 18 cost time: 0.8111569881439209
Epoch: 18, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.307 Vali Acc: 0.594 Test Loss: 1.307 Test Acc: 0.594
Validation loss decreased (-0.555541 --> -0.594431).  Saving model ...
Epoch: 19 cost time: 0.7446975708007812
Epoch: 19, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.236 Vali Acc: 0.606 Test Loss: 1.236 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605543).  Saving model ...
Epoch: 20 cost time: 0.8613386154174805
Epoch: 20, Steps: 12 | Train Loss: 0.973 Vali Loss: 1.116 Vali Acc: 0.639 Test Loss: 1.116 Test Acc: 0.639
Validation loss decreased (-0.605543 --> -0.638878).  Saving model ...
Epoch: 21 cost time: 0.7677481174468994
Epoch: 21, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.023 Vali Acc: 0.661 Test Loss: 1.023 Test Acc: 0.661
Validation loss decreased (-0.638878 --> -0.661101).  Saving model ...
Epoch: 22 cost time: 0.9578440189361572
Epoch: 22, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.972 Vali Acc: 0.711 Test Loss: 0.972 Test Acc: 0.711
Validation loss decreased (-0.661101 --> -0.711101).  Saving model ...
Epoch: 23 cost time: 0.7444577217102051
Epoch: 23, Steps: 12 | Train Loss: 0.672 Vali Loss: 0.930 Vali Acc: 0.722 Test Loss: 0.930 Test Acc: 0.722
Validation loss decreased (-0.711101 --> -0.722213).  Saving model ...
Epoch: 24 cost time: 0.974867582321167
Epoch: 24, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.884 Vali Acc: 0.728 Test Loss: 0.884 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 25 cost time: 0.84208083152771
Epoch: 25, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.841 Vali Acc: 0.739 Test Loss: 0.841 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 26 cost time: 0.8728575706481934
Epoch: 26, Steps: 12 | Train Loss: 0.531 Vali Loss: 0.796 Vali Acc: 0.761 Test Loss: 0.796 Test Acc: 0.761
Validation loss decreased (-0.738880 --> -0.761103).  Saving model ...
Epoch: 27 cost time: 0.8620285987854004
Epoch: 27, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.769 Vali Acc: 0.772 Test Loss: 0.769 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 28 cost time: 0.7611234188079834
Epoch: 28, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.740 Vali Acc: 0.778 Test Loss: 0.740 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 29 cost time: 0.9466202259063721
Epoch: 29, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.866614580154419
Epoch: 30, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.746 Vali Acc: 0.772 Test Loss: 0.746 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0131216049194336
Epoch: 31, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.721 Vali Acc: 0.761 Test Loss: 0.721 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8589687347412109
Epoch: 32, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.754 Vali Acc: 0.778 Test Loss: 0.754 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.315042495727539
Epoch: 33, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.728 Vali Acc: 0.772 Test Loss: 0.728 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.059779167175293
Epoch: 34, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.739 Vali Acc: 0.800 Test Loss: 0.739 Test Acc: 0.800
Validation loss decreased (-0.777770 --> -0.799993).  Saving model ...
Epoch: 35 cost time: 0.9136290550231934
Epoch: 35, Steps: 12 | Train Loss: 0.214 Vali Loss: 0.735 Vali Acc: 0.811 Test Loss: 0.735 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811104).  Saving model ...
Epoch: 36 cost time: 0.9323742389678955
Epoch: 36, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9957702159881592
Epoch: 37, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.677 Vali Acc: 0.806 Test Loss: 0.677 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0306706428527832
Epoch: 38, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0415618419647217
Epoch: 39, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.0828862190246582
Epoch: 40, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.732 Vali Acc: 0.817 Test Loss: 0.732 Test Acc: 0.817
Validation loss decreased (-0.811104 --> -0.816659).  Saving model ...
Epoch: 41 cost time: 1.1848728656768799
Epoch: 41, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.750 Vali Acc: 0.817 Test Loss: 0.750 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8370180130004883
Epoch: 42, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.793 Vali Acc: 0.806 Test Loss: 0.793 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9398257732391357
Epoch: 43, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.740 Vali Acc: 0.828 Test Loss: 0.740 Test Acc: 0.828
Validation loss decreased (-0.816659 --> -0.827770).  Saving model ...
Epoch: 44 cost time: 0.8103115558624268
Epoch: 44, Steps: 12 | Train Loss: 0.113 Vali Loss: 0.838 Vali Acc: 0.794 Test Loss: 0.838 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8468985557556152
Epoch: 45, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.865 Vali Acc: 0.811 Test Loss: 0.865 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7923755645751953
Epoch: 46, Steps: 12 | Train Loss: 0.079 Vali Loss: 0.857 Vali Acc: 0.789 Test Loss: 0.857 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9974086284637451
Epoch: 47, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.921 Vali Acc: 0.811 Test Loss: 0.921 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7853376865386963
Epoch: 48, Steps: 12 | Train Loss: 0.088 Vali Loss: 0.942 Vali Acc: 0.789 Test Loss: 0.942 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.1613893508911133
Epoch: 49, Steps: 12 | Train Loss: 0.061 Vali Loss: 0.904 Vali Acc: 0.806 Test Loss: 0.904 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1744706630706787
Epoch: 50, Steps: 12 | Train Loss: 0.056 Vali Loss: 0.897 Vali Acc: 0.794 Test Loss: 0.897 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.2199602127075195
Epoch: 51, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.032 Vali Acc: 0.772 Test Loss: 1.032 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.295290470123291
Epoch: 52, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.979 Vali Acc: 0.806 Test Loss: 0.979 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0605440139770508
Epoch: 53, Steps: 12 | Train Loss: 0.053 Vali Loss: 1.092 Vali Acc: 0.772 Test Loss: 1.092 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8277777777777777
model parameter : 31207
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2730886936187744
Epoch: 1, Steps: 12 | Train Loss: 2.813 Vali Loss: 2.817 Vali Acc: 0.050 Test Loss: 2.817 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 1.1231820583343506
Epoch: 2, Steps: 12 | Train Loss: 2.789 Vali Loss: 2.791 Vali Acc: 0.056 Test Loss: 2.791 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 3 cost time: 1.0567975044250488
Epoch: 3, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.753 Vali Acc: 0.072 Test Loss: 2.753 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 0.9258363246917725
Epoch: 4, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.710 Vali Acc: 0.111 Test Loss: 2.710 Test Acc: 0.111
Validation loss decreased (-0.072195 --> -0.111084).  Saving model ...
Epoch: 5 cost time: 1.067427158355713
Epoch: 5, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.665 Vali Acc: 0.150 Test Loss: 2.665 Test Acc: 0.150
Validation loss decreased (-0.111084 --> -0.149973).  Saving model ...
Epoch: 6 cost time: 0.9414255619049072
Epoch: 6, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.613 Vali Acc: 0.167 Test Loss: 2.613 Test Acc: 0.167
Validation loss decreased (-0.149973 --> -0.166641).  Saving model ...
Epoch: 7 cost time: 1.2542698383331299
Epoch: 7, Steps: 12 | Train Loss: 2.548 Vali Loss: 2.559 Vali Acc: 0.228 Test Loss: 2.559 Test Acc: 0.228
Validation loss decreased (-0.166641 --> -0.227752).  Saving model ...
Epoch: 8 cost time: 0.9708640575408936
Epoch: 8, Steps: 12 | Train Loss: 2.476 Vali Loss: 2.504 Vali Acc: 0.272 Test Loss: 2.504 Test Acc: 0.272
Validation loss decreased (-0.227752 --> -0.272197).  Saving model ...
Epoch: 9 cost time: 0.9645249843597412
Epoch: 9, Steps: 12 | Train Loss: 2.439 Vali Loss: 2.433 Vali Acc: 0.339 Test Loss: 2.433 Test Acc: 0.339
Validation loss decreased (-0.272197 --> -0.338865).  Saving model ...
Epoch: 10 cost time: 1.1201143264770508
Epoch: 10, Steps: 12 | Train Loss: 2.352 Vali Loss: 2.359 Vali Acc: 0.356 Test Loss: 2.359 Test Acc: 0.356
Validation loss decreased (-0.338865 --> -0.355532).  Saving model ...
Epoch: 11 cost time: 1.0518856048583984
Epoch: 11, Steps: 12 | Train Loss: 2.236 Vali Loss: 2.279 Vali Acc: 0.372 Test Loss: 2.279 Test Acc: 0.372
Validation loss decreased (-0.355532 --> -0.372199).  Saving model ...
Epoch: 12 cost time: 0.7991199493408203
Epoch: 12, Steps: 12 | Train Loss: 2.153 Vali Loss: 2.185 Vali Acc: 0.378 Test Loss: 2.185 Test Acc: 0.378
Validation loss decreased (-0.372199 --> -0.377756).  Saving model ...
Epoch: 13 cost time: 1.2490224838256836
Epoch: 13, Steps: 12 | Train Loss: 2.026 Vali Loss: 2.072 Vali Acc: 0.394 Test Loss: 2.072 Test Acc: 0.394
Validation loss decreased (-0.377756 --> -0.394424).  Saving model ...
Epoch: 14 cost time: 0.835059404373169
Epoch: 14, Steps: 12 | Train Loss: 1.825 Vali Loss: 1.946 Vali Acc: 0.428 Test Loss: 1.946 Test Acc: 0.428
Validation loss decreased (-0.394424 --> -0.427758).  Saving model ...
Epoch: 15 cost time: 1.0914967060089111
Epoch: 15, Steps: 12 | Train Loss: 1.718 Vali Loss: 1.816 Vali Acc: 0.478 Test Loss: 1.816 Test Acc: 0.478
Validation loss decreased (-0.427758 --> -0.477760).  Saving model ...
Epoch: 16 cost time: 1.1428678035736084
Epoch: 16, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.631 Vali Acc: 0.528 Test Loss: 1.631 Test Acc: 0.528
Validation loss decreased (-0.477760 --> -0.527761).  Saving model ...
Epoch: 17 cost time: 1.2650244235992432
Epoch: 17, Steps: 12 | Train Loss: 1.408 Vali Loss: 1.447 Vali Acc: 0.622 Test Loss: 1.447 Test Acc: 0.622
Validation loss decreased (-0.527761 --> -0.622208).  Saving model ...
Epoch: 18 cost time: 1.2600724697113037
Epoch: 18, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.320 Vali Acc: 0.650 Test Loss: 1.320 Test Acc: 0.650
Validation loss decreased (-0.622208 --> -0.649987).  Saving model ...
Epoch: 19 cost time: 1.1546354293823242
Epoch: 19, Steps: 12 | Train Loss: 1.049 Vali Loss: 1.193 Vali Acc: 0.644 Test Loss: 1.193 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9594967365264893
Epoch: 20, Steps: 12 | Train Loss: 0.913 Vali Loss: 1.076 Vali Acc: 0.678 Test Loss: 1.076 Test Acc: 0.678
Validation loss decreased (-0.649987 --> -0.677767).  Saving model ...
Epoch: 21 cost time: 1.0725431442260742
Epoch: 21, Steps: 12 | Train Loss: 0.829 Vali Loss: 0.981 Vali Acc: 0.683 Test Loss: 0.981 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683324).  Saving model ...
Epoch: 22 cost time: 1.1002495288848877
Epoch: 22, Steps: 12 | Train Loss: 0.668 Vali Loss: 0.913 Vali Acc: 0.733 Test Loss: 0.913 Test Acc: 0.733
Validation loss decreased (-0.683324 --> -0.733324).  Saving model ...
Epoch: 23 cost time: 1.3426218032836914
Epoch: 23, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.838 Vali Acc: 0.744 Test Loss: 0.838 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 24 cost time: 0.8207113742828369
Epoch: 24, Steps: 12 | Train Loss: 0.529 Vali Loss: 0.833 Vali Acc: 0.744 Test Loss: 0.833 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 25 cost time: 1.2509760856628418
Epoch: 25, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.776 Vali Acc: 0.744 Test Loss: 0.776 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 26 cost time: 1.4271326065063477
Epoch: 26, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.784 Vali Acc: 0.733 Test Loss: 0.784 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1303348541259766
Epoch: 27, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.764 Vali Acc: 0.744 Test Loss: 0.764 Test Acc: 0.744
Validation loss decreased (-0.744437 --> -0.744437).  Saving model ...
Epoch: 28 cost time: 0.9372231960296631
Epoch: 28, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.741 Vali Acc: 0.750 Test Loss: 0.741 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749993).  Saving model ...
Epoch: 29 cost time: 1.1097238063812256
Epoch: 29, Steps: 12 | Train Loss: 0.328 Vali Loss: 0.748 Vali Acc: 0.761 Test Loss: 0.748 Test Acc: 0.761
Validation loss decreased (-0.749993 --> -0.761104).  Saving model ...
Epoch: 30 cost time: 0.7704141139984131
Epoch: 30, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.708 Vali Acc: 0.756 Test Loss: 0.708 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9833734035491943
Epoch: 31, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.719 Vali Acc: 0.756 Test Loss: 0.719 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9586277008056641
Epoch: 32, Steps: 12 | Train Loss: 0.305 Vali Loss: 0.709 Vali Acc: 0.756 Test Loss: 0.709 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0339903831481934
Epoch: 33, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.658 Vali Acc: 0.767 Test Loss: 0.658 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766660).  Saving model ...
Epoch: 34 cost time: 1.1588213443756104
Epoch: 34, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.672 Vali Acc: 0.778 Test Loss: 0.672 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 35 cost time: 0.9478280544281006
Epoch: 35, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.694 Vali Acc: 0.794 Test Loss: 0.694 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 36 cost time: 0.9321227073669434
Epoch: 36, Steps: 12 | Train Loss: 0.212 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.982771635055542
Epoch: 37, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.740 Vali Acc: 0.794 Test Loss: 0.740 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0649313926696777
Epoch: 38, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.727 Vali Acc: 0.817 Test Loss: 0.727 Test Acc: 0.817
Validation loss decreased (-0.794438 --> -0.816659).  Saving model ...
Epoch: 39 cost time: 0.8754394054412842
Epoch: 39, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.803 Vali Acc: 0.800 Test Loss: 0.803 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1460442543029785
Epoch: 40, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.712 Vali Acc: 0.800 Test Loss: 0.712 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9047107696533203
Epoch: 41, Steps: 12 | Train Loss: 0.198 Vali Loss: 0.736 Vali Acc: 0.811 Test Loss: 0.736 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1002459526062012
Epoch: 42, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.343228816986084
Epoch: 43, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.829 Vali Acc: 0.822 Test Loss: 0.829 Test Acc: 0.822
Validation loss decreased (-0.816659 --> -0.822214).  Saving model ...
Epoch: 44 cost time: 1.079082727432251
Epoch: 44, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.783 Vali Acc: 0.822 Test Loss: 0.783 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 45 cost time: 0.8271441459655762
Epoch: 45, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.787 Vali Acc: 0.822 Test Loss: 0.787 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8945062160491943
Epoch: 46, Steps: 12 | Train Loss: 0.106 Vali Loss: 0.783 Vali Acc: 0.839 Test Loss: 0.783 Test Acc: 0.839
Validation loss decreased (-0.822214 --> -0.838881).  Saving model ...
Epoch: 47 cost time: 1.1047437191009521
Epoch: 47, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.901 Vali Acc: 0.822 Test Loss: 0.901 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.4872276782989502
Epoch: 48, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.846 Vali Acc: 0.811 Test Loss: 0.846 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2602930068969727
Epoch: 49, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.046 Vali Acc: 0.800 Test Loss: 1.046 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9802408218383789
Epoch: 50, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.898 Vali Acc: 0.817 Test Loss: 0.898 Test Acc: 0.817
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1572160720825195
Epoch: 51, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.025 Vali Acc: 0.811 Test Loss: 1.025 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0781235694885254
Epoch: 52, Steps: 12 | Train Loss: 0.110 Vali Loss: 0.963 Vali Acc: 0.811 Test Loss: 0.963 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9265296459197998
Epoch: 53, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.052 Vali Acc: 0.811 Test Loss: 1.052 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.1879777908325195
Epoch: 54, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.945 Vali Acc: 0.822 Test Loss: 0.945 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.0282320976257324
Epoch: 55, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.013 Vali Acc: 0.822 Test Loss: 1.013 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9794065952301025
Epoch: 56, Steps: 12 | Train Loss: 0.048 Vali Loss: 0.972 Vali Acc: 0.828 Test Loss: 0.972 Test Acc: 0.828
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 31154
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.4410338401794434
Epoch: 1, Steps: 12 | Train Loss: 2.771 Vali Loss: 2.776 Vali Acc: 0.028 Test Loss: 2.776 Test Acc: 0.028
Validation loss decreased (inf --> -0.027750).  Saving model ...
Epoch: 2 cost time: 1.1183393001556396
Epoch: 2, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.743 Vali Acc: 0.050 Test Loss: 2.743 Test Acc: 0.050
Validation loss decreased (-0.027750 --> -0.049973).  Saving model ...
Epoch: 3 cost time: 0.9777028560638428
Epoch: 3, Steps: 12 | Train Loss: 2.723 Vali Loss: 2.698 Vali Acc: 0.072 Test Loss: 2.698 Test Acc: 0.072
Validation loss decreased (-0.049973 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 1.1777074337005615
Epoch: 4, Steps: 12 | Train Loss: 2.686 Vali Loss: 2.646 Vali Acc: 0.133 Test Loss: 2.646 Test Acc: 0.133
Validation loss decreased (-0.072195 --> -0.133307).  Saving model ...
Epoch: 5 cost time: 0.9809935092926025
Epoch: 5, Steps: 12 | Train Loss: 2.625 Vali Loss: 2.591 Vali Acc: 0.172 Test Loss: 2.591 Test Acc: 0.172
Validation loss decreased (-0.133307 --> -0.172196).  Saving model ...
Epoch: 6 cost time: 0.8169558048248291
Epoch: 6, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.530 Vali Acc: 0.233 Test Loss: 2.530 Test Acc: 0.233
Validation loss decreased (-0.172196 --> -0.233308).  Saving model ...
Epoch: 7 cost time: 0.7247583866119385
Epoch: 7, Steps: 12 | Train Loss: 2.471 Vali Loss: 2.458 Vali Acc: 0.300 Test Loss: 2.458 Test Acc: 0.300
Validation loss decreased (-0.233308 --> -0.299975).  Saving model ...
Epoch: 8 cost time: 0.696040153503418
Epoch: 8, Steps: 12 | Train Loss: 2.410 Vali Loss: 2.368 Vali Acc: 0.356 Test Loss: 2.368 Test Acc: 0.356
Validation loss decreased (-0.299975 --> -0.355532).  Saving model ...
Epoch: 9 cost time: 0.7864477634429932
Epoch: 9, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.259 Vali Acc: 0.367 Test Loss: 2.259 Test Acc: 0.367
Validation loss decreased (-0.355532 --> -0.366644).  Saving model ...
Epoch: 10 cost time: 0.9821627140045166
Epoch: 10, Steps: 12 | Train Loss: 2.184 Vali Loss: 2.140 Vali Acc: 0.361 Test Loss: 2.140 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.077131748199463
Epoch: 11, Steps: 12 | Train Loss: 2.042 Vali Loss: 2.015 Vali Acc: 0.367 Test Loss: 2.015 Test Acc: 0.367
Validation loss decreased (-0.366644 --> -0.366647).  Saving model ...
Epoch: 12 cost time: 1.0471055507659912
Epoch: 12, Steps: 12 | Train Loss: 1.932 Vali Loss: 1.867 Vali Acc: 0.494 Test Loss: 1.867 Test Acc: 0.494
Validation loss decreased (-0.366647 --> -0.494426).  Saving model ...
Epoch: 13 cost time: 1.1659181118011475
Epoch: 13, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.731 Vali Acc: 0.506 Test Loss: 1.731 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505538).  Saving model ...
Epoch: 14 cost time: 0.8460028171539307
Epoch: 14, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.560 Vali Acc: 0.556 Test Loss: 1.560 Test Acc: 0.556
Validation loss decreased (-0.505538 --> -0.555540).  Saving model ...
Epoch: 15 cost time: 0.6876718997955322
Epoch: 15, Steps: 12 | Train Loss: 1.373 Vali Loss: 1.385 Vali Acc: 0.556 Test Loss: 1.385 Test Acc: 0.556
Validation loss decreased (-0.555540 --> -0.555542).  Saving model ...
Epoch: 16 cost time: 1.0076096057891846
Epoch: 16, Steps: 12 | Train Loss: 1.249 Vali Loss: 1.245 Vali Acc: 0.561 Test Loss: 1.245 Test Acc: 0.561
Validation loss decreased (-0.555542 --> -0.561099).  Saving model ...
Epoch: 17 cost time: 0.9543769359588623
Epoch: 17, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.088 Vali Acc: 0.633 Test Loss: 1.088 Test Acc: 0.633
Validation loss decreased (-0.561099 --> -0.633322).  Saving model ...
Epoch: 18 cost time: 1.1836965084075928
Epoch: 18, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.017 Vali Acc: 0.633 Test Loss: 1.017 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633323).  Saving model ...
Epoch: 19 cost time: 1.2749814987182617
Epoch: 19, Steps: 12 | Train Loss: 0.841 Vali Loss: 0.896 Vali Acc: 0.700 Test Loss: 0.896 Test Acc: 0.700
Validation loss decreased (-0.633323 --> -0.699991).  Saving model ...
Epoch: 20 cost time: 0.999079704284668
Epoch: 20, Steps: 12 | Train Loss: 0.721 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
Validation loss decreased (-0.699991 --> -0.744436).  Saving model ...
Epoch: 21 cost time: 0.9857833385467529
Epoch: 21, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.780 Vali Acc: 0.750 Test Loss: 0.780 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 22 cost time: 0.9155974388122559
Epoch: 22, Steps: 12 | Train Loss: 0.570 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.788881).  Saving model ...
Epoch: 23 cost time: 1.0526113510131836
Epoch: 23, Steps: 12 | Train Loss: 0.506 Vali Loss: 0.701 Vali Acc: 0.778 Test Loss: 0.701 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.961073637008667
Epoch: 24, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.649 Vali Acc: 0.806 Test Loss: 0.649 Test Acc: 0.806
Validation loss decreased (-0.788881 --> -0.805549).  Saving model ...
Epoch: 25 cost time: 1.0070714950561523
Epoch: 25, Steps: 12 | Train Loss: 0.420 Vali Loss: 0.675 Vali Acc: 0.806 Test Loss: 0.675 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2024331092834473
Epoch: 26, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.596 Vali Acc: 0.794 Test Loss: 0.596 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9651260375976562
Epoch: 27, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.669 Vali Acc: 0.806 Test Loss: 0.669 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.064347743988037
Epoch: 28, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.580 Vali Acc: 0.794 Test Loss: 0.580 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1334166526794434
Epoch: 29, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.618 Vali Acc: 0.806 Test Loss: 0.618 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805549).  Saving model ...
Epoch: 30 cost time: 0.7840356826782227
Epoch: 30, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.999718189239502
Epoch: 31, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.579 Vali Acc: 0.767 Test Loss: 0.579 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8146207332611084
Epoch: 32, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.558 Vali Acc: 0.806 Test Loss: 0.558 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 33 cost time: 0.8844320774078369
Epoch: 33, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.569 Vali Acc: 0.806 Test Loss: 0.569 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7368061542510986
Epoch: 34, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.561 Vali Acc: 0.839 Test Loss: 0.561 Test Acc: 0.839
Validation loss decreased (-0.805550 --> -0.838883).  Saving model ...
Epoch: 35 cost time: 1.0526597499847412
Epoch: 35, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.572 Vali Acc: 0.794 Test Loss: 0.572 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.234623670578003
Epoch: 36, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.564 Vali Acc: 0.806 Test Loss: 0.564 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5094718933105469
Epoch: 37, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.605 Vali Acc: 0.817 Test Loss: 0.605 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0790469646453857
Epoch: 38, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.604 Vali Acc: 0.800 Test Loss: 0.604 Test Acc: 0.800
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8649923801422119
Epoch: 39, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.9188737869262695
Epoch: 40, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.653 Vali Acc: 0.806 Test Loss: 0.653 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0501658916473389
Epoch: 41, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8636152744293213
Epoch: 42, Steps: 12 | Train Loss: 0.136 Vali Loss: 0.626 Vali Acc: 0.828 Test Loss: 0.626 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.147787094116211
Epoch: 43, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.1150522232055664
Epoch: 44, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.692 Vali Acc: 0.839 Test Loss: 0.692 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 31015
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.2903103828430176
Epoch: 1, Steps: 12 | Train Loss: 2.651 Vali Loss: 2.652 Vali Acc: 0.111 Test Loss: 2.652 Test Acc: 0.111
Validation loss decreased (inf --> -0.111085).  Saving model ...
Epoch: 2 cost time: 0.7179815769195557
Epoch: 2, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.626 Vali Acc: 0.133 Test Loss: 2.626 Test Acc: 0.133
Validation loss decreased (-0.111085 --> -0.133307).  Saving model ...
Epoch: 3 cost time: 0.9739971160888672
Epoch: 3, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.589 Vali Acc: 0.139 Test Loss: 2.589 Test Acc: 0.139
Validation loss decreased (-0.133307 --> -0.138863).  Saving model ...
Epoch: 4 cost time: 0.925260066986084
Epoch: 4, Steps: 12 | Train Loss: 2.586 Vali Loss: 2.546 Vali Acc: 0.156 Test Loss: 2.546 Test Acc: 0.156
Validation loss decreased (-0.138863 --> -0.155530).  Saving model ...
Epoch: 5 cost time: 1.039135217666626
Epoch: 5, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.501 Vali Acc: 0.172 Test Loss: 2.501 Test Acc: 0.172
Validation loss decreased (-0.155530 --> -0.172197).  Saving model ...
Epoch: 6 cost time: 0.7196316719055176
Epoch: 6, Steps: 12 | Train Loss: 2.450 Vali Loss: 2.449 Vali Acc: 0.183 Test Loss: 2.449 Test Acc: 0.183
Validation loss decreased (-0.172197 --> -0.183309).  Saving model ...
Epoch: 7 cost time: 1.061490535736084
Epoch: 7, Steps: 12 | Train Loss: 2.431 Vali Loss: 2.392 Vali Acc: 0.250 Test Loss: 2.392 Test Acc: 0.250
Validation loss decreased (-0.183309 --> -0.249976).  Saving model ...
Epoch: 8 cost time: 0.929497241973877
Epoch: 8, Steps: 12 | Train Loss: 2.315 Vali Loss: 2.326 Vali Acc: 0.283 Test Loss: 2.326 Test Acc: 0.283
Validation loss decreased (-0.249976 --> -0.283310).  Saving model ...
Epoch: 9 cost time: 1.221987009048462
Epoch: 9, Steps: 12 | Train Loss: 2.258 Vali Loss: 2.248 Vali Acc: 0.350 Test Loss: 2.248 Test Acc: 0.350
Validation loss decreased (-0.283310 --> -0.349978).  Saving model ...
Epoch: 10 cost time: 1.1003739833831787
Epoch: 10, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.151 Vali Acc: 0.400 Test Loss: 2.151 Test Acc: 0.400
Validation loss decreased (-0.349978 --> -0.399978).  Saving model ...
Epoch: 11 cost time: 0.9692807197570801
Epoch: 11, Steps: 12 | Train Loss: 2.044 Vali Loss: 2.028 Vali Acc: 0.467 Test Loss: 2.028 Test Acc: 0.467
Validation loss decreased (-0.399978 --> -0.466646).  Saving model ...
Epoch: 12 cost time: 0.8806989192962646
Epoch: 12, Steps: 12 | Train Loss: 1.855 Vali Loss: 1.890 Vali Acc: 0.494 Test Loss: 1.890 Test Acc: 0.494
Validation loss decreased (-0.466646 --> -0.494426).  Saving model ...
Epoch: 13 cost time: 0.7373714447021484
Epoch: 13, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.759 Vali Acc: 0.483 Test Loss: 1.759 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8426599502563477
Epoch: 14, Steps: 12 | Train Loss: 1.599 Vali Loss: 1.626 Vali Acc: 0.539 Test Loss: 1.626 Test Acc: 0.539
Validation loss decreased (-0.494426 --> -0.538873).  Saving model ...
Epoch: 15 cost time: 1.1054730415344238
Epoch: 15, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.497 Vali Acc: 0.567 Test Loss: 1.497 Test Acc: 0.567
Validation loss decreased (-0.538873 --> -0.566652).  Saving model ...
Epoch: 16 cost time: 0.9348628520965576
Epoch: 16, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.359 Vali Acc: 0.589 Test Loss: 1.359 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588875).  Saving model ...
Epoch: 17 cost time: 0.9907035827636719
Epoch: 17, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.265 Vali Acc: 0.606 Test Loss: 1.265 Test Acc: 0.606
Validation loss decreased (-0.588875 --> -0.605543).  Saving model ...
Epoch: 18 cost time: 0.7866954803466797
Epoch: 18, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.161 Vali Acc: 0.622 Test Loss: 1.161 Test Acc: 0.622
Validation loss decreased (-0.605543 --> -0.622211).  Saving model ...
Epoch: 19 cost time: 0.9525806903839111
Epoch: 19, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.102 Vali Acc: 0.633 Test Loss: 1.102 Test Acc: 0.633
Validation loss decreased (-0.622211 --> -0.633322).  Saving model ...
Epoch: 20 cost time: 1.0610239505767822
Epoch: 20, Steps: 12 | Train Loss: 0.871 Vali Loss: 1.031 Vali Acc: 0.667 Test Loss: 1.031 Test Acc: 0.667
Validation loss decreased (-0.633322 --> -0.666656).  Saving model ...
Epoch: 21 cost time: 1.0928919315338135
Epoch: 21, Steps: 12 | Train Loss: 0.744 Vali Loss: 0.966 Vali Acc: 0.672 Test Loss: 0.966 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672213).  Saving model ...
Epoch: 22 cost time: 1.4110960960388184
Epoch: 22, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.935 Vali Acc: 0.683 Test Loss: 0.935 Test Acc: 0.683
Validation loss decreased (-0.672213 --> -0.683324).  Saving model ...
Epoch: 23 cost time: 1.425170660018921
Epoch: 23, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.839 Vali Acc: 0.728 Test Loss: 0.839 Test Acc: 0.728
Validation loss decreased (-0.683324 --> -0.727769).  Saving model ...
Epoch: 24 cost time: 1.5753962993621826
Epoch: 24, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.847 Vali Acc: 0.739 Test Loss: 0.847 Test Acc: 0.739
Validation loss decreased (-0.727769 --> -0.738880).  Saving model ...
Epoch: 25 cost time: 1.205273151397705
Epoch: 25, Steps: 12 | Train Loss: 0.562 Vali Loss: 0.795 Vali Acc: 0.744 Test Loss: 0.795 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 26 cost time: 1.1917378902435303
Epoch: 26, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.741 Vali Acc: 0.756 Test Loss: 0.741 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 27 cost time: 1.2708556652069092
Epoch: 27, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.687 Vali Acc: 0.767 Test Loss: 0.687 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766660).  Saving model ...
Epoch: 28 cost time: 1.0869731903076172
Epoch: 28, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.639 Vali Acc: 0.778 Test Loss: 0.639 Test Acc: 0.778
Validation loss decreased (-0.766660 --> -0.777771).  Saving model ...
Epoch: 29 cost time: 1.1447391510009766
Epoch: 29, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.665 Vali Acc: 0.778 Test Loss: 0.665 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2865371704101562
Epoch: 30, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.654 Vali Acc: 0.794 Test Loss: 0.654 Test Acc: 0.794
Validation loss decreased (-0.777771 --> -0.794438).  Saving model ...
Epoch: 31 cost time: 1.2498517036437988
Epoch: 31, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.632 Vali Acc: 0.778 Test Loss: 0.632 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2560298442840576
Epoch: 32, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.570 Vali Acc: 0.828 Test Loss: 0.570 Test Acc: 0.828
Validation loss decreased (-0.794438 --> -0.827772).  Saving model ...
Epoch: 33 cost time: 1.0260493755340576
Epoch: 33, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0701980590820312
Epoch: 34, Steps: 12 | Train Loss: 0.233 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.827772 --> -0.833327).  Saving model ...
Epoch: 35 cost time: 0.9041507244110107
Epoch: 35, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2285521030426025
Epoch: 36, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.589 Vali Acc: 0.822 Test Loss: 0.589 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0444483757019043
Epoch: 37, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.621 Vali Acc: 0.800 Test Loss: 0.621 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1494839191436768
Epoch: 38, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.593 Vali Acc: 0.811 Test Loss: 0.593 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9706618785858154
Epoch: 39, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.607 Vali Acc: 0.811 Test Loss: 0.607 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.223355770111084
Epoch: 40, Steps: 12 | Train Loss: 0.150 Vali Loss: 0.640 Vali Acc: 0.811 Test Loss: 0.640 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.174501657485962
Epoch: 41, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.620 Vali Acc: 0.822 Test Loss: 0.620 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0018210411071777
Epoch: 42, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.644 Vali Acc: 0.794 Test Loss: 0.644 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.908292293548584
Epoch: 43, Steps: 12 | Train Loss: 0.102 Vali Loss: 0.615 Vali Acc: 0.800 Test Loss: 0.615 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2310657501220703
Epoch: 44, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.736 Vali Acc: 0.778 Test Loss: 0.736 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8333333333333334
model parameter : 30790
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 3.0685362815856934
Epoch: 1, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.587 Vali Acc: 0.189 Test Loss: 2.587 Test Acc: 0.189
Validation loss decreased (inf --> -0.188863).  Saving model ...
Epoch: 2 cost time: 0.9074196815490723
Epoch: 2, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.565 Vali Acc: 0.200 Test Loss: 2.565 Test Acc: 0.200
Validation loss decreased (-0.188863 --> -0.199974).  Saving model ...
Epoch: 3 cost time: 0.8209114074707031
Epoch: 3, Steps: 12 | Train Loss: 2.574 Vali Loss: 2.534 Vali Acc: 0.217 Test Loss: 2.534 Test Acc: 0.217
Validation loss decreased (-0.199974 --> -0.216641).  Saving model ...
Epoch: 4 cost time: 0.8989832401275635
Epoch: 4, Steps: 12 | Train Loss: 2.567 Vali Loss: 2.497 Vali Acc: 0.233 Test Loss: 2.497 Test Acc: 0.233
Validation loss decreased (-0.216641 --> -0.233308).  Saving model ...
Epoch: 5 cost time: 0.7820603847503662
Epoch: 5, Steps: 12 | Train Loss: 2.536 Vali Loss: 2.454 Vali Acc: 0.250 Test Loss: 2.454 Test Acc: 0.250
Validation loss decreased (-0.233308 --> -0.249975).  Saving model ...
Epoch: 6 cost time: 0.965329647064209
Epoch: 6, Steps: 12 | Train Loss: 2.462 Vali Loss: 2.409 Vali Acc: 0.278 Test Loss: 2.409 Test Acc: 0.278
Validation loss decreased (-0.249975 --> -0.277754).  Saving model ...
Epoch: 7 cost time: 0.8383080959320068
Epoch: 7, Steps: 12 | Train Loss: 2.405 Vali Loss: 2.356 Vali Acc: 0.322 Test Loss: 2.356 Test Acc: 0.322
Validation loss decreased (-0.277754 --> -0.322199).  Saving model ...
Epoch: 8 cost time: 1.059424877166748
Epoch: 8, Steps: 12 | Train Loss: 2.328 Vali Loss: 2.290 Vali Acc: 0.378 Test Loss: 2.290 Test Acc: 0.378
Validation loss decreased (-0.322199 --> -0.377755).  Saving model ...
Epoch: 9 cost time: 0.9020657539367676
Epoch: 9, Steps: 12 | Train Loss: 2.208 Vali Loss: 2.198 Vali Acc: 0.389 Test Loss: 2.198 Test Acc: 0.389
Validation loss decreased (-0.377755 --> -0.388867).  Saving model ...
Epoch: 10 cost time: 0.9693760871887207
Epoch: 10, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.084 Vali Acc: 0.450 Test Loss: 2.084 Test Acc: 0.450
Validation loss decreased (-0.388867 --> -0.449979).  Saving model ...
Epoch: 11 cost time: 0.9751839637756348
Epoch: 11, Steps: 12 | Train Loss: 1.972 Vali Loss: 1.933 Vali Acc: 0.439 Test Loss: 1.933 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9878621101379395
Epoch: 12, Steps: 12 | Train Loss: 1.819 Vali Loss: 1.766 Vali Acc: 0.472 Test Loss: 1.766 Test Acc: 0.472
Validation loss decreased (-0.449979 --> -0.472205).  Saving model ...
Epoch: 13 cost time: 0.7782580852508545
Epoch: 13, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.595 Vali Acc: 0.478 Test Loss: 1.595 Test Acc: 0.478
Validation loss decreased (-0.472205 --> -0.477762).  Saving model ...
Epoch: 14 cost time: 0.8817102909088135
Epoch: 14, Steps: 12 | Train Loss: 1.435 Vali Loss: 1.440 Vali Acc: 0.544 Test Loss: 1.440 Test Acc: 0.544
Validation loss decreased (-0.477762 --> -0.544430).  Saving model ...
Epoch: 15 cost time: 0.9993116855621338
Epoch: 15, Steps: 12 | Train Loss: 1.156 Vali Loss: 1.326 Vali Acc: 0.611 Test Loss: 1.326 Test Acc: 0.611
Validation loss decreased (-0.544430 --> -0.611098).  Saving model ...
Epoch: 16 cost time: 0.9458858966827393
Epoch: 16, Steps: 12 | Train Loss: 1.094 Vali Loss: 1.260 Vali Acc: 0.594 Test Loss: 1.260 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9877035617828369
Epoch: 17, Steps: 12 | Train Loss: 0.915 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
Validation loss decreased (-0.611098 --> -0.655544).  Saving model ...
Epoch: 18 cost time: 0.9430696964263916
Epoch: 18, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.029 Vali Acc: 0.650 Test Loss: 1.029 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8894641399383545
Epoch: 19, Steps: 12 | Train Loss: 0.704 Vali Loss: 0.977 Vali Acc: 0.650 Test Loss: 0.977 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9667568206787109
Epoch: 20, Steps: 12 | Train Loss: 0.615 Vali Loss: 0.888 Vali Acc: 0.678 Test Loss: 0.888 Test Acc: 0.678
Validation loss decreased (-0.655544 --> -0.677769).  Saving model ...
Epoch: 21 cost time: 0.7731609344482422
Epoch: 21, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.885 Vali Acc: 0.689 Test Loss: 0.885 Test Acc: 0.689
Validation loss decreased (-0.677769 --> -0.688880).  Saving model ...
Epoch: 22 cost time: 1.0236577987670898
Epoch: 22, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.790 Vali Acc: 0.706 Test Loss: 0.790 Test Acc: 0.706
Validation loss decreased (-0.688880 --> -0.705548).  Saving model ...
Epoch: 23 cost time: 0.800541877746582
Epoch: 23, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.787 Vali Acc: 0.706 Test Loss: 0.787 Test Acc: 0.706
Validation loss decreased (-0.705548 --> -0.705548).  Saving model ...
Epoch: 24 cost time: 0.728198766708374
Epoch: 24, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.734 Vali Acc: 0.722 Test Loss: 0.734 Test Acc: 0.722
Validation loss decreased (-0.705548 --> -0.722215).  Saving model ...
Epoch: 25 cost time: 0.8343465328216553
Epoch: 25, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.762 Vali Acc: 0.689 Test Loss: 0.762 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8685083389282227
Epoch: 26, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.783 Vali Acc: 0.739 Test Loss: 0.783 Test Acc: 0.739
Validation loss decreased (-0.722215 --> -0.738881).  Saving model ...
Epoch: 27 cost time: 0.8505878448486328
Epoch: 27, Steps: 12 | Train Loss: 0.348 Vali Loss: 0.724 Vali Acc: 0.744 Test Loss: 0.724 Test Acc: 0.744
Validation loss decreased (-0.738881 --> -0.744437).  Saving model ...
Epoch: 28 cost time: 0.8921918869018555
Epoch: 28, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.876 Vali Acc: 0.689 Test Loss: 0.876 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9468300342559814
Epoch: 29, Steps: 12 | Train Loss: 0.354 Vali Loss: 0.789 Vali Acc: 0.761 Test Loss: 0.789 Test Acc: 0.761
Validation loss decreased (-0.744437 --> -0.761103).  Saving model ...
Epoch: 30 cost time: 0.8905410766601562
Epoch: 30, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8770861625671387
Epoch: 31, Steps: 12 | Train Loss: 0.278 Vali Loss: 0.726 Vali Acc: 0.772 Test Loss: 0.726 Test Acc: 0.772
Validation loss decreased (-0.761103 --> -0.772215).  Saving model ...
Epoch: 32 cost time: 1.0713560581207275
Epoch: 32, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.761 Vali Acc: 0.761 Test Loss: 0.761 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9084196090698242
Epoch: 33, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.752 Vali Acc: 0.733 Test Loss: 0.752 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1899831295013428
Epoch: 34, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.755 Vali Acc: 0.772 Test Loss: 0.755 Test Acc: 0.772
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9945034980773926
Epoch: 35, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.790 Vali Acc: 0.733 Test Loss: 0.790 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8410894870758057
Epoch: 36, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.727 Vali Acc: 0.761 Test Loss: 0.727 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9024736881256104
Epoch: 37, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.876 Vali Acc: 0.733 Test Loss: 0.876 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.835688591003418
Epoch: 38, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.729 Vali Acc: 0.772 Test Loss: 0.729 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.074510097503662
Epoch: 39, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.833 Vali Acc: 0.756 Test Loss: 0.833 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0281779766082764
Epoch: 40, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.796 Vali Acc: 0.739 Test Loss: 0.796 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0512566566467285
Epoch: 41, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.868 Vali Acc: 0.761 Test Loss: 0.868 Test Acc: 0.761
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 30935
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6398487091064453
Epoch: 1, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.696 Vali Acc: 0.028 Test Loss: 2.696 Test Acc: 0.028
Validation loss decreased (inf --> -0.027751).  Saving model ...
Epoch: 2 cost time: 0.9771475791931152
Epoch: 2, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.669 Vali Acc: 0.039 Test Loss: 2.669 Test Acc: 0.039
Validation loss decreased (-0.027751 --> -0.038862).  Saving model ...
Epoch: 3 cost time: 0.7054760456085205
Epoch: 3, Steps: 12 | Train Loss: 2.676 Vali Loss: 2.631 Vali Acc: 0.050 Test Loss: 2.631 Test Acc: 0.050
Validation loss decreased (-0.038862 --> -0.049974).  Saving model ...
Epoch: 4 cost time: 0.8623552322387695
Epoch: 4, Steps: 12 | Train Loss: 2.658 Vali Loss: 2.583 Vali Acc: 0.094 Test Loss: 2.583 Test Acc: 0.094
Validation loss decreased (-0.049974 --> -0.094419).  Saving model ...
Epoch: 5 cost time: 0.8665854930877686
Epoch: 5, Steps: 12 | Train Loss: 2.583 Vali Loss: 2.534 Vali Acc: 0.133 Test Loss: 2.534 Test Acc: 0.133
Validation loss decreased (-0.094419 --> -0.133308).  Saving model ...
Epoch: 6 cost time: 0.6954529285430908
Epoch: 6, Steps: 12 | Train Loss: 2.541 Vali Loss: 2.480 Vali Acc: 0.206 Test Loss: 2.480 Test Acc: 0.206
Validation loss decreased (-0.133308 --> -0.205531).  Saving model ...
Epoch: 7 cost time: 0.828333854675293
Epoch: 7, Steps: 12 | Train Loss: 2.484 Vali Loss: 2.415 Vali Acc: 0.267 Test Loss: 2.415 Test Acc: 0.267
Validation loss decreased (-0.205531 --> -0.266643).  Saving model ...
Epoch: 8 cost time: 0.8268721103668213
Epoch: 8, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.334 Vali Acc: 0.322 Test Loss: 2.334 Test Acc: 0.322
Validation loss decreased (-0.266643 --> -0.322199).  Saving model ...
Epoch: 9 cost time: 0.7570042610168457
Epoch: 9, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.233 Vali Acc: 0.383 Test Loss: 2.233 Test Acc: 0.383
Validation loss decreased (-0.322199 --> -0.383311).  Saving model ...
Epoch: 10 cost time: 1.1068105697631836
Epoch: 10, Steps: 12 | Train Loss: 2.183 Vali Loss: 2.104 Vali Acc: 0.439 Test Loss: 2.104 Test Acc: 0.439
Validation loss decreased (-0.383311 --> -0.438868).  Saving model ...
Epoch: 11 cost time: 1.0442514419555664
Epoch: 11, Steps: 12 | Train Loss: 2.045 Vali Loss: 1.934 Vali Acc: 0.433 Test Loss: 1.934 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0413026809692383
Epoch: 12, Steps: 12 | Train Loss: 1.914 Vali Loss: 1.781 Vali Acc: 0.439 Test Loss: 1.781 Test Acc: 0.439
Validation loss decreased (-0.438868 --> -0.438871).  Saving model ...
Epoch: 13 cost time: 0.8934135437011719
Epoch: 13, Steps: 12 | Train Loss: 1.757 Vali Loss: 1.641 Vali Acc: 0.461 Test Loss: 1.641 Test Acc: 0.461
Validation loss decreased (-0.438871 --> -0.461095).  Saving model ...
Epoch: 14 cost time: 0.912233829498291
Epoch: 14, Steps: 12 | Train Loss: 1.518 Vali Loss: 1.533 Vali Acc: 0.467 Test Loss: 1.533 Test Acc: 0.467
Validation loss decreased (-0.461095 --> -0.466651).  Saving model ...
Epoch: 15 cost time: 0.7747583389282227
Epoch: 15, Steps: 12 | Train Loss: 1.369 Vali Loss: 1.425 Vali Acc: 0.483 Test Loss: 1.425 Test Acc: 0.483
Validation loss decreased (-0.466651 --> -0.483319).  Saving model ...
Epoch: 16 cost time: 0.8873927593231201
Epoch: 16, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.304 Vali Acc: 0.489 Test Loss: 1.304 Test Acc: 0.489
Validation loss decreased (-0.483319 --> -0.488876).  Saving model ...
Epoch: 17 cost time: 0.7520878314971924
Epoch: 17, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.242 Vali Acc: 0.528 Test Loss: 1.242 Test Acc: 0.528
Validation loss decreased (-0.488876 --> -0.527765).  Saving model ...
Epoch: 18 cost time: 1.0516059398651123
Epoch: 18, Steps: 12 | Train Loss: 1.004 Vali Loss: 1.199 Vali Acc: 0.511 Test Loss: 1.199 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1080193519592285
Epoch: 19, Steps: 12 | Train Loss: 0.925 Vali Loss: 1.132 Vali Acc: 0.550 Test Loss: 1.132 Test Acc: 0.550
Validation loss decreased (-0.527765 --> -0.549989).  Saving model ...
Epoch: 20 cost time: 0.8481249809265137
Epoch: 20, Steps: 12 | Train Loss: 0.815 Vali Loss: 1.085 Vali Acc: 0.556 Test Loss: 1.085 Test Acc: 0.556
Validation loss decreased (-0.549989 --> -0.555545).  Saving model ...
Epoch: 21 cost time: 0.9200806617736816
Epoch: 21, Steps: 12 | Train Loss: 0.805 Vali Loss: 1.054 Vali Acc: 0.583 Test Loss: 1.054 Test Acc: 0.583
Validation loss decreased (-0.555545 --> -0.583323).  Saving model ...
Epoch: 22 cost time: 0.7844822406768799
Epoch: 22, Steps: 12 | Train Loss: 0.696 Vali Loss: 1.020 Vali Acc: 0.600 Test Loss: 1.020 Test Acc: 0.600
Validation loss decreased (-0.583323 --> -0.599990).  Saving model ...
Epoch: 23 cost time: 0.7657418251037598
Epoch: 23, Steps: 12 | Train Loss: 0.688 Vali Loss: 1.018 Vali Acc: 0.611 Test Loss: 1.018 Test Acc: 0.611
Validation loss decreased (-0.599990 --> -0.611101).  Saving model ...
Epoch: 24 cost time: 1.0591907501220703
Epoch: 24, Steps: 12 | Train Loss: 0.639 Vali Loss: 1.006 Vali Acc: 0.606 Test Loss: 1.006 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9645013809204102
Epoch: 25, Steps: 12 | Train Loss: 0.603 Vali Loss: 0.961 Vali Acc: 0.622 Test Loss: 0.961 Test Acc: 0.622
Validation loss decreased (-0.611101 --> -0.622213).  Saving model ...
Epoch: 26 cost time: 1.0417263507843018
Epoch: 26, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.927 Vali Acc: 0.650 Test Loss: 0.927 Test Acc: 0.650
Validation loss decreased (-0.622213 --> -0.649991).  Saving model ...
Epoch: 27 cost time: 0.8981316089630127
Epoch: 27, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.936 Vali Acc: 0.650 Test Loss: 0.936 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.055544376373291
Epoch: 28, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.921 Vali Acc: 0.656 Test Loss: 0.921 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655546).  Saving model ...
Epoch: 29 cost time: 0.8289294242858887
Epoch: 29, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.901 Vali Acc: 0.689 Test Loss: 0.901 Test Acc: 0.689
Validation loss decreased (-0.655546 --> -0.688880).  Saving model ...
Epoch: 30 cost time: 0.9704341888427734
Epoch: 30, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.925 Vali Acc: 0.656 Test Loss: 0.925 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3059639930725098
Epoch: 31, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.914 Vali Acc: 0.689 Test Loss: 0.914 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9103460311889648
Epoch: 32, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.930 Vali Acc: 0.672 Test Loss: 0.930 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8909246921539307
Epoch: 33, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.925 Vali Acc: 0.694 Test Loss: 0.925 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 34 cost time: 0.7336719036102295
Epoch: 34, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.933 Vali Acc: 0.667 Test Loss: 0.933 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8609895706176758
Epoch: 35, Steps: 12 | Train Loss: 0.336 Vali Loss: 1.001 Vali Acc: 0.706 Test Loss: 1.001 Test Acc: 0.706
Validation loss decreased (-0.694435 --> -0.705546).  Saving model ...
Epoch: 36 cost time: 0.9692893028259277
Epoch: 36, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.918 Vali Acc: 0.678 Test Loss: 0.918 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0910661220550537
Epoch: 37, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.943 Vali Acc: 0.717 Test Loss: 0.943 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 38 cost time: 0.8368117809295654
Epoch: 38, Steps: 12 | Train Loss: 0.245 Vali Loss: 0.968 Vali Acc: 0.722 Test Loss: 0.968 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 39 cost time: 1.0845520496368408
Epoch: 39, Steps: 12 | Train Loss: 0.306 Vali Loss: 1.018 Vali Acc: 0.739 Test Loss: 1.018 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738879).  Saving model ...
Epoch: 40 cost time: 1.1507539749145508
Epoch: 40, Steps: 12 | Train Loss: 0.248 Vali Loss: 0.991 Vali Acc: 0.744 Test Loss: 0.991 Test Acc: 0.744
Validation loss decreased (-0.738879 --> -0.744435).  Saving model ...
Epoch: 41 cost time: 0.9033236503601074
Epoch: 41, Steps: 12 | Train Loss: 0.211 Vali Loss: 1.079 Vali Acc: 0.722 Test Loss: 1.079 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7875823974609375
Epoch: 42, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.999 Vali Acc: 0.733 Test Loss: 0.999 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0360312461853027
Epoch: 43, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.106 Vali Acc: 0.717 Test Loss: 1.106 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8419191837310791
Epoch: 44, Steps: 12 | Train Loss: 0.251 Vali Loss: 1.109 Vali Acc: 0.739 Test Loss: 1.109 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9453234672546387
Epoch: 45, Steps: 12 | Train Loss: 0.201 Vali Loss: 1.150 Vali Acc: 0.728 Test Loss: 1.150 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.084651231765747
Epoch: 46, Steps: 12 | Train Loss: 0.160 Vali Loss: 1.088 Vali Acc: 0.750 Test Loss: 1.088 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749989).  Saving model ...
Epoch: 47 cost time: 0.937375545501709
Epoch: 47, Steps: 12 | Train Loss: 0.147 Vali Loss: 1.188 Vali Acc: 0.733 Test Loss: 1.188 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1210100650787354
Epoch: 48, Steps: 12 | Train Loss: 0.157 Vali Loss: 1.178 Vali Acc: 0.739 Test Loss: 1.178 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.3602607250213623
Epoch: 49, Steps: 12 | Train Loss: 0.112 Vali Loss: 1.166 Vali Acc: 0.733 Test Loss: 1.166 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.1463792324066162
Epoch: 50, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.197 Vali Acc: 0.739 Test Loss: 1.197 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.8164496421813965
Epoch: 51, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.272 Vali Acc: 0.756 Test Loss: 1.272 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.755543).  Saving model ...
Epoch: 52 cost time: 0.8256006240844727
Epoch: 52, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.296 Vali Acc: 0.733 Test Loss: 1.296 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9826264381408691
Epoch: 53, Steps: 12 | Train Loss: 0.076 Vali Loss: 1.215 Vali Acc: 0.756 Test Loss: 1.215 Test Acc: 0.756
Validation loss decreased (-0.755543 --> -0.755543).  Saving model ...
Epoch: 54 cost time: 1.020202398300171
Epoch: 54, Steps: 12 | Train Loss: 0.079 Vali Loss: 1.313 Vali Acc: 0.767 Test Loss: 1.313 Test Acc: 0.767
Validation loss decreased (-0.755543 --> -0.766654).  Saving model ...
Epoch: 55 cost time: 0.7718994617462158
Epoch: 55, Steps: 12 | Train Loss: 0.097 Vali Loss: 1.340 Vali Acc: 0.756 Test Loss: 1.340 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0014188289642334
Epoch: 56, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.376 Vali Acc: 0.756 Test Loss: 1.376 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0209171772003174
Epoch: 57, Steps: 12 | Train Loss: 0.067 Vali Loss: 1.294 Vali Acc: 0.761 Test Loss: 1.294 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.99578857421875
Epoch: 58, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.461 Vali Acc: 0.756 Test Loss: 1.461 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.044788122177124
Epoch: 59, Steps: 12 | Train Loss: 0.064 Vali Loss: 1.474 Vali Acc: 0.756 Test Loss: 1.474 Test Acc: 0.756
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9195942878723145
Epoch: 60, Steps: 12 | Train Loss: 0.075 Vali Loss: 1.470 Vali Acc: 0.750 Test Loss: 1.470 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8861291408538818
Epoch: 61, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.668 Vali Acc: 0.733 Test Loss: 1.668 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1279850006103516
Epoch: 62, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.607 Vali Acc: 0.778 Test Loss: 1.607 Test Acc: 0.778
Validation loss decreased (-0.766654 --> -0.777762).  Saving model ...
Epoch: 63 cost time: 0.8308441638946533
Epoch: 63, Steps: 12 | Train Loss: 0.083 Vali Loss: 1.585 Vali Acc: 0.761 Test Loss: 1.585 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8499917984008789
Epoch: 64, Steps: 12 | Train Loss: 0.040 Vali Loss: 1.531 Vali Acc: 0.750 Test Loss: 1.531 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.87520432472229
Epoch: 65, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.669 Vali Acc: 0.744 Test Loss: 1.669 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.6938865184783936
Epoch: 66, Steps: 12 | Train Loss: 0.029 Vali Loss: 1.749 Vali Acc: 0.761 Test Loss: 1.749 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8284702301025391
Epoch: 67, Steps: 12 | Train Loss: 0.034 Vali Loss: 1.754 Vali Acc: 0.767 Test Loss: 1.754 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9082660675048828
Epoch: 68, Steps: 12 | Train Loss: 0.026 Vali Loss: 1.627 Vali Acc: 0.767 Test Loss: 1.627 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.8501243591308594
Epoch: 69, Steps: 12 | Train Loss: 0.017 Vali Loss: 1.674 Vali Acc: 0.767 Test Loss: 1.674 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9505016803741455
Epoch: 70, Steps: 12 | Train Loss: 0.043 Vali Loss: 1.793 Vali Acc: 0.750 Test Loss: 1.793 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.722142219543457
Epoch: 71, Steps: 12 | Train Loss: 0.012 Vali Loss: 1.768 Vali Acc: 0.767 Test Loss: 1.768 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.756812572479248
Epoch: 72, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.763 Vali Acc: 0.767 Test Loss: 1.763 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm256_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 30846
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.460075855255127
Epoch: 1, Steps: 12 | Train Loss: 2.761 Vali Loss: 2.758 Vali Acc: 0.050 Test Loss: 2.758 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.8858773708343506
Epoch: 2, Steps: 12 | Train Loss: 2.765 Vali Loss: 2.732 Vali Acc: 0.072 Test Loss: 2.732 Test Acc: 0.072
Validation loss decreased (-0.049972 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 1.100876808166504
Epoch: 3, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.697 Vali Acc: 0.089 Test Loss: 2.697 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 1.1523106098175049
Epoch: 4, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.655 Vali Acc: 0.094 Test Loss: 2.655 Test Acc: 0.094
Validation loss decreased (-0.088862 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.8523633480072021
Epoch: 5, Steps: 12 | Train Loss: 2.617 Vali Loss: 2.607 Vali Acc: 0.139 Test Loss: 2.607 Test Acc: 0.139
Validation loss decreased (-0.094418 --> -0.138863).  Saving model ...
Epoch: 6 cost time: 0.8768086433410645
Epoch: 6, Steps: 12 | Train Loss: 2.573 Vali Loss: 2.556 Vali Acc: 0.172 Test Loss: 2.556 Test Acc: 0.172
Validation loss decreased (-0.138863 --> -0.172197).  Saving model ...
Epoch: 7 cost time: 0.8352465629577637
Epoch: 7, Steps: 12 | Train Loss: 2.515 Vali Loss: 2.502 Vali Acc: 0.194 Test Loss: 2.502 Test Acc: 0.194
Validation loss decreased (-0.172197 --> -0.194419).  Saving model ...
Epoch: 8 cost time: 0.774360179901123
Epoch: 8, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.443 Vali Acc: 0.250 Test Loss: 2.443 Test Acc: 0.250
Validation loss decreased (-0.194419 --> -0.249976).  Saving model ...
Epoch: 9 cost time: 0.8965375423431396
Epoch: 9, Steps: 12 | Train Loss: 2.382 Vali Loss: 2.377 Vali Acc: 0.294 Test Loss: 2.377 Test Acc: 0.294
Validation loss decreased (-0.249976 --> -0.294421).  Saving model ...
Epoch: 10 cost time: 0.7966632843017578
Epoch: 10, Steps: 12 | Train Loss: 2.286 Vali Loss: 2.301 Vali Acc: 0.361 Test Loss: 2.301 Test Acc: 0.361
Validation loss decreased (-0.294421 --> -0.361088).  Saving model ...
Epoch: 11 cost time: 1.1106340885162354
Epoch: 11, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.220 Vali Acc: 0.372 Test Loss: 2.220 Test Acc: 0.372
Validation loss decreased (-0.361088 --> -0.372200).  Saving model ...
Epoch: 12 cost time: 1.0809133052825928
Epoch: 12, Steps: 12 | Train Loss: 2.103 Vali Loss: 2.129 Vali Acc: 0.372 Test Loss: 2.129 Test Acc: 0.372
Validation loss decreased (-0.372200 --> -0.372201).  Saving model ...
Epoch: 13 cost time: 0.7370254993438721
Epoch: 13, Steps: 12 | Train Loss: 1.954 Vali Loss: 2.041 Vali Acc: 0.378 Test Loss: 2.041 Test Acc: 0.378
Validation loss decreased (-0.372201 --> -0.377757).  Saving model ...
Epoch: 14 cost time: 0.9530220031738281
Epoch: 14, Steps: 12 | Train Loss: 1.867 Vali Loss: 1.965 Vali Acc: 0.372 Test Loss: 1.965 Test Acc: 0.372
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1459956169128418
Epoch: 15, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.898 Vali Acc: 0.411 Test Loss: 1.898 Test Acc: 0.411
Validation loss decreased (-0.377757 --> -0.411092).  Saving model ...
Epoch: 16 cost time: 0.8017971515655518
Epoch: 16, Steps: 12 | Train Loss: 1.662 Vali Loss: 1.819 Vali Acc: 0.428 Test Loss: 1.819 Test Acc: 0.428
Validation loss decreased (-0.411092 --> -0.427760).  Saving model ...
Epoch: 17 cost time: 1.0055391788482666
Epoch: 17, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.741 Vali Acc: 0.489 Test Loss: 1.741 Test Acc: 0.489
Validation loss decreased (-0.427760 --> -0.488871).  Saving model ...
Epoch: 18 cost time: 0.8255338668823242
Epoch: 18, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.666 Vali Acc: 0.489 Test Loss: 1.666 Test Acc: 0.489
Validation loss decreased (-0.488871 --> -0.488872).  Saving model ...
Epoch: 19 cost time: 0.9237809181213379
Epoch: 19, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.555 Vali Acc: 0.567 Test Loss: 1.555 Test Acc: 0.567
Validation loss decreased (-0.488872 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 1.4199514389038086
Epoch: 20, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.434 Vali Acc: 0.617 Test Loss: 1.434 Test Acc: 0.617
Validation loss decreased (-0.566651 --> -0.616652).  Saving model ...
Epoch: 21 cost time: 1.107262134552002
Epoch: 21, Steps: 12 | Train Loss: 1.275 Vali Loss: 1.342 Vali Acc: 0.611 Test Loss: 1.342 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8167006969451904
Epoch: 22, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.264 Vali Acc: 0.628 Test Loss: 1.264 Test Acc: 0.628
Validation loss decreased (-0.616652 --> -0.627765).  Saving model ...
Epoch: 23 cost time: 0.8432731628417969
Epoch: 23, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.184 Vali Acc: 0.628 Test Loss: 1.184 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627766).  Saving model ...
Epoch: 24 cost time: 0.8964221477508545
Epoch: 24, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.104 Vali Acc: 0.644 Test Loss: 1.104 Test Acc: 0.644
Validation loss decreased (-0.627766 --> -0.644433).  Saving model ...
Epoch: 25 cost time: 0.9206407070159912
Epoch: 25, Steps: 12 | Train Loss: 0.902 Vali Loss: 1.025 Vali Acc: 0.661 Test Loss: 1.025 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661101).  Saving model ...
Epoch: 26 cost time: 0.9527373313903809
Epoch: 26, Steps: 12 | Train Loss: 0.828 Vali Loss: 0.983 Vali Acc: 0.678 Test Loss: 0.983 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677768).  Saving model ...
Epoch: 27 cost time: 0.9827842712402344
Epoch: 27, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.922 Vali Acc: 0.656 Test Loss: 0.922 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0128917694091797
Epoch: 28, Steps: 12 | Train Loss: 0.699 Vali Loss: 0.889 Vali Acc: 0.689 Test Loss: 0.889 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 29 cost time: 1.0534274578094482
Epoch: 29, Steps: 12 | Train Loss: 0.677 Vali Loss: 0.819 Vali Acc: 0.739 Test Loss: 0.819 Test Acc: 0.739
Validation loss decreased (-0.688880 --> -0.738881).  Saving model ...
Epoch: 30 cost time: 0.7606828212738037
Epoch: 30, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7545368671417236
Epoch: 31, Steps: 12 | Train Loss: 0.497 Vali Loss: 0.750 Vali Acc: 0.733 Test Loss: 0.750 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8118288516998291
Epoch: 32, Steps: 12 | Train Loss: 0.519 Vali Loss: 0.724 Vali Acc: 0.739 Test Loss: 0.724 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738882).  Saving model ...
Epoch: 33 cost time: 0.9319577217102051
Epoch: 33, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.676 Vali Acc: 0.778 Test Loss: 0.676 Test Acc: 0.778
Validation loss decreased (-0.738882 --> -0.777771).  Saving model ...
Epoch: 34 cost time: 0.8388409614562988
Epoch: 34, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.660 Vali Acc: 0.789 Test Loss: 0.660 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 35 cost time: 0.9557332992553711
Epoch: 35, Steps: 12 | Train Loss: 0.389 Vali Loss: 0.661 Vali Acc: 0.767 Test Loss: 0.661 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9865221977233887
Epoch: 36, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788883).  Saving model ...
Epoch: 37 cost time: 1.207876205444336
Epoch: 37, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.614 Vali Acc: 0.800 Test Loss: 0.614 Test Acc: 0.800
Validation loss decreased (-0.788883 --> -0.799994).  Saving model ...
Epoch: 38 cost time: 0.9014303684234619
Epoch: 38, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9190216064453125
Epoch: 39, Steps: 12 | Train Loss: 0.303 Vali Loss: 0.596 Vali Acc: 0.806 Test Loss: 0.596 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 40 cost time: 0.9230310916900635
Epoch: 40, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.620 Vali Acc: 0.789 Test Loss: 0.620 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0025231838226318
Epoch: 41, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.603 Vali Acc: 0.794 Test Loss: 0.603 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0662317276000977
Epoch: 42, Steps: 12 | Train Loss: 0.277 Vali Loss: 0.609 Vali Acc: 0.794 Test Loss: 0.609 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8003723621368408
Epoch: 43, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.601 Vali Acc: 0.806 Test Loss: 0.601 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0262320041656494
Epoch: 44, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.636 Vali Acc: 0.811 Test Loss: 0.636 Test Acc: 0.811
Validation loss decreased (-0.805550 --> -0.811105).  Saving model ...
Epoch: 45 cost time: 1.1957781314849854
Epoch: 45, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.636 Vali Acc: 0.806 Test Loss: 0.636 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0767955780029297
Epoch: 46, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.602 Vali Acc: 0.794 Test Loss: 0.602 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.1023669242858887
Epoch: 47, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1312413215637207
Epoch: 48, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.677 Vali Acc: 0.794 Test Loss: 0.677 Test Acc: 0.794
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8662354946136475
Epoch: 49, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.664 Vali Acc: 0.794 Test Loss: 0.664 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9531075954437256
Epoch: 50, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.646 Vali Acc: 0.806 Test Loss: 0.646 Test Acc: 0.806
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9194691181182861
Epoch: 51, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.669 Vali Acc: 0.767 Test Loss: 0.669 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.821174144744873
Epoch: 52, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.649 Vali Acc: 0.794 Test Loss: 0.649 Test Acc: 0.794
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.3045518398284912
Epoch: 53, Steps: 12 | Train Loss: 0.139 Vali Loss: 0.746 Vali Acc: 0.767 Test Loss: 0.746 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0448379516601562
Epoch: 54, Steps: 12 | Train Loss: 0.095 Vali Loss: 0.681 Vali Acc: 0.811 Test Loss: 0.681 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8111111111111111
model parameter : 12109
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.317086696624756
Epoch: 1, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.765 Vali Acc: 0.139 Test Loss: 2.765 Test Acc: 0.139
Validation loss decreased (inf --> -0.138861).  Saving model ...
Epoch: 2 cost time: 0.7130804061889648
Epoch: 2, Steps: 12 | Train Loss: 2.681 Vali Loss: 2.738 Vali Acc: 0.139 Test Loss: 2.738 Test Acc: 0.139
Validation loss decreased (-0.138861 --> -0.138862).  Saving model ...
Epoch: 3 cost time: 0.932995080947876
Epoch: 3, Steps: 12 | Train Loss: 2.628 Vali Loss: 2.704 Vali Acc: 0.144 Test Loss: 2.704 Test Acc: 0.144
Validation loss decreased (-0.138862 --> -0.144417).  Saving model ...
Epoch: 4 cost time: 0.7138526439666748
Epoch: 4, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.664 Vali Acc: 0.156 Test Loss: 2.664 Test Acc: 0.156
Validation loss decreased (-0.144417 --> -0.155529).  Saving model ...
Epoch: 5 cost time: 0.7043685913085938
Epoch: 5, Steps: 12 | Train Loss: 2.560 Vali Loss: 2.621 Vali Acc: 0.172 Test Loss: 2.621 Test Acc: 0.172
Validation loss decreased (-0.155529 --> -0.172196).  Saving model ...
Epoch: 6 cost time: 0.9105007648468018
Epoch: 6, Steps: 12 | Train Loss: 2.523 Vali Loss: 2.573 Vali Acc: 0.183 Test Loss: 2.573 Test Acc: 0.183
Validation loss decreased (-0.172196 --> -0.183308).  Saving model ...
Epoch: 7 cost time: 0.9335534572601318
Epoch: 7, Steps: 12 | Train Loss: 2.447 Vali Loss: 2.520 Vali Acc: 0.200 Test Loss: 2.520 Test Acc: 0.200
Validation loss decreased (-0.183308 --> -0.199975).  Saving model ...
Epoch: 8 cost time: 0.7898468971252441
Epoch: 8, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.465 Vali Acc: 0.233 Test Loss: 2.465 Test Acc: 0.233
Validation loss decreased (-0.199975 --> -0.233309).  Saving model ...
Epoch: 9 cost time: 0.870589017868042
Epoch: 9, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.407 Vali Acc: 0.289 Test Loss: 2.407 Test Acc: 0.289
Validation loss decreased (-0.233309 --> -0.288865).  Saving model ...
Epoch: 10 cost time: 0.7649409770965576
Epoch: 10, Steps: 12 | Train Loss: 2.273 Vali Loss: 2.341 Vali Acc: 0.339 Test Loss: 2.341 Test Acc: 0.339
Validation loss decreased (-0.288865 --> -0.338865).  Saving model ...
Epoch: 11 cost time: 0.7811167240142822
Epoch: 11, Steps: 12 | Train Loss: 2.175 Vali Loss: 2.274 Vali Acc: 0.361 Test Loss: 2.274 Test Acc: 0.361
Validation loss decreased (-0.338865 --> -0.361088).  Saving model ...
Epoch: 12 cost time: 0.9051187038421631
Epoch: 12, Steps: 12 | Train Loss: 2.135 Vali Loss: 2.194 Vali Acc: 0.372 Test Loss: 2.194 Test Acc: 0.372
Validation loss decreased (-0.361088 --> -0.372200).  Saving model ...
Epoch: 13 cost time: 0.8372597694396973
Epoch: 13, Steps: 12 | Train Loss: 2.053 Vali Loss: 2.108 Vali Acc: 0.394 Test Loss: 2.108 Test Acc: 0.394
Validation loss decreased (-0.372200 --> -0.394423).  Saving model ...
Epoch: 14 cost time: 0.6365265846252441
Epoch: 14, Steps: 12 | Train Loss: 1.936 Vali Loss: 2.012 Vali Acc: 0.383 Test Loss: 2.012 Test Acc: 0.383
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8151912689208984
Epoch: 15, Steps: 12 | Train Loss: 1.875 Vali Loss: 1.906 Vali Acc: 0.422 Test Loss: 1.906 Test Acc: 0.422
Validation loss decreased (-0.394423 --> -0.422203).  Saving model ...
Epoch: 16 cost time: 0.7157087326049805
Epoch: 16, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.801 Vali Acc: 0.450 Test Loss: 1.801 Test Acc: 0.450
Validation loss decreased (-0.422203 --> -0.449982).  Saving model ...
Epoch: 17 cost time: 0.9099957942962646
Epoch: 17, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.706 Vali Acc: 0.500 Test Loss: 1.706 Test Acc: 0.500
Validation loss decreased (-0.449982 --> -0.499983).  Saving model ...
Epoch: 18 cost time: 1.0301637649536133
Epoch: 18, Steps: 12 | Train Loss: 1.595 Vali Loss: 1.627 Vali Acc: 0.506 Test Loss: 1.627 Test Acc: 0.506
Validation loss decreased (-0.499983 --> -0.505539).  Saving model ...
Epoch: 19 cost time: 0.896240234375
Epoch: 19, Steps: 12 | Train Loss: 1.453 Vali Loss: 1.548 Vali Acc: 0.550 Test Loss: 1.548 Test Acc: 0.550
Validation loss decreased (-0.505539 --> -0.549985).  Saving model ...
Epoch: 20 cost time: 0.849895715713501
Epoch: 20, Steps: 12 | Train Loss: 1.401 Vali Loss: 1.470 Vali Acc: 0.544 Test Loss: 1.470 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7698428630828857
Epoch: 21, Steps: 12 | Train Loss: 1.285 Vali Loss: 1.406 Vali Acc: 0.583 Test Loss: 1.406 Test Acc: 0.583
Validation loss decreased (-0.549985 --> -0.583319).  Saving model ...
Epoch: 22 cost time: 0.879051685333252
Epoch: 22, Steps: 12 | Train Loss: 1.199 Vali Loss: 1.339 Vali Acc: 0.578 Test Loss: 1.339 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7427220344543457
Epoch: 23, Steps: 12 | Train Loss: 1.107 Vali Loss: 1.257 Vali Acc: 0.556 Test Loss: 1.257 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1275033950805664
Epoch: 24, Steps: 12 | Train Loss: 1.035 Vali Loss: 1.206 Vali Acc: 0.617 Test Loss: 1.206 Test Acc: 0.617
Validation loss decreased (-0.583319 --> -0.616655).  Saving model ...
Epoch: 25 cost time: 0.8812201023101807
Epoch: 25, Steps: 12 | Train Loss: 0.960 Vali Loss: 1.142 Vali Acc: 0.628 Test Loss: 1.142 Test Acc: 0.628
Validation loss decreased (-0.616655 --> -0.627766).  Saving model ...
Epoch: 26 cost time: 0.8564581871032715
Epoch: 26, Steps: 12 | Train Loss: 0.884 Vali Loss: 1.101 Vali Acc: 0.611 Test Loss: 1.101 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8268756866455078
Epoch: 27, Steps: 12 | Train Loss: 0.852 Vali Loss: 1.055 Vali Acc: 0.622 Test Loss: 1.055 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8124949932098389
Epoch: 28, Steps: 12 | Train Loss: 0.794 Vali Loss: 1.027 Vali Acc: 0.622 Test Loss: 1.027 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0722846984863281
Epoch: 29, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.984 Vali Acc: 0.628 Test Loss: 0.984 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627768).  Saving model ...
Epoch: 30 cost time: 1.2585339546203613
Epoch: 30, Steps: 12 | Train Loss: 0.678 Vali Loss: 0.962 Vali Acc: 0.606 Test Loss: 0.962 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7884180545806885
Epoch: 31, Steps: 12 | Train Loss: 0.703 Vali Loss: 0.920 Vali Acc: 0.644 Test Loss: 0.920 Test Acc: 0.644
Validation loss decreased (-0.627768 --> -0.644435).  Saving model ...
Epoch: 32 cost time: 0.8546340465545654
Epoch: 32, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.916 Vali Acc: 0.628 Test Loss: 0.916 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9903795719146729
Epoch: 33, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.889 Vali Acc: 0.650 Test Loss: 0.889 Test Acc: 0.650
Validation loss decreased (-0.644435 --> -0.649991).  Saving model ...
Epoch: 34 cost time: 0.9010710716247559
Epoch: 34, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.861 Vali Acc: 0.656 Test Loss: 0.861 Test Acc: 0.656
Validation loss decreased (-0.649991 --> -0.655547).  Saving model ...
Epoch: 35 cost time: 1.0936834812164307
Epoch: 35, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.849 Vali Acc: 0.678 Test Loss: 0.849 Test Acc: 0.678
Validation loss decreased (-0.655547 --> -0.677769).  Saving model ...
Epoch: 36 cost time: 0.8465664386749268
Epoch: 36, Steps: 12 | Train Loss: 0.509 Vali Loss: 0.821 Vali Acc: 0.683 Test Loss: 0.821 Test Acc: 0.683
Validation loss decreased (-0.677769 --> -0.683325).  Saving model ...
Epoch: 37 cost time: 0.9888734817504883
Epoch: 37, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.820 Vali Acc: 0.667 Test Loss: 0.820 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0303819179534912
Epoch: 38, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.820 Vali Acc: 0.683 Test Loss: 0.820 Test Acc: 0.683
Validation loss decreased (-0.683325 --> -0.683325).  Saving model ...
Epoch: 39 cost time: 0.7515871524810791
Epoch: 39, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.786 Vali Acc: 0.672 Test Loss: 0.786 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8077418804168701
Epoch: 40, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.788 Vali Acc: 0.700 Test Loss: 0.788 Test Acc: 0.700
Validation loss decreased (-0.683325 --> -0.699992).  Saving model ...
Epoch: 41 cost time: 1.195671796798706
Epoch: 41, Steps: 12 | Train Loss: 0.368 Vali Loss: 0.763 Vali Acc: 0.694 Test Loss: 0.763 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.714745044708252
Epoch: 42, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.756 Vali Acc: 0.700 Test Loss: 0.756 Test Acc: 0.700
Validation loss decreased (-0.699992 --> -0.699992).  Saving model ...
Epoch: 43 cost time: 1.0003952980041504
Epoch: 43, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.738 Vali Acc: 0.739 Test Loss: 0.738 Test Acc: 0.739
Validation loss decreased (-0.699992 --> -0.738882).  Saving model ...
Epoch: 44 cost time: 1.003169298171997
Epoch: 44, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.740 Vali Acc: 0.728 Test Loss: 0.740 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7823517322540283
Epoch: 45, Steps: 12 | Train Loss: 0.293 Vali Loss: 0.775 Vali Acc: 0.694 Test Loss: 0.775 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9433889389038086
Epoch: 46, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.752 Vali Acc: 0.756 Test Loss: 0.752 Test Acc: 0.756
Validation loss decreased (-0.738882 --> -0.755548).  Saving model ...
Epoch: 47 cost time: 0.9653933048248291
Epoch: 47, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.739 Vali Acc: 0.728 Test Loss: 0.739 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0651991367340088
Epoch: 48, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9443755149841309
Epoch: 49, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.785 Vali Acc: 0.728 Test Loss: 0.785 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.2567272186279297
Epoch: 50, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1393659114837646
Epoch: 51, Steps: 12 | Train Loss: 0.142 Vali Loss: 0.823 Vali Acc: 0.739 Test Loss: 0.823 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.1287760734558105
Epoch: 52, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.936 Vali Acc: 0.722 Test Loss: 0.936 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8219435214996338
Epoch: 53, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.895 Vali Acc: 0.728 Test Loss: 0.895 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7443251609802246
Epoch: 54, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.904 Vali Acc: 0.744 Test Loss: 0.904 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7760543823242188
Epoch: 55, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.022 Vali Acc: 0.733 Test Loss: 1.022 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9780638217926025
Epoch: 56, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.940 Vali Acc: 0.744 Test Loss: 0.940 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7555555555555555
model parameter : 11566
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.104325294494629
Epoch: 1, Steps: 12 | Train Loss: 2.790 Vali Loss: 2.802 Vali Acc: 0.094 Test Loss: 2.802 Test Acc: 0.094
Validation loss decreased (inf --> -0.094416).  Saving model ...
Epoch: 2 cost time: 0.7460920810699463
Epoch: 2, Steps: 12 | Train Loss: 2.754 Vali Loss: 2.776 Vali Acc: 0.111 Test Loss: 2.776 Test Acc: 0.111
Validation loss decreased (-0.094416 --> -0.111083).  Saving model ...
Epoch: 3 cost time: 0.7944047451019287
Epoch: 3, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.741 Vali Acc: 0.128 Test Loss: 2.741 Test Acc: 0.128
Validation loss decreased (-0.111083 --> -0.127750).  Saving model ...
Epoch: 4 cost time: 0.7768304347991943
Epoch: 4, Steps: 12 | Train Loss: 2.674 Vali Loss: 2.701 Vali Acc: 0.139 Test Loss: 2.701 Test Acc: 0.139
Validation loss decreased (-0.127750 --> -0.138862).  Saving model ...
Epoch: 5 cost time: 0.7438900470733643
Epoch: 5, Steps: 12 | Train Loss: 2.632 Vali Loss: 2.658 Vali Acc: 0.161 Test Loss: 2.658 Test Acc: 0.161
Validation loss decreased (-0.138862 --> -0.161085).  Saving model ...
Epoch: 6 cost time: 0.7294480800628662
Epoch: 6, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.614 Vali Acc: 0.178 Test Loss: 2.614 Test Acc: 0.178
Validation loss decreased (-0.161085 --> -0.177752).  Saving model ...
Epoch: 7 cost time: 0.8583104610443115
Epoch: 7, Steps: 12 | Train Loss: 2.534 Vali Loss: 2.569 Vali Acc: 0.194 Test Loss: 2.569 Test Acc: 0.194
Validation loss decreased (-0.177752 --> -0.194419).  Saving model ...
Epoch: 8 cost time: 0.8753337860107422
Epoch: 8, Steps: 12 | Train Loss: 2.504 Vali Loss: 2.519 Vali Acc: 0.261 Test Loss: 2.519 Test Acc: 0.261
Validation loss decreased (-0.194419 --> -0.261086).  Saving model ...
Epoch: 9 cost time: 0.799389123916626
Epoch: 9, Steps: 12 | Train Loss: 2.415 Vali Loss: 2.474 Vali Acc: 0.289 Test Loss: 2.474 Test Acc: 0.289
Validation loss decreased (-0.261086 --> -0.288864).  Saving model ...
Epoch: 10 cost time: 0.7855126857757568
Epoch: 10, Steps: 12 | Train Loss: 2.374 Vali Loss: 2.422 Vali Acc: 0.283 Test Loss: 2.422 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.829113245010376
Epoch: 11, Steps: 12 | Train Loss: 2.319 Vali Loss: 2.372 Vali Acc: 0.317 Test Loss: 2.372 Test Acc: 0.317
Validation loss decreased (-0.288864 --> -0.316643).  Saving model ...
Epoch: 12 cost time: 0.775975227355957
Epoch: 12, Steps: 12 | Train Loss: 2.244 Vali Loss: 2.322 Vali Acc: 0.328 Test Loss: 2.322 Test Acc: 0.328
Validation loss decreased (-0.316643 --> -0.327755).  Saving model ...
Epoch: 13 cost time: 0.6995944976806641
Epoch: 13, Steps: 12 | Train Loss: 2.200 Vali Loss: 2.267 Vali Acc: 0.328 Test Loss: 2.267 Test Acc: 0.328
Validation loss decreased (-0.327755 --> -0.327755).  Saving model ...
Epoch: 14 cost time: 0.8588955402374268
Epoch: 14, Steps: 12 | Train Loss: 2.080 Vali Loss: 2.210 Vali Acc: 0.339 Test Loss: 2.210 Test Acc: 0.339
Validation loss decreased (-0.327755 --> -0.338867).  Saving model ...
Epoch: 15 cost time: 0.9200658798217773
Epoch: 15, Steps: 12 | Train Loss: 2.060 Vali Loss: 2.154 Vali Acc: 0.339 Test Loss: 2.154 Test Acc: 0.339
Validation loss decreased (-0.338867 --> -0.338867).  Saving model ...
Epoch: 16 cost time: 0.7936930656433105
Epoch: 16, Steps: 12 | Train Loss: 1.962 Vali Loss: 2.095 Vali Acc: 0.350 Test Loss: 2.095 Test Acc: 0.350
Validation loss decreased (-0.338867 --> -0.349979).  Saving model ...
Epoch: 17 cost time: 0.7329339981079102
Epoch: 17, Steps: 12 | Train Loss: 1.921 Vali Loss: 2.039 Vali Acc: 0.378 Test Loss: 2.039 Test Acc: 0.378
Validation loss decreased (-0.349979 --> -0.377757).  Saving model ...
Epoch: 18 cost time: 1.1362333297729492
Epoch: 18, Steps: 12 | Train Loss: 1.874 Vali Loss: 1.987 Vali Acc: 0.394 Test Loss: 1.987 Test Acc: 0.394
Validation loss decreased (-0.377757 --> -0.394425).  Saving model ...
Epoch: 19 cost time: 0.7367384433746338
Epoch: 19, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.935 Vali Acc: 0.400 Test Loss: 1.935 Test Acc: 0.400
Validation loss decreased (-0.394425 --> -0.399981).  Saving model ...
Epoch: 20 cost time: 0.9694385528564453
Epoch: 20, Steps: 12 | Train Loss: 1.732 Vali Loss: 1.870 Vali Acc: 0.439 Test Loss: 1.870 Test Acc: 0.439
Validation loss decreased (-0.399981 --> -0.438870).  Saving model ...
Epoch: 21 cost time: 0.7681500911712646
Epoch: 21, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.803 Vali Acc: 0.500 Test Loss: 1.803 Test Acc: 0.500
Validation loss decreased (-0.438870 --> -0.499982).  Saving model ...
Epoch: 22 cost time: 0.6398615837097168
Epoch: 22, Steps: 12 | Train Loss: 1.617 Vali Loss: 1.727 Vali Acc: 0.544 Test Loss: 1.727 Test Acc: 0.544
Validation loss decreased (-0.499982 --> -0.544427).  Saving model ...
Epoch: 23 cost time: 0.9110913276672363
Epoch: 23, Steps: 12 | Train Loss: 1.489 Vali Loss: 1.633 Vali Acc: 0.583 Test Loss: 1.633 Test Acc: 0.583
Validation loss decreased (-0.544427 --> -0.583317).  Saving model ...
Epoch: 24 cost time: 1.1222412586212158
Epoch: 24, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.530 Vali Acc: 0.611 Test Loss: 1.530 Test Acc: 0.611
Validation loss decreased (-0.583317 --> -0.611096).  Saving model ...
Epoch: 25 cost time: 0.8183891773223877
Epoch: 25, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.427 Vali Acc: 0.611 Test Loss: 1.427 Test Acc: 0.611
Validation loss decreased (-0.611096 --> -0.611097).  Saving model ...
Epoch: 26 cost time: 0.9787087440490723
Epoch: 26, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.312 Vali Acc: 0.622 Test Loss: 1.312 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 27 cost time: 0.9454188346862793
Epoch: 27, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.193 Vali Acc: 0.622 Test Loss: 1.193 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 28 cost time: 0.774571418762207
Epoch: 28, Steps: 12 | Train Loss: 0.896 Vali Loss: 1.062 Vali Acc: 0.628 Test Loss: 1.062 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627767).  Saving model ...
Epoch: 29 cost time: 0.7710323333740234
Epoch: 29, Steps: 12 | Train Loss: 0.822 Vali Loss: 0.949 Vali Acc: 0.661 Test Loss: 0.949 Test Acc: 0.661
Validation loss decreased (-0.627767 --> -0.661102).  Saving model ...
Epoch: 30 cost time: 0.80108642578125
Epoch: 30, Steps: 12 | Train Loss: 0.718 Vali Loss: 0.867 Vali Acc: 0.672 Test Loss: 0.867 Test Acc: 0.672
Validation loss decreased (-0.661102 --> -0.672214).  Saving model ...
Epoch: 31 cost time: 0.773291826248169
Epoch: 31, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.810 Vali Acc: 0.667 Test Loss: 0.810 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7538907527923584
Epoch: 32, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.745 Vali Acc: 0.683 Test Loss: 0.745 Test Acc: 0.683
Validation loss decreased (-0.672214 --> -0.683326).  Saving model ...
Epoch: 33 cost time: 0.8468484878540039
Epoch: 33, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.683326 --> -0.749993).  Saving model ...
Epoch: 34 cost time: 1.1241741180419922
Epoch: 34, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
Validation loss decreased (-0.749993 --> -0.788882).  Saving model ...
Epoch: 35 cost time: 0.9389870166778564
Epoch: 35, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.612 Vali Acc: 0.806 Test Loss: 0.612 Test Acc: 0.806
Validation loss decreased (-0.788882 --> -0.805549).  Saving model ...
Epoch: 36 cost time: 1.009948492050171
Epoch: 36, Steps: 12 | Train Loss: 0.366 Vali Loss: 0.574 Vali Acc: 0.806 Test Loss: 0.574 Test Acc: 0.806
Validation loss decreased (-0.805549 --> -0.805550).  Saving model ...
Epoch: 37 cost time: 0.7691187858581543
Epoch: 37, Steps: 12 | Train Loss: 0.321 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7268779277801514
Epoch: 38, Steps: 12 | Train Loss: 0.282 Vali Loss: 0.530 Vali Acc: 0.800 Test Loss: 0.530 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.011836051940918
Epoch: 39, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.576 Vali Acc: 0.800 Test Loss: 0.576 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0309264659881592
Epoch: 40, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.514 Vali Acc: 0.817 Test Loss: 0.514 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816662).  Saving model ...
Epoch: 41 cost time: 0.8774814605712891
Epoch: 41, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.506 Vali Acc: 0.806 Test Loss: 0.506 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9964630603790283
Epoch: 42, Steps: 12 | Train Loss: 0.186 Vali Loss: 0.470 Vali Acc: 0.817 Test Loss: 0.470 Test Acc: 0.817
Validation loss decreased (-0.816662 --> -0.816662).  Saving model ...
Epoch: 43 cost time: 0.9967541694641113
Epoch: 43, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.485 Vali Acc: 0.800 Test Loss: 0.485 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0986216068267822
Epoch: 44, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.479 Vali Acc: 0.800 Test Loss: 0.479 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0193591117858887
Epoch: 45, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.477 Vali Acc: 0.811 Test Loss: 0.477 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9072227478027344
Epoch: 46, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.478 Vali Acc: 0.828 Test Loss: 0.478 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 47 cost time: 0.8651309013366699
Epoch: 47, Steps: 12 | Train Loss: 0.092 Vali Loss: 0.553 Vali Acc: 0.822 Test Loss: 0.553 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0725369453430176
Epoch: 48, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.481 Vali Acc: 0.828 Test Loss: 0.481 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.1611502170562744
Epoch: 49, Steps: 12 | Train Loss: 0.134 Vali Loss: 0.465 Vali Acc: 0.828 Test Loss: 0.465 Test Acc: 0.828
Validation loss decreased (-0.827773 --> -0.827773).  Saving model ...
Epoch: 50 cost time: 1.0333027839660645
Epoch: 50, Steps: 12 | Train Loss: 0.084 Vali Loss: 0.488 Vali Acc: 0.811 Test Loss: 0.488 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1042821407318115
Epoch: 51, Steps: 12 | Train Loss: 0.077 Vali Loss: 0.496 Vali Acc: 0.839 Test Loss: 0.496 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838884).  Saving model ...
Epoch: 52 cost time: 0.986076831817627
Epoch: 52, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8654272556304932
Epoch: 53, Steps: 12 | Train Loss: 0.063 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0376574993133545
Epoch: 54, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.517 Vali Acc: 0.828 Test Loss: 0.517 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8484773635864258
Epoch: 55, Steps: 12 | Train Loss: 0.062 Vali Loss: 0.537 Vali Acc: 0.806 Test Loss: 0.537 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9151301383972168
Epoch: 56, Steps: 12 | Train Loss: 0.049 Vali Loss: 0.563 Vali Acc: 0.806 Test Loss: 0.563 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.8285009860992432
Epoch: 57, Steps: 12 | Train Loss: 0.044 Vali Loss: 0.574 Vali Acc: 0.811 Test Loss: 0.574 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0372083187103271
Epoch: 58, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.817 Test Loss: 0.568 Test Acc: 0.817
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.8327243328094482
Epoch: 59, Steps: 12 | Train Loss: 0.040 Vali Loss: 0.609 Vali Acc: 0.828 Test Loss: 0.609 Test Acc: 0.828
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9920220375061035
Epoch: 60, Steps: 12 | Train Loss: 0.038 Vali Loss: 0.560 Vali Acc: 0.806 Test Loss: 0.560 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.7016534805297852
Epoch: 61, Steps: 12 | Train Loss: 0.037 Vali Loss: 0.568 Vali Acc: 0.839 Test Loss: 0.568 Test Acc: 0.839
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 11527
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5067946910858154
Epoch: 1, Steps: 12 | Train Loss: 2.775 Vali Loss: 2.766 Vali Acc: 0.072 Test Loss: 2.766 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.9112889766693115
Epoch: 2, Steps: 12 | Train Loss: 2.759 Vali Loss: 2.740 Vali Acc: 0.072 Test Loss: 2.740 Test Acc: 0.072
Validation loss decreased (-0.072195 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.7476069927215576
Epoch: 3, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.703 Vali Acc: 0.094 Test Loss: 2.703 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094417).  Saving model ...
Epoch: 4 cost time: 1.1165895462036133
Epoch: 4, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.660 Vali Acc: 0.089 Test Loss: 2.660 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7618703842163086
Epoch: 5, Steps: 12 | Train Loss: 2.627 Vali Loss: 2.612 Vali Acc: 0.128 Test Loss: 2.612 Test Acc: 0.128
Validation loss decreased (-0.094417 --> -0.127752).  Saving model ...
Epoch: 6 cost time: 0.8889429569244385
Epoch: 6, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.561 Vali Acc: 0.178 Test Loss: 2.561 Test Acc: 0.178
Validation loss decreased (-0.127752 --> -0.177752).  Saving model ...
Epoch: 7 cost time: 0.874561071395874
Epoch: 7, Steps: 12 | Train Loss: 2.519 Vali Loss: 2.503 Vali Acc: 0.228 Test Loss: 2.503 Test Acc: 0.228
Validation loss decreased (-0.177752 --> -0.227753).  Saving model ...
Epoch: 8 cost time: 0.7502415180206299
Epoch: 8, Steps: 12 | Train Loss: 2.446 Vali Loss: 2.440 Vali Acc: 0.272 Test Loss: 2.440 Test Acc: 0.272
Validation loss decreased (-0.227753 --> -0.272198).  Saving model ...
Epoch: 9 cost time: 0.9710245132446289
Epoch: 9, Steps: 12 | Train Loss: 2.366 Vali Loss: 2.367 Vali Acc: 0.306 Test Loss: 2.367 Test Acc: 0.306
Validation loss decreased (-0.272198 --> -0.305532).  Saving model ...
Epoch: 10 cost time: 1.082517385482788
Epoch: 10, Steps: 12 | Train Loss: 2.303 Vali Loss: 2.286 Vali Acc: 0.339 Test Loss: 2.286 Test Acc: 0.339
Validation loss decreased (-0.305532 --> -0.338866).  Saving model ...
Epoch: 11 cost time: 0.9534816741943359
Epoch: 11, Steps: 12 | Train Loss: 2.178 Vali Loss: 2.197 Vali Acc: 0.350 Test Loss: 2.197 Test Acc: 0.350
Validation loss decreased (-0.338866 --> -0.349978).  Saving model ...
Epoch: 12 cost time: 0.8556630611419678
Epoch: 12, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.093 Vali Acc: 0.383 Test Loss: 2.093 Test Acc: 0.383
Validation loss decreased (-0.349978 --> -0.383312).  Saving model ...
Epoch: 13 cost time: 0.7878968715667725
Epoch: 13, Steps: 12 | Train Loss: 1.946 Vali Loss: 1.988 Vali Acc: 0.417 Test Loss: 1.988 Test Acc: 0.417
Validation loss decreased (-0.383312 --> -0.416647).  Saving model ...
Epoch: 14 cost time: 1.0362470149993896
Epoch: 14, Steps: 12 | Train Loss: 1.866 Vali Loss: 1.874 Vali Acc: 0.444 Test Loss: 1.874 Test Acc: 0.444
Validation loss decreased (-0.416647 --> -0.444426).  Saving model ...
Epoch: 15 cost time: 0.791649341583252
Epoch: 15, Steps: 12 | Train Loss: 1.741 Vali Loss: 1.778 Vali Acc: 0.439 Test Loss: 1.778 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9128470420837402
Epoch: 16, Steps: 12 | Train Loss: 1.674 Vali Loss: 1.674 Vali Acc: 0.450 Test Loss: 1.674 Test Acc: 0.450
Validation loss decreased (-0.444426 --> -0.449983).  Saving model ...
Epoch: 17 cost time: 0.7237823009490967
Epoch: 17, Steps: 12 | Train Loss: 1.520 Vali Loss: 1.585 Vali Acc: 0.517 Test Loss: 1.585 Test Acc: 0.517
Validation loss decreased (-0.449983 --> -0.516651).  Saving model ...
Epoch: 18 cost time: 0.8848536014556885
Epoch: 18, Steps: 12 | Train Loss: 1.421 Vali Loss: 1.515 Vali Acc: 0.528 Test Loss: 1.515 Test Acc: 0.528
Validation loss decreased (-0.516651 --> -0.527763).  Saving model ...
Epoch: 19 cost time: 0.9311552047729492
Epoch: 19, Steps: 12 | Train Loss: 1.343 Vali Loss: 1.471 Vali Acc: 0.506 Test Loss: 1.471 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9626638889312744
Epoch: 20, Steps: 12 | Train Loss: 1.255 Vali Loss: 1.382 Vali Acc: 0.522 Test Loss: 1.382 Test Acc: 0.522
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.957082986831665
Epoch: 21, Steps: 12 | Train Loss: 1.185 Vali Loss: 1.301 Vali Acc: 0.561 Test Loss: 1.301 Test Acc: 0.561
Validation loss decreased (-0.527763 --> -0.561098).  Saving model ...
Epoch: 22 cost time: 0.8061037063598633
Epoch: 22, Steps: 12 | Train Loss: 1.124 Vali Loss: 1.264 Vali Acc: 0.556 Test Loss: 1.264 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6876757144927979
Epoch: 23, Steps: 12 | Train Loss: 1.096 Vali Loss: 1.257 Vali Acc: 0.539 Test Loss: 1.257 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8452763557434082
Epoch: 24, Steps: 12 | Train Loss: 0.975 Vali Loss: 1.155 Vali Acc: 0.622 Test Loss: 1.155 Test Acc: 0.622
Validation loss decreased (-0.561098 --> -0.622211).  Saving model ...
Epoch: 25 cost time: 0.8368499279022217
Epoch: 25, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.120 Vali Acc: 0.578 Test Loss: 1.120 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8058979511260986
Epoch: 26, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.106 Vali Acc: 0.561 Test Loss: 1.106 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7998881340026855
Epoch: 27, Steps: 12 | Train Loss: 0.844 Vali Loss: 1.079 Vali Acc: 0.600 Test Loss: 1.079 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8944001197814941
Epoch: 28, Steps: 12 | Train Loss: 0.798 Vali Loss: 1.070 Vali Acc: 0.583 Test Loss: 1.070 Test Acc: 0.583
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8652520179748535
Epoch: 29, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.047 Vali Acc: 0.622 Test Loss: 1.047 Test Acc: 0.622
Validation loss decreased (-0.622211 --> -0.622212).  Saving model ...
Epoch: 30 cost time: 0.8812260627746582
Epoch: 30, Steps: 12 | Train Loss: 0.735 Vali Loss: 0.972 Vali Acc: 0.617 Test Loss: 0.972 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0300307273864746
Epoch: 31, Steps: 12 | Train Loss: 0.716 Vali Loss: 0.975 Vali Acc: 0.633 Test Loss: 0.975 Test Acc: 0.633
Validation loss decreased (-0.622212 --> -0.633324).  Saving model ...
Epoch: 32 cost time: 0.8561689853668213
Epoch: 32, Steps: 12 | Train Loss: 0.640 Vali Loss: 0.937 Vali Acc: 0.678 Test Loss: 0.937 Test Acc: 0.678
Validation loss decreased (-0.633324 --> -0.677768).  Saving model ...
Epoch: 33 cost time: 0.6494162082672119
Epoch: 33, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.916 Vali Acc: 0.678 Test Loss: 0.916 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677769).  Saving model ...
Epoch: 34 cost time: 0.7993245124816895
Epoch: 34, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.874 Vali Acc: 0.694 Test Loss: 0.874 Test Acc: 0.694
Validation loss decreased (-0.677769 --> -0.694436).  Saving model ...
Epoch: 35 cost time: 0.7936892509460449
Epoch: 35, Steps: 12 | Train Loss: 0.578 Vali Loss: 0.883 Vali Acc: 0.694 Test Loss: 0.883 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2065150737762451
Epoch: 36, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.822 Vali Acc: 0.689 Test Loss: 0.822 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6903588771820068
Epoch: 37, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.828 Vali Acc: 0.683 Test Loss: 0.828 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6494066715240479
Epoch: 38, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.798 Vali Acc: 0.706 Test Loss: 0.798 Test Acc: 0.706
Validation loss decreased (-0.694436 --> -0.705548).  Saving model ...
Epoch: 39 cost time: 0.8390402793884277
Epoch: 39, Steps: 12 | Train Loss: 0.433 Vali Loss: 0.778 Vali Acc: 0.728 Test Loss: 0.778 Test Acc: 0.728
Validation loss decreased (-0.705548 --> -0.727770).  Saving model ...
Epoch: 40 cost time: 0.8661744594573975
Epoch: 40, Steps: 12 | Train Loss: 0.436 Vali Loss: 0.769 Vali Acc: 0.711 Test Loss: 0.769 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8959941864013672
Epoch: 41, Steps: 12 | Train Loss: 0.429 Vali Loss: 0.753 Vali Acc: 0.728 Test Loss: 0.753 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 42 cost time: 0.8929061889648438
Epoch: 42, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.747 Vali Acc: 0.756 Test Loss: 0.747 Test Acc: 0.756
Validation loss decreased (-0.727770 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 0.6019070148468018
Epoch: 43, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.764 Vali Acc: 0.739 Test Loss: 0.764 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7673542499542236
Epoch: 44, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.708 Vali Acc: 0.761 Test Loss: 0.708 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 45 cost time: 0.8686740398406982
Epoch: 45, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.742 Vali Acc: 0.756 Test Loss: 0.742 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8234577178955078
Epoch: 46, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.788 Vali Acc: 0.728 Test Loss: 0.788 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8670611381530762
Epoch: 47, Steps: 12 | Train Loss: 0.276 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.1137771606445312
Epoch: 48, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.719 Vali Acc: 0.772 Test Loss: 0.719 Test Acc: 0.772
Validation loss decreased (-0.761104 --> -0.772215).  Saving model ...
Epoch: 49 cost time: 0.9285762310028076
Epoch: 49, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.766 Vali Acc: 0.778 Test Loss: 0.766 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 50 cost time: 0.9851367473602295
Epoch: 50, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.758 Vali Acc: 0.761 Test Loss: 0.758 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8684680461883545
Epoch: 51, Steps: 12 | Train Loss: 0.210 Vali Loss: 0.771 Vali Acc: 0.772 Test Loss: 0.771 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9330806732177734
Epoch: 52, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1911487579345703
Epoch: 53, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 54 cost time: 0.9753246307373047
Epoch: 54, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.808 Vali Acc: 0.778 Test Loss: 0.808 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8563365936279297
Epoch: 55, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.833 Vali Acc: 0.783 Test Loss: 0.833 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7398293018341064
Epoch: 56, Steps: 12 | Train Loss: 0.199 Vali Loss: 0.777 Vali Acc: 0.778 Test Loss: 0.777 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8694791793823242
Epoch: 57, Steps: 12 | Train Loss: 0.127 Vali Loss: 0.886 Vali Acc: 0.783 Test Loss: 0.886 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.828132152557373
Epoch: 58, Steps: 12 | Train Loss: 0.120 Vali Loss: 0.834 Vali Acc: 0.800 Test Loss: 0.834 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799992).  Saving model ...
Epoch: 59 cost time: 0.7916285991668701
Epoch: 59, Steps: 12 | Train Loss: 0.114 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.038705825805664
Epoch: 60, Steps: 12 | Train Loss: 0.133 Vali Loss: 0.949 Vali Acc: 0.794 Test Loss: 0.949 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8780534267425537
Epoch: 61, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8897852897644043
Epoch: 62, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.966 Vali Acc: 0.772 Test Loss: 0.966 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8396177291870117
Epoch: 63, Steps: 12 | Train Loss: 0.099 Vali Loss: 0.892 Vali Acc: 0.783 Test Loss: 0.892 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7952933311462402
Epoch: 64, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.048 Vali Acc: 0.772 Test Loss: 1.048 Test Acc: 0.772
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6964578628540039
Epoch: 65, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.886 Vali Acc: 0.772 Test Loss: 0.886 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.7943422794342041
Epoch: 66, Steps: 12 | Train Loss: 0.105 Vali Loss: 1.031 Vali Acc: 0.761 Test Loss: 1.031 Test Acc: 0.761
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.0370972156524658
Epoch: 67, Steps: 12 | Train Loss: 0.091 Vali Loss: 0.979 Vali Acc: 0.789 Test Loss: 0.979 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.2309329509735107
Epoch: 68, Steps: 12 | Train Loss: 0.060 Vali Loss: 0.947 Vali Acc: 0.806 Test Loss: 0.947 Test Acc: 0.806
Validation loss decreased (-0.799992 --> -0.805546).  Saving model ...
Epoch: 69 cost time: 1.002816915512085
Epoch: 69, Steps: 12 | Train Loss: 0.055 Vali Loss: 1.065 Vali Acc: 0.756 Test Loss: 1.065 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9706120491027832
Epoch: 70, Steps: 12 | Train Loss: 0.087 Vali Loss: 0.942 Vali Acc: 0.817 Test Loss: 0.942 Test Acc: 0.817
Validation loss decreased (-0.805546 --> -0.816657).  Saving model ...
Epoch: 71 cost time: 0.8549542427062988
Epoch: 71, Steps: 12 | Train Loss: 0.059 Vali Loss: 1.010 Vali Acc: 0.772 Test Loss: 1.010 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8999061584472656
Epoch: 72, Steps: 12 | Train Loss: 0.056 Vali Loss: 1.102 Vali Acc: 0.789 Test Loss: 1.102 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5599415302276611
Epoch: 73, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.128 Vali Acc: 0.767 Test Loss: 1.128 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8343105316162109
Epoch: 74, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.068 Vali Acc: 0.767 Test Loss: 1.068 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.8587019443511963
Epoch: 75, Steps: 12 | Train Loss: 0.046 Vali Loss: 1.253 Vali Acc: 0.767 Test Loss: 1.253 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8026092052459717
Epoch: 76, Steps: 12 | Train Loss: 0.028 Vali Loss: 1.085 Vali Acc: 0.761 Test Loss: 1.085 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 1.2113945484161377
Epoch: 77, Steps: 12 | Train Loss: 0.022 Vali Loss: 1.196 Vali Acc: 0.756 Test Loss: 1.196 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.9405660629272461
Epoch: 78, Steps: 12 | Train Loss: 0.031 Vali Loss: 1.134 Vali Acc: 0.783 Test Loss: 1.134 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.7152070999145508
Epoch: 79, Steps: 12 | Train Loss: 0.049 Vali Loss: 1.143 Vali Acc: 0.767 Test Loss: 1.143 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.83988356590271
Epoch: 80, Steps: 12 | Train Loss: 0.032 Vali Loss: 1.264 Vali Acc: 0.767 Test Loss: 1.264 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 11222
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.922821283340454
Epoch: 1, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.798 Vali Acc: 0.056 Test Loss: 2.798 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.7730529308319092
Epoch: 2, Steps: 12 | Train Loss: 2.785 Vali Loss: 2.770 Vali Acc: 0.072 Test Loss: 2.770 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 1.0042614936828613
Epoch: 3, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.732 Vali Acc: 0.094 Test Loss: 2.732 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094417).  Saving model ...
Epoch: 4 cost time: 0.7954568862915039
Epoch: 4, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.687 Vali Acc: 0.122 Test Loss: 2.687 Test Acc: 0.122
Validation loss decreased (-0.094417 --> -0.122195).  Saving model ...
Epoch: 5 cost time: 0.8042011260986328
Epoch: 5, Steps: 12 | Train Loss: 2.639 Vali Loss: 2.635 Vali Acc: 0.144 Test Loss: 2.635 Test Acc: 0.144
Validation loss decreased (-0.122195 --> -0.144418).  Saving model ...
Epoch: 6 cost time: 1.0627498626708984
Epoch: 6, Steps: 12 | Train Loss: 2.589 Vali Loss: 2.580 Vali Acc: 0.156 Test Loss: 2.580 Test Acc: 0.156
Validation loss decreased (-0.144418 --> -0.155530).  Saving model ...
Epoch: 7 cost time: 0.8479940891265869
Epoch: 7, Steps: 12 | Train Loss: 2.529 Vali Loss: 2.517 Vali Acc: 0.194 Test Loss: 2.517 Test Acc: 0.194
Validation loss decreased (-0.155530 --> -0.194419).  Saving model ...
Epoch: 8 cost time: 0.9027740955352783
Epoch: 8, Steps: 12 | Train Loss: 2.424 Vali Loss: 2.448 Vali Acc: 0.211 Test Loss: 2.448 Test Acc: 0.211
Validation loss decreased (-0.194419 --> -0.211087).  Saving model ...
Epoch: 9 cost time: 0.7298088073730469
Epoch: 9, Steps: 12 | Train Loss: 2.371 Vali Loss: 2.371 Vali Acc: 0.239 Test Loss: 2.371 Test Acc: 0.239
Validation loss decreased (-0.211087 --> -0.238865).  Saving model ...
Epoch: 10 cost time: 0.8132510185241699
Epoch: 10, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.287 Vali Acc: 0.283 Test Loss: 2.287 Test Acc: 0.283
Validation loss decreased (-0.238865 --> -0.283310).  Saving model ...
Epoch: 11 cost time: 0.8640804290771484
Epoch: 11, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.190 Vali Acc: 0.322 Test Loss: 2.190 Test Acc: 0.322
Validation loss decreased (-0.283310 --> -0.322200).  Saving model ...
Epoch: 12 cost time: 1.1134111881256104
Epoch: 12, Steps: 12 | Train Loss: 2.087 Vali Loss: 2.089 Vali Acc: 0.356 Test Loss: 2.089 Test Acc: 0.356
Validation loss decreased (-0.322200 --> -0.355535).  Saving model ...
Epoch: 13 cost time: 0.8883740901947021
Epoch: 13, Steps: 12 | Train Loss: 1.950 Vali Loss: 1.987 Vali Acc: 0.444 Test Loss: 1.987 Test Acc: 0.444
Validation loss decreased (-0.355535 --> -0.444425).  Saving model ...
Epoch: 14 cost time: 0.7864601612091064
Epoch: 14, Steps: 12 | Train Loss: 1.843 Vali Loss: 1.883 Vali Acc: 0.461 Test Loss: 1.883 Test Acc: 0.461
Validation loss decreased (-0.444425 --> -0.461092).  Saving model ...
Epoch: 15 cost time: 0.8313665390014648
Epoch: 15, Steps: 12 | Train Loss: 1.700 Vali Loss: 1.788 Vali Acc: 0.478 Test Loss: 1.788 Test Acc: 0.478
Validation loss decreased (-0.461092 --> -0.477760).  Saving model ...
Epoch: 16 cost time: 1.010549545288086
Epoch: 16, Steps: 12 | Train Loss: 1.607 Vali Loss: 1.688 Vali Acc: 0.500 Test Loss: 1.688 Test Acc: 0.500
Validation loss decreased (-0.477760 --> -0.499983).  Saving model ...
Epoch: 17 cost time: 0.8875644207000732
Epoch: 17, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.591 Vali Acc: 0.494 Test Loss: 1.591 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9001452922821045
Epoch: 18, Steps: 12 | Train Loss: 1.441 Vali Loss: 1.494 Vali Acc: 0.528 Test Loss: 1.494 Test Acc: 0.528
Validation loss decreased (-0.499983 --> -0.527763).  Saving model ...
Epoch: 19 cost time: 0.91017746925354
Epoch: 19, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.422 Vali Acc: 0.522 Test Loss: 1.422 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0926907062530518
Epoch: 20, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.355 Vali Acc: 0.539 Test Loss: 1.355 Test Acc: 0.539
Validation loss decreased (-0.527763 --> -0.538875).  Saving model ...
Epoch: 21 cost time: 1.136946201324463
Epoch: 21, Steps: 12 | Train Loss: 1.106 Vali Loss: 1.292 Vali Acc: 0.578 Test Loss: 1.292 Test Acc: 0.578
Validation loss decreased (-0.538875 --> -0.577765).  Saving model ...
Epoch: 22 cost time: 0.8983685970306396
Epoch: 22, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.224 Vali Acc: 0.611 Test Loss: 1.224 Test Acc: 0.611
Validation loss decreased (-0.577765 --> -0.611099).  Saving model ...
Epoch: 23 cost time: 0.9714808464050293
Epoch: 23, Steps: 12 | Train Loss: 0.972 Vali Loss: 1.190 Vali Acc: 0.606 Test Loss: 1.190 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9534285068511963
Epoch: 24, Steps: 12 | Train Loss: 0.893 Vali Loss: 1.149 Vali Acc: 0.617 Test Loss: 1.149 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 25 cost time: 0.8805105686187744
Epoch: 25, Steps: 12 | Train Loss: 0.872 Vali Loss: 1.115 Vali Acc: 0.622 Test Loss: 1.115 Test Acc: 0.622
Validation loss decreased (-0.616655 --> -0.622211).  Saving model ...
Epoch: 26 cost time: 0.8864455223083496
Epoch: 26, Steps: 12 | Train Loss: 0.802 Vali Loss: 1.054 Vali Acc: 0.650 Test Loss: 1.054 Test Acc: 0.650
Validation loss decreased (-0.622211 --> -0.649989).  Saving model ...
Epoch: 27 cost time: 0.7710974216461182
Epoch: 27, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.009 Vali Acc: 0.667 Test Loss: 1.009 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666657).  Saving model ...
Epoch: 28 cost time: 0.702232837677002
Epoch: 28, Steps: 12 | Train Loss: 0.683 Vali Loss: 0.951 Vali Acc: 0.678 Test Loss: 0.951 Test Acc: 0.678
Validation loss decreased (-0.666657 --> -0.677768).  Saving model ...
Epoch: 29 cost time: 1.0038299560546875
Epoch: 29, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.925 Vali Acc: 0.689 Test Loss: 0.925 Test Acc: 0.689
Validation loss decreased (-0.677768 --> -0.688880).  Saving model ...
Epoch: 30 cost time: 0.8944849967956543
Epoch: 30, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.896 Vali Acc: 0.694 Test Loss: 0.896 Test Acc: 0.694
Validation loss decreased (-0.688880 --> -0.694435).  Saving model ...
Epoch: 31 cost time: 0.8198561668395996
Epoch: 31, Steps: 12 | Train Loss: 0.590 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
Validation loss decreased (-0.694435 --> -0.716658).  Saving model ...
Epoch: 32 cost time: 0.7264614105224609
Epoch: 32, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.841 Vali Acc: 0.717 Test Loss: 0.841 Test Acc: 0.717
Validation loss decreased (-0.716658 --> -0.716658).  Saving model ...
Epoch: 33 cost time: 0.7022237777709961
Epoch: 33, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.838 Vali Acc: 0.694 Test Loss: 0.838 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8231527805328369
Epoch: 34, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.768 Vali Acc: 0.744 Test Loss: 0.768 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744437).  Saving model ...
Epoch: 35 cost time: 0.687467098236084
Epoch: 35, Steps: 12 | Train Loss: 0.523 Vali Loss: 0.813 Vali Acc: 0.689 Test Loss: 0.813 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.202519416809082
Epoch: 36, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.766 Vali Acc: 0.722 Test Loss: 0.766 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9460713863372803
Epoch: 37, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8409342765808105
Epoch: 38, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.741 Vali Acc: 0.700 Test Loss: 0.741 Test Acc: 0.700
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9332127571105957
Epoch: 39, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.726 Vali Acc: 0.728 Test Loss: 0.726 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7209174633026123
Epoch: 40, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.714 Vali Acc: 0.728 Test Loss: 0.714 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8331780433654785
Epoch: 41, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.694 Vali Acc: 0.739 Test Loss: 0.694 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.771369218826294
Epoch: 42, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.726 Vali Acc: 0.722 Test Loss: 0.726 Test Acc: 0.722
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9111158847808838
Epoch: 43, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.689 Vali Acc: 0.733 Test Loss: 0.689 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.763742208480835
Epoch: 44, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.698 Vali Acc: 0.756 Test Loss: 0.698 Test Acc: 0.756
Validation loss decreased (-0.744437 --> -0.755549).  Saving model ...
Epoch: 45 cost time: 0.8463912010192871
Epoch: 45, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.729 Vali Acc: 0.711 Test Loss: 0.729 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.009850263595581
Epoch: 46, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.659 Vali Acc: 0.761 Test Loss: 0.659 Test Acc: 0.761
Validation loss decreased (-0.755549 --> -0.761105).  Saving model ...
Epoch: 47 cost time: 0.9070320129394531
Epoch: 47, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.665 Vali Acc: 0.733 Test Loss: 0.665 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0388915538787842
Epoch: 48, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.661 Vali Acc: 0.778 Test Loss: 0.661 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777771).  Saving model ...
Epoch: 49 cost time: 0.8427793979644775
Epoch: 49, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.665 Vali Acc: 0.739 Test Loss: 0.665 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8443279266357422
Epoch: 50, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.660 Vali Acc: 0.761 Test Loss: 0.660 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9772448539733887
Epoch: 51, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.679 Vali Acc: 0.756 Test Loss: 0.679 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9536058902740479
Epoch: 52, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.710 Vali Acc: 0.739 Test Loss: 0.710 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2745630741119385
Epoch: 53, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.672 Vali Acc: 0.744 Test Loss: 0.672 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0601844787597656
Epoch: 54, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.697 Vali Acc: 0.750 Test Loss: 0.697 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.2624900341033936
Epoch: 55, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.727 Vali Acc: 0.756 Test Loss: 0.727 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.8477110862731934
Epoch: 56, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 57 cost time: 0.7416560649871826
Epoch: 57, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.746 Vali Acc: 0.733 Test Loss: 0.746 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9264335632324219
Epoch: 58, Steps: 12 | Train Loss: 0.151 Vali Loss: 0.751 Vali Acc: 0.767 Test Loss: 0.751 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7718305587768555
Epoch: 59, Steps: 12 | Train Loss: 0.152 Vali Loss: 0.725 Vali Acc: 0.767 Test Loss: 0.725 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8049824237823486
Epoch: 60, Steps: 12 | Train Loss: 0.159 Vali Loss: 0.730 Vali Acc: 0.783 Test Loss: 0.730 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.8153488636016846
Epoch: 61, Steps: 12 | Train Loss: 0.140 Vali Loss: 0.806 Vali Acc: 0.722 Test Loss: 0.806 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8106677532196045
Epoch: 62, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.796 Vali Acc: 0.756 Test Loss: 0.796 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.9887697696685791
Epoch: 63, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.750 Vali Acc: 0.778 Test Loss: 0.750 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.110501766204834
Epoch: 64, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.809 Vali Acc: 0.717 Test Loss: 0.809 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.7979142665863037
Epoch: 65, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.970 Vali Acc: 0.739 Test Loss: 0.970 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.8997600078582764
Epoch: 66, Steps: 12 | Train Loss: 0.180 Vali Loss: 0.826 Vali Acc: 0.744 Test Loss: 0.826 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 11319
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.229356527328491
Epoch: 1, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.818 Vali Acc: 0.011 Test Loss: 2.818 Test Acc: 0.011
Validation loss decreased (inf --> -0.011083).  Saving model ...
Epoch: 2 cost time: 0.7237393856048584
Epoch: 2, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.791 Vali Acc: 0.017 Test Loss: 2.791 Test Acc: 0.017
Validation loss decreased (-0.011083 --> -0.016639).  Saving model ...
Epoch: 3 cost time: 0.8600819110870361
Epoch: 3, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.756 Vali Acc: 0.033 Test Loss: 2.756 Test Acc: 0.033
Validation loss decreased (-0.016639 --> -0.033306).  Saving model ...
Epoch: 4 cost time: 1.0092825889587402
Epoch: 4, Steps: 12 | Train Loss: 2.666 Vali Loss: 2.718 Vali Acc: 0.050 Test Loss: 2.718 Test Acc: 0.050
Validation loss decreased (-0.033306 --> -0.049973).  Saving model ...
Epoch: 5 cost time: 0.8307919502258301
Epoch: 5, Steps: 12 | Train Loss: 2.618 Vali Loss: 2.676 Vali Acc: 0.050 Test Loss: 2.676 Test Acc: 0.050
Validation loss decreased (-0.049973 --> -0.049973).  Saving model ...
Epoch: 6 cost time: 0.7666637897491455
Epoch: 6, Steps: 12 | Train Loss: 2.585 Vali Loss: 2.631 Vali Acc: 0.100 Test Loss: 2.631 Test Acc: 0.100
Validation loss decreased (-0.049973 --> -0.099974).  Saving model ...
Epoch: 7 cost time: 1.0250120162963867
Epoch: 7, Steps: 12 | Train Loss: 2.530 Vali Loss: 2.578 Vali Acc: 0.117 Test Loss: 2.578 Test Acc: 0.117
Validation loss decreased (-0.099974 --> -0.116641).  Saving model ...
Epoch: 8 cost time: 0.8024299144744873
Epoch: 8, Steps: 12 | Train Loss: 2.470 Vali Loss: 2.522 Vali Acc: 0.139 Test Loss: 2.522 Test Acc: 0.139
Validation loss decreased (-0.116641 --> -0.138864).  Saving model ...
Epoch: 9 cost time: 1.0846142768859863
Epoch: 9, Steps: 12 | Train Loss: 2.404 Vali Loss: 2.469 Vali Acc: 0.222 Test Loss: 2.469 Test Acc: 0.222
Validation loss decreased (-0.138864 --> -0.222198).  Saving model ...
Epoch: 10 cost time: 0.965301513671875
Epoch: 10, Steps: 12 | Train Loss: 2.344 Vali Loss: 2.415 Vali Acc: 0.289 Test Loss: 2.415 Test Acc: 0.289
Validation loss decreased (-0.222198 --> -0.288865).  Saving model ...
Epoch: 11 cost time: 0.8400630950927734
Epoch: 11, Steps: 12 | Train Loss: 2.280 Vali Loss: 2.356 Vali Acc: 0.328 Test Loss: 2.356 Test Acc: 0.328
Validation loss decreased (-0.288865 --> -0.327754).  Saving model ...
Epoch: 12 cost time: 0.911501407623291
Epoch: 12, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.295 Vali Acc: 0.372 Test Loss: 2.295 Test Acc: 0.372
Validation loss decreased (-0.327754 --> -0.372199).  Saving model ...
Epoch: 13 cost time: 0.8520565032958984
Epoch: 13, Steps: 12 | Train Loss: 2.119 Vali Loss: 2.219 Vali Acc: 0.394 Test Loss: 2.219 Test Acc: 0.394
Validation loss decreased (-0.372199 --> -0.394422).  Saving model ...
Epoch: 14 cost time: 0.9122650623321533
Epoch: 14, Steps: 12 | Train Loss: 2.047 Vali Loss: 2.150 Vali Acc: 0.444 Test Loss: 2.150 Test Acc: 0.444
Validation loss decreased (-0.394422 --> -0.444423).  Saving model ...
Epoch: 15 cost time: 1.0675594806671143
Epoch: 15, Steps: 12 | Train Loss: 1.981 Vali Loss: 2.076 Vali Acc: 0.456 Test Loss: 2.076 Test Acc: 0.456
Validation loss decreased (-0.444423 --> -0.455535).  Saving model ...
Epoch: 16 cost time: 0.8113584518432617
Epoch: 16, Steps: 12 | Train Loss: 1.893 Vali Loss: 2.003 Vali Acc: 0.500 Test Loss: 2.003 Test Acc: 0.500
Validation loss decreased (-0.455535 --> -0.499980).  Saving model ...
Epoch: 17 cost time: 0.8056371212005615
Epoch: 17, Steps: 12 | Train Loss: 1.778 Vali Loss: 1.920 Vali Acc: 0.511 Test Loss: 1.920 Test Acc: 0.511
Validation loss decreased (-0.499980 --> -0.511092).  Saving model ...
Epoch: 18 cost time: 0.9147870540618896
Epoch: 18, Steps: 12 | Train Loss: 1.694 Vali Loss: 1.842 Vali Acc: 0.528 Test Loss: 1.842 Test Acc: 0.528
Validation loss decreased (-0.511092 --> -0.527759).  Saving model ...
Epoch: 19 cost time: 1.070033311843872
Epoch: 19, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.750 Vali Acc: 0.506 Test Loss: 1.750 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.031334400177002
Epoch: 20, Steps: 12 | Train Loss: 1.482 Vali Loss: 1.659 Vali Acc: 0.528 Test Loss: 1.659 Test Acc: 0.528
Validation loss decreased (-0.527759 --> -0.527761).  Saving model ...
Epoch: 21 cost time: 0.8755805492401123
Epoch: 21, Steps: 12 | Train Loss: 1.350 Vali Loss: 1.569 Vali Acc: 0.506 Test Loss: 1.569 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0906357765197754
Epoch: 22, Steps: 12 | Train Loss: 1.246 Vali Loss: 1.469 Vali Acc: 0.533 Test Loss: 1.469 Test Acc: 0.533
Validation loss decreased (-0.527761 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.9355721473693848
Epoch: 23, Steps: 12 | Train Loss: 1.159 Vali Loss: 1.355 Vali Acc: 0.561 Test Loss: 1.355 Test Acc: 0.561
Validation loss decreased (-0.533319 --> -0.561098).  Saving model ...
Epoch: 24 cost time: 0.9201438426971436
Epoch: 24, Steps: 12 | Train Loss: 1.041 Vali Loss: 1.247 Vali Acc: 0.578 Test Loss: 1.247 Test Acc: 0.578
Validation loss decreased (-0.561098 --> -0.577765).  Saving model ...
Epoch: 25 cost time: 0.8681294918060303
Epoch: 25, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.168 Vali Acc: 0.583 Test Loss: 1.168 Test Acc: 0.583
Validation loss decreased (-0.577765 --> -0.583322).  Saving model ...
Epoch: 26 cost time: 1.0552611351013184
Epoch: 26, Steps: 12 | Train Loss: 0.827 Vali Loss: 1.091 Vali Acc: 0.600 Test Loss: 1.091 Test Acc: 0.600
Validation loss decreased (-0.583322 --> -0.599989).  Saving model ...
Epoch: 27 cost time: 0.8311686515808105
Epoch: 27, Steps: 12 | Train Loss: 0.803 Vali Loss: 1.052 Vali Acc: 0.606 Test Loss: 1.052 Test Acc: 0.606
Validation loss decreased (-0.599989 --> -0.605545).  Saving model ...
Epoch: 28 cost time: 1.0136404037475586
Epoch: 28, Steps: 12 | Train Loss: 0.753 Vali Loss: 1.015 Vali Acc: 0.611 Test Loss: 1.015 Test Acc: 0.611
Validation loss decreased (-0.605545 --> -0.611101).  Saving model ...
Epoch: 29 cost time: 0.8053643703460693
Epoch: 29, Steps: 12 | Train Loss: 0.637 Vali Loss: 0.953 Vali Acc: 0.667 Test Loss: 0.953 Test Acc: 0.667
Validation loss decreased (-0.611101 --> -0.666657).  Saving model ...
Epoch: 30 cost time: 0.91518235206604
Epoch: 30, Steps: 12 | Train Loss: 0.612 Vali Loss: 0.930 Vali Acc: 0.656 Test Loss: 0.930 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8941352367401123
Epoch: 31, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.904 Vali Acc: 0.683 Test Loss: 0.904 Test Acc: 0.683
Validation loss decreased (-0.666657 --> -0.683324).  Saving model ...
Epoch: 32 cost time: 0.8358268737792969
Epoch: 32, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.871 Vali Acc: 0.694 Test Loss: 0.871 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694436).  Saving model ...
Epoch: 33 cost time: 0.718292236328125
Epoch: 33, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.875 Vali Acc: 0.722 Test Loss: 0.875 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722213).  Saving model ...
Epoch: 34 cost time: 0.7289812564849854
Epoch: 34, Steps: 12 | Train Loss: 0.469 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.698317289352417
Epoch: 35, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.888 Vali Acc: 0.706 Test Loss: 0.888 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.831770658493042
Epoch: 36, Steps: 12 | Train Loss: 0.379 Vali Loss: 0.895 Vali Acc: 0.694 Test Loss: 0.895 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.668644905090332
Epoch: 37, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.878 Vali Acc: 0.694 Test Loss: 0.878 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8348197937011719
Epoch: 38, Steps: 12 | Train Loss: 0.335 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.12782621383667
Epoch: 39, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.858 Vali Acc: 0.706 Test Loss: 0.858 Test Acc: 0.706
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9228243827819824
Epoch: 40, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.906 Vali Acc: 0.733 Test Loss: 0.906 Test Acc: 0.733
Validation loss decreased (-0.722213 --> -0.733324).  Saving model ...
Epoch: 41 cost time: 0.8826391696929932
Epoch: 41, Steps: 12 | Train Loss: 0.292 Vali Loss: 0.866 Vali Acc: 0.711 Test Loss: 0.866 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8461039066314697
Epoch: 42, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7160115242004395
Epoch: 43, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.911 Vali Acc: 0.733 Test Loss: 0.911 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8970670700073242
Epoch: 44, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.914 Vali Acc: 0.722 Test Loss: 0.914 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0001888275146484
Epoch: 45, Steps: 12 | Train Loss: 0.220 Vali Loss: 0.949 Vali Acc: 0.733 Test Loss: 0.949 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7851195335388184
Epoch: 46, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.957 Vali Acc: 0.744 Test Loss: 0.957 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744435).  Saving model ...
Epoch: 47 cost time: 1.0854313373565674
Epoch: 47, Steps: 12 | Train Loss: 0.221 Vali Loss: 1.028 Vali Acc: 0.733 Test Loss: 1.028 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9910862445831299
Epoch: 48, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.994 Vali Acc: 0.744 Test Loss: 0.994 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8492867946624756
Epoch: 49, Steps: 12 | Train Loss: 0.216 Vali Loss: 0.977 Vali Acc: 0.750 Test Loss: 0.977 Test Acc: 0.750
Validation loss decreased (-0.744435 --> -0.749990).  Saving model ...
Epoch: 50 cost time: 0.9711556434631348
Epoch: 50, Steps: 12 | Train Loss: 0.193 Vali Loss: 1.005 Vali Acc: 0.728 Test Loss: 1.005 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8333480358123779
Epoch: 51, Steps: 12 | Train Loss: 0.183 Vali Loss: 1.013 Vali Acc: 0.739 Test Loss: 1.013 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7496192455291748
Epoch: 52, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.033 Vali Acc: 0.744 Test Loss: 1.033 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7985754013061523
Epoch: 53, Steps: 12 | Train Loss: 0.169 Vali Loss: 1.110 Vali Acc: 0.739 Test Loss: 1.110 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9811241626739502
Epoch: 54, Steps: 12 | Train Loss: 0.194 Vali Loss: 1.058 Vali Acc: 0.744 Test Loss: 1.058 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7219064235687256
Epoch: 55, Steps: 12 | Train Loss: 0.188 Vali Loss: 1.166 Vali Acc: 0.733 Test Loss: 1.166 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.129901647567749
Epoch: 56, Steps: 12 | Train Loss: 0.165 Vali Loss: 1.063 Vali Acc: 0.767 Test Loss: 1.063 Test Acc: 0.767
Validation loss decreased (-0.749990 --> -0.766656).  Saving model ...
Epoch: 57 cost time: 1.1752452850341797
Epoch: 57, Steps: 12 | Train Loss: 0.170 Vali Loss: 1.077 Vali Acc: 0.739 Test Loss: 1.077 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9367856979370117
Epoch: 58, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.156 Vali Acc: 0.744 Test Loss: 1.156 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8764078617095947
Epoch: 59, Steps: 12 | Train Loss: 0.132 Vali Loss: 1.109 Vali Acc: 0.739 Test Loss: 1.109 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8141834735870361
Epoch: 60, Steps: 12 | Train Loss: 0.136 Vali Loss: 1.112 Vali Acc: 0.756 Test Loss: 1.112 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.7185993194580078
Epoch: 61, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.163 Vali Acc: 0.744 Test Loss: 1.163 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.9801344871520996
Epoch: 62, Steps: 12 | Train Loss: 0.115 Vali Loss: 1.121 Vali Acc: 0.750 Test Loss: 1.121 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.915381669998169
Epoch: 63, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.188 Vali Acc: 0.761 Test Loss: 1.188 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.8835742473602295
Epoch: 64, Steps: 12 | Train Loss: 0.118 Vali Loss: 1.198 Vali Acc: 0.767 Test Loss: 1.198 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.818967342376709
Epoch: 65, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.256 Vali Acc: 0.733 Test Loss: 1.256 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.0473747253417969
Epoch: 66, Steps: 12 | Train Loss: 0.162 Vali Loss: 1.247 Vali Acc: 0.783 Test Loss: 1.247 Test Acc: 0.783
Validation loss decreased (-0.766656 --> -0.783321).  Saving model ...
Epoch: 67 cost time: 0.7590303421020508
Epoch: 67, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.376 Vali Acc: 0.744 Test Loss: 1.376 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9687869548797607
Epoch: 68, Steps: 12 | Train Loss: 0.167 Vali Loss: 1.279 Vali Acc: 0.750 Test Loss: 1.279 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7826523780822754
Epoch: 69, Steps: 12 | Train Loss: 0.119 Vali Loss: 1.322 Vali Acc: 0.739 Test Loss: 1.322 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7820916175842285
Epoch: 70, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.206 Vali Acc: 0.789 Test Loss: 1.206 Test Acc: 0.789
Validation loss decreased (-0.783321 --> -0.788877).  Saving model ...
Epoch: 71 cost time: 0.7645571231842041
Epoch: 71, Steps: 12 | Train Loss: 0.091 Vali Loss: 1.247 Vali Acc: 0.783 Test Loss: 1.247 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7815079689025879
Epoch: 72, Steps: 12 | Train Loss: 0.084 Vali Loss: 1.297 Vali Acc: 0.767 Test Loss: 1.297 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6829240322113037
Epoch: 73, Steps: 12 | Train Loss: 0.087 Vali Loss: 1.346 Vali Acc: 0.767 Test Loss: 1.346 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7335541248321533
Epoch: 74, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.338 Vali Acc: 0.739 Test Loss: 1.338 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.8705337047576904
Epoch: 75, Steps: 12 | Train Loss: 0.117 Vali Loss: 1.450 Vali Acc: 0.739 Test Loss: 1.450 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.746213436126709
Epoch: 76, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.350 Vali Acc: 0.767 Test Loss: 1.350 Test Acc: 0.767
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.8334958553314209
Epoch: 77, Steps: 12 | Train Loss: 0.074 Vali Loss: 1.414 Vali Acc: 0.761 Test Loss: 1.414 Test Acc: 0.761
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.6830847263336182
Epoch: 78, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.342 Vali Acc: 0.772 Test Loss: 1.342 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.6051616668701172
Epoch: 79, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.431 Vali Acc: 0.761 Test Loss: 1.431 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.7162368297576904
Epoch: 80, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.408 Vali Acc: 0.767 Test Loss: 1.408 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 11330
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5202412605285645
Epoch: 1, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.707 Vali Acc: 0.083 Test Loss: 2.707 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.9731168746948242
Epoch: 2, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.683 Vali Acc: 0.078 Test Loss: 2.683 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7384219169616699
Epoch: 3, Steps: 12 | Train Loss: 2.684 Vali Loss: 2.652 Vali Acc: 0.078 Test Loss: 2.652 Test Acc: 0.078
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7777838706970215
Epoch: 4, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.618 Vali Acc: 0.094 Test Loss: 2.618 Test Acc: 0.094
Validation loss decreased (-0.083306 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.793421745300293
Epoch: 5, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.576 Vali Acc: 0.111 Test Loss: 2.576 Test Acc: 0.111
Validation loss decreased (-0.094418 --> -0.111085).  Saving model ...
Epoch: 6 cost time: 0.8104259967803955
Epoch: 6, Steps: 12 | Train Loss: 2.545 Vali Loss: 2.532 Vali Acc: 0.150 Test Loss: 2.532 Test Acc: 0.150
Validation loss decreased (-0.111085 --> -0.149975).  Saving model ...
Epoch: 7 cost time: 1.0228068828582764
Epoch: 7, Steps: 12 | Train Loss: 2.503 Vali Loss: 2.487 Vali Acc: 0.178 Test Loss: 2.487 Test Acc: 0.178
Validation loss decreased (-0.149975 --> -0.177753).  Saving model ...
Epoch: 8 cost time: 0.7388536930084229
Epoch: 8, Steps: 12 | Train Loss: 2.458 Vali Loss: 2.439 Vali Acc: 0.206 Test Loss: 2.439 Test Acc: 0.206
Validation loss decreased (-0.177753 --> -0.205531).  Saving model ...
Epoch: 9 cost time: 0.8488810062408447
Epoch: 9, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.389 Vali Acc: 0.250 Test Loss: 2.389 Test Acc: 0.250
Validation loss decreased (-0.205531 --> -0.249976).  Saving model ...
Epoch: 10 cost time: 1.0394084453582764
Epoch: 10, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.335 Vali Acc: 0.261 Test Loss: 2.335 Test Acc: 0.261
Validation loss decreased (-0.249976 --> -0.261088).  Saving model ...
Epoch: 11 cost time: 1.03163480758667
Epoch: 11, Steps: 12 | Train Loss: 2.291 Vali Loss: 2.277 Vali Acc: 0.306 Test Loss: 2.277 Test Acc: 0.306
Validation loss decreased (-0.261088 --> -0.305533).  Saving model ...
Epoch: 12 cost time: 1.0244128704071045
Epoch: 12, Steps: 12 | Train Loss: 2.211 Vali Loss: 2.214 Vali Acc: 0.339 Test Loss: 2.214 Test Acc: 0.339
Validation loss decreased (-0.305533 --> -0.338867).  Saving model ...
Epoch: 13 cost time: 0.7629556655883789
Epoch: 13, Steps: 12 | Train Loss: 2.126 Vali Loss: 2.148 Vali Acc: 0.378 Test Loss: 2.148 Test Acc: 0.378
Validation loss decreased (-0.338867 --> -0.377756).  Saving model ...
Epoch: 14 cost time: 0.9610373973846436
Epoch: 14, Steps: 12 | Train Loss: 2.071 Vali Loss: 2.072 Vali Acc: 0.406 Test Loss: 2.072 Test Acc: 0.406
Validation loss decreased (-0.377756 --> -0.405535).  Saving model ...
Epoch: 15 cost time: 0.754734992980957
Epoch: 15, Steps: 12 | Train Loss: 1.977 Vali Loss: 1.982 Vali Acc: 0.422 Test Loss: 1.982 Test Acc: 0.422
Validation loss decreased (-0.405535 --> -0.422202).  Saving model ...
Epoch: 16 cost time: 0.8718042373657227
Epoch: 16, Steps: 12 | Train Loss: 1.835 Vali Loss: 1.878 Vali Acc: 0.433 Test Loss: 1.878 Test Acc: 0.433
Validation loss decreased (-0.422202 --> -0.433315).  Saving model ...
Epoch: 17 cost time: 0.8625819683074951
Epoch: 17, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.778 Vali Acc: 0.456 Test Loss: 1.778 Test Acc: 0.456
Validation loss decreased (-0.433315 --> -0.455538).  Saving model ...
Epoch: 18 cost time: 0.7493667602539062
Epoch: 18, Steps: 12 | Train Loss: 1.652 Vali Loss: 1.681 Vali Acc: 0.489 Test Loss: 1.681 Test Acc: 0.489
Validation loss decreased (-0.455538 --> -0.488872).  Saving model ...
Epoch: 19 cost time: 0.9831030368804932
Epoch: 19, Steps: 12 | Train Loss: 1.576 Vali Loss: 1.574 Vali Acc: 0.533 Test Loss: 1.574 Test Acc: 0.533
Validation loss decreased (-0.488872 --> -0.533318).  Saving model ...
Epoch: 20 cost time: 0.9863290786743164
Epoch: 20, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.491 Vali Acc: 0.544 Test Loss: 1.491 Test Acc: 0.544
Validation loss decreased (-0.533318 --> -0.544430).  Saving model ...
Epoch: 21 cost time: 0.9140720367431641
Epoch: 21, Steps: 12 | Train Loss: 1.331 Vali Loss: 1.395 Vali Acc: 0.572 Test Loss: 1.395 Test Acc: 0.572
Validation loss decreased (-0.544430 --> -0.572208).  Saving model ...
Epoch: 22 cost time: 0.7492921352386475
Epoch: 22, Steps: 12 | Train Loss: 1.261 Vali Loss: 1.305 Vali Acc: 0.572 Test Loss: 1.305 Test Acc: 0.572
Validation loss decreased (-0.572208 --> -0.572209).  Saving model ...
Epoch: 23 cost time: 0.7573847770690918
Epoch: 23, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.221 Vali Acc: 0.611 Test Loss: 1.221 Test Acc: 0.611
Validation loss decreased (-0.572209 --> -0.611099).  Saving model ...
Epoch: 24 cost time: 0.7097249031066895
Epoch: 24, Steps: 12 | Train Loss: 1.063 Vali Loss: 1.137 Vali Acc: 0.644 Test Loss: 1.137 Test Acc: 0.644
Validation loss decreased (-0.611099 --> -0.644433).  Saving model ...
Epoch: 25 cost time: 0.930617094039917
Epoch: 25, Steps: 12 | Train Loss: 0.966 Vali Loss: 1.055 Vali Acc: 0.661 Test Loss: 1.055 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661101).  Saving model ...
Epoch: 26 cost time: 0.8846149444580078
Epoch: 26, Steps: 12 | Train Loss: 0.903 Vali Loss: 0.976 Vali Acc: 0.650 Test Loss: 0.976 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8857157230377197
Epoch: 27, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.910 Vali Acc: 0.700 Test Loss: 0.910 Test Acc: 0.700
Validation loss decreased (-0.661101 --> -0.699991).  Saving model ...
Epoch: 28 cost time: 0.7908163070678711
Epoch: 28, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.836 Vali Acc: 0.694 Test Loss: 0.836 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6525382995605469
Epoch: 29, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.761 Vali Acc: 0.722 Test Loss: 0.761 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722215).  Saving model ...
Epoch: 30 cost time: 0.8322381973266602
Epoch: 30, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
Validation loss decreased (-0.722215 --> -0.727771).  Saving model ...
Epoch: 31 cost time: 0.8955769538879395
Epoch: 31, Steps: 12 | Train Loss: 0.540 Vali Loss: 0.660 Vali Acc: 0.733 Test Loss: 0.660 Test Acc: 0.733
Validation loss decreased (-0.727771 --> -0.733327).  Saving model ...
Epoch: 32 cost time: 0.9029719829559326
Epoch: 32, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
Validation loss decreased (-0.733327 --> -0.749994).  Saving model ...
Epoch: 33 cost time: 0.8837606906890869
Epoch: 33, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.580 Vali Acc: 0.778 Test Loss: 0.580 Test Acc: 0.778
Validation loss decreased (-0.749994 --> -0.777772).  Saving model ...
Epoch: 34 cost time: 0.9967854022979736
Epoch: 34, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.539 Vali Acc: 0.778 Test Loss: 0.539 Test Acc: 0.778
Validation loss decreased (-0.777772 --> -0.777772).  Saving model ...
Epoch: 35 cost time: 0.8088006973266602
Epoch: 35, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.508 Vali Acc: 0.794 Test Loss: 0.508 Test Acc: 0.794
Validation loss decreased (-0.777772 --> -0.794439).  Saving model ...
Epoch: 36 cost time: 0.9516260623931885
Epoch: 36, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.494 Vali Acc: 0.806 Test Loss: 0.494 Test Acc: 0.806
Validation loss decreased (-0.794439 --> -0.805551).  Saving model ...
Epoch: 37 cost time: 1.0876240730285645
Epoch: 37, Steps: 12 | Train Loss: 0.284 Vali Loss: 0.475 Vali Acc: 0.811 Test Loss: 0.475 Test Acc: 0.811
Validation loss decreased (-0.805551 --> -0.811106).  Saving model ...
Epoch: 38 cost time: 0.8292789459228516
Epoch: 38, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.478 Vali Acc: 0.800 Test Loss: 0.478 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7417857646942139
Epoch: 39, Steps: 12 | Train Loss: 0.244 Vali Loss: 0.480 Vali Acc: 0.817 Test Loss: 0.480 Test Acc: 0.817
Validation loss decreased (-0.811106 --> -0.816662).  Saving model ...
Epoch: 40 cost time: 0.9060523509979248
Epoch: 40, Steps: 12 | Train Loss: 0.234 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7500755786895752
Epoch: 41, Steps: 12 | Train Loss: 0.240 Vali Loss: 0.456 Vali Acc: 0.806 Test Loss: 0.456 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9782609939575195
Epoch: 42, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.433 Vali Acc: 0.828 Test Loss: 0.433 Test Acc: 0.828
Validation loss decreased (-0.816662 --> -0.827773).  Saving model ...
Epoch: 43 cost time: 0.9398760795593262
Epoch: 43, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.516 Vali Acc: 0.767 Test Loss: 0.516 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8650484085083008
Epoch: 44, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.466 Vali Acc: 0.839 Test Loss: 0.466 Test Acc: 0.839
Validation loss decreased (-0.827773 --> -0.838884).  Saving model ...
Epoch: 45 cost time: 0.7661054134368896
Epoch: 45, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.457 Vali Acc: 0.811 Test Loss: 0.457 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6404869556427002
Epoch: 46, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.459 Vali Acc: 0.817 Test Loss: 0.459 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8907525539398193
Epoch: 47, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.519 Vali Acc: 0.822 Test Loss: 0.519 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.866973876953125
Epoch: 48, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.491 Vali Acc: 0.833 Test Loss: 0.491 Test Acc: 0.833
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9027185440063477
Epoch: 49, Steps: 12 | Train Loss: 0.131 Vali Loss: 0.511 Vali Acc: 0.839 Test Loss: 0.511 Test Acc: 0.839
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.2329843044281006
Epoch: 50, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.475 Vali Acc: 0.811 Test Loss: 0.475 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9556219577789307
Epoch: 51, Steps: 12 | Train Loss: 0.103 Vali Loss: 0.521 Vali Acc: 0.794 Test Loss: 0.521 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2388243675231934
Epoch: 52, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.481 Vali Acc: 0.833 Test Loss: 0.481 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.114842176437378
Epoch: 53, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.583 Vali Acc: 0.800 Test Loss: 0.583 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9392671585083008
Epoch: 54, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.509 Vali Acc: 0.811 Test Loss: 0.509 Test Acc: 0.811
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 11255
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4019150733947754
Epoch: 1, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.663 Vali Acc: 0.083 Test Loss: 2.663 Test Acc: 0.083
Validation loss decreased (inf --> -0.083307).  Saving model ...
Epoch: 2 cost time: 0.8314299583435059
Epoch: 2, Steps: 12 | Train Loss: 2.672 Vali Loss: 2.640 Vali Acc: 0.089 Test Loss: 2.640 Test Acc: 0.089
Validation loss decreased (-0.083307 --> -0.088862).  Saving model ...
Epoch: 3 cost time: 0.811394453048706
Epoch: 3, Steps: 12 | Train Loss: 2.629 Vali Loss: 2.609 Vali Acc: 0.111 Test Loss: 2.609 Test Acc: 0.111
Validation loss decreased (-0.088862 --> -0.111085).  Saving model ...
Epoch: 4 cost time: 0.8011059761047363
Epoch: 4, Steps: 12 | Train Loss: 2.599 Vali Loss: 2.577 Vali Acc: 0.150 Test Loss: 2.577 Test Acc: 0.150
Validation loss decreased (-0.111085 --> -0.149974).  Saving model ...
Epoch: 5 cost time: 0.8532111644744873
Epoch: 5, Steps: 12 | Train Loss: 2.553 Vali Loss: 2.538 Vali Acc: 0.161 Test Loss: 2.538 Test Acc: 0.161
Validation loss decreased (-0.149974 --> -0.161086).  Saving model ...
Epoch: 6 cost time: 1.0829157829284668
Epoch: 6, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.493 Vali Acc: 0.183 Test Loss: 2.493 Test Acc: 0.183
Validation loss decreased (-0.161086 --> -0.183308).  Saving model ...
Epoch: 7 cost time: 0.7850232124328613
Epoch: 7, Steps: 12 | Train Loss: 2.469 Vali Loss: 2.442 Vali Acc: 0.244 Test Loss: 2.442 Test Acc: 0.244
Validation loss decreased (-0.183308 --> -0.244420).  Saving model ...
Epoch: 8 cost time: 0.8673574924468994
Epoch: 8, Steps: 12 | Train Loss: 2.418 Vali Loss: 2.389 Vali Acc: 0.272 Test Loss: 2.389 Test Acc: 0.272
Validation loss decreased (-0.244420 --> -0.272198).  Saving model ...
Epoch: 9 cost time: 0.9489922523498535
Epoch: 9, Steps: 12 | Train Loss: 2.340 Vali Loss: 2.336 Vali Acc: 0.317 Test Loss: 2.336 Test Acc: 0.317
Validation loss decreased (-0.272198 --> -0.316643).  Saving model ...
Epoch: 10 cost time: 0.9106757640838623
Epoch: 10, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.273 Vali Acc: 0.333 Test Loss: 2.273 Test Acc: 0.333
Validation loss decreased (-0.316643 --> -0.333311).  Saving model ...
Epoch: 11 cost time: 0.97804856300354
Epoch: 11, Steps: 12 | Train Loss: 2.212 Vali Loss: 2.205 Vali Acc: 0.350 Test Loss: 2.205 Test Acc: 0.350
Validation loss decreased (-0.333311 --> -0.349978).  Saving model ...
Epoch: 12 cost time: 0.8569960594177246
Epoch: 12, Steps: 12 | Train Loss: 2.107 Vali Loss: 2.126 Vali Acc: 0.378 Test Loss: 2.126 Test Acc: 0.378
Validation loss decreased (-0.349978 --> -0.377757).  Saving model ...
Epoch: 13 cost time: 0.8294694423675537
Epoch: 13, Steps: 12 | Train Loss: 2.000 Vali Loss: 2.038 Vali Acc: 0.406 Test Loss: 2.038 Test Acc: 0.406
Validation loss decreased (-0.377757 --> -0.405535).  Saving model ...
Epoch: 14 cost time: 0.9159276485443115
Epoch: 14, Steps: 12 | Train Loss: 1.854 Vali Loss: 1.930 Vali Acc: 0.417 Test Loss: 1.930 Test Acc: 0.417
Validation loss decreased (-0.405535 --> -0.416647).  Saving model ...
Epoch: 15 cost time: 0.751227855682373
Epoch: 15, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.815 Vali Acc: 0.472 Test Loss: 1.815 Test Acc: 0.472
Validation loss decreased (-0.416647 --> -0.472204).  Saving model ...
Epoch: 16 cost time: 0.8504841327667236
Epoch: 16, Steps: 12 | Train Loss: 1.632 Vali Loss: 1.715 Vali Acc: 0.494 Test Loss: 1.715 Test Acc: 0.494
Validation loss decreased (-0.472204 --> -0.494427).  Saving model ...
Epoch: 17 cost time: 0.8267090320587158
Epoch: 17, Steps: 12 | Train Loss: 1.557 Vali Loss: 1.591 Vali Acc: 0.528 Test Loss: 1.591 Test Acc: 0.528
Validation loss decreased (-0.494427 --> -0.527762).  Saving model ...
Epoch: 18 cost time: 0.8869719505310059
Epoch: 18, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.482 Vali Acc: 0.594 Test Loss: 1.482 Test Acc: 0.594
Validation loss decreased (-0.527762 --> -0.594430).  Saving model ...
Epoch: 19 cost time: 1.0231728553771973
Epoch: 19, Steps: 12 | Train Loss: 1.327 Vali Loss: 1.361 Vali Acc: 0.644 Test Loss: 1.361 Test Acc: 0.644
Validation loss decreased (-0.594430 --> -0.644431).  Saving model ...
Epoch: 20 cost time: 0.9621884822845459
Epoch: 20, Steps: 12 | Train Loss: 1.180 Vali Loss: 1.263 Vali Acc: 0.617 Test Loss: 1.263 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9778296947479248
Epoch: 21, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.644431 --> -0.655544).  Saving model ...
Epoch: 22 cost time: 0.9655659198760986
Epoch: 22, Steps: 12 | Train Loss: 0.992 Vali Loss: 1.099 Vali Acc: 0.689 Test Loss: 1.099 Test Acc: 0.689
Validation loss decreased (-0.655544 --> -0.688878).  Saving model ...
Epoch: 23 cost time: 0.9214637279510498
Epoch: 23, Steps: 12 | Train Loss: 0.935 Vali Loss: 1.040 Vali Acc: 0.689 Test Loss: 1.040 Test Acc: 0.689
Validation loss decreased (-0.688878 --> -0.688878).  Saving model ...
Epoch: 24 cost time: 1.0064623355865479
Epoch: 24, Steps: 12 | Train Loss: 0.865 Vali Loss: 0.995 Vali Acc: 0.672 Test Loss: 0.995 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8661317825317383
Epoch: 25, Steps: 12 | Train Loss: 0.799 Vali Loss: 0.940 Vali Acc: 0.694 Test Loss: 0.940 Test Acc: 0.694
Validation loss decreased (-0.688878 --> -0.694435).  Saving model ...
Epoch: 26 cost time: 1.0092213153839111
Epoch: 26, Steps: 12 | Train Loss: 0.788 Vali Loss: 0.933 Vali Acc: 0.722 Test Loss: 0.933 Test Acc: 0.722
Validation loss decreased (-0.694435 --> -0.722213).  Saving model ...
Epoch: 27 cost time: 0.8921141624450684
Epoch: 27, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.893 Vali Acc: 0.706 Test Loss: 0.893 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9838354587554932
Epoch: 28, Steps: 12 | Train Loss: 0.712 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.722213 --> -0.727769).  Saving model ...
Epoch: 29 cost time: 0.8552360534667969
Epoch: 29, Steps: 12 | Train Loss: 0.645 Vali Loss: 0.845 Vali Acc: 0.711 Test Loss: 0.845 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7531726360321045
Epoch: 30, Steps: 12 | Train Loss: 0.597 Vali Loss: 0.829 Vali Acc: 0.733 Test Loss: 0.829 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733325).  Saving model ...
Epoch: 31 cost time: 0.9793190956115723
Epoch: 31, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.805 Vali Acc: 0.739 Test Loss: 0.805 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 32 cost time: 0.9652199745178223
Epoch: 32, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.784 Vali Acc: 0.739 Test Loss: 0.784 Test Acc: 0.739
Validation loss decreased (-0.738881 --> -0.738881).  Saving model ...
Epoch: 33 cost time: 1.27183198928833
Epoch: 33, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.756 Vali Acc: 0.756 Test Loss: 0.756 Test Acc: 0.756
Validation loss decreased (-0.738881 --> -0.755548).  Saving model ...
Epoch: 34 cost time: 1.0729725360870361
Epoch: 34, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.737 Vali Acc: 0.733 Test Loss: 0.737 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8949370384216309
Epoch: 35, Steps: 12 | Train Loss: 0.454 Vali Loss: 0.711 Vali Acc: 0.733 Test Loss: 0.711 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9073526859283447
Epoch: 36, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.702 Vali Acc: 0.761 Test Loss: 0.702 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 37 cost time: 0.8237731456756592
Epoch: 37, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.688 Vali Acc: 0.761 Test Loss: 0.688 Test Acc: 0.761
Validation loss decreased (-0.761104 --> -0.761104).  Saving model ...
Epoch: 38 cost time: 0.8465635776519775
Epoch: 38, Steps: 12 | Train Loss: 0.397 Vali Loss: 0.691 Vali Acc: 0.750 Test Loss: 0.691 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0321099758148193
Epoch: 39, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
Validation loss decreased (-0.761104 --> -0.777771).  Saving model ...
Epoch: 40 cost time: 0.7906920909881592
Epoch: 40, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.663 Vali Acc: 0.761 Test Loss: 0.663 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7795934677124023
Epoch: 41, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.641 Vali Acc: 0.761 Test Loss: 0.641 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7707211971282959
Epoch: 42, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 43 cost time: 0.7463240623474121
Epoch: 43, Steps: 12 | Train Loss: 0.274 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9042067527770996
Epoch: 44, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.684 Vali Acc: 0.767 Test Loss: 0.684 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.917701244354248
Epoch: 45, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.590 Vali Acc: 0.800 Test Loss: 0.590 Test Acc: 0.800
Validation loss decreased (-0.783327 --> -0.799994).  Saving model ...
Epoch: 46 cost time: 0.7615871429443359
Epoch: 46, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.649 Vali Acc: 0.778 Test Loss: 0.649 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9911520481109619
Epoch: 47, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.627 Vali Acc: 0.800 Test Loss: 0.627 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7157421112060547
Epoch: 48, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.027909517288208
Epoch: 49, Steps: 12 | Train Loss: 0.172 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7936797142028809
Epoch: 50, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.619 Vali Acc: 0.800 Test Loss: 0.619 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9060726165771484
Epoch: 51, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.658 Vali Acc: 0.794 Test Loss: 0.658 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9425699710845947
Epoch: 52, Steps: 12 | Train Loss: 0.146 Vali Loss: 0.678 Vali Acc: 0.817 Test Loss: 0.678 Test Acc: 0.817
Validation loss decreased (-0.799994 --> -0.816660).  Saving model ...
Epoch: 53 cost time: 0.8369338512420654
Epoch: 53, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.689 Vali Acc: 0.800 Test Loss: 0.689 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.006575345993042
Epoch: 54, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.692 Vali Acc: 0.778 Test Loss: 0.692 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9900920391082764
Epoch: 55, Steps: 12 | Train Loss: 0.124 Vali Loss: 0.672 Vali Acc: 0.800 Test Loss: 0.672 Test Acc: 0.800
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.017899751663208
Epoch: 56, Steps: 12 | Train Loss: 0.123 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0081088542938232
Epoch: 57, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.730 Vali Acc: 0.806 Test Loss: 0.730 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9367630481719971
Epoch: 58, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.778 Vali Acc: 0.794 Test Loss: 0.778 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.0059309005737305
Epoch: 59, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.760 Vali Acc: 0.800 Test Loss: 0.760 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.8337719440460205
Epoch: 60, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.764 Vali Acc: 0.806 Test Loss: 0.764 Test Acc: 0.806
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.7840292453765869
Epoch: 61, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.854 Vali Acc: 0.800 Test Loss: 0.854 Test Acc: 0.800
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.8535764217376709
Epoch: 62, Steps: 12 | Train Loss: 0.167 Vali Loss: 0.734 Vali Acc: 0.817 Test Loss: 0.734 Test Acc: 0.817
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 11094
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1023166179656982
Epoch: 1, Steps: 12 | Train Loss: 2.748 Vali Loss: 2.749 Vali Acc: 0.056 Test Loss: 2.749 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.715979814529419
Epoch: 2, Steps: 12 | Train Loss: 2.722 Vali Loss: 2.723 Vali Acc: 0.061 Test Loss: 2.723 Test Acc: 0.061
Validation loss decreased (-0.055528 --> -0.061084).  Saving model ...
Epoch: 3 cost time: 0.7390775680541992
Epoch: 3, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.689 Vali Acc: 0.061 Test Loss: 2.689 Test Acc: 0.061
Validation loss decreased (-0.061084 --> -0.061084).  Saving model ...
Epoch: 4 cost time: 0.6956379413604736
Epoch: 4, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.650 Vali Acc: 0.072 Test Loss: 2.650 Test Acc: 0.072
Validation loss decreased (-0.061084 --> -0.072196).  Saving model ...
Epoch: 5 cost time: 0.7151904106140137
Epoch: 5, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.605 Vali Acc: 0.117 Test Loss: 2.605 Test Acc: 0.117
Validation loss decreased (-0.072196 --> -0.116641).  Saving model ...
Epoch: 6 cost time: 0.8094828128814697
Epoch: 6, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.555 Vali Acc: 0.161 Test Loss: 2.555 Test Acc: 0.161
Validation loss decreased (-0.116641 --> -0.161086).  Saving model ...
Epoch: 7 cost time: 0.7187650203704834
Epoch: 7, Steps: 12 | Train Loss: 2.485 Vali Loss: 2.499 Vali Acc: 0.206 Test Loss: 2.499 Test Acc: 0.206
Validation loss decreased (-0.161086 --> -0.205531).  Saving model ...
Epoch: 8 cost time: 0.8316121101379395
Epoch: 8, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.438 Vali Acc: 0.289 Test Loss: 2.438 Test Acc: 0.289
Validation loss decreased (-0.205531 --> -0.288865).  Saving model ...
Epoch: 9 cost time: 0.8598878383636475
Epoch: 9, Steps: 12 | Train Loss: 2.377 Vali Loss: 2.369 Vali Acc: 0.356 Test Loss: 2.369 Test Acc: 0.356
Validation loss decreased (-0.288865 --> -0.355532).  Saving model ...
Epoch: 10 cost time: 0.6390976905822754
Epoch: 10, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.291 Vali Acc: 0.433 Test Loss: 2.291 Test Acc: 0.433
Validation loss decreased (-0.355532 --> -0.433310).  Saving model ...
Epoch: 11 cost time: 1.038522720336914
Epoch: 11, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.201 Vali Acc: 0.439 Test Loss: 2.201 Test Acc: 0.439
Validation loss decreased (-0.433310 --> -0.438867).  Saving model ...
Epoch: 12 cost time: 1.1771211624145508
Epoch: 12, Steps: 12 | Train Loss: 2.091 Vali Loss: 2.106 Vali Acc: 0.439 Test Loss: 2.106 Test Acc: 0.439
Validation loss decreased (-0.438867 --> -0.438868).  Saving model ...
Epoch: 13 cost time: 0.8734152317047119
Epoch: 13, Steps: 12 | Train Loss: 2.004 Vali Loss: 1.999 Vali Acc: 0.461 Test Loss: 1.999 Test Acc: 0.461
Validation loss decreased (-0.438868 --> -0.461091).  Saving model ...
Epoch: 14 cost time: 0.6627514362335205
Epoch: 14, Steps: 12 | Train Loss: 1.876 Vali Loss: 1.890 Vali Acc: 0.450 Test Loss: 1.890 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9368786811828613
Epoch: 15, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.782 Vali Acc: 0.461 Test Loss: 1.782 Test Acc: 0.461
Validation loss decreased (-0.461091 --> -0.461093).  Saving model ...
Epoch: 16 cost time: 0.8152329921722412
Epoch: 16, Steps: 12 | Train Loss: 1.627 Vali Loss: 1.672 Vali Acc: 0.489 Test Loss: 1.672 Test Acc: 0.489
Validation loss decreased (-0.461093 --> -0.488872).  Saving model ...
Epoch: 17 cost time: 1.0920488834381104
Epoch: 17, Steps: 12 | Train Loss: 1.476 Vali Loss: 1.573 Vali Acc: 0.517 Test Loss: 1.573 Test Acc: 0.517
Validation loss decreased (-0.488872 --> -0.516651).  Saving model ...
Epoch: 18 cost time: 0.969517707824707
Epoch: 18, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.467 Vali Acc: 0.583 Test Loss: 1.467 Test Acc: 0.583
Validation loss decreased (-0.516651 --> -0.583319).  Saving model ...
Epoch: 19 cost time: 1.3060016632080078
Epoch: 19, Steps: 12 | Train Loss: 1.307 Vali Loss: 1.373 Vali Acc: 0.611 Test Loss: 1.373 Test Acc: 0.611
Validation loss decreased (-0.583319 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 1.0360383987426758
Epoch: 20, Steps: 12 | Train Loss: 1.205 Vali Loss: 1.279 Vali Acc: 0.633 Test Loss: 1.279 Test Acc: 0.633
Validation loss decreased (-0.611097 --> -0.633321).  Saving model ...
Epoch: 21 cost time: 0.8559708595275879
Epoch: 21, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.222 Vali Acc: 0.628 Test Loss: 1.222 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9352679252624512
Epoch: 22, Steps: 12 | Train Loss: 1.017 Vali Loss: 1.165 Vali Acc: 0.639 Test Loss: 1.165 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638877).  Saving model ...
Epoch: 23 cost time: 0.9095737934112549
Epoch: 23, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.104 Vali Acc: 0.639 Test Loss: 1.104 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 24 cost time: 0.9764020442962646
Epoch: 24, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.044 Vali Acc: 0.656 Test Loss: 1.044 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655545).  Saving model ...
Epoch: 25 cost time: 0.9097964763641357
Epoch: 25, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.026 Vali Acc: 0.667 Test Loss: 1.026 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666656).  Saving model ...
Epoch: 26 cost time: 0.8981950283050537
Epoch: 26, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.997 Vali Acc: 0.700 Test Loss: 0.997 Test Acc: 0.700
Validation loss decreased (-0.666656 --> -0.699990).  Saving model ...
Epoch: 27 cost time: 1.2668912410736084
Epoch: 27, Steps: 12 | Train Loss: 0.705 Vali Loss: 0.958 Vali Acc: 0.700 Test Loss: 0.958 Test Acc: 0.700
Validation loss decreased (-0.699990 --> -0.699990).  Saving model ...
Epoch: 28 cost time: 0.8296852111816406
Epoch: 28, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.970 Vali Acc: 0.694 Test Loss: 0.970 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.023277997970581
Epoch: 29, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.957 Vali Acc: 0.678 Test Loss: 0.957 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7415475845336914
Epoch: 30, Steps: 12 | Train Loss: 0.555 Vali Loss: 0.888 Vali Acc: 0.722 Test Loss: 0.888 Test Acc: 0.722
Validation loss decreased (-0.699990 --> -0.722213).  Saving model ...
Epoch: 31 cost time: 0.8222408294677734
Epoch: 31, Steps: 12 | Train Loss: 0.530 Vali Loss: 0.902 Vali Acc: 0.711 Test Loss: 0.902 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9832751750946045
Epoch: 32, Steps: 12 | Train Loss: 0.515 Vali Loss: 0.906 Vali Acc: 0.694 Test Loss: 0.906 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9408037662506104
Epoch: 33, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.881 Vali Acc: 0.711 Test Loss: 0.881 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1337110996246338
Epoch: 34, Steps: 12 | Train Loss: 0.493 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0891633033752441
Epoch: 35, Steps: 12 | Train Loss: 0.426 Vali Loss: 0.850 Vali Acc: 0.717 Test Loss: 0.850 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.919348955154419
Epoch: 36, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.819 Vali Acc: 0.711 Test Loss: 0.819 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9711034297943115
Epoch: 37, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.834 Vali Acc: 0.700 Test Loss: 0.834 Test Acc: 0.700
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7991364002227783
Epoch: 38, Steps: 12 | Train Loss: 0.452 Vali Loss: 0.831 Vali Acc: 0.739 Test Loss: 0.831 Test Acc: 0.739
Validation loss decreased (-0.722213 --> -0.738881).  Saving model ...
Epoch: 39 cost time: 1.451481580734253
Epoch: 39, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.835 Vali Acc: 0.700 Test Loss: 0.835 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0253701210021973
Epoch: 40, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.792 Vali Acc: 0.733 Test Loss: 0.792 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8893988132476807
Epoch: 41, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.816 Vali Acc: 0.722 Test Loss: 0.816 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.1326854228973389
Epoch: 42, Steps: 12 | Train Loss: 0.325 Vali Loss: 0.763 Vali Acc: 0.750 Test Loss: 0.763 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 43 cost time: 0.9210832118988037
Epoch: 43, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.837 Vali Acc: 0.728 Test Loss: 0.837 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9771268367767334
Epoch: 44, Steps: 12 | Train Loss: 0.342 Vali Loss: 0.804 Vali Acc: 0.750 Test Loss: 0.804 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7322123050689697
Epoch: 45, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.800 Vali Acc: 0.750 Test Loss: 0.800 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9337613582611084
Epoch: 46, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.771 Vali Acc: 0.756 Test Loss: 0.771 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 47 cost time: 0.9374122619628906
Epoch: 47, Steps: 12 | Train Loss: 0.286 Vali Loss: 0.841 Vali Acc: 0.756 Test Loss: 0.841 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8321099281311035
Epoch: 48, Steps: 12 | Train Loss: 0.300 Vali Loss: 0.797 Vali Acc: 0.767 Test Loss: 0.797 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 49 cost time: 1.075404405593872
Epoch: 49, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.816 Vali Acc: 0.772 Test Loss: 0.816 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772214).  Saving model ...
Epoch: 50 cost time: 0.8535470962524414
Epoch: 50, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.825 Vali Acc: 0.767 Test Loss: 0.825 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9244039058685303
Epoch: 51, Steps: 12 | Train Loss: 0.232 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 52 cost time: 0.9340476989746094
Epoch: 52, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.866 Vali Acc: 0.739 Test Loss: 0.866 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.190291166305542
Epoch: 53, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.842 Vali Acc: 0.778 Test Loss: 0.842 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.065277099609375
Epoch: 54, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.811 Vali Acc: 0.761 Test Loss: 0.811 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.9047002792358398
Epoch: 55, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.816 Vali Acc: 0.761 Test Loss: 0.816 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.0755774974822998
Epoch: 56, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.855 Vali Acc: 0.772 Test Loss: 0.855 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.1172621250152588
Epoch: 57, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.843 Vali Acc: 0.756 Test Loss: 0.843 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0153331756591797
Epoch: 58, Steps: 12 | Train Loss: 0.204 Vali Loss: 0.819 Vali Acc: 0.778 Test Loss: 0.819 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.033372402191162
Epoch: 59, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.859 Vali Acc: 0.772 Test Loss: 0.859 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.9771218299865723
Epoch: 60, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.772 Vali Acc: 0.761 Test Loss: 0.772 Test Acc: 0.761
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.1668658256530762
Epoch: 61, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.867 Vali Acc: 0.750 Test Loss: 0.867 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 11303
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4124162197113037
Epoch: 1, Steps: 12 | Train Loss: 2.788 Vali Loss: 2.817 Vali Acc: 0.050 Test Loss: 2.817 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.743236780166626
Epoch: 2, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.792 Vali Acc: 0.067 Test Loss: 2.792 Test Acc: 0.067
Validation loss decreased (-0.049972 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 0.5681343078613281
Epoch: 3, Steps: 12 | Train Loss: 2.724 Vali Loss: 2.759 Vali Acc: 0.072 Test Loss: 2.759 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 0.7016608715057373
Epoch: 4, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.721 Vali Acc: 0.094 Test Loss: 2.721 Test Acc: 0.094
Validation loss decreased (-0.072195 --> -0.094417).  Saving model ...
Epoch: 5 cost time: 0.84494948387146
Epoch: 5, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.678 Vali Acc: 0.122 Test Loss: 2.678 Test Acc: 0.122
Validation loss decreased (-0.094417 --> -0.122195).  Saving model ...
Epoch: 6 cost time: 0.6232316493988037
Epoch: 6, Steps: 12 | Train Loss: 2.596 Vali Loss: 2.633 Vali Acc: 0.133 Test Loss: 2.633 Test Acc: 0.133
Validation loss decreased (-0.122195 --> -0.133307).  Saving model ...
Epoch: 7 cost time: 0.6927826404571533
Epoch: 7, Steps: 12 | Train Loss: 2.544 Vali Loss: 2.583 Vali Acc: 0.189 Test Loss: 2.583 Test Acc: 0.189
Validation loss decreased (-0.133307 --> -0.188863).  Saving model ...
Epoch: 8 cost time: 0.6875107288360596
Epoch: 8, Steps: 12 | Train Loss: 2.480 Vali Loss: 2.534 Vali Acc: 0.272 Test Loss: 2.534 Test Acc: 0.272
Validation loss decreased (-0.188863 --> -0.272197).  Saving model ...
Epoch: 9 cost time: 0.7976329326629639
Epoch: 9, Steps: 12 | Train Loss: 2.438 Vali Loss: 2.479 Vali Acc: 0.328 Test Loss: 2.479 Test Acc: 0.328
Validation loss decreased (-0.272197 --> -0.327753).  Saving model ...
Epoch: 10 cost time: 0.7814064025878906
Epoch: 10, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.421 Vali Acc: 0.383 Test Loss: 2.421 Test Acc: 0.383
Validation loss decreased (-0.327753 --> -0.383309).  Saving model ...
Epoch: 11 cost time: 0.6987347602844238
Epoch: 11, Steps: 12 | Train Loss: 2.289 Vali Loss: 2.356 Vali Acc: 0.417 Test Loss: 2.356 Test Acc: 0.417
Validation loss decreased (-0.383309 --> -0.416643).  Saving model ...
Epoch: 12 cost time: 0.6791133880615234
Epoch: 12, Steps: 12 | Train Loss: 2.210 Vali Loss: 2.284 Vali Acc: 0.467 Test Loss: 2.284 Test Acc: 0.467
Validation loss decreased (-0.416643 --> -0.466644).  Saving model ...
Epoch: 13 cost time: 0.733457088470459
Epoch: 13, Steps: 12 | Train Loss: 2.130 Vali Loss: 2.192 Vali Acc: 0.506 Test Loss: 2.192 Test Acc: 0.506
Validation loss decreased (-0.466644 --> -0.505534).  Saving model ...
Epoch: 14 cost time: 0.8581748008728027
Epoch: 14, Steps: 12 | Train Loss: 2.014 Vali Loss: 2.086 Vali Acc: 0.533 Test Loss: 2.086 Test Acc: 0.533
Validation loss decreased (-0.505534 --> -0.533312).  Saving model ...
Epoch: 15 cost time: 1.0423414707183838
Epoch: 15, Steps: 12 | Train Loss: 1.920 Vali Loss: 1.963 Vali Acc: 0.533 Test Loss: 1.963 Test Acc: 0.533
Validation loss decreased (-0.533312 --> -0.533314).  Saving model ...
Epoch: 16 cost time: 0.993809700012207
Epoch: 16, Steps: 12 | Train Loss: 1.788 Vali Loss: 1.849 Vali Acc: 0.539 Test Loss: 1.849 Test Acc: 0.539
Validation loss decreased (-0.533314 --> -0.538870).  Saving model ...
Epoch: 17 cost time: 0.9120843410491943
Epoch: 17, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.727 Vali Acc: 0.533 Test Loss: 1.727 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7409696578979492
Epoch: 18, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.643 Vali Acc: 0.556 Test Loss: 1.643 Test Acc: 0.556
Validation loss decreased (-0.538870 --> -0.555539).  Saving model ...
Epoch: 19 cost time: 0.7116692066192627
Epoch: 19, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.536 Vali Acc: 0.556 Test Loss: 1.536 Test Acc: 0.556
Validation loss decreased (-0.555539 --> -0.555540).  Saving model ...
Epoch: 20 cost time: 0.7141883373260498
Epoch: 20, Steps: 12 | Train Loss: 1.258 Vali Loss: 1.468 Vali Acc: 0.561 Test Loss: 1.468 Test Acc: 0.561
Validation loss decreased (-0.555540 --> -0.561096).  Saving model ...
Epoch: 21 cost time: 0.8462088108062744
Epoch: 21, Steps: 12 | Train Loss: 1.200 Vali Loss: 1.385 Vali Acc: 0.572 Test Loss: 1.385 Test Acc: 0.572
Validation loss decreased (-0.561096 --> -0.572208).  Saving model ...
Epoch: 22 cost time: 0.8749020099639893
Epoch: 22, Steps: 12 | Train Loss: 1.133 Vali Loss: 1.319 Vali Acc: 0.589 Test Loss: 1.319 Test Acc: 0.589
Validation loss decreased (-0.572208 --> -0.588876).  Saving model ...
Epoch: 23 cost time: 0.5917015075683594
Epoch: 23, Steps: 12 | Train Loss: 1.007 Vali Loss: 1.211 Vali Acc: 0.628 Test Loss: 1.211 Test Acc: 0.628
Validation loss decreased (-0.588876 --> -0.627766).  Saving model ...
Epoch: 24 cost time: 0.8690025806427002
Epoch: 24, Steps: 12 | Train Loss: 0.919 Vali Loss: 1.139 Vali Acc: 0.633 Test Loss: 1.139 Test Acc: 0.633
Validation loss decreased (-0.627766 --> -0.633322).  Saving model ...
Epoch: 25 cost time: 0.8004631996154785
Epoch: 25, Steps: 12 | Train Loss: 0.809 Vali Loss: 1.055 Vali Acc: 0.628 Test Loss: 1.055 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6770508289337158
Epoch: 26, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.998 Vali Acc: 0.622 Test Loss: 0.998 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6911890506744385
Epoch: 27, Steps: 12 | Train Loss: 0.674 Vali Loss: 0.920 Vali Acc: 0.661 Test Loss: 0.920 Test Acc: 0.661
Validation loss decreased (-0.633322 --> -0.661102).  Saving model ...
Epoch: 28 cost time: 0.69063401222229
Epoch: 28, Steps: 12 | Train Loss: 0.622 Vali Loss: 0.846 Vali Acc: 0.711 Test Loss: 0.846 Test Acc: 0.711
Validation loss decreased (-0.661102 --> -0.711103).  Saving model ...
Epoch: 29 cost time: 0.6460561752319336
Epoch: 29, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.811 Vali Acc: 0.722 Test Loss: 0.811 Test Acc: 0.722
Validation loss decreased (-0.711103 --> -0.722214).  Saving model ...
Epoch: 30 cost time: 0.7326922416687012
Epoch: 30, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.805 Vali Acc: 0.733 Test Loss: 0.805 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 31 cost time: 0.7046256065368652
Epoch: 31, Steps: 12 | Train Loss: 0.491 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7736372947692871
Epoch: 32, Steps: 12 | Train Loss: 0.424 Vali Loss: 0.788 Vali Acc: 0.728 Test Loss: 0.788 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8969089984893799
Epoch: 33, Steps: 12 | Train Loss: 0.401 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
Validation loss decreased (-0.733325 --> -0.738881).  Saving model ...
Epoch: 34 cost time: 0.6922721862792969
Epoch: 34, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.782 Vali Acc: 0.750 Test Loss: 0.782 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749992).  Saving model ...
Epoch: 35 cost time: 0.7868568897247314
Epoch: 35, Steps: 12 | Train Loss: 0.332 Vali Loss: 0.797 Vali Acc: 0.739 Test Loss: 0.797 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6675183773040771
Epoch: 36, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.790 Vali Acc: 0.733 Test Loss: 0.790 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6358487606048584
Epoch: 37, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.818 Vali Acc: 0.739 Test Loss: 0.818 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7679257392883301
Epoch: 38, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.799 Vali Acc: 0.733 Test Loss: 0.799 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9572560787200928
Epoch: 39, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.836 Vali Acc: 0.744 Test Loss: 0.836 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8479382991790771
Epoch: 40, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.809 Vali Acc: 0.689 Test Loss: 0.809 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7895026206970215
Epoch: 41, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.822 Vali Acc: 0.739 Test Loss: 0.822 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8501856327056885
Epoch: 42, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.855 Vali Acc: 0.717 Test Loss: 0.855 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7931292057037354
Epoch: 43, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.898 Vali Acc: 0.761 Test Loss: 0.898 Test Acc: 0.761
Validation loss decreased (-0.749992 --> -0.761102).  Saving model ...
Epoch: 44 cost time: 0.9557967185974121
Epoch: 44, Steps: 12 | Train Loss: 0.207 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7149548530578613
Epoch: 45, Steps: 12 | Train Loss: 0.176 Vali Loss: 0.843 Vali Acc: 0.733 Test Loss: 0.843 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7436978816986084
Epoch: 46, Steps: 12 | Train Loss: 0.164 Vali Loss: 0.855 Vali Acc: 0.744 Test Loss: 0.855 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7389945983886719
Epoch: 47, Steps: 12 | Train Loss: 0.170 Vali Loss: 0.935 Vali Acc: 0.772 Test Loss: 0.935 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772213).  Saving model ...
Epoch: 48 cost time: 0.8667483329772949
Epoch: 48, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.899 Vali Acc: 0.744 Test Loss: 0.899 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7470331192016602
Epoch: 49, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.900 Vali Acc: 0.750 Test Loss: 0.900 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9838461875915527
Epoch: 50, Steps: 12 | Train Loss: 0.129 Vali Loss: 0.922 Vali Acc: 0.772 Test Loss: 0.922 Test Acc: 0.772
Validation loss decreased (-0.772213 --> -0.772213).  Saving model ...
Epoch: 51 cost time: 0.834296703338623
Epoch: 51, Steps: 12 | Train Loss: 0.111 Vali Loss: 0.921 Vali Acc: 0.750 Test Loss: 0.921 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6333439350128174
Epoch: 52, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.983 Vali Acc: 0.783 Test Loss: 0.983 Test Acc: 0.783
Validation loss decreased (-0.772213 --> -0.783324).  Saving model ...
Epoch: 53 cost time: 0.6991961002349854
Epoch: 53, Steps: 12 | Train Loss: 0.115 Vali Loss: 0.979 Vali Acc: 0.750 Test Loss: 0.979 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7777979373931885
Epoch: 54, Steps: 12 | Train Loss: 0.102 Vali Loss: 1.006 Vali Acc: 0.772 Test Loss: 1.006 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7182021141052246
Epoch: 55, Steps: 12 | Train Loss: 0.125 Vali Loss: 1.110 Vali Acc: 0.711 Test Loss: 1.110 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8978965282440186
Epoch: 56, Steps: 12 | Train Loss: 0.110 Vali Loss: 1.087 Vali Acc: 0.772 Test Loss: 1.087 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6617577075958252
Epoch: 57, Steps: 12 | Train Loss: 0.120 Vali Loss: 1.054 Vali Acc: 0.761 Test Loss: 1.054 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.747187614440918
Epoch: 58, Steps: 12 | Train Loss: 0.078 Vali Loss: 1.045 Vali Acc: 0.783 Test Loss: 1.045 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.7745261192321777
Epoch: 59, Steps: 12 | Train Loss: 0.080 Vali Loss: 1.131 Vali Acc: 0.794 Test Loss: 1.131 Test Acc: 0.794
Validation loss decreased (-0.783324 --> -0.794433).  Saving model ...
Epoch: 60 cost time: 0.9056508541107178
Epoch: 60, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.080 Vali Acc: 0.761 Test Loss: 1.080 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8156287670135498
Epoch: 61, Steps: 12 | Train Loss: 0.060 Vali Loss: 1.120 Vali Acc: 0.750 Test Loss: 1.120 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8469293117523193
Epoch: 62, Steps: 12 | Train Loss: 0.054 Vali Loss: 1.141 Vali Acc: 0.767 Test Loss: 1.141 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7052643299102783
Epoch: 63, Steps: 12 | Train Loss: 0.101 Vali Loss: 1.163 Vali Acc: 0.756 Test Loss: 1.163 Test Acc: 0.756
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7835414409637451
Epoch: 64, Steps: 12 | Train Loss: 0.182 Vali Loss: 1.285 Vali Acc: 0.778 Test Loss: 1.285 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.6618309020996094
Epoch: 65, Steps: 12 | Train Loss: 0.066 Vali Loss: 1.195 Vali Acc: 0.733 Test Loss: 1.195 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8066380023956299
Epoch: 66, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.311 Vali Acc: 0.767 Test Loss: 1.311 Test Acc: 0.767
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.8659133911132812
Epoch: 67, Steps: 12 | Train Loss: 0.070 Vali Loss: 1.279 Vali Acc: 0.750 Test Loss: 1.279 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.13712477684021
Epoch: 68, Steps: 12 | Train Loss: 0.045 Vali Loss: 1.266 Vali Acc: 0.750 Test Loss: 1.266 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.7423510551452637
Epoch: 69, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.292 Vali Acc: 0.767 Test Loss: 1.292 Test Acc: 0.767
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm128_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 11278
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.5021212100982666
Epoch: 1, Steps: 12 | Train Loss: 2.750 Vali Loss: 2.725 Vali Acc: 0.072 Test Loss: 2.725 Test Acc: 0.072
Validation loss decreased (inf --> -0.072195).  Saving model ...
Epoch: 2 cost time: 0.6068315505981445
Epoch: 2, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.699 Vali Acc: 0.072 Test Loss: 2.699 Test Acc: 0.072
Validation loss decreased (-0.072195 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.7662656307220459
Epoch: 3, Steps: 12 | Train Loss: 2.673 Vali Loss: 2.665 Vali Acc: 0.100 Test Loss: 2.665 Test Acc: 0.100
Validation loss decreased (-0.072195 --> -0.099973).  Saving model ...
Epoch: 4 cost time: 0.7091832160949707
Epoch: 4, Steps: 12 | Train Loss: 2.636 Vali Loss: 2.622 Vali Acc: 0.117 Test Loss: 2.622 Test Acc: 0.117
Validation loss decreased (-0.099973 --> -0.116640).  Saving model ...
Epoch: 5 cost time: 0.5254580974578857
Epoch: 5, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.577 Vali Acc: 0.139 Test Loss: 2.577 Test Acc: 0.139
Validation loss decreased (-0.116640 --> -0.138863).  Saving model ...
Epoch: 6 cost time: 0.7876307964324951
Epoch: 6, Steps: 12 | Train Loss: 2.527 Vali Loss: 2.527 Vali Acc: 0.144 Test Loss: 2.527 Test Acc: 0.144
Validation loss decreased (-0.138863 --> -0.144419).  Saving model ...
Epoch: 7 cost time: 0.6054706573486328
Epoch: 7, Steps: 12 | Train Loss: 2.481 Vali Loss: 2.479 Vali Acc: 0.183 Test Loss: 2.479 Test Acc: 0.183
Validation loss decreased (-0.144419 --> -0.183309).  Saving model ...
Epoch: 8 cost time: 0.7244248390197754
Epoch: 8, Steps: 12 | Train Loss: 2.419 Vali Loss: 2.428 Vali Acc: 0.233 Test Loss: 2.428 Test Acc: 0.233
Validation loss decreased (-0.183309 --> -0.233309).  Saving model ...
Epoch: 9 cost time: 0.6699364185333252
Epoch: 9, Steps: 12 | Train Loss: 2.388 Vali Loss: 2.370 Vali Acc: 0.272 Test Loss: 2.370 Test Acc: 0.272
Validation loss decreased (-0.233309 --> -0.272199).  Saving model ...
Epoch: 10 cost time: 0.5788702964782715
Epoch: 10, Steps: 12 | Train Loss: 2.282 Vali Loss: 2.316 Vali Acc: 0.289 Test Loss: 2.316 Test Acc: 0.289
Validation loss decreased (-0.272199 --> -0.288866).  Saving model ...
Epoch: 11 cost time: 0.582829475402832
Epoch: 11, Steps: 12 | Train Loss: 2.223 Vali Loss: 2.257 Vali Acc: 0.300 Test Loss: 2.257 Test Acc: 0.300
Validation loss decreased (-0.288866 --> -0.299977).  Saving model ...
Epoch: 12 cost time: 0.7046620845794678
Epoch: 12, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.193 Vali Acc: 0.328 Test Loss: 2.193 Test Acc: 0.328
Validation loss decreased (-0.299977 --> -0.327756).  Saving model ...
Epoch: 13 cost time: 0.667149543762207
Epoch: 13, Steps: 12 | Train Loss: 2.101 Vali Loss: 2.130 Vali Acc: 0.356 Test Loss: 2.130 Test Acc: 0.356
Validation loss decreased (-0.327756 --> -0.355534).  Saving model ...
Epoch: 14 cost time: 0.6673433780670166
Epoch: 14, Steps: 12 | Train Loss: 2.044 Vali Loss: 2.068 Vali Acc: 0.378 Test Loss: 2.068 Test Acc: 0.378
Validation loss decreased (-0.355534 --> -0.377757).  Saving model ...
Epoch: 15 cost time: 1.0728843212127686
Epoch: 15, Steps: 12 | Train Loss: 1.925 Vali Loss: 2.006 Vali Acc: 0.400 Test Loss: 2.006 Test Acc: 0.400
Validation loss decreased (-0.377757 --> -0.399980).  Saving model ...
Epoch: 16 cost time: 0.7614028453826904
Epoch: 16, Steps: 12 | Train Loss: 1.832 Vali Loss: 1.942 Vali Acc: 0.400 Test Loss: 1.942 Test Acc: 0.400
Validation loss decreased (-0.399980 --> -0.399981).  Saving model ...
Epoch: 17 cost time: 0.8271758556365967
Epoch: 17, Steps: 12 | Train Loss: 1.750 Vali Loss: 1.873 Vali Acc: 0.422 Test Loss: 1.873 Test Acc: 0.422
Validation loss decreased (-0.399981 --> -0.422203).  Saving model ...
Epoch: 18 cost time: 0.899932861328125
Epoch: 18, Steps: 12 | Train Loss: 1.706 Vali Loss: 1.823 Vali Acc: 0.433 Test Loss: 1.823 Test Acc: 0.433
Validation loss decreased (-0.422203 --> -0.433315).  Saving model ...
Epoch: 19 cost time: 0.8290753364562988
Epoch: 19, Steps: 12 | Train Loss: 1.656 Vali Loss: 1.765 Vali Acc: 0.433 Test Loss: 1.765 Test Acc: 0.433
Validation loss decreased (-0.433315 --> -0.433316).  Saving model ...
Epoch: 20 cost time: 0.8836662769317627
Epoch: 20, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.694 Vali Acc: 0.467 Test Loss: 1.694 Test Acc: 0.467
Validation loss decreased (-0.433316 --> -0.466650).  Saving model ...
Epoch: 21 cost time: 0.6717500686645508
Epoch: 21, Steps: 12 | Train Loss: 1.547 Vali Loss: 1.649 Vali Acc: 0.483 Test Loss: 1.649 Test Acc: 0.483
Validation loss decreased (-0.466650 --> -0.483317).  Saving model ...
Epoch: 22 cost time: 0.7066395282745361
Epoch: 22, Steps: 12 | Train Loss: 1.481 Vali Loss: 1.596 Vali Acc: 0.500 Test Loss: 1.596 Test Acc: 0.500
Validation loss decreased (-0.483317 --> -0.499984).  Saving model ...
Epoch: 23 cost time: 0.7109358310699463
Epoch: 23, Steps: 12 | Train Loss: 1.382 Vali Loss: 1.534 Vali Acc: 0.517 Test Loss: 1.534 Test Acc: 0.517
Validation loss decreased (-0.499984 --> -0.516651).  Saving model ...
Epoch: 24 cost time: 0.7409887313842773
Epoch: 24, Steps: 12 | Train Loss: 1.304 Vali Loss: 1.473 Vali Acc: 0.550 Test Loss: 1.473 Test Acc: 0.550
Validation loss decreased (-0.516651 --> -0.549985).  Saving model ...
Epoch: 25 cost time: 0.8654859066009521
Epoch: 25, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.422 Vali Acc: 0.567 Test Loss: 1.422 Test Acc: 0.567
Validation loss decreased (-0.549985 --> -0.566652).  Saving model ...
Epoch: 26 cost time: 0.6403322219848633
Epoch: 26, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.366 Vali Acc: 0.544 Test Loss: 1.366 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8602514266967773
Epoch: 27, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.302 Vali Acc: 0.583 Test Loss: 1.302 Test Acc: 0.583
Validation loss decreased (-0.566652 --> -0.583320).  Saving model ...
Epoch: 28 cost time: 0.8770184516906738
Epoch: 28, Steps: 12 | Train Loss: 1.036 Vali Loss: 1.239 Vali Acc: 0.611 Test Loss: 1.239 Test Acc: 0.611
Validation loss decreased (-0.583320 --> -0.611099).  Saving model ...
Epoch: 29 cost time: 0.655524492263794
Epoch: 29, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.178 Vali Acc: 0.617 Test Loss: 1.178 Test Acc: 0.617
Validation loss decreased (-0.611099 --> -0.616655).  Saving model ...
Epoch: 30 cost time: 0.930917501449585
Epoch: 30, Steps: 12 | Train Loss: 0.912 Vali Loss: 1.134 Vali Acc: 0.617 Test Loss: 1.134 Test Acc: 0.617
Validation loss decreased (-0.616655 --> -0.616655).  Saving model ...
Epoch: 31 cost time: 0.7442874908447266
Epoch: 31, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.109 Vali Acc: 0.589 Test Loss: 1.109 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7034316062927246
Epoch: 32, Steps: 12 | Train Loss: 0.860 Vali Loss: 1.071 Vali Acc: 0.617 Test Loss: 1.071 Test Acc: 0.617
Validation loss decreased (-0.616655 --> -0.616656).  Saving model ...
Epoch: 33 cost time: 0.7203531265258789
Epoch: 33, Steps: 12 | Train Loss: 0.811 Vali Loss: 1.031 Vali Acc: 0.600 Test Loss: 1.031 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9636917114257812
Epoch: 34, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.005 Vali Acc: 0.606 Test Loss: 1.005 Test Acc: 0.606
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.887700080871582
Epoch: 35, Steps: 12 | Train Loss: 0.731 Vali Loss: 0.987 Vali Acc: 0.633 Test Loss: 0.987 Test Acc: 0.633
Validation loss decreased (-0.616656 --> -0.633323).  Saving model ...
Epoch: 36 cost time: 0.687443733215332
Epoch: 36, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.977 Vali Acc: 0.644 Test Loss: 0.977 Test Acc: 0.644
Validation loss decreased (-0.633323 --> -0.644435).  Saving model ...
Epoch: 37 cost time: 0.8272457122802734
Epoch: 37, Steps: 12 | Train Loss: 0.666 Vali Loss: 0.948 Vali Acc: 0.622 Test Loss: 0.948 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8271582126617432
Epoch: 38, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.928 Vali Acc: 0.656 Test Loss: 0.928 Test Acc: 0.656
Validation loss decreased (-0.644435 --> -0.655546).  Saving model ...
Epoch: 39 cost time: 0.7286355495452881
Epoch: 39, Steps: 12 | Train Loss: 0.624 Vali Loss: 0.936 Vali Acc: 0.667 Test Loss: 0.936 Test Acc: 0.667
Validation loss decreased (-0.655546 --> -0.666657).  Saving model ...
Epoch: 40 cost time: 0.7676558494567871
Epoch: 40, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.904 Vali Acc: 0.622 Test Loss: 0.904 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6275324821472168
Epoch: 41, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.887 Vali Acc: 0.650 Test Loss: 0.887 Test Acc: 0.650
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9210224151611328
Epoch: 42, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.875 Vali Acc: 0.650 Test Loss: 0.875 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7477021217346191
Epoch: 43, Steps: 12 | Train Loss: 0.560 Vali Loss: 0.862 Vali Acc: 0.667 Test Loss: 0.862 Test Acc: 0.667
Validation loss decreased (-0.666657 --> -0.666658).  Saving model ...
Epoch: 44 cost time: 0.81732177734375
Epoch: 44, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.869 Vali Acc: 0.639 Test Loss: 0.869 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7510471343994141
Epoch: 45, Steps: 12 | Train Loss: 0.538 Vali Loss: 0.859 Vali Acc: 0.694 Test Loss: 0.859 Test Acc: 0.694
Validation loss decreased (-0.666658 --> -0.694436).  Saving model ...
Epoch: 46 cost time: 0.6797676086425781
Epoch: 46, Steps: 12 | Train Loss: 0.486 Vali Loss: 0.880 Vali Acc: 0.689 Test Loss: 0.880 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6804854869842529
Epoch: 47, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.864 Vali Acc: 0.683 Test Loss: 0.864 Test Acc: 0.683
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9225301742553711
Epoch: 48, Steps: 12 | Train Loss: 0.466 Vali Loss: 0.852 Vali Acc: 0.672 Test Loss: 0.852 Test Acc: 0.672
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.8309409618377686
Epoch: 49, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.838 Vali Acc: 0.689 Test Loss: 0.838 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7090139389038086
Epoch: 50, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.846 Vali Acc: 0.689 Test Loss: 0.846 Test Acc: 0.689
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7120029926300049
Epoch: 51, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.849 Vali Acc: 0.689 Test Loss: 0.849 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.6880204677581787
Epoch: 52, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.849 Vali Acc: 0.722 Test Loss: 0.849 Test Acc: 0.722
Validation loss decreased (-0.694436 --> -0.722214).  Saving model ...
Epoch: 53 cost time: 0.7163312435150146
Epoch: 53, Steps: 12 | Train Loss: 0.394 Vali Loss: 0.867 Vali Acc: 0.711 Test Loss: 0.867 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6596536636352539
Epoch: 54, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.877 Vali Acc: 0.706 Test Loss: 0.877 Test Acc: 0.706
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7156648635864258
Epoch: 55, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.910 Vali Acc: 0.706 Test Loss: 0.910 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6778674125671387
Epoch: 56, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.885 Vali Acc: 0.728 Test Loss: 0.885 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727769).  Saving model ...
Epoch: 57 cost time: 0.7836272716522217
Epoch: 57, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.894 Vali Acc: 0.722 Test Loss: 0.894 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6301906108856201
Epoch: 58, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.912 Vali Acc: 0.733 Test Loss: 0.912 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733324).  Saving model ...
Epoch: 59 cost time: 0.6564087867736816
Epoch: 59, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.941 Vali Acc: 0.722 Test Loss: 0.941 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6718132495880127
Epoch: 60, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.920 Vali Acc: 0.722 Test Loss: 0.920 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8618934154510498
Epoch: 61, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.894 Vali Acc: 0.744 Test Loss: 0.894 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 62 cost time: 0.9666397571563721
Epoch: 62, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.927 Vali Acc: 0.722 Test Loss: 0.927 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9541940689086914
Epoch: 63, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.944 Vali Acc: 0.728 Test Loss: 0.944 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7638435363769531
Epoch: 64, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.984 Vali Acc: 0.717 Test Loss: 0.984 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.708369255065918
Epoch: 65, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.978 Vali Acc: 0.728 Test Loss: 0.978 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8070778846740723
Epoch: 66, Steps: 12 | Train Loss: 0.246 Vali Loss: 0.990 Vali Acc: 0.733 Test Loss: 0.990 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.8180551528930664
Epoch: 67, Steps: 12 | Train Loss: 0.250 Vali Loss: 1.037 Vali Acc: 0.733 Test Loss: 1.037 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.921741247177124
Epoch: 68, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.037 Vali Acc: 0.739 Test Loss: 1.037 Test Acc: 0.739
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.8694517612457275
Epoch: 69, Steps: 12 | Train Loss: 0.227 Vali Loss: 1.059 Vali Acc: 0.728 Test Loss: 1.059 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 1.0489606857299805
Epoch: 70, Steps: 12 | Train Loss: 0.270 Vali Loss: 1.145 Vali Acc: 0.728 Test Loss: 1.145 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.8889799118041992
Epoch: 71, Steps: 12 | Train Loss: 0.203 Vali Loss: 1.101 Vali Acc: 0.744 Test Loss: 1.101 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7444444444444445
model parameter : 6293
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.6346070766448975
Epoch: 1, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.760 Vali Acc: 0.067 Test Loss: 2.760 Test Acc: 0.067
Validation loss decreased (inf --> -0.066639).  Saving model ...
Epoch: 2 cost time: 0.796097993850708
Epoch: 2, Steps: 12 | Train Loss: 2.768 Vali Loss: 2.733 Vali Acc: 0.067 Test Loss: 2.733 Test Acc: 0.067
Validation loss decreased (-0.066639 --> -0.066639).  Saving model ...
Epoch: 3 cost time: 0.7853922843933105
Epoch: 3, Steps: 12 | Train Loss: 2.730 Vali Loss: 2.700 Vali Acc: 0.072 Test Loss: 2.700 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 4 cost time: 0.7108805179595947
Epoch: 4, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.659 Vali Acc: 0.089 Test Loss: 2.659 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 5 cost time: 0.8928301334381104
Epoch: 5, Steps: 12 | Train Loss: 2.649 Vali Loss: 2.617 Vali Acc: 0.094 Test Loss: 2.617 Test Acc: 0.094
Validation loss decreased (-0.088862 --> -0.094418).  Saving model ...
Epoch: 6 cost time: 0.6571502685546875
Epoch: 6, Steps: 12 | Train Loss: 2.593 Vali Loss: 2.569 Vali Acc: 0.139 Test Loss: 2.569 Test Acc: 0.139
Validation loss decreased (-0.094418 --> -0.138863).  Saving model ...
Epoch: 7 cost time: 0.780738115310669
Epoch: 7, Steps: 12 | Train Loss: 2.540 Vali Loss: 2.521 Vali Acc: 0.156 Test Loss: 2.521 Test Acc: 0.156
Validation loss decreased (-0.138863 --> -0.155530).  Saving model ...
Epoch: 8 cost time: 0.7553577423095703
Epoch: 8, Steps: 12 | Train Loss: 2.497 Vali Loss: 2.469 Vali Acc: 0.222 Test Loss: 2.469 Test Acc: 0.222
Validation loss decreased (-0.155530 --> -0.222198).  Saving model ...
Epoch: 9 cost time: 0.6200811862945557
Epoch: 9, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.418 Vali Acc: 0.283 Test Loss: 2.418 Test Acc: 0.283
Validation loss decreased (-0.222198 --> -0.283309).  Saving model ...
Epoch: 10 cost time: 0.7070355415344238
Epoch: 10, Steps: 12 | Train Loss: 2.345 Vali Loss: 2.364 Vali Acc: 0.328 Test Loss: 2.364 Test Acc: 0.328
Validation loss decreased (-0.283309 --> -0.327754).  Saving model ...
Epoch: 11 cost time: 0.7576394081115723
Epoch: 11, Steps: 12 | Train Loss: 2.289 Vali Loss: 2.306 Vali Acc: 0.356 Test Loss: 2.306 Test Acc: 0.356
Validation loss decreased (-0.327754 --> -0.355532).  Saving model ...
Epoch: 12 cost time: 0.6800904273986816
Epoch: 12, Steps: 12 | Train Loss: 2.235 Vali Loss: 2.251 Vali Acc: 0.394 Test Loss: 2.251 Test Acc: 0.394
Validation loss decreased (-0.355532 --> -0.394422).  Saving model ...
Epoch: 13 cost time: 0.733755350112915
Epoch: 13, Steps: 12 | Train Loss: 2.169 Vali Loss: 2.196 Vali Acc: 0.422 Test Loss: 2.196 Test Acc: 0.422
Validation loss decreased (-0.394422 --> -0.422200).  Saving model ...
Epoch: 14 cost time: 0.7520396709442139
Epoch: 14, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.143 Vali Acc: 0.422 Test Loss: 2.143 Test Acc: 0.422
Validation loss decreased (-0.422200 --> -0.422201).  Saving model ...
Epoch: 15 cost time: 0.7783534526824951
Epoch: 15, Steps: 12 | Train Loss: 2.029 Vali Loss: 2.087 Vali Acc: 0.456 Test Loss: 2.087 Test Acc: 0.456
Validation loss decreased (-0.422201 --> -0.455535).  Saving model ...
Epoch: 16 cost time: 0.7144765853881836
Epoch: 16, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.033 Vali Acc: 0.478 Test Loss: 2.033 Test Acc: 0.478
Validation loss decreased (-0.455535 --> -0.477757).  Saving model ...
Epoch: 17 cost time: 0.8176882266998291
Epoch: 17, Steps: 12 | Train Loss: 1.913 Vali Loss: 1.983 Vali Acc: 0.506 Test Loss: 1.983 Test Acc: 0.506
Validation loss decreased (-0.477757 --> -0.505536).  Saving model ...
Epoch: 18 cost time: 0.7621040344238281
Epoch: 18, Steps: 12 | Train Loss: 1.841 Vali Loss: 1.931 Vali Acc: 0.522 Test Loss: 1.931 Test Acc: 0.522
Validation loss decreased (-0.505536 --> -0.522203).  Saving model ...
Epoch: 19 cost time: 0.7303135395050049
Epoch: 19, Steps: 12 | Train Loss: 1.800 Vali Loss: 1.875 Vali Acc: 0.522 Test Loss: 1.875 Test Acc: 0.522
Validation loss decreased (-0.522203 --> -0.522203).  Saving model ...
Epoch: 20 cost time: 0.9574205875396729
Epoch: 20, Steps: 12 | Train Loss: 1.730 Vali Loss: 1.824 Vali Acc: 0.544 Test Loss: 1.824 Test Acc: 0.544
Validation loss decreased (-0.522203 --> -0.544426).  Saving model ...
Epoch: 21 cost time: 0.8342413902282715
Epoch: 21, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.776 Vali Acc: 0.561 Test Loss: 1.776 Test Acc: 0.561
Validation loss decreased (-0.544426 --> -0.561093).  Saving model ...
Epoch: 22 cost time: 0.7298331260681152
Epoch: 22, Steps: 12 | Train Loss: 1.619 Vali Loss: 1.722 Vali Acc: 0.556 Test Loss: 1.722 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9031684398651123
Epoch: 23, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.661 Vali Acc: 0.550 Test Loss: 1.661 Test Acc: 0.550
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7496399879455566
Epoch: 24, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.600 Vali Acc: 0.567 Test Loss: 1.600 Test Acc: 0.567
Validation loss decreased (-0.561093 --> -0.566651).  Saving model ...
Epoch: 25 cost time: 0.686730146408081
Epoch: 25, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.536 Vali Acc: 0.567 Test Loss: 1.536 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 26 cost time: 0.7049856185913086
Epoch: 26, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.472 Vali Acc: 0.578 Test Loss: 1.472 Test Acc: 0.578
Validation loss decreased (-0.566651 --> -0.577763).  Saving model ...
Epoch: 27 cost time: 0.8260898590087891
Epoch: 27, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.407 Vali Acc: 0.594 Test Loss: 1.407 Test Acc: 0.594
Validation loss decreased (-0.577763 --> -0.594430).  Saving model ...
Epoch: 28 cost time: 0.9926753044128418
Epoch: 28, Steps: 12 | Train Loss: 1.131 Vali Loss: 1.337 Vali Acc: 0.583 Test Loss: 1.337 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7975044250488281
Epoch: 29, Steps: 12 | Train Loss: 1.100 Vali Loss: 1.265 Vali Acc: 0.639 Test Loss: 1.265 Test Acc: 0.639
Validation loss decreased (-0.594430 --> -0.638876).  Saving model ...
Epoch: 30 cost time: 0.9092190265655518
Epoch: 30, Steps: 12 | Train Loss: 0.963 Vali Loss: 1.194 Vali Acc: 0.622 Test Loss: 1.194 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7212152481079102
Epoch: 31, Steps: 12 | Train Loss: 0.907 Vali Loss: 1.134 Vali Acc: 0.617 Test Loss: 1.134 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.750493049621582
Epoch: 32, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.063 Vali Acc: 0.622 Test Loss: 1.063 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7871592044830322
Epoch: 33, Steps: 12 | Train Loss: 0.751 Vali Loss: 0.994 Vali Acc: 0.661 Test Loss: 0.994 Test Acc: 0.661
Validation loss decreased (-0.638876 --> -0.661101).  Saving model ...
Epoch: 34 cost time: 0.7220427989959717
Epoch: 34, Steps: 12 | Train Loss: 0.711 Vali Loss: 0.957 Vali Acc: 0.650 Test Loss: 0.957 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7753989696502686
Epoch: 35, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.902 Vali Acc: 0.678 Test Loss: 0.902 Test Acc: 0.678
Validation loss decreased (-0.661101 --> -0.677769).  Saving model ...
Epoch: 36 cost time: 0.6977148056030273
Epoch: 36, Steps: 12 | Train Loss: 0.654 Vali Loss: 0.878 Vali Acc: 0.711 Test Loss: 0.878 Test Acc: 0.711
Validation loss decreased (-0.677769 --> -0.711102).  Saving model ...
Epoch: 37 cost time: 0.9665815830230713
Epoch: 37, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.836 Vali Acc: 0.711 Test Loss: 0.836 Test Acc: 0.711
Validation loss decreased (-0.711102 --> -0.711103).  Saving model ...
Epoch: 38 cost time: 1.033088207244873
Epoch: 38, Steps: 12 | Train Loss: 0.554 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
Validation loss decreased (-0.711103 --> -0.744436).  Saving model ...
Epoch: 39 cost time: 0.7328746318817139
Epoch: 39, Steps: 12 | Train Loss: 0.537 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6651041507720947
Epoch: 40, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.773 Vali Acc: 0.767 Test Loss: 0.773 Test Acc: 0.767
Validation loss decreased (-0.744436 --> -0.766659).  Saving model ...
Epoch: 41 cost time: 0.7178597450256348
Epoch: 41, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.797 Vali Acc: 0.711 Test Loss: 0.797 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8708522319793701
Epoch: 42, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.765 Vali Acc: 0.739 Test Loss: 0.765 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8246104717254639
Epoch: 43, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.762 Vali Acc: 0.739 Test Loss: 0.762 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7278933525085449
Epoch: 44, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.753 Vali Acc: 0.750 Test Loss: 0.753 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8013083934783936
Epoch: 45, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.747 Vali Acc: 0.761 Test Loss: 0.747 Test Acc: 0.761
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.754706859588623
Epoch: 46, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.731 Vali Acc: 0.756 Test Loss: 0.731 Test Acc: 0.756
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6652953624725342
Epoch: 47, Steps: 12 | Train Loss: 0.356 Vali Loss: 0.732 Vali Acc: 0.756 Test Loss: 0.732 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7855939865112305
Epoch: 48, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.754 Vali Acc: 0.744 Test Loss: 0.754 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8617904186248779
Epoch: 49, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.737 Vali Acc: 0.750 Test Loss: 0.737 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7754724025726318
Epoch: 50, Steps: 12 | Train Loss: 0.376 Vali Loss: 0.708 Vali Acc: 0.744 Test Loss: 0.708 Test Acc: 0.744
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7666666666666667
model parameter : 6006
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1634600162506104
Epoch: 1, Steps: 12 | Train Loss: 2.705 Vali Loss: 2.716 Vali Acc: 0.067 Test Loss: 2.716 Test Acc: 0.067
Validation loss decreased (inf --> -0.066640).  Saving model ...
Epoch: 2 cost time: 0.582564115524292
Epoch: 2, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.692 Vali Acc: 0.067 Test Loss: 2.692 Test Acc: 0.067
Validation loss decreased (-0.066640 --> -0.066640).  Saving model ...
Epoch: 3 cost time: 0.654757022857666
Epoch: 3, Steps: 12 | Train Loss: 2.642 Vali Loss: 2.659 Vali Acc: 0.072 Test Loss: 2.659 Test Acc: 0.072
Validation loss decreased (-0.066640 --> -0.072196).  Saving model ...
Epoch: 4 cost time: 0.6223771572113037
Epoch: 4, Steps: 12 | Train Loss: 2.615 Vali Loss: 2.621 Vali Acc: 0.094 Test Loss: 2.621 Test Acc: 0.094
Validation loss decreased (-0.072196 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.7162461280822754
Epoch: 5, Steps: 12 | Train Loss: 2.565 Vali Loss: 2.579 Vali Acc: 0.133 Test Loss: 2.579 Test Acc: 0.133
Validation loss decreased (-0.094418 --> -0.133308).  Saving model ...
Epoch: 6 cost time: 0.88204026222229
Epoch: 6, Steps: 12 | Train Loss: 2.518 Vali Loss: 2.533 Vali Acc: 0.217 Test Loss: 2.533 Test Acc: 0.217
Validation loss decreased (-0.133308 --> -0.216641).  Saving model ...
Epoch: 7 cost time: 0.6844134330749512
Epoch: 7, Steps: 12 | Train Loss: 2.454 Vali Loss: 2.484 Vali Acc: 0.267 Test Loss: 2.484 Test Acc: 0.267
Validation loss decreased (-0.216641 --> -0.266642).  Saving model ...
Epoch: 8 cost time: 0.6926858425140381
Epoch: 8, Steps: 12 | Train Loss: 2.422 Vali Loss: 2.432 Vali Acc: 0.317 Test Loss: 2.432 Test Acc: 0.317
Validation loss decreased (-0.266642 --> -0.316642).  Saving model ...
Epoch: 9 cost time: 0.8265171051025391
Epoch: 9, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.381 Vali Acc: 0.328 Test Loss: 2.381 Test Acc: 0.328
Validation loss decreased (-0.316642 --> -0.327754).  Saving model ...
Epoch: 10 cost time: 0.9697272777557373
Epoch: 10, Steps: 12 | Train Loss: 2.273 Vali Loss: 2.330 Vali Acc: 0.339 Test Loss: 2.330 Test Acc: 0.339
Validation loss decreased (-0.327754 --> -0.338866).  Saving model ...
Epoch: 11 cost time: 0.7200357913970947
Epoch: 11, Steps: 12 | Train Loss: 2.220 Vali Loss: 2.275 Vali Acc: 0.378 Test Loss: 2.275 Test Acc: 0.378
Validation loss decreased (-0.338866 --> -0.377755).  Saving model ...
Epoch: 12 cost time: 0.8540871143341064
Epoch: 12, Steps: 12 | Train Loss: 2.190 Vali Loss: 2.218 Vali Acc: 0.389 Test Loss: 2.218 Test Acc: 0.389
Validation loss decreased (-0.377755 --> -0.388867).  Saving model ...
Epoch: 13 cost time: 0.906684160232544
Epoch: 13, Steps: 12 | Train Loss: 2.083 Vali Loss: 2.165 Vali Acc: 0.422 Test Loss: 2.165 Test Acc: 0.422
Validation loss decreased (-0.388867 --> -0.422201).  Saving model ...
Epoch: 14 cost time: 0.7523367404937744
Epoch: 14, Steps: 12 | Train Loss: 2.054 Vali Loss: 2.109 Vali Acc: 0.439 Test Loss: 2.109 Test Acc: 0.439
Validation loss decreased (-0.422201 --> -0.438868).  Saving model ...
Epoch: 15 cost time: 0.9678695201873779
Epoch: 15, Steps: 12 | Train Loss: 1.997 Vali Loss: 2.058 Vali Acc: 0.456 Test Loss: 2.058 Test Acc: 0.456
Validation loss decreased (-0.438868 --> -0.455535).  Saving model ...
Epoch: 16 cost time: 0.9981586933135986
Epoch: 16, Steps: 12 | Train Loss: 1.946 Vali Loss: 2.006 Vali Acc: 0.467 Test Loss: 2.006 Test Acc: 0.467
Validation loss decreased (-0.455535 --> -0.466647).  Saving model ...
Epoch: 17 cost time: 0.8470213413238525
Epoch: 17, Steps: 12 | Train Loss: 1.892 Vali Loss: 1.953 Vali Acc: 0.489 Test Loss: 1.953 Test Acc: 0.489
Validation loss decreased (-0.466647 --> -0.488869).  Saving model ...
Epoch: 18 cost time: 0.7031724452972412
Epoch: 18, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.898 Vali Acc: 0.500 Test Loss: 1.898 Test Acc: 0.500
Validation loss decreased (-0.488869 --> -0.499981).  Saving model ...
Epoch: 19 cost time: 0.9085628986358643
Epoch: 19, Steps: 12 | Train Loss: 1.740 Vali Loss: 1.858 Vali Acc: 0.506 Test Loss: 1.858 Test Acc: 0.506
Validation loss decreased (-0.499981 --> -0.505537).  Saving model ...
Epoch: 20 cost time: 0.6109824180603027
Epoch: 20, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.815 Vali Acc: 0.517 Test Loss: 1.815 Test Acc: 0.517
Validation loss decreased (-0.505537 --> -0.516649).  Saving model ...
Epoch: 21 cost time: 0.6822657585144043
Epoch: 21, Steps: 12 | Train Loss: 1.663 Vali Loss: 1.774 Vali Acc: 0.522 Test Loss: 1.774 Test Acc: 0.522
Validation loss decreased (-0.516649 --> -0.522204).  Saving model ...
Epoch: 22 cost time: 0.6373672485351562
Epoch: 22, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.727 Vali Acc: 0.556 Test Loss: 1.727 Test Acc: 0.556
Validation loss decreased (-0.522204 --> -0.555538).  Saving model ...
Epoch: 23 cost time: 0.7561540603637695
Epoch: 23, Steps: 12 | Train Loss: 1.527 Vali Loss: 1.688 Vali Acc: 0.550 Test Loss: 1.688 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0068492889404297
Epoch: 24, Steps: 12 | Train Loss: 1.445 Vali Loss: 1.644 Vali Acc: 0.556 Test Loss: 1.644 Test Acc: 0.556
Validation loss decreased (-0.555538 --> -0.555539).  Saving model ...
Epoch: 25 cost time: 0.8496508598327637
Epoch: 25, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.611 Vali Acc: 0.572 Test Loss: 1.611 Test Acc: 0.572
Validation loss decreased (-0.555539 --> -0.572206).  Saving model ...
Epoch: 26 cost time: 0.7074415683746338
Epoch: 26, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.572 Vali Acc: 0.578 Test Loss: 1.572 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 27 cost time: 0.7382221221923828
Epoch: 27, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.521 Vali Acc: 0.589 Test Loss: 1.521 Test Acc: 0.589
Validation loss decreased (-0.577762 --> -0.588874).  Saving model ...
Epoch: 28 cost time: 0.6127927303314209
Epoch: 28, Steps: 12 | Train Loss: 1.282 Vali Loss: 1.482 Vali Acc: 0.594 Test Loss: 1.482 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594430).  Saving model ...
Epoch: 29 cost time: 0.7871417999267578
Epoch: 29, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.429 Vali Acc: 0.589 Test Loss: 1.429 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8247084617614746
Epoch: 30, Steps: 12 | Train Loss: 1.168 Vali Loss: 1.393 Vali Acc: 0.594 Test Loss: 1.393 Test Acc: 0.594
Validation loss decreased (-0.594430 --> -0.594431).  Saving model ...
Epoch: 31 cost time: 0.6530652046203613
Epoch: 31, Steps: 12 | Train Loss: 1.093 Vali Loss: 1.358 Vali Acc: 0.606 Test Loss: 1.358 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605542).  Saving model ...
Epoch: 32 cost time: 0.9082517623901367
Epoch: 32, Steps: 12 | Train Loss: 1.072 Vali Loss: 1.307 Vali Acc: 0.606 Test Loss: 1.307 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605542).  Saving model ...
Epoch: 33 cost time: 0.849545955657959
Epoch: 33, Steps: 12 | Train Loss: 1.030 Vali Loss: 1.271 Vali Acc: 0.617 Test Loss: 1.271 Test Acc: 0.617
Validation loss decreased (-0.605542 --> -0.616654).  Saving model ...
Epoch: 34 cost time: 0.8522334098815918
Epoch: 34, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.237 Vali Acc: 0.639 Test Loss: 1.237 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 35 cost time: 0.8060028553009033
Epoch: 35, Steps: 12 | Train Loss: 0.904 Vali Loss: 1.213 Vali Acc: 0.628 Test Loss: 1.213 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6715362071990967
Epoch: 36, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.198 Vali Acc: 0.622 Test Loss: 1.198 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6633505821228027
Epoch: 37, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.178 Vali Acc: 0.622 Test Loss: 1.178 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7776660919189453
Epoch: 38, Steps: 12 | Train Loss: 0.779 Vali Loss: 1.156 Vali Acc: 0.633 Test Loss: 1.156 Test Acc: 0.633
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7068932056427002
Epoch: 39, Steps: 12 | Train Loss: 0.758 Vali Loss: 1.139 Vali Acc: 0.639 Test Loss: 1.139 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 40 cost time: 0.7096202373504639
Epoch: 40, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.135 Vali Acc: 0.656 Test Loss: 1.135 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655544).  Saving model ...
Epoch: 41 cost time: 0.9373960494995117
Epoch: 41, Steps: 12 | Train Loss: 0.701 Vali Loss: 1.125 Vali Acc: 0.628 Test Loss: 1.125 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.067051887512207
Epoch: 42, Steps: 12 | Train Loss: 0.677 Vali Loss: 1.100 Vali Acc: 0.639 Test Loss: 1.100 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8774862289428711
Epoch: 43, Steps: 12 | Train Loss: 0.636 Vali Loss: 1.097 Vali Acc: 0.628 Test Loss: 1.097 Test Acc: 0.628
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9522960186004639
Epoch: 44, Steps: 12 | Train Loss: 0.629 Vali Loss: 1.078 Vali Acc: 0.650 Test Loss: 1.078 Test Acc: 0.650
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8597588539123535
Epoch: 45, Steps: 12 | Train Loss: 0.593 Vali Loss: 1.071 Vali Acc: 0.644 Test Loss: 1.071 Test Acc: 0.644
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9426472187042236
Epoch: 46, Steps: 12 | Train Loss: 0.573 Vali Loss: 1.076 Vali Acc: 0.656 Test Loss: 1.076 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655545).  Saving model ...
Epoch: 47 cost time: 0.8030030727386475
Epoch: 47, Steps: 12 | Train Loss: 0.549 Vali Loss: 1.070 Vali Acc: 0.656 Test Loss: 1.070 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 48 cost time: 0.9134676456451416
Epoch: 48, Steps: 12 | Train Loss: 0.590 Vali Loss: 1.057 Vali Acc: 0.656 Test Loss: 1.057 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 49 cost time: 1.0349853038787842
Epoch: 49, Steps: 12 | Train Loss: 0.600 Vali Loss: 1.044 Vali Acc: 0.656 Test Loss: 1.044 Test Acc: 0.656
Validation loss decreased (-0.655545 --> -0.655545).  Saving model ...
Epoch: 50 cost time: 0.7995610237121582
Epoch: 50, Steps: 12 | Train Loss: 0.497 Vali Loss: 1.030 Vali Acc: 0.667 Test Loss: 1.030 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666656).  Saving model ...
Epoch: 51 cost time: 0.8102009296417236
Epoch: 51, Steps: 12 | Train Loss: 0.521 Vali Loss: 1.045 Vali Acc: 0.656 Test Loss: 1.045 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6434535980224609
Epoch: 52, Steps: 12 | Train Loss: 0.460 Vali Loss: 1.040 Vali Acc: 0.661 Test Loss: 1.040 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7743539810180664
Epoch: 53, Steps: 12 | Train Loss: 0.440 Vali Loss: 1.032 Vali Acc: 0.661 Test Loss: 1.032 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6733036041259766
Epoch: 54, Steps: 12 | Train Loss: 0.442 Vali Loss: 1.037 Vali Acc: 0.678 Test Loss: 1.037 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 55 cost time: 0.884469747543335
Epoch: 55, Steps: 12 | Train Loss: 0.430 Vali Loss: 1.043 Vali Acc: 0.678 Test Loss: 1.043 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7592916488647461
Epoch: 56, Steps: 12 | Train Loss: 0.412 Vali Loss: 1.050 Vali Acc: 0.683 Test Loss: 1.050 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 57 cost time: 0.6529414653778076
Epoch: 57, Steps: 12 | Train Loss: 0.383 Vali Loss: 1.039 Vali Acc: 0.694 Test Loss: 1.039 Test Acc: 0.694
Validation loss decreased (-0.683323 --> -0.694434).  Saving model ...
Epoch: 58 cost time: 0.6633679866790771
Epoch: 58, Steps: 12 | Train Loss: 0.381 Vali Loss: 1.027 Vali Acc: 0.700 Test Loss: 1.027 Test Acc: 0.700
Validation loss decreased (-0.694434 --> -0.699990).  Saving model ...
Epoch: 59 cost time: 0.7600438594818115
Epoch: 59, Steps: 12 | Train Loss: 0.362 Vali Loss: 1.041 Vali Acc: 0.706 Test Loss: 1.041 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705545).  Saving model ...
Epoch: 60 cost time: 0.7694001197814941
Epoch: 60, Steps: 12 | Train Loss: 0.345 Vali Loss: 1.042 Vali Acc: 0.706 Test Loss: 1.042 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8021435737609863
Epoch: 61, Steps: 12 | Train Loss: 0.348 Vali Loss: 1.058 Vali Acc: 0.717 Test Loss: 1.058 Test Acc: 0.717
Validation loss decreased (-0.705545 --> -0.716656).  Saving model ...
Epoch: 62 cost time: 0.7274820804595947
Epoch: 62, Steps: 12 | Train Loss: 0.338 Vali Loss: 1.041 Vali Acc: 0.706 Test Loss: 1.041 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7489016056060791
Epoch: 63, Steps: 12 | Train Loss: 0.337 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9035427570343018
Epoch: 64, Steps: 12 | Train Loss: 0.339 Vali Loss: 1.056 Vali Acc: 0.722 Test Loss: 1.056 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722212).  Saving model ...
Epoch: 65 cost time: 0.7045605182647705
Epoch: 65, Steps: 12 | Train Loss: 0.296 Vali Loss: 1.055 Vali Acc: 0.711 Test Loss: 1.055 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7223124504089355
Epoch: 66, Steps: 12 | Train Loss: 0.292 Vali Loss: 1.065 Vali Acc: 0.711 Test Loss: 1.065 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.9511158466339111
Epoch: 67, Steps: 12 | Train Loss: 0.361 Vali Loss: 1.068 Vali Acc: 0.722 Test Loss: 1.068 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8115384578704834
Epoch: 68, Steps: 12 | Train Loss: 0.274 Vali Loss: 1.079 Vali Acc: 0.711 Test Loss: 1.079 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.7193758487701416
Epoch: 69, Steps: 12 | Train Loss: 0.249 Vali Loss: 1.067 Vali Acc: 0.733 Test Loss: 1.067 Test Acc: 0.733
Validation loss decreased (-0.722212 --> -0.733323).  Saving model ...
Epoch: 70 cost time: 0.6066782474517822
Epoch: 70, Steps: 12 | Train Loss: 0.277 Vali Loss: 1.049 Vali Acc: 0.722 Test Loss: 1.049 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7058587074279785
Epoch: 71, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.065 Vali Acc: 0.733 Test Loss: 1.065 Test Acc: 0.733
Validation loss decreased (-0.733323 --> -0.733323).  Saving model ...
Epoch: 72 cost time: 0.7671360969543457
Epoch: 72, Steps: 12 | Train Loss: 0.289 Vali Loss: 1.088 Vali Acc: 0.722 Test Loss: 1.088 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.709120512008667
Epoch: 73, Steps: 12 | Train Loss: 0.244 Vali Loss: 1.051 Vali Acc: 0.739 Test Loss: 1.051 Test Acc: 0.739
Validation loss decreased (-0.733323 --> -0.738878).  Saving model ...
Epoch: 74 cost time: 0.7652709484100342
Epoch: 74, Steps: 12 | Train Loss: 0.242 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
Validation loss decreased (-0.738878 --> -0.749989).  Saving model ...
Epoch: 75 cost time: 0.7016386985778809
Epoch: 75, Steps: 12 | Train Loss: 0.233 Vali Loss: 1.072 Vali Acc: 0.733 Test Loss: 1.072 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.9317491054534912
Epoch: 76, Steps: 12 | Train Loss: 0.202 Vali Loss: 1.059 Vali Acc: 0.750 Test Loss: 1.059 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 77 cost time: 0.786217212677002
Epoch: 77, Steps: 12 | Train Loss: 0.225 Vali Loss: 1.059 Vali Acc: 0.750 Test Loss: 1.059 Test Acc: 0.750
Validation loss decreased (-0.749989 --> -0.749989).  Saving model ...
Epoch: 78 cost time: 0.7278218269348145
Epoch: 78, Steps: 12 | Train Loss: 0.196 Vali Loss: 1.084 Vali Acc: 0.756 Test Loss: 1.084 Test Acc: 0.756
Validation loss decreased (-0.749989 --> -0.755545).  Saving model ...
Epoch: 79 cost time: 0.9581191539764404
Epoch: 79, Steps: 12 | Train Loss: 0.175 Vali Loss: 1.060 Vali Acc: 0.750 Test Loss: 1.060 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8186154365539551
Epoch: 80, Steps: 12 | Train Loss: 0.176 Vali Loss: 1.079 Vali Acc: 0.767 Test Loss: 1.079 Test Acc: 0.767
Validation loss decreased (-0.755545 --> -0.766656).  Saving model ...
Epoch: 81 cost time: 0.7837378978729248
Epoch: 81, Steps: 12 | Train Loss: 0.209 Vali Loss: 1.075 Vali Acc: 0.739 Test Loss: 1.075 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7462007999420166
Epoch: 82, Steps: 12 | Train Loss: 0.153 Vali Loss: 1.067 Vali Acc: 0.756 Test Loss: 1.067 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7344183921813965
Epoch: 83, Steps: 12 | Train Loss: 0.139 Vali Loss: 1.084 Vali Acc: 0.756 Test Loss: 1.084 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 1.0442445278167725
Epoch: 84, Steps: 12 | Train Loss: 0.135 Vali Loss: 1.100 Vali Acc: 0.761 Test Loss: 1.100 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.8704690933227539
Epoch: 85, Steps: 12 | Train Loss: 0.126 Vali Loss: 1.085 Vali Acc: 0.778 Test Loss: 1.085 Test Acc: 0.778
Validation loss decreased (-0.766656 --> -0.777767).  Saving model ...
Epoch: 86 cost time: 0.7933094501495361
Epoch: 86, Steps: 12 | Train Loss: 0.121 Vali Loss: 1.134 Vali Acc: 0.767 Test Loss: 1.134 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 1.0149486064910889
Epoch: 87, Steps: 12 | Train Loss: 0.104 Vali Loss: 1.135 Vali Acc: 0.772 Test Loss: 1.135 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.708965539932251
Epoch: 88, Steps: 12 | Train Loss: 0.107 Vali Loss: 1.131 Vali Acc: 0.767 Test Loss: 1.131 Test Acc: 0.767
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.8076357841491699
Epoch: 89, Steps: 12 | Train Loss: 0.099 Vali Loss: 1.142 Vali Acc: 0.733 Test Loss: 1.142 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.9125914573669434
Epoch: 90, Steps: 12 | Train Loss: 0.093 Vali Loss: 1.145 Vali Acc: 0.778 Test Loss: 1.145 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.754680871963501
Epoch: 91, Steps: 12 | Train Loss: 0.092 Vali Loss: 1.162 Vali Acc: 0.778 Test Loss: 1.162 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.7790322303771973
Epoch: 92, Steps: 12 | Train Loss: 0.111 Vali Loss: 1.222 Vali Acc: 0.772 Test Loss: 1.222 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.9980289936065674
Epoch: 93, Steps: 12 | Train Loss: 0.077 Vali Loss: 1.187 Vali Acc: 0.767 Test Loss: 1.187 Test Acc: 0.767
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.9235472679138184
Epoch: 94, Steps: 12 | Train Loss: 0.071 Vali Loss: 1.226 Vali Acc: 0.783 Test Loss: 1.226 Test Acc: 0.783
Validation loss decreased (-0.777767 --> -0.783321).  Saving model ...
Epoch: 95 cost time: 1.0098850727081299
Epoch: 95, Steps: 12 | Train Loss: 0.068 Vali Loss: 1.224 Vali Acc: 0.778 Test Loss: 1.224 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9116849899291992
Epoch: 96, Steps: 12 | Train Loss: 0.063 Vali Loss: 1.246 Vali Acc: 0.789 Test Loss: 1.246 Test Acc: 0.789
Validation loss decreased (-0.783321 --> -0.788876).  Saving model ...
Epoch: 97 cost time: 0.8820991516113281
Epoch: 97, Steps: 12 | Train Loss: 0.062 Vali Loss: 1.254 Vali Acc: 0.789 Test Loss: 1.254 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.8669302463531494
Epoch: 98, Steps: 12 | Train Loss: 0.061 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.983217716217041
Epoch: 99, Steps: 12 | Train Loss: 0.050 Vali Loss: 1.318 Vali Acc: 0.778 Test Loss: 1.318 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 100 cost time: 0.7748079299926758
Epoch: 100, Steps: 12 | Train Loss: 0.042 Vali Loss: 1.314 Vali Acc: 0.783 Test Loss: 1.314 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 6063
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0270261764526367
Epoch: 1, Steps: 12 | Train Loss: 2.737 Vali Loss: 2.730 Vali Acc: 0.056 Test Loss: 2.730 Test Acc: 0.056
Validation loss decreased (inf --> -0.055528).  Saving model ...
Epoch: 2 cost time: 0.7851223945617676
Epoch: 2, Steps: 12 | Train Loss: 2.745 Vali Loss: 2.704 Vali Acc: 0.072 Test Loss: 2.704 Test Acc: 0.072
Validation loss decreased (-0.055528 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.8339240550994873
Epoch: 3, Steps: 12 | Train Loss: 2.680 Vali Loss: 2.669 Vali Acc: 0.083 Test Loss: 2.669 Test Acc: 0.083
Validation loss decreased (-0.072195 --> -0.083307).  Saving model ...
Epoch: 4 cost time: 0.9310922622680664
Epoch: 4, Steps: 12 | Train Loss: 2.645 Vali Loss: 2.630 Vali Acc: 0.100 Test Loss: 2.630 Test Acc: 0.100
Validation loss decreased (-0.083307 --> -0.099974).  Saving model ...
Epoch: 5 cost time: 0.7250275611877441
Epoch: 5, Steps: 12 | Train Loss: 2.605 Vali Loss: 2.586 Vali Acc: 0.117 Test Loss: 2.586 Test Acc: 0.117
Validation loss decreased (-0.099974 --> -0.116641).  Saving model ...
Epoch: 6 cost time: 0.7250919342041016
Epoch: 6, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.540 Vali Acc: 0.172 Test Loss: 2.540 Test Acc: 0.172
Validation loss decreased (-0.116641 --> -0.172197).  Saving model ...
Epoch: 7 cost time: 0.7855556011199951
Epoch: 7, Steps: 12 | Train Loss: 2.493 Vali Loss: 2.493 Vali Acc: 0.217 Test Loss: 2.493 Test Acc: 0.217
Validation loss decreased (-0.172197 --> -0.216642).  Saving model ...
Epoch: 8 cost time: 0.6762862205505371
Epoch: 8, Steps: 12 | Train Loss: 2.448 Vali Loss: 2.444 Vali Acc: 0.250 Test Loss: 2.444 Test Acc: 0.250
Validation loss decreased (-0.216642 --> -0.249976).  Saving model ...
Epoch: 9 cost time: 0.6843287944793701
Epoch: 9, Steps: 12 | Train Loss: 2.373 Vali Loss: 2.394 Vali Acc: 0.333 Test Loss: 2.394 Test Acc: 0.333
Validation loss decreased (-0.249976 --> -0.333309).  Saving model ...
Epoch: 10 cost time: 0.7322680950164795
Epoch: 10, Steps: 12 | Train Loss: 2.306 Vali Loss: 2.335 Vali Acc: 0.361 Test Loss: 2.335 Test Acc: 0.361
Validation loss decreased (-0.333309 --> -0.361088).  Saving model ...
Epoch: 11 cost time: 0.7770073413848877
Epoch: 11, Steps: 12 | Train Loss: 2.250 Vali Loss: 2.281 Vali Acc: 0.367 Test Loss: 2.281 Test Acc: 0.367
Validation loss decreased (-0.361088 --> -0.366644).  Saving model ...
Epoch: 12 cost time: 0.9208400249481201
Epoch: 12, Steps: 12 | Train Loss: 2.194 Vali Loss: 2.228 Vali Acc: 0.389 Test Loss: 2.228 Test Acc: 0.389
Validation loss decreased (-0.366644 --> -0.388867).  Saving model ...
Epoch: 13 cost time: 0.6084990501403809
Epoch: 13, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.173 Vali Acc: 0.439 Test Loss: 2.173 Test Acc: 0.439
Validation loss decreased (-0.388867 --> -0.438867).  Saving model ...
Epoch: 14 cost time: 0.6228539943695068
Epoch: 14, Steps: 12 | Train Loss: 2.055 Vali Loss: 2.118 Vali Acc: 0.450 Test Loss: 2.118 Test Acc: 0.450
Validation loss decreased (-0.438867 --> -0.449979).  Saving model ...
Epoch: 15 cost time: 0.6133229732513428
Epoch: 15, Steps: 12 | Train Loss: 1.995 Vali Loss: 2.060 Vali Acc: 0.483 Test Loss: 2.060 Test Acc: 0.483
Validation loss decreased (-0.449979 --> -0.483313).  Saving model ...
Epoch: 16 cost time: 0.7864265441894531
Epoch: 16, Steps: 12 | Train Loss: 1.908 Vali Loss: 2.002 Vali Acc: 0.500 Test Loss: 2.002 Test Acc: 0.500
Validation loss decreased (-0.483313 --> -0.499980).  Saving model ...
Epoch: 17 cost time: 0.9333302974700928
Epoch: 17, Steps: 12 | Train Loss: 1.873 Vali Loss: 1.946 Vali Acc: 0.494 Test Loss: 1.946 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7594523429870605
Epoch: 18, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.894 Vali Acc: 0.539 Test Loss: 1.894 Test Acc: 0.539
Validation loss decreased (-0.499980 --> -0.538870).  Saving model ...
Epoch: 19 cost time: 0.7354834079742432
Epoch: 19, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.839 Vali Acc: 0.550 Test Loss: 1.839 Test Acc: 0.550
Validation loss decreased (-0.538870 --> -0.549982).  Saving model ...
Epoch: 20 cost time: 0.7339046001434326
Epoch: 20, Steps: 12 | Train Loss: 1.710 Vali Loss: 1.793 Vali Acc: 0.589 Test Loss: 1.793 Test Acc: 0.589
Validation loss decreased (-0.549982 --> -0.588871).  Saving model ...
Epoch: 21 cost time: 0.7618691921234131
Epoch: 21, Steps: 12 | Train Loss: 1.623 Vali Loss: 1.744 Vali Acc: 0.556 Test Loss: 1.744 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7082064151763916
Epoch: 22, Steps: 12 | Train Loss: 1.560 Vali Loss: 1.707 Vali Acc: 0.567 Test Loss: 1.707 Test Acc: 0.567
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7985358238220215
Epoch: 23, Steps: 12 | Train Loss: 1.549 Vali Loss: 1.663 Vali Acc: 0.550 Test Loss: 1.663 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6911869049072266
Epoch: 24, Steps: 12 | Train Loss: 1.472 Vali Loss: 1.627 Vali Acc: 0.561 Test Loss: 1.627 Test Acc: 0.561
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7343649864196777
Epoch: 25, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.587 Vali Acc: 0.567 Test Loss: 1.587 Test Acc: 0.567
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7430875301361084
Epoch: 26, Steps: 12 | Train Loss: 1.348 Vali Loss: 1.549 Vali Acc: 0.556 Test Loss: 1.549 Test Acc: 0.556
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0781614780426025
Epoch: 27, Steps: 12 | Train Loss: 1.400 Vali Loss: 1.507 Vali Acc: 0.567 Test Loss: 1.507 Test Acc: 0.567
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8969602584838867
Epoch: 28, Steps: 12 | Train Loss: 1.263 Vali Loss: 1.468 Vali Acc: 0.578 Test Loss: 1.468 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9131064414978027
Epoch: 29, Steps: 12 | Train Loss: 1.233 Vali Loss: 1.422 Vali Acc: 0.594 Test Loss: 1.422 Test Acc: 0.594
Validation loss decreased (-0.588871 --> -0.594430).  Saving model ...
Epoch: 30 cost time: 0.8084356784820557
Epoch: 30, Steps: 12 | Train Loss: 1.187 Vali Loss: 1.371 Vali Acc: 0.622 Test Loss: 1.371 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622209).  Saving model ...
Epoch: 31 cost time: 0.9861505031585693
Epoch: 31, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.323 Vali Acc: 0.611 Test Loss: 1.323 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0334510803222656
Epoch: 32, Steps: 12 | Train Loss: 1.045 Vali Loss: 1.269 Vali Acc: 0.622 Test Loss: 1.269 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 33 cost time: 0.8622472286224365
Epoch: 33, Steps: 12 | Train Loss: 1.020 Vali Loss: 1.229 Vali Acc: 0.628 Test Loss: 1.229 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627765).  Saving model ...
Epoch: 34 cost time: 1.0061149597167969
Epoch: 34, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.180 Vali Acc: 0.611 Test Loss: 1.180 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8918600082397461
Epoch: 35, Steps: 12 | Train Loss: 0.906 Vali Loss: 1.125 Vali Acc: 0.611 Test Loss: 1.125 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8506898880004883
Epoch: 36, Steps: 12 | Train Loss: 0.874 Vali Loss: 1.071 Vali Acc: 0.628 Test Loss: 1.071 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627767).  Saving model ...
Epoch: 37 cost time: 0.7883415222167969
Epoch: 37, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.037 Vali Acc: 0.633 Test Loss: 1.037 Test Acc: 0.633
Validation loss decreased (-0.627767 --> -0.633323).  Saving model ...
Epoch: 38 cost time: 0.882671594619751
Epoch: 38, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.989 Vali Acc: 0.678 Test Loss: 0.989 Test Acc: 0.678
Validation loss decreased (-0.633323 --> -0.677768).  Saving model ...
Epoch: 39 cost time: 0.842724084854126
Epoch: 39, Steps: 12 | Train Loss: 0.667 Vali Loss: 0.928 Vali Acc: 0.700 Test Loss: 0.928 Test Acc: 0.700
Validation loss decreased (-0.677768 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 1.0395042896270752
Epoch: 40, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.908 Vali Acc: 0.672 Test Loss: 0.908 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7878603935241699
Epoch: 41, Steps: 12 | Train Loss: 0.589 Vali Loss: 0.858 Vali Acc: 0.700 Test Loss: 0.858 Test Acc: 0.700
Validation loss decreased (-0.699991 --> -0.699991).  Saving model ...
Epoch: 42 cost time: 0.6862053871154785
Epoch: 42, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.847 Vali Acc: 0.694 Test Loss: 0.847 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9925105571746826
Epoch: 43, Steps: 12 | Train Loss: 0.541 Vali Loss: 0.824 Vali Acc: 0.672 Test Loss: 0.824 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7878520488739014
Epoch: 44, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.794 Vali Acc: 0.694 Test Loss: 0.794 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8152008056640625
Epoch: 45, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.773 Vali Acc: 0.689 Test Loss: 0.773 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.967024564743042
Epoch: 46, Steps: 12 | Train Loss: 0.418 Vali Loss: 0.753 Vali Acc: 0.694 Test Loss: 0.753 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7577919960021973
Epoch: 47, Steps: 12 | Train Loss: 0.390 Vali Loss: 0.748 Vali Acc: 0.722 Test Loss: 0.748 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722215).  Saving model ...
Epoch: 48 cost time: 0.8978285789489746
Epoch: 48, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8132860660552979
Epoch: 49, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.706 Vali Acc: 0.733 Test Loss: 0.706 Test Acc: 0.733
Validation loss decreased (-0.722215 --> -0.733326).  Saving model ...
Epoch: 50 cost time: 0.8498365879058838
Epoch: 50, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.696 Vali Acc: 0.728 Test Loss: 0.696 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0747077465057373
Epoch: 51, Steps: 12 | Train Loss: 0.279 Vali Loss: 0.698 Vali Acc: 0.711 Test Loss: 0.698 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0590424537658691
Epoch: 52, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.684 Vali Acc: 0.750 Test Loss: 0.684 Test Acc: 0.750
Validation loss decreased (-0.733326 --> -0.749993).  Saving model ...
Epoch: 53 cost time: 0.8371291160583496
Epoch: 53, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.680 Vali Acc: 0.744 Test Loss: 0.680 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.865605354309082
Epoch: 54, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.646 Vali Acc: 0.750 Test Loss: 0.646 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 55 cost time: 1.032397985458374
Epoch: 55, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.670 Vali Acc: 0.739 Test Loss: 0.670 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1049549579620361
Epoch: 56, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.639 Vali Acc: 0.761 Test Loss: 0.639 Test Acc: 0.761
Validation loss decreased (-0.749994 --> -0.761105).  Saving model ...
Epoch: 57 cost time: 0.8053615093231201
Epoch: 57, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.642 Vali Acc: 0.756 Test Loss: 0.642 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0350418090820312
Epoch: 58, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.653 Vali Acc: 0.761 Test Loss: 0.653 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.1372475624084473
Epoch: 59, Steps: 12 | Train Loss: 0.161 Vali Loss: 0.652 Vali Acc: 0.778 Test Loss: 0.652 Test Acc: 0.778
Validation loss decreased (-0.761105 --> -0.777771).  Saving model ...
Epoch: 60 cost time: 0.9490354061126709
Epoch: 60, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.692 Vali Acc: 0.739 Test Loss: 0.692 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0636706352233887
Epoch: 61, Steps: 12 | Train Loss: 0.149 Vali Loss: 0.618 Vali Acc: 0.772 Test Loss: 0.618 Test Acc: 0.772
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0407359600067139
Epoch: 62, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.646 Vali Acc: 0.778 Test Loss: 0.646 Test Acc: 0.778
Validation loss decreased (-0.777771 --> -0.777771).  Saving model ...
Epoch: 63 cost time: 0.9424097537994385
Epoch: 63, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.656 Vali Acc: 0.772 Test Loss: 0.656 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9425230026245117
Epoch: 64, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.644 Vali Acc: 0.761 Test Loss: 0.644 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9596109390258789
Epoch: 65, Steps: 12 | Train Loss: 0.109 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.777771 --> -0.783327).  Saving model ...
Epoch: 66 cost time: 1.002640962600708
Epoch: 66, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.663 Vali Acc: 0.778 Test Loss: 0.663 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.0252392292022705
Epoch: 67, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.660 Vali Acc: 0.778 Test Loss: 0.660 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8632290363311768
Epoch: 68, Steps: 12 | Train Loss: 0.085 Vali Loss: 0.650 Vali Acc: 0.794 Test Loss: 0.650 Test Acc: 0.794
Validation loss decreased (-0.783327 --> -0.794438).  Saving model ...
Epoch: 69 cost time: 0.9191906452178955
Epoch: 69, Steps: 12 | Train Loss: 0.105 Vali Loss: 0.700 Vali Acc: 0.756 Test Loss: 0.700 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8630669116973877
Epoch: 70, Steps: 12 | Train Loss: 0.075 Vali Loss: 0.641 Vali Acc: 0.778 Test Loss: 0.641 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.3183467388153076
Epoch: 71, Steps: 12 | Train Loss: 0.068 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.0401439666748047
Epoch: 72, Steps: 12 | Train Loss: 0.064 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.0427117347717285
Epoch: 73, Steps: 12 | Train Loss: 0.058 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.897742509841919
Epoch: 74, Steps: 12 | Train Loss: 0.065 Vali Loss: 0.678 Vali Acc: 0.794 Test Loss: 0.678 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.7960894107818604
Epoch: 75, Steps: 12 | Train Loss: 0.057 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.9850630760192871
Epoch: 76, Steps: 12 | Train Loss: 0.053 Vali Loss: 0.703 Vali Acc: 0.800 Test Loss: 0.703 Test Acc: 0.800
Validation loss decreased (-0.794438 --> -0.799993).  Saving model ...
Epoch: 77 cost time: 0.8686690330505371
Epoch: 77, Steps: 12 | Train Loss: 0.052 Vali Loss: 0.669 Vali Acc: 0.817 Test Loss: 0.669 Test Acc: 0.817
Validation loss decreased (-0.799993 --> -0.816660).  Saving model ...
Epoch: 78 cost time: 0.9178073406219482
Epoch: 78, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.718 Vali Acc: 0.778 Test Loss: 0.718 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 1.0328967571258545
Epoch: 79, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.8556535243988037
Epoch: 80, Steps: 12 | Train Loss: 0.043 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.8663477897644043
Epoch: 81, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.728 Vali Acc: 0.811 Test Loss: 0.728 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.7373638153076172
Epoch: 82, Steps: 12 | Train Loss: 0.028 Vali Loss: 0.737 Vali Acc: 0.794 Test Loss: 0.737 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.9163751602172852
Epoch: 83, Steps: 12 | Train Loss: 0.031 Vali Loss: 0.733 Vali Acc: 0.794 Test Loss: 0.733 Test Acc: 0.794
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.9843363761901855
Epoch: 84, Steps: 12 | Train Loss: 0.033 Vali Loss: 0.732 Vali Acc: 0.800 Test Loss: 0.732 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 1.0380749702453613
Epoch: 85, Steps: 12 | Train Loss: 0.027 Vali Loss: 0.735 Vali Acc: 0.800 Test Loss: 0.735 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.7339556217193604
Epoch: 86, Steps: 12 | Train Loss: 0.023 Vali Loss: 0.745 Vali Acc: 0.806 Test Loss: 0.745 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.890192985534668
Epoch: 87, Steps: 12 | Train Loss: 0.026 Vali Loss: 0.761 Vali Acc: 0.806 Test Loss: 0.761 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 5854
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.823399066925049
Epoch: 1, Steps: 12 | Train Loss: 2.854 Vali Loss: 2.832 Vali Acc: 0.072 Test Loss: 2.832 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 1.017296314239502
Epoch: 2, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.803 Vali Acc: 0.094 Test Loss: 2.803 Test Acc: 0.094
Validation loss decreased (-0.072194 --> -0.094416).  Saving model ...
Epoch: 3 cost time: 0.7377088069915771
Epoch: 3, Steps: 12 | Train Loss: 2.767 Vali Loss: 2.767 Vali Acc: 0.111 Test Loss: 2.767 Test Acc: 0.111
Validation loss decreased (-0.094416 --> -0.111083).  Saving model ...
Epoch: 4 cost time: 0.786095380783081
Epoch: 4, Steps: 12 | Train Loss: 2.739 Vali Loss: 2.726 Vali Acc: 0.111 Test Loss: 2.726 Test Acc: 0.111
Validation loss decreased (-0.111083 --> -0.111084).  Saving model ...
Epoch: 5 cost time: 0.7727882862091064
Epoch: 5, Steps: 12 | Train Loss: 2.715 Vali Loss: 2.681 Vali Acc: 0.144 Test Loss: 2.681 Test Acc: 0.144
Validation loss decreased (-0.111084 --> -0.144418).  Saving model ...
Epoch: 6 cost time: 0.9018001556396484
Epoch: 6, Steps: 12 | Train Loss: 2.661 Vali Loss: 2.632 Vali Acc: 0.167 Test Loss: 2.632 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166640).  Saving model ...
Epoch: 7 cost time: 0.9066498279571533
Epoch: 7, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.578 Vali Acc: 0.206 Test Loss: 2.578 Test Acc: 0.206
Validation loss decreased (-0.166640 --> -0.205530).  Saving model ...
Epoch: 8 cost time: 0.9657313823699951
Epoch: 8, Steps: 12 | Train Loss: 2.521 Vali Loss: 2.522 Vali Acc: 0.239 Test Loss: 2.522 Test Acc: 0.239
Validation loss decreased (-0.205530 --> -0.238864).  Saving model ...
Epoch: 9 cost time: 0.662329912185669
Epoch: 9, Steps: 12 | Train Loss: 2.434 Vali Loss: 2.465 Vali Acc: 0.289 Test Loss: 2.465 Test Acc: 0.289
Validation loss decreased (-0.238864 --> -0.288864).  Saving model ...
Epoch: 10 cost time: 0.621225118637085
Epoch: 10, Steps: 12 | Train Loss: 2.420 Vali Loss: 2.404 Vali Acc: 0.289 Test Loss: 2.404 Test Acc: 0.289
Validation loss decreased (-0.288864 --> -0.288865).  Saving model ...
Epoch: 11 cost time: 0.7346584796905518
Epoch: 11, Steps: 12 | Train Loss: 2.330 Vali Loss: 2.337 Vali Acc: 0.300 Test Loss: 2.337 Test Acc: 0.300
Validation loss decreased (-0.288865 --> -0.299977).  Saving model ...
Epoch: 12 cost time: 0.9741265773773193
Epoch: 12, Steps: 12 | Train Loss: 2.259 Vali Loss: 2.270 Vali Acc: 0.361 Test Loss: 2.270 Test Acc: 0.361
Validation loss decreased (-0.299977 --> -0.361088).  Saving model ...
Epoch: 13 cost time: 0.9072051048278809
Epoch: 13, Steps: 12 | Train Loss: 2.171 Vali Loss: 2.196 Vali Acc: 0.417 Test Loss: 2.196 Test Acc: 0.417
Validation loss decreased (-0.361088 --> -0.416645).  Saving model ...
Epoch: 14 cost time: 1.0497887134552002
Epoch: 14, Steps: 12 | Train Loss: 2.094 Vali Loss: 2.121 Vali Acc: 0.439 Test Loss: 2.121 Test Acc: 0.439
Validation loss decreased (-0.416645 --> -0.438868).  Saving model ...
Epoch: 15 cost time: 1.0135250091552734
Epoch: 15, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.044 Vali Acc: 0.461 Test Loss: 2.044 Test Acc: 0.461
Validation loss decreased (-0.438868 --> -0.461091).  Saving model ...
Epoch: 16 cost time: 0.6913809776306152
Epoch: 16, Steps: 12 | Train Loss: 1.924 Vali Loss: 1.964 Vali Acc: 0.494 Test Loss: 1.964 Test Acc: 0.494
Validation loss decreased (-0.461091 --> -0.494425).  Saving model ...
Epoch: 17 cost time: 1.04856276512146
Epoch: 17, Steps: 12 | Train Loss: 1.827 Vali Loss: 1.894 Vali Acc: 0.511 Test Loss: 1.894 Test Acc: 0.511
Validation loss decreased (-0.494425 --> -0.511092).  Saving model ...
Epoch: 18 cost time: 0.8017756938934326
Epoch: 18, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.818 Vali Acc: 0.506 Test Loss: 1.818 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8474276065826416
Epoch: 19, Steps: 12 | Train Loss: 1.655 Vali Loss: 1.754 Vali Acc: 0.556 Test Loss: 1.754 Test Acc: 0.556
Validation loss decreased (-0.511092 --> -0.555538).  Saving model ...
Epoch: 20 cost time: 0.8343088626861572
Epoch: 20, Steps: 12 | Train Loss: 1.554 Vali Loss: 1.696 Vali Acc: 0.561 Test Loss: 1.696 Test Acc: 0.561
Validation loss decreased (-0.555538 --> -0.561094).  Saving model ...
Epoch: 21 cost time: 1.1393849849700928
Epoch: 21, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.630 Vali Acc: 0.539 Test Loss: 1.630 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6873435974121094
Epoch: 22, Steps: 12 | Train Loss: 1.517 Vali Loss: 1.576 Vali Acc: 0.578 Test Loss: 1.576 Test Acc: 0.578
Validation loss decreased (-0.561094 --> -0.577762).  Saving model ...
Epoch: 23 cost time: 0.8787472248077393
Epoch: 23, Steps: 12 | Train Loss: 1.385 Vali Loss: 1.513 Vali Acc: 0.561 Test Loss: 1.513 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9082307815551758
Epoch: 24, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.430 Vali Acc: 0.583 Test Loss: 1.430 Test Acc: 0.583
Validation loss decreased (-0.577762 --> -0.583319).  Saving model ...
Epoch: 25 cost time: 0.761742115020752
Epoch: 25, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.358 Vali Acc: 0.589 Test Loss: 1.358 Test Acc: 0.589
Validation loss decreased (-0.583319 --> -0.588875).  Saving model ...
Epoch: 26 cost time: 0.73995041847229
Epoch: 26, Steps: 12 | Train Loss: 1.172 Vali Loss: 1.294 Vali Acc: 0.583 Test Loss: 1.294 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9631209373474121
Epoch: 27, Steps: 12 | Train Loss: 1.044 Vali Loss: 1.213 Vali Acc: 0.611 Test Loss: 1.213 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611099).  Saving model ...
Epoch: 28 cost time: 0.7949891090393066
Epoch: 28, Steps: 12 | Train Loss: 0.987 Vali Loss: 1.148 Vali Acc: 0.628 Test Loss: 1.148 Test Acc: 0.628
Validation loss decreased (-0.611099 --> -0.627766).  Saving model ...
Epoch: 29 cost time: 0.8019824028015137
Epoch: 29, Steps: 12 | Train Loss: 0.949 Vali Loss: 1.121 Vali Acc: 0.606 Test Loss: 1.121 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8891201019287109
Epoch: 30, Steps: 12 | Train Loss: 0.953 Vali Loss: 1.088 Vali Acc: 0.611 Test Loss: 1.088 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.655534029006958
Epoch: 31, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.042 Vali Acc: 0.600 Test Loss: 1.042 Test Acc: 0.600
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6641182899475098
Epoch: 32, Steps: 12 | Train Loss: 0.832 Vali Loss: 1.013 Vali Acc: 0.617 Test Loss: 1.013 Test Acc: 0.617
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9371347427368164
Epoch: 33, Steps: 12 | Train Loss: 0.823 Vali Loss: 0.992 Vali Acc: 0.656 Test Loss: 0.992 Test Acc: 0.656
Validation loss decreased (-0.627766 --> -0.655546).  Saving model ...
Epoch: 34 cost time: 0.646411657333374
Epoch: 34, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.977 Vali Acc: 0.650 Test Loss: 0.977 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9053831100463867
Epoch: 35, Steps: 12 | Train Loss: 0.740 Vali Loss: 0.958 Vali Acc: 0.633 Test Loss: 0.958 Test Acc: 0.633
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.935387372970581
Epoch: 36, Steps: 12 | Train Loss: 0.725 Vali Loss: 0.954 Vali Acc: 0.650 Test Loss: 0.954 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9804954528808594
Epoch: 37, Steps: 12 | Train Loss: 0.724 Vali Loss: 0.932 Vali Acc: 0.678 Test Loss: 0.932 Test Acc: 0.678
Validation loss decreased (-0.655546 --> -0.677768).  Saving model ...
Epoch: 38 cost time: 0.7433657646179199
Epoch: 38, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.945 Vali Acc: 0.639 Test Loss: 0.945 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7890992164611816
Epoch: 39, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.899 Vali Acc: 0.683 Test Loss: 0.899 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 40 cost time: 0.7659125328063965
Epoch: 40, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.917 Vali Acc: 0.672 Test Loss: 0.917 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0391294956207275
Epoch: 41, Steps: 12 | Train Loss: 0.616 Vali Loss: 0.918 Vali Acc: 0.639 Test Loss: 0.918 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9012086391448975
Epoch: 42, Steps: 12 | Train Loss: 0.618 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
Validation loss decreased (-0.683324 --> -0.711102).  Saving model ...
Epoch: 43 cost time: 0.8346078395843506
Epoch: 43, Steps: 12 | Train Loss: 0.580 Vali Loss: 0.908 Vali Acc: 0.672 Test Loss: 0.908 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9795186519622803
Epoch: 44, Steps: 12 | Train Loss: 0.565 Vali Loss: 0.883 Vali Acc: 0.700 Test Loss: 0.883 Test Acc: 0.700
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9265449047088623
Epoch: 45, Steps: 12 | Train Loss: 0.558 Vali Loss: 0.902 Vali Acc: 0.683 Test Loss: 0.902 Test Acc: 0.683
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8437685966491699
Epoch: 46, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.895 Vali Acc: 0.717 Test Loss: 0.895 Test Acc: 0.717
Validation loss decreased (-0.711102 --> -0.716658).  Saving model ...
Epoch: 47 cost time: 0.8482480049133301
Epoch: 47, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.895 Vali Acc: 0.694 Test Loss: 0.895 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8075456619262695
Epoch: 48, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.889 Vali Acc: 0.672 Test Loss: 0.889 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6748795509338379
Epoch: 49, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.891 Vali Acc: 0.694 Test Loss: 0.891 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.8974347114562988
Epoch: 50, Steps: 12 | Train Loss: 0.487 Vali Loss: 0.921 Vali Acc: 0.683 Test Loss: 0.921 Test Acc: 0.683
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.1178927421569824
Epoch: 51, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.890 Vali Acc: 0.700 Test Loss: 0.890 Test Acc: 0.700
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9424002170562744
Epoch: 52, Steps: 12 | Train Loss: 0.461 Vali Loss: 0.917 Vali Acc: 0.689 Test Loss: 0.917 Test Acc: 0.689
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.726137638092041
Epoch: 53, Steps: 12 | Train Loss: 0.410 Vali Loss: 0.906 Vali Acc: 0.717 Test Loss: 0.906 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9125075340270996
Epoch: 54, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.920 Vali Acc: 0.700 Test Loss: 0.920 Test Acc: 0.700
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.8215823173522949
Epoch: 55, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.976 Vali Acc: 0.700 Test Loss: 0.976 Test Acc: 0.700
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.009728193283081
Epoch: 56, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.951 Vali Acc: 0.711 Test Loss: 0.951 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7166666666666667
model parameter : 5983
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4255738258361816
Epoch: 1, Steps: 12 | Train Loss: 2.804 Vali Loss: 2.844 Vali Acc: 0.050 Test Loss: 2.844 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.7511308193206787
Epoch: 2, Steps: 12 | Train Loss: 2.787 Vali Loss: 2.818 Vali Acc: 0.061 Test Loss: 2.818 Test Acc: 0.061
Validation loss decreased (-0.049972 --> -0.061083).  Saving model ...
Epoch: 3 cost time: 0.8416593074798584
Epoch: 3, Steps: 12 | Train Loss: 2.735 Vali Loss: 2.783 Vali Acc: 0.083 Test Loss: 2.783 Test Acc: 0.083
Validation loss decreased (-0.061083 --> -0.083306).  Saving model ...
Epoch: 4 cost time: 0.681082010269165
Epoch: 4, Steps: 12 | Train Loss: 2.717 Vali Loss: 2.744 Vali Acc: 0.100 Test Loss: 2.744 Test Acc: 0.100
Validation loss decreased (-0.083306 --> -0.099973).  Saving model ...
Epoch: 5 cost time: 0.6810476779937744
Epoch: 5, Steps: 12 | Train Loss: 2.655 Vali Loss: 2.695 Vali Acc: 0.156 Test Loss: 2.695 Test Acc: 0.156
Validation loss decreased (-0.099973 --> -0.155529).  Saving model ...
Epoch: 6 cost time: 0.6082849502563477
Epoch: 6, Steps: 12 | Train Loss: 2.619 Vali Loss: 2.647 Vali Acc: 0.172 Test Loss: 2.647 Test Acc: 0.172
Validation loss decreased (-0.155529 --> -0.172196).  Saving model ...
Epoch: 7 cost time: 0.816300630569458
Epoch: 7, Steps: 12 | Train Loss: 2.539 Vali Loss: 2.597 Vali Acc: 0.206 Test Loss: 2.597 Test Acc: 0.206
Validation loss decreased (-0.172196 --> -0.205530).  Saving model ...
Epoch: 8 cost time: 0.6701910495758057
Epoch: 8, Steps: 12 | Train Loss: 2.505 Vali Loss: 2.546 Vali Acc: 0.228 Test Loss: 2.546 Test Acc: 0.228
Validation loss decreased (-0.205530 --> -0.227752).  Saving model ...
Epoch: 9 cost time: 0.7644519805908203
Epoch: 9, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.495 Vali Acc: 0.250 Test Loss: 2.495 Test Acc: 0.250
Validation loss decreased (-0.227752 --> -0.249975).  Saving model ...
Epoch: 10 cost time: 0.7445127964019775
Epoch: 10, Steps: 12 | Train Loss: 2.358 Vali Loss: 2.437 Vali Acc: 0.267 Test Loss: 2.437 Test Acc: 0.267
Validation loss decreased (-0.249975 --> -0.266642).  Saving model ...
Epoch: 11 cost time: 0.7114109992980957
Epoch: 11, Steps: 12 | Train Loss: 2.317 Vali Loss: 2.383 Vali Acc: 0.300 Test Loss: 2.383 Test Acc: 0.300
Validation loss decreased (-0.266642 --> -0.299976).  Saving model ...
Epoch: 12 cost time: 0.7881302833557129
Epoch: 12, Steps: 12 | Train Loss: 2.215 Vali Loss: 2.325 Vali Acc: 0.306 Test Loss: 2.325 Test Acc: 0.306
Validation loss decreased (-0.299976 --> -0.305532).  Saving model ...
Epoch: 13 cost time: 0.7296063899993896
Epoch: 13, Steps: 12 | Train Loss: 2.191 Vali Loss: 2.259 Vali Acc: 0.333 Test Loss: 2.259 Test Acc: 0.333
Validation loss decreased (-0.305532 --> -0.333311).  Saving model ...
Epoch: 14 cost time: 0.7311320304870605
Epoch: 14, Steps: 12 | Train Loss: 2.102 Vali Loss: 2.203 Vali Acc: 0.356 Test Loss: 2.203 Test Acc: 0.356
Validation loss decreased (-0.333311 --> -0.355534).  Saving model ...
Epoch: 15 cost time: 0.6957626342773438
Epoch: 15, Steps: 12 | Train Loss: 2.008 Vali Loss: 2.148 Vali Acc: 0.361 Test Loss: 2.148 Test Acc: 0.361
Validation loss decreased (-0.355534 --> -0.361090).  Saving model ...
Epoch: 16 cost time: 0.7061505317687988
Epoch: 16, Steps: 12 | Train Loss: 1.992 Vali Loss: 2.095 Vali Acc: 0.367 Test Loss: 2.095 Test Acc: 0.367
Validation loss decreased (-0.361090 --> -0.366646).  Saving model ...
Epoch: 17 cost time: 0.684551477432251
Epoch: 17, Steps: 12 | Train Loss: 1.923 Vali Loss: 2.038 Vali Acc: 0.383 Test Loss: 2.038 Test Acc: 0.383
Validation loss decreased (-0.366646 --> -0.383313).  Saving model ...
Epoch: 18 cost time: 0.6820402145385742
Epoch: 18, Steps: 12 | Train Loss: 1.831 Vali Loss: 1.982 Vali Acc: 0.433 Test Loss: 1.982 Test Acc: 0.433
Validation loss decreased (-0.383313 --> -0.433314).  Saving model ...
Epoch: 19 cost time: 0.673961877822876
Epoch: 19, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.930 Vali Acc: 0.467 Test Loss: 1.930 Test Acc: 0.467
Validation loss decreased (-0.433314 --> -0.466647).  Saving model ...
Epoch: 20 cost time: 0.6428966522216797
Epoch: 20, Steps: 12 | Train Loss: 1.695 Vali Loss: 1.876 Vali Acc: 0.478 Test Loss: 1.876 Test Acc: 0.478
Validation loss decreased (-0.466647 --> -0.477759).  Saving model ...
Epoch: 21 cost time: 0.7450070381164551
Epoch: 21, Steps: 12 | Train Loss: 1.666 Vali Loss: 1.824 Vali Acc: 0.494 Test Loss: 1.824 Test Acc: 0.494
Validation loss decreased (-0.477759 --> -0.494426).  Saving model ...
Epoch: 22 cost time: 0.6177163124084473
Epoch: 22, Steps: 12 | Train Loss: 1.611 Vali Loss: 1.775 Vali Acc: 0.483 Test Loss: 1.775 Test Acc: 0.483
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9494419097900391
Epoch: 23, Steps: 12 | Train Loss: 1.522 Vali Loss: 1.735 Vali Acc: 0.494 Test Loss: 1.735 Test Acc: 0.494
Validation loss decreased (-0.494426 --> -0.494427).  Saving model ...
Epoch: 24 cost time: 0.7139608860015869
Epoch: 24, Steps: 12 | Train Loss: 1.424 Vali Loss: 1.701 Vali Acc: 0.528 Test Loss: 1.701 Test Acc: 0.528
Validation loss decreased (-0.494427 --> -0.527761).  Saving model ...
Epoch: 25 cost time: 0.6394615173339844
Epoch: 25, Steps: 12 | Train Loss: 1.494 Vali Loss: 1.660 Vali Acc: 0.522 Test Loss: 1.660 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7513906955718994
Epoch: 26, Steps: 12 | Train Loss: 1.380 Vali Loss: 1.603 Vali Acc: 0.539 Test Loss: 1.603 Test Acc: 0.539
Validation loss decreased (-0.527761 --> -0.538873).  Saving model ...
Epoch: 27 cost time: 0.7070178985595703
Epoch: 27, Steps: 12 | Train Loss: 1.315 Vali Loss: 1.563 Vali Acc: 0.550 Test Loss: 1.563 Test Acc: 0.550
Validation loss decreased (-0.538873 --> -0.549984).  Saving model ...
Epoch: 28 cost time: 0.6518306732177734
Epoch: 28, Steps: 12 | Train Loss: 1.291 Vali Loss: 1.517 Vali Acc: 0.561 Test Loss: 1.517 Test Acc: 0.561
Validation loss decreased (-0.549984 --> -0.561096).  Saving model ...
Epoch: 29 cost time: 0.7473099231719971
Epoch: 29, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.473 Vali Acc: 0.578 Test Loss: 1.473 Test Acc: 0.578
Validation loss decreased (-0.561096 --> -0.577763).  Saving model ...
Epoch: 30 cost time: 0.6459927558898926
Epoch: 30, Steps: 12 | Train Loss: 1.214 Vali Loss: 1.441 Vali Acc: 0.600 Test Loss: 1.441 Test Acc: 0.600
Validation loss decreased (-0.577763 --> -0.599986).  Saving model ...
Epoch: 31 cost time: 0.6708722114562988
Epoch: 31, Steps: 12 | Train Loss: 1.104 Vali Loss: 1.392 Vali Acc: 0.589 Test Loss: 1.392 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7126851081848145
Epoch: 32, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.357 Vali Acc: 0.594 Test Loss: 1.357 Test Acc: 0.594
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6270034313201904
Epoch: 33, Steps: 12 | Train Loss: 1.021 Vali Loss: 1.295 Vali Acc: 0.617 Test Loss: 1.295 Test Acc: 0.617
Validation loss decreased (-0.599986 --> -0.616654).  Saving model ...
Epoch: 34 cost time: 0.7600202560424805
Epoch: 34, Steps: 12 | Train Loss: 0.982 Vali Loss: 1.252 Vali Acc: 0.628 Test Loss: 1.252 Test Acc: 0.628
Validation loss decreased (-0.616654 --> -0.627765).  Saving model ...
Epoch: 35 cost time: 0.7842779159545898
Epoch: 35, Steps: 12 | Train Loss: 0.924 Vali Loss: 1.197 Vali Acc: 0.639 Test Loss: 1.197 Test Acc: 0.639
Validation loss decreased (-0.627765 --> -0.638877).  Saving model ...
Epoch: 36 cost time: 0.7257888317108154
Epoch: 36, Steps: 12 | Train Loss: 0.947 Vali Loss: 1.168 Vali Acc: 0.611 Test Loss: 1.168 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7468500137329102
Epoch: 37, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.119 Vali Acc: 0.639 Test Loss: 1.119 Test Acc: 0.639
Validation loss decreased (-0.638877 --> -0.638878).  Saving model ...
Epoch: 38 cost time: 0.7907307147979736
Epoch: 38, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.098 Vali Acc: 0.644 Test Loss: 1.098 Test Acc: 0.644
Validation loss decreased (-0.638878 --> -0.644433).  Saving model ...
Epoch: 39 cost time: 0.8091433048248291
Epoch: 39, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.028 Vali Acc: 0.656 Test Loss: 1.028 Test Acc: 0.656
Validation loss decreased (-0.644433 --> -0.655545).  Saving model ...
Epoch: 40 cost time: 0.7201249599456787
Epoch: 40, Steps: 12 | Train Loss: 0.722 Vali Loss: 0.994 Vali Acc: 0.667 Test Loss: 0.994 Test Acc: 0.667
Validation loss decreased (-0.655545 --> -0.666657).  Saving model ...
Epoch: 41 cost time: 0.6260433197021484
Epoch: 41, Steps: 12 | Train Loss: 0.695 Vali Loss: 0.966 Vali Acc: 0.661 Test Loss: 0.966 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.684628963470459
Epoch: 42, Steps: 12 | Train Loss: 0.617 Vali Loss: 0.937 Vali Acc: 0.689 Test Loss: 0.937 Test Acc: 0.689
Validation loss decreased (-0.666657 --> -0.688880).  Saving model ...
Epoch: 43 cost time: 0.7817647457122803
Epoch: 43, Steps: 12 | Train Loss: 0.610 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
Validation loss decreased (-0.688880 --> -0.716658).  Saving model ...
Epoch: 44 cost time: 0.8036243915557861
Epoch: 44, Steps: 12 | Train Loss: 0.584 Vali Loss: 0.906 Vali Acc: 0.711 Test Loss: 0.906 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7370965480804443
Epoch: 45, Steps: 12 | Train Loss: 0.556 Vali Loss: 0.851 Vali Acc: 0.744 Test Loss: 0.851 Test Acc: 0.744
Validation loss decreased (-0.716658 --> -0.744436).  Saving model ...
Epoch: 46 cost time: 0.872072696685791
Epoch: 46, Steps: 12 | Train Loss: 0.499 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755547).  Saving model ...
Epoch: 47 cost time: 0.6789669990539551
Epoch: 47, Steps: 12 | Train Loss: 0.496 Vali Loss: 0.844 Vali Acc: 0.756 Test Loss: 0.844 Test Acc: 0.756
Validation loss decreased (-0.755547 --> -0.755547).  Saving model ...
Epoch: 48 cost time: 0.6889736652374268
Epoch: 48, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.815 Vali Acc: 0.772 Test Loss: 0.815 Test Acc: 0.772
Validation loss decreased (-0.755547 --> -0.772214).  Saving model ...
Epoch: 49 cost time: 0.856086015701294
Epoch: 49, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.810 Vali Acc: 0.761 Test Loss: 0.810 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7101171016693115
Epoch: 50, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.825 Vali Acc: 0.750 Test Loss: 0.825 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7388968467712402
Epoch: 51, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.778 Vali Acc: 0.778 Test Loss: 0.778 Test Acc: 0.778
Validation loss decreased (-0.772214 --> -0.777770).  Saving model ...
Epoch: 52 cost time: 0.8430056571960449
Epoch: 52, Steps: 12 | Train Loss: 0.384 Vali Loss: 0.787 Vali Acc: 0.772 Test Loss: 0.787 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.725583553314209
Epoch: 53, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
Validation loss decreased (-0.777770 --> -0.783326).  Saving model ...
Epoch: 54 cost time: 0.746107816696167
Epoch: 54, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.791 Vali Acc: 0.761 Test Loss: 0.791 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7032930850982666
Epoch: 55, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.757 Vali Acc: 0.778 Test Loss: 0.757 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6095371246337891
Epoch: 56, Steps: 12 | Train Loss: 0.308 Vali Loss: 0.779 Vali Acc: 0.783 Test Loss: 0.779 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7624328136444092
Epoch: 57, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.766 Vali Acc: 0.783 Test Loss: 0.766 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 58 cost time: 0.8124821186065674
Epoch: 58, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.774 Vali Acc: 0.772 Test Loss: 0.774 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8943357467651367
Epoch: 59, Steps: 12 | Train Loss: 0.301 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 60 cost time: 0.7003355026245117
Epoch: 60, Steps: 12 | Train Loss: 0.269 Vali Loss: 0.745 Vali Acc: 0.783 Test Loss: 0.745 Test Acc: 0.783
Validation loss decreased (-0.783326 --> -0.783326).  Saving model ...
Epoch: 61 cost time: 0.6847188472747803
Epoch: 61, Steps: 12 | Train Loss: 0.257 Vali Loss: 0.788 Vali Acc: 0.778 Test Loss: 0.788 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8734357357025146
Epoch: 62, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.771 Vali Acc: 0.778 Test Loss: 0.771 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9902386665344238
Epoch: 63, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.739 Vali Acc: 0.778 Test Loss: 0.739 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.7239837646484375
Epoch: 64, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788881).  Saving model ...
Epoch: 65 cost time: 0.7303078174591064
Epoch: 65, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.776 Vali Acc: 0.767 Test Loss: 0.776 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.828948974609375
Epoch: 66, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.778 Vali Acc: 0.783 Test Loss: 0.778 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7882308959960938
Epoch: 67, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.754 Vali Acc: 0.783 Test Loss: 0.754 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8477706909179688
Epoch: 68, Steps: 12 | Train Loss: 0.211 Vali Loss: 0.787 Vali Acc: 0.778 Test Loss: 0.787 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.69586181640625
Epoch: 69, Steps: 12 | Train Loss: 0.191 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7547402381896973
Epoch: 70, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.793 Vali Acc: 0.783 Test Loss: 0.793 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.7166500091552734
Epoch: 71, Steps: 12 | Train Loss: 0.201 Vali Loss: 0.828 Vali Acc: 0.783 Test Loss: 0.828 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.7793235778808594
Epoch: 72, Steps: 12 | Train Loss: 0.194 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.6899323463439941
Epoch: 73, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.784 Vali Acc: 0.778 Test Loss: 0.784 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.709714412689209
Epoch: 74, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.810 Vali Acc: 0.778 Test Loss: 0.810 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 6026
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0590097904205322
Epoch: 1, Steps: 12 | Train Loss: 2.857 Vali Loss: 2.835 Vali Acc: 0.089 Test Loss: 2.835 Test Acc: 0.089
Validation loss decreased (inf --> -0.088861).  Saving model ...
Epoch: 2 cost time: 0.6699187755584717
Epoch: 2, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.806 Vali Acc: 0.100 Test Loss: 2.806 Test Acc: 0.100
Validation loss decreased (-0.088861 --> -0.099972).  Saving model ...
Epoch: 3 cost time: 0.5669660568237305
Epoch: 3, Steps: 12 | Train Loss: 2.766 Vali Loss: 2.770 Vali Acc: 0.122 Test Loss: 2.770 Test Acc: 0.122
Validation loss decreased (-0.099972 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.6821751594543457
Epoch: 4, Steps: 12 | Train Loss: 2.743 Vali Loss: 2.730 Vali Acc: 0.128 Test Loss: 2.730 Test Acc: 0.128
Validation loss decreased (-0.122195 --> -0.127750).  Saving model ...
Epoch: 5 cost time: 0.6116948127746582
Epoch: 5, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.686 Vali Acc: 0.139 Test Loss: 2.686 Test Acc: 0.139
Validation loss decreased (-0.127750 --> -0.138862).  Saving model ...
Epoch: 6 cost time: 0.7197656631469727
Epoch: 6, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.637 Vali Acc: 0.172 Test Loss: 2.637 Test Acc: 0.172
Validation loss decreased (-0.138862 --> -0.172196).  Saving model ...
Epoch: 7 cost time: 0.702336311340332
Epoch: 7, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.583 Vali Acc: 0.206 Test Loss: 2.583 Test Acc: 0.206
Validation loss decreased (-0.172196 --> -0.205530).  Saving model ...
Epoch: 8 cost time: 0.5984475612640381
Epoch: 8, Steps: 12 | Train Loss: 2.528 Vali Loss: 2.529 Vali Acc: 0.233 Test Loss: 2.529 Test Acc: 0.233
Validation loss decreased (-0.205530 --> -0.233308).  Saving model ...
Epoch: 9 cost time: 0.5982232093811035
Epoch: 9, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.474 Vali Acc: 0.283 Test Loss: 2.474 Test Acc: 0.283
Validation loss decreased (-0.233308 --> -0.283309).  Saving model ...
Epoch: 10 cost time: 0.6335887908935547
Epoch: 10, Steps: 12 | Train Loss: 2.430 Vali Loss: 2.416 Vali Acc: 0.311 Test Loss: 2.416 Test Acc: 0.311
Validation loss decreased (-0.283309 --> -0.311087).  Saving model ...
Epoch: 11 cost time: 0.6557142734527588
Epoch: 11, Steps: 12 | Train Loss: 2.348 Vali Loss: 2.354 Vali Acc: 0.328 Test Loss: 2.354 Test Acc: 0.328
Validation loss decreased (-0.311087 --> -0.327754).  Saving model ...
Epoch: 12 cost time: 0.7697641849517822
Epoch: 12, Steps: 12 | Train Loss: 2.284 Vali Loss: 2.293 Vali Acc: 0.356 Test Loss: 2.293 Test Acc: 0.356
Validation loss decreased (-0.327754 --> -0.355533).  Saving model ...
Epoch: 13 cost time: 0.8278336524963379
Epoch: 13, Steps: 12 | Train Loss: 2.205 Vali Loss: 2.227 Vali Acc: 0.406 Test Loss: 2.227 Test Acc: 0.406
Validation loss decreased (-0.355533 --> -0.405533).  Saving model ...
Epoch: 14 cost time: 0.5813572406768799
Epoch: 14, Steps: 12 | Train Loss: 2.139 Vali Loss: 2.162 Vali Acc: 0.450 Test Loss: 2.162 Test Acc: 0.450
Validation loss decreased (-0.405533 --> -0.449978).  Saving model ...
Epoch: 15 cost time: 0.7046384811401367
Epoch: 15, Steps: 12 | Train Loss: 2.069 Vali Loss: 2.096 Vali Acc: 0.467 Test Loss: 2.096 Test Acc: 0.467
Validation loss decreased (-0.449978 --> -0.466646).  Saving model ...
Epoch: 16 cost time: 0.7353208065032959
Epoch: 16, Steps: 12 | Train Loss: 1.993 Vali Loss: 2.028 Vali Acc: 0.489 Test Loss: 2.028 Test Acc: 0.489
Validation loss decreased (-0.466646 --> -0.488869).  Saving model ...
Epoch: 17 cost time: 0.6139349937438965
Epoch: 17, Steps: 12 | Train Loss: 1.906 Vali Loss: 1.964 Vali Acc: 0.533 Test Loss: 1.964 Test Acc: 0.533
Validation loss decreased (-0.488869 --> -0.533314).  Saving model ...
Epoch: 18 cost time: 0.9520964622497559
Epoch: 18, Steps: 12 | Train Loss: 1.864 Vali Loss: 1.897 Vali Acc: 0.533 Test Loss: 1.897 Test Acc: 0.533
Validation loss decreased (-0.533314 --> -0.533314).  Saving model ...
Epoch: 19 cost time: 0.8881237506866455
Epoch: 19, Steps: 12 | Train Loss: 1.744 Vali Loss: 1.838 Vali Acc: 0.567 Test Loss: 1.838 Test Acc: 0.567
Validation loss decreased (-0.533314 --> -0.566648).  Saving model ...
Epoch: 20 cost time: 0.7141578197479248
Epoch: 20, Steps: 12 | Train Loss: 1.645 Vali Loss: 1.785 Vali Acc: 0.539 Test Loss: 1.785 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8229279518127441
Epoch: 21, Steps: 12 | Train Loss: 1.584 Vali Loss: 1.729 Vali Acc: 0.533 Test Loss: 1.729 Test Acc: 0.533
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7313320636749268
Epoch: 22, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.687 Vali Acc: 0.550 Test Loss: 1.687 Test Acc: 0.550
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6837954521179199
Epoch: 23, Steps: 12 | Train Loss: 1.456 Vali Loss: 1.643 Vali Acc: 0.556 Test Loss: 1.643 Test Acc: 0.556
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.875971794128418
Epoch: 24, Steps: 12 | Train Loss: 1.440 Vali Loss: 1.593 Vali Acc: 0.556 Test Loss: 1.593 Test Acc: 0.556
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8500566482543945
Epoch: 25, Steps: 12 | Train Loss: 1.384 Vali Loss: 1.549 Vali Acc: 0.544 Test Loss: 1.549 Test Acc: 0.544
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6893284320831299
Epoch: 26, Steps: 12 | Train Loss: 1.329 Vali Loss: 1.500 Vali Acc: 0.583 Test Loss: 1.500 Test Acc: 0.583
Validation loss decreased (-0.566648 --> -0.583318).  Saving model ...
Epoch: 27 cost time: 0.6844487190246582
Epoch: 27, Steps: 12 | Train Loss: 1.228 Vali Loss: 1.456 Vali Acc: 0.578 Test Loss: 1.456 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.738048791885376
Epoch: 28, Steps: 12 | Train Loss: 1.161 Vali Loss: 1.413 Vali Acc: 0.572 Test Loss: 1.413 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7049198150634766
Epoch: 29, Steps: 12 | Train Loss: 1.110 Vali Loss: 1.384 Vali Acc: 0.583 Test Loss: 1.384 Test Acc: 0.583
Validation loss decreased (-0.583318 --> -0.583319).  Saving model ...
Epoch: 30 cost time: 0.7350733280181885
Epoch: 30, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.343 Vali Acc: 0.600 Test Loss: 1.343 Test Acc: 0.600
Validation loss decreased (-0.583319 --> -0.599987).  Saving model ...
Epoch: 31 cost time: 0.6365504264831543
Epoch: 31, Steps: 12 | Train Loss: 1.067 Vali Loss: 1.298 Vali Acc: 0.617 Test Loss: 1.298 Test Acc: 0.617
Validation loss decreased (-0.599987 --> -0.616654).  Saving model ...
Epoch: 32 cost time: 0.6957581043243408
Epoch: 32, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.258 Vali Acc: 0.617 Test Loss: 1.258 Test Acc: 0.617
Validation loss decreased (-0.616654 --> -0.616654).  Saving model ...
Epoch: 33 cost time: 0.7353670597076416
Epoch: 33, Steps: 12 | Train Loss: 0.955 Vali Loss: 1.221 Vali Acc: 0.611 Test Loss: 1.221 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9943766593933105
Epoch: 34, Steps: 12 | Train Loss: 0.873 Vali Loss: 1.183 Vali Acc: 0.633 Test Loss: 1.183 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633322).  Saving model ...
Epoch: 35 cost time: 0.7521166801452637
Epoch: 35, Steps: 12 | Train Loss: 0.838 Vali Loss: 1.154 Vali Acc: 0.633 Test Loss: 1.154 Test Acc: 0.633
Validation loss decreased (-0.633322 --> -0.633322).  Saving model ...
Epoch: 36 cost time: 0.7215747833251953
Epoch: 36, Steps: 12 | Train Loss: 0.774 Vali Loss: 1.115 Vali Acc: 0.639 Test Loss: 1.115 Test Acc: 0.639
Validation loss decreased (-0.633322 --> -0.638878).  Saving model ...
Epoch: 37 cost time: 0.6598892211914062
Epoch: 37, Steps: 12 | Train Loss: 0.757 Vali Loss: 1.063 Vali Acc: 0.650 Test Loss: 1.063 Test Acc: 0.650
Validation loss decreased (-0.638878 --> -0.649989).  Saving model ...
Epoch: 38 cost time: 0.6563105583190918
Epoch: 38, Steps: 12 | Train Loss: 0.711 Vali Loss: 1.022 Vali Acc: 0.661 Test Loss: 1.022 Test Acc: 0.661
Validation loss decreased (-0.649989 --> -0.661101).  Saving model ...
Epoch: 39 cost time: 0.712761640548706
Epoch: 39, Steps: 12 | Train Loss: 0.691 Vali Loss: 0.983 Vali Acc: 0.656 Test Loss: 0.983 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6321563720703125
Epoch: 40, Steps: 12 | Train Loss: 0.625 Vali Loss: 0.950 Vali Acc: 0.656 Test Loss: 0.950 Test Acc: 0.656
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6994686126708984
Epoch: 41, Steps: 12 | Train Loss: 0.564 Vali Loss: 0.930 Vali Acc: 0.683 Test Loss: 0.930 Test Acc: 0.683
Validation loss decreased (-0.661101 --> -0.683324).  Saving model ...
Epoch: 42 cost time: 0.9091672897338867
Epoch: 42, Steps: 12 | Train Loss: 0.543 Vali Loss: 0.896 Vali Acc: 0.694 Test Loss: 0.896 Test Acc: 0.694
Validation loss decreased (-0.683324 --> -0.694435).  Saving model ...
Epoch: 43 cost time: 0.7101073265075684
Epoch: 43, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.858 Vali Acc: 0.694 Test Loss: 0.858 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694436).  Saving model ...
Epoch: 44 cost time: 0.6017463207244873
Epoch: 44, Steps: 12 | Train Loss: 0.473 Vali Loss: 0.840 Vali Acc: 0.711 Test Loss: 0.840 Test Acc: 0.711
Validation loss decreased (-0.694436 --> -0.711103).  Saving model ...
Epoch: 45 cost time: 0.6628720760345459
Epoch: 45, Steps: 12 | Train Loss: 0.438 Vali Loss: 0.835 Vali Acc: 0.728 Test Loss: 0.835 Test Acc: 0.728
Validation loss decreased (-0.711103 --> -0.727769).  Saving model ...
Epoch: 46 cost time: 0.7388765811920166
Epoch: 46, Steps: 12 | Train Loss: 0.411 Vali Loss: 0.806 Vali Acc: 0.728 Test Loss: 0.806 Test Acc: 0.728
Validation loss decreased (-0.727769 --> -0.727770).  Saving model ...
Epoch: 47 cost time: 0.8080258369445801
Epoch: 47, Steps: 12 | Train Loss: 0.400 Vali Loss: 0.788 Vali Acc: 0.722 Test Loss: 0.788 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8277575969696045
Epoch: 48, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.773 Vali Acc: 0.750 Test Loss: 0.773 Test Acc: 0.750
Validation loss decreased (-0.727770 --> -0.749992).  Saving model ...
Epoch: 49 cost time: 0.6008670330047607
Epoch: 49, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.773 Vali Acc: 0.756 Test Loss: 0.773 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 50 cost time: 0.6400249004364014
Epoch: 50, Steps: 12 | Train Loss: 0.364 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7462539672851562
Epoch: 51, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.754 Vali Acc: 0.761 Test Loss: 0.754 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 52 cost time: 0.7242414951324463
Epoch: 52, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.726 Vali Acc: 0.767 Test Loss: 0.726 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 53 cost time: 0.7951335906982422
Epoch: 53, Steps: 12 | Train Loss: 0.316 Vali Loss: 0.731 Vali Acc: 0.772 Test Loss: 0.731 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 54 cost time: 0.848360538482666
Epoch: 54, Steps: 12 | Train Loss: 0.304 Vali Loss: 0.736 Vali Acc: 0.756 Test Loss: 0.736 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7324168682098389
Epoch: 55, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8799715042114258
Epoch: 56, Steps: 12 | Train Loss: 0.315 Vali Loss: 0.713 Vali Acc: 0.739 Test Loss: 0.713 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.8212072849273682
Epoch: 57, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.717 Vali Acc: 0.761 Test Loss: 0.717 Test Acc: 0.761
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.0012211799621582
Epoch: 58, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.715 Vali Acc: 0.750 Test Loss: 0.715 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9947996139526367
Epoch: 59, Steps: 12 | Train Loss: 0.266 Vali Loss: 0.721 Vali Acc: 0.739 Test Loss: 0.721 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.8632030487060547
Epoch: 60, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.713 Vali Acc: 0.756 Test Loss: 0.713 Test Acc: 0.756
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9035036563873291
Epoch: 61, Steps: 12 | Train Loss: 0.271 Vali Loss: 0.721 Vali Acc: 0.744 Test Loss: 0.721 Test Acc: 0.744
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.7412927150726318
Epoch: 62, Steps: 12 | Train Loss: 0.218 Vali Loss: 0.732 Vali Acc: 0.739 Test Loss: 0.732 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.6629612445831299
Epoch: 63, Steps: 12 | Train Loss: 0.221 Vali Loss: 0.720 Vali Acc: 0.750 Test Loss: 0.720 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7722222222222223
model parameter : 5983
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3625009059906006
Epoch: 1, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.735 Vali Acc: 0.094 Test Loss: 2.735 Test Acc: 0.094
Validation loss decreased (inf --> -0.094417).  Saving model ...
Epoch: 2 cost time: 0.8326208591461182
Epoch: 2, Steps: 12 | Train Loss: 2.746 Vali Loss: 2.708 Vali Acc: 0.106 Test Loss: 2.708 Test Acc: 0.106
Validation loss decreased (-0.094417 --> -0.105528).  Saving model ...
Epoch: 3 cost time: 0.6639423370361328
Epoch: 3, Steps: 12 | Train Loss: 2.682 Vali Loss: 2.672 Vali Acc: 0.117 Test Loss: 2.672 Test Acc: 0.117
Validation loss decreased (-0.105528 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 0.6095964908599854
Epoch: 4, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.631 Vali Acc: 0.122 Test Loss: 2.631 Test Acc: 0.122
Validation loss decreased (-0.116640 --> -0.122196).  Saving model ...
Epoch: 5 cost time: 0.9090838432312012
Epoch: 5, Steps: 12 | Train Loss: 2.606 Vali Loss: 2.586 Vali Acc: 0.133 Test Loss: 2.586 Test Acc: 0.133
Validation loss decreased (-0.122196 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 0.715456485748291
Epoch: 6, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.539 Vali Acc: 0.167 Test Loss: 2.539 Test Acc: 0.167
Validation loss decreased (-0.133307 --> -0.166641).  Saving model ...
Epoch: 7 cost time: 0.7274203300476074
Epoch: 7, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.489 Vali Acc: 0.194 Test Loss: 2.489 Test Acc: 0.194
Validation loss decreased (-0.166641 --> -0.194420).  Saving model ...
Epoch: 8 cost time: 0.8718016147613525
Epoch: 8, Steps: 12 | Train Loss: 2.445 Vali Loss: 2.439 Vali Acc: 0.272 Test Loss: 2.439 Test Acc: 0.272
Validation loss decreased (-0.194420 --> -0.272198).  Saving model ...
Epoch: 9 cost time: 0.6448180675506592
Epoch: 9, Steps: 12 | Train Loss: 2.369 Vali Loss: 2.385 Vali Acc: 0.322 Test Loss: 2.385 Test Acc: 0.322
Validation loss decreased (-0.272198 --> -0.322198).  Saving model ...
Epoch: 10 cost time: 0.676124095916748
Epoch: 10, Steps: 12 | Train Loss: 2.300 Vali Loss: 2.324 Vali Acc: 0.367 Test Loss: 2.324 Test Acc: 0.367
Validation loss decreased (-0.322198 --> -0.366643).  Saving model ...
Epoch: 11 cost time: 0.6662733554840088
Epoch: 11, Steps: 12 | Train Loss: 2.240 Vali Loss: 2.266 Vali Acc: 0.394 Test Loss: 2.266 Test Acc: 0.394
Validation loss decreased (-0.366643 --> -0.394422).  Saving model ...
Epoch: 12 cost time: 0.66288161277771
Epoch: 12, Steps: 12 | Train Loss: 2.180 Vali Loss: 2.208 Vali Acc: 0.422 Test Loss: 2.208 Test Acc: 0.422
Validation loss decreased (-0.394422 --> -0.422200).  Saving model ...
Epoch: 13 cost time: 0.6863036155700684
Epoch: 13, Steps: 12 | Train Loss: 2.097 Vali Loss: 2.149 Vali Acc: 0.439 Test Loss: 2.149 Test Acc: 0.439
Validation loss decreased (-0.422200 --> -0.438867).  Saving model ...
Epoch: 14 cost time: 0.610598087310791
Epoch: 14, Steps: 12 | Train Loss: 2.033 Vali Loss: 2.088 Vali Acc: 0.456 Test Loss: 2.088 Test Acc: 0.456
Validation loss decreased (-0.438867 --> -0.455535).  Saving model ...
Epoch: 15 cost time: 0.687246561050415
Epoch: 15, Steps: 12 | Train Loss: 1.969 Vali Loss: 2.024 Vali Acc: 0.478 Test Loss: 2.024 Test Acc: 0.478
Validation loss decreased (-0.455535 --> -0.477758).  Saving model ...
Epoch: 16 cost time: 0.7358808517456055
Epoch: 16, Steps: 12 | Train Loss: 1.868 Vali Loss: 1.960 Vali Acc: 0.500 Test Loss: 1.960 Test Acc: 0.500
Validation loss decreased (-0.477758 --> -0.499980).  Saving model ...
Epoch: 17 cost time: 0.7281608581542969
Epoch: 17, Steps: 12 | Train Loss: 1.830 Vali Loss: 1.897 Vali Acc: 0.506 Test Loss: 1.897 Test Acc: 0.506
Validation loss decreased (-0.499980 --> -0.505537).  Saving model ...
Epoch: 18 cost time: 0.6266651153564453
Epoch: 18, Steps: 12 | Train Loss: 1.780 Vali Loss: 1.839 Vali Acc: 0.522 Test Loss: 1.839 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522204).  Saving model ...
Epoch: 19 cost time: 0.7488596439361572
Epoch: 19, Steps: 12 | Train Loss: 1.688 Vali Loss: 1.775 Vali Acc: 0.528 Test Loss: 1.775 Test Acc: 0.528
Validation loss decreased (-0.522204 --> -0.527760).  Saving model ...
Epoch: 20 cost time: 0.7736563682556152
Epoch: 20, Steps: 12 | Train Loss: 1.648 Vali Loss: 1.721 Vali Acc: 0.550 Test Loss: 1.721 Test Acc: 0.550
Validation loss decreased (-0.527760 --> -0.549983).  Saving model ...
Epoch: 21 cost time: 0.6671075820922852
Epoch: 21, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.658 Vali Acc: 0.550 Test Loss: 1.658 Test Acc: 0.550
Validation loss decreased (-0.549983 --> -0.549983).  Saving model ...
Epoch: 22 cost time: 0.6691219806671143
Epoch: 22, Steps: 12 | Train Loss: 1.484 Vali Loss: 1.606 Vali Acc: 0.544 Test Loss: 1.606 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7439475059509277
Epoch: 23, Steps: 12 | Train Loss: 1.466 Vali Loss: 1.547 Vali Acc: 0.556 Test Loss: 1.547 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555540).  Saving model ...
Epoch: 24 cost time: 0.690936803817749
Epoch: 24, Steps: 12 | Train Loss: 1.383 Vali Loss: 1.497 Vali Acc: 0.589 Test Loss: 1.497 Test Acc: 0.589
Validation loss decreased (-0.555540 --> -0.588874).  Saving model ...
Epoch: 25 cost time: 0.8310396671295166
Epoch: 25, Steps: 12 | Train Loss: 1.309 Vali Loss: 1.438 Vali Acc: 0.578 Test Loss: 1.438 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8743197917938232
Epoch: 26, Steps: 12 | Train Loss: 1.226 Vali Loss: 1.385 Vali Acc: 0.594 Test Loss: 1.385 Test Acc: 0.594
Validation loss decreased (-0.588874 --> -0.594431).  Saving model ...
Epoch: 27 cost time: 0.756838321685791
Epoch: 27, Steps: 12 | Train Loss: 1.273 Vali Loss: 1.334 Vali Acc: 0.606 Test Loss: 1.334 Test Acc: 0.606
Validation loss decreased (-0.594431 --> -0.605542).  Saving model ...
Epoch: 28 cost time: 0.7371416091918945
Epoch: 28, Steps: 12 | Train Loss: 1.117 Vali Loss: 1.294 Vali Acc: 0.606 Test Loss: 1.294 Test Acc: 0.606
Validation loss decreased (-0.605542 --> -0.605543).  Saving model ...
Epoch: 29 cost time: 0.6949508190155029
Epoch: 29, Steps: 12 | Train Loss: 1.079 Vali Loss: 1.254 Vali Acc: 0.617 Test Loss: 1.254 Test Acc: 0.617
Validation loss decreased (-0.605543 --> -0.616654).  Saving model ...
Epoch: 30 cost time: 0.6310272216796875
Epoch: 30, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.207 Vali Acc: 0.633 Test Loss: 1.207 Test Acc: 0.633
Validation loss decreased (-0.616654 --> -0.633321).  Saving model ...
Epoch: 31 cost time: 0.7414810657501221
Epoch: 31, Steps: 12 | Train Loss: 1.003 Vali Loss: 1.173 Vali Acc: 0.622 Test Loss: 1.173 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8104662895202637
Epoch: 32, Steps: 12 | Train Loss: 0.917 Vali Loss: 1.137 Vali Acc: 0.639 Test Loss: 1.137 Test Acc: 0.639
Validation loss decreased (-0.633321 --> -0.638878).  Saving model ...
Epoch: 33 cost time: 0.7924573421478271
Epoch: 33, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.111 Vali Acc: 0.656 Test Loss: 1.111 Test Acc: 0.656
Validation loss decreased (-0.638878 --> -0.655544).  Saving model ...
Epoch: 34 cost time: 0.8497798442840576
Epoch: 34, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.060 Vali Acc: 0.667 Test Loss: 1.060 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666656).  Saving model ...
Epoch: 35 cost time: 0.818702220916748
Epoch: 35, Steps: 12 | Train Loss: 0.790 Vali Loss: 1.020 Vali Acc: 0.639 Test Loss: 1.020 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7318711280822754
Epoch: 36, Steps: 12 | Train Loss: 0.768 Vali Loss: 0.995 Vali Acc: 0.667 Test Loss: 0.995 Test Acc: 0.667
Validation loss decreased (-0.666656 --> -0.666657).  Saving model ...
Epoch: 37 cost time: 0.6349523067474365
Epoch: 37, Steps: 12 | Train Loss: 0.686 Vali Loss: 0.956 Vali Acc: 0.661 Test Loss: 0.956 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7215557098388672
Epoch: 38, Steps: 12 | Train Loss: 0.697 Vali Loss: 0.913 Vali Acc: 0.672 Test Loss: 0.913 Test Acc: 0.672
Validation loss decreased (-0.666657 --> -0.672213).  Saving model ...
Epoch: 39 cost time: 0.8751885890960693
Epoch: 39, Steps: 12 | Train Loss: 0.623 Vali Loss: 0.884 Vali Acc: 0.700 Test Loss: 0.884 Test Acc: 0.700
Validation loss decreased (-0.672213 --> -0.699991).  Saving model ...
Epoch: 40 cost time: 0.6575887203216553
Epoch: 40, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
Validation loss decreased (-0.699991 --> -0.722214).  Saving model ...
Epoch: 41 cost time: 0.9759466648101807
Epoch: 41, Steps: 12 | Train Loss: 0.521 Vali Loss: 0.832 Vali Acc: 0.733 Test Loss: 0.832 Test Acc: 0.733
Validation loss decreased (-0.722214 --> -0.733325).  Saving model ...
Epoch: 42 cost time: 0.8579742908477783
Epoch: 42, Steps: 12 | Train Loss: 0.511 Vali Loss: 0.817 Vali Acc: 0.728 Test Loss: 0.817 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7800321578979492
Epoch: 43, Steps: 12 | Train Loss: 0.480 Vali Loss: 0.798 Vali Acc: 0.728 Test Loss: 0.798 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7073097229003906
Epoch: 44, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.780 Vali Acc: 0.733 Test Loss: 0.780 Test Acc: 0.733
Validation loss decreased (-0.733325 --> -0.733326).  Saving model ...
Epoch: 45 cost time: 0.65146803855896
Epoch: 45, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7155449390411377
Epoch: 46, Steps: 12 | Train Loss: 0.387 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7261414527893066
Epoch: 47, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.774 Vali Acc: 0.728 Test Loss: 0.774 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9627945423126221
Epoch: 48, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.753 Vali Acc: 0.739 Test Loss: 0.753 Test Acc: 0.739
Validation loss decreased (-0.733326 --> -0.738881).  Saving model ...
Epoch: 49 cost time: 0.7355074882507324
Epoch: 49, Steps: 12 | Train Loss: 0.302 Vali Loss: 0.736 Vali Acc: 0.750 Test Loss: 0.736 Test Acc: 0.750
Validation loss decreased (-0.738881 --> -0.749993).  Saving model ...
Epoch: 50 cost time: 0.7288162708282471
Epoch: 50, Steps: 12 | Train Loss: 0.291 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6966245174407959
Epoch: 51, Steps: 12 | Train Loss: 0.265 Vali Loss: 0.761 Vali Acc: 0.728 Test Loss: 0.761 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7322864532470703
Epoch: 52, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.753 Vali Acc: 0.733 Test Loss: 0.753 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.724757194519043
Epoch: 53, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.745 Vali Acc: 0.739 Test Loss: 0.745 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7883877754211426
Epoch: 54, Steps: 12 | Train Loss: 0.251 Vali Loss: 0.775 Vali Acc: 0.733 Test Loss: 0.775 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.7730071544647217
Epoch: 55, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.786 Vali Acc: 0.722 Test Loss: 0.786 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.670163631439209
Epoch: 56, Steps: 12 | Train Loss: 0.202 Vali Loss: 0.758 Vali Acc: 0.733 Test Loss: 0.758 Test Acc: 0.733
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6447973251342773
Epoch: 57, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.787 Vali Acc: 0.739 Test Loss: 0.787 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6616349220275879
Epoch: 58, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.793 Vali Acc: 0.739 Test Loss: 0.793 Test Acc: 0.739
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.6649227142333984
Epoch: 59, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.798 Vali Acc: 0.756 Test Loss: 0.798 Test Acc: 0.756
Validation loss decreased (-0.749993 --> -0.755548).  Saving model ...
Epoch: 60 cost time: 0.6085560321807861
Epoch: 60, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.788 Vali Acc: 0.739 Test Loss: 0.788 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6903505325317383
Epoch: 61, Steps: 12 | Train Loss: 0.154 Vali Loss: 0.791 Vali Acc: 0.739 Test Loss: 0.791 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6151838302612305
Epoch: 62, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.824 Vali Acc: 0.761 Test Loss: 0.824 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761103).  Saving model ...
Epoch: 63 cost time: 0.5908961296081543
Epoch: 63, Steps: 12 | Train Loss: 0.130 Vali Loss: 0.822 Vali Acc: 0.744 Test Loss: 0.822 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6788396835327148
Epoch: 64, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.820 Vali Acc: 0.756 Test Loss: 0.820 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6135716438293457
Epoch: 65, Steps: 12 | Train Loss: 0.118 Vali Loss: 0.838 Vali Acc: 0.750 Test Loss: 0.838 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.7474992275238037
Epoch: 66, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.859 Vali Acc: 0.750 Test Loss: 0.859 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7653837203979492
Epoch: 67, Steps: 12 | Train Loss: 0.107 Vali Loss: 0.896 Vali Acc: 0.739 Test Loss: 0.896 Test Acc: 0.739
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.6535477638244629
Epoch: 68, Steps: 12 | Train Loss: 0.094 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.7912399768829346
Epoch: 69, Steps: 12 | Train Loss: 0.101 Vali Loss: 0.876 Vali Acc: 0.750 Test Loss: 0.876 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.8143630027770996
Epoch: 70, Steps: 12 | Train Loss: 0.082 Vali Loss: 0.919 Vali Acc: 0.739 Test Loss: 0.919 Test Acc: 0.739
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.7261126041412354
Epoch: 71, Steps: 12 | Train Loss: 0.078 Vali Loss: 0.936 Vali Acc: 0.733 Test Loss: 0.936 Test Acc: 0.733
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.6394085884094238
Epoch: 72, Steps: 12 | Train Loss: 0.074 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 5854
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.212273359298706
Epoch: 1, Steps: 12 | Train Loss: 2.817 Vali Loss: 2.832 Vali Acc: 0.050 Test Loss: 2.832 Test Acc: 0.050
Validation loss decreased (inf --> -0.049972).  Saving model ...
Epoch: 2 cost time: 0.6432192325592041
Epoch: 2, Steps: 12 | Train Loss: 2.796 Vali Loss: 2.807 Vali Acc: 0.056 Test Loss: 2.807 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055527).  Saving model ...
Epoch: 3 cost time: 0.5487501621246338
Epoch: 3, Steps: 12 | Train Loss: 2.782 Vali Loss: 2.774 Vali Acc: 0.067 Test Loss: 2.774 Test Acc: 0.067
Validation loss decreased (-0.055527 --> -0.066639).  Saving model ...
Epoch: 4 cost time: 0.7524924278259277
Epoch: 4, Steps: 12 | Train Loss: 2.713 Vali Loss: 2.734 Vali Acc: 0.072 Test Loss: 2.734 Test Acc: 0.072
Validation loss decreased (-0.066639 --> -0.072195).  Saving model ...
Epoch: 5 cost time: 1.0524663925170898
Epoch: 5, Steps: 12 | Train Loss: 2.689 Vali Loss: 2.692 Vali Acc: 0.083 Test Loss: 2.692 Test Acc: 0.083
Validation loss decreased (-0.072195 --> -0.083306).  Saving model ...
Epoch: 6 cost time: 0.646636962890625
Epoch: 6, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.649 Vali Acc: 0.106 Test Loss: 2.649 Test Acc: 0.106
Validation loss decreased (-0.083306 --> -0.105529).  Saving model ...
Epoch: 7 cost time: 0.688549280166626
Epoch: 7, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.600 Vali Acc: 0.133 Test Loss: 2.600 Test Acc: 0.133
Validation loss decreased (-0.105529 --> -0.133307).  Saving model ...
Epoch: 8 cost time: 0.821725606918335
Epoch: 8, Steps: 12 | Train Loss: 2.532 Vali Loss: 2.548 Vali Acc: 0.144 Test Loss: 2.548 Test Acc: 0.144
Validation loss decreased (-0.133307 --> -0.144419).  Saving model ...
Epoch: 9 cost time: 0.6648797988891602
Epoch: 9, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.498 Vali Acc: 0.156 Test Loss: 2.498 Test Acc: 0.156
Validation loss decreased (-0.144419 --> -0.155531).  Saving model ...
Epoch: 10 cost time: 0.6899452209472656
Epoch: 10, Steps: 12 | Train Loss: 2.423 Vali Loss: 2.440 Vali Acc: 0.222 Test Loss: 2.440 Test Acc: 0.222
Validation loss decreased (-0.155531 --> -0.222198).  Saving model ...
Epoch: 11 cost time: 0.8943266868591309
Epoch: 11, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.383 Vali Acc: 0.306 Test Loss: 2.383 Test Acc: 0.306
Validation loss decreased (-0.222198 --> -0.305532).  Saving model ...
Epoch: 12 cost time: 0.7650604248046875
Epoch: 12, Steps: 12 | Train Loss: 2.301 Vali Loss: 2.323 Vali Acc: 0.339 Test Loss: 2.323 Test Acc: 0.339
Validation loss decreased (-0.305532 --> -0.338866).  Saving model ...
Epoch: 13 cost time: 0.8862087726593018
Epoch: 13, Steps: 12 | Train Loss: 2.233 Vali Loss: 2.258 Vali Acc: 0.383 Test Loss: 2.258 Test Acc: 0.383
Validation loss decreased (-0.338866 --> -0.383311).  Saving model ...
Epoch: 14 cost time: 0.9976117610931396
Epoch: 14, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.189 Vali Acc: 0.411 Test Loss: 2.189 Test Acc: 0.411
Validation loss decreased (-0.383311 --> -0.411089).  Saving model ...
Epoch: 15 cost time: 0.602891206741333
Epoch: 15, Steps: 12 | Train Loss: 2.076 Vali Loss: 2.124 Vali Acc: 0.433 Test Loss: 2.124 Test Acc: 0.433
Validation loss decreased (-0.411089 --> -0.433312).  Saving model ...
Epoch: 16 cost time: 0.6391892433166504
Epoch: 16, Steps: 12 | Train Loss: 2.009 Vali Loss: 2.049 Vali Acc: 0.428 Test Loss: 2.049 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6580708026885986
Epoch: 17, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.971 Vali Acc: 0.422 Test Loss: 1.971 Test Acc: 0.422
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6207661628723145
Epoch: 18, Steps: 12 | Train Loss: 1.786 Vali Loss: 1.885 Vali Acc: 0.428 Test Loss: 1.885 Test Acc: 0.428
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7124147415161133
Epoch: 19, Steps: 12 | Train Loss: 1.708 Vali Loss: 1.803 Vali Acc: 0.450 Test Loss: 1.803 Test Acc: 0.450
Validation loss decreased (-0.433312 --> -0.449982).  Saving model ...
Epoch: 20 cost time: 0.6505670547485352
Epoch: 20, Steps: 12 | Train Loss: 1.588 Vali Loss: 1.720 Vali Acc: 0.478 Test Loss: 1.720 Test Acc: 0.478
Validation loss decreased (-0.449982 --> -0.477761).  Saving model ...
Epoch: 21 cost time: 0.6771073341369629
Epoch: 21, Steps: 12 | Train Loss: 1.499 Vali Loss: 1.654 Vali Acc: 0.467 Test Loss: 1.654 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7295887470245361
Epoch: 22, Steps: 12 | Train Loss: 1.394 Vali Loss: 1.586 Vali Acc: 0.494 Test Loss: 1.586 Test Acc: 0.494
Validation loss decreased (-0.477761 --> -0.494429).  Saving model ...
Epoch: 23 cost time: 0.7832353115081787
Epoch: 23, Steps: 12 | Train Loss: 1.340 Vali Loss: 1.527 Vali Acc: 0.517 Test Loss: 1.527 Test Acc: 0.517
Validation loss decreased (-0.494429 --> -0.516651).  Saving model ...
Epoch: 24 cost time: 0.7045278549194336
Epoch: 24, Steps: 12 | Train Loss: 1.266 Vali Loss: 1.475 Vali Acc: 0.589 Test Loss: 1.475 Test Acc: 0.589
Validation loss decreased (-0.516651 --> -0.588874).  Saving model ...
Epoch: 25 cost time: 0.5620439052581787
Epoch: 25, Steps: 12 | Train Loss: 1.189 Vali Loss: 1.408 Vali Acc: 0.583 Test Loss: 1.408 Test Acc: 0.583
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6551966667175293
Epoch: 26, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.360 Vali Acc: 0.561 Test Loss: 1.360 Test Acc: 0.561
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6229391098022461
Epoch: 27, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.315 Vali Acc: 0.600 Test Loss: 1.315 Test Acc: 0.600
Validation loss decreased (-0.588874 --> -0.599987).  Saving model ...
Epoch: 28 cost time: 0.7085235118865967
Epoch: 28, Steps: 12 | Train Loss: 0.988 Vali Loss: 1.260 Vali Acc: 0.606 Test Loss: 1.260 Test Acc: 0.606
Validation loss decreased (-0.599987 --> -0.605543).  Saving model ...
Epoch: 29 cost time: 0.6074142456054688
Epoch: 29, Steps: 12 | Train Loss: 0.939 Vali Loss: 1.218 Vali Acc: 0.594 Test Loss: 1.218 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6757979393005371
Epoch: 30, Steps: 12 | Train Loss: 0.869 Vali Loss: 1.166 Vali Acc: 0.656 Test Loss: 1.166 Test Acc: 0.656
Validation loss decreased (-0.605543 --> -0.655544).  Saving model ...
Epoch: 31 cost time: 0.758739709854126
Epoch: 31, Steps: 12 | Train Loss: 0.788 Vali Loss: 1.140 Vali Acc: 0.650 Test Loss: 1.140 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7535982131958008
Epoch: 32, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.124 Vali Acc: 0.656 Test Loss: 1.124 Test Acc: 0.656
Validation loss decreased (-0.655544 --> -0.655544).  Saving model ...
Epoch: 33 cost time: 0.6184170246124268
Epoch: 33, Steps: 12 | Train Loss: 0.767 Vali Loss: 1.103 Vali Acc: 0.639 Test Loss: 1.103 Test Acc: 0.639
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6491861343383789
Epoch: 34, Steps: 12 | Train Loss: 0.706 Vali Loss: 1.061 Vali Acc: 0.661 Test Loss: 1.061 Test Acc: 0.661
Validation loss decreased (-0.655544 --> -0.661100).  Saving model ...
Epoch: 35 cost time: 0.6468720436096191
Epoch: 35, Steps: 12 | Train Loss: 0.699 Vali Loss: 1.049 Vali Acc: 0.661 Test Loss: 1.049 Test Acc: 0.661
Validation loss decreased (-0.661100 --> -0.661101).  Saving model ...
Epoch: 36 cost time: 0.702021598815918
Epoch: 36, Steps: 12 | Train Loss: 0.682 Vali Loss: 1.016 Vali Acc: 0.672 Test Loss: 1.016 Test Acc: 0.672
Validation loss decreased (-0.661101 --> -0.672212).  Saving model ...
Epoch: 37 cost time: 0.7048666477203369
Epoch: 37, Steps: 12 | Train Loss: 0.661 Vali Loss: 1.009 Vali Acc: 0.661 Test Loss: 1.009 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8417506217956543
Epoch: 38, Steps: 12 | Train Loss: 0.632 Vali Loss: 0.967 Vali Acc: 0.639 Test Loss: 0.967 Test Acc: 0.639
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7913377285003662
Epoch: 39, Steps: 12 | Train Loss: 0.609 Vali Loss: 0.959 Vali Acc: 0.661 Test Loss: 0.959 Test Acc: 0.661
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8344624042510986
Epoch: 40, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
Validation loss decreased (-0.672212 --> -0.716657).  Saving model ...
Epoch: 41 cost time: 0.6941452026367188
Epoch: 41, Steps: 12 | Train Loss: 0.571 Vali Loss: 0.897 Vali Acc: 0.711 Test Loss: 0.897 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8071105480194092
Epoch: 42, Steps: 12 | Train Loss: 0.561 Vali Loss: 0.887 Vali Acc: 0.689 Test Loss: 0.887 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7416398525238037
Epoch: 43, Steps: 12 | Train Loss: 0.539 Vali Loss: 0.879 Vali Acc: 0.700 Test Loss: 0.879 Test Acc: 0.700
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7129244804382324
Epoch: 44, Steps: 12 | Train Loss: 0.598 Vali Loss: 0.878 Vali Acc: 0.722 Test Loss: 0.878 Test Acc: 0.722
Validation loss decreased (-0.716657 --> -0.722213).  Saving model ...
Epoch: 45 cost time: 0.85091233253479
Epoch: 45, Steps: 12 | Train Loss: 0.596 Vali Loss: 0.846 Vali Acc: 0.722 Test Loss: 0.846 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 46 cost time: 0.7245426177978516
Epoch: 46, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.822 Vali Acc: 0.722 Test Loss: 0.822 Test Acc: 0.722
Validation loss decreased (-0.722214 --> -0.722214).  Saving model ...
Epoch: 47 cost time: 0.7427761554718018
Epoch: 47, Steps: 12 | Train Loss: 0.510 Vali Loss: 0.848 Vali Acc: 0.717 Test Loss: 0.848 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8436999320983887
Epoch: 48, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.810 Vali Acc: 0.728 Test Loss: 0.810 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 49 cost time: 0.9775745868682861
Epoch: 49, Steps: 12 | Train Loss: 0.446 Vali Loss: 0.805 Vali Acc: 0.722 Test Loss: 0.805 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6329007148742676
Epoch: 50, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.813 Vali Acc: 0.744 Test Loss: 0.813 Test Acc: 0.744
Validation loss decreased (-0.727770 --> -0.744436).  Saving model ...
Epoch: 51 cost time: 0.7838668823242188
Epoch: 51, Steps: 12 | Train Loss: 0.416 Vali Loss: 0.819 Vali Acc: 0.717 Test Loss: 0.819 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8389711380004883
Epoch: 52, Steps: 12 | Train Loss: 0.419 Vali Loss: 0.812 Vali Acc: 0.744 Test Loss: 0.812 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 53 cost time: 0.7552978992462158
Epoch: 53, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.797 Vali Acc: 0.739 Test Loss: 0.797 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7102305889129639
Epoch: 54, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.785 Vali Acc: 0.750 Test Loss: 0.785 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 0.5765080451965332
Epoch: 55, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.782 Vali Acc: 0.744 Test Loss: 0.782 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.709000825881958
Epoch: 56, Steps: 12 | Train Loss: 0.361 Vali Loss: 0.806 Vali Acc: 0.739 Test Loss: 0.806 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7647507190704346
Epoch: 57, Steps: 12 | Train Loss: 0.334 Vali Loss: 0.803 Vali Acc: 0.744 Test Loss: 0.803 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6689283847808838
Epoch: 58, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 59 cost time: 0.7442750930786133
Epoch: 59, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.757 Vali Acc: 0.756 Test Loss: 0.757 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755548).  Saving model ...
Epoch: 60 cost time: 0.712942361831665
Epoch: 60, Steps: 12 | Train Loss: 0.345 Vali Loss: 0.788 Vali Acc: 0.750 Test Loss: 0.788 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6992902755737305
Epoch: 61, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.755 Vali Acc: 0.761 Test Loss: 0.755 Test Acc: 0.761
Validation loss decreased (-0.755548 --> -0.761104).  Saving model ...
Epoch: 62 cost time: 0.6458334922790527
Epoch: 62, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.743 Vali Acc: 0.750 Test Loss: 0.743 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6905555725097656
Epoch: 63, Steps: 12 | Train Loss: 0.350 Vali Loss: 0.740 Vali Acc: 0.789 Test Loss: 0.740 Test Acc: 0.789
Validation loss decreased (-0.761104 --> -0.788881).  Saving model ...
Epoch: 64 cost time: 0.5883748531341553
Epoch: 64, Steps: 12 | Train Loss: 0.298 Vali Loss: 0.738 Vali Acc: 0.761 Test Loss: 0.738 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.8165469169616699
Epoch: 65, Steps: 12 | Train Loss: 0.258 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9738049507141113
Epoch: 66, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.711 Vali Acc: 0.794 Test Loss: 0.711 Test Acc: 0.794
Validation loss decreased (-0.788881 --> -0.794437).  Saving model ...
Epoch: 67 cost time: 0.7666637897491455
Epoch: 67, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.752 Vali Acc: 0.783 Test Loss: 0.752 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6919500827789307
Epoch: 68, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.731 Vali Acc: 0.800 Test Loss: 0.731 Test Acc: 0.800
Validation loss decreased (-0.794437 --> -0.799993).  Saving model ...
Epoch: 69 cost time: 0.8329157829284668
Epoch: 69, Steps: 12 | Train Loss: 0.259 Vali Loss: 0.739 Vali Acc: 0.772 Test Loss: 0.739 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6680493354797363
Epoch: 70, Steps: 12 | Train Loss: 0.253 Vali Loss: 0.783 Vali Acc: 0.800 Test Loss: 0.783 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6690566539764404
Epoch: 71, Steps: 12 | Train Loss: 0.231 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.752816915512085
Epoch: 72, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.738 Vali Acc: 0.806 Test Loss: 0.738 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805548).  Saving model ...
Epoch: 73 cost time: 0.682243824005127
Epoch: 73, Steps: 12 | Train Loss: 0.312 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7195451259613037
Epoch: 74, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.756 Vali Acc: 0.794 Test Loss: 0.756 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.9847407341003418
Epoch: 75, Steps: 12 | Train Loss: 0.227 Vali Loss: 0.775 Vali Acc: 0.789 Test Loss: 0.775 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.7514975070953369
Epoch: 76, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.750 Vali Acc: 0.806 Test Loss: 0.750 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6130940914154053
Epoch: 77, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.784 Vali Acc: 0.794 Test Loss: 0.784 Test Acc: 0.794
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.7110013961791992
Epoch: 78, Steps: 12 | Train Loss: 0.196 Vali Loss: 0.733 Vali Acc: 0.806 Test Loss: 0.733 Test Acc: 0.806
Validation loss decreased (-0.805548 --> -0.805548).  Saving model ...
Epoch: 79 cost time: 0.6444826126098633
Epoch: 79, Steps: 12 | Train Loss: 0.189 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7598354816436768
Epoch: 80, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.759 Vali Acc: 0.806 Test Loss: 0.759 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7224826812744141
Epoch: 81, Steps: 12 | Train Loss: 0.175 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.664463996887207
Epoch: 82, Steps: 12 | Train Loss: 0.217 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7441291809082031
Epoch: 83, Steps: 12 | Train Loss: 0.171 Vali Loss: 0.785 Vali Acc: 0.811 Test Loss: 0.785 Test Acc: 0.811
Validation loss decreased (-0.805548 --> -0.811103).  Saving model ...
Epoch: 84 cost time: 0.5766913890838623
Epoch: 84, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.769 Vali Acc: 0.800 Test Loss: 0.769 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.668358564376831
Epoch: 85, Steps: 12 | Train Loss: 0.181 Vali Loss: 0.827 Vali Acc: 0.794 Test Loss: 0.827 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.8304200172424316
Epoch: 86, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.826 Vali Acc: 0.794 Test Loss: 0.826 Test Acc: 0.794
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.6841177940368652
Epoch: 87, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.818 Vali Acc: 0.806 Test Loss: 0.818 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.668201208114624
Epoch: 88, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.833 Vali Acc: 0.817 Test Loss: 0.833 Test Acc: 0.817
Validation loss decreased (-0.811103 --> -0.816658).  Saving model ...
Epoch: 89 cost time: 0.5773768424987793
Epoch: 89, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.827 Vali Acc: 0.789 Test Loss: 0.827 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7499709129333496
Epoch: 90, Steps: 12 | Train Loss: 0.147 Vali Loss: 0.877 Vali Acc: 0.794 Test Loss: 0.877 Test Acc: 0.794
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.6391057968139648
Epoch: 91, Steps: 12 | Train Loss: 0.125 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6652305126190186
Epoch: 92, Steps: 12 | Train Loss: 0.126 Vali Loss: 0.879 Vali Acc: 0.806 Test Loss: 0.879 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.6881411075592041
Epoch: 93, Steps: 12 | Train Loss: 0.116 Vali Loss: 0.901 Vali Acc: 0.800 Test Loss: 0.901 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.776724100112915
Epoch: 94, Steps: 12 | Train Loss: 0.097 Vali Loss: 0.888 Vali Acc: 0.783 Test Loss: 0.888 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.7083244323730469
Epoch: 95, Steps: 12 | Train Loss: 0.090 Vali Loss: 0.855 Vali Acc: 0.800 Test Loss: 0.855 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.7381758689880371
Epoch: 96, Steps: 12 | Train Loss: 0.081 Vali Loss: 0.931 Vali Acc: 0.789 Test Loss: 0.931 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.6757771968841553
Epoch: 97, Steps: 12 | Train Loss: 0.083 Vali Loss: 0.908 Vali Acc: 0.789 Test Loss: 0.908 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 0.6900134086608887
Epoch: 98, Steps: 12 | Train Loss: 0.073 Vali Loss: 1.003 Vali Acc: 0.778 Test Loss: 1.003 Test Acc: 0.778
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8166666666666667
model parameter : 6095
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3743457794189453
Epoch: 1, Steps: 12 | Train Loss: 2.902 Vali Loss: 2.905 Vali Acc: 0.039 Test Loss: 2.905 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 0.7268784046173096
Epoch: 2, Steps: 12 | Train Loss: 2.875 Vali Loss: 2.879 Vali Acc: 0.033 Test Loss: 2.879 Test Acc: 0.033
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7121739387512207
Epoch: 3, Steps: 12 | Train Loss: 2.866 Vali Loss: 2.843 Vali Acc: 0.044 Test Loss: 2.843 Test Acc: 0.044
Validation loss decreased (-0.038860 --> -0.044416).  Saving model ...
Epoch: 4 cost time: 0.6095373630523682
Epoch: 4, Steps: 12 | Train Loss: 2.809 Vali Loss: 2.800 Vali Acc: 0.050 Test Loss: 2.800 Test Acc: 0.050
Validation loss decreased (-0.044416 --> -0.049972).  Saving model ...
Epoch: 5 cost time: 0.6242258548736572
Epoch: 5, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.754 Vali Acc: 0.056 Test Loss: 2.754 Test Acc: 0.056
Validation loss decreased (-0.049972 --> -0.055528).  Saving model ...
Epoch: 6 cost time: 0.7649283409118652
Epoch: 6, Steps: 12 | Train Loss: 2.718 Vali Loss: 2.707 Vali Acc: 0.061 Test Loss: 2.707 Test Acc: 0.061
Validation loss decreased (-0.055528 --> -0.061084).  Saving model ...
Epoch: 7 cost time: 0.5470869541168213
Epoch: 7, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.654 Vali Acc: 0.094 Test Loss: 2.654 Test Acc: 0.094
Validation loss decreased (-0.061084 --> -0.094418).  Saving model ...
Epoch: 8 cost time: 0.6281237602233887
Epoch: 8, Steps: 12 | Train Loss: 2.591 Vali Loss: 2.601 Vali Acc: 0.117 Test Loss: 2.601 Test Acc: 0.117
Validation loss decreased (-0.094418 --> -0.116641).  Saving model ...
Epoch: 9 cost time: 0.6874313354492188
Epoch: 9, Steps: 12 | Train Loss: 2.549 Vali Loss: 2.547 Vali Acc: 0.172 Test Loss: 2.547 Test Acc: 0.172
Validation loss decreased (-0.116641 --> -0.172197).  Saving model ...
Epoch: 10 cost time: 0.7517173290252686
Epoch: 10, Steps: 12 | Train Loss: 2.483 Vali Loss: 2.490 Vali Acc: 0.222 Test Loss: 2.490 Test Acc: 0.222
Validation loss decreased (-0.172197 --> -0.222197).  Saving model ...
Epoch: 11 cost time: 0.6712086200714111
Epoch: 11, Steps: 12 | Train Loss: 2.421 Vali Loss: 2.429 Vali Acc: 0.244 Test Loss: 2.429 Test Acc: 0.244
Validation loss decreased (-0.222197 --> -0.244420).  Saving model ...
Epoch: 12 cost time: 0.7264425754547119
Epoch: 12, Steps: 12 | Train Loss: 2.354 Vali Loss: 2.366 Vali Acc: 0.267 Test Loss: 2.366 Test Acc: 0.267
Validation loss decreased (-0.244420 --> -0.266643).  Saving model ...
Epoch: 13 cost time: 0.64559006690979
Epoch: 13, Steps: 12 | Train Loss: 2.275 Vali Loss: 2.298 Vali Acc: 0.328 Test Loss: 2.298 Test Acc: 0.328
Validation loss decreased (-0.266643 --> -0.327755).  Saving model ...
Epoch: 14 cost time: 0.7247204780578613
Epoch: 14, Steps: 12 | Train Loss: 2.208 Vali Loss: 2.229 Vali Acc: 0.383 Test Loss: 2.229 Test Acc: 0.383
Validation loss decreased (-0.327755 --> -0.383311).  Saving model ...
Epoch: 15 cost time: 0.6611506938934326
Epoch: 15, Steps: 12 | Train Loss: 2.140 Vali Loss: 2.156 Vali Acc: 0.439 Test Loss: 2.156 Test Acc: 0.439
Validation loss decreased (-0.383311 --> -0.438867).  Saving model ...
Epoch: 16 cost time: 0.6846222877502441
Epoch: 16, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.075 Vali Acc: 0.461 Test Loss: 2.075 Test Acc: 0.461
Validation loss decreased (-0.438867 --> -0.461090).  Saving model ...
Epoch: 17 cost time: 0.6067714691162109
Epoch: 17, Steps: 12 | Train Loss: 1.954 Vali Loss: 1.991 Vali Acc: 0.478 Test Loss: 1.991 Test Acc: 0.478
Validation loss decreased (-0.461090 --> -0.477758).  Saving model ...
Epoch: 18 cost time: 0.6186387538909912
Epoch: 18, Steps: 12 | Train Loss: 1.833 Vali Loss: 1.896 Vali Acc: 0.483 Test Loss: 1.896 Test Acc: 0.483
Validation loss decreased (-0.477758 --> -0.483314).  Saving model ...
Epoch: 19 cost time: 0.773413896560669
Epoch: 19, Steps: 12 | Train Loss: 1.752 Vali Loss: 1.807 Vali Acc: 0.506 Test Loss: 1.807 Test Acc: 0.506
Validation loss decreased (-0.483314 --> -0.505537).  Saving model ...
Epoch: 20 cost time: 0.7038943767547607
Epoch: 20, Steps: 12 | Train Loss: 1.638 Vali Loss: 1.711 Vali Acc: 0.522 Test Loss: 1.711 Test Acc: 0.522
Validation loss decreased (-0.505537 --> -0.522205).  Saving model ...
Epoch: 21 cost time: 0.7057113647460938
Epoch: 21, Steps: 12 | Train Loss: 1.568 Vali Loss: 1.619 Vali Acc: 0.539 Test Loss: 1.619 Test Acc: 0.539
Validation loss decreased (-0.522205 --> -0.538873).  Saving model ...
Epoch: 22 cost time: 0.6042358875274658
Epoch: 22, Steps: 12 | Train Loss: 1.436 Vali Loss: 1.540 Vali Acc: 0.550 Test Loss: 1.540 Test Acc: 0.550
Validation loss decreased (-0.538873 --> -0.549985).  Saving model ...
Epoch: 23 cost time: 0.567324161529541
Epoch: 23, Steps: 12 | Train Loss: 1.399 Vali Loss: 1.457 Vali Acc: 0.600 Test Loss: 1.457 Test Acc: 0.600
Validation loss decreased (-0.549985 --> -0.599985).  Saving model ...
Epoch: 24 cost time: 0.8188202381134033
Epoch: 24, Steps: 12 | Train Loss: 1.345 Vali Loss: 1.409 Vali Acc: 0.606 Test Loss: 1.409 Test Acc: 0.606
Validation loss decreased (-0.599985 --> -0.605541).  Saving model ...
Epoch: 25 cost time: 0.9533493518829346
Epoch: 25, Steps: 12 | Train Loss: 1.196 Vali Loss: 1.352 Vali Acc: 0.644 Test Loss: 1.352 Test Acc: 0.644
Validation loss decreased (-0.605541 --> -0.644431).  Saving model ...
Epoch: 26 cost time: 0.6980171203613281
Epoch: 26, Steps: 12 | Train Loss: 1.105 Vali Loss: 1.309 Vali Acc: 0.644 Test Loss: 1.309 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 27 cost time: 0.940786600112915
Epoch: 27, Steps: 12 | Train Loss: 1.039 Vali Loss: 1.272 Vali Acc: 0.644 Test Loss: 1.272 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644432).  Saving model ...
Epoch: 28 cost time: 0.8584716320037842
Epoch: 28, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.221 Vali Acc: 0.661 Test Loss: 1.221 Test Acc: 0.661
Validation loss decreased (-0.644432 --> -0.661099).  Saving model ...
Epoch: 29 cost time: 0.5647845268249512
Epoch: 29, Steps: 12 | Train Loss: 0.976 Vali Loss: 1.202 Vali Acc: 0.667 Test Loss: 1.202 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 30 cost time: 0.5634207725524902
Epoch: 30, Steps: 12 | Train Loss: 0.858 Vali Loss: 1.121 Vali Acc: 0.656 Test Loss: 1.121 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6208453178405762
Epoch: 31, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.074 Vali Acc: 0.661 Test Loss: 1.074 Test Acc: 0.661
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5534374713897705
Epoch: 32, Steps: 12 | Train Loss: 0.742 Vali Loss: 1.024 Vali Acc: 0.683 Test Loss: 1.024 Test Acc: 0.683
Validation loss decreased (-0.666655 --> -0.683323).  Saving model ...
Epoch: 33 cost time: 0.7799034118652344
Epoch: 33, Steps: 12 | Train Loss: 0.692 Vali Loss: 0.961 Vali Acc: 0.706 Test Loss: 0.961 Test Acc: 0.706
Validation loss decreased (-0.683323 --> -0.705546).  Saving model ...
Epoch: 34 cost time: 0.788630485534668
Epoch: 34, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.925 Vali Acc: 0.717 Test Loss: 0.925 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 35 cost time: 0.6750161647796631
Epoch: 35, Steps: 12 | Train Loss: 0.547 Vali Loss: 0.886 Vali Acc: 0.733 Test Loss: 0.886 Test Acc: 0.733
Validation loss decreased (-0.716657 --> -0.733324).  Saving model ...
Epoch: 36 cost time: 0.941601037979126
Epoch: 36, Steps: 12 | Train Loss: 0.503 Vali Loss: 0.858 Vali Acc: 0.706 Test Loss: 0.858 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.754826545715332
Epoch: 37, Steps: 12 | Train Loss: 0.462 Vali Loss: 0.834 Vali Acc: 0.728 Test Loss: 0.834 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5933735370635986
Epoch: 38, Steps: 12 | Train Loss: 0.512 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 39 cost time: 0.5461084842681885
Epoch: 39, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.797 Vali Acc: 0.733 Test Loss: 0.797 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6173303127288818
Epoch: 40, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.801 Vali Acc: 0.733 Test Loss: 0.801 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7369763851165771
Epoch: 41, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.764 Vali Acc: 0.739 Test Loss: 0.764 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8340444564819336
Epoch: 42, Steps: 12 | Train Loss: 0.375 Vali Loss: 0.750 Vali Acc: 0.761 Test Loss: 0.750 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761104).  Saving model ...
Epoch: 43 cost time: 0.7523250579833984
Epoch: 43, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.793 Vali Acc: 0.756 Test Loss: 0.793 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7330772876739502
Epoch: 44, Steps: 12 | Train Loss: 0.338 Vali Loss: 0.756 Vali Acc: 0.761 Test Loss: 0.756 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8584895133972168
Epoch: 45, Steps: 12 | Train Loss: 0.340 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
Validation loss decreased (-0.761104 --> -0.766659).  Saving model ...
Epoch: 46 cost time: 0.8354449272155762
Epoch: 46, Steps: 12 | Train Loss: 0.341 Vali Loss: 0.741 Vali Acc: 0.772 Test Loss: 0.741 Test Acc: 0.772
Validation loss decreased (-0.766659 --> -0.772215).  Saving model ...
Epoch: 47 cost time: 0.7644622325897217
Epoch: 47, Steps: 12 | Train Loss: 0.270 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.710162878036499
Epoch: 48, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
Validation loss decreased (-0.772215 --> -0.777770).  Saving model ...
Epoch: 49 cost time: 0.7132384777069092
Epoch: 49, Steps: 12 | Train Loss: 0.256 Vali Loss: 0.814 Vali Acc: 0.756 Test Loss: 0.814 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7499055862426758
Epoch: 50, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.798 Vali Acc: 0.767 Test Loss: 0.798 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6634922027587891
Epoch: 51, Steps: 12 | Train Loss: 0.237 Vali Loss: 0.794 Vali Acc: 0.761 Test Loss: 0.794 Test Acc: 0.761
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.754472017288208
Epoch: 52, Steps: 12 | Train Loss: 0.241 Vali Loss: 0.792 Vali Acc: 0.772 Test Loss: 0.792 Test Acc: 0.772
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.6728255748748779
Epoch: 53, Steps: 12 | Train Loss: 0.275 Vali Loss: 0.814 Vali Acc: 0.772 Test Loss: 0.814 Test Acc: 0.772
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.88189697265625
Epoch: 54, Steps: 12 | Train Loss: 0.192 Vali Loss: 0.746 Vali Acc: 0.744 Test Loss: 0.746 Test Acc: 0.744
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6143612861633301
Epoch: 55, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.780 Vali Acc: 0.778 Test Loss: 0.780 Test Acc: 0.778
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6245424747467041
Epoch: 56, Steps: 12 | Train Loss: 0.185 Vali Loss: 0.817 Vali Acc: 0.772 Test Loss: 0.817 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.6188843250274658
Epoch: 57, Steps: 12 | Train Loss: 0.178 Vali Loss: 0.812 Vali Acc: 0.778 Test Loss: 0.812 Test Acc: 0.778
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.592261791229248
Epoch: 58, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.838 Vali Acc: 0.756 Test Loss: 0.838 Test Acc: 0.756
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm64_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7777777777777778
model parameter : 6102
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.1205384731292725
Epoch: 1, Steps: 12 | Train Loss: 2.811 Vali Loss: 2.780 Vali Acc: 0.072 Test Loss: 2.780 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.7236359119415283
Epoch: 2, Steps: 12 | Train Loss: 2.799 Vali Loss: 2.754 Vali Acc: 0.072 Test Loss: 2.754 Test Acc: 0.072
Validation loss decreased (-0.072194 --> -0.072195).  Saving model ...
Epoch: 3 cost time: 0.8347876071929932
Epoch: 3, Steps: 12 | Train Loss: 2.763 Vali Loss: 2.722 Vali Acc: 0.089 Test Loss: 2.722 Test Acc: 0.089
Validation loss decreased (-0.072195 --> -0.088862).  Saving model ...
Epoch: 4 cost time: 0.691603422164917
Epoch: 4, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.682 Vali Acc: 0.100 Test Loss: 2.682 Test Acc: 0.100
Validation loss decreased (-0.088862 --> -0.099973).  Saving model ...
Epoch: 5 cost time: 0.7447803020477295
Epoch: 5, Steps: 12 | Train Loss: 2.665 Vali Loss: 2.638 Vali Acc: 0.117 Test Loss: 2.638 Test Acc: 0.117
Validation loss decreased (-0.099973 --> -0.116640).  Saving model ...
Epoch: 6 cost time: 0.7170381546020508
Epoch: 6, Steps: 12 | Train Loss: 2.613 Vali Loss: 2.593 Vali Acc: 0.161 Test Loss: 2.593 Test Acc: 0.161
Validation loss decreased (-0.116640 --> -0.161085).  Saving model ...
Epoch: 7 cost time: 0.6323683261871338
Epoch: 7, Steps: 12 | Train Loss: 2.557 Vali Loss: 2.542 Vali Acc: 0.200 Test Loss: 2.542 Test Acc: 0.200
Validation loss decreased (-0.161085 --> -0.199975).  Saving model ...
Epoch: 8 cost time: 0.6789014339447021
Epoch: 8, Steps: 12 | Train Loss: 2.502 Vali Loss: 2.491 Vali Acc: 0.261 Test Loss: 2.491 Test Acc: 0.261
Validation loss decreased (-0.199975 --> -0.261086).  Saving model ...
Epoch: 9 cost time: 0.720813512802124
Epoch: 9, Steps: 12 | Train Loss: 2.455 Vali Loss: 2.438 Vali Acc: 0.311 Test Loss: 2.438 Test Acc: 0.311
Validation loss decreased (-0.261086 --> -0.311087).  Saving model ...
Epoch: 10 cost time: 0.7647063732147217
Epoch: 10, Steps: 12 | Train Loss: 2.407 Vali Loss: 2.384 Vali Acc: 0.317 Test Loss: 2.384 Test Acc: 0.317
Validation loss decreased (-0.311087 --> -0.316643).  Saving model ...
Epoch: 11 cost time: 0.8100583553314209
Epoch: 11, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.331 Vali Acc: 0.333 Test Loss: 2.331 Test Acc: 0.333
Validation loss decreased (-0.316643 --> -0.333310).  Saving model ...
Epoch: 12 cost time: 0.6566598415374756
Epoch: 12, Steps: 12 | Train Loss: 2.245 Vali Loss: 2.276 Vali Acc: 0.356 Test Loss: 2.276 Test Acc: 0.356
Validation loss decreased (-0.333310 --> -0.355533).  Saving model ...
Epoch: 13 cost time: 0.7875661849975586
Epoch: 13, Steps: 12 | Train Loss: 2.202 Vali Loss: 2.220 Vali Acc: 0.339 Test Loss: 2.220 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7179300785064697
Epoch: 14, Steps: 12 | Train Loss: 2.146 Vali Loss: 2.164 Vali Acc: 0.339 Test Loss: 2.164 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7040038108825684
Epoch: 15, Steps: 12 | Train Loss: 2.089 Vali Loss: 2.115 Vali Acc: 0.344 Test Loss: 2.115 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7543184757232666
Epoch: 16, Steps: 12 | Train Loss: 2.039 Vali Loss: 2.062 Vali Acc: 0.356 Test Loss: 2.062 Test Acc: 0.356
Validation loss decreased (-0.355533 --> -0.355535).  Saving model ...
Epoch: 17 cost time: 0.6557049751281738
Epoch: 17, Steps: 12 | Train Loss: 1.980 Vali Loss: 2.013 Vali Acc: 0.367 Test Loss: 2.013 Test Acc: 0.367
Validation loss decreased (-0.355535 --> -0.366647).  Saving model ...
Epoch: 18 cost time: 0.7114391326904297
Epoch: 18, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.961 Vali Acc: 0.389 Test Loss: 1.961 Test Acc: 0.389
Validation loss decreased (-0.366647 --> -0.388869).  Saving model ...
Epoch: 19 cost time: 0.6642661094665527
Epoch: 19, Steps: 12 | Train Loss: 1.818 Vali Loss: 1.906 Vali Acc: 0.439 Test Loss: 1.906 Test Acc: 0.439
Validation loss decreased (-0.388869 --> -0.438870).  Saving model ...
Epoch: 20 cost time: 0.7001676559448242
Epoch: 20, Steps: 12 | Train Loss: 1.765 Vali Loss: 1.856 Vali Acc: 0.456 Test Loss: 1.856 Test Acc: 0.456
Validation loss decreased (-0.438870 --> -0.455537).  Saving model ...
Epoch: 21 cost time: 0.6696772575378418
Epoch: 21, Steps: 12 | Train Loss: 1.768 Vali Loss: 1.812 Vali Acc: 0.478 Test Loss: 1.812 Test Acc: 0.478
Validation loss decreased (-0.455537 --> -0.477760).  Saving model ...
Epoch: 22 cost time: 0.9149155616760254
Epoch: 22, Steps: 12 | Train Loss: 1.680 Vali Loss: 1.764 Vali Acc: 0.500 Test Loss: 1.764 Test Acc: 0.500
Validation loss decreased (-0.477760 --> -0.499982).  Saving model ...
Epoch: 23 cost time: 0.8208909034729004
Epoch: 23, Steps: 12 | Train Loss: 1.684 Vali Loss: 1.727 Vali Acc: 0.517 Test Loss: 1.727 Test Acc: 0.517
Validation loss decreased (-0.499982 --> -0.516649).  Saving model ...
Epoch: 24 cost time: 0.8093888759613037
Epoch: 24, Steps: 12 | Train Loss: 1.563 Vali Loss: 1.687 Vali Acc: 0.544 Test Loss: 1.687 Test Acc: 0.544
Validation loss decreased (-0.516649 --> -0.544428).  Saving model ...
Epoch: 25 cost time: 0.704777717590332
Epoch: 25, Steps: 12 | Train Loss: 1.533 Vali Loss: 1.654 Vali Acc: 0.572 Test Loss: 1.654 Test Acc: 0.572
Validation loss decreased (-0.544428 --> -0.572206).  Saving model ...
Epoch: 26 cost time: 0.771956205368042
Epoch: 26, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.619 Vali Acc: 0.583 Test Loss: 1.619 Test Acc: 0.583
Validation loss decreased (-0.572206 --> -0.583317).  Saving model ...
Epoch: 27 cost time: 0.6637973785400391
Epoch: 27, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.585 Vali Acc: 0.594 Test Loss: 1.585 Test Acc: 0.594
Validation loss decreased (-0.583317 --> -0.594429).  Saving model ...
Epoch: 28 cost time: 0.6210479736328125
Epoch: 28, Steps: 12 | Train Loss: 1.390 Vali Loss: 1.550 Vali Acc: 0.600 Test Loss: 1.550 Test Acc: 0.600
Validation loss decreased (-0.594429 --> -0.599984).  Saving model ...
Epoch: 29 cost time: 0.7812376022338867
Epoch: 29, Steps: 12 | Train Loss: 1.358 Vali Loss: 1.518 Vali Acc: 0.611 Test Loss: 1.518 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611096).  Saving model ...
Epoch: 30 cost time: 0.7488307952880859
Epoch: 30, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.484 Vali Acc: 0.594 Test Loss: 1.484 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6898314952850342
Epoch: 31, Steps: 12 | Train Loss: 1.259 Vali Loss: 1.453 Vali Acc: 0.611 Test Loss: 1.453 Test Acc: 0.611
Validation loss decreased (-0.611096 --> -0.611097).  Saving model ...
Epoch: 32 cost time: 0.646409273147583
Epoch: 32, Steps: 12 | Train Loss: 1.212 Vali Loss: 1.424 Vali Acc: 0.594 Test Loss: 1.424 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7236042022705078
Epoch: 33, Steps: 12 | Train Loss: 1.188 Vali Loss: 1.389 Vali Acc: 0.600 Test Loss: 1.389 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.692108154296875
Epoch: 34, Steps: 12 | Train Loss: 1.149 Vali Loss: 1.363 Vali Acc: 0.622 Test Loss: 1.363 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622209).  Saving model ...
Epoch: 35 cost time: 0.6697697639465332
Epoch: 35, Steps: 12 | Train Loss: 1.097 Vali Loss: 1.327 Vali Acc: 0.628 Test Loss: 1.327 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627765).  Saving model ...
Epoch: 36 cost time: 0.6114513874053955
Epoch: 36, Steps: 12 | Train Loss: 1.061 Vali Loss: 1.296 Vali Acc: 0.617 Test Loss: 1.296 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6464645862579346
Epoch: 37, Steps: 12 | Train Loss: 1.014 Vali Loss: 1.270 Vali Acc: 0.633 Test Loss: 1.270 Test Acc: 0.633
Validation loss decreased (-0.627765 --> -0.633321).  Saving model ...
Epoch: 38 cost time: 0.5734500885009766
Epoch: 38, Steps: 12 | Train Loss: 0.968 Vali Loss: 1.246 Vali Acc: 0.633 Test Loss: 1.246 Test Acc: 0.633
Validation loss decreased (-0.633321 --> -0.633321).  Saving model ...
Epoch: 39 cost time: 0.6449897289276123
Epoch: 39, Steps: 12 | Train Loss: 0.943 Vali Loss: 1.205 Vali Acc: 0.661 Test Loss: 1.205 Test Acc: 0.661
Validation loss decreased (-0.633321 --> -0.661099).  Saving model ...
Epoch: 40 cost time: 0.722095251083374
Epoch: 40, Steps: 12 | Train Loss: 0.928 Vali Loss: 1.183 Vali Acc: 0.650 Test Loss: 1.183 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6061482429504395
Epoch: 41, Steps: 12 | Train Loss: 0.981 Vali Loss: 1.167 Vali Acc: 0.644 Test Loss: 1.167 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8447880744934082
Epoch: 42, Steps: 12 | Train Loss: 0.849 Vali Loss: 1.130 Vali Acc: 0.656 Test Loss: 1.130 Test Acc: 0.656
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7546448707580566
Epoch: 43, Steps: 12 | Train Loss: 0.801 Vali Loss: 1.108 Vali Acc: 0.661 Test Loss: 1.108 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 44 cost time: 0.6694338321685791
Epoch: 44, Steps: 12 | Train Loss: 0.759 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.592951774597168
Epoch: 45, Steps: 12 | Train Loss: 0.755 Vali Loss: 1.063 Vali Acc: 0.672 Test Loss: 1.063 Test Acc: 0.672
Validation loss decreased (-0.661100 --> -0.672212).  Saving model ...
Epoch: 46 cost time: 0.7998459339141846
Epoch: 46, Steps: 12 | Train Loss: 0.722 Vali Loss: 1.057 Vali Acc: 0.689 Test Loss: 1.057 Test Acc: 0.689
Validation loss decreased (-0.672212 --> -0.688878).  Saving model ...
Epoch: 47 cost time: 0.8631148338317871
Epoch: 47, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.042 Vali Acc: 0.700 Test Loss: 1.042 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699990).  Saving model ...
Epoch: 48 cost time: 0.804443359375
Epoch: 48, Steps: 12 | Train Loss: 0.700 Vali Loss: 1.018 Vali Acc: 0.678 Test Loss: 1.018 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8956029415130615
Epoch: 49, Steps: 12 | Train Loss: 0.656 Vali Loss: 1.004 Vali Acc: 0.678 Test Loss: 1.004 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.76009202003479
Epoch: 50, Steps: 12 | Train Loss: 0.642 Vali Loss: 1.017 Vali Acc: 0.689 Test Loss: 1.017 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7294247150421143
Epoch: 51, Steps: 12 | Train Loss: 0.613 Vali Loss: 0.992 Vali Acc: 0.689 Test Loss: 0.992 Test Acc: 0.689
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7680394649505615
Epoch: 52, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.963 Vali Acc: 0.706 Test Loss: 0.963 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 53 cost time: 0.7706725597381592
Epoch: 53, Steps: 12 | Train Loss: 0.572 Vali Loss: 0.945 Vali Acc: 0.717 Test Loss: 0.945 Test Acc: 0.717
Validation loss decreased (-0.705546 --> -0.716657).  Saving model ...
Epoch: 54 cost time: 0.7670350074768066
Epoch: 54, Steps: 12 | Train Loss: 0.594 Vali Loss: 0.968 Vali Acc: 0.717 Test Loss: 0.968 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7989096641540527
Epoch: 55, Steps: 12 | Train Loss: 0.546 Vali Loss: 0.953 Vali Acc: 0.711 Test Loss: 0.953 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7607302665710449
Epoch: 56, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.929 Vali Acc: 0.706 Test Loss: 0.929 Test Acc: 0.706
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.892974853515625
Epoch: 57, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.926 Vali Acc: 0.717 Test Loss: 0.926 Test Acc: 0.717
Validation loss decreased (-0.716657 --> -0.716657).  Saving model ...
Epoch: 58 cost time: 0.6527285575866699
Epoch: 58, Steps: 12 | Train Loss: 0.482 Vali Loss: 0.934 Vali Acc: 0.728 Test Loss: 0.934 Test Acc: 0.728
Validation loss decreased (-0.716657 --> -0.727768).  Saving model ...
Epoch: 59 cost time: 0.7535865306854248
Epoch: 59, Steps: 12 | Train Loss: 0.475 Vali Loss: 0.913 Vali Acc: 0.728 Test Loss: 0.913 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 60 cost time: 0.7648987770080566
Epoch: 60, Steps: 12 | Train Loss: 0.488 Vali Loss: 0.912 Vali Acc: 0.706 Test Loss: 0.912 Test Acc: 0.706
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8076553344726562
Epoch: 61, Steps: 12 | Train Loss: 0.458 Vali Loss: 0.909 Vali Acc: 0.717 Test Loss: 0.909 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8642864227294922
Epoch: 62, Steps: 12 | Train Loss: 0.479 Vali Loss: 0.920 Vali Acc: 0.728 Test Loss: 0.920 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8142273426055908
Epoch: 63, Steps: 12 | Train Loss: 0.447 Vali Loss: 0.909 Vali Acc: 0.733 Test Loss: 0.909 Test Acc: 0.733
Validation loss decreased (-0.727769 --> -0.733324).  Saving model ...
Epoch: 64 cost time: 0.624382734298706
Epoch: 64, Steps: 12 | Train Loss: 0.445 Vali Loss: 0.912 Vali Acc: 0.750 Test Loss: 0.912 Test Acc: 0.750
Validation loss decreased (-0.733324 --> -0.749991).  Saving model ...
Epoch: 65 cost time: 0.7650246620178223
Epoch: 65, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.903 Vali Acc: 0.711 Test Loss: 0.903 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.7077903747558594
Epoch: 66, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.917 Vali Acc: 0.744 Test Loss: 0.917 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6951179504394531
Epoch: 67, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.899 Vali Acc: 0.722 Test Loss: 0.899 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6973876953125
Epoch: 68, Steps: 12 | Train Loss: 0.453 Vali Loss: 0.912 Vali Acc: 0.739 Test Loss: 0.912 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.8405258655548096
Epoch: 69, Steps: 12 | Train Loss: 0.406 Vali Loss: 0.928 Vali Acc: 0.733 Test Loss: 0.928 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8458480834960938
Epoch: 70, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.876 Vali Acc: 0.739 Test Loss: 0.876 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.8348236083984375
Epoch: 71, Steps: 12 | Train Loss: 0.369 Vali Loss: 0.904 Vali Acc: 0.722 Test Loss: 0.904 Test Acc: 0.722
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.6949737071990967
Epoch: 72, Steps: 12 | Train Loss: 0.362 Vali Loss: 0.891 Vali Acc: 0.733 Test Loss: 0.891 Test Acc: 0.733
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.7860231399536133
Epoch: 73, Steps: 12 | Train Loss: 0.352 Vali Loss: 0.895 Vali Acc: 0.722 Test Loss: 0.895 Test Acc: 0.722
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.8922483921051025
Epoch: 74, Steps: 12 | Train Loss: 0.344 Vali Loss: 0.920 Vali Acc: 0.728 Test Loss: 0.920 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 4537
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0657200813293457
Epoch: 1, Steps: 12 | Train Loss: 2.810 Vali Loss: 2.852 Vali Acc: 0.039 Test Loss: 2.852 Test Acc: 0.039
Validation loss decreased (inf --> -0.038860).  Saving model ...
Epoch: 2 cost time: 0.7127175331115723
Epoch: 2, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.824 Vali Acc: 0.044 Test Loss: 2.824 Test Acc: 0.044
Validation loss decreased (-0.038860 --> -0.044416).  Saving model ...
Epoch: 3 cost time: 0.6740145683288574
Epoch: 3, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.787 Vali Acc: 0.061 Test Loss: 2.787 Test Acc: 0.061
Validation loss decreased (-0.044416 --> -0.061083).  Saving model ...
Epoch: 4 cost time: 0.7601325511932373
Epoch: 4, Steps: 12 | Train Loss: 2.721 Vali Loss: 2.746 Vali Acc: 0.089 Test Loss: 2.746 Test Acc: 0.089
Validation loss decreased (-0.061083 --> -0.088861).  Saving model ...
Epoch: 5 cost time: 0.87449049949646
Epoch: 5, Steps: 12 | Train Loss: 2.690 Vali Loss: 2.700 Vali Acc: 0.100 Test Loss: 2.700 Test Acc: 0.100
Validation loss decreased (-0.088861 --> -0.099973).  Saving model ...
Epoch: 6 cost time: 0.6131565570831299
Epoch: 6, Steps: 12 | Train Loss: 2.624 Vali Loss: 2.653 Vali Acc: 0.111 Test Loss: 2.653 Test Acc: 0.111
Validation loss decreased (-0.099973 --> -0.111085).  Saving model ...
Epoch: 7 cost time: 0.7598271369934082
Epoch: 7, Steps: 12 | Train Loss: 2.566 Vali Loss: 2.603 Vali Acc: 0.128 Test Loss: 2.603 Test Acc: 0.128
Validation loss decreased (-0.111085 --> -0.127752).  Saving model ...
Epoch: 8 cost time: 0.6362879276275635
Epoch: 8, Steps: 12 | Train Loss: 2.507 Vali Loss: 2.550 Vali Acc: 0.161 Test Loss: 2.550 Test Acc: 0.161
Validation loss decreased (-0.127752 --> -0.161086).  Saving model ...
Epoch: 9 cost time: 0.65968918800354
Epoch: 9, Steps: 12 | Train Loss: 2.475 Vali Loss: 2.494 Vali Acc: 0.156 Test Loss: 2.494 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8626878261566162
Epoch: 10, Steps: 12 | Train Loss: 2.393 Vali Loss: 2.442 Vali Acc: 0.183 Test Loss: 2.442 Test Acc: 0.183
Validation loss decreased (-0.161086 --> -0.183309).  Saving model ...
Epoch: 11 cost time: 0.8717460632324219
Epoch: 11, Steps: 12 | Train Loss: 2.367 Vali Loss: 2.386 Vali Acc: 0.233 Test Loss: 2.386 Test Acc: 0.233
Validation loss decreased (-0.183309 --> -0.233309).  Saving model ...
Epoch: 12 cost time: 0.7679803371429443
Epoch: 12, Steps: 12 | Train Loss: 2.299 Vali Loss: 2.331 Vali Acc: 0.261 Test Loss: 2.331 Test Acc: 0.261
Validation loss decreased (-0.233309 --> -0.261088).  Saving model ...
Epoch: 13 cost time: 0.8567492961883545
Epoch: 13, Steps: 12 | Train Loss: 2.260 Vali Loss: 2.274 Vali Acc: 0.278 Test Loss: 2.274 Test Acc: 0.278
Validation loss decreased (-0.261088 --> -0.277755).  Saving model ...
Epoch: 14 cost time: 0.856499433517456
Epoch: 14, Steps: 12 | Train Loss: 2.166 Vali Loss: 2.218 Vali Acc: 0.289 Test Loss: 2.218 Test Acc: 0.289
Validation loss decreased (-0.277755 --> -0.288867).  Saving model ...
Epoch: 15 cost time: 0.8107590675354004
Epoch: 15, Steps: 12 | Train Loss: 2.081 Vali Loss: 2.161 Vali Acc: 0.328 Test Loss: 2.161 Test Acc: 0.328
Validation loss decreased (-0.288867 --> -0.327756).  Saving model ...
Epoch: 16 cost time: 0.9439818859100342
Epoch: 16, Steps: 12 | Train Loss: 2.062 Vali Loss: 2.106 Vali Acc: 0.344 Test Loss: 2.106 Test Acc: 0.344
Validation loss decreased (-0.327756 --> -0.344423).  Saving model ...
Epoch: 17 cost time: 0.8428232669830322
Epoch: 17, Steps: 12 | Train Loss: 1.955 Vali Loss: 2.047 Vali Acc: 0.378 Test Loss: 2.047 Test Acc: 0.378
Validation loss decreased (-0.344423 --> -0.377757).  Saving model ...
Epoch: 18 cost time: 0.9305739402770996
Epoch: 18, Steps: 12 | Train Loss: 1.933 Vali Loss: 1.992 Vali Acc: 0.406 Test Loss: 1.992 Test Acc: 0.406
Validation loss decreased (-0.377757 --> -0.405536).  Saving model ...
Epoch: 19 cost time: 0.842606782913208
Epoch: 19, Steps: 12 | Train Loss: 1.862 Vali Loss: 1.941 Vali Acc: 0.450 Test Loss: 1.941 Test Acc: 0.450
Validation loss decreased (-0.405536 --> -0.449981).  Saving model ...
Epoch: 20 cost time: 0.8335442543029785
Epoch: 20, Steps: 12 | Train Loss: 1.793 Vali Loss: 1.897 Vali Acc: 0.478 Test Loss: 1.897 Test Acc: 0.478
Validation loss decreased (-0.449981 --> -0.477759).  Saving model ...
Epoch: 21 cost time: 0.6913073062896729
Epoch: 21, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.854 Vali Acc: 0.528 Test Loss: 1.854 Test Acc: 0.528
Validation loss decreased (-0.477759 --> -0.527759).  Saving model ...
Epoch: 22 cost time: 0.9563179016113281
Epoch: 22, Steps: 12 | Train Loss: 1.719 Vali Loss: 1.811 Vali Acc: 0.533 Test Loss: 1.811 Test Acc: 0.533
Validation loss decreased (-0.527759 --> -0.533315).  Saving model ...
Epoch: 23 cost time: 0.7543346881866455
Epoch: 23, Steps: 12 | Train Loss: 1.672 Vali Loss: 1.773 Vali Acc: 0.567 Test Loss: 1.773 Test Acc: 0.567
Validation loss decreased (-0.533315 --> -0.566649).  Saving model ...
Epoch: 24 cost time: 0.8230886459350586
Epoch: 24, Steps: 12 | Train Loss: 1.569 Vali Loss: 1.729 Vali Acc: 0.567 Test Loss: 1.729 Test Acc: 0.567
Validation loss decreased (-0.566649 --> -0.566649).  Saving model ...
Epoch: 25 cost time: 0.8276941776275635
Epoch: 25, Steps: 12 | Train Loss: 1.553 Vali Loss: 1.701 Vali Acc: 0.578 Test Loss: 1.701 Test Acc: 0.578
Validation loss decreased (-0.566649 --> -0.577761).  Saving model ...
Epoch: 26 cost time: 0.7901251316070557
Epoch: 26, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.666 Vali Acc: 0.578 Test Loss: 1.666 Test Acc: 0.578
Validation loss decreased (-0.577761 --> -0.577761).  Saving model ...
Epoch: 27 cost time: 0.5830695629119873
Epoch: 27, Steps: 12 | Train Loss: 1.459 Vali Loss: 1.630 Vali Acc: 0.600 Test Loss: 1.630 Test Acc: 0.600
Validation loss decreased (-0.577761 --> -0.599984).  Saving model ...
Epoch: 28 cost time: 0.9836392402648926
Epoch: 28, Steps: 12 | Train Loss: 1.428 Vali Loss: 1.598 Vali Acc: 0.600 Test Loss: 1.598 Test Acc: 0.600
Validation loss decreased (-0.599984 --> -0.599984).  Saving model ...
Epoch: 29 cost time: 0.9330158233642578
Epoch: 29, Steps: 12 | Train Loss: 1.412 Vali Loss: 1.562 Vali Acc: 0.611 Test Loss: 1.562 Test Acc: 0.611
Validation loss decreased (-0.599984 --> -0.611095).  Saving model ...
Epoch: 30 cost time: 0.9437329769134521
Epoch: 30, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.527 Vali Acc: 0.600 Test Loss: 1.527 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8790805339813232
Epoch: 31, Steps: 12 | Train Loss: 1.377 Vali Loss: 1.507 Vali Acc: 0.589 Test Loss: 1.507 Test Acc: 0.589
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8704936504364014
Epoch: 32, Steps: 12 | Train Loss: 1.310 Vali Loss: 1.481 Vali Acc: 0.606 Test Loss: 1.481 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6685538291931152
Epoch: 33, Steps: 12 | Train Loss: 1.221 Vali Loss: 1.460 Vali Acc: 0.611 Test Loss: 1.460 Test Acc: 0.611
Validation loss decreased (-0.611095 --> -0.611097).  Saving model ...
Epoch: 34 cost time: 0.99971604347229
Epoch: 34, Steps: 12 | Train Loss: 1.254 Vali Loss: 1.438 Vali Acc: 0.622 Test Loss: 1.438 Test Acc: 0.622
Validation loss decreased (-0.611097 --> -0.622208).  Saving model ...
Epoch: 35 cost time: 0.7821404933929443
Epoch: 35, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.416 Vali Acc: 0.622 Test Loss: 1.416 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622208).  Saving model ...
Epoch: 36 cost time: 0.7986607551574707
Epoch: 36, Steps: 12 | Train Loss: 1.209 Vali Loss: 1.403 Vali Acc: 0.617 Test Loss: 1.403 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7009627819061279
Epoch: 37, Steps: 12 | Train Loss: 1.190 Vali Loss: 1.386 Vali Acc: 0.600 Test Loss: 1.386 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6430675983428955
Epoch: 38, Steps: 12 | Train Loss: 1.086 Vali Loss: 1.365 Vali Acc: 0.622 Test Loss: 1.365 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 39 cost time: 0.7161233425140381
Epoch: 39, Steps: 12 | Train Loss: 1.146 Vali Loss: 1.347 Vali Acc: 0.633 Test Loss: 1.347 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633320).  Saving model ...
Epoch: 40 cost time: 0.8331928253173828
Epoch: 40, Steps: 12 | Train Loss: 1.066 Vali Loss: 1.308 Vali Acc: 0.644 Test Loss: 1.308 Test Acc: 0.644
Validation loss decreased (-0.633320 --> -0.644431).  Saving model ...
Epoch: 41 cost time: 0.7915995121002197
Epoch: 41, Steps: 12 | Train Loss: 1.091 Vali Loss: 1.298 Vali Acc: 0.644 Test Loss: 1.298 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 42 cost time: 0.8195474147796631
Epoch: 42, Steps: 12 | Train Loss: 1.050 Vali Loss: 1.273 Vali Acc: 0.650 Test Loss: 1.273 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 43 cost time: 0.9300813674926758
Epoch: 43, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.258 Vali Acc: 0.656 Test Loss: 1.258 Test Acc: 0.656
Validation loss decreased (-0.649987 --> -0.655543).  Saving model ...
Epoch: 44 cost time: 0.7564222812652588
Epoch: 44, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.251 Vali Acc: 0.644 Test Loss: 1.251 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6855709552764893
Epoch: 45, Steps: 12 | Train Loss: 0.967 Vali Loss: 1.239 Vali Acc: 0.644 Test Loss: 1.239 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7605001926422119
Epoch: 46, Steps: 12 | Train Loss: 0.959 Vali Loss: 1.231 Vali Acc: 0.650 Test Loss: 1.231 Test Acc: 0.650
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8997070789337158
Epoch: 47, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.217 Vali Acc: 0.661 Test Loss: 1.217 Test Acc: 0.661
Validation loss decreased (-0.655543 --> -0.661099).  Saving model ...
Epoch: 48 cost time: 0.8114898204803467
Epoch: 48, Steps: 12 | Train Loss: 0.901 Vali Loss: 1.212 Vali Acc: 0.667 Test Loss: 1.212 Test Acc: 0.667
Validation loss decreased (-0.661099 --> -0.666655).  Saving model ...
Epoch: 49 cost time: 0.9657847881317139
Epoch: 49, Steps: 12 | Train Loss: 0.956 Vali Loss: 1.203 Vali Acc: 0.667 Test Loss: 1.203 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 50 cost time: 0.9418766498565674
Epoch: 50, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.189 Vali Acc: 0.667 Test Loss: 1.189 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 51 cost time: 0.9105572700500488
Epoch: 51, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.178 Vali Acc: 0.667 Test Loss: 1.178 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 52 cost time: 0.7758004665374756
Epoch: 52, Steps: 12 | Train Loss: 0.882 Vali Loss: 1.181 Vali Acc: 0.678 Test Loss: 1.181 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 53 cost time: 0.7317640781402588
Epoch: 53, Steps: 12 | Train Loss: 0.813 Vali Loss: 1.177 Vali Acc: 0.672 Test Loss: 1.177 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8930490016937256
Epoch: 54, Steps: 12 | Train Loss: 0.823 Vali Loss: 1.168 Vali Acc: 0.672 Test Loss: 1.168 Test Acc: 0.672
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.1235034465789795
Epoch: 55, Steps: 12 | Train Loss: 0.791 Vali Loss: 1.160 Vali Acc: 0.667 Test Loss: 1.160 Test Acc: 0.667
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9081301689147949
Epoch: 56, Steps: 12 | Train Loss: 0.769 Vali Loss: 1.159 Vali Acc: 0.667 Test Loss: 1.159 Test Acc: 0.667
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.7686479091644287
Epoch: 57, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.146 Vali Acc: 0.672 Test Loss: 1.146 Test Acc: 0.672
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.6974055767059326
Epoch: 58, Steps: 12 | Train Loss: 0.766 Vali Loss: 1.143 Vali Acc: 0.678 Test Loss: 1.143 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 59 cost time: 1.0222272872924805
Epoch: 59, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.130 Vali Acc: 0.678 Test Loss: 1.130 Test Acc: 0.678
Validation loss decreased (-0.677766 --> -0.677766).  Saving model ...
Epoch: 60 cost time: 0.881676197052002
Epoch: 60, Steps: 12 | Train Loss: 0.736 Vali Loss: 1.122 Vali Acc: 0.683 Test Loss: 1.122 Test Acc: 0.683
Validation loss decreased (-0.677766 --> -0.683322).  Saving model ...
Epoch: 61 cost time: 0.7139575481414795
Epoch: 61, Steps: 12 | Train Loss: 0.744 Vali Loss: 1.116 Vali Acc: 0.683 Test Loss: 1.116 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 62 cost time: 0.758298397064209
Epoch: 62, Steps: 12 | Train Loss: 0.747 Vali Loss: 1.116 Vali Acc: 0.678 Test Loss: 1.116 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.9422504901885986
Epoch: 63, Steps: 12 | Train Loss: 0.676 Vali Loss: 1.107 Vali Acc: 0.683 Test Loss: 1.107 Test Acc: 0.683
Validation loss decreased (-0.683322 --> -0.683322).  Saving model ...
Epoch: 64 cost time: 0.6914477348327637
Epoch: 64, Steps: 12 | Train Loss: 0.679 Vali Loss: 1.108 Vali Acc: 0.689 Test Loss: 1.108 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688878).  Saving model ...
Epoch: 65 cost time: 0.8672804832458496
Epoch: 65, Steps: 12 | Train Loss: 0.667 Vali Loss: 1.096 Vali Acc: 0.700 Test Loss: 1.096 Test Acc: 0.700
Validation loss decreased (-0.688878 --> -0.699989).  Saving model ...
Epoch: 66 cost time: 0.7682864665985107
Epoch: 66, Steps: 12 | Train Loss: 0.672 Vali Loss: 1.095 Vali Acc: 0.694 Test Loss: 1.095 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7388074398040771
Epoch: 67, Steps: 12 | Train Loss: 0.649 Vali Loss: 1.098 Vali Acc: 0.694 Test Loss: 1.098 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7968683242797852
Epoch: 68, Steps: 12 | Train Loss: 0.717 Vali Loss: 1.095 Vali Acc: 0.689 Test Loss: 1.095 Test Acc: 0.689
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8539416790008545
Epoch: 69, Steps: 12 | Train Loss: 0.633 Vali Loss: 1.083 Vali Acc: 0.706 Test Loss: 1.083 Test Acc: 0.706
Validation loss decreased (-0.699989 --> -0.705545).  Saving model ...
Epoch: 70 cost time: 0.8615992069244385
Epoch: 70, Steps: 12 | Train Loss: 0.644 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8769242763519287
Epoch: 71, Steps: 12 | Train Loss: 0.619 Vali Loss: 1.088 Vali Acc: 0.694 Test Loss: 1.088 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.00177001953125
Epoch: 72, Steps: 12 | Train Loss: 0.597 Vali Loss: 1.092 Vali Acc: 0.694 Test Loss: 1.092 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.9517488479614258
Epoch: 73, Steps: 12 | Train Loss: 0.653 Vali Loss: 1.088 Vali Acc: 0.694 Test Loss: 1.088 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8330719470977783
Epoch: 74, Steps: 12 | Train Loss: 0.594 Vali Loss: 1.072 Vali Acc: 0.694 Test Loss: 1.072 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.9321715831756592
Epoch: 75, Steps: 12 | Train Loss: 0.562 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.8720824718475342
Epoch: 76, Steps: 12 | Train Loss: 0.553 Vali Loss: 1.079 Vali Acc: 0.706 Test Loss: 1.079 Test Acc: 0.706
Validation loss decreased (-0.705545 --> -0.705545).  Saving model ...
Epoch: 77 cost time: 0.9948055744171143
Epoch: 77, Steps: 12 | Train Loss: 0.643 Vali Loss: 1.081 Vali Acc: 0.700 Test Loss: 1.081 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.9426181316375732
Epoch: 78, Steps: 12 | Train Loss: 0.539 Vali Loss: 1.079 Vali Acc: 0.711 Test Loss: 1.079 Test Acc: 0.711
Validation loss decreased (-0.705545 --> -0.711100).  Saving model ...
Epoch: 79 cost time: 0.8969545364379883
Epoch: 79, Steps: 12 | Train Loss: 0.508 Vali Loss: 1.086 Vali Acc: 0.700 Test Loss: 1.086 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.6632769107818604
Epoch: 80, Steps: 12 | Train Loss: 0.502 Vali Loss: 1.083 Vali Acc: 0.717 Test Loss: 1.083 Test Acc: 0.717
Validation loss decreased (-0.711100 --> -0.716656).  Saving model ...
Epoch: 81 cost time: 0.6783356666564941
Epoch: 81, Steps: 12 | Train Loss: 0.484 Vali Loss: 1.092 Vali Acc: 0.694 Test Loss: 1.092 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.8767664432525635
Epoch: 82, Steps: 12 | Train Loss: 0.480 Vali Loss: 1.104 Vali Acc: 0.689 Test Loss: 1.104 Test Acc: 0.689
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.9464247226715088
Epoch: 83, Steps: 12 | Train Loss: 0.463 Vali Loss: 1.113 Vali Acc: 0.694 Test Loss: 1.113 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7741413116455078
Epoch: 84, Steps: 12 | Train Loss: 0.436 Vali Loss: 1.125 Vali Acc: 0.678 Test Loss: 1.125 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.8351879119873047
Epoch: 85, Steps: 12 | Train Loss: 0.427 Vali Loss: 1.144 Vali Acc: 0.711 Test Loss: 1.144 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.6348443031311035
Epoch: 86, Steps: 12 | Train Loss: 0.416 Vali Loss: 1.151 Vali Acc: 0.711 Test Loss: 1.151 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.6887481212615967
Epoch: 87, Steps: 12 | Train Loss: 0.431 Vali Loss: 1.185 Vali Acc: 0.717 Test Loss: 1.185 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 1.021195650100708
Epoch: 88, Steps: 12 | Train Loss: 0.376 Vali Loss: 1.191 Vali Acc: 0.722 Test Loss: 1.191 Test Acc: 0.722
Validation loss decreased (-0.716656 --> -0.722210).  Saving model ...
Epoch: 89 cost time: 0.6594603061676025
Epoch: 89, Steps: 12 | Train Loss: 0.416 Vali Loss: 1.204 Vali Acc: 0.728 Test Loss: 1.204 Test Acc: 0.728
Validation loss decreased (-0.722210 --> -0.727766).  Saving model ...
Epoch: 90 cost time: 0.9980621337890625
Epoch: 90, Steps: 12 | Train Loss: 0.384 Vali Loss: 1.238 Vali Acc: 0.722 Test Loss: 1.238 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9222595691680908
Epoch: 91, Steps: 12 | Train Loss: 0.341 Vali Loss: 1.250 Vali Acc: 0.733 Test Loss: 1.250 Test Acc: 0.733
Validation loss decreased (-0.727766 --> -0.733321).  Saving model ...
Epoch: 92 cost time: 0.7137765884399414
Epoch: 92, Steps: 12 | Train Loss: 0.326 Vali Loss: 1.260 Vali Acc: 0.717 Test Loss: 1.260 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.6817588806152344
Epoch: 93, Steps: 12 | Train Loss: 0.316 Vali Loss: 1.290 Vali Acc: 0.733 Test Loss: 1.290 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.7107832431793213
Epoch: 94, Steps: 12 | Train Loss: 0.299 Vali Loss: 1.316 Vali Acc: 0.733 Test Loss: 1.316 Test Acc: 0.733
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.8899111747741699
Epoch: 95, Steps: 12 | Train Loss: 0.310 Vali Loss: 1.340 Vali Acc: 0.744 Test Loss: 1.340 Test Acc: 0.744
Validation loss decreased (-0.733321 --> -0.744431).  Saving model ...
Epoch: 96 cost time: 0.8131618499755859
Epoch: 96, Steps: 12 | Train Loss: 0.309 Vali Loss: 1.339 Vali Acc: 0.717 Test Loss: 1.339 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8972311019897461
Epoch: 97, Steps: 12 | Train Loss: 0.279 Vali Loss: 1.395 Vali Acc: 0.739 Test Loss: 1.395 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8550517559051514
Epoch: 98, Steps: 12 | Train Loss: 0.282 Vali Loss: 1.444 Vali Acc: 0.744 Test Loss: 1.444 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.9677152633666992
Epoch: 99, Steps: 12 | Train Loss: 0.260 Vali Loss: 1.443 Vali Acc: 0.750 Test Loss: 1.443 Test Acc: 0.750
Validation loss decreased (-0.744431 --> -0.749986).  Saving model ...
Epoch: 100 cost time: 0.7051541805267334
Epoch: 100, Steps: 12 | Train Loss: 0.258 Vali Loss: 1.463 Vali Acc: 0.761 Test Loss: 1.463 Test Acc: 0.761
Validation loss decreased (-0.749986 --> -0.761096).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 4378
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.4145944118499756
Epoch: 1, Steps: 12 | Train Loss: 2.821 Vali Loss: 2.845 Vali Acc: 0.089 Test Loss: 2.845 Test Acc: 0.089
Validation loss decreased (inf --> -0.088860).  Saving model ...
Epoch: 2 cost time: 0.7095258235931396
Epoch: 2, Steps: 12 | Train Loss: 2.786 Vali Loss: 2.819 Vali Acc: 0.089 Test Loss: 2.819 Test Acc: 0.089
Validation loss decreased (-0.088860 --> -0.088861).  Saving model ...
Epoch: 3 cost time: 0.5642898082733154
Epoch: 3, Steps: 12 | Train Loss: 2.784 Vali Loss: 2.784 Vali Acc: 0.106 Test Loss: 2.784 Test Acc: 0.106
Validation loss decreased (-0.088861 --> -0.105528).  Saving model ...
Epoch: 4 cost time: 0.7020351886749268
Epoch: 4, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.741 Vali Acc: 0.117 Test Loss: 2.741 Test Acc: 0.117
Validation loss decreased (-0.105528 --> -0.116639).  Saving model ...
Epoch: 5 cost time: 0.776827335357666
Epoch: 5, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.699 Vali Acc: 0.128 Test Loss: 2.699 Test Acc: 0.128
Validation loss decreased (-0.116639 --> -0.127751).  Saving model ...
Epoch: 6 cost time: 0.7683184146881104
Epoch: 6, Steps: 12 | Train Loss: 2.610 Vali Loss: 2.647 Vali Acc: 0.156 Test Loss: 2.647 Test Acc: 0.156
Validation loss decreased (-0.127751 --> -0.155529).  Saving model ...
Epoch: 7 cost time: 0.9745926856994629
Epoch: 7, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.600 Vali Acc: 0.156 Test Loss: 2.600 Test Acc: 0.156
Validation loss decreased (-0.155529 --> -0.155530).  Saving model ...
Epoch: 8 cost time: 0.7912399768829346
Epoch: 8, Steps: 12 | Train Loss: 2.526 Vali Loss: 2.543 Vali Acc: 0.178 Test Loss: 2.543 Test Acc: 0.178
Validation loss decreased (-0.155530 --> -0.177752).  Saving model ...
Epoch: 9 cost time: 0.7088773250579834
Epoch: 9, Steps: 12 | Train Loss: 2.479 Vali Loss: 2.494 Vali Acc: 0.206 Test Loss: 2.494 Test Acc: 0.206
Validation loss decreased (-0.177752 --> -0.205531).  Saving model ...
Epoch: 10 cost time: 0.73777174949646
Epoch: 10, Steps: 12 | Train Loss: 2.432 Vali Loss: 2.440 Vali Acc: 0.250 Test Loss: 2.440 Test Acc: 0.250
Validation loss decreased (-0.205531 --> -0.249976).  Saving model ...
Epoch: 11 cost time: 0.6594469547271729
Epoch: 11, Steps: 12 | Train Loss: 2.350 Vali Loss: 2.385 Vali Acc: 0.322 Test Loss: 2.385 Test Acc: 0.322
Validation loss decreased (-0.249976 --> -0.322198).  Saving model ...
Epoch: 12 cost time: 0.6877918243408203
Epoch: 12, Steps: 12 | Train Loss: 2.292 Vali Loss: 2.329 Vali Acc: 0.378 Test Loss: 2.329 Test Acc: 0.378
Validation loss decreased (-0.322198 --> -0.377754).  Saving model ...
Epoch: 13 cost time: 0.7538115978240967
Epoch: 13, Steps: 12 | Train Loss: 2.231 Vali Loss: 2.270 Vali Acc: 0.394 Test Loss: 2.270 Test Acc: 0.394
Validation loss decreased (-0.377754 --> -0.394422).  Saving model ...
Epoch: 14 cost time: 0.892242431640625
Epoch: 14, Steps: 12 | Train Loss: 2.192 Vali Loss: 2.215 Vali Acc: 0.400 Test Loss: 2.215 Test Acc: 0.400
Validation loss decreased (-0.394422 --> -0.399978).  Saving model ...
Epoch: 15 cost time: 0.6035706996917725
Epoch: 15, Steps: 12 | Train Loss: 2.109 Vali Loss: 2.155 Vali Acc: 0.417 Test Loss: 2.155 Test Acc: 0.417
Validation loss decreased (-0.399978 --> -0.416645).  Saving model ...
Epoch: 16 cost time: 0.8164749145507812
Epoch: 16, Steps: 12 | Train Loss: 2.037 Vali Loss: 2.097 Vali Acc: 0.456 Test Loss: 2.097 Test Acc: 0.456
Validation loss decreased (-0.416645 --> -0.455535).  Saving model ...
Epoch: 17 cost time: 0.6511518955230713
Epoch: 17, Steps: 12 | Train Loss: 1.987 Vali Loss: 2.045 Vali Acc: 0.483 Test Loss: 2.045 Test Acc: 0.483
Validation loss decreased (-0.455535 --> -0.483313).  Saving model ...
Epoch: 18 cost time: 0.6102049350738525
Epoch: 18, Steps: 12 | Train Loss: 1.928 Vali Loss: 1.988 Vali Acc: 0.506 Test Loss: 1.988 Test Acc: 0.506
Validation loss decreased (-0.483313 --> -0.505536).  Saving model ...
Epoch: 19 cost time: 0.6435859203338623
Epoch: 19, Steps: 12 | Train Loss: 1.813 Vali Loss: 1.932 Vali Acc: 0.528 Test Loss: 1.932 Test Acc: 0.528
Validation loss decreased (-0.505536 --> -0.527758).  Saving model ...
Epoch: 20 cost time: 0.7515971660614014
Epoch: 20, Steps: 12 | Train Loss: 1.803 Vali Loss: 1.881 Vali Acc: 0.556 Test Loss: 1.881 Test Acc: 0.556
Validation loss decreased (-0.527758 --> -0.555537).  Saving model ...
Epoch: 21 cost time: 0.6480245590209961
Epoch: 21, Steps: 12 | Train Loss: 1.734 Vali Loss: 1.842 Vali Acc: 0.572 Test Loss: 1.842 Test Acc: 0.572
Validation loss decreased (-0.555537 --> -0.572204).  Saving model ...
Epoch: 22 cost time: 0.7238337993621826
Epoch: 22, Steps: 12 | Train Loss: 1.661 Vali Loss: 1.803 Vali Acc: 0.583 Test Loss: 1.803 Test Acc: 0.583
Validation loss decreased (-0.572204 --> -0.583315).  Saving model ...
Epoch: 23 cost time: 0.7163960933685303
Epoch: 23, Steps: 12 | Train Loss: 1.635 Vali Loss: 1.768 Vali Acc: 0.567 Test Loss: 1.768 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6657743453979492
Epoch: 24, Steps: 12 | Train Loss: 1.556 Vali Loss: 1.726 Vali Acc: 0.589 Test Loss: 1.726 Test Acc: 0.589
Validation loss decreased (-0.583315 --> -0.588872).  Saving model ...
Epoch: 25 cost time: 0.6955935955047607
Epoch: 25, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.694 Vali Acc: 0.594 Test Loss: 1.694 Test Acc: 0.594
Validation loss decreased (-0.588872 --> -0.594428).  Saving model ...
Epoch: 26 cost time: 0.7741096019744873
Epoch: 26, Steps: 12 | Train Loss: 1.503 Vali Loss: 1.661 Vali Acc: 0.600 Test Loss: 1.661 Test Acc: 0.600
Validation loss decreased (-0.594428 --> -0.599983).  Saving model ...
Epoch: 27 cost time: 0.6323554515838623
Epoch: 27, Steps: 12 | Train Loss: 1.462 Vali Loss: 1.627 Vali Acc: 0.594 Test Loss: 1.627 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6368048191070557
Epoch: 28, Steps: 12 | Train Loss: 1.404 Vali Loss: 1.597 Vali Acc: 0.583 Test Loss: 1.597 Test Acc: 0.583
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6882703304290771
Epoch: 29, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.560 Vali Acc: 0.578 Test Loss: 1.560 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7109673023223877
Epoch: 30, Steps: 12 | Train Loss: 1.289 Vali Loss: 1.542 Vali Acc: 0.567 Test Loss: 1.542 Test Acc: 0.567
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8570938110351562
Epoch: 31, Steps: 12 | Train Loss: 1.288 Vali Loss: 1.510 Vali Acc: 0.572 Test Loss: 1.510 Test Acc: 0.572
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8040163516998291
Epoch: 32, Steps: 12 | Train Loss: 1.240 Vali Loss: 1.480 Vali Acc: 0.567 Test Loss: 1.480 Test Acc: 0.567
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6691718101501465
Epoch: 33, Steps: 12 | Train Loss: 1.191 Vali Loss: 1.455 Vali Acc: 0.583 Test Loss: 1.455 Test Acc: 0.583
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8220388889312744
Epoch: 34, Steps: 12 | Train Loss: 1.134 Vali Loss: 1.429 Vali Acc: 0.578 Test Loss: 1.429 Test Acc: 0.578
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6785485744476318
Epoch: 35, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.412 Vali Acc: 0.572 Test Loss: 1.412 Test Acc: 0.572
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8314704895019531
Epoch: 36, Steps: 12 | Train Loss: 1.122 Vali Loss: 1.383 Vali Acc: 0.594 Test Loss: 1.383 Test Acc: 0.594
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.6
model parameter : 4483
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.319120407104492
Epoch: 1, Steps: 12 | Train Loss: 2.729 Vali Loss: 2.655 Vali Acc: 0.128 Test Loss: 2.655 Test Acc: 0.128
Validation loss decreased (inf --> -0.127751).  Saving model ...
Epoch: 2 cost time: 0.7539894580841064
Epoch: 2, Steps: 12 | Train Loss: 2.714 Vali Loss: 2.630 Vali Acc: 0.139 Test Loss: 2.630 Test Acc: 0.139
Validation loss decreased (-0.127751 --> -0.138863).  Saving model ...
Epoch: 3 cost time: 0.6573882102966309
Epoch: 3, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.597 Vali Acc: 0.161 Test Loss: 2.597 Test Acc: 0.161
Validation loss decreased (-0.138863 --> -0.161085).  Saving model ...
Epoch: 4 cost time: 0.731980562210083
Epoch: 4, Steps: 12 | Train Loss: 2.634 Vali Loss: 2.557 Vali Acc: 0.189 Test Loss: 2.557 Test Acc: 0.189
Validation loss decreased (-0.161085 --> -0.188863).  Saving model ...
Epoch: 5 cost time: 0.8073761463165283
Epoch: 5, Steps: 12 | Train Loss: 2.595 Vali Loss: 2.515 Vali Acc: 0.222 Test Loss: 2.515 Test Acc: 0.222
Validation loss decreased (-0.188863 --> -0.222197).  Saving model ...
Epoch: 6 cost time: 0.7306370735168457
Epoch: 6, Steps: 12 | Train Loss: 2.561 Vali Loss: 2.469 Vali Acc: 0.261 Test Loss: 2.469 Test Acc: 0.261
Validation loss decreased (-0.222197 --> -0.261086).  Saving model ...
Epoch: 7 cost time: 0.5892152786254883
Epoch: 7, Steps: 12 | Train Loss: 2.486 Vali Loss: 2.422 Vali Acc: 0.317 Test Loss: 2.422 Test Acc: 0.317
Validation loss decreased (-0.261086 --> -0.316642).  Saving model ...
Epoch: 8 cost time: 0.8655431270599365
Epoch: 8, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.374 Vali Acc: 0.350 Test Loss: 2.374 Test Acc: 0.350
Validation loss decreased (-0.316642 --> -0.349976).  Saving model ...
Epoch: 9 cost time: 0.7781383991241455
Epoch: 9, Steps: 12 | Train Loss: 2.400 Vali Loss: 2.323 Vali Acc: 0.372 Test Loss: 2.323 Test Acc: 0.372
Validation loss decreased (-0.349976 --> -0.372199).  Saving model ...
Epoch: 10 cost time: 0.7360227108001709
Epoch: 10, Steps: 12 | Train Loss: 2.308 Vali Loss: 2.272 Vali Acc: 0.400 Test Loss: 2.272 Test Acc: 0.400
Validation loss decreased (-0.372199 --> -0.399977).  Saving model ...
Epoch: 11 cost time: 0.8296670913696289
Epoch: 11, Steps: 12 | Train Loss: 2.268 Vali Loss: 2.221 Vali Acc: 0.428 Test Loss: 2.221 Test Acc: 0.428
Validation loss decreased (-0.399977 --> -0.427756).  Saving model ...
Epoch: 12 cost time: 0.8313322067260742
Epoch: 12, Steps: 12 | Train Loss: 2.201 Vali Loss: 2.168 Vali Acc: 0.450 Test Loss: 2.168 Test Acc: 0.450
Validation loss decreased (-0.427756 --> -0.449978).  Saving model ...
Epoch: 13 cost time: 0.8008816242218018
Epoch: 13, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.118 Vali Acc: 0.467 Test Loss: 2.118 Test Acc: 0.467
Validation loss decreased (-0.449978 --> -0.466645).  Saving model ...
Epoch: 14 cost time: 0.6982822418212891
Epoch: 14, Steps: 12 | Train Loss: 2.034 Vali Loss: 2.069 Vali Acc: 0.472 Test Loss: 2.069 Test Acc: 0.472
Validation loss decreased (-0.466645 --> -0.472202).  Saving model ...
Epoch: 15 cost time: 0.6523144245147705
Epoch: 15, Steps: 12 | Train Loss: 1.959 Vali Loss: 2.017 Vali Acc: 0.489 Test Loss: 2.017 Test Acc: 0.489
Validation loss decreased (-0.472202 --> -0.488869).  Saving model ...
Epoch: 16 cost time: 0.7095203399658203
Epoch: 16, Steps: 12 | Train Loss: 1.957 Vali Loss: 1.969 Vali Acc: 0.489 Test Loss: 1.969 Test Acc: 0.489
Validation loss decreased (-0.488869 --> -0.488869).  Saving model ...
Epoch: 17 cost time: 0.7539207935333252
Epoch: 17, Steps: 12 | Train Loss: 1.845 Vali Loss: 1.926 Vali Acc: 0.494 Test Loss: 1.926 Test Acc: 0.494
Validation loss decreased (-0.488869 --> -0.494425).  Saving model ...
Epoch: 18 cost time: 0.7429230213165283
Epoch: 18, Steps: 12 | Train Loss: 1.828 Vali Loss: 1.884 Vali Acc: 0.489 Test Loss: 1.884 Test Acc: 0.489
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9268920421600342
Epoch: 19, Steps: 12 | Train Loss: 1.802 Vali Loss: 1.845 Vali Acc: 0.494 Test Loss: 1.845 Test Acc: 0.494
Validation loss decreased (-0.494425 --> -0.494426).  Saving model ...
Epoch: 20 cost time: 0.8640716075897217
Epoch: 20, Steps: 12 | Train Loss: 1.756 Vali Loss: 1.804 Vali Acc: 0.506 Test Loss: 1.804 Test Acc: 0.506
Validation loss decreased (-0.494426 --> -0.505538).  Saving model ...
Epoch: 21 cost time: 0.744797945022583
Epoch: 21, Steps: 12 | Train Loss: 1.636 Vali Loss: 1.766 Vali Acc: 0.539 Test Loss: 1.766 Test Acc: 0.539
Validation loss decreased (-0.505538 --> -0.538871).  Saving model ...
Epoch: 22 cost time: 0.6067438125610352
Epoch: 22, Steps: 12 | Train Loss: 1.616 Vali Loss: 1.731 Vali Acc: 0.544 Test Loss: 1.731 Test Acc: 0.544
Validation loss decreased (-0.538871 --> -0.544427).  Saving model ...
Epoch: 23 cost time: 0.7394168376922607
Epoch: 23, Steps: 12 | Train Loss: 1.593 Vali Loss: 1.700 Vali Acc: 0.556 Test Loss: 1.700 Test Acc: 0.556
Validation loss decreased (-0.544427 --> -0.555539).  Saving model ...
Epoch: 24 cost time: 0.7257955074310303
Epoch: 24, Steps: 12 | Train Loss: 1.508 Vali Loss: 1.661 Vali Acc: 0.567 Test Loss: 1.661 Test Acc: 0.567
Validation loss decreased (-0.555539 --> -0.566650).  Saving model ...
Epoch: 25 cost time: 0.7049200534820557
Epoch: 25, Steps: 12 | Train Loss: 1.501 Vali Loss: 1.628 Vali Acc: 0.578 Test Loss: 1.628 Test Acc: 0.578
Validation loss decreased (-0.566650 --> -0.577761).  Saving model ...
Epoch: 26 cost time: 0.7211182117462158
Epoch: 26, Steps: 12 | Train Loss: 1.460 Vali Loss: 1.596 Vali Acc: 0.567 Test Loss: 1.596 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8162305355072021
Epoch: 27, Steps: 12 | Train Loss: 1.403 Vali Loss: 1.575 Vali Acc: 0.578 Test Loss: 1.575 Test Acc: 0.578
Validation loss decreased (-0.577761 --> -0.577762).  Saving model ...
Epoch: 28 cost time: 0.9166693687438965
Epoch: 28, Steps: 12 | Train Loss: 1.371 Vali Loss: 1.547 Vali Acc: 0.594 Test Loss: 1.547 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594429).  Saving model ...
Epoch: 29 cost time: 0.6929879188537598
Epoch: 29, Steps: 12 | Train Loss: 1.342 Vali Loss: 1.517 Vali Acc: 0.594 Test Loss: 1.517 Test Acc: 0.594
Validation loss decreased (-0.594429 --> -0.594429).  Saving model ...
Epoch: 30 cost time: 0.7280290126800537
Epoch: 30, Steps: 12 | Train Loss: 1.320 Vali Loss: 1.492 Vali Acc: 0.622 Test Loss: 1.492 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622207).  Saving model ...
Epoch: 31 cost time: 0.711801290512085
Epoch: 31, Steps: 12 | Train Loss: 1.225 Vali Loss: 1.457 Vali Acc: 0.633 Test Loss: 1.457 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633319).  Saving model ...
Epoch: 32 cost time: 0.6881406307220459
Epoch: 32, Steps: 12 | Train Loss: 1.236 Vali Loss: 1.438 Vali Acc: 0.633 Test Loss: 1.438 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 33 cost time: 0.6824045181274414
Epoch: 33, Steps: 12 | Train Loss: 1.178 Vali Loss: 1.409 Vali Acc: 0.633 Test Loss: 1.409 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 34 cost time: 0.7089228630065918
Epoch: 34, Steps: 12 | Train Loss: 1.123 Vali Loss: 1.374 Vali Acc: 0.644 Test Loss: 1.374 Test Acc: 0.644
Validation loss decreased (-0.633319 --> -0.644431).  Saving model ...
Epoch: 35 cost time: 0.7954490184783936
Epoch: 35, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.342 Vali Acc: 0.650 Test Loss: 1.342 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 36 cost time: 0.9022531509399414
Epoch: 36, Steps: 12 | Train Loss: 1.076 Vali Loss: 1.304 Vali Acc: 0.661 Test Loss: 1.304 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661098).  Saving model ...
Epoch: 37 cost time: 0.7236626148223877
Epoch: 37, Steps: 12 | Train Loss: 1.024 Vali Loss: 1.263 Vali Acc: 0.650 Test Loss: 1.263 Test Acc: 0.650
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6108245849609375
Epoch: 38, Steps: 12 | Train Loss: 1.038 Vali Loss: 1.238 Vali Acc: 0.644 Test Loss: 1.238 Test Acc: 0.644
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6457877159118652
Epoch: 39, Steps: 12 | Train Loss: 0.971 Vali Loss: 1.201 Vali Acc: 0.667 Test Loss: 1.201 Test Acc: 0.667
Validation loss decreased (-0.661098 --> -0.666655).  Saving model ...
Epoch: 40 cost time: 0.6350951194763184
Epoch: 40, Steps: 12 | Train Loss: 0.909 Vali Loss: 1.175 Vali Acc: 0.667 Test Loss: 1.175 Test Acc: 0.667
Validation loss decreased (-0.666655 --> -0.666655).  Saving model ...
Epoch: 41 cost time: 0.6234209537506104
Epoch: 41, Steps: 12 | Train Loss: 0.910 Vali Loss: 1.147 Vali Acc: 0.678 Test Loss: 1.147 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677766).  Saving model ...
Epoch: 42 cost time: 0.8216474056243896
Epoch: 42, Steps: 12 | Train Loss: 0.888 Vali Loss: 1.105 Vali Acc: 0.700 Test Loss: 1.105 Test Acc: 0.700
Validation loss decreased (-0.677766 --> -0.699989).  Saving model ...
Epoch: 43 cost time: 0.6812961101531982
Epoch: 43, Steps: 12 | Train Loss: 0.859 Vali Loss: 1.077 Vali Acc: 0.694 Test Loss: 1.077 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6845643520355225
Epoch: 44, Steps: 12 | Train Loss: 0.826 Vali Loss: 1.052 Vali Acc: 0.700 Test Loss: 1.052 Test Acc: 0.700
Validation loss decreased (-0.699989 --> -0.699989).  Saving model ...
Epoch: 45 cost time: 0.625974178314209
Epoch: 45, Steps: 12 | Train Loss: 0.751 Vali Loss: 1.012 Vali Acc: 0.728 Test Loss: 1.012 Test Acc: 0.728
Validation loss decreased (-0.699989 --> -0.727768).  Saving model ...
Epoch: 46 cost time: 0.5748906135559082
Epoch: 46, Steps: 12 | Train Loss: 0.782 Vali Loss: 0.979 Vali Acc: 0.722 Test Loss: 0.979 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5078966617584229
Epoch: 47, Steps: 12 | Train Loss: 0.706 Vali Loss: 0.935 Vali Acc: 0.711 Test Loss: 0.935 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6269900798797607
Epoch: 48, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.901 Vali Acc: 0.717 Test Loss: 0.901 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.6824896335601807
Epoch: 49, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.869 Vali Acc: 0.722 Test Loss: 0.869 Test Acc: 0.722
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.7757678031921387
Epoch: 50, Steps: 12 | Train Loss: 0.606 Vali Loss: 0.838 Vali Acc: 0.722 Test Loss: 0.838 Test Acc: 0.722
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8831467628479004
Epoch: 51, Steps: 12 | Train Loss: 0.563 Vali Loss: 0.807 Vali Acc: 0.733 Test Loss: 0.807 Test Acc: 0.733
Validation loss decreased (-0.727768 --> -0.733325).  Saving model ...
Epoch: 52 cost time: 0.8375859260559082
Epoch: 52, Steps: 12 | Train Loss: 0.549 Vali Loss: 0.779 Vali Acc: 0.744 Test Loss: 0.779 Test Acc: 0.744
Validation loss decreased (-0.733325 --> -0.744437).  Saving model ...
Epoch: 53 cost time: 0.7910580635070801
Epoch: 53, Steps: 12 | Train Loss: 0.517 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
Validation loss decreased (-0.744437 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.608741283416748
Epoch: 54, Steps: 12 | Train Loss: 0.470 Vali Loss: 0.723 Vali Acc: 0.767 Test Loss: 0.723 Test Acc: 0.767
Validation loss decreased (-0.749992 --> -0.766659).  Saving model ...
Epoch: 55 cost time: 0.6359057426452637
Epoch: 55, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.718 Vali Acc: 0.767 Test Loss: 0.718 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 56 cost time: 0.7678871154785156
Epoch: 56, Steps: 12 | Train Loss: 0.483 Vali Loss: 0.688 Vali Acc: 0.783 Test Loss: 0.688 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 57 cost time: 0.7057774066925049
Epoch: 57, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.669 Vali Acc: 0.778 Test Loss: 0.669 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.0190320014953613
Epoch: 58, Steps: 12 | Train Loss: 0.405 Vali Loss: 0.655 Vali Acc: 0.778 Test Loss: 0.655 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.028268575668335
Epoch: 59, Steps: 12 | Train Loss: 0.403 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 60 cost time: 0.79945969581604
Epoch: 60, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7523303031921387
Epoch: 61, Steps: 12 | Train Loss: 0.314 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7793941497802734
Epoch: 62, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.611 Vali Acc: 0.800 Test Loss: 0.611 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799994).  Saving model ...
Epoch: 63 cost time: 0.7019598484039307
Epoch: 63, Steps: 12 | Train Loss: 0.280 Vali Loss: 0.630 Vali Acc: 0.800 Test Loss: 0.630 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8108265399932861
Epoch: 64, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.597 Vali Acc: 0.806 Test Loss: 0.597 Test Acc: 0.806
Validation loss decreased (-0.799994 --> -0.805550).  Saving model ...
Epoch: 65 cost time: 0.7954361438751221
Epoch: 65, Steps: 12 | Train Loss: 0.260 Vali Loss: 0.595 Vali Acc: 0.806 Test Loss: 0.595 Test Acc: 0.806
Validation loss decreased (-0.805550 --> -0.805550).  Saving model ...
Epoch: 66 cost time: 0.70835280418396
Epoch: 66, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.597 Vali Acc: 0.794 Test Loss: 0.597 Test Acc: 0.794
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7318077087402344
Epoch: 67, Steps: 12 | Train Loss: 0.243 Vali Loss: 0.572 Vali Acc: 0.817 Test Loss: 0.572 Test Acc: 0.817
Validation loss decreased (-0.805550 --> -0.816661).  Saving model ...
Epoch: 68 cost time: 0.8257043361663818
Epoch: 68, Steps: 12 | Train Loss: 0.249 Vali Loss: 0.585 Vali Acc: 0.811 Test Loss: 0.585 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8789780139923096
Epoch: 69, Steps: 12 | Train Loss: 0.213 Vali Loss: 0.572 Vali Acc: 0.822 Test Loss: 0.572 Test Acc: 0.822
Validation loss decreased (-0.816661 --> -0.822216).  Saving model ...
Epoch: 70 cost time: 0.8023619651794434
Epoch: 70, Steps: 12 | Train Loss: 0.205 Vali Loss: 0.586 Vali Acc: 0.811 Test Loss: 0.586 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6829264163970947
Epoch: 71, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.570 Vali Acc: 0.817 Test Loss: 0.570 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6030807495117188
Epoch: 72, Steps: 12 | Train Loss: 0.187 Vali Loss: 0.586 Vali Acc: 0.806 Test Loss: 0.586 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7794458866119385
Epoch: 73, Steps: 12 | Train Loss: 0.197 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.6246204376220703
Epoch: 74, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.587 Vali Acc: 0.806 Test Loss: 0.587 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7115838527679443
Epoch: 75, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.575 Vali Acc: 0.817 Test Loss: 0.575 Test Acc: 0.817
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.6905274391174316
Epoch: 76, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.573 Vali Acc: 0.811 Test Loss: 0.573 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.6520605087280273
Epoch: 77, Steps: 12 | Train Loss: 0.162 Vali Loss: 0.596 Vali Acc: 0.811 Test Loss: 0.596 Test Acc: 0.811
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.698969841003418
Epoch: 78, Steps: 12 | Train Loss: 0.144 Vali Loss: 0.560 Vali Acc: 0.806 Test Loss: 0.560 Test Acc: 0.806
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.7355983257293701
Epoch: 79, Steps: 12 | Train Loss: 0.156 Vali Loss: 0.585 Vali Acc: 0.806 Test Loss: 0.585 Test Acc: 0.806
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8222222222222222
model parameter : 4322
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.219482898712158
Epoch: 1, Steps: 12 | Train Loss: 2.688 Vali Loss: 2.684 Vali Acc: 0.083 Test Loss: 2.684 Test Acc: 0.083
Validation loss decreased (inf --> -0.083306).  Saving model ...
Epoch: 2 cost time: 0.7931697368621826
Epoch: 2, Steps: 12 | Train Loss: 2.683 Vali Loss: 2.664 Vali Acc: 0.106 Test Loss: 2.664 Test Acc: 0.106
Validation loss decreased (-0.083306 --> -0.105529).  Saving model ...
Epoch: 3 cost time: 0.7572124004364014
Epoch: 3, Steps: 12 | Train Loss: 2.652 Vali Loss: 2.635 Vali Acc: 0.117 Test Loss: 2.635 Test Acc: 0.117
Validation loss decreased (-0.105529 --> -0.116640).  Saving model ...
Epoch: 4 cost time: 0.9030499458312988
Epoch: 4, Steps: 12 | Train Loss: 2.609 Vali Loss: 2.599 Vali Acc: 0.144 Test Loss: 2.599 Test Acc: 0.144
Validation loss decreased (-0.116640 --> -0.144418).  Saving model ...
Epoch: 5 cost time: 0.8504433631896973
Epoch: 5, Steps: 12 | Train Loss: 2.582 Vali Loss: 2.561 Vali Acc: 0.167 Test Loss: 2.561 Test Acc: 0.167
Validation loss decreased (-0.144418 --> -0.166641).  Saving model ...
Epoch: 6 cost time: 0.8820085525512695
Epoch: 6, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.516 Vali Acc: 0.217 Test Loss: 2.516 Test Acc: 0.217
Validation loss decreased (-0.166641 --> -0.216642).  Saving model ...
Epoch: 7 cost time: 0.9491450786590576
Epoch: 7, Steps: 12 | Train Loss: 2.491 Vali Loss: 2.474 Vali Acc: 0.250 Test Loss: 2.474 Test Acc: 0.250
Validation loss decreased (-0.216642 --> -0.249975).  Saving model ...
Epoch: 8 cost time: 0.7972266674041748
Epoch: 8, Steps: 12 | Train Loss: 2.403 Vali Loss: 2.423 Vali Acc: 0.283 Test Loss: 2.423 Test Acc: 0.283
Validation loss decreased (-0.249975 --> -0.283309).  Saving model ...
Epoch: 9 cost time: 0.8525702953338623
Epoch: 9, Steps: 12 | Train Loss: 2.395 Vali Loss: 2.378 Vali Acc: 0.322 Test Loss: 2.378 Test Acc: 0.322
Validation loss decreased (-0.283309 --> -0.322198).  Saving model ...
Epoch: 10 cost time: 0.7583789825439453
Epoch: 10, Steps: 12 | Train Loss: 2.335 Vali Loss: 2.322 Vali Acc: 0.350 Test Loss: 2.322 Test Acc: 0.350
Validation loss decreased (-0.322198 --> -0.349977).  Saving model ...
Epoch: 11 cost time: 0.6955523490905762
Epoch: 11, Steps: 12 | Train Loss: 2.262 Vali Loss: 2.276 Vali Acc: 0.361 Test Loss: 2.276 Test Acc: 0.361
Validation loss decreased (-0.349977 --> -0.361088).  Saving model ...
Epoch: 12 cost time: 0.6943614482879639
Epoch: 12, Steps: 12 | Train Loss: 2.215 Vali Loss: 2.227 Vali Acc: 0.383 Test Loss: 2.227 Test Acc: 0.383
Validation loss decreased (-0.361088 --> -0.383311).  Saving model ...
Epoch: 13 cost time: 0.7928714752197266
Epoch: 13, Steps: 12 | Train Loss: 2.137 Vali Loss: 2.175 Vali Acc: 0.406 Test Loss: 2.175 Test Acc: 0.406
Validation loss decreased (-0.383311 --> -0.405534).  Saving model ...
Epoch: 14 cost time: 0.68271803855896
Epoch: 14, Steps: 12 | Train Loss: 2.082 Vali Loss: 2.125 Vali Acc: 0.439 Test Loss: 2.125 Test Acc: 0.439
Validation loss decreased (-0.405534 --> -0.438868).  Saving model ...
Epoch: 15 cost time: 0.847430944442749
Epoch: 15, Steps: 12 | Train Loss: 2.018 Vali Loss: 2.074 Vali Acc: 0.450 Test Loss: 2.074 Test Acc: 0.450
Validation loss decreased (-0.438868 --> -0.449979).  Saving model ...
Epoch: 16 cost time: 0.831282377243042
Epoch: 16, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.030 Vali Acc: 0.461 Test Loss: 2.030 Test Acc: 0.461
Validation loss decreased (-0.449979 --> -0.461091).  Saving model ...
Epoch: 17 cost time: 0.8446042537689209
Epoch: 17, Steps: 12 | Train Loss: 1.917 Vali Loss: 1.980 Vali Acc: 0.489 Test Loss: 1.980 Test Acc: 0.489
Validation loss decreased (-0.461091 --> -0.488869).  Saving model ...
Epoch: 18 cost time: 0.7667021751403809
Epoch: 18, Steps: 12 | Train Loss: 1.861 Vali Loss: 1.934 Vali Acc: 0.517 Test Loss: 1.934 Test Acc: 0.517
Validation loss decreased (-0.488869 --> -0.516647).  Saving model ...
Epoch: 19 cost time: 0.658381462097168
Epoch: 19, Steps: 12 | Train Loss: 1.822 Vali Loss: 1.894 Vali Acc: 0.522 Test Loss: 1.894 Test Acc: 0.522
Validation loss decreased (-0.516647 --> -0.522203).  Saving model ...
Epoch: 20 cost time: 0.6537048816680908
Epoch: 20, Steps: 12 | Train Loss: 1.766 Vali Loss: 1.850 Vali Acc: 0.550 Test Loss: 1.850 Test Acc: 0.550
Validation loss decreased (-0.522203 --> -0.549982).  Saving model ...
Epoch: 21 cost time: 0.6622042655944824
Epoch: 21, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.803 Vali Acc: 0.544 Test Loss: 1.803 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6623790264129639
Epoch: 22, Steps: 12 | Train Loss: 1.667 Vali Loss: 1.763 Vali Acc: 0.550 Test Loss: 1.763 Test Acc: 0.550
Validation loss decreased (-0.549982 --> -0.549982).  Saving model ...
Epoch: 23 cost time: 0.8312609195709229
Epoch: 23, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.732 Vali Acc: 0.561 Test Loss: 1.732 Test Acc: 0.561
Validation loss decreased (-0.549982 --> -0.561094).  Saving model ...
Epoch: 24 cost time: 0.6743628978729248
Epoch: 24, Steps: 12 | Train Loss: 1.537 Vali Loss: 1.699 Vali Acc: 0.561 Test Loss: 1.699 Test Acc: 0.561
Validation loss decreased (-0.561094 --> -0.561094).  Saving model ...
Epoch: 25 cost time: 0.8907194137573242
Epoch: 25, Steps: 12 | Train Loss: 1.529 Vali Loss: 1.667 Vali Acc: 0.550 Test Loss: 1.667 Test Acc: 0.550
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.626218318939209
Epoch: 26, Steps: 12 | Train Loss: 1.449 Vali Loss: 1.625 Vali Acc: 0.572 Test Loss: 1.625 Test Acc: 0.572
Validation loss decreased (-0.561094 --> -0.572206).  Saving model ...
Epoch: 27 cost time: 0.6021230220794678
Epoch: 27, Steps: 12 | Train Loss: 1.422 Vali Loss: 1.591 Vali Acc: 0.572 Test Loss: 1.591 Test Acc: 0.572
Validation loss decreased (-0.572206 --> -0.572206).  Saving model ...
Epoch: 28 cost time: 0.9286623001098633
Epoch: 28, Steps: 12 | Train Loss: 1.387 Vali Loss: 1.551 Vali Acc: 0.567 Test Loss: 1.551 Test Acc: 0.567
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7565269470214844
Epoch: 29, Steps: 12 | Train Loss: 1.355 Vali Loss: 1.508 Vali Acc: 0.583 Test Loss: 1.508 Test Acc: 0.583
Validation loss decreased (-0.572206 --> -0.583318).  Saving model ...
Epoch: 30 cost time: 0.8617069721221924
Epoch: 30, Steps: 12 | Train Loss: 1.292 Vali Loss: 1.466 Vali Acc: 0.572 Test Loss: 1.466 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6887035369873047
Epoch: 31, Steps: 12 | Train Loss: 1.245 Vali Loss: 1.408 Vali Acc: 0.578 Test Loss: 1.408 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7006580829620361
Epoch: 32, Steps: 12 | Train Loss: 1.166 Vali Loss: 1.366 Vali Acc: 0.594 Test Loss: 1.366 Test Acc: 0.594
Validation loss decreased (-0.583318 --> -0.594431).  Saving model ...
Epoch: 33 cost time: 0.7713973522186279
Epoch: 33, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.303 Vali Acc: 0.617 Test Loss: 1.303 Test Acc: 0.617
Validation loss decreased (-0.594431 --> -0.616654).  Saving model ...
Epoch: 34 cost time: 0.7752413749694824
Epoch: 34, Steps: 12 | Train Loss: 1.054 Vali Loss: 1.233 Vali Acc: 0.639 Test Loss: 1.233 Test Acc: 0.639
Validation loss decreased (-0.616654 --> -0.638877).  Saving model ...
Epoch: 35 cost time: 0.6235439777374268
Epoch: 35, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.178 Vali Acc: 0.656 Test Loss: 1.178 Test Acc: 0.656
Validation loss decreased (-0.638877 --> -0.655544).  Saving model ...
Epoch: 36 cost time: 0.5850732326507568
Epoch: 36, Steps: 12 | Train Loss: 0.908 Vali Loss: 1.117 Vali Acc: 0.667 Test Loss: 1.117 Test Acc: 0.667
Validation loss decreased (-0.655544 --> -0.666655).  Saving model ...
Epoch: 37 cost time: 0.7250473499298096
Epoch: 37, Steps: 12 | Train Loss: 0.875 Vali Loss: 1.079 Vali Acc: 0.661 Test Loss: 1.079 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.857520580291748
Epoch: 38, Steps: 12 | Train Loss: 0.847 Vali Loss: 1.024 Vali Acc: 0.678 Test Loss: 1.024 Test Acc: 0.678
Validation loss decreased (-0.666655 --> -0.677768).  Saving model ...
Epoch: 39 cost time: 0.700577974319458
Epoch: 39, Steps: 12 | Train Loss: 0.797 Vali Loss: 0.991 Vali Acc: 0.678 Test Loss: 0.991 Test Acc: 0.678
Validation loss decreased (-0.677768 --> -0.677768).  Saving model ...
Epoch: 40 cost time: 0.6576783657073975
Epoch: 40, Steps: 12 | Train Loss: 0.729 Vali Loss: 0.971 Vali Acc: 0.683 Test Loss: 0.971 Test Acc: 0.683
Validation loss decreased (-0.677768 --> -0.683324).  Saving model ...
Epoch: 41 cost time: 0.6468031406402588
Epoch: 41, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.950 Vali Acc: 0.706 Test Loss: 0.950 Test Acc: 0.706
Validation loss decreased (-0.683324 --> -0.705546).  Saving model ...
Epoch: 42 cost time: 0.8266992568969727
Epoch: 42, Steps: 12 | Train Loss: 0.658 Vali Loss: 0.923 Vali Acc: 0.700 Test Loss: 0.923 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.691051721572876
Epoch: 43, Steps: 12 | Train Loss: 0.650 Vali Loss: 0.901 Vali Acc: 0.706 Test Loss: 0.901 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705547).  Saving model ...
Epoch: 44 cost time: 0.6263177394866943
Epoch: 44, Steps: 12 | Train Loss: 0.657 Vali Loss: 0.876 Vali Acc: 0.722 Test Loss: 0.876 Test Acc: 0.722
Validation loss decreased (-0.705547 --> -0.722213).  Saving model ...
Epoch: 45 cost time: 0.6683261394500732
Epoch: 45, Steps: 12 | Train Loss: 0.600 Vali Loss: 0.863 Vali Acc: 0.717 Test Loss: 0.863 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7859127521514893
Epoch: 46, Steps: 12 | Train Loss: 0.574 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8505344390869141
Epoch: 47, Steps: 12 | Train Loss: 0.534 Vali Loss: 0.831 Vali Acc: 0.722 Test Loss: 0.831 Test Acc: 0.722
Validation loss decreased (-0.722213 --> -0.722214).  Saving model ...
Epoch: 48 cost time: 0.8768501281738281
Epoch: 48, Steps: 12 | Train Loss: 0.528 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6024641990661621
Epoch: 49, Steps: 12 | Train Loss: 0.513 Vali Loss: 0.812 Vali Acc: 0.728 Test Loss: 0.812 Test Acc: 0.728
Validation loss decreased (-0.722214 --> -0.727770).  Saving model ...
Epoch: 50 cost time: 0.6778261661529541
Epoch: 50, Steps: 12 | Train Loss: 0.524 Vali Loss: 0.785 Vali Acc: 0.728 Test Loss: 0.785 Test Acc: 0.728
Validation loss decreased (-0.727770 --> -0.727770).  Saving model ...
Epoch: 51 cost time: 0.6374554634094238
Epoch: 51, Steps: 12 | Train Loss: 0.573 Vali Loss: 0.770 Vali Acc: 0.733 Test Loss: 0.770 Test Acc: 0.733
Validation loss decreased (-0.727770 --> -0.733326).  Saving model ...
Epoch: 52 cost time: 0.8688361644744873
Epoch: 52, Steps: 12 | Train Loss: 0.460 Vali Loss: 0.774 Vali Acc: 0.756 Test Loss: 0.774 Test Acc: 0.756
Validation loss decreased (-0.733326 --> -0.755548).  Saving model ...
Epoch: 53 cost time: 0.732905387878418
Epoch: 53, Steps: 12 | Train Loss: 0.450 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6964902877807617
Epoch: 54, Steps: 12 | Train Loss: 0.476 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7842276096343994
Epoch: 55, Steps: 12 | Train Loss: 0.437 Vali Loss: 0.743 Vali Acc: 0.744 Test Loss: 0.743 Test Acc: 0.744
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6752963066101074
Epoch: 56, Steps: 12 | Train Loss: 0.439 Vali Loss: 0.739 Vali Acc: 0.767 Test Loss: 0.739 Test Acc: 0.767
Validation loss decreased (-0.755548 --> -0.766659).  Saving model ...
Epoch: 57 cost time: 0.7221119403839111
Epoch: 57, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.733 Vali Acc: 0.761 Test Loss: 0.733 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6896328926086426
Epoch: 58, Steps: 12 | Train Loss: 0.431 Vali Loss: 0.722 Vali Acc: 0.767 Test Loss: 0.722 Test Acc: 0.767
Validation loss decreased (-0.766659 --> -0.766659).  Saving model ...
Epoch: 59 cost time: 0.6808929443359375
Epoch: 59, Steps: 12 | Train Loss: 0.370 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
Validation loss decreased (-0.766659 --> -0.783326).  Saving model ...
Epoch: 60 cost time: 0.7048919200897217
Epoch: 60, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.695 Vali Acc: 0.772 Test Loss: 0.695 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7911515235900879
Epoch: 61, Steps: 12 | Train Loss: 0.347 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
Validation loss decreased (-0.783326 --> -0.788882).  Saving model ...
Epoch: 62 cost time: 0.8336806297302246
Epoch: 62, Steps: 12 | Train Loss: 0.327 Vali Loss: 0.694 Vali Acc: 0.772 Test Loss: 0.694 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6435682773590088
Epoch: 63, Steps: 12 | Train Loss: 0.322 Vali Loss: 0.686 Vali Acc: 0.756 Test Loss: 0.686 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6634376049041748
Epoch: 64, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 65 cost time: 0.9896543025970459
Epoch: 65, Steps: 12 | Train Loss: 0.323 Vali Loss: 0.666 Vali Acc: 0.800 Test Loss: 0.666 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 66 cost time: 0.7161104679107666
Epoch: 66, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.664 Vali Acc: 0.789 Test Loss: 0.664 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7582254409790039
Epoch: 67, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.677 Vali Acc: 0.783 Test Loss: 0.677 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6708238124847412
Epoch: 68, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.6294629573822021
Epoch: 69, Steps: 12 | Train Loss: 0.262 Vali Loss: 0.658 Vali Acc: 0.811 Test Loss: 0.658 Test Acc: 0.811
Validation loss decreased (-0.799993 --> -0.811105).  Saving model ...
Epoch: 70 cost time: 0.696234941482544
Epoch: 70, Steps: 12 | Train Loss: 0.267 Vali Loss: 0.657 Vali Acc: 0.806 Test Loss: 0.657 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9655239582061768
Epoch: 71, Steps: 12 | Train Loss: 0.247 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.657034158706665
Epoch: 72, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.645 Vali Acc: 0.806 Test Loss: 0.645 Test Acc: 0.806
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7234094142913818
Epoch: 73, Steps: 12 | Train Loss: 0.235 Vali Loss: 0.655 Vali Acc: 0.806 Test Loss: 0.655 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.8022925853729248
Epoch: 74, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.656 Vali Acc: 0.806 Test Loss: 0.656 Test Acc: 0.806
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6354742050170898
Epoch: 75, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.657 Vali Acc: 0.811 Test Loss: 0.657 Test Acc: 0.811
Validation loss decreased (-0.811105 --> -0.811105).  Saving model ...
Epoch: 76 cost time: 0.630115270614624
Epoch: 76, Steps: 12 | Train Loss: 0.219 Vali Loss: 0.631 Vali Acc: 0.806 Test Loss: 0.631 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6903855800628662
Epoch: 77, Steps: 12 | Train Loss: 0.206 Vali Loss: 0.650 Vali Acc: 0.817 Test Loss: 0.650 Test Acc: 0.817
Validation loss decreased (-0.811105 --> -0.816660).  Saving model ...
Epoch: 78 cost time: 0.8106179237365723
Epoch: 78, Steps: 12 | Train Loss: 0.209 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
Validation loss decreased (-0.816660 --> -0.822216).  Saving model ...
Epoch: 79 cost time: 0.7593955993652344
Epoch: 79, Steps: 12 | Train Loss: 0.200 Vali Loss: 0.642 Vali Acc: 0.817 Test Loss: 0.642 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.783055305480957
Epoch: 80, Steps: 12 | Train Loss: 0.190 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833327).  Saving model ...
Epoch: 81 cost time: 0.624326229095459
Epoch: 81, Steps: 12 | Train Loss: 0.182 Vali Loss: 0.632 Vali Acc: 0.828 Test Loss: 0.632 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.650418758392334
Epoch: 82, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.7164685726165771
Epoch: 83, Steps: 12 | Train Loss: 0.223 Vali Loss: 0.636 Vali Acc: 0.833 Test Loss: 0.636 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7499523162841797
Epoch: 84, Steps: 12 | Train Loss: 0.177 Vali Loss: 0.633 Vali Acc: 0.839 Test Loss: 0.633 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 85 cost time: 0.6110217571258545
Epoch: 85, Steps: 12 | Train Loss: 0.179 Vali Loss: 0.635 Vali Acc: 0.828 Test Loss: 0.635 Test Acc: 0.828
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7619314193725586
Epoch: 86, Steps: 12 | Train Loss: 0.160 Vali Loss: 0.613 Vali Acc: 0.844 Test Loss: 0.613 Test Acc: 0.844
Validation loss decreased (-0.838883 --> -0.844438).  Saving model ...
Epoch: 87 cost time: 0.7902464866638184
Epoch: 87, Steps: 12 | Train Loss: 0.153 Vali Loss: 0.622 Vali Acc: 0.839 Test Loss: 0.622 Test Acc: 0.839
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.76092529296875
Epoch: 88, Steps: 12 | Train Loss: 0.165 Vali Loss: 0.622 Vali Acc: 0.833 Test Loss: 0.622 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.8111824989318848
Epoch: 89, Steps: 12 | Train Loss: 0.163 Vali Loss: 0.630 Vali Acc: 0.833 Test Loss: 0.630 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 90 cost time: 0.6953580379486084
Epoch: 90, Steps: 12 | Train Loss: 0.158 Vali Loss: 0.622 Vali Acc: 0.844 Test Loss: 0.622 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 91 cost time: 0.7286593914031982
Epoch: 91, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.625 Vali Acc: 0.828 Test Loss: 0.625 Test Acc: 0.828
EarlyStopping counter: 5 out of 10
Epoch: 92 cost time: 0.6745939254760742
Epoch: 92, Steps: 12 | Train Loss: 0.143 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
Validation loss decreased (-0.844438 --> -0.849994).  Saving model ...
Epoch: 93 cost time: 0.6989395618438721
Epoch: 93, Steps: 12 | Train Loss: 0.137 Vali Loss: 0.618 Vali Acc: 0.844 Test Loss: 0.618 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.6456782817840576
Epoch: 94, Steps: 12 | Train Loss: 0.132 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.7271027565002441
Epoch: 95, Steps: 12 | Train Loss: 0.138 Vali Loss: 0.621 Vali Acc: 0.856 Test Loss: 0.621 Test Acc: 0.856
Validation loss decreased (-0.849994 --> -0.855549).  Saving model ...
Epoch: 96 cost time: 0.8674015998840332
Epoch: 96, Steps: 12 | Train Loss: 0.119 Vali Loss: 0.623 Vali Acc: 0.861 Test Loss: 0.623 Test Acc: 0.861
Validation loss decreased (-0.855549 --> -0.861105).  Saving model ...
Epoch: 97 cost time: 0.9233534336090088
Epoch: 97, Steps: 12 | Train Loss: 0.117 Vali Loss: 0.620 Vali Acc: 0.861 Test Loss: 0.620 Test Acc: 0.861
Validation loss decreased (-0.861105 --> -0.861105).  Saving model ...
Epoch: 98 cost time: 0.6605846881866455
Epoch: 98, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.631 Vali Acc: 0.850 Test Loss: 0.631 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6260077953338623
Epoch: 99, Steps: 12 | Train Loss: 0.112 Vali Loss: 0.653 Vali Acc: 0.844 Test Loss: 0.653 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.6934778690338135
Epoch: 100, Steps: 12 | Train Loss: 0.108 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
Validation loss decreased (-0.861105 --> -0.866660).  Saving model ...
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8666666666666667
model parameter : 4467
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 1.9999027252197266
Epoch: 1, Steps: 12 | Train Loss: 2.830 Vali Loss: 2.795 Vali Acc: 0.039 Test Loss: 2.795 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.7514064311981201
Epoch: 2, Steps: 12 | Train Loss: 2.798 Vali Loss: 2.770 Vali Acc: 0.044 Test Loss: 2.770 Test Acc: 0.044
Validation loss decreased (-0.038861 --> -0.044417).  Saving model ...
Epoch: 3 cost time: 0.6387650966644287
Epoch: 3, Steps: 12 | Train Loss: 2.769 Vali Loss: 2.736 Vali Acc: 0.050 Test Loss: 2.736 Test Acc: 0.050
Validation loss decreased (-0.044417 --> -0.049973).  Saving model ...
Epoch: 4 cost time: 0.6167023181915283
Epoch: 4, Steps: 12 | Train Loss: 2.733 Vali Loss: 2.696 Vali Acc: 0.067 Test Loss: 2.696 Test Acc: 0.067
Validation loss decreased (-0.049973 --> -0.066640).  Saving model ...
Epoch: 5 cost time: 0.9085967540740967
Epoch: 5, Steps: 12 | Train Loss: 2.685 Vali Loss: 2.654 Vali Acc: 0.083 Test Loss: 2.654 Test Acc: 0.083
Validation loss decreased (-0.066640 --> -0.083307).  Saving model ...
Epoch: 6 cost time: 0.7870047092437744
Epoch: 6, Steps: 12 | Train Loss: 2.650 Vali Loss: 2.606 Vali Acc: 0.117 Test Loss: 2.606 Test Acc: 0.117
Validation loss decreased (-0.083307 --> -0.116641).  Saving model ...
Epoch: 7 cost time: 0.7499332427978516
Epoch: 7, Steps: 12 | Train Loss: 2.580 Vali Loss: 2.560 Vali Acc: 0.144 Test Loss: 2.560 Test Acc: 0.144
Validation loss decreased (-0.116641 --> -0.144419).  Saving model ...
Epoch: 8 cost time: 0.8030767440795898
Epoch: 8, Steps: 12 | Train Loss: 2.538 Vali Loss: 2.512 Vali Acc: 0.178 Test Loss: 2.512 Test Acc: 0.178
Validation loss decreased (-0.144419 --> -0.177753).  Saving model ...
Epoch: 9 cost time: 0.6935093402862549
Epoch: 9, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.463 Vali Acc: 0.228 Test Loss: 2.463 Test Acc: 0.228
Validation loss decreased (-0.177753 --> -0.227753).  Saving model ...
Epoch: 10 cost time: 0.6623642444610596
Epoch: 10, Steps: 12 | Train Loss: 2.427 Vali Loss: 2.411 Vali Acc: 0.267 Test Loss: 2.411 Test Acc: 0.267
Validation loss decreased (-0.227753 --> -0.266643).  Saving model ...
Epoch: 11 cost time: 1.0141026973724365
Epoch: 11, Steps: 12 | Train Loss: 2.355 Vali Loss: 2.358 Vali Acc: 0.311 Test Loss: 2.358 Test Acc: 0.311
Validation loss decreased (-0.266643 --> -0.311088).  Saving model ...
Epoch: 12 cost time: 0.6637558937072754
Epoch: 12, Steps: 12 | Train Loss: 2.327 Vali Loss: 2.304 Vali Acc: 0.339 Test Loss: 2.304 Test Acc: 0.339
Validation loss decreased (-0.311088 --> -0.338866).  Saving model ...
Epoch: 13 cost time: 0.6562397480010986
Epoch: 13, Steps: 12 | Train Loss: 2.263 Vali Loss: 2.252 Vali Acc: 0.356 Test Loss: 2.252 Test Acc: 0.356
Validation loss decreased (-0.338866 --> -0.355533).  Saving model ...
Epoch: 14 cost time: 0.9793083667755127
Epoch: 14, Steps: 12 | Train Loss: 2.204 Vali Loss: 2.198 Vali Acc: 0.372 Test Loss: 2.198 Test Acc: 0.372
Validation loss decreased (-0.355533 --> -0.372200).  Saving model ...
Epoch: 15 cost time: 0.6680212020874023
Epoch: 15, Steps: 12 | Train Loss: 2.147 Vali Loss: 2.143 Vali Acc: 0.433 Test Loss: 2.143 Test Acc: 0.433
Validation loss decreased (-0.372200 --> -0.433312).  Saving model ...
Epoch: 16 cost time: 0.6472387313842773
Epoch: 16, Steps: 12 | Train Loss: 2.063 Vali Loss: 2.089 Vali Acc: 0.461 Test Loss: 2.089 Test Acc: 0.461
Validation loss decreased (-0.433312 --> -0.461090).  Saving model ...
Epoch: 17 cost time: 0.7221121788024902
Epoch: 17, Steps: 12 | Train Loss: 1.990 Vali Loss: 2.031 Vali Acc: 0.478 Test Loss: 2.031 Test Acc: 0.478
Validation loss decreased (-0.461090 --> -0.477757).  Saving model ...
Epoch: 18 cost time: 0.6888988018035889
Epoch: 18, Steps: 12 | Train Loss: 1.931 Vali Loss: 1.976 Vali Acc: 0.478 Test Loss: 1.976 Test Acc: 0.478
Validation loss decreased (-0.477757 --> -0.477758).  Saving model ...
Epoch: 19 cost time: 0.7935328483581543
Epoch: 19, Steps: 12 | Train Loss: 1.870 Vali Loss: 1.923 Vali Acc: 0.500 Test Loss: 1.923 Test Acc: 0.500
Validation loss decreased (-0.477758 --> -0.499981).  Saving model ...
Epoch: 20 cost time: 0.7717692852020264
Epoch: 20, Steps: 12 | Train Loss: 1.823 Vali Loss: 1.875 Vali Acc: 0.511 Test Loss: 1.875 Test Acc: 0.511
Validation loss decreased (-0.499981 --> -0.511092).  Saving model ...
Epoch: 21 cost time: 0.7659695148468018
Epoch: 21, Steps: 12 | Train Loss: 1.784 Vali Loss: 1.827 Vali Acc: 0.539 Test Loss: 1.827 Test Acc: 0.539
Validation loss decreased (-0.511092 --> -0.538871).  Saving model ...
Epoch: 22 cost time: 0.7092773914337158
Epoch: 22, Steps: 12 | Train Loss: 1.733 Vali Loss: 1.789 Vali Acc: 0.556 Test Loss: 1.789 Test Acc: 0.556
Validation loss decreased (-0.538871 --> -0.555538).  Saving model ...
Epoch: 23 cost time: 0.7547311782836914
Epoch: 23, Steps: 12 | Train Loss: 1.689 Vali Loss: 1.750 Vali Acc: 0.578 Test Loss: 1.750 Test Acc: 0.578
Validation loss decreased (-0.555538 --> -0.577760).  Saving model ...
Epoch: 24 cost time: 0.8432471752166748
Epoch: 24, Steps: 12 | Train Loss: 1.586 Vali Loss: 1.712 Vali Acc: 0.589 Test Loss: 1.712 Test Acc: 0.589
Validation loss decreased (-0.577760 --> -0.588872).  Saving model ...
Epoch: 25 cost time: 0.6606221199035645
Epoch: 25, Steps: 12 | Train Loss: 1.559 Vali Loss: 1.671 Vali Acc: 0.600 Test Loss: 1.671 Test Acc: 0.600
Validation loss decreased (-0.588872 --> -0.599983).  Saving model ...
Epoch: 26 cost time: 0.9300596714019775
Epoch: 26, Steps: 12 | Train Loss: 1.507 Vali Loss: 1.638 Vali Acc: 0.600 Test Loss: 1.638 Test Acc: 0.600
Validation loss decreased (-0.599983 --> -0.599984).  Saving model ...
Epoch: 27 cost time: 0.7611410617828369
Epoch: 27, Steps: 12 | Train Loss: 1.510 Vali Loss: 1.603 Vali Acc: 0.617 Test Loss: 1.603 Test Acc: 0.617
Validation loss decreased (-0.599984 --> -0.616651).  Saving model ...
Epoch: 28 cost time: 0.837268590927124
Epoch: 28, Steps: 12 | Train Loss: 1.418 Vali Loss: 1.569 Vali Acc: 0.617 Test Loss: 1.569 Test Acc: 0.617
Validation loss decreased (-0.616651 --> -0.616651).  Saving model ...
Epoch: 29 cost time: 1.0053112506866455
Epoch: 29, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.540 Vali Acc: 0.606 Test Loss: 1.540 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6417737007141113
Epoch: 30, Steps: 12 | Train Loss: 1.356 Vali Loss: 1.500 Vali Acc: 0.622 Test Loss: 1.500 Test Acc: 0.622
Validation loss decreased (-0.616651 --> -0.622207).  Saving model ...
Epoch: 31 cost time: 0.7781374454498291
Epoch: 31, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.468 Vali Acc: 0.617 Test Loss: 1.468 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7936806678771973
Epoch: 32, Steps: 12 | Train Loss: 1.247 Vali Loss: 1.438 Vali Acc: 0.633 Test Loss: 1.438 Test Acc: 0.633
Validation loss decreased (-0.622207 --> -0.633319).  Saving model ...
Epoch: 33 cost time: 0.6773498058319092
Epoch: 33, Steps: 12 | Train Loss: 1.229 Vali Loss: 1.406 Vali Acc: 0.633 Test Loss: 1.406 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633319).  Saving model ...
Epoch: 34 cost time: 0.6848843097686768
Epoch: 34, Steps: 12 | Train Loss: 1.198 Vali Loss: 1.367 Vali Acc: 0.628 Test Loss: 1.367 Test Acc: 0.628
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8200266361236572
Epoch: 35, Steps: 12 | Train Loss: 1.150 Vali Loss: 1.331 Vali Acc: 0.622 Test Loss: 1.331 Test Acc: 0.622
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8341248035430908
Epoch: 36, Steps: 12 | Train Loss: 1.098 Vali Loss: 1.300 Vali Acc: 0.611 Test Loss: 1.300 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.766150951385498
Epoch: 37, Steps: 12 | Train Loss: 1.099 Vali Loss: 1.248 Vali Acc: 0.628 Test Loss: 1.248 Test Acc: 0.628
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.688035249710083
Epoch: 38, Steps: 12 | Train Loss: 1.013 Vali Loss: 1.217 Vali Acc: 0.611 Test Loss: 1.217 Test Acc: 0.611
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6755242347717285
Epoch: 39, Steps: 12 | Train Loss: 1.011 Vali Loss: 1.185 Vali Acc: 0.633 Test Loss: 1.185 Test Acc: 0.633
Validation loss decreased (-0.633319 --> -0.633321).  Saving model ...
Epoch: 40 cost time: 0.7177681922912598
Epoch: 40, Steps: 12 | Train Loss: 0.916 Vali Loss: 1.147 Vali Acc: 0.644 Test Loss: 1.147 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644433).  Saving model ...
Epoch: 41 cost time: 0.7317900657653809
Epoch: 41, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.115 Vali Acc: 0.661 Test Loss: 1.115 Test Acc: 0.661
Validation loss decreased (-0.644433 --> -0.661100).  Saving model ...
Epoch: 42 cost time: 0.7026429176330566
Epoch: 42, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.084 Vali Acc: 0.656 Test Loss: 1.084 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9626226425170898
Epoch: 43, Steps: 12 | Train Loss: 0.800 Vali Loss: 1.049 Vali Acc: 0.667 Test Loss: 1.049 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 44 cost time: 0.78049635887146
Epoch: 44, Steps: 12 | Train Loss: 0.754 Vali Loss: 1.022 Vali Acc: 0.672 Test Loss: 1.022 Test Acc: 0.672
Validation loss decreased (-0.666656 --> -0.672212).  Saving model ...
Epoch: 45 cost time: 0.7609348297119141
Epoch: 45, Steps: 12 | Train Loss: 0.779 Vali Loss: 0.988 Vali Acc: 0.667 Test Loss: 0.988 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7919080257415771
Epoch: 46, Steps: 12 | Train Loss: 0.708 Vali Loss: 0.974 Vali Acc: 0.667 Test Loss: 0.974 Test Acc: 0.667
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6943912506103516
Epoch: 47, Steps: 12 | Train Loss: 0.714 Vali Loss: 0.946 Vali Acc: 0.683 Test Loss: 0.946 Test Acc: 0.683
Validation loss decreased (-0.672212 --> -0.683324).  Saving model ...
Epoch: 48 cost time: 0.8594925403594971
Epoch: 48, Steps: 12 | Train Loss: 0.673 Vali Loss: 0.931 Vali Acc: 0.672 Test Loss: 0.931 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8136234283447266
Epoch: 49, Steps: 12 | Train Loss: 0.621 Vali Loss: 0.912 Vali Acc: 0.717 Test Loss: 0.912 Test Acc: 0.717
Validation loss decreased (-0.683324 --> -0.716658).  Saving model ...
Epoch: 50 cost time: 0.7471683025360107
Epoch: 50, Steps: 12 | Train Loss: 0.614 Vali Loss: 0.889 Vali Acc: 0.700 Test Loss: 0.889 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8035681247711182
Epoch: 51, Steps: 12 | Train Loss: 0.630 Vali Loss: 0.885 Vali Acc: 0.711 Test Loss: 0.885 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7038595676422119
Epoch: 52, Steps: 12 | Train Loss: 0.582 Vali Loss: 0.858 Vali Acc: 0.722 Test Loss: 0.858 Test Acc: 0.722
Validation loss decreased (-0.716658 --> -0.722214).  Saving model ...
Epoch: 53 cost time: 0.7984297275543213
Epoch: 53, Steps: 12 | Train Loss: 0.591 Vali Loss: 0.881 Vali Acc: 0.711 Test Loss: 0.881 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6445713043212891
Epoch: 54, Steps: 12 | Train Loss: 0.518 Vali Loss: 0.861 Vali Acc: 0.761 Test Loss: 0.861 Test Acc: 0.761
Validation loss decreased (-0.722214 --> -0.761102).  Saving model ...
Epoch: 55 cost time: 0.6861178874969482
Epoch: 55, Steps: 12 | Train Loss: 0.542 Vali Loss: 0.835 Vali Acc: 0.756 Test Loss: 0.835 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5955562591552734
Epoch: 56, Steps: 12 | Train Loss: 0.489 Vali Loss: 0.821 Vali Acc: 0.750 Test Loss: 0.821 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7131459712982178
Epoch: 57, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.829 Vali Acc: 0.739 Test Loss: 0.829 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7227504253387451
Epoch: 58, Steps: 12 | Train Loss: 0.477 Vali Loss: 0.825 Vali Acc: 0.744 Test Loss: 0.825 Test Acc: 0.744
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7733440399169922
Epoch: 59, Steps: 12 | Train Loss: 0.472 Vali Loss: 0.809 Vali Acc: 0.744 Test Loss: 0.809 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8916831016540527
Epoch: 60, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.826 Vali Acc: 0.722 Test Loss: 0.826 Test Acc: 0.722
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8838732242584229
Epoch: 61, Steps: 12 | Train Loss: 0.441 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8419797420501709
Epoch: 62, Steps: 12 | Train Loss: 0.449 Vali Loss: 0.791 Vali Acc: 0.772 Test Loss: 0.791 Test Acc: 0.772
Validation loss decreased (-0.761102 --> -0.772214).  Saving model ...
Epoch: 63 cost time: 0.7885704040527344
Epoch: 63, Steps: 12 | Train Loss: 0.430 Vali Loss: 0.798 Vali Acc: 0.750 Test Loss: 0.798 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8441400527954102
Epoch: 64, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.782 Vali Acc: 0.761 Test Loss: 0.782 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9783399105072021
Epoch: 65, Steps: 12 | Train Loss: 0.393 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
Validation loss decreased (-0.772214 --> -0.783326).  Saving model ...
Epoch: 66 cost time: 1.119718313217163
Epoch: 66, Steps: 12 | Train Loss: 0.392 Vali Loss: 0.786 Vali Acc: 0.761 Test Loss: 0.786 Test Acc: 0.761
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8932700157165527
Epoch: 67, Steps: 12 | Train Loss: 0.377 Vali Loss: 0.771 Vali Acc: 0.761 Test Loss: 0.771 Test Acc: 0.761
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.775348424911499
Epoch: 68, Steps: 12 | Train Loss: 0.395 Vali Loss: 0.764 Vali Acc: 0.778 Test Loss: 0.764 Test Acc: 0.778
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.0863137245178223
Epoch: 69, Steps: 12 | Train Loss: 0.349 Vali Loss: 0.769 Vali Acc: 0.767 Test Loss: 0.769 Test Acc: 0.767
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.2742204666137695
Epoch: 70, Steps: 12 | Train Loss: 0.355 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.2922956943511963
Epoch: 71, Steps: 12 | Train Loss: 0.359 Vali Loss: 0.777 Vali Acc: 0.761 Test Loss: 0.777 Test Acc: 0.761
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.1327054500579834
Epoch: 72, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.747 Vali Acc: 0.794 Test Loss: 0.747 Test Acc: 0.794
Validation loss decreased (-0.783326 --> -0.794437).  Saving model ...
Epoch: 73 cost time: 1.1975297927856445
Epoch: 73, Steps: 12 | Train Loss: 0.383 Vali Loss: 0.751 Vali Acc: 0.772 Test Loss: 0.751 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 1.1203415393829346
Epoch: 74, Steps: 12 | Train Loss: 0.330 Vali Loss: 0.771 Vali Acc: 0.767 Test Loss: 0.771 Test Acc: 0.767
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8666348457336426
Epoch: 75, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.741 Vali Acc: 0.794 Test Loss: 0.741 Test Acc: 0.794
Validation loss decreased (-0.794437 --> -0.794437).  Saving model ...
Epoch: 76 cost time: 0.920687198638916
Epoch: 76, Steps: 12 | Train Loss: 0.309 Vali Loss: 0.770 Vali Acc: 0.756 Test Loss: 0.770 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8765425682067871
Epoch: 77, Steps: 12 | Train Loss: 0.306 Vali Loss: 0.749 Vali Acc: 0.778 Test Loss: 0.749 Test Acc: 0.778
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.1369776725769043
Epoch: 78, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.733 Vali Acc: 0.789 Test Loss: 0.733 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.7921736240386963
Epoch: 79, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.2777760028839111
Epoch: 80, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.761 Vali Acc: 0.778 Test Loss: 0.761 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.9838409423828125
Epoch: 81, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.765 Vali Acc: 0.789 Test Loss: 0.765 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.9359571933746338
Epoch: 82, Steps: 12 | Train Loss: 0.288 Vali Loss: 0.742 Vali Acc: 0.794 Test Loss: 0.742 Test Acc: 0.794
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.133655071258545
Epoch: 83, Steps: 12 | Train Loss: 0.252 Vali Loss: 0.741 Vali Acc: 0.778 Test Loss: 0.741 Test Acc: 0.778
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.8745641708374023
Epoch: 84, Steps: 12 | Train Loss: 0.254 Vali Loss: 0.743 Vali Acc: 0.794 Test Loss: 0.743 Test Acc: 0.794
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.998896598815918
Epoch: 85, Steps: 12 | Train Loss: 0.239 Vali Loss: 0.748 Vali Acc: 0.794 Test Loss: 0.748 Test Acc: 0.794
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7944444444444444
model parameter : 4526
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2564260959625244
Epoch: 1, Steps: 12 | Train Loss: 2.848 Vali Loss: 2.821 Vali Acc: 0.072 Test Loss: 2.821 Test Acc: 0.072
Validation loss decreased (inf --> -0.072194).  Saving model ...
Epoch: 2 cost time: 0.6247084140777588
Epoch: 2, Steps: 12 | Train Loss: 2.806 Vali Loss: 2.794 Vali Acc: 0.094 Test Loss: 2.794 Test Acc: 0.094
Validation loss decreased (-0.072194 --> -0.094417).  Saving model ...
Epoch: 3 cost time: 0.6413238048553467
Epoch: 3, Steps: 12 | Train Loss: 2.780 Vali Loss: 2.762 Vali Acc: 0.122 Test Loss: 2.762 Test Acc: 0.122
Validation loss decreased (-0.094417 --> -0.122195).  Saving model ...
Epoch: 4 cost time: 0.6043493747711182
Epoch: 4, Steps: 12 | Train Loss: 2.757 Vali Loss: 2.721 Vali Acc: 0.128 Test Loss: 2.721 Test Acc: 0.128
Validation loss decreased (-0.122195 --> -0.127751).  Saving model ...
Epoch: 5 cost time: 0.634800910949707
Epoch: 5, Steps: 12 | Train Loss: 2.700 Vali Loss: 2.680 Vali Acc: 0.133 Test Loss: 2.680 Test Acc: 0.133
Validation loss decreased (-0.127751 --> -0.133307).  Saving model ...
Epoch: 6 cost time: 0.733802080154419
Epoch: 6, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.632 Vali Acc: 0.150 Test Loss: 2.632 Test Acc: 0.150
Validation loss decreased (-0.133307 --> -0.149974).  Saving model ...
Epoch: 7 cost time: 0.6864087581634521
Epoch: 7, Steps: 12 | Train Loss: 2.601 Vali Loss: 2.588 Vali Acc: 0.178 Test Loss: 2.588 Test Acc: 0.178
Validation loss decreased (-0.149974 --> -0.177752).  Saving model ...
Epoch: 8 cost time: 0.6723213195800781
Epoch: 8, Steps: 12 | Train Loss: 2.559 Vali Loss: 2.541 Vali Acc: 0.206 Test Loss: 2.541 Test Acc: 0.206
Validation loss decreased (-0.177752 --> -0.205530).  Saving model ...
Epoch: 9 cost time: 0.8577406406402588
Epoch: 9, Steps: 12 | Train Loss: 2.489 Vali Loss: 2.491 Vali Acc: 0.244 Test Loss: 2.491 Test Acc: 0.244
Validation loss decreased (-0.205530 --> -0.244420).  Saving model ...
Epoch: 10 cost time: 0.6539080142974854
Epoch: 10, Steps: 12 | Train Loss: 2.444 Vali Loss: 2.441 Vali Acc: 0.267 Test Loss: 2.441 Test Acc: 0.267
Validation loss decreased (-0.244420 --> -0.266642).  Saving model ...
Epoch: 11 cost time: 0.5804591178894043
Epoch: 11, Steps: 12 | Train Loss: 2.376 Vali Loss: 2.388 Vali Acc: 0.278 Test Loss: 2.388 Test Acc: 0.278
Validation loss decreased (-0.266642 --> -0.277754).  Saving model ...
Epoch: 12 cost time: 0.6746585369110107
Epoch: 12, Steps: 12 | Train Loss: 2.339 Vali Loss: 2.338 Vali Acc: 0.311 Test Loss: 2.338 Test Acc: 0.311
Validation loss decreased (-0.277754 --> -0.311088).  Saving model ...
Epoch: 13 cost time: 0.6856253147125244
Epoch: 13, Steps: 12 | Train Loss: 2.266 Vali Loss: 2.282 Vali Acc: 0.372 Test Loss: 2.282 Test Acc: 0.372
Validation loss decreased (-0.311088 --> -0.372199).  Saving model ...
Epoch: 14 cost time: 0.7387433052062988
Epoch: 14, Steps: 12 | Train Loss: 2.206 Vali Loss: 2.226 Vali Acc: 0.428 Test Loss: 2.226 Test Acc: 0.428
Validation loss decreased (-0.372199 --> -0.427756).  Saving model ...
Epoch: 15 cost time: 0.958385705947876
Epoch: 15, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.174 Vali Acc: 0.433 Test Loss: 2.174 Test Acc: 0.433
Validation loss decreased (-0.427756 --> -0.433312).  Saving model ...
Epoch: 16 cost time: 0.6207337379455566
Epoch: 16, Steps: 12 | Train Loss: 2.087 Vali Loss: 2.116 Vali Acc: 0.467 Test Loss: 2.116 Test Acc: 0.467
Validation loss decreased (-0.433312 --> -0.466646).  Saving model ...
Epoch: 17 cost time: 0.7110509872436523
Epoch: 17, Steps: 12 | Train Loss: 1.972 Vali Loss: 2.058 Vali Acc: 0.478 Test Loss: 2.058 Test Acc: 0.478
Validation loss decreased (-0.466646 --> -0.477757).  Saving model ...
Epoch: 18 cost time: 0.7748990058898926
Epoch: 18, Steps: 12 | Train Loss: 1.950 Vali Loss: 2.003 Vali Acc: 0.478 Test Loss: 2.003 Test Acc: 0.478
Validation loss decreased (-0.477757 --> -0.477758).  Saving model ...
Epoch: 19 cost time: 0.6963329315185547
Epoch: 19, Steps: 12 | Train Loss: 1.878 Vali Loss: 1.956 Vali Acc: 0.478 Test Loss: 1.956 Test Acc: 0.478
Validation loss decreased (-0.477758 --> -0.477758).  Saving model ...
Epoch: 20 cost time: 0.9888370037078857
Epoch: 20, Steps: 12 | Train Loss: 1.807 Vali Loss: 1.908 Vali Acc: 0.494 Test Loss: 1.908 Test Acc: 0.494
Validation loss decreased (-0.477758 --> -0.494425).  Saving model ...
Epoch: 21 cost time: 0.7673501968383789
Epoch: 21, Steps: 12 | Train Loss: 1.751 Vali Loss: 1.862 Vali Acc: 0.506 Test Loss: 1.862 Test Acc: 0.506
Validation loss decreased (-0.494425 --> -0.505537).  Saving model ...
Epoch: 22 cost time: 0.7724449634552002
Epoch: 22, Steps: 12 | Train Loss: 1.673 Vali Loss: 1.810 Vali Acc: 0.528 Test Loss: 1.810 Test Acc: 0.528
Validation loss decreased (-0.505537 --> -0.527760).  Saving model ...
Epoch: 23 cost time: 0.9194302558898926
Epoch: 23, Steps: 12 | Train Loss: 1.630 Vali Loss: 1.767 Vali Acc: 0.544 Test Loss: 1.767 Test Acc: 0.544
Validation loss decreased (-0.527760 --> -0.544427).  Saving model ...
Epoch: 24 cost time: 0.8048639297485352
Epoch: 24, Steps: 12 | Train Loss: 1.583 Vali Loss: 1.723 Vali Acc: 0.550 Test Loss: 1.723 Test Acc: 0.550
Validation loss decreased (-0.544427 --> -0.549983).  Saving model ...
Epoch: 25 cost time: 1.078247308731079
Epoch: 25, Steps: 12 | Train Loss: 1.539 Vali Loss: 1.677 Vali Acc: 0.583 Test Loss: 1.677 Test Acc: 0.583
Validation loss decreased (-0.549983 --> -0.583317).  Saving model ...
Epoch: 26 cost time: 0.9217433929443359
Epoch: 26, Steps: 12 | Train Loss: 1.478 Vali Loss: 1.635 Vali Acc: 0.589 Test Loss: 1.635 Test Acc: 0.589
Validation loss decreased (-0.583317 --> -0.588873).  Saving model ...
Epoch: 27 cost time: 0.9342598915100098
Epoch: 27, Steps: 12 | Train Loss: 1.451 Vali Loss: 1.583 Vali Acc: 0.606 Test Loss: 1.583 Test Acc: 0.606
Validation loss decreased (-0.588873 --> -0.605540).  Saving model ...
Epoch: 28 cost time: 0.659132719039917
Epoch: 28, Steps: 12 | Train Loss: 1.346 Vali Loss: 1.551 Vali Acc: 0.589 Test Loss: 1.551 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.888730525970459
Epoch: 29, Steps: 12 | Train Loss: 1.328 Vali Loss: 1.503 Vali Acc: 0.617 Test Loss: 1.503 Test Acc: 0.617
Validation loss decreased (-0.605540 --> -0.616652).  Saving model ...
Epoch: 30 cost time: 1.0547292232513428
Epoch: 30, Steps: 12 | Train Loss: 1.253 Vali Loss: 1.451 Vali Acc: 0.611 Test Loss: 1.451 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9432921409606934
Epoch: 31, Steps: 12 | Train Loss: 1.204 Vali Loss: 1.412 Vali Acc: 0.622 Test Loss: 1.412 Test Acc: 0.622
Validation loss decreased (-0.616652 --> -0.622208).  Saving model ...
Epoch: 32 cost time: 0.9009816646575928
Epoch: 32, Steps: 12 | Train Loss: 1.138 Vali Loss: 1.368 Vali Acc: 0.622 Test Loss: 1.368 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 33 cost time: 0.658989667892456
Epoch: 33, Steps: 12 | Train Loss: 1.095 Vali Loss: 1.331 Vali Acc: 0.644 Test Loss: 1.331 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644431).  Saving model ...
Epoch: 34 cost time: 0.9703269004821777
Epoch: 34, Steps: 12 | Train Loss: 1.071 Vali Loss: 1.285 Vali Acc: 0.650 Test Loss: 1.285 Test Acc: 0.650
Validation loss decreased (-0.644431 --> -0.649987).  Saving model ...
Epoch: 35 cost time: 1.2036211490631104
Epoch: 35, Steps: 12 | Train Loss: 1.019 Vali Loss: 1.241 Vali Acc: 0.661 Test Loss: 1.241 Test Acc: 0.661
Validation loss decreased (-0.649987 --> -0.661099).  Saving model ...
Epoch: 36 cost time: 0.8871276378631592
Epoch: 36, Steps: 12 | Train Loss: 0.930 Vali Loss: 1.201 Vali Acc: 0.661 Test Loss: 1.201 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661099).  Saving model ...
Epoch: 37 cost time: 1.1360418796539307
Epoch: 37, Steps: 12 | Train Loss: 0.885 Vali Loss: 1.161 Vali Acc: 0.656 Test Loss: 1.161 Test Acc: 0.656
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8634555339813232
Epoch: 38, Steps: 12 | Train Loss: 0.837 Vali Loss: 1.131 Vali Acc: 0.661 Test Loss: 1.131 Test Acc: 0.661
Validation loss decreased (-0.661099 --> -0.661100).  Saving model ...
Epoch: 39 cost time: 0.8245081901550293
Epoch: 39, Steps: 12 | Train Loss: 0.833 Vali Loss: 1.094 Vali Acc: 0.667 Test Loss: 1.094 Test Acc: 0.667
Validation loss decreased (-0.661100 --> -0.666656).  Saving model ...
Epoch: 40 cost time: 0.873192548751831
Epoch: 40, Steps: 12 | Train Loss: 0.821 Vali Loss: 1.065 Vali Acc: 0.661 Test Loss: 1.065 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7898836135864258
Epoch: 41, Steps: 12 | Train Loss: 0.740 Vali Loss: 1.036 Vali Acc: 0.678 Test Loss: 1.036 Test Acc: 0.678
Validation loss decreased (-0.666656 --> -0.677767).  Saving model ...
Epoch: 42 cost time: 0.8253781795501709
Epoch: 42, Steps: 12 | Train Loss: 0.739 Vali Loss: 1.009 Vali Acc: 0.689 Test Loss: 1.009 Test Acc: 0.689
Validation loss decreased (-0.677767 --> -0.688879).  Saving model ...
Epoch: 43 cost time: 0.9209532737731934
Epoch: 43, Steps: 12 | Train Loss: 0.653 Vali Loss: 0.983 Vali Acc: 0.700 Test Loss: 0.983 Test Acc: 0.700
Validation loss decreased (-0.688879 --> -0.699990).  Saving model ...
Epoch: 44 cost time: 0.8445026874542236
Epoch: 44, Steps: 12 | Train Loss: 0.639 Vali Loss: 0.965 Vali Acc: 0.706 Test Loss: 0.965 Test Acc: 0.706
Validation loss decreased (-0.699990 --> -0.705546).  Saving model ...
Epoch: 45 cost time: 0.803978681564331
Epoch: 45, Steps: 12 | Train Loss: 0.628 Vali Loss: 0.950 Vali Acc: 0.706 Test Loss: 0.950 Test Acc: 0.706
Validation loss decreased (-0.705546 --> -0.705546).  Saving model ...
Epoch: 46 cost time: 0.7662022113800049
Epoch: 46, Steps: 12 | Train Loss: 0.644 Vali Loss: 0.925 Vali Acc: 0.733 Test Loss: 0.925 Test Acc: 0.733
Validation loss decreased (-0.705546 --> -0.733324).  Saving model ...
Epoch: 47 cost time: 0.7582166194915771
Epoch: 47, Steps: 12 | Train Loss: 0.664 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9292502403259277
Epoch: 48, Steps: 12 | Train Loss: 0.552 Vali Loss: 0.898 Vali Acc: 0.739 Test Loss: 0.898 Test Acc: 0.739
Validation loss decreased (-0.733324 --> -0.738880).  Saving model ...
Epoch: 49 cost time: 0.9033331871032715
Epoch: 49, Steps: 12 | Train Loss: 0.533 Vali Loss: 0.883 Vali Acc: 0.728 Test Loss: 0.883 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6880948543548584
Epoch: 50, Steps: 12 | Train Loss: 0.548 Vali Loss: 0.872 Vali Acc: 0.739 Test Loss: 0.872 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 51 cost time: 0.9498045444488525
Epoch: 51, Steps: 12 | Train Loss: 0.526 Vali Loss: 0.869 Vali Acc: 0.739 Test Loss: 0.869 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 52 cost time: 0.9356648921966553
Epoch: 52, Steps: 12 | Train Loss: 0.527 Vali Loss: 0.856 Vali Acc: 0.739 Test Loss: 0.856 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 53 cost time: 1.068985939025879
Epoch: 53, Steps: 12 | Train Loss: 0.456 Vali Loss: 0.853 Vali Acc: 0.739 Test Loss: 0.853 Test Acc: 0.739
Validation loss decreased (-0.738880 --> -0.738880).  Saving model ...
Epoch: 54 cost time: 0.8913571834564209
Epoch: 54, Steps: 12 | Train Loss: 0.481 Vali Loss: 0.843 Vali Acc: 0.750 Test Loss: 0.843 Test Acc: 0.750
Validation loss decreased (-0.738880 --> -0.749992).  Saving model ...
Epoch: 55 cost time: 0.855872631072998
Epoch: 55, Steps: 12 | Train Loss: 0.504 Vali Loss: 0.821 Vali Acc: 0.744 Test Loss: 0.821 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8875000476837158
Epoch: 56, Steps: 12 | Train Loss: 0.432 Vali Loss: 0.806 Vali Acc: 0.756 Test Loss: 0.806 Test Acc: 0.756
Validation loss decreased (-0.749992 --> -0.755547).  Saving model ...
Epoch: 57 cost time: 1.1087121963500977
Epoch: 57, Steps: 12 | Train Loss: 0.413 Vali Loss: 0.803 Vali Acc: 0.750 Test Loss: 0.803 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.749558687210083
Epoch: 58, Steps: 12 | Train Loss: 0.391 Vali Loss: 0.809 Vali Acc: 0.750 Test Loss: 0.809 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.7468950748443604
Epoch: 59, Steps: 12 | Train Loss: 0.382 Vali Loss: 0.817 Vali Acc: 0.739 Test Loss: 0.817 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7480990886688232
Epoch: 60, Steps: 12 | Train Loss: 0.367 Vali Loss: 0.807 Vali Acc: 0.750 Test Loss: 0.807 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.7956357002258301
Epoch: 61, Steps: 12 | Train Loss: 0.434 Vali Loss: 0.785 Vali Acc: 0.744 Test Loss: 0.785 Test Acc: 0.744
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8918132781982422
Epoch: 62, Steps: 12 | Train Loss: 0.358 Vali Loss: 0.787 Vali Acc: 0.761 Test Loss: 0.787 Test Acc: 0.761
Validation loss decreased (-0.755547 --> -0.761103).  Saving model ...
Epoch: 63 cost time: 0.9953844547271729
Epoch: 63, Steps: 12 | Train Loss: 0.343 Vali Loss: 0.793 Vali Acc: 0.750 Test Loss: 0.793 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9066905975341797
Epoch: 64, Steps: 12 | Train Loss: 0.346 Vali Loss: 0.805 Vali Acc: 0.750 Test Loss: 0.805 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8568789958953857
Epoch: 65, Steps: 12 | Train Loss: 0.318 Vali Loss: 0.793 Vali Acc: 0.739 Test Loss: 0.793 Test Acc: 0.739
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8185806274414062
Epoch: 66, Steps: 12 | Train Loss: 0.310 Vali Loss: 0.796 Vali Acc: 0.750 Test Loss: 0.796 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9113476276397705
Epoch: 67, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.811 Vali Acc: 0.733 Test Loss: 0.811 Test Acc: 0.733
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9332225322723389
Epoch: 68, Steps: 12 | Train Loss: 0.289 Vali Loss: 0.801 Vali Acc: 0.739 Test Loss: 0.801 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.191511631011963
Epoch: 69, Steps: 12 | Train Loss: 0.287 Vali Loss: 0.795 Vali Acc: 0.750 Test Loss: 0.795 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.913292407989502
Epoch: 70, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.807 Vali Acc: 0.756 Test Loss: 0.807 Test Acc: 0.756
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.0942165851593018
Epoch: 71, Steps: 12 | Train Loss: 0.351 Vali Loss: 0.849 Vali Acc: 0.756 Test Loss: 0.849 Test Acc: 0.756
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.929046630859375
Epoch: 72, Steps: 12 | Train Loss: 0.255 Vali Loss: 0.810 Vali Acc: 0.750 Test Loss: 0.810 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7611111111111111
model parameter : 4499
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.3942222595214844
Epoch: 1, Steps: 12 | Train Loss: 2.862 Vali Loss: 2.866 Vali Acc: 0.056 Test Loss: 2.866 Test Acc: 0.056
Validation loss decreased (inf --> -0.055527).  Saving model ...
Epoch: 2 cost time: 0.7789065837860107
Epoch: 2, Steps: 12 | Train Loss: 2.882 Vali Loss: 2.837 Vali Acc: 0.056 Test Loss: 2.837 Test Acc: 0.056
Validation loss decreased (-0.055527 --> -0.055527).  Saving model ...
Epoch: 3 cost time: 0.5733213424682617
Epoch: 3, Steps: 12 | Train Loss: 2.826 Vali Loss: 2.798 Vali Acc: 0.061 Test Loss: 2.798 Test Acc: 0.061
Validation loss decreased (-0.055527 --> -0.061083).  Saving model ...
Epoch: 4 cost time: 0.7916028499603271
Epoch: 4, Steps: 12 | Train Loss: 2.776 Vali Loss: 2.753 Vali Acc: 0.061 Test Loss: 2.753 Test Acc: 0.061
Validation loss decreased (-0.061083 --> -0.061084).  Saving model ...
Epoch: 5 cost time: 0.845242977142334
Epoch: 5, Steps: 12 | Train Loss: 2.732 Vali Loss: 2.707 Vali Acc: 0.072 Test Loss: 2.707 Test Acc: 0.072
Validation loss decreased (-0.061084 --> -0.072195).  Saving model ...
Epoch: 6 cost time: 0.7317519187927246
Epoch: 6, Steps: 12 | Train Loss: 2.687 Vali Loss: 2.657 Vali Acc: 0.078 Test Loss: 2.657 Test Acc: 0.078
Validation loss decreased (-0.072195 --> -0.077751).  Saving model ...
Epoch: 7 cost time: 0.7799332141876221
Epoch: 7, Steps: 12 | Train Loss: 2.620 Vali Loss: 2.602 Vali Acc: 0.111 Test Loss: 2.602 Test Acc: 0.111
Validation loss decreased (-0.077751 --> -0.111085).  Saving model ...
Epoch: 8 cost time: 0.8522191047668457
Epoch: 8, Steps: 12 | Train Loss: 2.563 Vali Loss: 2.546 Vali Acc: 0.128 Test Loss: 2.546 Test Acc: 0.128
Validation loss decreased (-0.111085 --> -0.127752).  Saving model ...
Epoch: 9 cost time: 0.6585805416107178
Epoch: 9, Steps: 12 | Train Loss: 2.490 Vali Loss: 2.492 Vali Acc: 0.183 Test Loss: 2.492 Test Acc: 0.183
Validation loss decreased (-0.127752 --> -0.183308).  Saving model ...
Epoch: 10 cost time: 0.6698431968688965
Epoch: 10, Steps: 12 | Train Loss: 2.437 Vali Loss: 2.435 Vali Acc: 0.267 Test Loss: 2.435 Test Acc: 0.267
Validation loss decreased (-0.183308 --> -0.266642).  Saving model ...
Epoch: 11 cost time: 0.8255705833435059
Epoch: 11, Steps: 12 | Train Loss: 2.372 Vali Loss: 2.379 Vali Acc: 0.322 Test Loss: 2.379 Test Acc: 0.322
Validation loss decreased (-0.266642 --> -0.322198).  Saving model ...
Epoch: 12 cost time: 0.712731122970581
Epoch: 12, Steps: 12 | Train Loss: 2.337 Vali Loss: 2.321 Vali Acc: 0.372 Test Loss: 2.321 Test Acc: 0.372
Validation loss decreased (-0.322198 --> -0.372199).  Saving model ...
Epoch: 13 cost time: 0.8395640850067139
Epoch: 13, Steps: 12 | Train Loss: 2.229 Vali Loss: 2.262 Vali Acc: 0.428 Test Loss: 2.262 Test Acc: 0.428
Validation loss decreased (-0.372199 --> -0.427755).  Saving model ...
Epoch: 14 cost time: 0.9240367412567139
Epoch: 14, Steps: 12 | Train Loss: 2.149 Vali Loss: 2.203 Vali Acc: 0.444 Test Loss: 2.203 Test Acc: 0.444
Validation loss decreased (-0.427755 --> -0.444422).  Saving model ...
Epoch: 15 cost time: 0.7277266979217529
Epoch: 15, Steps: 12 | Train Loss: 2.113 Vali Loss: 2.143 Vali Acc: 0.478 Test Loss: 2.143 Test Acc: 0.478
Validation loss decreased (-0.444422 --> -0.477756).  Saving model ...
Epoch: 16 cost time: 0.6735115051269531
Epoch: 16, Steps: 12 | Train Loss: 1.993 Vali Loss: 2.080 Vali Acc: 0.478 Test Loss: 2.080 Test Acc: 0.478
Validation loss decreased (-0.477756 --> -0.477757).  Saving model ...
Epoch: 17 cost time: 0.7592024803161621
Epoch: 17, Steps: 12 | Train Loss: 1.970 Vali Loss: 2.021 Vali Acc: 0.511 Test Loss: 2.021 Test Acc: 0.511
Validation loss decreased (-0.477757 --> -0.511091).  Saving model ...
Epoch: 18 cost time: 0.7523314952850342
Epoch: 18, Steps: 12 | Train Loss: 1.895 Vali Loss: 1.966 Vali Acc: 0.544 Test Loss: 1.966 Test Acc: 0.544
Validation loss decreased (-0.511091 --> -0.544425).  Saving model ...
Epoch: 19 cost time: 0.7942099571228027
Epoch: 19, Steps: 12 | Train Loss: 1.820 Vali Loss: 1.918 Vali Acc: 0.544 Test Loss: 1.918 Test Acc: 0.544
Validation loss decreased (-0.544425 --> -0.544425).  Saving model ...
Epoch: 20 cost time: 0.874718427658081
Epoch: 20, Steps: 12 | Train Loss: 1.761 Vali Loss: 1.870 Vali Acc: 0.550 Test Loss: 1.870 Test Acc: 0.550
Validation loss decreased (-0.544425 --> -0.549981).  Saving model ...
Epoch: 21 cost time: 0.7010180950164795
Epoch: 21, Steps: 12 | Train Loss: 1.713 Vali Loss: 1.822 Vali Acc: 0.561 Test Loss: 1.822 Test Acc: 0.561
Validation loss decreased (-0.549981 --> -0.561093).  Saving model ...
Epoch: 22 cost time: 0.9088027477264404
Epoch: 22, Steps: 12 | Train Loss: 1.671 Vali Loss: 1.781 Vali Acc: 0.572 Test Loss: 1.781 Test Acc: 0.572
Validation loss decreased (-0.561093 --> -0.572204).  Saving model ...
Epoch: 23 cost time: 0.7663712501525879
Epoch: 23, Steps: 12 | Train Loss: 1.548 Vali Loss: 1.732 Vali Acc: 0.594 Test Loss: 1.732 Test Acc: 0.594
Validation loss decreased (-0.572204 --> -0.594427).  Saving model ...
Epoch: 24 cost time: 0.6815516948699951
Epoch: 24, Steps: 12 | Train Loss: 1.531 Vali Loss: 1.700 Vali Acc: 0.594 Test Loss: 1.700 Test Acc: 0.594
Validation loss decreased (-0.594427 --> -0.594427).  Saving model ...
Epoch: 25 cost time: 0.8536989688873291
Epoch: 25, Steps: 12 | Train Loss: 1.483 Vali Loss: 1.663 Vali Acc: 0.611 Test Loss: 1.663 Test Acc: 0.611
Validation loss decreased (-0.594427 --> -0.611094).  Saving model ...
Epoch: 26 cost time: 0.9432170391082764
Epoch: 26, Steps: 12 | Train Loss: 1.414 Vali Loss: 1.621 Vali Acc: 0.594 Test Loss: 1.621 Test Acc: 0.594
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9228827953338623
Epoch: 27, Steps: 12 | Train Loss: 1.378 Vali Loss: 1.581 Vali Acc: 0.600 Test Loss: 1.581 Test Acc: 0.600
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7228665351867676
Epoch: 28, Steps: 12 | Train Loss: 1.352 Vali Loss: 1.539 Vali Acc: 0.606 Test Loss: 1.539 Test Acc: 0.606
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6811010837554932
Epoch: 29, Steps: 12 | Train Loss: 1.276 Vali Loss: 1.494 Vali Acc: 0.594 Test Loss: 1.494 Test Acc: 0.594
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8463249206542969
Epoch: 30, Steps: 12 | Train Loss: 1.269 Vali Loss: 1.464 Vali Acc: 0.600 Test Loss: 1.464 Test Acc: 0.600
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9077961444854736
Epoch: 31, Steps: 12 | Train Loss: 1.210 Vali Loss: 1.423 Vali Acc: 0.606 Test Loss: 1.423 Test Acc: 0.606
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.766395092010498
Epoch: 32, Steps: 12 | Train Loss: 1.121 Vali Loss: 1.390 Vali Acc: 0.606 Test Loss: 1.390 Test Acc: 0.606
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7923238277435303
Epoch: 33, Steps: 12 | Train Loss: 1.118 Vali Loss: 1.340 Vali Acc: 0.617 Test Loss: 1.340 Test Acc: 0.617
Validation loss decreased (-0.611094 --> -0.616653).  Saving model ...
Epoch: 34 cost time: 0.7557213306427002
Epoch: 34, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.291 Vali Acc: 0.628 Test Loss: 1.291 Test Acc: 0.628
Validation loss decreased (-0.616653 --> -0.627765).  Saving model ...
Epoch: 35 cost time: 0.8386242389678955
Epoch: 35, Steps: 12 | Train Loss: 1.048 Vali Loss: 1.248 Vali Acc: 0.628 Test Loss: 1.248 Test Acc: 0.628
Validation loss decreased (-0.627765 --> -0.627765).  Saving model ...
Epoch: 36 cost time: 0.9293215274810791
Epoch: 36, Steps: 12 | Train Loss: 0.996 Vali Loss: 1.193 Vali Acc: 0.650 Test Loss: 1.193 Test Acc: 0.650
Validation loss decreased (-0.627765 --> -0.649988).  Saving model ...
Epoch: 37 cost time: 0.7172911167144775
Epoch: 37, Steps: 12 | Train Loss: 0.870 Vali Loss: 1.129 Vali Acc: 0.683 Test Loss: 1.129 Test Acc: 0.683
Validation loss decreased (-0.649988 --> -0.683322).  Saving model ...
Epoch: 38 cost time: 0.6781835556030273
Epoch: 38, Steps: 12 | Train Loss: 0.881 Vali Loss: 1.076 Vali Acc: 0.672 Test Loss: 1.076 Test Acc: 0.672
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7620131969451904
Epoch: 39, Steps: 12 | Train Loss: 0.767 Vali Loss: 0.991 Vali Acc: 0.689 Test Loss: 0.991 Test Acc: 0.689
Validation loss decreased (-0.683322 --> -0.688879).  Saving model ...
Epoch: 40 cost time: 0.6415848731994629
Epoch: 40, Steps: 12 | Train Loss: 0.746 Vali Loss: 0.939 Vali Acc: 0.706 Test Loss: 0.939 Test Acc: 0.706
Validation loss decreased (-0.688879 --> -0.705546).  Saving model ...
Epoch: 41 cost time: 0.5678787231445312
Epoch: 41, Steps: 12 | Train Loss: 0.669 Vali Loss: 0.860 Vali Acc: 0.744 Test Loss: 0.860 Test Acc: 0.744
Validation loss decreased (-0.705546 --> -0.744436).  Saving model ...
Epoch: 42 cost time: 0.6954255104064941
Epoch: 42, Steps: 12 | Train Loss: 0.605 Vali Loss: 0.805 Vali Acc: 0.756 Test Loss: 0.805 Test Acc: 0.756
Validation loss decreased (-0.744436 --> -0.755548).  Saving model ...
Epoch: 43 cost time: 0.7877602577209473
Epoch: 43, Steps: 12 | Train Loss: 0.557 Vali Loss: 0.759 Vali Acc: 0.778 Test Loss: 0.759 Test Acc: 0.778
Validation loss decreased (-0.755548 --> -0.777770).  Saving model ...
Epoch: 44 cost time: 0.9083602428436279
Epoch: 44, Steps: 12 | Train Loss: 0.522 Vali Loss: 0.719 Vali Acc: 0.750 Test Loss: 0.719 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.73343825340271
Epoch: 45, Steps: 12 | Train Loss: 0.474 Vali Loss: 0.689 Vali Acc: 0.778 Test Loss: 0.689 Test Acc: 0.778
Validation loss decreased (-0.777770 --> -0.777771).  Saving model ...
Epoch: 46 cost time: 0.5892038345336914
Epoch: 46, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
Validation loss decreased (-0.777771 --> -0.788882).  Saving model ...
Epoch: 47 cost time: 0.6754531860351562
Epoch: 47, Steps: 12 | Train Loss: 0.414 Vali Loss: 0.643 Vali Acc: 0.772 Test Loss: 0.643 Test Acc: 0.772
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5727901458740234
Epoch: 48, Steps: 12 | Train Loss: 0.448 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7216389179229736
Epoch: 49, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7166481018066406
Epoch: 50, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.598 Vali Acc: 0.778 Test Loss: 0.598 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7236764430999756
Epoch: 51, Steps: 12 | Train Loss: 0.385 Vali Loss: 0.598 Vali Acc: 0.778 Test Loss: 0.598 Test Acc: 0.778
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.7690796852111816
Epoch: 52, Steps: 12 | Train Loss: 0.307 Vali Loss: 0.591 Vali Acc: 0.778 Test Loss: 0.591 Test Acc: 0.778
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8486678600311279
Epoch: 53, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.576 Vali Acc: 0.772 Test Loss: 0.576 Test Acc: 0.772
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.7567284107208252
Epoch: 54, Steps: 12 | Train Loss: 0.283 Vali Loss: 0.570 Vali Acc: 0.772 Test Loss: 0.570 Test Acc: 0.772
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7670609951019287
Epoch: 55, Steps: 12 | Train Loss: 0.264 Vali Loss: 0.572 Vali Acc: 0.767 Test Loss: 0.572 Test Acc: 0.767
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.9672505855560303
Epoch: 56, Steps: 12 | Train Loss: 0.281 Vali Loss: 0.561 Vali Acc: 0.772 Test Loss: 0.561 Test Acc: 0.772
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.7888888888888889
model parameter : 4386
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.2729673385620117
Epoch: 1, Steps: 12 | Train Loss: 2.840 Vali Loss: 2.769 Vali Acc: 0.039 Test Loss: 2.769 Test Acc: 0.039
Validation loss decreased (inf --> -0.038861).  Saving model ...
Epoch: 2 cost time: 0.768449068069458
Epoch: 2, Steps: 12 | Train Loss: 2.829 Vali Loss: 2.745 Vali Acc: 0.039 Test Loss: 2.745 Test Acc: 0.039
Validation loss decreased (-0.038861 --> -0.038861).  Saving model ...
Epoch: 3 cost time: 0.7899270057678223
Epoch: 3, Steps: 12 | Train Loss: 2.802 Vali Loss: 2.713 Vali Acc: 0.050 Test Loss: 2.713 Test Acc: 0.050
Validation loss decreased (-0.038861 --> -0.049973).  Saving model ...
Epoch: 4 cost time: 0.6971726417541504
Epoch: 4, Steps: 12 | Train Loss: 2.770 Vali Loss: 2.675 Vali Acc: 0.050 Test Loss: 2.675 Test Acc: 0.050
Validation loss decreased (-0.049973 --> -0.049973).  Saving model ...
Epoch: 5 cost time: 0.7374505996704102
Epoch: 5, Steps: 12 | Train Loss: 2.696 Vali Loss: 2.634 Vali Acc: 0.072 Test Loss: 2.634 Test Acc: 0.072
Validation loss decreased (-0.049973 --> -0.072196).  Saving model ...
Epoch: 6 cost time: 0.7824749946594238
Epoch: 6, Steps: 12 | Train Loss: 2.644 Vali Loss: 2.589 Vali Acc: 0.094 Test Loss: 2.589 Test Acc: 0.094
Validation loss decreased (-0.072196 --> -0.094419).  Saving model ...
Epoch: 7 cost time: 0.7194883823394775
Epoch: 7, Steps: 12 | Train Loss: 2.607 Vali Loss: 2.542 Vali Acc: 0.128 Test Loss: 2.542 Test Acc: 0.128
Validation loss decreased (-0.094419 --> -0.127752).  Saving model ...
Epoch: 8 cost time: 0.663475513458252
Epoch: 8, Steps: 12 | Train Loss: 2.556 Vali Loss: 2.494 Vali Acc: 0.161 Test Loss: 2.494 Test Acc: 0.161
Validation loss decreased (-0.127752 --> -0.161086).  Saving model ...
Epoch: 9 cost time: 0.8553416728973389
Epoch: 9, Steps: 12 | Train Loss: 2.513 Vali Loss: 2.441 Vali Acc: 0.172 Test Loss: 2.441 Test Acc: 0.172
Validation loss decreased (-0.161086 --> -0.172198).  Saving model ...
Epoch: 10 cost time: 0.6544253826141357
Epoch: 10, Steps: 12 | Train Loss: 2.416 Vali Loss: 2.390 Vali Acc: 0.244 Test Loss: 2.390 Test Acc: 0.244
Validation loss decreased (-0.172198 --> -0.244421).  Saving model ...
Epoch: 11 cost time: 0.658564567565918
Epoch: 11, Steps: 12 | Train Loss: 2.370 Vali Loss: 2.334 Vali Acc: 0.289 Test Loss: 2.334 Test Acc: 0.289
Validation loss decreased (-0.244421 --> -0.288866).  Saving model ...
Epoch: 12 cost time: 0.8726792335510254
Epoch: 12, Steps: 12 | Train Loss: 2.310 Vali Loss: 2.278 Vali Acc: 0.328 Test Loss: 2.278 Test Acc: 0.328
Validation loss decreased (-0.288866 --> -0.327755).  Saving model ...
Epoch: 13 cost time: 1.0736010074615479
Epoch: 13, Steps: 12 | Train Loss: 2.246 Vali Loss: 2.223 Vali Acc: 0.372 Test Loss: 2.223 Test Acc: 0.372
Validation loss decreased (-0.327755 --> -0.372200).  Saving model ...
Epoch: 14 cost time: 0.8142528533935547
Epoch: 14, Steps: 12 | Train Loss: 2.152 Vali Loss: 2.169 Vali Acc: 0.417 Test Loss: 2.169 Test Acc: 0.417
Validation loss decreased (-0.372200 --> -0.416645).  Saving model ...
Epoch: 15 cost time: 0.8630461692810059
Epoch: 15, Steps: 12 | Train Loss: 2.116 Vali Loss: 2.115 Vali Acc: 0.428 Test Loss: 2.115 Test Acc: 0.428
Validation loss decreased (-0.416645 --> -0.427757).  Saving model ...
Epoch: 16 cost time: 1.2287766933441162
Epoch: 16, Steps: 12 | Train Loss: 2.050 Vali Loss: 2.061 Vali Acc: 0.439 Test Loss: 2.061 Test Acc: 0.439
Validation loss decreased (-0.427757 --> -0.438868).  Saving model ...
Epoch: 17 cost time: 0.8801212310791016
Epoch: 17, Steps: 12 | Train Loss: 1.972 Vali Loss: 2.008 Vali Acc: 0.461 Test Loss: 2.008 Test Acc: 0.461
Validation loss decreased (-0.438868 --> -0.461091).  Saving model ...
Epoch: 18 cost time: 0.971390962600708
Epoch: 18, Steps: 12 | Train Loss: 1.894 Vali Loss: 1.957 Vali Acc: 0.467 Test Loss: 1.957 Test Acc: 0.467
Validation loss decreased (-0.461091 --> -0.466647).  Saving model ...
Epoch: 19 cost time: 0.9624805450439453
Epoch: 19, Steps: 12 | Train Loss: 1.856 Vali Loss: 1.908 Vali Acc: 0.506 Test Loss: 1.908 Test Acc: 0.506
Validation loss decreased (-0.466647 --> -0.505536).  Saving model ...
Epoch: 20 cost time: 0.7674722671508789
Epoch: 20, Steps: 12 | Train Loss: 1.753 Vali Loss: 1.867 Vali Acc: 0.494 Test Loss: 1.867 Test Acc: 0.494
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6717147827148438
Epoch: 21, Steps: 12 | Train Loss: 1.743 Vali Loss: 1.822 Vali Acc: 0.511 Test Loss: 1.822 Test Acc: 0.511
Validation loss decreased (-0.505536 --> -0.511093).  Saving model ...
Epoch: 22 cost time: 1.1910715103149414
Epoch: 22, Steps: 12 | Train Loss: 1.731 Vali Loss: 1.785 Vali Acc: 0.506 Test Loss: 1.785 Test Acc: 0.506
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9722228050231934
Epoch: 23, Steps: 12 | Train Loss: 1.615 Vali Loss: 1.748 Vali Acc: 0.539 Test Loss: 1.748 Test Acc: 0.539
Validation loss decreased (-0.511093 --> -0.538871).  Saving model ...
Epoch: 24 cost time: 0.9236252307891846
Epoch: 24, Steps: 12 | Train Loss: 1.601 Vali Loss: 1.714 Vali Acc: 0.539 Test Loss: 1.714 Test Acc: 0.539
Validation loss decreased (-0.538871 --> -0.538872).  Saving model ...
Epoch: 25 cost time: 0.8721835613250732
Epoch: 25, Steps: 12 | Train Loss: 1.526 Vali Loss: 1.682 Vali Acc: 0.550 Test Loss: 1.682 Test Acc: 0.550
Validation loss decreased (-0.538872 --> -0.549983).  Saving model ...
Epoch: 26 cost time: 0.8254296779632568
Epoch: 26, Steps: 12 | Train Loss: 1.464 Vali Loss: 1.649 Vali Acc: 0.556 Test Loss: 1.649 Test Acc: 0.556
Validation loss decreased (-0.549983 --> -0.555539).  Saving model ...
Epoch: 27 cost time: 0.8301265239715576
Epoch: 27, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.616 Vali Acc: 0.561 Test Loss: 1.616 Test Acc: 0.561
Validation loss decreased (-0.555539 --> -0.561095).  Saving model ...
Epoch: 28 cost time: 0.8225092887878418
Epoch: 28, Steps: 12 | Train Loss: 1.477 Vali Loss: 1.590 Vali Acc: 0.544 Test Loss: 1.590 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9193665981292725
Epoch: 29, Steps: 12 | Train Loss: 1.438 Vali Loss: 1.562 Vali Acc: 0.556 Test Loss: 1.562 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9537527561187744
Epoch: 30, Steps: 12 | Train Loss: 1.337 Vali Loss: 1.537 Vali Acc: 0.556 Test Loss: 1.537 Test Acc: 0.556
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9656612873077393
Epoch: 31, Steps: 12 | Train Loss: 1.300 Vali Loss: 1.506 Vali Acc: 0.567 Test Loss: 1.506 Test Acc: 0.567
Validation loss decreased (-0.561095 --> -0.566652).  Saving model ...
Epoch: 32 cost time: 0.8631260395050049
Epoch: 32, Steps: 12 | Train Loss: 1.294 Vali Loss: 1.478 Vali Acc: 0.572 Test Loss: 1.478 Test Acc: 0.572
Validation loss decreased (-0.566652 --> -0.572207).  Saving model ...
Epoch: 33 cost time: 0.9576539993286133
Epoch: 33, Steps: 12 | Train Loss: 1.303 Vali Loss: 1.452 Vali Acc: 0.583 Test Loss: 1.452 Test Acc: 0.583
Validation loss decreased (-0.572207 --> -0.583319).  Saving model ...
Epoch: 34 cost time: 0.8901968002319336
Epoch: 34, Steps: 12 | Train Loss: 1.277 Vali Loss: 1.420 Vali Acc: 0.572 Test Loss: 1.420 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.084326982498169
Epoch: 35, Steps: 12 | Train Loss: 1.182 Vali Loss: 1.396 Vali Acc: 0.594 Test Loss: 1.396 Test Acc: 0.594
Validation loss decreased (-0.583319 --> -0.594430).  Saving model ...
Epoch: 36 cost time: 0.8839590549468994
Epoch: 36, Steps: 12 | Train Loss: 1.202 Vali Loss: 1.376 Vali Acc: 0.589 Test Loss: 1.376 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0273189544677734
Epoch: 37, Steps: 12 | Train Loss: 1.197 Vali Loss: 1.347 Vali Acc: 0.622 Test Loss: 1.347 Test Acc: 0.622
Validation loss decreased (-0.594430 --> -0.622209).  Saving model ...
Epoch: 38 cost time: 0.9693088531494141
Epoch: 38, Steps: 12 | Train Loss: 1.147 Vali Loss: 1.323 Vali Acc: 0.617 Test Loss: 1.323 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8334100246429443
Epoch: 39, Steps: 12 | Train Loss: 1.089 Vali Loss: 1.296 Vali Acc: 0.617 Test Loss: 1.296 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.977576732635498
Epoch: 40, Steps: 12 | Train Loss: 1.018 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.622209 --> -0.622210).  Saving model ...
Epoch: 41 cost time: 0.9046177864074707
Epoch: 41, Steps: 12 | Train Loss: 0.984 Vali Loss: 1.244 Vali Acc: 0.617 Test Loss: 1.244 Test Acc: 0.617
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9822194576263428
Epoch: 42, Steps: 12 | Train Loss: 0.995 Vali Loss: 1.195 Vali Acc: 0.611 Test Loss: 1.195 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2114245891571045
Epoch: 43, Steps: 12 | Train Loss: 0.991 Vali Loss: 1.176 Vali Acc: 0.617 Test Loss: 1.176 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9399411678314209
Epoch: 44, Steps: 12 | Train Loss: 0.922 Vali Loss: 1.166 Vali Acc: 0.628 Test Loss: 1.166 Test Acc: 0.628
Validation loss decreased (-0.622210 --> -0.627766).  Saving model ...
Epoch: 45 cost time: 0.8072423934936523
Epoch: 45, Steps: 12 | Train Loss: 0.889 Vali Loss: 1.142 Vali Acc: 0.650 Test Loss: 1.142 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 46 cost time: 1.0179474353790283
Epoch: 46, Steps: 12 | Train Loss: 0.845 Vali Loss: 1.119 Vali Acc: 0.678 Test Loss: 1.119 Test Acc: 0.678
Validation loss decreased (-0.649989 --> -0.677767).  Saving model ...
Epoch: 47 cost time: 0.8317708969116211
Epoch: 47, Steps: 12 | Train Loss: 0.810 Vali Loss: 1.100 Vali Acc: 0.667 Test Loss: 1.100 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8284437656402588
Epoch: 48, Steps: 12 | Train Loss: 0.789 Vali Loss: 1.085 Vali Acc: 0.678 Test Loss: 1.085 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 49 cost time: 1.068061113357544
Epoch: 49, Steps: 12 | Train Loss: 0.742 Vali Loss: 1.052 Vali Acc: 0.678 Test Loss: 1.052 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 50 cost time: 1.1411726474761963
Epoch: 50, Steps: 12 | Train Loss: 0.750 Vali Loss: 1.042 Vali Acc: 0.678 Test Loss: 1.042 Test Acc: 0.678
Validation loss decreased (-0.677767 --> -0.677767).  Saving model ...
Epoch: 51 cost time: 0.7514629364013672
Epoch: 51, Steps: 12 | Train Loss: 0.698 Vali Loss: 0.997 Vali Acc: 0.683 Test Loss: 0.997 Test Acc: 0.683
Validation loss decreased (-0.677767 --> -0.683323).  Saving model ...
Epoch: 52 cost time: 0.9249382019042969
Epoch: 52, Steps: 12 | Train Loss: 0.702 Vali Loss: 0.983 Vali Acc: 0.711 Test Loss: 0.983 Test Acc: 0.711
Validation loss decreased (-0.683323 --> -0.711101).  Saving model ...
Epoch: 53 cost time: 0.7711477279663086
Epoch: 53, Steps: 12 | Train Loss: 0.733 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
Validation loss decreased (-0.711101 --> -0.711101).  Saving model ...
Epoch: 54 cost time: 0.8901190757751465
Epoch: 54, Steps: 12 | Train Loss: 0.607 Vali Loss: 0.963 Vali Acc: 0.728 Test Loss: 0.963 Test Acc: 0.728
Validation loss decreased (-0.711101 --> -0.727768).  Saving model ...
Epoch: 55 cost time: 0.9988231658935547
Epoch: 55, Steps: 12 | Train Loss: 0.592 Vali Loss: 0.940 Vali Acc: 0.711 Test Loss: 0.940 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0361816883087158
Epoch: 56, Steps: 12 | Train Loss: 0.611 Vali Loss: 0.941 Vali Acc: 0.728 Test Loss: 0.941 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727768).  Saving model ...
Epoch: 57 cost time: 0.9830021858215332
Epoch: 57, Steps: 12 | Train Loss: 0.568 Vali Loss: 0.898 Vali Acc: 0.728 Test Loss: 0.898 Test Acc: 0.728
Validation loss decreased (-0.727768 --> -0.727769).  Saving model ...
Epoch: 58 cost time: 0.8801069259643555
Epoch: 58, Steps: 12 | Train Loss: 0.559 Vali Loss: 0.928 Vali Acc: 0.722 Test Loss: 0.928 Test Acc: 0.722
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.1458525657653809
Epoch: 59, Steps: 12 | Train Loss: 0.536 Vali Loss: 0.877 Vali Acc: 0.744 Test Loss: 0.877 Test Acc: 0.744
Validation loss decreased (-0.727769 --> -0.744436).  Saving model ...
Epoch: 60 cost time: 0.744368314743042
Epoch: 60, Steps: 12 | Train Loss: 0.508 Vali Loss: 0.889 Vali Acc: 0.739 Test Loss: 0.889 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.226945161819458
Epoch: 61, Steps: 12 | Train Loss: 0.566 Vali Loss: 0.873 Vali Acc: 0.739 Test Loss: 0.873 Test Acc: 0.739
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7770607471466064
Epoch: 62, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.865 Vali Acc: 0.722 Test Loss: 0.865 Test Acc: 0.722
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8441650867462158
Epoch: 63, Steps: 12 | Train Loss: 0.457 Vali Loss: 0.854 Vali Acc: 0.744 Test Loss: 0.854 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 64 cost time: 0.6404142379760742
Epoch: 64, Steps: 12 | Train Loss: 0.444 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.680840253829956
Epoch: 65, Steps: 12 | Train Loss: 0.427 Vali Loss: 0.838 Vali Acc: 0.733 Test Loss: 0.838 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9631006717681885
Epoch: 66, Steps: 12 | Train Loss: 0.459 Vali Loss: 0.844 Vali Acc: 0.728 Test Loss: 0.844 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.741037130355835
Epoch: 67, Steps: 12 | Train Loss: 0.408 Vali Loss: 0.851 Vali Acc: 0.733 Test Loss: 0.851 Test Acc: 0.733
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9051065444946289
Epoch: 68, Steps: 12 | Train Loss: 0.396 Vali Loss: 0.857 Vali Acc: 0.728 Test Loss: 0.857 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8265981674194336
Epoch: 69, Steps: 12 | Train Loss: 0.373 Vali Loss: 0.845 Vali Acc: 0.739 Test Loss: 0.845 Test Acc: 0.739
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.9533758163452148
Epoch: 70, Steps: 12 | Train Loss: 0.404 Vali Loss: 0.837 Vali Acc: 0.750 Test Loss: 0.837 Test Acc: 0.750
Validation loss decreased (-0.744436 --> -0.749992).  Saving model ...
Epoch: 71 cost time: 0.7375226020812988
Epoch: 71, Steps: 12 | Train Loss: 0.363 Vali Loss: 0.853 Vali Acc: 0.728 Test Loss: 0.853 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.7528765201568604
Epoch: 72, Steps: 12 | Train Loss: 0.372 Vali Loss: 0.850 Vali Acc: 0.728 Test Loss: 0.850 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0432353019714355
Epoch: 73, Steps: 12 | Train Loss: 0.357 Vali Loss: 0.839 Vali Acc: 0.728 Test Loss: 0.839 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8352165222167969
Epoch: 74, Steps: 12 | Train Loss: 0.326 Vali Loss: 0.843 Vali Acc: 0.739 Test Loss: 0.843 Test Acc: 0.739
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.0700318813323975
Epoch: 75, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.858 Vali Acc: 0.728 Test Loss: 0.858 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8537793159484863
Epoch: 76, Steps: 12 | Train Loss: 0.353 Vali Loss: 0.859 Vali Acc: 0.733 Test Loss: 0.859 Test Acc: 0.733
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.7914829254150391
Epoch: 77, Steps: 12 | Train Loss: 0.331 Vali Loss: 0.872 Vali Acc: 0.711 Test Loss: 0.872 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.7893855571746826
Epoch: 78, Steps: 12 | Train Loss: 0.299 Vali Loss: 0.838 Vali Acc: 0.728 Test Loss: 0.838 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.8338289260864258
Epoch: 79, Steps: 12 | Train Loss: 0.297 Vali Loss: 0.876 Vali Acc: 0.717 Test Loss: 0.876 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.0246963500976562
Epoch: 80, Steps: 12 | Train Loss: 0.285 Vali Loss: 0.834 Vali Acc: 0.739 Test Loss: 0.834 Test Acc: 0.739
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.75
model parameter : 4643
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Libras          Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Libras
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             2                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

180
180
>>>>>>>start training : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
180
180
180
Epoch: 1 cost time: 2.0750925540924072
Epoch: 1, Steps: 12 | Train Loss: 2.764 Vali Loss: 2.696 Vali Acc: 0.061 Test Loss: 2.696 Test Acc: 0.061
Validation loss decreased (inf --> -0.061084).  Saving model ...
Epoch: 2 cost time: 0.9322803020477295
Epoch: 2, Steps: 12 | Train Loss: 2.738 Vali Loss: 2.673 Vali Acc: 0.050 Test Loss: 2.673 Test Acc: 0.050
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9053173065185547
Epoch: 3, Steps: 12 | Train Loss: 2.702 Vali Loss: 2.641 Vali Acc: 0.072 Test Loss: 2.641 Test Acc: 0.072
Validation loss decreased (-0.061084 --> -0.072196).  Saving model ...
Epoch: 4 cost time: 0.9608221054077148
Epoch: 4, Steps: 12 | Train Loss: 2.664 Vali Loss: 2.600 Vali Acc: 0.094 Test Loss: 2.600 Test Acc: 0.094
Validation loss decreased (-0.072196 --> -0.094418).  Saving model ...
Epoch: 5 cost time: 0.6173434257507324
Epoch: 5, Steps: 12 | Train Loss: 2.622 Vali Loss: 2.559 Vali Acc: 0.122 Test Loss: 2.559 Test Acc: 0.122
Validation loss decreased (-0.094418 --> -0.122197).  Saving model ...
Epoch: 6 cost time: 0.6349763870239258
Epoch: 6, Steps: 12 | Train Loss: 2.594 Vali Loss: 2.512 Vali Acc: 0.189 Test Loss: 2.512 Test Acc: 0.189
Validation loss decreased (-0.122197 --> -0.188864).  Saving model ...
Epoch: 7 cost time: 0.6040287017822266
Epoch: 7, Steps: 12 | Train Loss: 2.537 Vali Loss: 2.464 Vali Acc: 0.261 Test Loss: 2.464 Test Acc: 0.261
Validation loss decreased (-0.188864 --> -0.261086).  Saving model ...
Epoch: 8 cost time: 0.5489952564239502
Epoch: 8, Steps: 12 | Train Loss: 2.478 Vali Loss: 2.416 Vali Acc: 0.289 Test Loss: 2.416 Test Acc: 0.289
Validation loss decreased (-0.261086 --> -0.288865).  Saving model ...
Epoch: 9 cost time: 0.7540194988250732
Epoch: 9, Steps: 12 | Train Loss: 2.426 Vali Loss: 2.365 Vali Acc: 0.311 Test Loss: 2.365 Test Acc: 0.311
Validation loss decreased (-0.288865 --> -0.311087).  Saving model ...
Epoch: 10 cost time: 0.7074844837188721
Epoch: 10, Steps: 12 | Train Loss: 2.362 Vali Loss: 2.314 Vali Acc: 0.344 Test Loss: 2.314 Test Acc: 0.344
Validation loss decreased (-0.311087 --> -0.344421).  Saving model ...
Epoch: 11 cost time: 0.780109167098999
Epoch: 11, Steps: 12 | Train Loss: 2.326 Vali Loss: 2.261 Vali Acc: 0.356 Test Loss: 2.261 Test Acc: 0.356
Validation loss decreased (-0.344421 --> -0.355533).  Saving model ...
Epoch: 12 cost time: 0.7790610790252686
Epoch: 12, Steps: 12 | Train Loss: 2.256 Vali Loss: 2.208 Vali Acc: 0.378 Test Loss: 2.208 Test Acc: 0.378
Validation loss decreased (-0.355533 --> -0.377756).  Saving model ...
Epoch: 13 cost time: 0.7330327033996582
Epoch: 13, Steps: 12 | Train Loss: 2.203 Vali Loss: 2.154 Vali Acc: 0.383 Test Loss: 2.154 Test Acc: 0.383
Validation loss decreased (-0.377756 --> -0.383312).  Saving model ...
Epoch: 14 cost time: 0.6701622009277344
Epoch: 14, Steps: 12 | Train Loss: 2.148 Vali Loss: 2.102 Vali Acc: 0.400 Test Loss: 2.102 Test Acc: 0.400
Validation loss decreased (-0.383312 --> -0.399979).  Saving model ...
Epoch: 15 cost time: 0.7396128177642822
Epoch: 15, Steps: 12 | Train Loss: 2.061 Vali Loss: 2.049 Vali Acc: 0.433 Test Loss: 2.049 Test Acc: 0.433
Validation loss decreased (-0.399979 --> -0.433313).  Saving model ...
Epoch: 16 cost time: 0.6152844429016113
Epoch: 16, Steps: 12 | Train Loss: 1.998 Vali Loss: 2.002 Vali Acc: 0.439 Test Loss: 2.002 Test Acc: 0.439
Validation loss decreased (-0.433313 --> -0.438869).  Saving model ...
Epoch: 17 cost time: 0.9117438793182373
Epoch: 17, Steps: 12 | Train Loss: 1.904 Vali Loss: 1.953 Vali Acc: 0.439 Test Loss: 1.953 Test Acc: 0.439
Validation loss decreased (-0.438869 --> -0.438869).  Saving model ...
Epoch: 18 cost time: 0.9214394092559814
Epoch: 18, Steps: 12 | Train Loss: 1.900 Vali Loss: 1.907 Vali Acc: 0.428 Test Loss: 1.907 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7405779361724854
Epoch: 19, Steps: 12 | Train Loss: 1.772 Vali Loss: 1.862 Vali Acc: 0.461 Test Loss: 1.862 Test Acc: 0.461
Validation loss decreased (-0.438869 --> -0.461092).  Saving model ...
Epoch: 20 cost time: 0.7926175594329834
Epoch: 20, Steps: 12 | Train Loss: 1.738 Vali Loss: 1.824 Vali Acc: 0.478 Test Loss: 1.824 Test Acc: 0.478
Validation loss decreased (-0.461092 --> -0.477760).  Saving model ...
Epoch: 21 cost time: 0.6630566120147705
Epoch: 21, Steps: 12 | Train Loss: 1.704 Vali Loss: 1.784 Vali Acc: 0.528 Test Loss: 1.784 Test Acc: 0.528
Validation loss decreased (-0.477760 --> -0.527760).  Saving model ...
Epoch: 22 cost time: 0.7221331596374512
Epoch: 22, Steps: 12 | Train Loss: 1.631 Vali Loss: 1.749 Vali Acc: 0.533 Test Loss: 1.749 Test Acc: 0.533
Validation loss decreased (-0.527760 --> -0.533316).  Saving model ...
Epoch: 23 cost time: 0.72666335105896
Epoch: 23, Steps: 12 | Train Loss: 1.606 Vali Loss: 1.705 Vali Acc: 0.561 Test Loss: 1.705 Test Acc: 0.561
Validation loss decreased (-0.533316 --> -0.561094).  Saving model ...
Epoch: 24 cost time: 0.6850824356079102
Epoch: 24, Steps: 12 | Train Loss: 1.532 Vali Loss: 1.664 Vali Acc: 0.572 Test Loss: 1.664 Test Acc: 0.572
Validation loss decreased (-0.561094 --> -0.572206).  Saving model ...
Epoch: 25 cost time: 0.7334027290344238
Epoch: 25, Steps: 12 | Train Loss: 1.497 Vali Loss: 1.626 Vali Acc: 0.578 Test Loss: 1.626 Test Acc: 0.578
Validation loss decreased (-0.572206 --> -0.577762).  Saving model ...
Epoch: 26 cost time: 0.8897807598114014
Epoch: 26, Steps: 12 | Train Loss: 1.490 Vali Loss: 1.595 Vali Acc: 0.578 Test Loss: 1.595 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577762).  Saving model ...
Epoch: 27 cost time: 0.7899260520935059
Epoch: 27, Steps: 12 | Train Loss: 1.365 Vali Loss: 1.561 Vali Acc: 0.594 Test Loss: 1.561 Test Acc: 0.594
Validation loss decreased (-0.577762 --> -0.594429).  Saving model ...
Epoch: 28 cost time: 0.9774980545043945
Epoch: 28, Steps: 12 | Train Loss: 1.349 Vali Loss: 1.532 Vali Acc: 0.589 Test Loss: 1.532 Test Acc: 0.589
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8663778305053711
Epoch: 29, Steps: 12 | Train Loss: 1.313 Vali Loss: 1.491 Vali Acc: 0.622 Test Loss: 1.491 Test Acc: 0.622
Validation loss decreased (-0.594429 --> -0.622207).  Saving model ...
Epoch: 30 cost time: 0.8131957054138184
Epoch: 30, Steps: 12 | Train Loss: 1.306 Vali Loss: 1.464 Vali Acc: 0.622 Test Loss: 1.464 Test Acc: 0.622
Validation loss decreased (-0.622207 --> -0.622208).  Saving model ...
Epoch: 31 cost time: 0.8947432041168213
Epoch: 31, Steps: 12 | Train Loss: 1.248 Vali Loss: 1.431 Vali Acc: 0.606 Test Loss: 1.431 Test Acc: 0.606
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6615726947784424
Epoch: 32, Steps: 12 | Train Loss: 1.257 Vali Loss: 1.397 Vali Acc: 0.617 Test Loss: 1.397 Test Acc: 0.617
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7450835704803467
Epoch: 33, Steps: 12 | Train Loss: 1.194 Vali Loss: 1.369 Vali Acc: 0.611 Test Loss: 1.369 Test Acc: 0.611
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.946364164352417
Epoch: 34, Steps: 12 | Train Loss: 1.160 Vali Loss: 1.345 Vali Acc: 0.611 Test Loss: 1.345 Test Acc: 0.611
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7613012790679932
Epoch: 35, Steps: 12 | Train Loss: 1.115 Vali Loss: 1.320 Vali Acc: 0.622 Test Loss: 1.320 Test Acc: 0.622
Validation loss decreased (-0.622208 --> -0.622209).  Saving model ...
Epoch: 36 cost time: 0.9039406776428223
Epoch: 36, Steps: 12 | Train Loss: 1.064 Vali Loss: 1.296 Vali Acc: 0.611 Test Loss: 1.296 Test Acc: 0.611
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.928098201751709
Epoch: 37, Steps: 12 | Train Loss: 1.137 Vali Loss: 1.264 Vali Acc: 0.611 Test Loss: 1.264 Test Acc: 0.611
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7032179832458496
Epoch: 38, Steps: 12 | Train Loss: 1.051 Vali Loss: 1.233 Vali Acc: 0.617 Test Loss: 1.233 Test Acc: 0.617
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7966313362121582
Epoch: 39, Steps: 12 | Train Loss: 0.970 Vali Loss: 1.208 Vali Acc: 0.628 Test Loss: 1.208 Test Acc: 0.628
Validation loss decreased (-0.622209 --> -0.627766).  Saving model ...
Epoch: 40 cost time: 0.8424434661865234
Epoch: 40, Steps: 12 | Train Loss: 0.979 Vali Loss: 1.191 Vali Acc: 0.622 Test Loss: 1.191 Test Acc: 0.622
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.739842414855957
Epoch: 41, Steps: 12 | Train Loss: 1.008 Vali Loss: 1.168 Vali Acc: 0.628 Test Loss: 1.168 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627766).  Saving model ...
Epoch: 42 cost time: 0.8804779052734375
Epoch: 42, Steps: 12 | Train Loss: 0.905 Vali Loss: 1.138 Vali Acc: 0.628 Test Loss: 1.138 Test Acc: 0.628
Validation loss decreased (-0.627766 --> -0.627766).  Saving model ...
Epoch: 43 cost time: 0.9754819869995117
Epoch: 43, Steps: 12 | Train Loss: 0.856 Vali Loss: 1.117 Vali Acc: 0.650 Test Loss: 1.117 Test Acc: 0.650
Validation loss decreased (-0.627766 --> -0.649989).  Saving model ...
Epoch: 44 cost time: 1.000756025314331
Epoch: 44, Steps: 12 | Train Loss: 0.819 Vali Loss: 1.083 Vali Acc: 0.650 Test Loss: 1.083 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 45 cost time: 0.9814698696136475
Epoch: 45, Steps: 12 | Train Loss: 0.782 Vali Loss: 1.068 Vali Acc: 0.650 Test Loss: 1.068 Test Acc: 0.650
Validation loss decreased (-0.649989 --> -0.649989).  Saving model ...
Epoch: 46 cost time: 0.7235555648803711
Epoch: 46, Steps: 12 | Train Loss: 0.785 Vali Loss: 1.047 Vali Acc: 0.667 Test Loss: 1.047 Test Acc: 0.667
Validation loss decreased (-0.649989 --> -0.666656).  Saving model ...
Epoch: 47 cost time: 0.7959930896759033
Epoch: 47, Steps: 12 | Train Loss: 0.764 Vali Loss: 1.003 Vali Acc: 0.661 Test Loss: 1.003 Test Acc: 0.661
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6659462451934814
Epoch: 48, Steps: 12 | Train Loss: 0.684 Vali Loss: 0.978 Vali Acc: 0.694 Test Loss: 0.978 Test Acc: 0.694
Validation loss decreased (-0.666656 --> -0.694435).  Saving model ...
Epoch: 49 cost time: 0.5723876953125
Epoch: 49, Steps: 12 | Train Loss: 0.660 Vali Loss: 0.958 Vali Acc: 0.689 Test Loss: 0.958 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.844252347946167
Epoch: 50, Steps: 12 | Train Loss: 0.646 Vali Loss: 0.908 Vali Acc: 0.694 Test Loss: 0.908 Test Acc: 0.694
Validation loss decreased (-0.694435 --> -0.694435).  Saving model ...
Epoch: 51 cost time: 0.8738315105438232
Epoch: 51, Steps: 12 | Train Loss: 0.633 Vali Loss: 0.902 Vali Acc: 0.700 Test Loss: 0.902 Test Acc: 0.700
Validation loss decreased (-0.694435 --> -0.699991).  Saving model ...
Epoch: 52 cost time: 0.7995879650115967
Epoch: 52, Steps: 12 | Train Loss: 0.575 Vali Loss: 0.866 Vali Acc: 0.717 Test Loss: 0.866 Test Acc: 0.717
Validation loss decreased (-0.699991 --> -0.716658).  Saving model ...
Epoch: 53 cost time: 0.8136019706726074
Epoch: 53, Steps: 12 | Train Loss: 0.581 Vali Loss: 0.841 Vali Acc: 0.739 Test Loss: 0.841 Test Acc: 0.739
Validation loss decreased (-0.716658 --> -0.738880).  Saving model ...
Epoch: 54 cost time: 0.737825870513916
Epoch: 54, Steps: 12 | Train Loss: 0.550 Vali Loss: 0.829 Vali Acc: 0.744 Test Loss: 0.829 Test Acc: 0.744
Validation loss decreased (-0.738880 --> -0.744436).  Saving model ...
Epoch: 55 cost time: 0.627774715423584
Epoch: 55, Steps: 12 | Train Loss: 0.514 Vali Loss: 0.808 Vali Acc: 0.744 Test Loss: 0.808 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744436).  Saving model ...
Epoch: 56 cost time: 0.7038042545318604
Epoch: 56, Steps: 12 | Train Loss: 0.467 Vali Loss: 0.762 Vali Acc: 0.761 Test Loss: 0.762 Test Acc: 0.761
Validation loss decreased (-0.744436 --> -0.761103).  Saving model ...
Epoch: 57 cost time: 0.6362111568450928
Epoch: 57, Steps: 12 | Train Loss: 0.442 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
Validation loss decreased (-0.761103 --> -0.783326).  Saving model ...
Epoch: 58 cost time: 0.7482483386993408
Epoch: 58, Steps: 12 | Train Loss: 0.428 Vali Loss: 0.746 Vali Acc: 0.800 Test Loss: 0.746 Test Acc: 0.800
Validation loss decreased (-0.783326 --> -0.799993).  Saving model ...
Epoch: 59 cost time: 0.8342158794403076
Epoch: 59, Steps: 12 | Train Loss: 0.417 Vali Loss: 0.720 Vali Acc: 0.800 Test Loss: 0.720 Test Acc: 0.800
Validation loss decreased (-0.799993 --> -0.799993).  Saving model ...
Epoch: 60 cost time: 1.0369305610656738
Epoch: 60, Steps: 12 | Train Loss: 0.412 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2889158725738525
Epoch: 61, Steps: 12 | Train Loss: 0.381 Vali Loss: 0.687 Vali Acc: 0.806 Test Loss: 0.687 Test Acc: 0.806
Validation loss decreased (-0.799993 --> -0.805549).  Saving model ...
Epoch: 62 cost time: 0.8637313842773438
Epoch: 62, Steps: 12 | Train Loss: 0.378 Vali Loss: 0.685 Vali Acc: 0.778 Test Loss: 0.685 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 1.0004870891571045
Epoch: 63, Steps: 12 | Train Loss: 0.388 Vali Loss: 0.660 Vali Acc: 0.811 Test Loss: 0.660 Test Acc: 0.811
Validation loss decreased (-0.805549 --> -0.811105).  Saving model ...
Epoch: 64 cost time: 0.761474609375
Epoch: 64, Steps: 12 | Train Loss: 0.333 Vali Loss: 0.660 Vali Acc: 0.828 Test Loss: 0.660 Test Acc: 0.828
Validation loss decreased (-0.811105 --> -0.827771).  Saving model ...
Epoch: 65 cost time: 0.8976268768310547
Epoch: 65, Steps: 12 | Train Loss: 0.313 Vali Loss: 0.643 Vali Acc: 0.811 Test Loss: 0.643 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9182620048522949
Epoch: 66, Steps: 12 | Train Loss: 0.317 Vali Loss: 0.624 Vali Acc: 0.817 Test Loss: 0.624 Test Acc: 0.817
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.904700517654419
Epoch: 67, Steps: 12 | Train Loss: 0.294 Vali Loss: 0.668 Vali Acc: 0.811 Test Loss: 0.668 Test Acc: 0.811
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9872236251831055
Epoch: 68, Steps: 12 | Train Loss: 0.290 Vali Loss: 0.613 Vali Acc: 0.806 Test Loss: 0.613 Test Acc: 0.806
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.830460786819458
Epoch: 69, Steps: 12 | Train Loss: 0.311 Vali Loss: 0.615 Vali Acc: 0.817 Test Loss: 0.615 Test Acc: 0.817
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7560420036315918
Epoch: 70, Steps: 12 | Train Loss: 0.268 Vali Loss: 0.612 Vali Acc: 0.811 Test Loss: 0.612 Test Acc: 0.811
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.6598381996154785
Epoch: 71, Steps: 12 | Train Loss: 0.263 Vali Loss: 0.586 Vali Acc: 0.833 Test Loss: 0.586 Test Acc: 0.833
Validation loss decreased (-0.827771 --> -0.833327).  Saving model ...
Epoch: 72 cost time: 0.8137454986572266
Epoch: 72, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.604 Vali Acc: 0.806 Test Loss: 0.604 Test Acc: 0.806
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7068610191345215
Epoch: 73, Steps: 12 | Train Loss: 0.250 Vali Loss: 0.614 Vali Acc: 0.806 Test Loss: 0.614 Test Acc: 0.806
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.7785379886627197
Epoch: 74, Steps: 12 | Train Loss: 0.238 Vali Loss: 0.600 Vali Acc: 0.828 Test Loss: 0.600 Test Acc: 0.828
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.9354870319366455
Epoch: 75, Steps: 12 | Train Loss: 0.228 Vali Loss: 0.607 Vali Acc: 0.839 Test Loss: 0.607 Test Acc: 0.839
Validation loss decreased (-0.833327 --> -0.838883).  Saving model ...
Epoch: 76 cost time: 0.7700667381286621
Epoch: 76, Steps: 12 | Train Loss: 0.225 Vali Loss: 0.600 Vali Acc: 0.817 Test Loss: 0.600 Test Acc: 0.817
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.9398329257965088
Epoch: 77, Steps: 12 | Train Loss: 0.230 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.831425666809082
Epoch: 78, Steps: 12 | Train Loss: 0.203 Vali Loss: 0.601 Vali Acc: 0.817 Test Loss: 0.601 Test Acc: 0.817
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.7685952186584473
Epoch: 79, Steps: 12 | Train Loss: 0.188 Vali Loss: 0.641 Vali Acc: 0.811 Test Loss: 0.641 Test Acc: 0.811
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.810962438583374
Epoch: 80, Steps: 12 | Train Loss: 0.229 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.738044261932373
Epoch: 81, Steps: 12 | Train Loss: 0.183 Vali Loss: 0.617 Vali Acc: 0.822 Test Loss: 0.617 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.7534723281860352
Epoch: 82, Steps: 12 | Train Loss: 0.193 Vali Loss: 0.602 Vali Acc: 0.811 Test Loss: 0.602 Test Acc: 0.811
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.81113600730896
Epoch: 83, Steps: 12 | Train Loss: 0.174 Vali Loss: 0.621 Vali Acc: 0.817 Test Loss: 0.621 Test Acc: 0.817
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.9969491958618164
Epoch: 84, Steps: 12 | Train Loss: 0.168 Vali Loss: 0.630 Vali Acc: 0.811 Test Loss: 0.630 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.814016580581665
Epoch: 85, Steps: 12 | Train Loss: 0.157 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Libras_LightTS_UEA_ftM_sl45_ll0_pl0_dm32_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
180
test shape: torch.Size([180, 15]) torch.Size([180, 1])
accuracy:0.8388888888888889
model parameter : 4666
model size : 0.03MB
