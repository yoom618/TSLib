Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.5074703693389893
Epoch: 1, Steps: 17 | Train Loss: 2.226 Vali Loss: 2.181 Vali Acc: 0.059 Test Loss: 2.181 Test Acc: 0.059
Validation loss decreased (inf --> -0.059438).  Saving model ...
Epoch: 2 cost time: 1.0045475959777832
Epoch: 2, Steps: 17 | Train Loss: 2.155 Vali Loss: 2.075 Vali Acc: 0.251 Test Loss: 2.075 Test Acc: 0.251
Validation loss decreased (-0.059438 --> -0.251331).  Saving model ...
Epoch: 3 cost time: 1.2378277778625488
Epoch: 3, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.967 Vali Acc: 0.459 Test Loss: 1.967 Test Acc: 0.459
Validation loss decreased (-0.251331 --> -0.459440).  Saving model ...
Epoch: 4 cost time: 0.9886775016784668
Epoch: 4, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.811 Vali Acc: 0.697 Test Loss: 1.811 Test Acc: 0.697
Validation loss decreased (-0.459440 --> -0.697279).  Saving model ...
Epoch: 5 cost time: 1.2236809730529785
Epoch: 5, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.545 Vali Acc: 0.811 Test Loss: 1.545 Test Acc: 0.811
Validation loss decreased (-0.697279 --> -0.810795).  Saving model ...
Epoch: 6 cost time: 1.1275889873504639
Epoch: 6, Steps: 17 | Train Loss: 1.292 Vali Loss: 0.944 Vali Acc: 0.830 Test Loss: 0.944 Test Acc: 0.830
Validation loss decreased (-0.810795 --> -0.829720).  Saving model ...
Epoch: 7 cost time: 1.5050632953643799
Epoch: 7, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.403 Vali Acc: 0.865 Test Loss: 0.403 Test Acc: 0.865
Validation loss decreased (-0.829720 --> -0.864861).  Saving model ...
Epoch: 8 cost time: 1.4974067211151123
Epoch: 8, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.864861 --> -0.929728).  Saving model ...
Epoch: 9 cost time: 1.3565013408660889
Epoch: 9, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929728 --> -0.929728).  Saving model ...
Epoch: 10 cost time: 1.4942917823791504
Epoch: 10, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.929728 --> -0.948647).  Saving model ...
Epoch: 11 cost time: 1.532118797302246
Epoch: 11, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 12 cost time: 1.528113603591919
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.800428867340088
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.320038080215454
Epoch: 14, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.943 Test Loss: 0.211 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5992422103881836
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.943 Test Loss: 0.208 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4697761535644531
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0548741817474365
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.0806772708892822
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.935 Test Loss: 0.241 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.3379004001617432
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.253 Vali Acc: 0.938 Test Loss: 0.253 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5347990989685059
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1892292499542236
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 109139
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9039857387542725
Epoch: 1, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.085 Vali Acc: 0.259 Test Loss: 2.085 Test Acc: 0.259
Validation loss decreased (inf --> -0.259439).  Saving model ...
Epoch: 2 cost time: 1.4963750839233398
Epoch: 2, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.961 Vali Acc: 0.395 Test Loss: 1.961 Test Acc: 0.395
Validation loss decreased (-0.259439 --> -0.394575).  Saving model ...
Epoch: 3 cost time: 1.171849250793457
Epoch: 3, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.721 Vali Acc: 0.646 Test Loss: 1.721 Test Acc: 0.646
Validation loss decreased (-0.394575 --> -0.645929).  Saving model ...
Epoch: 4 cost time: 1.2745375633239746
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.149 Vali Acc: 0.808 Test Loss: 1.149 Test Acc: 0.808
Validation loss decreased (-0.645929 --> -0.808097).  Saving model ...
Epoch: 5 cost time: 1.3604435920715332
Epoch: 5, Steps: 17 | Train Loss: 0.796 Vali Loss: 0.515 Vali Acc: 0.857 Test Loss: 0.515 Test Acc: 0.857
Validation loss decreased (-0.808097 --> -0.856752).  Saving model ...
Epoch: 6 cost time: 1.2110087871551514
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (-0.856752 --> -0.935133).  Saving model ...
Epoch: 7 cost time: 1.472292184829712
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 8 cost time: 1.2993838787078857
Epoch: 8, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 9 cost time: 1.0435235500335693
Epoch: 9, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
Validation loss decreased (-0.940539 --> -0.954053).  Saving model ...
Epoch: 10 cost time: 1.3707165718078613
Epoch: 10, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.959 Test Loss: 0.140 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 11 cost time: 1.3594584465026855
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2471168041229248
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0920257568359375
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2815406322479248
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1259639263153076
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.231 Vali Acc: 0.932 Test Loss: 0.231 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.063575029373169
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3085856437683105
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.957 Test Loss: 0.214 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2974028587341309
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.951 Test Loss: 0.201 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3444149494171143
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0802245140075684
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 107873
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9518349170684814
Epoch: 1, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.166 Vali Acc: 0.168 Test Loss: 2.166 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.0670216083526611
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 2.064 Vali Acc: 0.322 Test Loss: 2.064 Test Acc: 0.322
Validation loss decreased (-0.167546 --> -0.321601).  Saving model ...
Epoch: 3 cost time: 1.0505475997924805
Epoch: 3, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.928 Vali Acc: 0.530 Test Loss: 1.928 Test Acc: 0.530
Validation loss decreased (-0.321601 --> -0.529710).  Saving model ...
Epoch: 4 cost time: 1.2728066444396973
Epoch: 4, Steps: 17 | Train Loss: 1.790 Vali Loss: 1.681 Vali Acc: 0.703 Test Loss: 1.681 Test Acc: 0.703
Validation loss decreased (-0.529710 --> -0.702686).  Saving model ...
Epoch: 5 cost time: 0.9182047843933105
Epoch: 5, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.120 Vali Acc: 0.765 Test Loss: 1.120 Test Acc: 0.765
Validation loss decreased (-0.702686 --> -0.764854).  Saving model ...
Epoch: 6 cost time: 1.0989205837249756
Epoch: 6, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.456 Vali Acc: 0.868 Test Loss: 0.456 Test Acc: 0.868
Validation loss decreased (-0.764854 --> -0.867563).  Saving model ...
Epoch: 7 cost time: 1.1809234619140625
Epoch: 7, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
Validation loss decreased (-0.867563 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 1.1229093074798584
Epoch: 8, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 9 cost time: 1.0059876441955566
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2381184101104736
Epoch: 10, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.2004024982452393
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956756).  Saving model ...
Epoch: 12 cost time: 1.0717582702636719
Epoch: 12, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2547028064727783
Epoch: 13, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.147 Vali Acc: 0.951 Test Loss: 0.147 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2342276573181152
Epoch: 14, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1039249897003174
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5466790199279785
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.254408359527588
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2197034358978271
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.957 Test Loss: 0.155 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0391697883605957
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.0755243301391602
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1919608116149902
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 107437
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.889176368713379
Epoch: 1, Steps: 17 | Train Loss: 2.203 Vali Loss: 2.131 Vali Acc: 0.141 Test Loss: 2.131 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 1.0953364372253418
Epoch: 2, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.040 Vali Acc: 0.351 Test Loss: 2.040 Test Acc: 0.351
Validation loss decreased (-0.140519 --> -0.351331).  Saving model ...
Epoch: 3 cost time: 1.0292189121246338
Epoch: 3, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.934 Vali Acc: 0.530 Test Loss: 1.934 Test Acc: 0.530
Validation loss decreased (-0.351331 --> -0.529710).  Saving model ...
Epoch: 4 cost time: 1.2360599040985107
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.768 Vali Acc: 0.711 Test Loss: 1.768 Test Acc: 0.711
Validation loss decreased (-0.529710 --> -0.710793).  Saving model ...
Epoch: 5 cost time: 1.0431995391845703
Epoch: 5, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.431 Vali Acc: 0.795 Test Loss: 1.431 Test Acc: 0.795
Validation loss decreased (-0.710793 --> -0.794580).  Saving model ...
Epoch: 6 cost time: 1.0991628170013428
Epoch: 6, Steps: 17 | Train Loss: 1.119 Vali Loss: 0.685 Vali Acc: 0.814 Test Loss: 0.685 Test Acc: 0.814
Validation loss decreased (-0.794580 --> -0.813507).  Saving model ...
Epoch: 7 cost time: 1.1122751235961914
Epoch: 7, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.358 Vali Acc: 0.870 Test Loss: 0.358 Test Acc: 0.870
Validation loss decreased (-0.813507 --> -0.870267).  Saving model ...
Epoch: 8 cost time: 1.0323386192321777
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.232 Vali Acc: 0.932 Test Loss: 0.232 Test Acc: 0.932
Validation loss decreased (-0.870267 --> -0.932430).  Saving model ...
Epoch: 9 cost time: 1.115093469619751
Epoch: 9, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.932430 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 1.200199842453003
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.191 Vali Acc: 0.927 Test Loss: 0.191 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0992987155914307
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.174 Vali Acc: 0.951 Test Loss: 0.174 Test Acc: 0.951
Validation loss decreased (-0.940539 --> -0.951350).  Saving model ...
Epoch: 12 cost time: 1.1434040069580078
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1651990413665771
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.196 Vali Acc: 0.943 Test Loss: 0.196 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6208274364471436
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.949 Test Loss: 0.182 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4440555572509766
Epoch: 15, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.935 Test Loss: 0.195 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2435722351074219
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.932 Test Loss: 0.235 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4622070789337158
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1045329570770264
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.345 Vali Acc: 0.905 Test Loss: 0.345 Test Acc: 0.905
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4259097576141357
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3679053783416748
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.2067136764526367
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.311 Vali Acc: 0.924 Test Loss: 0.311 Test Acc: 0.924
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 106889
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.9567792415618896
Epoch: 1, Steps: 17 | Train Loss: 2.111 Vali Loss: 2.076 Vali Acc: 0.319 Test Loss: 2.076 Test Acc: 0.319
Validation loss decreased (inf --> -0.318898).  Saving model ...
Epoch: 2 cost time: 1.2163662910461426
Epoch: 2, Steps: 17 | Train Loss: 2.024 Vali Loss: 1.960 Vali Acc: 0.432 Test Loss: 1.960 Test Acc: 0.432
Validation loss decreased (-0.318898 --> -0.432413).  Saving model ...
Epoch: 3 cost time: 1.5157215595245361
Epoch: 3, Steps: 17 | Train Loss: 1.884 Vali Loss: 1.786 Vali Acc: 0.619 Test Loss: 1.786 Test Acc: 0.619
Validation loss decreased (-0.432413 --> -0.618901).  Saving model ...
Epoch: 4 cost time: 1.3144810199737549
Epoch: 4, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.470 Vali Acc: 0.784 Test Loss: 1.470 Test Acc: 0.784
Validation loss decreased (-0.618901 --> -0.783769).  Saving model ...
Epoch: 5 cost time: 1.1107943058013916
Epoch: 5, Steps: 17 | Train Loss: 1.182 Vali Loss: 0.847 Vali Acc: 0.824 Test Loss: 0.847 Test Acc: 0.824
Validation loss decreased (-0.783769 --> -0.824316).  Saving model ...
Epoch: 6 cost time: 1.3886990547180176
Epoch: 6, Steps: 17 | Train Loss: 0.600 Vali Loss: 0.394 Vali Acc: 0.897 Test Loss: 0.394 Test Acc: 0.897
Validation loss decreased (-0.824316 --> -0.897293).  Saving model ...
Epoch: 7 cost time: 1.0913028717041016
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.271 Vali Acc: 0.905 Test Loss: 0.271 Test Acc: 0.905
Validation loss decreased (-0.897293 --> -0.905403).  Saving model ...
Epoch: 8 cost time: 1.211395025253296
Epoch: 8, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.225 Vali Acc: 0.911 Test Loss: 0.225 Test Acc: 0.911
Validation loss decreased (-0.905403 --> -0.910809).  Saving model ...
Epoch: 9 cost time: 1.4134762287139893
Epoch: 9, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.910809 --> -0.929728).  Saving model ...
Epoch: 10 cost time: 1.137556791305542
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929728 --> -0.929728).  Saving model ...
Epoch: 11 cost time: 1.327726125717163
Epoch: 11, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.196 Vali Acc: 0.922 Test Loss: 0.196 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2205986976623535
Epoch: 12, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
Validation loss decreased (-0.929728 --> -0.943242).  Saving model ...
Epoch: 13 cost time: 1.0154540538787842
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.187 Vali Acc: 0.932 Test Loss: 0.187 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2857205867767334
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.195 Vali Acc: 0.943 Test Loss: 0.195 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.202197551727295
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.184 Vali Acc: 0.943 Test Loss: 0.184 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3192448616027832
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.663975715637207
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.943 Test Loss: 0.202 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3102459907531738
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1911773681640625
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.938 Test Loss: 0.226 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1444268226623535
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.946 Test Loss: 0.184 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 21 cost time: 1.2763187885284424
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.281 Vali Acc: 0.927 Test Loss: 0.281 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2854773998260498
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3833537101745605
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3274695873260498
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.251 Vali Acc: 0.946 Test Loss: 0.251 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9396803379058838
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0094354152679443
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.949 Test Loss: 0.208 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 27 cost time: 1.1340878009796143
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.951 Test Loss: 0.214 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 28 cost time: 1.1461718082427979
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.949 Test Loss: 0.220 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2480480670928955
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.949 Test Loss: 0.225 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1132290363311768
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.954 Test Loss: 0.217 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 31 cost time: 1.275639533996582
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1582040786743164
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.951 Test Loss: 0.229 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0673496723175049
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.951 Test Loss: 0.228 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1904869079589844
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1558685302734375
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4000589847564697
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.954 Test Loss: 0.233 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0503003597259521
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.954 Test Loss: 0.235 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2901191711425781
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.954 Test Loss: 0.236 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0294685363769531
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.954 Test Loss: 0.239 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0616962909698486
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.954 Test Loss: 0.241 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 106659
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.261005163192749
Epoch: 1, Steps: 17 | Train Loss: 2.141 Vali Loss: 2.109 Vali Acc: 0.176 Test Loss: 2.109 Test Acc: 0.176
Validation loss decreased (inf --> -0.175655).  Saving model ...
Epoch: 2 cost time: 1.1727309226989746
Epoch: 2, Steps: 17 | Train Loss: 2.067 Vali Loss: 2.016 Vali Acc: 0.308 Test Loss: 2.016 Test Acc: 0.308
Validation loss decreased (-0.175655 --> -0.308088).  Saving model ...
Epoch: 3 cost time: 1.2480227947235107
Epoch: 3, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.878 Vali Acc: 0.514 Test Loss: 1.878 Test Acc: 0.514
Validation loss decreased (-0.308088 --> -0.513495).  Saving model ...
Epoch: 4 cost time: 1.1035711765289307
Epoch: 4, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.648 Vali Acc: 0.719 Test Loss: 1.648 Test Acc: 0.719
Validation loss decreased (-0.513495 --> -0.718902).  Saving model ...
Epoch: 5 cost time: 1.0475914478302002
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.118 Vali Acc: 0.827 Test Loss: 1.118 Test Acc: 0.827
Validation loss decreased (-0.718902 --> -0.827016).  Saving model ...
Epoch: 6 cost time: 1.0901598930358887
Epoch: 6, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.487 Vali Acc: 0.868 Test Loss: 0.487 Test Acc: 0.868
Validation loss decreased (-0.827016 --> -0.867563).  Saving model ...
Epoch: 7 cost time: 1.216078758239746
Epoch: 7, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.867563 --> -0.910808).  Saving model ...
Epoch: 8 cost time: 1.1583385467529297
Epoch: 8, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.200 Vali Acc: 0.938 Test Loss: 0.200 Test Acc: 0.938
Validation loss decreased (-0.910808 --> -0.937836).  Saving model ...
Epoch: 9 cost time: 1.561567783355713
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.610053300857544
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 11 cost time: 1.4334394931793213
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.593315601348877
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0614619255065918
Epoch: 13, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9190874099731445
Epoch: 14, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2512927055358887
Epoch: 15, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.408552646636963
Epoch: 16, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.213 Vali Acc: 0.943 Test Loss: 0.213 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3446261882781982
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.943 Test Loss: 0.201 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5218243598937988
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3071856498718262
Epoch: 19, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2509751319885254
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 106525
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.654906749725342
Epoch: 1, Steps: 17 | Train Loss: 2.114 Vali Loss: 2.113 Vali Acc: 0.165 Test Loss: 2.113 Test Acc: 0.165
Validation loss decreased (inf --> -0.164844).  Saving model ...
Epoch: 2 cost time: 1.1670451164245605
Epoch: 2, Steps: 17 | Train Loss: 2.020 Vali Loss: 1.990 Vali Acc: 0.276 Test Loss: 1.990 Test Acc: 0.276
Validation loss decreased (-0.164844 --> -0.275656).  Saving model ...
Epoch: 3 cost time: 1.2047557830810547
Epoch: 3, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.758 Vali Acc: 0.589 Test Loss: 1.758 Test Acc: 0.589
Validation loss decreased (-0.275656 --> -0.589172).  Saving model ...
Epoch: 4 cost time: 1.5388092994689941
Epoch: 4, Steps: 17 | Train Loss: 1.505 Vali Loss: 1.215 Vali Acc: 0.768 Test Loss: 1.215 Test Acc: 0.768
Validation loss decreased (-0.589172 --> -0.767555).  Saving model ...
Epoch: 5 cost time: 1.188307762145996
Epoch: 5, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.477 Vali Acc: 0.859 Test Loss: 0.477 Test Acc: 0.859
Validation loss decreased (-0.767555 --> -0.859455).  Saving model ...
Epoch: 6 cost time: 1.0420448780059814
Epoch: 6, Steps: 17 | Train Loss: 0.380 Vali Loss: 0.250 Vali Acc: 0.914 Test Loss: 0.250 Test Acc: 0.914
Validation loss decreased (-0.859455 --> -0.913511).  Saving model ...
Epoch: 7 cost time: 1.1314060688018799
Epoch: 7, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.188 Vali Acc: 0.935 Test Loss: 0.188 Test Acc: 0.935
Validation loss decreased (-0.913511 --> -0.935133).  Saving model ...
Epoch: 8 cost time: 1.1885302066802979
Epoch: 8, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.191 Vali Acc: 0.932 Test Loss: 0.191 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4059922695159912
Epoch: 9, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 10 cost time: 1.202587366104126
Epoch: 10, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.165 Vali Acc: 0.957 Test Loss: 0.165 Test Acc: 0.957
Validation loss decreased (-0.940539 --> -0.956755).  Saving model ...
Epoch: 11 cost time: 1.0481822490692139
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.076197624206543
Epoch: 12, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.184 Vali Acc: 0.949 Test Loss: 0.184 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0215435028076172
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1160888671875
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.951 Test Loss: 0.184 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7294321060180664
Epoch: 15, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3394689559936523
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.949 Test Loss: 0.204 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3778762817382812
Epoch: 17, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.938 Test Loss: 0.244 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.254920244216919
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.954 Test Loss: 0.223 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.604501485824585
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.240 Vali Acc: 0.951 Test Loss: 0.240 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0688152313232422
Epoch: 20, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.946 Test Loss: 0.274 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 106291
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.481468677520752
Epoch: 1, Steps: 17 | Train Loss: 2.249 Vali Loss: 2.156 Vali Acc: 0.203 Test Loss: 2.156 Test Acc: 0.203
Validation loss decreased (inf --> -0.202681).  Saving model ...
Epoch: 2 cost time: 0.968878984451294
Epoch: 2, Steps: 17 | Train Loss: 2.157 Vali Loss: 2.040 Vali Acc: 0.343 Test Loss: 2.040 Test Acc: 0.343
Validation loss decreased (-0.202681 --> -0.343223).  Saving model ...
Epoch: 3 cost time: 1.0818455219268799
Epoch: 3, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.822 Vali Acc: 0.562 Test Loss: 1.822 Test Acc: 0.562
Validation loss decreased (-0.343223 --> -0.562144).  Saving model ...
Epoch: 4 cost time: 1.0438008308410645
Epoch: 4, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.190 Vali Acc: 0.714 Test Loss: 1.190 Test Acc: 0.714
Validation loss decreased (-0.562144 --> -0.713502).  Saving model ...
Epoch: 5 cost time: 1.3458976745605469
Epoch: 5, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.578 Vali Acc: 0.800 Test Loss: 0.578 Test Acc: 0.800
Validation loss decreased (-0.713502 --> -0.799994).  Saving model ...
Epoch: 6 cost time: 0.9605541229248047
Epoch: 6, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.365 Vali Acc: 0.870 Test Loss: 0.365 Test Acc: 0.870
Validation loss decreased (-0.799994 --> -0.870267).  Saving model ...
Epoch: 7 cost time: 1.0917096138000488
Epoch: 7, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.870267 --> -0.929727).  Saving model ...
Epoch: 8 cost time: 1.3521621227264404
Epoch: 8, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0091407299041748
Epoch: 9, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
Validation loss decreased (-0.929727 --> -0.943241).  Saving model ...
Epoch: 10 cost time: 1.0463976860046387
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2478609085083008
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.927661657333374
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2353935241699219
Epoch: 13, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.316 Vali Acc: 0.908 Test Loss: 0.316 Test Acc: 0.908
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2821118831634521
Epoch: 14, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.309 Vali Acc: 0.924 Test Loss: 0.309 Test Acc: 0.924
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3323426246643066
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.294 Vali Acc: 0.938 Test Loss: 0.294 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2847704887390137
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.411 Vali Acc: 0.895 Test Loss: 0.411 Test Acc: 0.895
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1049108505249023
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.375 Vali Acc: 0.916 Test Loss: 0.375 Test Acc: 0.916
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0033953189849854
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.377 Vali Acc: 0.922 Test Loss: 0.377 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.329360008239746
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.466 Vali Acc: 0.903 Test Loss: 0.466 Test Acc: 0.903
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm512_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 106305
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4382731914520264
Epoch: 1, Steps: 17 | Train Loss: 2.107 Vali Loss: 2.095 Vali Acc: 0.224 Test Loss: 2.095 Test Acc: 0.224
Validation loss decreased (inf --> -0.224303).  Saving model ...
Epoch: 2 cost time: 1.3283424377441406
Epoch: 2, Steps: 17 | Train Loss: 2.039 Vali Loss: 2.003 Vali Acc: 0.343 Test Loss: 2.003 Test Acc: 0.343
Validation loss decreased (-0.224303 --> -0.343223).  Saving model ...
Epoch: 3 cost time: 1.5680310726165771
Epoch: 3, Steps: 17 | Train Loss: 1.930 Vali Loss: 1.877 Vali Acc: 0.535 Test Loss: 1.877 Test Acc: 0.535
Validation loss decreased (-0.343223 --> -0.535116).  Saving model ...
Epoch: 4 cost time: 1.359964370727539
Epoch: 4, Steps: 17 | Train Loss: 1.776 Vali Loss: 1.689 Vali Acc: 0.719 Test Loss: 1.689 Test Acc: 0.719
Validation loss decreased (-0.535116 --> -0.718902).  Saving model ...
Epoch: 5 cost time: 1.453599214553833
Epoch: 5, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.374 Vali Acc: 0.819 Test Loss: 1.374 Test Acc: 0.819
Validation loss decreased (-0.718902 --> -0.818905).  Saving model ...
Epoch: 6 cost time: 1.115954875946045
Epoch: 6, Steps: 17 | Train Loss: 1.114 Vali Loss: 0.828 Vali Acc: 0.846 Test Loss: 0.828 Test Acc: 0.846
Validation loss decreased (-0.818905 --> -0.845938).  Saving model ...
Epoch: 7 cost time: 1.1652135848999023
Epoch: 7, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.445 Vali Acc: 0.868 Test Loss: 0.445 Test Acc: 0.868
Validation loss decreased (-0.845938 --> -0.867563).  Saving model ...
Epoch: 8 cost time: 1.3611514568328857
Epoch: 8, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.276 Vali Acc: 0.924 Test Loss: 0.276 Test Acc: 0.924
Validation loss decreased (-0.867563 --> -0.924322).  Saving model ...
Epoch: 9 cost time: 1.508061170578003
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
Validation loss decreased (-0.924322 --> -0.935133).  Saving model ...
Epoch: 10 cost time: 1.0767817497253418
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 11 cost time: 1.3590662479400635
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 1.2944393157958984
Epoch: 12, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9745888710021973
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.059715747833252
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0784237384796143
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.212195634841919
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3227746486663818
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5342457294464111
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.243 Vali Acc: 0.927 Test Loss: 0.243 Test Acc: 0.927
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1596169471740723
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.031515121459961
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.257 Vali Acc: 0.927 Test Loss: 0.257 Test Acc: 0.927
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1101391315460205
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.932 Test Loss: 0.248 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2709927558898926
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.269 Vali Acc: 0.932 Test Loss: 0.269 Test Acc: 0.932
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4247705936431885
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 32115
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.4566988945007324
Epoch: 1, Steps: 17 | Train Loss: 2.180 Vali Loss: 2.153 Vali Acc: 0.130 Test Loss: 2.153 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 1.0448660850524902
Epoch: 2, Steps: 17 | Train Loss: 2.110 Vali Loss: 2.063 Vali Acc: 0.249 Test Loss: 2.063 Test Acc: 0.249
Validation loss decreased (-0.129708 --> -0.248628).  Saving model ...
Epoch: 3 cost time: 1.4434330463409424
Epoch: 3, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.939 Vali Acc: 0.438 Test Loss: 1.939 Test Acc: 0.438
Validation loss decreased (-0.248628 --> -0.437818).  Saving model ...
Epoch: 4 cost time: 1.2342238426208496
Epoch: 4, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.780 Vali Acc: 0.632 Test Loss: 1.780 Test Acc: 0.632
Validation loss decreased (-0.437818 --> -0.632415).  Saving model ...
Epoch: 5 cost time: 1.248795509338379
Epoch: 5, Steps: 17 | Train Loss: 1.681 Vali Loss: 1.559 Vali Acc: 0.757 Test Loss: 1.559 Test Acc: 0.757
Validation loss decreased (-0.632415 --> -0.756741).  Saving model ...
Epoch: 6 cost time: 1.282834768295288
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.161 Vali Acc: 0.811 Test Loss: 1.161 Test Acc: 0.811
Validation loss decreased (-0.756741 --> -0.810799).  Saving model ...
Epoch: 7 cost time: 1.2795336246490479
Epoch: 7, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.612 Vali Acc: 0.832 Test Loss: 0.612 Test Acc: 0.832
Validation loss decreased (-0.810799 --> -0.832426).  Saving model ...
Epoch: 8 cost time: 1.0765745639801025
Epoch: 8, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.350 Vali Acc: 0.905 Test Loss: 0.350 Test Acc: 0.905
Validation loss decreased (-0.832426 --> -0.905402).  Saving model ...
Epoch: 9 cost time: 1.2530124187469482
Epoch: 9, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.254 Vali Acc: 0.927 Test Loss: 0.254 Test Acc: 0.927
Validation loss decreased (-0.905402 --> -0.927024).  Saving model ...
Epoch: 10 cost time: 1.1181063652038574
Epoch: 10, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
Validation loss decreased (-0.927024 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 1.4322352409362793
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.195 Vali Acc: 0.938 Test Loss: 0.195 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 12 cost time: 1.0520811080932617
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943242).  Saving model ...
Epoch: 13 cost time: 1.1283767223358154
Epoch: 13, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.161 Vali Acc: 0.943 Test Loss: 0.161 Test Acc: 0.943
Validation loss decreased (-0.943242 --> -0.943242).  Saving model ...
Epoch: 14 cost time: 1.0698776245117188
Epoch: 14, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 0.9551620483398438
Epoch: 15, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.2221806049346924
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.946 Test Loss: 0.156 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0763368606567383
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 1.1887791156768799
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.949 Test Loss: 0.173 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0019242763519287
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0991237163543701
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 21 cost time: 1.1492345333099365
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.935 Test Loss: 0.215 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.00191330909729
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1631875038146973
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0801331996917725
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0492732524871826
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.943 Test Loss: 0.237 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.957038402557373
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0184273719787598
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2040467262268066
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.255 Vali Acc: 0.943 Test Loss: 0.255 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1484196186065674
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0580220222473145
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.943 Test Loss: 0.265 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 31489
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.729710340499878
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.130 Vali Acc: 0.157 Test Loss: 2.130 Test Acc: 0.157
Validation loss decreased (inf --> -0.156735).  Saving model ...
Epoch: 2 cost time: 0.7581353187561035
Epoch: 2, Steps: 17 | Train Loss: 2.077 Vali Loss: 2.040 Vali Acc: 0.270 Test Loss: 2.040 Test Acc: 0.270
Validation loss decreased (-0.156735 --> -0.270250).  Saving model ...
Epoch: 3 cost time: 1.0004074573516846
Epoch: 3, Steps: 17 | Train Loss: 1.963 Vali Loss: 1.906 Vali Acc: 0.468 Test Loss: 1.906 Test Acc: 0.468
Validation loss decreased (-0.270250 --> -0.467549).  Saving model ...
Epoch: 4 cost time: 1.068894386291504
Epoch: 4, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.711 Vali Acc: 0.708 Test Loss: 1.711 Test Acc: 0.708
Validation loss decreased (-0.467549 --> -0.708091).  Saving model ...
Epoch: 5 cost time: 1.202219009399414
Epoch: 5, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.381 Vali Acc: 0.808 Test Loss: 1.381 Test Acc: 0.808
Validation loss decreased (-0.708091 --> -0.808094).  Saving model ...
Epoch: 6 cost time: 0.9739232063293457
Epoch: 6, Steps: 17 | Train Loss: 1.099 Vali Loss: 0.817 Vali Acc: 0.832 Test Loss: 0.817 Test Acc: 0.832
Validation loss decreased (-0.808094 --> -0.832424).  Saving model ...
Epoch: 7 cost time: 0.9905924797058105
Epoch: 7, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.431 Vali Acc: 0.862 Test Loss: 0.431 Test Acc: 0.862
Validation loss decreased (-0.832424 --> -0.862158).  Saving model ...
Epoch: 8 cost time: 0.9290933609008789
Epoch: 8, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.287 Vali Acc: 0.905 Test Loss: 0.287 Test Acc: 0.905
Validation loss decreased (-0.862158 --> -0.905403).  Saving model ...
Epoch: 9 cost time: 0.8927366733551025
Epoch: 9, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.228 Vali Acc: 0.927 Test Loss: 0.228 Test Acc: 0.927
Validation loss decreased (-0.905403 --> -0.927025).  Saving model ...
Epoch: 10 cost time: 0.8684873580932617
Epoch: 10, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.177 Vali Acc: 0.935 Test Loss: 0.177 Test Acc: 0.935
Validation loss decreased (-0.927025 --> -0.935133).  Saving model ...
Epoch: 11 cost time: 0.9683680534362793
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.935133 --> -0.940539).  Saving model ...
Epoch: 12 cost time: 1.0892348289489746
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 13 cost time: 0.9470653533935547
Epoch: 13, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 0.9793291091918945
Epoch: 14, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.197 Vali Acc: 0.943 Test Loss: 0.197 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8723275661468506
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 16 cost time: 0.9853732585906982
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.954 Test Loss: 0.158 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 17 cost time: 1.2239928245544434
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.946 Test Loss: 0.198 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1055989265441895
Epoch: 18, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.949 Test Loss: 0.191 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.341825008392334
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.943 Test Loss: 0.222 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1772348880767822
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2265236377716064
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.259 Vali Acc: 0.935 Test Loss: 0.259 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2407050132751465
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3035109043121338
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0479345321655273
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.943 Test Loss: 0.258 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3209946155548096
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.297 Vali Acc: 0.938 Test Loss: 0.297 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0087692737579346
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.938 Test Loss: 0.284 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 31309
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.241166830062866
Epoch: 1, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.180 Vali Acc: 0.176 Test Loss: 2.180 Test Acc: 0.176
Validation loss decreased (inf --> -0.175654).  Saving model ...
Epoch: 2 cost time: 0.9284460544586182
Epoch: 2, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.088 Vali Acc: 0.235 Test Loss: 2.088 Test Acc: 0.235
Validation loss decreased (-0.175654 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.0846459865570068
Epoch: 3, Steps: 17 | Train Loss: 1.983 Vali Loss: 1.965 Vali Acc: 0.357 Test Loss: 1.965 Test Acc: 0.357
Validation loss decreased (-0.235114 --> -0.356737).  Saving model ...
Epoch: 4 cost time: 1.0187652111053467
Epoch: 4, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.777 Vali Acc: 0.603 Test Loss: 1.777 Test Acc: 0.603
Validation loss decreased (-0.356737 --> -0.602685).  Saving model ...
Epoch: 5 cost time: 1.1975600719451904
Epoch: 5, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.501 Vali Acc: 0.746 Test Loss: 1.501 Test Acc: 0.746
Validation loss decreased (-0.602685 --> -0.745931).  Saving model ...
Epoch: 6 cost time: 0.978801965713501
Epoch: 6, Steps: 17 | Train Loss: 1.223 Vali Loss: 0.991 Vali Acc: 0.816 Test Loss: 0.991 Test Acc: 0.816
Validation loss decreased (-0.745931 --> -0.816206).  Saving model ...
Epoch: 7 cost time: 0.9254505634307861
Epoch: 7, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.464 Vali Acc: 0.889 Test Loss: 0.464 Test Acc: 0.889
Validation loss decreased (-0.816206 --> -0.889185).  Saving model ...
Epoch: 8 cost time: 1.1366550922393799
Epoch: 8, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.246 Vali Acc: 0.938 Test Loss: 0.246 Test Acc: 0.938
Validation loss decreased (-0.889185 --> -0.937835).  Saving model ...
Epoch: 9 cost time: 0.9205679893493652
Epoch: 9, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 1.065366268157959
Epoch: 10, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1629221439361572
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
Validation loss decreased (-0.945944 --> -0.954053).  Saving model ...
Epoch: 12 cost time: 1.29050874710083
Epoch: 12, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.954 Test Loss: 0.143 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 13 cost time: 1.4175612926483154
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.125 Vali Acc: 0.959 Test Loss: 0.125 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 14 cost time: 1.095637559890747
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.032371997833252
Epoch: 15, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.149 Vali Acc: 0.954 Test Loss: 0.149 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0987331867218018
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3750996589660645
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.293447732925415
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.951 Test Loss: 0.202 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1629931926727295
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.943 Test Loss: 0.200 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.014787197113037
Epoch: 20, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.949 Test Loss: 0.201 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7944319248199463
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9395654201507568
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.949 Test Loss: 0.205 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8321259021759033
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.217 Vali Acc: 0.949 Test Loss: 0.217 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 31017
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.057859182357788
Epoch: 1, Steps: 17 | Train Loss: 2.217 Vali Loss: 2.138 Vali Acc: 0.241 Test Loss: 2.138 Test Acc: 0.241
Validation loss decreased (inf --> -0.240519).  Saving model ...
Epoch: 2 cost time: 0.8738069534301758
Epoch: 2, Steps: 17 | Train Loss: 2.161 Vali Loss: 2.068 Vali Acc: 0.327 Test Loss: 2.068 Test Acc: 0.327
Validation loss decreased (-0.240519 --> -0.327006).  Saving model ...
Epoch: 3 cost time: 1.186202049255371
Epoch: 3, Steps: 17 | Train Loss: 2.068 Vali Loss: 1.971 Vali Acc: 0.424 Test Loss: 1.971 Test Acc: 0.424
Validation loss decreased (-0.327006 --> -0.424305).  Saving model ...
Epoch: 4 cost time: 0.976520299911499
Epoch: 4, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.827 Vali Acc: 0.592 Test Loss: 1.827 Test Acc: 0.592
Validation loss decreased (-0.424305 --> -0.591874).  Saving model ...
Epoch: 5 cost time: 1.0302700996398926
Epoch: 5, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.566 Vali Acc: 0.695 Test Loss: 1.566 Test Acc: 0.695
Validation loss decreased (-0.591874 --> -0.694579).  Saving model ...
Epoch: 6 cost time: 1.2696785926818848
Epoch: 6, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.086 Vali Acc: 0.773 Test Loss: 1.086 Test Acc: 0.773
Validation loss decreased (-0.694579 --> -0.772962).  Saving model ...
Epoch: 7 cost time: 0.8936557769775391
Epoch: 7, Steps: 17 | Train Loss: 0.820 Vali Loss: 0.575 Vali Acc: 0.868 Test Loss: 0.575 Test Acc: 0.868
Validation loss decreased (-0.772962 --> -0.867562).  Saving model ...
Epoch: 8 cost time: 1.2310991287231445
Epoch: 8, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.329 Vali Acc: 0.881 Test Loss: 0.329 Test Acc: 0.881
Validation loss decreased (-0.867562 --> -0.881078).  Saving model ...
Epoch: 9 cost time: 1.2433340549468994
Epoch: 9, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.261 Vali Acc: 0.900 Test Loss: 0.261 Test Acc: 0.900
Validation loss decreased (-0.881078 --> -0.899997).  Saving model ...
Epoch: 10 cost time: 1.0380494594573975
Epoch: 10, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.227 Vali Acc: 0.916 Test Loss: 0.227 Test Acc: 0.916
Validation loss decreased (-0.899997 --> -0.916214).  Saving model ...
Epoch: 11 cost time: 1.4702513217926025
Epoch: 11, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.916214 --> -0.921620).  Saving model ...
Epoch: 12 cost time: 1.006251573562622
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.203 Vali Acc: 0.938 Test Loss: 0.203 Test Acc: 0.938
Validation loss decreased (-0.921620 --> -0.937836).  Saving model ...
Epoch: 13 cost time: 1.14703369140625
Epoch: 13, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 14 cost time: 1.1397428512573242
Epoch: 14, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.194 Vali Acc: 0.943 Test Loss: 0.194 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943241).  Saving model ...
Epoch: 15 cost time: 1.299100637435913
Epoch: 15, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.7754054069519043
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.461766004562378
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.951 Test Loss: 0.203 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951349).  Saving model ...
Epoch: 18 cost time: 1.199538230895996
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.938 Test Loss: 0.210 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2439348697662354
Epoch: 19, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.214 Vali Acc: 0.943 Test Loss: 0.214 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4377002716064453
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9877622127532959
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1977252960205078
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.254 Vali Acc: 0.946 Test Loss: 0.254 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.063730001449585
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4361684322357178
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.943 Test Loss: 0.291 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3257012367248535
Epoch: 25, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2867813110351562
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.310 Vali Acc: 0.943 Test Loss: 0.310 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2781550884246826
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 30915
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.0320799350738525
Epoch: 1, Steps: 17 | Train Loss: 2.271 Vali Loss: 2.192 Vali Acc: 0.219 Test Loss: 2.192 Test Acc: 0.219
Validation loss decreased (inf --> -0.218897).  Saving model ...
Epoch: 2 cost time: 1.1110470294952393
Epoch: 2, Steps: 17 | Train Loss: 2.211 Vali Loss: 2.129 Vali Acc: 0.289 Test Loss: 2.129 Test Acc: 0.289
Validation loss decreased (-0.218897 --> -0.289168).  Saving model ...
Epoch: 3 cost time: 1.3434481620788574
Epoch: 3, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.034 Vali Acc: 0.405 Test Loss: 2.034 Test Acc: 0.405
Validation loss decreased (-0.289168 --> -0.405385).  Saving model ...
Epoch: 4 cost time: 1.0857489109039307
Epoch: 4, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.892 Vali Acc: 0.576 Test Loss: 1.892 Test Acc: 0.576
Validation loss decreased (-0.405385 --> -0.575657).  Saving model ...
Epoch: 5 cost time: 1.2362570762634277
Epoch: 5, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.617 Vali Acc: 0.689 Test Loss: 1.617 Test Acc: 0.689
Validation loss decreased (-0.575657 --> -0.689173).  Saving model ...
Epoch: 6 cost time: 1.1736423969268799
Epoch: 6, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.041 Vali Acc: 0.792 Test Loss: 1.041 Test Acc: 0.792
Validation loss decreased (-0.689173 --> -0.791881).  Saving model ...
Epoch: 7 cost time: 1.2992675304412842
Epoch: 7, Steps: 17 | Train Loss: 0.681 Vali Loss: 0.440 Vali Acc: 0.873 Test Loss: 0.440 Test Acc: 0.873
Validation loss decreased (-0.791881 --> -0.872969).  Saving model ...
Epoch: 8 cost time: 1.6611711978912354
Epoch: 8, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.234 Vali Acc: 0.908 Test Loss: 0.234 Test Acc: 0.908
Validation loss decreased (-0.872969 --> -0.908106).  Saving model ...
Epoch: 9 cost time: 1.5118193626403809
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.171 Vali Acc: 0.924 Test Loss: 0.171 Test Acc: 0.924
Validation loss decreased (-0.908106 --> -0.924323).  Saving model ...
Epoch: 10 cost time: 1.3968558311462402
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
Validation loss decreased (-0.924323 --> -0.937836).  Saving model ...
Epoch: 11 cost time: 0.8830878734588623
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.147 Vali Acc: 0.946 Test Loss: 0.147 Test Acc: 0.946
Validation loss decreased (-0.937836 --> -0.945944).  Saving model ...
Epoch: 12 cost time: 0.9556505680084229
Epoch: 12, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.160 Vali Acc: 0.943 Test Loss: 0.160 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2088892459869385
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.155 Vali Acc: 0.946 Test Loss: 0.155 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4060933589935303
Epoch: 14, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6235134601593018
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.1258888244628906
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.946 Test Loss: 0.178 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2809183597564697
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4081077575683594
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.332378625869751
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2484376430511475
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.935 Test Loss: 0.228 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2340257167816162
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.938 Test Loss: 0.204 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0944442749023438
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2415976524353027
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0932364463806152
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.943 Test Loss: 0.228 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0589394569396973
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.946 Test Loss: 0.223 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 30909
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.758209705352783
Epoch: 1, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.229 Vali Acc: 0.111 Test Loss: 2.229 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 1.048215627670288
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.148 Vali Acc: 0.192 Test Loss: 2.148 Test Acc: 0.192
Validation loss decreased (-0.110789 --> -0.191870).  Saving model ...
Epoch: 3 cost time: 1.128713607788086
Epoch: 3, Steps: 17 | Train Loss: 2.067 Vali Loss: 2.037 Vali Acc: 0.311 Test Loss: 2.037 Test Acc: 0.311
Validation loss decreased (-0.191870 --> -0.310790).  Saving model ...
Epoch: 4 cost time: 1.039940357208252
Epoch: 4, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.902 Vali Acc: 0.505 Test Loss: 1.902 Test Acc: 0.505
Validation loss decreased (-0.310790 --> -0.505386).  Saving model ...
Epoch: 5 cost time: 1.0313968658447266
Epoch: 5, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.692 Vali Acc: 0.711 Test Loss: 1.692 Test Acc: 0.711
Validation loss decreased (-0.505386 --> -0.710794).  Saving model ...
Epoch: 6 cost time: 1.053318977355957
Epoch: 6, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.307 Vali Acc: 0.781 Test Loss: 1.307 Test Acc: 0.781
Validation loss decreased (-0.710794 --> -0.781068).  Saving model ...
Epoch: 7 cost time: 1.202880859375
Epoch: 7, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.781068 --> -0.821615).  Saving model ...
Epoch: 8 cost time: 0.8508052825927734
Epoch: 8, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
Validation loss decreased (-0.821615 --> -0.921619).  Saving model ...
Epoch: 9 cost time: 0.9988129138946533
Epoch: 9, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.182 Vali Acc: 0.946 Test Loss: 0.182 Test Acc: 0.946
Validation loss decreased (-0.921619 --> -0.945944).  Saving model ...
Epoch: 10 cost time: 0.9212956428527832
Epoch: 10, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 11 cost time: 0.9239628314971924
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.126 Vali Acc: 0.949 Test Loss: 0.126 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 12 cost time: 1.0962910652160645
Epoch: 12, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.108 Vali Acc: 0.957 Test Loss: 0.108 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956756).  Saving model ...
Epoch: 13 cost time: 1.0011265277862549
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.153 Vali Acc: 0.946 Test Loss: 0.153 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0003416538238525
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.106 Vali Acc: 0.959 Test Loss: 0.106 Test Acc: 0.959
Validation loss decreased (-0.956756 --> -0.959458).  Saving model ...
Epoch: 15 cost time: 1.3282957077026367
Epoch: 15, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9901819229125977
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.124 Vali Acc: 0.965 Test Loss: 0.124 Test Acc: 0.965
Validation loss decreased (-0.959458 --> -0.964864).  Saving model ...
Epoch: 17 cost time: 0.9197783470153809
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.951 Test Loss: 0.151 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9706525802612305
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8899407386779785
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1721086502075195
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.943 Test Loss: 0.173 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.013728380203247
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0330731868743896
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0502479076385498
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.946 Test Loss: 0.177 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4241924285888672
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0350589752197266
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.946 Test Loss: 0.176 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.015779733657837
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 30803
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3068673610687256
Epoch: 1, Steps: 17 | Train Loss: 2.158 Vali Loss: 2.111 Vali Acc: 0.157 Test Loss: 2.111 Test Acc: 0.157
Validation loss decreased (inf --> -0.156736).  Saving model ...
Epoch: 2 cost time: 1.125378131866455
Epoch: 2, Steps: 17 | Train Loss: 2.097 Vali Loss: 2.034 Vali Acc: 0.349 Test Loss: 2.034 Test Acc: 0.349
Validation loss decreased (-0.156736 --> -0.348628).  Saving model ...
Epoch: 3 cost time: 1.159576654434204
Epoch: 3, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.929 Vali Acc: 0.535 Test Loss: 1.929 Test Acc: 0.535
Validation loss decreased (-0.348628 --> -0.535116).  Saving model ...
Epoch: 4 cost time: 1.2503340244293213
Epoch: 4, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.770 Vali Acc: 0.716 Test Loss: 1.770 Test Acc: 0.716
Validation loss decreased (-0.535116 --> -0.716199).  Saving model ...
Epoch: 5 cost time: 1.1078643798828125
Epoch: 5, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.469 Vali Acc: 0.805 Test Loss: 1.469 Test Acc: 0.805
Validation loss decreased (-0.716199 --> -0.805391).  Saving model ...
Epoch: 6 cost time: 1.1046092510223389
Epoch: 6, Steps: 17 | Train Loss: 1.188 Vali Loss: 0.838 Vali Acc: 0.830 Test Loss: 0.838 Test Acc: 0.830
Validation loss decreased (-0.805391 --> -0.829721).  Saving model ...
Epoch: 7 cost time: 1.5096988677978516
Epoch: 7, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.424 Vali Acc: 0.873 Test Loss: 0.424 Test Acc: 0.873
Validation loss decreased (-0.829721 --> -0.872969).  Saving model ...
Epoch: 8 cost time: 1.0337004661560059
Epoch: 8, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.296 Vali Acc: 0.903 Test Loss: 0.296 Test Acc: 0.903
Validation loss decreased (-0.872969 --> -0.902700).  Saving model ...
Epoch: 9 cost time: 1.136225938796997
Epoch: 9, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.229 Vali Acc: 0.924 Test Loss: 0.229 Test Acc: 0.924
Validation loss decreased (-0.902700 --> -0.924322).  Saving model ...
Epoch: 10 cost time: 1.189913034439087
Epoch: 10, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.184 Vali Acc: 0.932 Test Loss: 0.184 Test Acc: 0.932
Validation loss decreased (-0.924322 --> -0.932431).  Saving model ...
Epoch: 11 cost time: 1.2002818584442139
Epoch: 11, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.187 Vali Acc: 0.924 Test Loss: 0.187 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9982898235321045
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1339960098266602
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1294257640838623
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.174 Vali Acc: 0.938 Test Loss: 0.174 Test Acc: 0.938
Validation loss decreased (-0.932431 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 1.1703600883483887
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1996469497680664
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0128259658813477
Epoch: 17, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0255064964294434
Epoch: 18, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2075221538543701
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.204101800918579
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.269 Vali Acc: 0.932 Test Loss: 0.269 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3260962963104248
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
Validation loss decreased (-0.937836 --> -0.943241).  Saving model ...
Epoch: 22 cost time: 1.2421565055847168
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1793363094329834
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1206388473510742
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0306034088134766
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.324 Vali Acc: 0.935 Test Loss: 0.324 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8882622718811035
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0930020809173584
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.364 Vali Acc: 0.924 Test Loss: 0.364 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1391208171844482
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2450520992279053
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.371 Vali Acc: 0.924 Test Loss: 0.371 Test Acc: 0.924
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.014204740524292
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.373 Vali Acc: 0.924 Test Loss: 0.373 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.104231834411621
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.375 Vali Acc: 0.927 Test Loss: 0.375 Test Acc: 0.927
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm256_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9432432432432433
model parameter : 30945
model size : 0.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.1336472034454346
Epoch: 1, Steps: 17 | Train Loss: 2.230 Vali Loss: 2.225 Vali Acc: 0.095 Test Loss: 2.225 Test Acc: 0.095
Validation loss decreased (inf --> -0.094572).  Saving model ...
Epoch: 2 cost time: 0.8186736106872559
Epoch: 2, Steps: 17 | Train Loss: 2.162 Vali Loss: 2.143 Vali Acc: 0.130 Test Loss: 2.143 Test Acc: 0.130
Validation loss decreased (-0.094572 --> -0.129708).  Saving model ...
Epoch: 3 cost time: 1.1120109558105469
Epoch: 3, Steps: 17 | Train Loss: 2.056 Vali Loss: 2.032 Vali Acc: 0.249 Test Loss: 2.032 Test Acc: 0.249
Validation loss decreased (-0.129708 --> -0.248628).  Saving model ...
Epoch: 4 cost time: 1.1295976638793945
Epoch: 4, Steps: 17 | Train Loss: 1.933 Vali Loss: 1.907 Vali Acc: 0.462 Test Loss: 1.907 Test Acc: 0.462
Validation loss decreased (-0.248628 --> -0.462143).  Saving model ...
Epoch: 5 cost time: 1.106407880783081
Epoch: 5, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.761 Vali Acc: 0.651 Test Loss: 1.761 Test Acc: 0.651
Validation loss decreased (-0.462143 --> -0.651334).  Saving model ...
Epoch: 6 cost time: 1.4539663791656494
Epoch: 6, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.596 Vali Acc: 0.757 Test Loss: 1.596 Test Acc: 0.757
Validation loss decreased (-0.651334 --> -0.756741).  Saving model ...
Epoch: 7 cost time: 1.1670241355895996
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.406 Vali Acc: 0.838 Test Loss: 1.406 Test Acc: 0.838
Validation loss decreased (-0.756741 --> -0.837824).  Saving model ...
Epoch: 8 cost time: 1.1724319458007812
Epoch: 8, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.183 Vali Acc: 0.865 Test Loss: 1.183 Test Acc: 0.865
Validation loss decreased (-0.837824 --> -0.864853).  Saving model ...
Epoch: 9 cost time: 0.8149898052215576
Epoch: 9, Steps: 17 | Train Loss: 0.983 Vali Loss: 0.930 Vali Acc: 0.892 Test Loss: 0.930 Test Acc: 0.892
Validation loss decreased (-0.864853 --> -0.891883).  Saving model ...
Epoch: 10 cost time: 1.3058600425720215
Epoch: 10, Steps: 17 | Train Loss: 0.712 Vali Loss: 0.636 Vali Acc: 0.919 Test Loss: 0.636 Test Acc: 0.919
Validation loss decreased (-0.891883 --> -0.918913).  Saving model ...
Epoch: 11 cost time: 1.2118909358978271
Epoch: 11, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.395 Vali Acc: 0.935 Test Loss: 0.395 Test Acc: 0.935
Validation loss decreased (-0.918913 --> -0.935131).  Saving model ...
Epoch: 12 cost time: 1.1084325313568115
Epoch: 12, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.278 Vali Acc: 0.924 Test Loss: 0.278 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1994190216064453
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.230 Vali Acc: 0.935 Test Loss: 0.230 Test Acc: 0.935
Validation loss decreased (-0.935131 --> -0.935133).  Saving model ...
Epoch: 14 cost time: 1.0720391273498535
Epoch: 14, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
Validation loss decreased (-0.935133 --> -0.937836).  Saving model ...
Epoch: 15 cost time: 1.0560674667358398
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.937836 --> -0.940539).  Saving model ...
Epoch: 16 cost time: 0.9326608180999756
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2378392219543457
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.179 Vali Acc: 0.932 Test Loss: 0.179 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1608076095581055
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.168 Vali Acc: 0.938 Test Loss: 0.168 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3374574184417725
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2311732769012451
Epoch: 20, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.932 Test Loss: 0.188 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3180978298187256
Epoch: 21, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.938 Test Loss: 0.196 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1950478553771973
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8917551040649414
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.174360752105713
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.259443759918213
Epoch: 25, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9405405405405406
model parameter : 12035
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.3850786685943604
Epoch: 1, Steps: 17 | Train Loss: 2.198 Vali Loss: 2.153 Vali Acc: 0.168 Test Loss: 2.153 Test Acc: 0.168
Validation loss decreased (inf --> -0.167546).  Saving model ...
Epoch: 2 cost time: 1.1800172328948975
Epoch: 2, Steps: 17 | Train Loss: 2.139 Vali Loss: 2.077 Vali Acc: 0.262 Test Loss: 2.077 Test Acc: 0.262
Validation loss decreased (-0.167546 --> -0.262141).  Saving model ...
Epoch: 3 cost time: 1.131267786026001
Epoch: 3, Steps: 17 | Train Loss: 2.047 Vali Loss: 1.982 Vali Acc: 0.395 Test Loss: 1.982 Test Acc: 0.395
Validation loss decreased (-0.262141 --> -0.394575).  Saving model ...
Epoch: 4 cost time: 1.166872262954712
Epoch: 4, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.865 Vali Acc: 0.546 Test Loss: 1.865 Test Acc: 0.546
Validation loss decreased (-0.394575 --> -0.545927).  Saving model ...
Epoch: 5 cost time: 1.3324635028839111
Epoch: 5, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.720 Vali Acc: 0.722 Test Loss: 1.720 Test Acc: 0.722
Validation loss decreased (-0.545927 --> -0.721604).  Saving model ...
Epoch: 6 cost time: 1.247065544128418
Epoch: 6, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.545 Vali Acc: 0.805 Test Loss: 1.545 Test Acc: 0.805
Validation loss decreased (-0.721604 --> -0.805390).  Saving model ...
Epoch: 7 cost time: 1.3216350078582764
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.317 Vali Acc: 0.849 Test Loss: 1.317 Test Acc: 0.849
Validation loss decreased (-0.805390 --> -0.848635).  Saving model ...
Epoch: 8 cost time: 1.1758460998535156
Epoch: 8, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.015 Vali Acc: 0.881 Test Loss: 1.015 Test Acc: 0.881
Validation loss decreased (-0.848635 --> -0.881071).  Saving model ...
Epoch: 9 cost time: 1.1914725303649902
Epoch: 9, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.646 Vali Acc: 0.886 Test Loss: 0.646 Test Acc: 0.886
Validation loss decreased (-0.881071 --> -0.886480).  Saving model ...
Epoch: 10 cost time: 1.0388846397399902
Epoch: 10, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.381 Vali Acc: 0.916 Test Loss: 0.381 Test Acc: 0.916
Validation loss decreased (-0.886480 --> -0.916212).  Saving model ...
Epoch: 11 cost time: 0.8948092460632324
Epoch: 11, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.245 Vali Acc: 0.943 Test Loss: 0.245 Test Acc: 0.943
Validation loss decreased (-0.916212 --> -0.943241).  Saving model ...
Epoch: 12 cost time: 0.9148173332214355
Epoch: 12, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943241).  Saving model ...
Epoch: 13 cost time: 1.2824070453643799
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
Validation loss decreased (-0.943241 --> -0.948647).  Saving model ...
Epoch: 14 cost time: 1.085690975189209
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.156 Vali Acc: 0.943 Test Loss: 0.156 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0098271369934082
Epoch: 15, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.122 Vali Acc: 0.954 Test Loss: 0.122 Test Acc: 0.954
Validation loss decreased (-0.948647 --> -0.954053).  Saving model ...
Epoch: 16 cost time: 1.323307991027832
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0933821201324463
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 18 cost time: 0.8674659729003906
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.148 Vali Acc: 0.954 Test Loss: 0.148 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0100200176239014
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.156 Vali Acc: 0.954 Test Loss: 0.156 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1666526794433594
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.4043996334075928
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.154 Vali Acc: 0.951 Test Loss: 0.154 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.051318883895874
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.946 Test Loss: 0.183 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1580376625061035
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0309686660766602
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1755952835083008
Epoch: 25, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8264973163604736
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1016902923583984
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.949 Test Loss: 0.210 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 11729
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.253246545791626
Epoch: 1, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.145 Vali Acc: 0.162 Test Loss: 2.145 Test Acc: 0.162
Validation loss decreased (inf --> -0.162141).  Saving model ...
Epoch: 2 cost time: 1.2340271472930908
Epoch: 2, Steps: 17 | Train Loss: 2.113 Vali Loss: 2.067 Vali Acc: 0.316 Test Loss: 2.067 Test Acc: 0.316
Validation loss decreased (-0.162141 --> -0.316196).  Saving model ...
Epoch: 3 cost time: 1.4685139656066895
Epoch: 3, Steps: 17 | Train Loss: 2.018 Vali Loss: 1.962 Vali Acc: 0.478 Test Loss: 1.962 Test Acc: 0.478
Validation loss decreased (-0.316196 --> -0.478359).  Saving model ...
Epoch: 4 cost time: 1.1869838237762451
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.830 Vali Acc: 0.681 Test Loss: 1.830 Test Acc: 0.681
Validation loss decreased (-0.478359 --> -0.681063).  Saving model ...
Epoch: 5 cost time: 1.015552282333374
Epoch: 5, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.660 Vali Acc: 0.808 Test Loss: 1.660 Test Acc: 0.808
Validation loss decreased (-0.681063 --> -0.808092).  Saving model ...
Epoch: 6 cost time: 0.9451780319213867
Epoch: 6, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.427 Vali Acc: 0.865 Test Loss: 1.427 Test Acc: 0.865
Validation loss decreased (-0.808092 --> -0.864851).  Saving model ...
Epoch: 7 cost time: 0.9485557079315186
Epoch: 7, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.103 Vali Acc: 0.905 Test Loss: 1.103 Test Acc: 0.905
Validation loss decreased (-0.864851 --> -0.905394).  Saving model ...
Epoch: 8 cost time: 1.1020877361297607
Epoch: 8, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.691 Vali Acc: 0.900 Test Loss: 0.691 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.021545648574829
Epoch: 9, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.394 Vali Acc: 0.903 Test Loss: 0.394 Test Acc: 0.903
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.117384672164917
Epoch: 10, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
Validation loss decreased (-0.905394 --> -0.937835).  Saving model ...
Epoch: 11 cost time: 1.00531005859375
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
Validation loss decreased (-0.937835 --> -0.937836).  Saving model ...
Epoch: 12 cost time: 1.099503755569458
Epoch: 12, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.162 Vali Acc: 0.951 Test Loss: 0.162 Test Acc: 0.951
Validation loss decreased (-0.937836 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 1.1274693012237549
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.144 Vali Acc: 0.957 Test Loss: 0.144 Test Acc: 0.957
Validation loss decreased (-0.951350 --> -0.956755).  Saving model ...
Epoch: 14 cost time: 0.9236400127410889
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5601050853729248
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.152 Vali Acc: 0.951 Test Loss: 0.152 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1227777004241943
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.367614507675171
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9066195487976074
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8946011066436768
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0956227779388428
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.938 Test Loss: 0.199 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0086288452148438
Epoch: 21, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0385992527008057
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.389378309249878
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 11677
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.721083641052246
Epoch: 1, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.163 Vali Acc: 0.143 Test Loss: 2.163 Test Acc: 0.143
Validation loss decreased (inf --> -0.143222).  Saving model ...
Epoch: 2 cost time: 0.911557674407959
Epoch: 2, Steps: 17 | Train Loss: 2.106 Vali Loss: 2.089 Vali Acc: 0.224 Test Loss: 2.089 Test Acc: 0.224
Validation loss decreased (-0.143222 --> -0.224303).  Saving model ...
Epoch: 3 cost time: 0.8463976383209229
Epoch: 3, Steps: 17 | Train Loss: 2.017 Vali Loss: 1.990 Vali Acc: 0.305 Test Loss: 1.990 Test Acc: 0.305
Validation loss decreased (-0.224303 --> -0.305386).  Saving model ...
Epoch: 4 cost time: 0.8518154621124268
Epoch: 4, Steps: 17 | Train Loss: 1.901 Vali Loss: 1.866 Vali Acc: 0.508 Test Loss: 1.866 Test Acc: 0.508
Validation loss decreased (-0.305386 --> -0.508089).  Saving model ...
Epoch: 5 cost time: 1.0839779376983643
Epoch: 5, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.710 Vali Acc: 0.673 Test Loss: 1.710 Test Acc: 0.673
Validation loss decreased (-0.508089 --> -0.672956).  Saving model ...
Epoch: 6 cost time: 1.0852382183074951
Epoch: 6, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.488 Vali Acc: 0.781 Test Loss: 1.488 Test Acc: 0.781
Validation loss decreased (-0.672956 --> -0.781066).  Saving model ...
Epoch: 7 cost time: 1.0990443229675293
Epoch: 7, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.134 Vali Acc: 0.832 Test Loss: 1.134 Test Acc: 0.832
Validation loss decreased (-0.781066 --> -0.832421).  Saving model ...
Epoch: 8 cost time: 1.2453863620758057
Epoch: 8, Steps: 17 | Train Loss: 0.878 Vali Loss: 0.689 Vali Acc: 0.865 Test Loss: 0.689 Test Acc: 0.865
Validation loss decreased (-0.832421 --> -0.864858).  Saving model ...
Epoch: 9 cost time: 1.1685750484466553
Epoch: 9, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.401 Vali Acc: 0.868 Test Loss: 0.401 Test Acc: 0.868
Validation loss decreased (-0.864858 --> -0.867564).  Saving model ...
Epoch: 10 cost time: 1.1393227577209473
Epoch: 10, Steps: 17 | Train Loss: 0.307 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.867564 --> -0.918916).  Saving model ...
Epoch: 11 cost time: 1.0864861011505127
Epoch: 11, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.217 Vali Acc: 0.924 Test Loss: 0.217 Test Acc: 0.924
Validation loss decreased (-0.918916 --> -0.924322).  Saving model ...
Epoch: 12 cost time: 1.0127198696136475
Epoch: 12, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.924322 --> -0.940539).  Saving model ...
Epoch: 13 cost time: 1.0670959949493408
Epoch: 13, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940539 --> -0.940539).  Saving model ...
Epoch: 14 cost time: 1.3599963188171387
Epoch: 14, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.170 Vali Acc: 0.943 Test Loss: 0.170 Test Acc: 0.943
Validation loss decreased (-0.940539 --> -0.943242).  Saving model ...
Epoch: 15 cost time: 1.3655853271484375
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.186 Vali Acc: 0.946 Test Loss: 0.186 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 16 cost time: 1.0396044254302979
Epoch: 16, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.945944 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.103994607925415
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2744665145874023
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3639979362487793
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2759268283843994
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1141085624694824
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.899911642074585
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1400392055511475
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.272 Vali Acc: 0.935 Test Loss: 0.272 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.4274473190307617
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.249 Vali Acc: 0.949 Test Loss: 0.249 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1055727005004883
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.420154094696045
Epoch: 26, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.272 Vali Acc: 0.943 Test Loss: 0.272 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 11513
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8409533500671387
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.181 Vali Acc: 0.097 Test Loss: 2.181 Test Acc: 0.097
Validation loss decreased (inf --> -0.097275).  Saving model ...
Epoch: 2 cost time: 1.0149223804473877
Epoch: 2, Steps: 17 | Train Loss: 2.119 Vali Loss: 2.096 Vali Acc: 0.200 Test Loss: 2.096 Test Acc: 0.200
Validation loss decreased (-0.097275 --> -0.199979).  Saving model ...
Epoch: 3 cost time: 1.1714420318603516
Epoch: 3, Steps: 17 | Train Loss: 2.018 Vali Loss: 1.986 Vali Acc: 0.403 Test Loss: 1.986 Test Acc: 0.403
Validation loss decreased (-0.199979 --> -0.402683).  Saving model ...
Epoch: 4 cost time: 1.0938374996185303
Epoch: 4, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.847 Vali Acc: 0.651 Test Loss: 1.847 Test Acc: 0.651
Validation loss decreased (-0.402683 --> -0.651333).  Saving model ...
Epoch: 5 cost time: 0.9952511787414551
Epoch: 5, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.692 Vali Acc: 0.765 Test Loss: 1.692 Test Acc: 0.765
Validation loss decreased (-0.651333 --> -0.764848).  Saving model ...
Epoch: 6 cost time: 0.9614729881286621
Epoch: 6, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.501 Vali Acc: 0.832 Test Loss: 1.501 Test Acc: 0.832
Validation loss decreased (-0.764848 --> -0.832417).  Saving model ...
Epoch: 7 cost time: 1.1119041442871094
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.289 Vali Acc: 0.873 Test Loss: 1.289 Test Acc: 0.873
Validation loss decreased (-0.832417 --> -0.872960).  Saving model ...
Epoch: 8 cost time: 1.094233751296997
Epoch: 8, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.056 Vali Acc: 0.881 Test Loss: 1.056 Test Acc: 0.881
Validation loss decreased (-0.872960 --> -0.881071).  Saving model ...
Epoch: 9 cost time: 1.1445934772491455
Epoch: 9, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.802 Vali Acc: 0.914 Test Loss: 0.802 Test Acc: 0.914
Validation loss decreased (-0.881071 --> -0.913505).  Saving model ...
Epoch: 10 cost time: 1.197504997253418
Epoch: 10, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.542 Vali Acc: 0.927 Test Loss: 0.542 Test Acc: 0.927
Validation loss decreased (-0.913505 --> -0.927022).  Saving model ...
Epoch: 11 cost time: 0.9281761646270752
Epoch: 11, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.927022 --> -0.940537).  Saving model ...
Epoch: 12 cost time: 0.9281694889068604
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.221 Vali Acc: 0.935 Test Loss: 0.221 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9774856567382812
Epoch: 13, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.181 Vali Acc: 0.938 Test Loss: 0.181 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3527336120605469
Epoch: 14, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (-0.940537 --> -0.940539).  Saving model ...
Epoch: 15 cost time: 0.9348211288452148
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.971301794052124
Epoch: 16, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.161 Vali Acc: 0.935 Test Loss: 0.161 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8613848686218262
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.193 Vali Acc: 0.935 Test Loss: 0.193 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9239764213562012
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.167 Vali Acc: 0.938 Test Loss: 0.167 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.13930344581604
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2083990573883057
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2851567268371582
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
Validation loss decreased (-0.940539 --> -0.945944).  Saving model ...
Epoch: 22 cost time: 0.8863365650177002
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.938 Test Loss: 0.221 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9032282829284668
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.946 Test Loss: 0.220 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.143052577972412
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.938 Test Loss: 0.249 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9554464817047119
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2262251377105713
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0860240459442139
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.246476173400879
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.272 Vali Acc: 0.938 Test Loss: 0.272 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.053236961364746
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9395978450775146
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.938 Test Loss: 0.288 Test Acc: 0.938
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.5095994472503662
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.294 Vali Acc: 0.943 Test Loss: 0.294 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 11475
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6018946170806885
Epoch: 1, Steps: 17 | Train Loss: 2.142 Vali Loss: 2.163 Vali Acc: 0.138 Test Loss: 2.163 Test Acc: 0.138
Validation loss decreased (inf --> -0.137816).  Saving model ...
Epoch: 2 cost time: 1.3319823741912842
Epoch: 2, Steps: 17 | Train Loss: 2.076 Vali Loss: 2.071 Vali Acc: 0.224 Test Loss: 2.071 Test Acc: 0.224
Validation loss decreased (-0.137816 --> -0.224304).  Saving model ...
Epoch: 3 cost time: 1.0383751392364502
Epoch: 3, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.958 Vali Acc: 0.349 Test Loss: 1.958 Test Acc: 0.349
Validation loss decreased (-0.224304 --> -0.348629).  Saving model ...
Epoch: 4 cost time: 1.621730089187622
Epoch: 4, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.820 Vali Acc: 0.543 Test Loss: 1.820 Test Acc: 0.543
Validation loss decreased (-0.348629 --> -0.543225).  Saving model ...
Epoch: 5 cost time: 0.9340023994445801
Epoch: 5, Steps: 17 | Train Loss: 1.705 Vali Loss: 1.660 Vali Acc: 0.678 Test Loss: 1.660 Test Acc: 0.678
Validation loss decreased (-0.543225 --> -0.678362).  Saving model ...
Epoch: 6 cost time: 1.1595089435577393
Epoch: 6, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.462 Vali Acc: 0.751 Test Loss: 1.462 Test Acc: 0.751
Validation loss decreased (-0.678362 --> -0.751337).  Saving model ...
Epoch: 7 cost time: 1.3253674507141113
Epoch: 7, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.193 Vali Acc: 0.819 Test Loss: 1.193 Test Acc: 0.819
Validation loss decreased (-0.751337 --> -0.818907).  Saving model ...
Epoch: 8 cost time: 1.1808042526245117
Epoch: 8, Steps: 17 | Train Loss: 0.987 Vali Loss: 0.842 Vali Acc: 0.857 Test Loss: 0.842 Test Acc: 0.857
Validation loss decreased (-0.818907 --> -0.856748).  Saving model ...
Epoch: 9 cost time: 1.27445650100708
Epoch: 9, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.507 Vali Acc: 0.873 Test Loss: 0.507 Test Acc: 0.873
Validation loss decreased (-0.856748 --> -0.872968).  Saving model ...
Epoch: 10 cost time: 1.094846487045288
Epoch: 10, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.337 Vali Acc: 0.886 Test Loss: 0.337 Test Acc: 0.886
Validation loss decreased (-0.872968 --> -0.886483).  Saving model ...
Epoch: 11 cost time: 1.2604830265045166
Epoch: 11, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.230 Vali Acc: 0.932 Test Loss: 0.230 Test Acc: 0.932
Validation loss decreased (-0.886483 --> -0.932430).  Saving model ...
Epoch: 12 cost time: 1.0169942378997803
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (-0.932430 --> -0.932430).  Saving model ...
Epoch: 13 cost time: 1.1546714305877686
Epoch: 13, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.164 Vali Acc: 0.946 Test Loss: 0.164 Test Acc: 0.946
Validation loss decreased (-0.932430 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.0213050842285156
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.171 Vali Acc: 0.946 Test Loss: 0.171 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9759807586669922
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.194 Vali Acc: 0.938 Test Loss: 0.194 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2908453941345215
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2213826179504395
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.190 Vali Acc: 0.949 Test Loss: 0.190 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 18 cost time: 1.1236939430236816
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1647670269012451
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 0.9041047096252441
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3396496772766113
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.3641624450683594
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.230 Vali Acc: 0.938 Test Loss: 0.230 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2361640930175781
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1829564571380615
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0091845989227295
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.943 Test Loss: 0.223 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9846301078796387
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.042665719985962
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.256 Vali Acc: 0.938 Test Loss: 0.256 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.061800479888916
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1970546245574951
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.275 Vali Acc: 0.938 Test Loss: 0.275 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 11533
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.104431390762329
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 2.201 Vali Acc: 0.119 Test Loss: 2.201 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 1.163250207901001
Epoch: 2, Steps: 17 | Train Loss: 2.164 Vali Loss: 2.117 Vali Acc: 0.232 Test Loss: 2.117 Test Acc: 0.232
Validation loss decreased (-0.118897 --> -0.232411).  Saving model ...
Epoch: 3 cost time: 1.4182465076446533
Epoch: 3, Steps: 17 | Train Loss: 2.065 Vali Loss: 2.013 Vali Acc: 0.430 Test Loss: 2.013 Test Acc: 0.430
Validation loss decreased (-0.232411 --> -0.429710).  Saving model ...
Epoch: 4 cost time: 1.0101182460784912
Epoch: 4, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.877 Vali Acc: 0.581 Test Loss: 1.877 Test Acc: 0.581
Validation loss decreased (-0.429710 --> -0.581062).  Saving model ...
Epoch: 5 cost time: 1.126828670501709
Epoch: 5, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.707 Vali Acc: 0.727 Test Loss: 1.707 Test Acc: 0.727
Validation loss decreased (-0.581062 --> -0.727010).  Saving model ...
Epoch: 6 cost time: 1.0021543502807617
Epoch: 6, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.473 Vali Acc: 0.792 Test Loss: 1.473 Test Acc: 0.792
Validation loss decreased (-0.727010 --> -0.791877).  Saving model ...
Epoch: 7 cost time: 1.0669529438018799
Epoch: 7, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.128 Vali Acc: 0.816 Test Loss: 1.128 Test Acc: 0.816
Validation loss decreased (-0.791877 --> -0.816205).  Saving model ...
Epoch: 8 cost time: 1.0772104263305664
Epoch: 8, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.701 Vali Acc: 0.851 Test Loss: 0.701 Test Acc: 0.851
Validation loss decreased (-0.816205 --> -0.851344).  Saving model ...
Epoch: 9 cost time: 1.0368139743804932
Epoch: 9, Steps: 17 | Train Loss: 0.519 Vali Loss: 0.420 Vali Acc: 0.886 Test Loss: 0.420 Test Acc: 0.886
Validation loss decreased (-0.851344 --> -0.886482).  Saving model ...
Epoch: 10 cost time: 1.0057201385498047
Epoch: 10, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.886482 --> -0.929727).  Saving model ...
Epoch: 11 cost time: 1.0933256149291992
Epoch: 11, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.216 Vali Acc: 0.949 Test Loss: 0.216 Test Acc: 0.949
Validation loss decreased (-0.929727 --> -0.948646).  Saving model ...
Epoch: 12 cost time: 1.2483057975769043
Epoch: 12, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951350).  Saving model ...
Epoch: 13 cost time: 1.1437959671020508
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.176 Vali Acc: 0.943 Test Loss: 0.176 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9040496349334717
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3344552516937256
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.188 Vali Acc: 0.938 Test Loss: 0.188 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.143686294555664
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 17 cost time: 1.1857285499572754
Epoch: 17, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.189 Vali Acc: 0.938 Test Loss: 0.189 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0516612529754639
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.160 Vali Acc: 0.946 Test Loss: 0.160 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0784070491790771
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.02803635597229
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.943 Test Loss: 0.193 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9940304756164551
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0718867778778076
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1475975513458252
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.149810552597046
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 25 cost time: 1.0491983890533447
Epoch: 25, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.932 Test Loss: 0.237 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.061227798461914
Epoch: 26, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.949 Test Loss: 0.194 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.948249101638794
Epoch: 27, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.935 Test Loss: 0.210 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6612653732299805
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.935 Test Loss: 0.223 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.121647596359253
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.222 Vali Acc: 0.938 Test Loss: 0.222 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9253628253936768
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5610020160675049
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.248 Vali Acc: 0.938 Test Loss: 0.248 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9315998554229736
Epoch: 32, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.280 Vali Acc: 0.935 Test Loss: 0.280 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9452543258666992
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.969491720199585
Epoch: 34, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.287 Vali Acc: 0.938 Test Loss: 0.287 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 11491
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.530644178390503
Epoch: 1, Steps: 17 | Train Loss: 2.250 Vali Loss: 2.235 Vali Acc: 0.200 Test Loss: 2.235 Test Acc: 0.200
Validation loss decreased (inf --> -0.199978).  Saving model ...
Epoch: 2 cost time: 1.102870225906372
Epoch: 2, Steps: 17 | Train Loss: 2.186 Vali Loss: 2.150 Vali Acc: 0.257 Test Loss: 2.150 Test Acc: 0.257
Validation loss decreased (-0.199978 --> -0.256735).  Saving model ...
Epoch: 3 cost time: 1.141660451889038
Epoch: 3, Steps: 17 | Train Loss: 2.091 Vali Loss: 2.044 Vali Acc: 0.330 Test Loss: 2.044 Test Acc: 0.330
Validation loss decreased (-0.256735 --> -0.329709).  Saving model ...
Epoch: 4 cost time: 1.1600532531738281
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.907 Vali Acc: 0.459 Test Loss: 1.907 Test Acc: 0.459
Validation loss decreased (-0.329709 --> -0.459440).  Saving model ...
Epoch: 5 cost time: 1.0345735549926758
Epoch: 5, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.739 Vali Acc: 0.681 Test Loss: 1.739 Test Acc: 0.681
Validation loss decreased (-0.459440 --> -0.681064).  Saving model ...
Epoch: 6 cost time: 0.8626031875610352
Epoch: 6, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.479 Vali Acc: 0.803 Test Loss: 1.479 Test Acc: 0.803
Validation loss decreased (-0.681064 --> -0.802688).  Saving model ...
Epoch: 7 cost time: 1.0877878665924072
Epoch: 7, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.031 Vali Acc: 0.870 Test Loss: 1.031 Test Acc: 0.870
Validation loss decreased (-0.802688 --> -0.870260).  Saving model ...
Epoch: 8 cost time: 0.936758279800415
Epoch: 8, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.528 Vali Acc: 0.892 Test Loss: 0.528 Test Acc: 0.892
Validation loss decreased (-0.870260 --> -0.891887).  Saving model ...
Epoch: 9 cost time: 1.1929221153259277
Epoch: 9, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.313 Vali Acc: 0.914 Test Loss: 0.313 Test Acc: 0.914
Validation loss decreased (-0.891887 --> -0.913510).  Saving model ...
Epoch: 10 cost time: 1.100874900817871
Epoch: 10, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.253 Vali Acc: 0.927 Test Loss: 0.253 Test Acc: 0.927
Validation loss decreased (-0.913510 --> -0.927024).  Saving model ...
Epoch: 11 cost time: 1.2682547569274902
Epoch: 11, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.224 Vali Acc: 0.927 Test Loss: 0.224 Test Acc: 0.927
Validation loss decreased (-0.927024 --> -0.927025).  Saving model ...
Epoch: 12 cost time: 1.069983720779419
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0690298080444336
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0756175518035889
Epoch: 14, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8996760845184326
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.201 Vali Acc: 0.932 Test Loss: 0.201 Test Acc: 0.932
Validation loss decreased (-0.927025 --> -0.932430).  Saving model ...
Epoch: 16 cost time: 1.0138068199157715
Epoch: 16, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2256584167480469
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.212 Vali Acc: 0.935 Test Loss: 0.212 Test Acc: 0.935
Validation loss decreased (-0.932430 --> -0.935133).  Saving model ...
Epoch: 18 cost time: 1.2997665405273438
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.932 Test Loss: 0.221 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9687018394470215
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.946 Test Loss: 0.189 Test Acc: 0.946
Validation loss decreased (-0.935133 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 0.7966768741607666
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0897047519683838
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.949 Test Loss: 0.198 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 0.820570707321167
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8610308170318604
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.949 Test Loss: 0.219 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2493250370025635
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1613495349884033
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.247 Vali Acc: 0.943 Test Loss: 0.247 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7990224361419678
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.282 Vali Acc: 0.932 Test Loss: 0.282 Test Acc: 0.932
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0515589714050293
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.014798641204834
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.938 Test Loss: 0.285 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1251518726348877
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9855654239654541
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.966461181640625
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.295 Vali Acc: 0.941 Test Loss: 0.295 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm128_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 11697
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5240135192871094
Epoch: 1, Steps: 17 | Train Loss: 2.146 Vali Loss: 2.082 Vali Acc: 0.284 Test Loss: 2.082 Test Acc: 0.284
Validation loss decreased (inf --> -0.283763).  Saving model ...
Epoch: 2 cost time: 1.0665538311004639
Epoch: 2, Steps: 17 | Train Loss: 2.083 Vali Loss: 2.012 Vali Acc: 0.381 Test Loss: 2.012 Test Acc: 0.381
Validation loss decreased (-0.283763 --> -0.381061).  Saving model ...
Epoch: 3 cost time: 1.129730463027954
Epoch: 3, Steps: 17 | Train Loss: 1.987 Vali Loss: 1.909 Vali Acc: 0.492 Test Loss: 1.909 Test Acc: 0.492
Validation loss decreased (-0.381061 --> -0.491873).  Saving model ...
Epoch: 4 cost time: 1.0573503971099854
Epoch: 4, Steps: 17 | Train Loss: 1.869 Vali Loss: 1.791 Vali Acc: 0.597 Test Loss: 1.791 Test Acc: 0.597
Validation loss decreased (-0.491873 --> -0.597279).  Saving model ...
Epoch: 5 cost time: 1.048572301864624
Epoch: 5, Steps: 17 | Train Loss: 1.727 Vali Loss: 1.648 Vali Acc: 0.716 Test Loss: 1.648 Test Acc: 0.716
Validation loss decreased (-0.597279 --> -0.716200).  Saving model ...
Epoch: 6 cost time: 1.1126017570495605
Epoch: 6, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.486 Vali Acc: 0.795 Test Loss: 1.486 Test Acc: 0.795
Validation loss decreased (-0.716200 --> -0.794580).  Saving model ...
Epoch: 7 cost time: 1.1397244930267334
Epoch: 7, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.299 Vali Acc: 0.862 Test Loss: 1.299 Test Acc: 0.862
Validation loss decreased (-0.794580 --> -0.862149).  Saving model ...
Epoch: 8 cost time: 0.9644098281860352
Epoch: 8, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.109 Vali Acc: 0.878 Test Loss: 1.109 Test Acc: 0.878
Validation loss decreased (-0.862149 --> -0.878367).  Saving model ...
Epoch: 9 cost time: 0.9874875545501709
Epoch: 9, Steps: 17 | Train Loss: 0.977 Vali Loss: 0.928 Vali Acc: 0.905 Test Loss: 0.928 Test Acc: 0.905
Validation loss decreased (-0.878367 --> -0.905396).  Saving model ...
Epoch: 10 cost time: 1.1051843166351318
Epoch: 10, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.759 Vali Acc: 0.916 Test Loss: 0.759 Test Acc: 0.916
Validation loss decreased (-0.905396 --> -0.916209).  Saving model ...
Epoch: 11 cost time: 0.9003860950469971
Epoch: 11, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.611 Vali Acc: 0.922 Test Loss: 0.611 Test Acc: 0.922
Validation loss decreased (-0.916209 --> -0.921616).  Saving model ...
Epoch: 12 cost time: 1.1339421272277832
Epoch: 12, Steps: 17 | Train Loss: 0.503 Vali Loss: 0.476 Vali Acc: 0.941 Test Loss: 0.476 Test Acc: 0.941
Validation loss decreased (-0.921616 --> -0.940536).  Saving model ...
Epoch: 13 cost time: 1.3554298877716064
Epoch: 13, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.353 Vali Acc: 0.946 Test Loss: 0.353 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 14 cost time: 1.0648701190948486
Epoch: 14, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948646).  Saving model ...
Epoch: 15 cost time: 1.362485647201538
Epoch: 15, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.209 Vali Acc: 0.949 Test Loss: 0.209 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 16 cost time: 1.1175525188446045
Epoch: 16, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
Validation loss decreased (-0.948647 --> -0.956755).  Saving model ...
Epoch: 17 cost time: 1.125229835510254
Epoch: 17, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 18 cost time: 1.0112078189849854
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2700247764587402
Epoch: 19, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.147 Vali Acc: 0.954 Test Loss: 0.147 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4497005939483643
Epoch: 20, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.142 Vali Acc: 0.957 Test Loss: 0.142 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 21 cost time: 1.26389741897583
Epoch: 21, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.946 Test Loss: 0.141 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1574866771697998
Epoch: 22, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.954 Test Loss: 0.133 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9666306972503662
Epoch: 23, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9646804332733154
Epoch: 24, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.954 Test Loss: 0.132 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8398387432098389
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.143 Vali Acc: 0.949 Test Loss: 0.143 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0979671478271484
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9851109981536865
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5750982761383057
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.951 Test Loss: 0.148 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.810981035232544
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.152 Vali Acc: 0.943 Test Loss: 0.152 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0278480052947998
Epoch: 30, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.946 Test Loss: 0.152 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9567567567567568
model parameter : 6603
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.3093929290771484
Epoch: 1, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.163 Vali Acc: 0.143 Test Loss: 2.163 Test Acc: 0.143
Validation loss decreased (inf --> -0.143222).  Saving model ...
Epoch: 2 cost time: 1.2597923278808594
Epoch: 2, Steps: 17 | Train Loss: 2.163 Vali Loss: 2.091 Vali Acc: 0.246 Test Loss: 2.091 Test Acc: 0.246
Validation loss decreased (-0.143222 --> -0.245925).  Saving model ...
Epoch: 3 cost time: 0.9675455093383789
Epoch: 3, Steps: 17 | Train Loss: 2.073 Vali Loss: 1.999 Vali Acc: 0.470 Test Loss: 1.999 Test Acc: 0.470
Validation loss decreased (-0.245925 --> -0.470250).  Saving model ...
Epoch: 4 cost time: 1.0810348987579346
Epoch: 4, Steps: 17 | Train Loss: 1.958 Vali Loss: 1.884 Vali Acc: 0.635 Test Loss: 1.884 Test Acc: 0.635
Validation loss decreased (-0.470250 --> -0.635116).  Saving model ...
Epoch: 5 cost time: 1.3316435813903809
Epoch: 5, Steps: 17 | Train Loss: 1.821 Vali Loss: 1.744 Vali Acc: 0.778 Test Loss: 1.744 Test Acc: 0.778
Validation loss decreased (-0.635116 --> -0.778361).  Saving model ...
Epoch: 6 cost time: 0.9865434169769287
Epoch: 6, Steps: 17 | Train Loss: 1.657 Vali Loss: 1.573 Vali Acc: 0.846 Test Loss: 1.573 Test Acc: 0.846
Validation loss decreased (-0.778361 --> -0.845930).  Saving model ...
Epoch: 7 cost time: 0.8743135929107666
Epoch: 7, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.385 Vali Acc: 0.857 Test Loss: 1.385 Test Acc: 0.857
Validation loss decreased (-0.845930 --> -0.856743).  Saving model ...
Epoch: 8 cost time: 0.9947795867919922
Epoch: 8, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.186 Vali Acc: 0.873 Test Loss: 1.186 Test Acc: 0.873
Validation loss decreased (-0.856743 --> -0.872961).  Saving model ...
Epoch: 9 cost time: 1.396881103515625
Epoch: 9, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.000 Vali Acc: 0.884 Test Loss: 1.000 Test Acc: 0.884
Validation loss decreased (-0.872961 --> -0.883774).  Saving model ...
Epoch: 10 cost time: 1.0425331592559814
Epoch: 10, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.824 Vali Acc: 0.895 Test Loss: 0.824 Test Acc: 0.895
Validation loss decreased (-0.883774 --> -0.894586).  Saving model ...
Epoch: 11 cost time: 0.9733269214630127
Epoch: 11, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.675 Vali Acc: 0.905 Test Loss: 0.675 Test Acc: 0.905
Validation loss decreased (-0.894586 --> -0.905399).  Saving model ...
Epoch: 12 cost time: 1.2804934978485107
Epoch: 12, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.551 Vali Acc: 0.930 Test Loss: 0.551 Test Acc: 0.930
Validation loss decreased (-0.905399 --> -0.929724).  Saving model ...
Epoch: 13 cost time: 0.9648795127868652
Epoch: 13, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
Validation loss decreased (-0.929724 --> -0.940536).  Saving model ...
Epoch: 14 cost time: 1.0127477645874023
Epoch: 14, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.323 Vali Acc: 0.946 Test Loss: 0.323 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945943).  Saving model ...
Epoch: 15 cost time: 0.7950286865234375
Epoch: 15, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.235 Vali Acc: 0.951 Test Loss: 0.235 Test Acc: 0.951
Validation loss decreased (-0.945943 --> -0.951349).  Saving model ...
Epoch: 16 cost time: 0.9085583686828613
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.175 Vali Acc: 0.949 Test Loss: 0.175 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9626212120056152
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.154 Vali Acc: 0.954 Test Loss: 0.154 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954053).  Saving model ...
Epoch: 18 cost time: 1.1305460929870605
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.127 Vali Acc: 0.959 Test Loss: 0.127 Test Acc: 0.959
Validation loss decreased (-0.954053 --> -0.959458).  Saving model ...
Epoch: 19 cost time: 0.9764888286590576
Epoch: 19, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.124 Vali Acc: 0.959 Test Loss: 0.124 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.1473338603973389
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.122 Vali Acc: 0.962 Test Loss: 0.122 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962161).  Saving model ...
Epoch: 21 cost time: 0.8957772254943848
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
Validation loss decreased (-0.962161 --> -0.964864).  Saving model ...
Epoch: 22 cost time: 0.8924293518066406
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.129 Vali Acc: 0.959 Test Loss: 0.129 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9000403881072998
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.802525520324707
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.951 Test Loss: 0.145 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9871554374694824
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8427326679229736
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.141 Vali Acc: 0.959 Test Loss: 0.141 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9131851196289062
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.954 Test Loss: 0.151 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9221456050872803
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.981682538986206
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0099563598632812
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.951 Test Loss: 0.173 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8385517597198486
Epoch: 31, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.951 Test Loss: 0.166 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 6457
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.699479341506958
Epoch: 1, Steps: 17 | Train Loss: 2.183 Vali Loss: 2.121 Vali Acc: 0.305 Test Loss: 2.121 Test Acc: 0.305
Validation loss decreased (inf --> -0.305384).  Saving model ...
Epoch: 2 cost time: 1.2686269283294678
Epoch: 2, Steps: 17 | Train Loss: 2.121 Vali Loss: 2.056 Vali Acc: 0.400 Test Loss: 2.056 Test Acc: 0.400
Validation loss decreased (-0.305384 --> -0.399979).  Saving model ...
Epoch: 3 cost time: 1.059516191482544
Epoch: 3, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.965 Vali Acc: 0.486 Test Loss: 1.965 Test Acc: 0.486
Validation loss decreased (-0.399979 --> -0.486467).  Saving model ...
Epoch: 4 cost time: 1.2283778190612793
Epoch: 4, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.852 Vali Acc: 0.584 Test Loss: 1.852 Test Acc: 0.584
Validation loss decreased (-0.486467 --> -0.583765).  Saving model ...
Epoch: 5 cost time: 0.9382402896881104
Epoch: 5, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.714 Vali Acc: 0.684 Test Loss: 1.714 Test Acc: 0.684
Validation loss decreased (-0.583765 --> -0.683767).  Saving model ...
Epoch: 6 cost time: 1.0305845737457275
Epoch: 6, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.564 Vali Acc: 0.738 Test Loss: 1.564 Test Acc: 0.738
Validation loss decreased (-0.683767 --> -0.737822).  Saving model ...
Epoch: 7 cost time: 1.1717543601989746
Epoch: 7, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.382 Vali Acc: 0.800 Test Loss: 1.382 Test Acc: 0.800
Validation loss decreased (-0.737822 --> -0.799986).  Saving model ...
Epoch: 8 cost time: 1.016538381576538
Epoch: 8, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.193 Vali Acc: 0.862 Test Loss: 1.193 Test Acc: 0.862
Validation loss decreased (-0.799986 --> -0.862150).  Saving model ...
Epoch: 9 cost time: 0.9298205375671387
Epoch: 9, Steps: 17 | Train Loss: 1.049 Vali Loss: 0.997 Vali Acc: 0.889 Test Loss: 0.997 Test Acc: 0.889
Validation loss decreased (-0.862150 --> -0.889179).  Saving model ...
Epoch: 10 cost time: 1.034700632095337
Epoch: 10, Steps: 17 | Train Loss: 0.865 Vali Loss: 0.827 Vali Acc: 0.903 Test Loss: 0.827 Test Acc: 0.903
Validation loss decreased (-0.889179 --> -0.902694).  Saving model ...
Epoch: 11 cost time: 1.0299265384674072
Epoch: 11, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.675 Vali Acc: 0.927 Test Loss: 0.675 Test Acc: 0.927
Validation loss decreased (-0.902694 --> -0.927020).  Saving model ...
Epoch: 12 cost time: 0.9998931884765625
Epoch: 12, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.549 Vali Acc: 0.922 Test Loss: 0.549 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7665584087371826
Epoch: 13, Steps: 17 | Train Loss: 0.454 Vali Loss: 0.439 Vali Acc: 0.935 Test Loss: 0.439 Test Acc: 0.935
Validation loss decreased (-0.927020 --> -0.935131).  Saving model ...
Epoch: 14 cost time: 1.102034330368042
Epoch: 14, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.349 Vali Acc: 0.938 Test Loss: 0.349 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 15 cost time: 1.284846544265747
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940538).  Saving model ...
Epoch: 16 cost time: 1.1119494438171387
Epoch: 16, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
Validation loss decreased (-0.940538 --> -0.943241).  Saving model ...
Epoch: 17 cost time: 1.1588146686553955
Epoch: 17, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
Validation loss decreased (-0.943241 --> -0.951350).  Saving model ...
Epoch: 18 cost time: 0.7872319221496582
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9677937030792236
Epoch: 19, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
Validation loss decreased (-0.951350 --> -0.951350).  Saving model ...
Epoch: 20 cost time: 0.8083112239837646
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.144 Vali Acc: 0.954 Test Loss: 0.144 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954053).  Saving model ...
Epoch: 21 cost time: 1.1642651557922363
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.139 Vali Acc: 0.954 Test Loss: 0.139 Test Acc: 0.954
Validation loss decreased (-0.954053 --> -0.954053).  Saving model ...
Epoch: 22 cost time: 1.5064618587493896
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.166 Vali Acc: 0.949 Test Loss: 0.166 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0969996452331543
Epoch: 23, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.146 Vali Acc: 0.949 Test Loss: 0.146 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1759192943572998
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.949 Test Loss: 0.155 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.884589433670044
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.949 Test Loss: 0.158 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0263278484344482
Epoch: 26, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.017944574356079
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0116961002349854
Epoch: 28, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.943 Test Loss: 0.185 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0978333950042725
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.189666748046875
Epoch: 30, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.946 Test Loss: 0.179 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.342970848083496
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.938 Test Loss: 0.206 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 6469
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.629183769226074
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.188 Vali Acc: 0.141 Test Loss: 2.188 Test Acc: 0.141
Validation loss decreased (inf --> -0.140519).  Saving model ...
Epoch: 2 cost time: 1.083230972290039
Epoch: 2, Steps: 17 | Train Loss: 2.141 Vali Loss: 2.115 Vali Acc: 0.235 Test Loss: 2.115 Test Acc: 0.235
Validation loss decreased (-0.140519 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 0.971991777420044
Epoch: 3, Steps: 17 | Train Loss: 2.053 Vali Loss: 2.019 Vali Acc: 0.408 Test Loss: 2.019 Test Acc: 0.408
Validation loss decreased (-0.235114 --> -0.408088).  Saving model ...
Epoch: 4 cost time: 0.9643862247467041
Epoch: 4, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.908 Vali Acc: 0.557 Test Loss: 1.908 Test Acc: 0.557
Validation loss decreased (-0.408088 --> -0.556738).  Saving model ...
Epoch: 5 cost time: 1.0654776096343994
Epoch: 5, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.772 Vali Acc: 0.651 Test Loss: 1.772 Test Acc: 0.651
Validation loss decreased (-0.556738 --> -0.651334).  Saving model ...
Epoch: 6 cost time: 1.2085700035095215
Epoch: 6, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.605 Vali Acc: 0.757 Test Loss: 1.605 Test Acc: 0.757
Validation loss decreased (-0.651334 --> -0.756741).  Saving model ...
Epoch: 7 cost time: 1.3599998950958252
Epoch: 7, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.419 Vali Acc: 0.846 Test Loss: 1.419 Test Acc: 0.846
Validation loss decreased (-0.756741 --> -0.845932).  Saving model ...
Epoch: 8 cost time: 1.1582601070404053
Epoch: 8, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.220 Vali Acc: 0.889 Test Loss: 1.220 Test Acc: 0.889
Validation loss decreased (-0.845932 --> -0.889177).  Saving model ...
Epoch: 9 cost time: 0.7668170928955078
Epoch: 9, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.026 Vali Acc: 0.914 Test Loss: 1.026 Test Acc: 0.914
Validation loss decreased (-0.889177 --> -0.913503).  Saving model ...
Epoch: 10 cost time: 0.9972307682037354
Epoch: 10, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.855 Vali Acc: 0.924 Test Loss: 0.855 Test Acc: 0.924
Validation loss decreased (-0.913503 --> -0.924316).  Saving model ...
Epoch: 11 cost time: 1.1163361072540283
Epoch: 11, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.700 Vali Acc: 0.941 Test Loss: 0.700 Test Acc: 0.941
Validation loss decreased (-0.924316 --> -0.940534).  Saving model ...
Epoch: 12 cost time: 0.8820581436157227
Epoch: 12, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.582 Vali Acc: 0.946 Test Loss: 0.582 Test Acc: 0.946
Validation loss decreased (-0.940534 --> -0.945940).  Saving model ...
Epoch: 13 cost time: 1.057042121887207
Epoch: 13, Steps: 17 | Train Loss: 0.493 Vali Loss: 0.488 Vali Acc: 0.946 Test Loss: 0.488 Test Acc: 0.946
Validation loss decreased (-0.945940 --> -0.945941).  Saving model ...
Epoch: 14 cost time: 0.9581401348114014
Epoch: 14, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.414 Vali Acc: 0.954 Test Loss: 0.414 Test Acc: 0.954
Validation loss decreased (-0.945941 --> -0.954050).  Saving model ...
Epoch: 15 cost time: 0.9275109767913818
Epoch: 15, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.351 Vali Acc: 0.951 Test Loss: 0.351 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0197694301605225
Epoch: 16, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.292 Vali Acc: 0.954 Test Loss: 0.292 Test Acc: 0.954
Validation loss decreased (-0.954050 --> -0.954051).  Saving model ...
Epoch: 17 cost time: 0.9625730514526367
Epoch: 17, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.241 Vali Acc: 0.954 Test Loss: 0.241 Test Acc: 0.954
Validation loss decreased (-0.954051 --> -0.954052).  Saving model ...
Epoch: 18 cost time: 0.9346656799316406
Epoch: 18, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8755340576171875
Epoch: 19, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.170 Vali Acc: 0.949 Test Loss: 0.170 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0918984413146973
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.158 Vali Acc: 0.943 Test Loss: 0.158 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8379380702972412
Epoch: 21, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.146 Vali Acc: 0.951 Test Loss: 0.146 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0650782585144043
Epoch: 22, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0145907402038574
Epoch: 23, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.157 Vali Acc: 0.943 Test Loss: 0.157 Test Acc: 0.943
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9136972427368164
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.175 Vali Acc: 0.938 Test Loss: 0.175 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8879966735839844
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.938 Test Loss: 0.182 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9176902770996094
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7341017723083496
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 6369
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.481248140335083
Epoch: 1, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.173 Vali Acc: 0.130 Test Loss: 2.173 Test Acc: 0.130
Validation loss decreased (inf --> -0.129708).  Saving model ...
Epoch: 2 cost time: 0.9754719734191895
Epoch: 2, Steps: 17 | Train Loss: 2.116 Vali Loss: 2.093 Vali Acc: 0.232 Test Loss: 2.093 Test Acc: 0.232
Validation loss decreased (-0.129708 --> -0.232412).  Saving model ...
Epoch: 3 cost time: 0.8548088073730469
Epoch: 3, Steps: 17 | Train Loss: 2.023 Vali Loss: 1.988 Vali Acc: 0.397 Test Loss: 1.988 Test Acc: 0.397
Validation loss decreased (-0.232412 --> -0.397277).  Saving model ...
Epoch: 4 cost time: 0.8268146514892578
Epoch: 4, Steps: 17 | Train Loss: 1.907 Vali Loss: 1.866 Vali Acc: 0.576 Test Loss: 1.866 Test Acc: 0.576
Validation loss decreased (-0.397277 --> -0.575657).  Saving model ...
Epoch: 5 cost time: 0.8448102474212646
Epoch: 5, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.717 Vali Acc: 0.730 Test Loss: 1.717 Test Acc: 0.730
Validation loss decreased (-0.575657 --> -0.729713).  Saving model ...
Epoch: 6 cost time: 0.8485305309295654
Epoch: 6, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.555 Vali Acc: 0.814 Test Loss: 1.555 Test Acc: 0.814
Validation loss decreased (-0.729713 --> -0.813498).  Saving model ...
Epoch: 7 cost time: 0.8740584850311279
Epoch: 7, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.366 Vali Acc: 0.854 Test Loss: 1.366 Test Acc: 0.854
Validation loss decreased (-0.813498 --> -0.854040).  Saving model ...
Epoch: 8 cost time: 0.8570077419281006
Epoch: 8, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.175 Vali Acc: 0.884 Test Loss: 1.175 Test Acc: 0.884
Validation loss decreased (-0.854040 --> -0.883772).  Saving model ...
Epoch: 9 cost time: 0.9262924194335938
Epoch: 9, Steps: 17 | Train Loss: 1.036 Vali Loss: 0.988 Vali Acc: 0.903 Test Loss: 0.988 Test Acc: 0.903
Validation loss decreased (-0.883772 --> -0.902693).  Saving model ...
Epoch: 10 cost time: 0.962742805480957
Epoch: 10, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.821 Vali Acc: 0.916 Test Loss: 0.821 Test Acc: 0.916
Validation loss decreased (-0.902693 --> -0.916208).  Saving model ...
Epoch: 11 cost time: 1.000424861907959
Epoch: 11, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.681 Vali Acc: 0.935 Test Loss: 0.681 Test Acc: 0.935
Validation loss decreased (-0.916208 --> -0.935128).  Saving model ...
Epoch: 12 cost time: 0.9337649345397949
Epoch: 12, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.564 Vali Acc: 0.938 Test Loss: 0.564 Test Acc: 0.938
Validation loss decreased (-0.935128 --> -0.937832).  Saving model ...
Epoch: 13 cost time: 1.0358757972717285
Epoch: 13, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.476 Vali Acc: 0.941 Test Loss: 0.476 Test Acc: 0.941
Validation loss decreased (-0.937832 --> -0.940536).  Saving model ...
Epoch: 14 cost time: 1.0219483375549316
Epoch: 14, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.392 Vali Acc: 0.946 Test Loss: 0.392 Test Acc: 0.946
Validation loss decreased (-0.940536 --> -0.945942).  Saving model ...
Epoch: 15 cost time: 0.8083488941192627
Epoch: 15, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.321 Vali Acc: 0.949 Test Loss: 0.321 Test Acc: 0.949
Validation loss decreased (-0.945942 --> -0.948645).  Saving model ...
Epoch: 16 cost time: 0.8928563594818115
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.261 Vali Acc: 0.949 Test Loss: 0.261 Test Acc: 0.949
Validation loss decreased (-0.948645 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 1.2375714778900146
Epoch: 17, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.948646 --> -0.951349).  Saving model ...
Epoch: 18 cost time: 0.893277645111084
Epoch: 18, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.170 Vali Acc: 0.954 Test Loss: 0.170 Test Acc: 0.954
Validation loss decreased (-0.951349 --> -0.954052).  Saving model ...
Epoch: 19 cost time: 1.0221014022827148
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8991613388061523
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.149 Vali Acc: 0.951 Test Loss: 0.149 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8386759757995605
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8969836235046387
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9086771011352539
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.062889575958252
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9936361312866211
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.943 Test Loss: 0.172 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.826446533203125
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.943 Test Loss: 0.188 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8377842903137207
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.179 Vali Acc: 0.943 Test Loss: 0.179 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9014828205108643
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 6363
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.161339282989502
Epoch: 1, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.145 Vali Acc: 0.249 Test Loss: 2.145 Test Acc: 0.249
Validation loss decreased (inf --> -0.248627).  Saving model ...
Epoch: 2 cost time: 1.0988352298736572
Epoch: 2, Steps: 17 | Train Loss: 2.145 Vali Loss: 2.070 Vali Acc: 0.341 Test Loss: 2.070 Test Acc: 0.341
Validation loss decreased (-0.248627 --> -0.340520).  Saving model ...
Epoch: 3 cost time: 0.851165771484375
Epoch: 3, Steps: 17 | Train Loss: 2.050 Vali Loss: 1.973 Vali Acc: 0.495 Test Loss: 1.973 Test Acc: 0.495
Validation loss decreased (-0.340520 --> -0.494575).  Saving model ...
Epoch: 4 cost time: 1.0248935222625732
Epoch: 4, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.856 Vali Acc: 0.622 Test Loss: 1.856 Test Acc: 0.622
Validation loss decreased (-0.494575 --> -0.621603).  Saving model ...
Epoch: 5 cost time: 1.022934913635254
Epoch: 5, Steps: 17 | Train Loss: 1.785 Vali Loss: 1.703 Vali Acc: 0.768 Test Loss: 1.703 Test Acc: 0.768
Validation loss decreased (-0.621603 --> -0.767551).  Saving model ...
Epoch: 6 cost time: 0.9658610820770264
Epoch: 6, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.516 Vali Acc: 0.851 Test Loss: 1.516 Test Acc: 0.851
Validation loss decreased (-0.767551 --> -0.851336).  Saving model ...
Epoch: 7 cost time: 0.947695255279541
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.274 Vali Acc: 0.919 Test Loss: 1.274 Test Acc: 0.919
Validation loss decreased (-0.851336 --> -0.918906).  Saving model ...
Epoch: 8 cost time: 0.999086856842041
Epoch: 8, Steps: 17 | Train Loss: 1.119 Vali Loss: 0.986 Vali Acc: 0.919 Test Loss: 0.986 Test Acc: 0.919
Validation loss decreased (-0.918906 --> -0.918909).  Saving model ...
Epoch: 9 cost time: 0.912416934967041
Epoch: 9, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.662 Vali Acc: 0.889 Test Loss: 0.662 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9326767921447754
Epoch: 10, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.428 Vali Acc: 0.905 Test Loss: 0.428 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.154198408126831
Epoch: 11, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.299 Vali Acc: 0.924 Test Loss: 0.299 Test Acc: 0.924
Validation loss decreased (-0.918909 --> -0.924321).  Saving model ...
Epoch: 12 cost time: 0.9278502464294434
Epoch: 12, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.233 Vali Acc: 0.932 Test Loss: 0.233 Test Acc: 0.932
Validation loss decreased (-0.924321 --> -0.932430).  Saving model ...
Epoch: 13 cost time: 1.1715712547302246
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.187 Vali Acc: 0.943 Test Loss: 0.187 Test Acc: 0.943
Validation loss decreased (-0.932430 --> -0.943241).  Saving model ...
Epoch: 14 cost time: 0.9326913356781006
Epoch: 14, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1708309650421143
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.153 Vali Acc: 0.943 Test Loss: 0.153 Test Acc: 0.943
Validation loss decreased (-0.943241 --> -0.943242).  Saving model ...
Epoch: 16 cost time: 1.1591415405273438
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.155 Vali Acc: 0.943 Test Loss: 0.155 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1418967247009277
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.167 Vali Acc: 0.943 Test Loss: 0.167 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1679637432098389
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.154 Vali Acc: 0.946 Test Loss: 0.154 Test Acc: 0.946
Validation loss decreased (-0.943242 --> -0.945944).  Saving model ...
Epoch: 19 cost time: 1.127723217010498
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9589095115661621
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 21 cost time: 0.8979320526123047
Epoch: 21, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.943 Test Loss: 0.182 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8332502841949463
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.943 Test Loss: 0.177 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1081669330596924
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.943 Test Loss: 0.178 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7670300006866455
Epoch: 24, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.946 Test Loss: 0.196 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9596657752990723
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.946 Test Loss: 0.191 Test Acc: 0.946
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0630557537078857
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0724234580993652
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8954677581787109
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.946 Test Loss: 0.218 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.877385139465332
Epoch: 29, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.946 Test Loss: 0.219 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.9072732925415039
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.946 Test Loss: 0.226 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 6453
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 3.092472553253174
Epoch: 1, Steps: 17 | Train Loss: 2.115 Vali Loss: 2.079 Vali Acc: 0.308 Test Loss: 2.079 Test Acc: 0.308
Validation loss decreased (inf --> -0.308087).  Saving model ...
Epoch: 2 cost time: 0.9636549949645996
Epoch: 2, Steps: 17 | Train Loss: 2.046 Vali Loss: 1.997 Vali Acc: 0.397 Test Loss: 1.997 Test Acc: 0.397
Validation loss decreased (-0.308087 --> -0.397277).  Saving model ...
Epoch: 3 cost time: 1.0448009967803955
Epoch: 3, Steps: 17 | Train Loss: 1.941 Vali Loss: 1.891 Vali Acc: 0.486 Test Loss: 1.891 Test Acc: 0.486
Validation loss decreased (-0.397277 --> -0.486468).  Saving model ...
Epoch: 4 cost time: 1.4563384056091309
Epoch: 4, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.759 Vali Acc: 0.614 Test Loss: 1.759 Test Acc: 0.614
Validation loss decreased (-0.486468 --> -0.613496).  Saving model ...
Epoch: 5 cost time: 1.1743764877319336
Epoch: 5, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.609 Vali Acc: 0.741 Test Loss: 1.609 Test Acc: 0.741
Validation loss decreased (-0.613496 --> -0.740524).  Saving model ...
Epoch: 6 cost time: 0.8788759708404541
Epoch: 6, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.437 Vali Acc: 0.811 Test Loss: 1.437 Test Acc: 0.811
Validation loss decreased (-0.740524 --> -0.810796).  Saving model ...
Epoch: 7 cost time: 0.7647571563720703
Epoch: 7, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.250 Vali Acc: 0.851 Test Loss: 1.250 Test Acc: 0.851
Validation loss decreased (-0.810796 --> -0.851339).  Saving model ...
Epoch: 8 cost time: 0.9207417964935303
Epoch: 8, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.068 Vali Acc: 0.873 Test Loss: 1.068 Test Acc: 0.873
Validation loss decreased (-0.851339 --> -0.872962).  Saving model ...
Epoch: 9 cost time: 1.0130789279937744
Epoch: 9, Steps: 17 | Train Loss: 0.930 Vali Loss: 0.901 Vali Acc: 0.895 Test Loss: 0.901 Test Acc: 0.895
Validation loss decreased (-0.872962 --> -0.894586).  Saving model ...
Epoch: 10 cost time: 0.7974412441253662
Epoch: 10, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.762 Vali Acc: 0.914 Test Loss: 0.762 Test Acc: 0.914
Validation loss decreased (-0.894586 --> -0.913506).  Saving model ...
Epoch: 11 cost time: 0.9643039703369141
Epoch: 11, Steps: 17 | Train Loss: 0.645 Vali Loss: 0.642 Vali Acc: 0.924 Test Loss: 0.642 Test Acc: 0.924
Validation loss decreased (-0.913506 --> -0.924318).  Saving model ...
Epoch: 12 cost time: 0.9344162940979004
Epoch: 12, Steps: 17 | Train Loss: 0.540 Vali Loss: 0.538 Vali Acc: 0.930 Test Loss: 0.538 Test Acc: 0.930
Validation loss decreased (-0.924318 --> -0.929724).  Saving model ...
Epoch: 13 cost time: 0.8362798690795898
Epoch: 13, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.457 Vali Acc: 0.932 Test Loss: 0.457 Test Acc: 0.932
Validation loss decreased (-0.929724 --> -0.932428).  Saving model ...
Epoch: 14 cost time: 0.8757312297821045
Epoch: 14, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.384 Vali Acc: 0.938 Test Loss: 0.384 Test Acc: 0.938
Validation loss decreased (-0.932428 --> -0.937834).  Saving model ...
Epoch: 15 cost time: 0.7990665435791016
Epoch: 15, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.310 Vali Acc: 0.946 Test Loss: 0.310 Test Acc: 0.946
Validation loss decreased (-0.937834 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 0.8883609771728516
Epoch: 16, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.244 Vali Acc: 0.949 Test Loss: 0.244 Test Acc: 0.949
Validation loss decreased (-0.945943 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 0.8393151760101318
Epoch: 17, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.191 Vali Acc: 0.943 Test Loss: 0.191 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7821059226989746
Epoch: 18, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
Validation loss decreased (-0.948646 --> -0.956755).  Saving model ...
Epoch: 19 cost time: 0.7424983978271484
Epoch: 19, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.134 Vali Acc: 0.959 Test Loss: 0.134 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 0.8412380218505859
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.141 Vali Acc: 0.954 Test Loss: 0.141 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7892007827758789
Epoch: 21, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.957 Test Loss: 0.128 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9104666709899902
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.954 Test Loss: 0.137 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.00296950340271
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.951 Test Loss: 0.137 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9655632972717285
Epoch: 24, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.949 Test Loss: 0.151 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7883124351501465
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.154 Vali Acc: 0.949 Test Loss: 0.154 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9452874660491943
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8284764289855957
Epoch: 27, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.168 Vali Acc: 0.943 Test Loss: 0.168 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8933758735656738
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.949 Test Loss: 0.171 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9879181385040283
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 6443
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.640839099884033
Epoch: 1, Steps: 17 | Train Loss: 2.199 Vali Loss: 2.167 Vali Acc: 0.149 Test Loss: 2.167 Test Acc: 0.149
Validation loss decreased (inf --> -0.148627).  Saving model ...
Epoch: 2 cost time: 0.9582517147064209
Epoch: 2, Steps: 17 | Train Loss: 2.133 Vali Loss: 2.080 Vali Acc: 0.235 Test Loss: 2.080 Test Acc: 0.235
Validation loss decreased (-0.148627 --> -0.235114).  Saving model ...
Epoch: 3 cost time: 1.0003719329833984
Epoch: 3, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.966 Vali Acc: 0.386 Test Loss: 1.966 Test Acc: 0.386
Validation loss decreased (-0.235114 --> -0.386467).  Saving model ...
Epoch: 4 cost time: 0.9103949069976807
Epoch: 4, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.829 Vali Acc: 0.600 Test Loss: 1.829 Test Acc: 0.600
Validation loss decreased (-0.386467 --> -0.599982).  Saving model ...
Epoch: 5 cost time: 0.9167325496673584
Epoch: 5, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.659 Vali Acc: 0.770 Test Loss: 1.659 Test Acc: 0.770
Validation loss decreased (-0.599982 --> -0.770254).  Saving model ...
Epoch: 6 cost time: 0.8348653316497803
Epoch: 6, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.458 Vali Acc: 0.835 Test Loss: 1.458 Test Acc: 0.835
Validation loss decreased (-0.770254 --> -0.835121).  Saving model ...
Epoch: 7 cost time: 0.8847298622131348
Epoch: 7, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.192 Vali Acc: 0.873 Test Loss: 1.192 Test Acc: 0.873
Validation loss decreased (-0.835121 --> -0.872961).  Saving model ...
Epoch: 8 cost time: 0.8587646484375
Epoch: 8, Steps: 17 | Train Loss: 1.034 Vali Loss: 0.893 Vali Acc: 0.870 Test Loss: 0.893 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.03511381149292
Epoch: 9, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.611 Vali Acc: 0.895 Test Loss: 0.611 Test Acc: 0.895
Validation loss decreased (-0.872961 --> -0.894588).  Saving model ...
Epoch: 10 cost time: 0.8085391521453857
Epoch: 10, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.404 Vali Acc: 0.924 Test Loss: 0.404 Test Acc: 0.924
Validation loss decreased (-0.894588 --> -0.924320).  Saving model ...
Epoch: 11 cost time: 0.9870364665985107
Epoch: 11, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.859729528427124
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
Validation loss decreased (-0.924320 --> -0.937835).  Saving model ...
Epoch: 13 cost time: 0.8530070781707764
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.937835 --> -0.945944).  Saving model ...
Epoch: 14 cost time: 1.1704442501068115
Epoch: 14, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 15 cost time: 0.8526067733764648
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0554380416870117
Epoch: 16, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7922160625457764
Epoch: 17, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.223 Vali Acc: 0.932 Test Loss: 0.223 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9461262226104736
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0794596672058105
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.199 Vali Acc: 0.943 Test Loss: 0.199 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8958954811096191
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.236 Vali Acc: 0.932 Test Loss: 0.236 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0378568172454834
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9431757926940918
Epoch: 22, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.267 Vali Acc: 0.932 Test Loss: 0.267 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8034706115722656
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.245 Vali Acc: 0.935 Test Loss: 0.245 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.692551851272583
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.248 Vali Acc: 0.938 Test Loss: 0.248 Test Acc: 0.938
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm64_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9459459459459459
model parameter : 6681
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.840118408203125
Epoch: 1, Steps: 17 | Train Loss: 2.185 Vali Loss: 2.208 Vali Acc: 0.111 Test Loss: 2.208 Test Acc: 0.111
Validation loss decreased (inf --> -0.110789).  Saving model ...
Epoch: 2 cost time: 1.167175531387329
Epoch: 2, Steps: 17 | Train Loss: 2.130 Vali Loss: 2.138 Vali Acc: 0.151 Test Loss: 2.138 Test Acc: 0.151
Validation loss decreased (-0.110789 --> -0.151330).  Saving model ...
Epoch: 3 cost time: 1.209212303161621
Epoch: 3, Steps: 17 | Train Loss: 2.045 Vali Loss: 2.047 Vali Acc: 0.268 Test Loss: 2.047 Test Acc: 0.268
Validation loss decreased (-0.151330 --> -0.267547).  Saving model ...
Epoch: 4 cost time: 1.1545655727386475
Epoch: 4, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.934 Vali Acc: 0.432 Test Loss: 1.934 Test Acc: 0.432
Validation loss decreased (-0.267547 --> -0.432413).  Saving model ...
Epoch: 5 cost time: 0.9185178279876709
Epoch: 5, Steps: 17 | Train Loss: 1.816 Vali Loss: 1.805 Vali Acc: 0.616 Test Loss: 1.805 Test Acc: 0.616
Validation loss decreased (-0.432413 --> -0.616198).  Saving model ...
Epoch: 6 cost time: 1.128511905670166
Epoch: 6, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.644 Vali Acc: 0.746 Test Loss: 1.644 Test Acc: 0.746
Validation loss decreased (-0.616198 --> -0.745930).  Saving model ...
Epoch: 7 cost time: 1.0412487983703613
Epoch: 7, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.473 Vali Acc: 0.795 Test Loss: 1.473 Test Acc: 0.795
Validation loss decreased (-0.745930 --> -0.794580).  Saving model ...
Epoch: 8 cost time: 1.451186180114746
Epoch: 8, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.287 Vali Acc: 0.835 Test Loss: 1.287 Test Acc: 0.835
Validation loss decreased (-0.794580 --> -0.835122).  Saving model ...
Epoch: 9 cost time: 1.1406893730163574
Epoch: 9, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.090 Vali Acc: 0.868 Test Loss: 1.090 Test Acc: 0.868
Validation loss decreased (-0.835122 --> -0.867557).  Saving model ...
Epoch: 10 cost time: 1.1873149871826172
Epoch: 10, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.903 Vali Acc: 0.881 Test Loss: 0.903 Test Acc: 0.881
Validation loss decreased (-0.867557 --> -0.881072).  Saving model ...
Epoch: 11 cost time: 1.1137659549713135
Epoch: 11, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.881072 --> -0.899993).  Saving model ...
Epoch: 12 cost time: 1.3323006629943848
Epoch: 12, Steps: 17 | Train Loss: 0.584 Vali Loss: 0.585 Vali Acc: 0.914 Test Loss: 0.585 Test Acc: 0.914
Validation loss decreased (-0.899993 --> -0.913508).  Saving model ...
Epoch: 13 cost time: 0.9416089057922363
Epoch: 13, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.470 Vali Acc: 0.919 Test Loss: 0.470 Test Acc: 0.919
Validation loss decreased (-0.913508 --> -0.918914).  Saving model ...
Epoch: 14 cost time: 0.8670792579650879
Epoch: 14, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.370 Vali Acc: 0.938 Test Loss: 0.370 Test Acc: 0.938
Validation loss decreased (-0.918914 --> -0.937834).  Saving model ...
Epoch: 15 cost time: 1.121342658996582
Epoch: 15, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.303 Vali Acc: 0.943 Test Loss: 0.303 Test Acc: 0.943
Validation loss decreased (-0.937834 --> -0.943240).  Saving model ...
Epoch: 16 cost time: 1.0821385383605957
Epoch: 16, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.251 Vali Acc: 0.949 Test Loss: 0.251 Test Acc: 0.949
Validation loss decreased (-0.943240 --> -0.948646).  Saving model ...
Epoch: 17 cost time: 0.9478013515472412
Epoch: 17, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.011751651763916
Epoch: 18, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.189 Vali Acc: 0.943 Test Loss: 0.189 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9671494960784912
Epoch: 19, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.954146146774292
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2140164375305176
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.152 Vali Acc: 0.949 Test Loss: 0.152 Test Acc: 0.949
Validation loss decreased (-0.948646 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 0.9882829189300537
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.188403844833374
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.146 Vali Acc: 0.943 Test Loss: 0.146 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0194263458251953
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.943 Test Loss: 0.148 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9732210636138916
Epoch: 25, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.949 Test Loss: 0.145 Test Acc: 0.949
Validation loss decreased (-0.948647 --> -0.948647).  Saving model ...
Epoch: 26 cost time: 0.9098196029663086
Epoch: 26, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.946 Test Loss: 0.151 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8685362339019775
Epoch: 27, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.949 Test Loss: 0.156 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9136505126953125
Epoch: 28, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.149 Vali Acc: 0.946 Test Loss: 0.149 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.095108985900879
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.943 Test Loss: 0.164 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.4534413814544678
Epoch: 30, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.949 Test Loss: 0.165 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5287933349609375
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.2061529159545898
Epoch: 32, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.946 Test Loss: 0.174 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0231428146362305
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.943 Test Loss: 0.175 Test Acc: 0.943
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.941025972366333
Epoch: 34, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2704837322235107
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.935 Test Loss: 0.192 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9486486486486486
model parameter : 5039
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.163942575454712
Epoch: 1, Steps: 17 | Train Loss: 2.288 Vali Loss: 2.228 Vali Acc: 0.059 Test Loss: 2.228 Test Acc: 0.059
Validation loss decreased (inf --> -0.059437).  Saving model ...
Epoch: 2 cost time: 0.8853673934936523
Epoch: 2, Steps: 17 | Train Loss: 2.221 Vali Loss: 2.150 Vali Acc: 0.122 Test Loss: 2.150 Test Acc: 0.122
Validation loss decreased (-0.059437 --> -0.121600).  Saving model ...
Epoch: 3 cost time: 0.8628432750701904
Epoch: 3, Steps: 17 | Train Loss: 2.120 Vali Loss: 2.052 Vali Acc: 0.297 Test Loss: 2.052 Test Acc: 0.297
Validation loss decreased (-0.121600 --> -0.297277).  Saving model ...
Epoch: 4 cost time: 1.0040886402130127
Epoch: 4, Steps: 17 | Train Loss: 2.003 Vali Loss: 1.936 Vali Acc: 0.519 Test Loss: 1.936 Test Acc: 0.519
Validation loss decreased (-0.297277 --> -0.518900).  Saving model ...
Epoch: 5 cost time: 0.9603166580200195
Epoch: 5, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.798 Vali Acc: 0.678 Test Loss: 1.798 Test Acc: 0.678
Validation loss decreased (-0.518900 --> -0.678360).  Saving model ...
Epoch: 6 cost time: 0.9086098670959473
Epoch: 6, Steps: 17 | Train Loss: 1.703 Vali Loss: 1.638 Vali Acc: 0.776 Test Loss: 1.638 Test Acc: 0.776
Validation loss decreased (-0.678360 --> -0.775659).  Saving model ...
Epoch: 7 cost time: 0.9128174781799316
Epoch: 7, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.448 Vali Acc: 0.835 Test Loss: 1.448 Test Acc: 0.835
Validation loss decreased (-0.775659 --> -0.835121).  Saving model ...
Epoch: 8 cost time: 0.8318798542022705
Epoch: 8, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.254 Vali Acc: 0.876 Test Loss: 1.254 Test Acc: 0.876
Validation loss decreased (-0.835121 --> -0.875663).  Saving model ...
Epoch: 9 cost time: 1.1285881996154785
Epoch: 9, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.050 Vali Acc: 0.886 Test Loss: 1.050 Test Acc: 0.886
Validation loss decreased (-0.875663 --> -0.886476).  Saving model ...
Epoch: 10 cost time: 1.0022568702697754
Epoch: 10, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.860 Vali Acc: 0.916 Test Loss: 0.860 Test Acc: 0.916
Validation loss decreased (-0.886476 --> -0.916208).  Saving model ...
Epoch: 11 cost time: 0.8499975204467773
Epoch: 11, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.689 Vali Acc: 0.919 Test Loss: 0.689 Test Acc: 0.919
Validation loss decreased (-0.916208 --> -0.918912).  Saving model ...
Epoch: 12 cost time: 0.8042454719543457
Epoch: 12, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.556 Vali Acc: 0.924 Test Loss: 0.556 Test Acc: 0.924
Validation loss decreased (-0.918912 --> -0.924319).  Saving model ...
Epoch: 13 cost time: 1.1139962673187256
Epoch: 13, Steps: 17 | Train Loss: 0.441 Vali Loss: 0.446 Vali Acc: 0.935 Test Loss: 0.446 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935131).  Saving model ...
Epoch: 14 cost time: 0.8034567832946777
Epoch: 14, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.357 Vali Acc: 0.946 Test Loss: 0.357 Test Acc: 0.946
Validation loss decreased (-0.935131 --> -0.945942).  Saving model ...
Epoch: 15 cost time: 0.8882367610931396
Epoch: 15, Steps: 17 | Train Loss: 0.269 Vali Loss: 0.289 Vali Acc: 0.946 Test Loss: 0.289 Test Acc: 0.946
Validation loss decreased (-0.945942 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 1.134181261062622
Epoch: 16, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945943).  Saving model ...
Epoch: 17 cost time: 0.9658324718475342
Epoch: 17, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 0.7055635452270508
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.193 Vali Acc: 0.949 Test Loss: 0.193 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 19 cost time: 1.0752460956573486
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
Validation loss decreased (-0.948647 --> -0.959458).  Saving model ...
Epoch: 20 cost time: 1.050459861755371
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0628674030303955
Epoch: 21, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.174 Vali Acc: 0.943 Test Loss: 0.174 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0328078269958496
Epoch: 22, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.135148286819458
Epoch: 23, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.932 Test Loss: 0.178 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.148876667022705
Epoch: 24, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.176 Vali Acc: 0.935 Test Loss: 0.176 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9556376934051514
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.932 Test Loss: 0.183 Test Acc: 0.932
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9337434768676758
Epoch: 26, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.935 Test Loss: 0.184 Test Acc: 0.935
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.143418788909912
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.932 Test Loss: 0.193 Test Acc: 0.932
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8858072757720947
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.924 Test Loss: 0.216 Test Acc: 0.924
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1319725513458252
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.932 Test Loss: 0.206 Test Acc: 0.932
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9594594594594594
model parameter : 4973
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.482475996017456
Epoch: 1, Steps: 17 | Train Loss: 2.356 Vali Loss: 2.368 Vali Acc: 0.092 Test Loss: 2.368 Test Acc: 0.092
Validation loss decreased (inf --> -0.091868).  Saving model ...
Epoch: 2 cost time: 1.0567233562469482
Epoch: 2, Steps: 17 | Train Loss: 2.294 Vali Loss: 2.288 Vali Acc: 0.127 Test Loss: 2.288 Test Acc: 0.127
Validation loss decreased (-0.091868 --> -0.127004).  Saving model ...
Epoch: 3 cost time: 0.9528684616088867
Epoch: 3, Steps: 17 | Train Loss: 2.207 Vali Loss: 2.188 Vali Acc: 0.184 Test Loss: 2.188 Test Acc: 0.184
Validation loss decreased (-0.127004 --> -0.183762).  Saving model ...
Epoch: 4 cost time: 0.9181084632873535
Epoch: 4, Steps: 17 | Train Loss: 2.103 Vali Loss: 2.077 Vali Acc: 0.308 Test Loss: 2.077 Test Acc: 0.308
Validation loss decreased (-0.183762 --> -0.308087).  Saving model ...
Epoch: 5 cost time: 0.6091382503509521
Epoch: 5, Steps: 17 | Train Loss: 1.989 Vali Loss: 1.960 Vali Acc: 0.459 Test Loss: 1.960 Test Acc: 0.459
Validation loss decreased (-0.308087 --> -0.459440).  Saving model ...
Epoch: 6 cost time: 0.9528584480285645
Epoch: 6, Steps: 17 | Train Loss: 1.852 Vali Loss: 1.823 Vali Acc: 0.595 Test Loss: 1.823 Test Acc: 0.595
Validation loss decreased (-0.459440 --> -0.594576).  Saving model ...
Epoch: 7 cost time: 1.05210280418396
Epoch: 7, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.667 Vali Acc: 0.705 Test Loss: 1.667 Test Acc: 0.705
Validation loss decreased (-0.594576 --> -0.705389).  Saving model ...
Epoch: 8 cost time: 0.8916435241699219
Epoch: 8, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.489 Vali Acc: 0.814 Test Loss: 1.489 Test Acc: 0.814
Validation loss decreased (-0.705389 --> -0.813499).  Saving model ...
Epoch: 9 cost time: 0.9269635677337646
Epoch: 9, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.299 Vali Acc: 0.868 Test Loss: 1.299 Test Acc: 0.868
Validation loss decreased (-0.813499 --> -0.867555).  Saving model ...
Epoch: 10 cost time: 0.7866649627685547
Epoch: 10, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.094 Vali Acc: 0.916 Test Loss: 1.094 Test Acc: 0.916
Validation loss decreased (-0.867555 --> -0.916205).  Saving model ...
Epoch: 11 cost time: 0.9460608959197998
Epoch: 11, Steps: 17 | Train Loss: 0.932 Vali Loss: 0.909 Vali Acc: 0.922 Test Loss: 0.909 Test Acc: 0.922
Validation loss decreased (-0.916205 --> -0.921613).  Saving model ...
Epoch: 12 cost time: 0.8982875347137451
Epoch: 12, Steps: 17 | Train Loss: 0.770 Vali Loss: 0.753 Vali Acc: 0.938 Test Loss: 0.753 Test Acc: 0.938
Validation loss decreased (-0.921613 --> -0.937830).  Saving model ...
Epoch: 13 cost time: 0.8507571220397949
Epoch: 13, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.628 Vali Acc: 0.941 Test Loss: 0.628 Test Acc: 0.941
Validation loss decreased (-0.937830 --> -0.940534).  Saving model ...
Epoch: 14 cost time: 0.8844079971313477
Epoch: 14, Steps: 17 | Train Loss: 0.526 Vali Loss: 0.531 Vali Acc: 0.938 Test Loss: 0.531 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7659347057342529
Epoch: 15, Steps: 17 | Train Loss: 0.440 Vali Loss: 0.452 Vali Acc: 0.943 Test Loss: 0.452 Test Acc: 0.943
Validation loss decreased (-0.940534 --> -0.943239).  Saving model ...
Epoch: 16 cost time: 0.948164701461792
Epoch: 16, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.388 Vali Acc: 0.954 Test Loss: 0.388 Test Acc: 0.954
Validation loss decreased (-0.943239 --> -0.954050).  Saving model ...
Epoch: 17 cost time: 0.9937751293182373
Epoch: 17, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.345 Vali Acc: 0.951 Test Loss: 0.345 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1025011539459229
Epoch: 18, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.306 Vali Acc: 0.951 Test Loss: 0.306 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0621681213378906
Epoch: 19, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.272 Vali Acc: 0.954 Test Loss: 0.272 Test Acc: 0.954
Validation loss decreased (-0.954050 --> -0.954051).  Saving model ...
Epoch: 20 cost time: 1.1651616096496582
Epoch: 20, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.245 Vali Acc: 0.957 Test Loss: 0.245 Test Acc: 0.957
Validation loss decreased (-0.954051 --> -0.956754).  Saving model ...
Epoch: 21 cost time: 1.0807058811187744
Epoch: 21, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.224 Vali Acc: 0.957 Test Loss: 0.224 Test Acc: 0.957
Validation loss decreased (-0.956754 --> -0.956755).  Saving model ...
Epoch: 22 cost time: 1.1058366298675537
Epoch: 22, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
Validation loss decreased (-0.956755 --> -0.956755).  Saving model ...
Epoch: 23 cost time: 0.9260976314544678
Epoch: 23, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.956755 --> -0.959458).  Saving model ...
Epoch: 24 cost time: 0.8868069648742676
Epoch: 24, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.959458 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 0.9392285346984863
Epoch: 25, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.959458 --> -0.967566).  Saving model ...
Epoch: 26 cost time: 0.8270821571350098
Epoch: 26, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.143833875656128
Epoch: 27, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.124 Vali Acc: 0.962 Test Loss: 0.124 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1339850425720215
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.121 Vali Acc: 0.959 Test Loss: 0.121 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8527452945709229
Epoch: 29, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.118 Vali Acc: 0.962 Test Loss: 0.118 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0509400367736816
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.957 Test Loss: 0.114 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8591880798339844
Epoch: 31, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.957 Test Loss: 0.116 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9843523502349854
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1466715335845947
Epoch: 33, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.126 Vali Acc: 0.954 Test Loss: 0.126 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9645097255706787
Epoch: 34, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.954 Test Loss: 0.129 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.8397271633148193
Epoch: 35, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9675675675675676
model parameter : 5017
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.8696072101593018
Epoch: 1, Steps: 17 | Train Loss: 2.223 Vali Loss: 2.178 Vali Acc: 0.243 Test Loss: 2.178 Test Acc: 0.243
Validation loss decreased (inf --> -0.243221).  Saving model ...
Epoch: 2 cost time: 0.8690416812896729
Epoch: 2, Steps: 17 | Train Loss: 2.172 Vali Loss: 2.111 Vali Acc: 0.314 Test Loss: 2.111 Test Acc: 0.314
Validation loss decreased (-0.243221 --> -0.313492).  Saving model ...
Epoch: 3 cost time: 0.840552568435669
Epoch: 3, Steps: 17 | Train Loss: 2.094 Vali Loss: 2.024 Vali Acc: 0.446 Test Loss: 2.024 Test Acc: 0.446
Validation loss decreased (-0.313492 --> -0.445926).  Saving model ...
Epoch: 4 cost time: 0.798264741897583
Epoch: 4, Steps: 17 | Train Loss: 1.992 Vali Loss: 1.921 Vali Acc: 0.543 Test Loss: 1.921 Test Acc: 0.543
Validation loss decreased (-0.445926 --> -0.543224).  Saving model ...
Epoch: 5 cost time: 0.8011889457702637
Epoch: 5, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.795 Vali Acc: 0.646 Test Loss: 1.795 Test Acc: 0.646
Validation loss decreased (-0.543224 --> -0.645928).  Saving model ...
Epoch: 6 cost time: 0.791468620300293
Epoch: 6, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.645 Vali Acc: 0.765 Test Loss: 1.645 Test Acc: 0.765
Validation loss decreased (-0.645928 --> -0.764848).  Saving model ...
Epoch: 7 cost time: 0.9369401931762695
Epoch: 7, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.474 Vali Acc: 0.814 Test Loss: 1.474 Test Acc: 0.814
Validation loss decreased (-0.764848 --> -0.813499).  Saving model ...
Epoch: 8 cost time: 1.1104068756103516
Epoch: 8, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.283 Vali Acc: 0.868 Test Loss: 1.283 Test Acc: 0.868
Validation loss decreased (-0.813499 --> -0.867555).  Saving model ...
Epoch: 9 cost time: 0.7467014789581299
Epoch: 9, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.094 Vali Acc: 0.881 Test Loss: 1.094 Test Acc: 0.881
Validation loss decreased (-0.867555 --> -0.881070).  Saving model ...
Epoch: 10 cost time: 0.7849750518798828
Epoch: 10, Steps: 17 | Train Loss: 0.980 Vali Loss: 0.917 Vali Acc: 0.892 Test Loss: 0.917 Test Acc: 0.892
Validation loss decreased (-0.881070 --> -0.891883).  Saving model ...
Epoch: 11 cost time: 0.8751370906829834
Epoch: 11, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.774 Vali Acc: 0.916 Test Loss: 0.774 Test Acc: 0.916
Validation loss decreased (-0.891883 --> -0.916208).  Saving model ...
Epoch: 12 cost time: 0.9473774433135986
Epoch: 12, Steps: 17 | Train Loss: 0.677 Vali Loss: 0.650 Vali Acc: 0.930 Test Loss: 0.650 Test Acc: 0.930
Validation loss decreased (-0.916208 --> -0.929723).  Saving model ...
Epoch: 13 cost time: 0.9310934543609619
Epoch: 13, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.553 Vali Acc: 0.943 Test Loss: 0.553 Test Acc: 0.943
Validation loss decreased (-0.929723 --> -0.943238).  Saving model ...
Epoch: 14 cost time: 0.9615638256072998
Epoch: 14, Steps: 17 | Train Loss: 0.479 Vali Loss: 0.473 Vali Acc: 0.946 Test Loss: 0.473 Test Acc: 0.946
Validation loss decreased (-0.943238 --> -0.945941).  Saving model ...
Epoch: 15 cost time: 0.8742480278015137
Epoch: 15, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.416 Vali Acc: 0.946 Test Loss: 0.416 Test Acc: 0.946
Validation loss decreased (-0.945941 --> -0.945942).  Saving model ...
Epoch: 16 cost time: 0.9468753337860107
Epoch: 16, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.367 Vali Acc: 0.951 Test Loss: 0.367 Test Acc: 0.951
Validation loss decreased (-0.945942 --> -0.951348).  Saving model ...
Epoch: 17 cost time: 0.8792858123779297
Epoch: 17, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.327 Vali Acc: 0.949 Test Loss: 0.327 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9270288944244385
Epoch: 18, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.293 Vali Acc: 0.957 Test Loss: 0.293 Test Acc: 0.957
Validation loss decreased (-0.951348 --> -0.956754).  Saving model ...
Epoch: 19 cost time: 0.7772331237792969
Epoch: 19, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.269 Vali Acc: 0.959 Test Loss: 0.269 Test Acc: 0.959
Validation loss decreased (-0.956754 --> -0.959457).  Saving model ...
Epoch: 20 cost time: 0.8491263389587402
Epoch: 20, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0930149555206299
Epoch: 21, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.230 Vali Acc: 0.959 Test Loss: 0.230 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 22 cost time: 1.0846571922302246
Epoch: 22, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.207 Vali Acc: 0.959 Test Loss: 0.207 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959457).  Saving model ...
Epoch: 23 cost time: 1.1712055206298828
Epoch: 23, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.194 Vali Acc: 0.957 Test Loss: 0.194 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1875438690185547
Epoch: 24, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
Validation loss decreased (-0.959457 --> -0.959458).  Saving model ...
Epoch: 25 cost time: 0.8500628471374512
Epoch: 25, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.173 Vali Acc: 0.962 Test Loss: 0.173 Test Acc: 0.962
Validation loss decreased (-0.959458 --> -0.962160).  Saving model ...
Epoch: 26 cost time: 0.994403600692749
Epoch: 26, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.163 Vali Acc: 0.962 Test Loss: 0.163 Test Acc: 0.962
Validation loss decreased (-0.962160 --> -0.962161).  Saving model ...
Epoch: 27 cost time: 0.8679821491241455
Epoch: 27, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 28 cost time: 1.0574867725372314
Epoch: 28, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.962161 --> -0.962161).  Saving model ...
Epoch: 29 cost time: 0.8817343711853027
Epoch: 29, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.137 Vali Acc: 0.959 Test Loss: 0.137 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8029646873474121
Epoch: 30, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.959 Test Loss: 0.128 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9320979118347168
Epoch: 31, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.924475908279419
Epoch: 32, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.957 Test Loss: 0.123 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7637701034545898
Epoch: 33, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.125 Vali Acc: 0.957 Test Loss: 0.125 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0435137748718262
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.954 Test Loss: 0.128 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9892103672027588
Epoch: 35, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.133 Vali Acc: 0.951 Test Loss: 0.133 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0016989707946777
Epoch: 36, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.946 Test Loss: 0.137 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9302945137023926
Epoch: 37, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.949 Test Loss: 0.141 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9682643413543701
Epoch: 38, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.946 Test Loss: 0.145 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4949
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.604128360748291
Epoch: 1, Steps: 17 | Train Loss: 2.238 Vali Loss: 2.206 Vali Acc: 0.119 Test Loss: 2.206 Test Acc: 0.119
Validation loss decreased (inf --> -0.118897).  Saving model ...
Epoch: 2 cost time: 0.922337532043457
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.118 Vali Acc: 0.176 Test Loss: 2.118 Test Acc: 0.176
Validation loss decreased (-0.118897 --> -0.175654).  Saving model ...
Epoch: 3 cost time: 0.9834494590759277
Epoch: 3, Steps: 17 | Train Loss: 2.061 Vali Loss: 2.011 Vali Acc: 0.295 Test Loss: 2.011 Test Acc: 0.295
Validation loss decreased (-0.175654 --> -0.294574).  Saving model ...
Epoch: 4 cost time: 1.1184828281402588
Epoch: 4, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.889 Vali Acc: 0.495 Test Loss: 1.889 Test Acc: 0.495
Validation loss decreased (-0.294574 --> -0.494576).  Saving model ...
Epoch: 5 cost time: 1.1569304466247559
Epoch: 5, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.754 Vali Acc: 0.665 Test Loss: 1.754 Test Acc: 0.665
Validation loss decreased (-0.494576 --> -0.664847).  Saving model ...
Epoch: 6 cost time: 1.0907869338989258
Epoch: 6, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.597 Vali Acc: 0.784 Test Loss: 1.597 Test Acc: 0.784
Validation loss decreased (-0.664847 --> -0.783768).  Saving model ...
Epoch: 7 cost time: 1.0747087001800537
Epoch: 7, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.422 Vali Acc: 0.849 Test Loss: 1.422 Test Acc: 0.849
Validation loss decreased (-0.783768 --> -0.848634).  Saving model ...
Epoch: 8 cost time: 1.1015233993530273
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.237 Vali Acc: 0.851 Test Loss: 1.237 Test Acc: 0.851
Validation loss decreased (-0.848634 --> -0.851339).  Saving model ...
Epoch: 9 cost time: 0.8312485218048096
Epoch: 9, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.053 Vali Acc: 0.878 Test Loss: 1.053 Test Acc: 0.878
Validation loss decreased (-0.851339 --> -0.878368).  Saving model ...
Epoch: 10 cost time: 0.8412306308746338
Epoch: 10, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.879 Vali Acc: 0.914 Test Loss: 0.879 Test Acc: 0.914
Validation loss decreased (-0.878368 --> -0.913505).  Saving model ...
Epoch: 11 cost time: 0.8636531829833984
Epoch: 11, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.726 Vali Acc: 0.927 Test Loss: 0.726 Test Acc: 0.927
Validation loss decreased (-0.913505 --> -0.927020).  Saving model ...
Epoch: 12 cost time: 1.045278549194336
Epoch: 12, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.603 Vali Acc: 0.941 Test Loss: 0.603 Test Acc: 0.941
Validation loss decreased (-0.927020 --> -0.940535).  Saving model ...
Epoch: 13 cost time: 1.1418273448944092
Epoch: 13, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.509 Vali Acc: 0.935 Test Loss: 0.509 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.051865577697754
Epoch: 14, Steps: 17 | Train Loss: 0.432 Vali Loss: 0.423 Vali Acc: 0.946 Test Loss: 0.423 Test Acc: 0.946
Validation loss decreased (-0.940535 --> -0.945942).  Saving model ...
Epoch: 15 cost time: 0.8996553421020508
Epoch: 15, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.355 Vali Acc: 0.959 Test Loss: 0.355 Test Acc: 0.959
Validation loss decreased (-0.945942 --> -0.959456).  Saving model ...
Epoch: 16 cost time: 1.2125494480133057
Epoch: 16, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.296 Vali Acc: 0.962 Test Loss: 0.296 Test Acc: 0.962
Validation loss decreased (-0.959456 --> -0.962159).  Saving model ...
Epoch: 17 cost time: 0.9292171001434326
Epoch: 17, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.248 Vali Acc: 0.959 Test Loss: 0.248 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.938025951385498
Epoch: 18, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.219 Vali Acc: 0.957 Test Loss: 0.219 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9303603172302246
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.182 Vali Acc: 0.957 Test Loss: 0.182 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0616168975830078
Epoch: 20, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.161 Vali Acc: 0.951 Test Loss: 0.161 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8477315902709961
Epoch: 21, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.145 Vali Acc: 0.954 Test Loss: 0.145 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.887974739074707
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.138 Vali Acc: 0.949 Test Loss: 0.138 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8194446563720703
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.138 Vali Acc: 0.954 Test Loss: 0.138 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9920949935913086
Epoch: 24, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.124 Vali Acc: 0.951 Test Loss: 0.124 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8446328639984131
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.134 Vali Acc: 0.951 Test Loss: 0.134 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0572822093963623
Epoch: 26, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.138 Vali Acc: 0.951 Test Loss: 0.138 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9621621621621622
model parameter : 4959
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.6561713218688965
Epoch: 1, Steps: 17 | Train Loss: 2.214 Vali Loss: 2.196 Vali Acc: 0.116 Test Loss: 2.196 Test Acc: 0.116
Validation loss decreased (inf --> -0.116194).  Saving model ...
Epoch: 2 cost time: 1.1021153926849365
Epoch: 2, Steps: 17 | Train Loss: 2.143 Vali Loss: 2.106 Vali Acc: 0.189 Test Loss: 2.106 Test Acc: 0.189
Validation loss decreased (-0.116194 --> -0.189168).  Saving model ...
Epoch: 3 cost time: 0.8580639362335205
Epoch: 3, Steps: 17 | Train Loss: 2.040 Vali Loss: 2.001 Vali Acc: 0.286 Test Loss: 2.001 Test Acc: 0.286
Validation loss decreased (-0.189168 --> -0.286466).  Saving model ...
Epoch: 4 cost time: 0.8412866592407227
Epoch: 4, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.870 Vali Acc: 0.508 Test Loss: 1.870 Test Acc: 0.508
Validation loss decreased (-0.286466 --> -0.508089).  Saving model ...
Epoch: 5 cost time: 0.8755412101745605
Epoch: 5, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.724 Vali Acc: 0.689 Test Loss: 1.724 Test Acc: 0.689
Validation loss decreased (-0.508089 --> -0.689172).  Saving model ...
Epoch: 6 cost time: 1.0813090801239014
Epoch: 6, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.561 Vali Acc: 0.778 Test Loss: 1.561 Test Acc: 0.778
Validation loss decreased (-0.689172 --> -0.778363).  Saving model ...
Epoch: 7 cost time: 0.8740189075469971
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.382 Vali Acc: 0.841 Test Loss: 1.382 Test Acc: 0.841
Validation loss decreased (-0.778363 --> -0.840527).  Saving model ...
Epoch: 8 cost time: 1.1689457893371582
Epoch: 8, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.195 Vali Acc: 0.862 Test Loss: 1.195 Test Acc: 0.862
Validation loss decreased (-0.840527 --> -0.862150).  Saving model ...
Epoch: 9 cost time: 1.0254945755004883
Epoch: 9, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.009 Vali Acc: 0.881 Test Loss: 1.009 Test Acc: 0.881
Validation loss decreased (-0.862150 --> -0.881071).  Saving model ...
Epoch: 10 cost time: 0.8058650493621826
Epoch: 10, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.834 Vali Acc: 0.892 Test Loss: 0.834 Test Acc: 0.892
Validation loss decreased (-0.881071 --> -0.891884).  Saving model ...
Epoch: 11 cost time: 0.9511768817901611
Epoch: 11, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.691 Vali Acc: 0.927 Test Loss: 0.691 Test Acc: 0.927
Validation loss decreased (-0.891884 --> -0.927020).  Saving model ...
Epoch: 12 cost time: 0.9717810153961182
Epoch: 12, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.568 Vali Acc: 0.935 Test Loss: 0.568 Test Acc: 0.935
Validation loss decreased (-0.927020 --> -0.935129).  Saving model ...
Epoch: 13 cost time: 1.0415980815887451
Epoch: 13, Steps: 17 | Train Loss: 0.468 Vali Loss: 0.461 Vali Acc: 0.935 Test Loss: 0.461 Test Acc: 0.935
Validation loss decreased (-0.935129 --> -0.935131).  Saving model ...
Epoch: 14 cost time: 1.0799317359924316
Epoch: 14, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.371 Vali Acc: 0.943 Test Loss: 0.371 Test Acc: 0.943
Validation loss decreased (-0.935131 --> -0.943240).  Saving model ...
Epoch: 15 cost time: 0.8895070552825928
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.297 Vali Acc: 0.946 Test Loss: 0.297 Test Acc: 0.946
Validation loss decreased (-0.943240 --> -0.945943).  Saving model ...
Epoch: 16 cost time: 0.8970181941986084
Epoch: 16, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0021541118621826
Epoch: 17, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.201 Vali Acc: 0.946 Test Loss: 0.201 Test Acc: 0.946
Validation loss decreased (-0.945943 --> -0.945944).  Saving model ...
Epoch: 18 cost time: 1.0501282215118408
Epoch: 18, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.190 Vali Acc: 0.938 Test Loss: 0.190 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8083391189575195
Epoch: 19, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.173 Vali Acc: 0.946 Test Loss: 0.173 Test Acc: 0.946
Validation loss decreased (-0.945944 --> -0.945944).  Saving model ...
Epoch: 20 cost time: 0.8151051998138428
Epoch: 20, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8659160137176514
Epoch: 21, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.949 Test Loss: 0.159 Test Acc: 0.949
Validation loss decreased (-0.945944 --> -0.948647).  Saving model ...
Epoch: 22 cost time: 0.8931457996368408
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.168 Vali Acc: 0.946 Test Loss: 0.168 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8006241321563721
Epoch: 23, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8762772083282471
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.169 Vali Acc: 0.951 Test Loss: 0.169 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 25 cost time: 0.829228401184082
Epoch: 25, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.949 Test Loss: 0.178 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7536816596984863
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0105259418487549
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.935 Test Loss: 0.190 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.745589017868042
Epoch: 28, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8857309818267822
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.935 Test Loss: 0.206 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9654252529144287
Epoch: 30, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8933775424957275
Epoch: 31, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.943 Test Loss: 0.205 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9126510620117188
Epoch: 32, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.220 Vali Acc: 0.938 Test Loss: 0.220 Test Acc: 0.938
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8504929542541504
Epoch: 33, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.943 Test Loss: 0.215 Test Acc: 0.943
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7932741641998291
Epoch: 34, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.943 Test Loss: 0.229 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9513513513513514
model parameter : 5065
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.293548822402954
Epoch: 1, Steps: 17 | Train Loss: 2.225 Vali Loss: 2.214 Vali Acc: 0.051 Test Loss: 2.214 Test Acc: 0.051
Validation loss decreased (inf --> -0.051329).  Saving model ...
Epoch: 2 cost time: 0.6910820007324219
Epoch: 2, Steps: 17 | Train Loss: 2.165 Vali Loss: 2.141 Vali Acc: 0.095 Test Loss: 2.141 Test Acc: 0.095
Validation loss decreased (-0.051329 --> -0.094573).  Saving model ...
Epoch: 3 cost time: 0.844243049621582
Epoch: 3, Steps: 17 | Train Loss: 2.077 Vali Loss: 2.055 Vali Acc: 0.241 Test Loss: 2.055 Test Acc: 0.241
Validation loss decreased (-0.094573 --> -0.240520).  Saving model ...
Epoch: 4 cost time: 0.8139081001281738
Epoch: 4, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.950 Vali Acc: 0.478 Test Loss: 1.950 Test Acc: 0.478
Validation loss decreased (-0.240520 --> -0.478359).  Saving model ...
Epoch: 5 cost time: 0.838972806930542
Epoch: 5, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.825 Vali Acc: 0.611 Test Loss: 1.825 Test Acc: 0.611
Validation loss decreased (-0.478359 --> -0.610793).  Saving model ...
Epoch: 6 cost time: 1.1733911037445068
Epoch: 6, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.672 Vali Acc: 0.686 Test Loss: 1.672 Test Acc: 0.686
Validation loss decreased (-0.610793 --> -0.686470).  Saving model ...
Epoch: 7 cost time: 0.8371858596801758
Epoch: 7, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.494 Vali Acc: 0.768 Test Loss: 1.494 Test Acc: 0.768
Validation loss decreased (-0.686470 --> -0.767553).  Saving model ...
Epoch: 8 cost time: 0.872347354888916
Epoch: 8, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.288 Vali Acc: 0.854 Test Loss: 1.288 Test Acc: 0.854
Validation loss decreased (-0.767553 --> -0.854041).  Saving model ...
Epoch: 9 cost time: 0.7664585113525391
Epoch: 9, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.083 Vali Acc: 0.876 Test Loss: 1.083 Test Acc: 0.876
Validation loss decreased (-0.854041 --> -0.875665).  Saving model ...
Epoch: 10 cost time: 1.0875318050384521
Epoch: 10, Steps: 17 | Train Loss: 0.913 Vali Loss: 0.886 Vali Acc: 0.905 Test Loss: 0.886 Test Acc: 0.905
Validation loss decreased (-0.875665 --> -0.905397).  Saving model ...
Epoch: 11 cost time: 0.8011035919189453
Epoch: 11, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.722 Vali Acc: 0.905 Test Loss: 0.722 Test Acc: 0.905
Validation loss decreased (-0.905397 --> -0.905398).  Saving model ...
Epoch: 12 cost time: 0.8355991840362549
Epoch: 12, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.571 Vali Acc: 0.924 Test Loss: 0.571 Test Acc: 0.924
Validation loss decreased (-0.905398 --> -0.924319).  Saving model ...
Epoch: 13 cost time: 0.9232602119445801
Epoch: 13, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.454 Vali Acc: 0.935 Test Loss: 0.454 Test Acc: 0.935
Validation loss decreased (-0.924319 --> -0.935131).  Saving model ...
Epoch: 14 cost time: 0.7918241024017334
Epoch: 14, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.362 Vali Acc: 0.938 Test Loss: 0.362 Test Acc: 0.938
Validation loss decreased (-0.935131 --> -0.937834).  Saving model ...
Epoch: 15 cost time: 0.7616040706634521
Epoch: 15, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.937834 --> -0.940538).  Saving model ...
Epoch: 16 cost time: 0.703538179397583
Epoch: 16, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.252 Vali Acc: 0.932 Test Loss: 0.252 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7742879390716553
Epoch: 17, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940538).  Saving model ...
Epoch: 18 cost time: 0.9740557670593262
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940538 --> -0.940539).  Saving model ...
Epoch: 19 cost time: 0.9046237468719482
Epoch: 19, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.177 Vali Acc: 0.949 Test Loss: 0.177 Test Acc: 0.949
Validation loss decreased (-0.940539 --> -0.948647).  Saving model ...
Epoch: 20 cost time: 0.9557440280914307
Epoch: 20, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.168 Vali Acc: 0.951 Test Loss: 0.168 Test Acc: 0.951
Validation loss decreased (-0.948647 --> -0.951350).  Saving model ...
Epoch: 21 cost time: 0.8020052909851074
Epoch: 21, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.157 Vali Acc: 0.954 Test Loss: 0.157 Test Acc: 0.954
Validation loss decreased (-0.951350 --> -0.954052).  Saving model ...
Epoch: 22 cost time: 0.7362010478973389
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.159 Vali Acc: 0.954 Test Loss: 0.159 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.792726993560791
Epoch: 23, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9358181953430176
Epoch: 24, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7615764141082764
Epoch: 25, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.155 Vali Acc: 0.954 Test Loss: 0.155 Test Acc: 0.954
Validation loss decreased (-0.954052 --> -0.954053).  Saving model ...
Epoch: 26 cost time: 0.873976469039917
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.155 Vali Acc: 0.951 Test Loss: 0.155 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8724105358123779
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.167 Vali Acc: 0.949 Test Loss: 0.167 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1794805526733398
Epoch: 28, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.157 Vali Acc: 0.951 Test Loss: 0.157 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7831337451934814
Epoch: 29, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0860884189605713
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8587801456451416
Epoch: 31, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1685242652893066
Epoch: 32, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.949 Test Loss: 0.169 Test Acc: 0.949
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1868102550506592
Epoch: 33, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.172 Vali Acc: 0.946 Test Loss: 0.172 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0805821418762207
Epoch: 34, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.946 Test Loss: 0.169 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9351067543029785
Epoch: 35, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.935 Test Loss: 0.201 Test Acc: 0.935
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9540540540540541
model parameter : 5071
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_JapaneseVowels  Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/JapaneseVowels/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             12                  Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

270
370
>>>>>>>start training : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
270
370
370
Epoch: 1 cost time: 2.5230352878570557
Epoch: 1, Steps: 17 | Train Loss: 2.227 Vali Loss: 2.176 Vali Acc: 0.135 Test Loss: 2.176 Test Acc: 0.135
Validation loss decreased (inf --> -0.135113).  Saving model ...
Epoch: 2 cost time: 1.0522589683532715
Epoch: 2, Steps: 17 | Train Loss: 2.154 Vali Loss: 2.084 Vali Acc: 0.208 Test Loss: 2.084 Test Acc: 0.208
Validation loss decreased (-0.135113 --> -0.208087).  Saving model ...
Epoch: 3 cost time: 1.141432762145996
Epoch: 3, Steps: 17 | Train Loss: 2.043 Vali Loss: 1.968 Vali Acc: 0.376 Test Loss: 1.968 Test Acc: 0.376
Validation loss decreased (-0.208087 --> -0.375656).  Saving model ...
Epoch: 4 cost time: 0.9337506294250488
Epoch: 4, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.834 Vali Acc: 0.543 Test Loss: 1.834 Test Acc: 0.543
Validation loss decreased (-0.375656 --> -0.543225).  Saving model ...
Epoch: 5 cost time: 0.9730095863342285
Epoch: 5, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.677 Vali Acc: 0.681 Test Loss: 1.677 Test Acc: 0.681
Validation loss decreased (-0.543225 --> -0.681064).  Saving model ...
Epoch: 6 cost time: 1.0898489952087402
Epoch: 6, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.511 Vali Acc: 0.776 Test Loss: 1.511 Test Acc: 0.776
Validation loss decreased (-0.681064 --> -0.775661).  Saving model ...
Epoch: 7 cost time: 1.011303424835205
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.333 Vali Acc: 0.832 Test Loss: 1.333 Test Acc: 0.832
Validation loss decreased (-0.775661 --> -0.832419).  Saving model ...
Epoch: 8 cost time: 1.039396047592163
Epoch: 8, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.146 Vali Acc: 0.873 Test Loss: 1.146 Test Acc: 0.873
Validation loss decreased (-0.832419 --> -0.872962).  Saving model ...
Epoch: 9 cost time: 1.1099376678466797
Epoch: 9, Steps: 17 | Train Loss: 1.024 Vali Loss: 0.975 Vali Acc: 0.908 Test Loss: 0.975 Test Acc: 0.908
Validation loss decreased (-0.872962 --> -0.908098).  Saving model ...
Epoch: 10 cost time: 0.8578565120697021
Epoch: 10, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.818 Vali Acc: 0.919 Test Loss: 0.818 Test Acc: 0.919
Validation loss decreased (-0.908098 --> -0.918911).  Saving model ...
Epoch: 11 cost time: 0.9571597576141357
Epoch: 11, Steps: 17 | Train Loss: 0.711 Vali Loss: 0.686 Vali Acc: 0.938 Test Loss: 0.686 Test Acc: 0.938
Validation loss decreased (-0.918911 --> -0.937831).  Saving model ...
Epoch: 12 cost time: 0.9761145114898682
Epoch: 12, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.576 Vali Acc: 0.943 Test Loss: 0.576 Test Acc: 0.943
Validation loss decreased (-0.937831 --> -0.943237).  Saving model ...
Epoch: 13 cost time: 1.056339979171753
Epoch: 13, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.495 Vali Acc: 0.946 Test Loss: 0.495 Test Acc: 0.946
Validation loss decreased (-0.943237 --> -0.945941).  Saving model ...
Epoch: 14 cost time: 0.8849053382873535
Epoch: 14, Steps: 17 | Train Loss: 0.423 Vali Loss: 0.426 Vali Acc: 0.949 Test Loss: 0.426 Test Acc: 0.949
Validation loss decreased (-0.945941 --> -0.948644).  Saving model ...
Epoch: 15 cost time: 0.9392642974853516
Epoch: 15, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.371 Vali Acc: 0.954 Test Loss: 0.371 Test Acc: 0.954
Validation loss decreased (-0.948644 --> -0.954050).  Saving model ...
Epoch: 16 cost time: 0.9500541687011719
Epoch: 16, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.328 Vali Acc: 0.959 Test Loss: 0.328 Test Acc: 0.959
Validation loss decreased (-0.954050 --> -0.959456).  Saving model ...
Epoch: 17 cost time: 0.998150110244751
Epoch: 17, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.289 Vali Acc: 0.962 Test Loss: 0.289 Test Acc: 0.962
Validation loss decreased (-0.959456 --> -0.962159).  Saving model ...
Epoch: 18 cost time: 0.9085557460784912
Epoch: 18, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.257 Vali Acc: 0.965 Test Loss: 0.257 Test Acc: 0.965
Validation loss decreased (-0.962159 --> -0.964862).  Saving model ...
Epoch: 19 cost time: 1.0479674339294434
Epoch: 19, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.234 Vali Acc: 0.965 Test Loss: 0.234 Test Acc: 0.965
Validation loss decreased (-0.964862 --> -0.964863).  Saving model ...
Epoch: 20 cost time: 1.210620403289795
Epoch: 20, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1051733493804932
Epoch: 21, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.188 Vali Acc: 0.965 Test Loss: 0.188 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 22 cost time: 0.996030330657959
Epoch: 22, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9440419673919678
Epoch: 23, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 24 cost time: 1.208707332611084
Epoch: 24, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964863).  Saving model ...
Epoch: 25 cost time: 0.8233034610748291
Epoch: 25, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.132 Vali Acc: 0.957 Test Loss: 0.132 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9772734642028809
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.964863 --> -0.964864).  Saving model ...
Epoch: 27 cost time: 0.8015751838684082
Epoch: 27, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.119 Vali Acc: 0.965 Test Loss: 0.119 Test Acc: 0.965
Validation loss decreased (-0.964864 --> -0.964864).  Saving model ...
Epoch: 28 cost time: 1.1385655403137207
Epoch: 28, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.129 Vali Acc: 0.962 Test Loss: 0.129 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1189661026000977
Epoch: 29, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0487382411956787
Epoch: 30, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.951 Test Loss: 0.132 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.1585900783538818
Epoch: 31, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.126 Vali Acc: 0.959 Test Loss: 0.126 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9661087989807129
Epoch: 32, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.957 Test Loss: 0.137 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.283756971359253
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.153 Vali Acc: 0.951 Test Loss: 0.153 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.962801456451416
Epoch: 34, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0424461364746094
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1650538444519043
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.946 Test Loss: 0.166 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9276139736175537
Epoch: 37, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.957 Test Loss: 0.185 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_JapaneseVowels_LightTS_UEA_ftM_sl29_ll0_pl0_dm32_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
370
test shape: torch.Size([370, 9]) torch.Size([370, 1])
accuracy:0.9648648648648649
model parameter : 5325
model size : 0.03MB
