Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1414995193481445
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.409 Vali Acc: 0.316 Test Loss: 1.409 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 0.5619800090789795
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.387 Vali Acc: 0.276 Test Loss: 1.387 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6031267642974854
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.364 Vali Acc: 0.342 Test Loss: 1.364 Test Acc: 0.342
Validation loss decreased (-0.315775 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.6855511665344238
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.341 Vali Acc: 0.362 Test Loss: 1.341 Test Acc: 0.362
Validation loss decreased (-0.342092 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 0.5812137126922607
Epoch: 5, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.312 Vali Acc: 0.395 Test Loss: 1.312 Test Acc: 0.395
Validation loss decreased (-0.361829 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 0.6648159027099609
Epoch: 6, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.267 Vali Acc: 0.421 Test Loss: 1.267 Test Acc: 0.421
Validation loss decreased (-0.394724 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 0.6194136142730713
Epoch: 7, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.217 Vali Acc: 0.487 Test Loss: 1.217 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 0.6471273899078369
Epoch: 8, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.160 Vali Acc: 0.513 Test Loss: 1.160 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 0.6359620094299316
Epoch: 9, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.077 Vali Acc: 0.559 Test Loss: 1.077 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559200).  Saving model ...
Epoch: 10 cost time: 0.6104714870452881
Epoch: 10, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.987 Vali Acc: 0.599 Test Loss: 0.987 Test Acc: 0.599
Validation loss decreased (-0.559200 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 0.697145938873291
Epoch: 11, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.901 Vali Acc: 0.605 Test Loss: 0.901 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 12 cost time: 0.7622909545898438
Epoch: 12, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.841 Vali Acc: 0.625 Test Loss: 0.841 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624992).  Saving model ...
Epoch: 13 cost time: 0.7459259033203125
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.795 Vali Acc: 0.645 Test Loss: 0.795 Test Acc: 0.645
Validation loss decreased (-0.624992 --> -0.644729).  Saving model ...
Epoch: 14 cost time: 0.6533670425415039
Epoch: 14, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.728 Vali Acc: 0.684 Test Loss: 0.728 Test Acc: 0.684
Validation loss decreased (-0.644729 --> -0.684203).  Saving model ...
Epoch: 15 cost time: 0.6777429580688477
Epoch: 15, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.733 Vali Acc: 0.691 Test Loss: 0.733 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 16 cost time: 0.8328607082366943
Epoch: 16, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.681 Vali Acc: 0.724 Test Loss: 0.681 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 0.7324631214141846
Epoch: 17, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.734 Vali Acc: 0.704 Test Loss: 0.734 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5622632503509521
Epoch: 18, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.750 Vali Acc: 0.704 Test Loss: 0.750 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7315473556518555
Epoch: 19, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.722 Vali Acc: 0.743 Test Loss: 0.722 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 0.624237060546875
Epoch: 20, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.812 Vali Acc: 0.724 Test Loss: 0.812 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6864886283874512
Epoch: 21, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.791 Vali Acc: 0.743 Test Loss: 0.791 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6446917057037354
Epoch: 22, Steps: 10 | Train Loss: 0.099 Vali Loss: 1.006 Vali Acc: 0.737 Test Loss: 1.006 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.555199384689331
Epoch: 23, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.813 Vali Acc: 0.737 Test Loss: 0.813 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7176730632781982
Epoch: 24, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.986 Vali Acc: 0.730 Test Loss: 0.986 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6664280891418457
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.951 Vali Acc: 0.743 Test Loss: 0.951 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5829453468322754
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.049 Vali Acc: 0.737 Test Loss: 1.049 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7010743618011475
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.095 Vali Acc: 0.743 Test Loss: 1.095 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6139955520629883
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.132 Vali Acc: 0.750 Test Loss: 1.132 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749989).  Saving model ...
Epoch: 29 cost time: 0.658247709274292
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.201 Vali Acc: 0.737 Test Loss: 1.201 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5701065063476562
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.231 Vali Acc: 0.743 Test Loss: 1.231 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7407546043395996
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.279 Vali Acc: 0.743 Test Loss: 1.279 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.744938850402832
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.339 Vali Acc: 0.757 Test Loss: 1.339 Test Acc: 0.757
Validation loss decreased (-0.749989 --> -0.756566).  Saving model ...
Epoch: 33 cost time: 0.617913007736206
Epoch: 33, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.357 Vali Acc: 0.750 Test Loss: 1.357 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.665673017501831
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.399 Vali Acc: 0.757 Test Loss: 1.399 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6559102535247803
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.417 Vali Acc: 0.757 Test Loss: 1.417 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7159619331359863
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.467 Vali Acc: 0.763 Test Loss: 1.467 Test Acc: 0.763
Validation loss decreased (-0.756566 --> -0.763143).  Saving model ...
Epoch: 37 cost time: 0.6273481845855713
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.491 Vali Acc: 0.750 Test Loss: 1.491 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6483101844787598
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.521 Vali Acc: 0.763 Test Loss: 1.521 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7023932933807373
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.546 Vali Acc: 0.750 Test Loss: 1.546 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6507408618927002
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.588 Vali Acc: 0.763 Test Loss: 1.588 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6277973651885986
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.599 Vali Acc: 0.763 Test Loss: 1.599 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.4774913787841797
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.614 Vali Acc: 0.763 Test Loss: 1.614 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5440065860748291
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.638 Vali Acc: 0.763 Test Loss: 1.638 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6983225345611572
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.668 Vali Acc: 0.763 Test Loss: 1.668 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5767123699188232
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.686 Vali Acc: 0.763 Test Loss: 1.686 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7961704730987549
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.702 Vali Acc: 0.763 Test Loss: 1.702 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 106704
model size : 0.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0944206714630127
Epoch: 1, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.402 Vali Acc: 0.276 Test Loss: 1.402 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 0.5679669380187988
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.386 Vali Acc: 0.289 Test Loss: 1.386 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.8179070949554443
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.368 Vali Acc: 0.309 Test Loss: 1.368 Test Acc: 0.309
Validation loss decreased (-0.289460 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.6271212100982666
Epoch: 4, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.347 Vali Acc: 0.342 Test Loss: 1.347 Test Acc: 0.342
Validation loss decreased (-0.309197 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 0.565178632736206
Epoch: 5, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.322 Vali Acc: 0.375 Test Loss: 1.322 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.618549108505249
Epoch: 6, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.292 Vali Acc: 0.395 Test Loss: 1.292 Test Acc: 0.395
Validation loss decreased (-0.374987 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 0.8729555606842041
Epoch: 7, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.258 Vali Acc: 0.447 Test Loss: 1.258 Test Acc: 0.447
Validation loss decreased (-0.394724 --> -0.447356).  Saving model ...
Epoch: 8 cost time: 0.6610543727874756
Epoch: 8, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.219 Vali Acc: 0.546 Test Loss: 1.219 Test Acc: 0.546
Validation loss decreased (-0.447356 --> -0.546040).  Saving model ...
Epoch: 9 cost time: 0.6611435413360596
Epoch: 9, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.165 Vali Acc: 0.572 Test Loss: 1.165 Test Acc: 0.572
Validation loss decreased (-0.546040 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 0.635594367980957
Epoch: 10, Steps: 10 | Train Loss: 1.006 Vali Loss: 1.106 Vali Acc: 0.599 Test Loss: 1.106 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 11 cost time: 0.734616756439209
Epoch: 11, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.012 Vali Acc: 0.625 Test Loss: 1.012 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624990).  Saving model ...
Epoch: 12 cost time: 0.7125658988952637
Epoch: 12, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.923 Vali Acc: 0.658 Test Loss: 0.923 Test Acc: 0.658
Validation loss decreased (-0.624990 --> -0.657886).  Saving model ...
Epoch: 13 cost time: 0.5565662384033203
Epoch: 13, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.833 Vali Acc: 0.664 Test Loss: 0.833 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 0.7329373359680176
Epoch: 14, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.769 Vali Acc: 0.684 Test Loss: 0.769 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 15 cost time: 0.6886012554168701
Epoch: 15, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.744 Vali Acc: 0.697 Test Loss: 0.744 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 0.7792491912841797
Epoch: 16, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.701 Vali Acc: 0.704 Test Loss: 0.701 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 0.6796772480010986
Epoch: 17, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.678 Vali Acc: 0.724 Test Loss: 0.678 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.8219804763793945
Epoch: 18, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 0.8887250423431396
Epoch: 19, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 20 cost time: 0.6435239315032959
Epoch: 20, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 21 cost time: 0.9159350395202637
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 0.714118480682373
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6467423439025879
Epoch: 23, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.703 Vali Acc: 0.770 Test Loss: 0.703 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6254942417144775
Epoch: 24, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7174322605133057
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7113549709320068
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.801 Vali Acc: 0.763 Test Loss: 0.801 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5721981525421143
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.791 Vali Acc: 0.809 Test Loss: 0.791 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809203).  Saving model ...
Epoch: 28 cost time: 0.5945398807525635
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.812 Vali Acc: 0.789 Test Loss: 0.812 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8425185680389404
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.585817813873291
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.879 Vali Acc: 0.776 Test Loss: 0.879 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6747033596038818
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.912 Vali Acc: 0.783 Test Loss: 0.912 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6997301578521729
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.936 Vali Acc: 0.789 Test Loss: 0.936 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6364662647247314
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.966 Vali Acc: 0.783 Test Loss: 0.966 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6366167068481445
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.002 Vali Acc: 0.783 Test Loss: 1.002 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5659763813018799
Epoch: 35, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.032 Vali Acc: 0.789 Test Loss: 1.032 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.5559439659118652
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.047 Vali Acc: 0.783 Test Loss: 1.047 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6420340538024902
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.076 Vali Acc: 0.783 Test Loss: 1.076 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 105438
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.119382858276367
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.401 Vali Acc: 0.250 Test Loss: 1.401 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 0.7113037109375
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.388 Vali Acc: 0.283 Test Loss: 1.388 Test Acc: 0.283
Validation loss decreased (-0.249986 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 0.9458897113800049
Epoch: 3, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.372 Vali Acc: 0.336 Test Loss: 1.372 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 0.825169563293457
Epoch: 4, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.350 Vali Acc: 0.349 Test Loss: 1.350 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.9721145629882812
Epoch: 5, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.325 Vali Acc: 0.382 Test Loss: 1.325 Test Acc: 0.382
Validation loss decreased (-0.348671 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 0.6620504856109619
Epoch: 6, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.290 Vali Acc: 0.434 Test Loss: 1.290 Test Acc: 0.434
Validation loss decreased (-0.381566 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 0.6913559436798096
Epoch: 7, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.253 Vali Acc: 0.428 Test Loss: 1.253 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6068711280822754
Epoch: 8, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.205 Vali Acc: 0.480 Test Loss: 1.205 Test Acc: 0.480
Validation loss decreased (-0.434198 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 0.6673016548156738
Epoch: 9, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.143 Vali Acc: 0.546 Test Loss: 1.143 Test Acc: 0.546
Validation loss decreased (-0.480251 --> -0.546041).  Saving model ...
Epoch: 10 cost time: 0.6945352554321289
Epoch: 10, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.048 Vali Acc: 0.586 Test Loss: 1.048 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 11 cost time: 0.7301740646362305
Epoch: 11, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.946 Vali Acc: 0.579 Test Loss: 0.946 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7624127864837646
Epoch: 12, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.858 Vali Acc: 0.579 Test Loss: 0.858 Test Acc: 0.579
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.787412166595459
Epoch: 13, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.808 Vali Acc: 0.605 Test Loss: 0.808 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605255).  Saving model ...
Epoch: 14 cost time: 0.6657209396362305
Epoch: 14, Steps: 10 | Train Loss: 0.539 Vali Loss: 0.775 Vali Acc: 0.638 Test Loss: 0.775 Test Acc: 0.638
Validation loss decreased (-0.605255 --> -0.638150).  Saving model ...
Epoch: 15 cost time: 0.8331308364868164
Epoch: 15, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.757 Vali Acc: 0.664 Test Loss: 0.757 Test Acc: 0.664
Validation loss decreased (-0.638150 --> -0.664466).  Saving model ...
Epoch: 16 cost time: 0.6556534767150879
Epoch: 16, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.763 Vali Acc: 0.645 Test Loss: 0.763 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8099162578582764
Epoch: 17, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.746 Vali Acc: 0.697 Test Loss: 0.746 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 0.9806404113769531
Epoch: 18, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.743 Vali Acc: 0.671 Test Loss: 0.743 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6514754295349121
Epoch: 19, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.751 Vali Acc: 0.711 Test Loss: 0.751 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 20 cost time: 0.6586182117462158
Epoch: 20, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.755 Vali Acc: 0.697 Test Loss: 0.755 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7130184173583984
Epoch: 21, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.769 Vali Acc: 0.704 Test Loss: 0.769 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.830650806427002
Epoch: 22, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.811 Vali Acc: 0.717 Test Loss: 0.811 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717097).  Saving model ...
Epoch: 23 cost time: 0.7327797412872314
Epoch: 23, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.817 Vali Acc: 0.697 Test Loss: 0.817 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8986382484436035
Epoch: 24, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.803 Vali Acc: 0.697 Test Loss: 0.803 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7703638076782227
Epoch: 25, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.836 Vali Acc: 0.697 Test Loss: 0.836 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7310919761657715
Epoch: 26, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.874 Vali Acc: 0.730 Test Loss: 0.874 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730254).  Saving model ...
Epoch: 27 cost time: 0.8105723857879639
Epoch: 27, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.918 Vali Acc: 0.711 Test Loss: 0.918 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8279178142547607
Epoch: 28, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.950 Vali Acc: 0.711 Test Loss: 0.950 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9263033866882324
Epoch: 29, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.999 Vali Acc: 0.711 Test Loss: 0.999 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7537918090820312
Epoch: 30, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.034 Vali Acc: 0.724 Test Loss: 1.034 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7205104827880859
Epoch: 31, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.118 Vali Acc: 0.704 Test Loss: 1.118 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7681329250335693
Epoch: 32, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.155 Vali Acc: 0.743 Test Loss: 1.155 Test Acc: 0.743
Validation loss decreased (-0.730254 --> -0.743410).  Saving model ...
Epoch: 33 cost time: 0.736689567565918
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.151 Vali Acc: 0.724 Test Loss: 1.151 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8266644477844238
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.215 Vali Acc: 0.717 Test Loss: 1.215 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7076287269592285
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.274 Vali Acc: 0.737 Test Loss: 1.274 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8794586658477783
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.312 Vali Acc: 0.737 Test Loss: 1.312 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6755752563476562
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.356 Vali Acc: 0.730 Test Loss: 1.356 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.747511625289917
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.397 Vali Acc: 0.730 Test Loss: 1.397 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.705247163772583
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.439 Vali Acc: 0.730 Test Loss: 1.439 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.684175968170166
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.477 Vali Acc: 0.737 Test Loss: 1.477 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6498587131500244
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.511 Vali Acc: 0.724 Test Loss: 1.511 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7690327167510986
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.535 Vali Acc: 0.717 Test Loss: 1.535 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.743421052631579
model parameter : 105004
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2867536544799805
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.665585994720459
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.397 Vali Acc: 0.250 Test Loss: 1.397 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6139266490936279
Epoch: 3, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.373 Vali Acc: 0.250 Test Loss: 1.373 Test Acc: 0.250
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5951976776123047
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.348 Vali Acc: 0.263 Test Loss: 1.348 Test Acc: 0.263
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6400516033172607
Epoch: 5, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.320 Vali Acc: 0.270 Test Loss: 1.320 Test Acc: 0.270
Validation loss decreased (-0.269723 --> -0.269724).  Saving model ...
Epoch: 6 cost time: 0.7539238929748535
Epoch: 6, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.286 Vali Acc: 0.309 Test Loss: 1.286 Test Acc: 0.309
Validation loss decreased (-0.269724 --> -0.309198).  Saving model ...
Epoch: 7 cost time: 0.6776494979858398
Epoch: 7, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.241 Vali Acc: 0.382 Test Loss: 1.241 Test Acc: 0.382
Validation loss decreased (-0.309198 --> -0.381567).  Saving model ...
Epoch: 8 cost time: 0.7103257179260254
Epoch: 8, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.187 Vali Acc: 0.461 Test Loss: 1.187 Test Acc: 0.461
Validation loss decreased (-0.381567 --> -0.460514).  Saving model ...
Epoch: 9 cost time: 0.7357406616210938
Epoch: 9, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.121 Vali Acc: 0.539 Test Loss: 1.121 Test Acc: 0.539
Validation loss decreased (-0.460514 --> -0.539462).  Saving model ...
Epoch: 10 cost time: 0.7215516567230225
Epoch: 10, Steps: 10 | Train Loss: 0.981 Vali Loss: 1.037 Vali Acc: 0.592 Test Loss: 1.037 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592095).  Saving model ...
Epoch: 11 cost time: 0.738222599029541
Epoch: 11, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.976 Vali Acc: 0.592 Test Loss: 0.976 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592096).  Saving model ...
Epoch: 12 cost time: 0.6501798629760742
Epoch: 12, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.947 Vali Acc: 0.612 Test Loss: 0.947 Test Acc: 0.612
Validation loss decreased (-0.592096 --> -0.611833).  Saving model ...
Epoch: 13 cost time: 0.8408010005950928
Epoch: 13, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.937 Vali Acc: 0.618 Test Loss: 0.937 Test Acc: 0.618
Validation loss decreased (-0.611833 --> -0.618412).  Saving model ...
Epoch: 14 cost time: 0.6100978851318359
Epoch: 14, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.934 Vali Acc: 0.638 Test Loss: 0.934 Test Acc: 0.638
Validation loss decreased (-0.618412 --> -0.638149).  Saving model ...
Epoch: 15 cost time: 0.9461166858673096
Epoch: 15, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.934 Vali Acc: 0.645 Test Loss: 0.934 Test Acc: 0.645
Validation loss decreased (-0.638149 --> -0.644728).  Saving model ...
Epoch: 16 cost time: 0.6440014839172363
Epoch: 16, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.943 Vali Acc: 0.658 Test Loss: 0.943 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657885).  Saving model ...
Epoch: 17 cost time: 0.6867151260375977
Epoch: 17, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7036902904510498
Epoch: 18, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.940 Vali Acc: 0.651 Test Loss: 0.940 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7013189792633057
Epoch: 19, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.942 Vali Acc: 0.691 Test Loss: 0.942 Test Acc: 0.691
Validation loss decreased (-0.657885 --> -0.690780).  Saving model ...
Epoch: 20 cost time: 0.670583963394165
Epoch: 20, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.943 Vali Acc: 0.671 Test Loss: 0.943 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6389210224151611
Epoch: 21, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.967 Vali Acc: 0.691 Test Loss: 0.967 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6129987239837646
Epoch: 22, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.979 Vali Acc: 0.684 Test Loss: 0.979 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5278704166412354
Epoch: 23, Steps: 10 | Train Loss: 0.217 Vali Loss: 1.030 Vali Acc: 0.691 Test Loss: 1.030 Test Acc: 0.691
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6544589996337891
Epoch: 24, Steps: 10 | Train Loss: 0.185 Vali Loss: 1.074 Vali Acc: 0.697 Test Loss: 1.074 Test Acc: 0.697
Validation loss decreased (-0.690780 --> -0.697358).  Saving model ...
Epoch: 25 cost time: 0.7782905101776123
Epoch: 25, Steps: 10 | Train Loss: 0.162 Vali Loss: 1.109 Vali Acc: 0.704 Test Loss: 1.109 Test Acc: 0.704
Validation loss decreased (-0.697358 --> -0.703936).  Saving model ...
Epoch: 26 cost time: 0.5920891761779785
Epoch: 26, Steps: 10 | Train Loss: 0.141 Vali Loss: 1.163 Vali Acc: 0.697 Test Loss: 1.163 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9653041362762451
Epoch: 27, Steps: 10 | Train Loss: 0.101 Vali Loss: 1.238 Vali Acc: 0.717 Test Loss: 1.238 Test Acc: 0.717
Validation loss decreased (-0.703936 --> -0.717093).  Saving model ...
Epoch: 28 cost time: 0.7896988391876221
Epoch: 28, Steps: 10 | Train Loss: 0.084 Vali Loss: 1.309 Vali Acc: 0.704 Test Loss: 1.309 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6828906536102295
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.362 Vali Acc: 0.711 Test Loss: 1.362 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8394813537597656
Epoch: 30, Steps: 10 | Train Loss: 0.058 Vali Loss: 1.421 Vali Acc: 0.717 Test Loss: 1.421 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8824687004089355
Epoch: 31, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.502 Vali Acc: 0.711 Test Loss: 1.502 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8471164703369141
Epoch: 32, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.572 Vali Acc: 0.704 Test Loss: 1.572 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8606030941009521
Epoch: 33, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.671 Vali Acc: 0.704 Test Loss: 1.671 Test Acc: 0.704
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9415407180786133
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.718 Vali Acc: 0.704 Test Loss: 1.718 Test Acc: 0.704
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8486785888671875
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.775 Vali Acc: 0.704 Test Loss: 1.775 Test Acc: 0.704
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8978419303894043
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.856 Vali Acc: 0.717 Test Loss: 1.856 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1057868003845215
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.915 Vali Acc: 0.711 Test Loss: 1.915 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7171052631578947
model parameter : 104454
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.244745969772339
Epoch: 1, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.384 Vali Acc: 0.296 Test Loss: 1.384 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 0.6844029426574707
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.360 Vali Acc: 0.316 Test Loss: 1.360 Test Acc: 0.316
Validation loss decreased (-0.296039 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 0.6465291976928711
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.327 Vali Acc: 0.355 Test Loss: 1.327 Test Acc: 0.355
Validation loss decreased (-0.315776 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 0.6487624645233154
Epoch: 4, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.292 Vali Acc: 0.375 Test Loss: 1.292 Test Acc: 0.375
Validation loss decreased (-0.355250 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 0.5812005996704102
Epoch: 5, Steps: 10 | Train Loss: 1.266 Vali Loss: 1.250 Vali Acc: 0.421 Test Loss: 1.250 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 0.6578514575958252
Epoch: 6, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.200 Vali Acc: 0.487 Test Loss: 1.200 Test Acc: 0.487
Validation loss decreased (-0.421040 --> -0.486830).  Saving model ...
Epoch: 7 cost time: 0.5178115367889404
Epoch: 7, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.139 Vali Acc: 0.546 Test Loss: 1.139 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 0.6700742244720459
Epoch: 8, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.054 Vali Acc: 0.572 Test Loss: 1.054 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572358).  Saving model ...
Epoch: 9 cost time: 0.5999407768249512
Epoch: 9, Steps: 10 | Train Loss: 0.922 Vali Loss: 0.961 Vali Acc: 0.572 Test Loss: 0.961 Test Acc: 0.572
Validation loss decreased (-0.572358 --> -0.572359).  Saving model ...
Epoch: 10 cost time: 0.6682107448577881
Epoch: 10, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.859 Vali Acc: 0.678 Test Loss: 0.859 Test Acc: 0.678
Validation loss decreased (-0.572359 --> -0.677623).  Saving model ...
Epoch: 11 cost time: 0.6430826187133789
Epoch: 11, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.759 Vali Acc: 0.678 Test Loss: 0.759 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 12 cost time: 0.750800609588623
Epoch: 12, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.681 Vali Acc: 0.730 Test Loss: 0.681 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 0.699012041091919
Epoch: 13, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 0.7538852691650391
Epoch: 14, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 0.6510920524597168
Epoch: 15, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 0.6393623352050781
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 0.6306805610656738
Epoch: 17, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.772803783416748
Epoch: 18, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9862625598907471
Epoch: 19, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.593 Vali Acc: 0.809 Test Loss: 0.593 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 0.6985898017883301
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.610539436340332
Epoch: 21, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7052178382873535
Epoch: 22, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6934914588928223
Epoch: 23, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.702 Vali Acc: 0.809 Test Loss: 0.702 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6748504638671875
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.738 Vali Acc: 0.796 Test Loss: 0.738 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6624314785003662
Epoch: 25, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6722073554992676
Epoch: 26, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.860 Vali Acc: 0.809 Test Loss: 0.860 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.731550931930542
Epoch: 27, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6282229423522949
Epoch: 28, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.907 Vali Acc: 0.783 Test Loss: 0.907 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7410502433776855
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.935 Vali Acc: 0.783 Test Loss: 0.935 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 104224
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.200253486633301
Epoch: 1, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 0.637300968170166
Epoch: 2, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.331 Vali Acc: 0.349 Test Loss: 1.331 Test Acc: 0.349
Validation loss decreased (-0.342092 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.8282008171081543
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.309 Vali Acc: 0.349 Test Loss: 1.309 Test Acc: 0.349
Validation loss decreased (-0.348671 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 0.5748848915100098
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.286 Vali Acc: 0.349 Test Loss: 1.286 Test Acc: 0.349
Validation loss decreased (-0.348671 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.6051018238067627
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.255 Vali Acc: 0.375 Test Loss: 1.255 Test Acc: 0.375
Validation loss decreased (-0.348671 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.6615736484527588
Epoch: 6, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.220 Vali Acc: 0.434 Test Loss: 1.220 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 7 cost time: 0.5716230869293213
Epoch: 7, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.180 Vali Acc: 0.487 Test Loss: 1.180 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 0.818408727645874
Epoch: 8, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.126 Vali Acc: 0.546 Test Loss: 1.126 Test Acc: 0.546
Validation loss decreased (-0.486830 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 0.6191134452819824
Epoch: 9, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.068 Vali Acc: 0.586 Test Loss: 1.068 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 0.6917128562927246
Epoch: 10, Steps: 10 | Train Loss: 0.884 Vali Loss: 1.020 Vali Acc: 0.572 Test Loss: 1.020 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.709010124206543
Epoch: 11, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.965 Vali Acc: 0.599 Test Loss: 0.965 Test Acc: 0.599
Validation loss decreased (-0.585516 --> -0.598675).  Saving model ...
Epoch: 12 cost time: 0.6378862857818604
Epoch: 12, Steps: 10 | Train Loss: 0.699 Vali Loss: 0.904 Vali Acc: 0.645 Test Loss: 0.904 Test Acc: 0.645
Validation loss decreased (-0.598675 --> -0.644728).  Saving model ...
Epoch: 13 cost time: 0.6126716136932373
Epoch: 13, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.844 Vali Acc: 0.684 Test Loss: 0.844 Test Acc: 0.684
Validation loss decreased (-0.644728 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 0.7362041473388672
Epoch: 14, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.792 Vali Acc: 0.697 Test Loss: 0.792 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 0.6194920539855957
Epoch: 15, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.740 Vali Acc: 0.711 Test Loss: 0.740 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 0.7881131172180176
Epoch: 16, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.749 Vali Acc: 0.737 Test Loss: 0.749 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 0.6907591819763184
Epoch: 17, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.766 Vali Acc: 0.704 Test Loss: 0.766 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6890008449554443
Epoch: 18, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.739 Vali Acc: 0.704 Test Loss: 0.739 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7116572856903076
Epoch: 19, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.748 Vali Acc: 0.697 Test Loss: 0.748 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6393222808837891
Epoch: 20, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.757 Vali Acc: 0.704 Test Loss: 0.757 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6689200401306152
Epoch: 21, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0109498500823975
Epoch: 22, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.787 Vali Acc: 0.724 Test Loss: 0.787 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6569981575012207
Epoch: 23, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.841 Vali Acc: 0.750 Test Loss: 0.841 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749992).  Saving model ...
Epoch: 24 cost time: 0.7470471858978271
Epoch: 24, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.848 Vali Acc: 0.737 Test Loss: 0.848 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6031253337860107
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.901 Vali Acc: 0.737 Test Loss: 0.901 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6369493007659912
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.967 Vali Acc: 0.750 Test Loss: 0.967 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5599796772003174
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.982 Vali Acc: 0.757 Test Loss: 0.982 Test Acc: 0.757
Validation loss decreased (-0.749992 --> -0.756569).  Saving model ...
Epoch: 28 cost time: 0.6489136219024658
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.000 Vali Acc: 0.743 Test Loss: 1.000 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7225997447967529
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.029 Vali Acc: 0.763 Test Loss: 1.029 Test Acc: 0.763
Validation loss decreased (-0.756569 --> -0.763148).  Saving model ...
Epoch: 30 cost time: 0.7180733680725098
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.067 Vali Acc: 0.743 Test Loss: 1.067 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6780681610107422
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.115 Vali Acc: 0.737 Test Loss: 1.115 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6800017356872559
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.146 Vali Acc: 0.743 Test Loss: 1.146 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5560426712036133
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.174 Vali Acc: 0.737 Test Loss: 1.174 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6708471775054932
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.195 Vali Acc: 0.743 Test Loss: 1.195 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7330172061920166
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.219 Vali Acc: 0.737 Test Loss: 1.219 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7402646541595459
Epoch: 36, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.249 Vali Acc: 0.730 Test Loss: 1.249 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7063138484954834
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.271 Vali Acc: 0.757 Test Loss: 1.271 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6529967784881592
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.283 Vali Acc: 0.757 Test Loss: 1.283 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7847676277160645
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.303 Vali Acc: 0.743 Test Loss: 1.303 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 104092
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5206851959228516
Epoch: 1, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.439 Vali Acc: 0.283 Test Loss: 1.439 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 0.8298180103302002
Epoch: 2, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.421 Vali Acc: 0.316 Test Loss: 1.421 Test Acc: 0.316
Validation loss decreased (-0.282880 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 0.9101238250732422
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.394 Vali Acc: 0.316 Test Loss: 1.394 Test Acc: 0.316
Validation loss decreased (-0.315775 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 0.6633317470550537
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.361 Vali Acc: 0.336 Test Loss: 1.361 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 0.6686558723449707
Epoch: 5, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.323 Vali Acc: 0.362 Test Loss: 1.323 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 0.7103633880615234
Epoch: 6, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.271 Vali Acc: 0.401 Test Loss: 1.271 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 7 cost time: 0.6525981426239014
Epoch: 7, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.196 Vali Acc: 0.474 Test Loss: 1.196 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473672).  Saving model ...
Epoch: 8 cost time: 0.8886919021606445
Epoch: 8, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.099 Vali Acc: 0.539 Test Loss: 1.099 Test Acc: 0.539
Validation loss decreased (-0.473672 --> -0.539463).  Saving model ...
Epoch: 9 cost time: 0.8464164733886719
Epoch: 9, Steps: 10 | Train Loss: 0.863 Vali Loss: 1.007 Vali Acc: 0.579 Test Loss: 1.007 Test Acc: 0.579
Validation loss decreased (-0.539463 --> -0.578937).  Saving model ...
Epoch: 10 cost time: 0.6237452030181885
Epoch: 10, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.939 Vali Acc: 0.612 Test Loss: 0.939 Test Acc: 0.612
Validation loss decreased (-0.578937 --> -0.611833).  Saving model ...
Epoch: 11 cost time: 0.6005911827087402
Epoch: 11, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.912 Vali Acc: 0.632 Test Loss: 0.912 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 12 cost time: 0.5938615798950195
Epoch: 12, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.864 Vali Acc: 0.651 Test Loss: 0.864 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 0.6563751697540283
Epoch: 13, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.837 Vali Acc: 0.664 Test Loss: 0.837 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 0.7445523738861084
Epoch: 14, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.802 Vali Acc: 0.671 Test Loss: 0.802 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671045).  Saving model ...
Epoch: 15 cost time: 0.7052547931671143
Epoch: 15, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.786 Vali Acc: 0.704 Test Loss: 0.786 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 0.803720235824585
Epoch: 16, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.768 Vali Acc: 0.704 Test Loss: 0.768 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 0.6086442470550537
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.761 Vali Acc: 0.724 Test Loss: 0.761 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.590989351272583
Epoch: 18, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.800 Vali Acc: 0.697 Test Loss: 0.800 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6474056243896484
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.805 Vali Acc: 0.730 Test Loss: 0.805 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730255).  Saving model ...
Epoch: 20 cost time: 0.5545170307159424
Epoch: 20, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.858 Vali Acc: 0.730 Test Loss: 0.858 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7936315536499023
Epoch: 21, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.870 Vali Acc: 0.724 Test Loss: 0.870 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7335057258605957
Epoch: 22, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.912 Vali Acc: 0.730 Test Loss: 0.912 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.695267915725708
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.972 Vali Acc: 0.737 Test Loss: 0.972 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736832).  Saving model ...
Epoch: 24 cost time: 0.6615900993347168
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 1.025 Vali Acc: 0.724 Test Loss: 1.025 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.727414608001709
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.059 Vali Acc: 0.717 Test Loss: 1.059 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8432486057281494
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.130 Vali Acc: 0.717 Test Loss: 1.130 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.740882158279419
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.181 Vali Acc: 0.743 Test Loss: 1.181 Test Acc: 0.743
Validation loss decreased (-0.736832 --> -0.743409).  Saving model ...
Epoch: 28 cost time: 0.7960336208343506
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.241 Vali Acc: 0.717 Test Loss: 1.241 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7308404445648193
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.293 Vali Acc: 0.717 Test Loss: 1.293 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7610008716583252
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.351 Vali Acc: 0.724 Test Loss: 1.351 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8127601146697998
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.418 Vali Acc: 0.724 Test Loss: 1.418 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8680346012115479
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.437 Vali Acc: 0.724 Test Loss: 1.437 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7189886569976807
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.475 Vali Acc: 0.717 Test Loss: 1.475 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8550844192504883
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.520 Vali Acc: 0.724 Test Loss: 1.520 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6115708351135254
Epoch: 35, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.551 Vali Acc: 0.724 Test Loss: 1.551 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6019301414489746
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.581 Vali Acc: 0.730 Test Loss: 1.581 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8724892139434814
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.608 Vali Acc: 0.737 Test Loss: 1.608 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.743421052631579
model parameter : 103856
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.456005811691284
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.350 Vali Acc: 0.395 Test Loss: 1.350 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 0.6340658664703369
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.329 Vali Acc: 0.421 Test Loss: 1.329 Test Acc: 0.421
Validation loss decreased (-0.394723 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 0.7864787578582764
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.300 Vali Acc: 0.395 Test Loss: 1.300 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.738243579864502
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.267 Vali Acc: 0.382 Test Loss: 1.267 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8605873584747314
Epoch: 5, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.226 Vali Acc: 0.401 Test Loss: 1.226 Test Acc: 0.401
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9049379825592041
Epoch: 6, Steps: 10 | Train Loss: 1.156 Vali Loss: 1.172 Vali Acc: 0.447 Test Loss: 1.172 Test Acc: 0.447
Validation loss decreased (-0.421039 --> -0.447357).  Saving model ...
Epoch: 7 cost time: 0.6872918605804443
Epoch: 7, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.102 Vali Acc: 0.500 Test Loss: 1.102 Test Acc: 0.500
Validation loss decreased (-0.447357 --> -0.499989).  Saving model ...
Epoch: 8 cost time: 0.6688547134399414
Epoch: 8, Steps: 10 | Train Loss: 0.943 Vali Loss: 1.026 Vali Acc: 0.520 Test Loss: 1.026 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519727).  Saving model ...
Epoch: 9 cost time: 0.6470813751220703
Epoch: 9, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.961 Vali Acc: 0.572 Test Loss: 0.961 Test Acc: 0.572
Validation loss decreased (-0.519727 --> -0.572359).  Saving model ...
Epoch: 10 cost time: 0.7703564167022705
Epoch: 10, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.915 Vali Acc: 0.572 Test Loss: 0.915 Test Acc: 0.572
Validation loss decreased (-0.572359 --> -0.572359).  Saving model ...
Epoch: 11 cost time: 0.8564009666442871
Epoch: 11, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.899 Vali Acc: 0.572 Test Loss: 0.899 Test Acc: 0.572
Validation loss decreased (-0.572359 --> -0.572359).  Saving model ...
Epoch: 12 cost time: 0.6365461349487305
Epoch: 12, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.858 Vali Acc: 0.632 Test Loss: 0.858 Test Acc: 0.632
Validation loss decreased (-0.572359 --> -0.631570).  Saving model ...
Epoch: 13 cost time: 0.8459010124206543
Epoch: 13, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.796 Vali Acc: 0.658 Test Loss: 0.796 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657887).  Saving model ...
Epoch: 14 cost time: 0.5228350162506104
Epoch: 14, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.743 Vali Acc: 0.658 Test Loss: 0.743 Test Acc: 0.658
Validation loss decreased (-0.657887 --> -0.657887).  Saving model ...
Epoch: 15 cost time: 0.6101722717285156
Epoch: 15, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.716 Vali Acc: 0.697 Test Loss: 0.716 Test Acc: 0.697
Validation loss decreased (-0.657887 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 0.6431190967559814
Epoch: 16, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.727 Vali Acc: 0.711 Test Loss: 0.727 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 0.7119402885437012
Epoch: 17, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.713 Vali Acc: 0.724 Test Loss: 0.713 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 0.6256387233734131
Epoch: 18, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.675835132598877
Epoch: 19, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.660 Vali Acc: 0.724 Test Loss: 0.660 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 20 cost time: 0.6121971607208252
Epoch: 20, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.668 Vali Acc: 0.743 Test Loss: 0.668 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743414).  Saving model ...
Epoch: 21 cost time: 0.7350668907165527
Epoch: 21, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.692 Vali Acc: 0.757 Test Loss: 0.692 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 22 cost time: 0.7666659355163574
Epoch: 22, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.666 Vali Acc: 0.776 Test Loss: 0.666 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 23 cost time: 0.719860315322876
Epoch: 23, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.691 Vali Acc: 0.750 Test Loss: 0.691 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8627243041992188
Epoch: 24, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.693 Vali Acc: 0.783 Test Loss: 0.693 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 25 cost time: 0.5794436931610107
Epoch: 25, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.736 Vali Acc: 0.796 Test Loss: 0.736 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796045).  Saving model ...
Epoch: 26 cost time: 0.7275738716125488
Epoch: 26, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6952834129333496
Epoch: 27, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.790 Vali Acc: 0.796 Test Loss: 0.790 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8427700996398926
Epoch: 28, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.864 Vali Acc: 0.770 Test Loss: 0.864 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7637588977813721
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.858 Vali Acc: 0.789 Test Loss: 0.858 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7342925071716309
Epoch: 30, Steps: 10 | Train Loss: 0.091 Vali Loss: 1.032 Vali Acc: 0.730 Test Loss: 1.032 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8411617279052734
Epoch: 31, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.912 Vali Acc: 0.783 Test Loss: 0.912 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6832354068756104
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 1.030 Vali Acc: 0.743 Test Loss: 1.030 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8325009346008301
Epoch: 33, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.956 Vali Acc: 0.803 Test Loss: 0.956 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802622).  Saving model ...
Epoch: 34 cost time: 0.6398992538452148
Epoch: 34, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.025 Vali Acc: 0.789 Test Loss: 1.025 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8172669410705566
Epoch: 35, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.111 Vali Acc: 0.750 Test Loss: 1.111 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8662214279174805
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.093 Vali Acc: 0.803 Test Loss: 1.093 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0315475463867188
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.162 Vali Acc: 0.783 Test Loss: 1.162 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7443835735321045
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.159 Vali Acc: 0.789 Test Loss: 1.159 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.655850887298584
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.260 Vali Acc: 0.789 Test Loss: 1.260 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7473108768463135
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.293 Vali Acc: 0.789 Test Loss: 1.293 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6945667266845703
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.343 Vali Acc: 0.770 Test Loss: 1.343 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7320737838745117
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.381 Vali Acc: 0.783 Test Loss: 1.381 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7592594623565674
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.395 Vali Acc: 0.776 Test Loss: 1.395 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm512_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 103870
model size : 0.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9140198230743408
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.402 Vali Acc: 0.243 Test Loss: 1.402 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.5969491004943848
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.389 Vali Acc: 0.270 Test Loss: 1.389 Test Acc: 0.270
Validation loss decreased (-0.243407 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.6624319553375244
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.372 Vali Acc: 0.296 Test Loss: 1.372 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 0.6565299034118652
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.352 Vali Acc: 0.303 Test Loss: 1.352 Test Acc: 0.303
Validation loss decreased (-0.296039 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 0.6683251857757568
Epoch: 5, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.329 Vali Acc: 0.355 Test Loss: 1.329 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 0.517169713973999
Epoch: 6, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.304 Vali Acc: 0.375 Test Loss: 1.304 Test Acc: 0.375
Validation loss decreased (-0.355250 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.5656030178070068
Epoch: 7, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.276 Vali Acc: 0.408 Test Loss: 1.276 Test Acc: 0.408
Validation loss decreased (-0.374987 --> -0.407882).  Saving model ...
Epoch: 8 cost time: 0.5561356544494629
Epoch: 8, Steps: 10 | Train Loss: 1.175 Vali Loss: 1.245 Vali Acc: 0.441 Test Loss: 1.245 Test Acc: 0.441
Validation loss decreased (-0.407882 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 0.5964033603668213
Epoch: 9, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.211 Vali Acc: 0.454 Test Loss: 1.211 Test Acc: 0.454
Validation loss decreased (-0.440777 --> -0.453935).  Saving model ...
Epoch: 10 cost time: 0.6121952533721924
Epoch: 10, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.169 Vali Acc: 0.487 Test Loss: 1.169 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 11 cost time: 0.7082397937774658
Epoch: 11, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.118 Vali Acc: 0.533 Test Loss: 1.118 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532884).  Saving model ...
Epoch: 12 cost time: 0.5953371524810791
Epoch: 12, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.060 Vali Acc: 0.586 Test Loss: 1.060 Test Acc: 0.586
Validation loss decreased (-0.532884 --> -0.585516).  Saving model ...
Epoch: 13 cost time: 0.5653119087219238
Epoch: 13, Steps: 10 | Train Loss: 0.834 Vali Loss: 1.001 Vali Acc: 0.592 Test Loss: 1.001 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 14 cost time: 0.5821287631988525
Epoch: 14, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.943 Vali Acc: 0.586 Test Loss: 0.943 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5614075660705566
Epoch: 15, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.918 Vali Acc: 0.599 Test Loss: 0.918 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598675).  Saving model ...
Epoch: 16 cost time: 0.5834529399871826
Epoch: 16, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.913 Vali Acc: 0.625 Test Loss: 0.913 Test Acc: 0.625
Validation loss decreased (-0.598675 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 0.5690813064575195
Epoch: 17, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.894 Vali Acc: 0.645 Test Loss: 0.894 Test Acc: 0.645
Validation loss decreased (-0.624991 --> -0.644728).  Saving model ...
Epoch: 18 cost time: 0.6256439685821533
Epoch: 18, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.883 Vali Acc: 0.658 Test Loss: 0.883 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657886).  Saving model ...
Epoch: 19 cost time: 0.633927583694458
Epoch: 19, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.867 Vali Acc: 0.651 Test Loss: 0.867 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8222155570983887
Epoch: 20, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.844 Vali Acc: 0.651 Test Loss: 0.844 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5965433120727539
Epoch: 21, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.862 Vali Acc: 0.651 Test Loss: 0.862 Test Acc: 0.651
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6189744472503662
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 23 cost time: 0.6277692317962646
Epoch: 23, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.866 Vali Acc: 0.678 Test Loss: 0.866 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6201920509338379
Epoch: 24, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.835 Vali Acc: 0.684 Test Loss: 0.835 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684202).  Saving model ...
Epoch: 25 cost time: 0.6489078998565674
Epoch: 25, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.877 Vali Acc: 0.684 Test Loss: 0.877 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5931925773620605
Epoch: 26, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.884 Vali Acc: 0.671 Test Loss: 0.884 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.578857421875
Epoch: 27, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.902 Vali Acc: 0.691 Test Loss: 0.902 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690780).  Saving model ...
Epoch: 28 cost time: 0.6201598644256592
Epoch: 28, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.970 Vali Acc: 0.664 Test Loss: 0.970 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6054904460906982
Epoch: 29, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.978 Vali Acc: 0.684 Test Loss: 0.978 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5825929641723633
Epoch: 30, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.022 Vali Acc: 0.684 Test Loss: 1.022 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6896913051605225
Epoch: 31, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.082 Vali Acc: 0.678 Test Loss: 1.082 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.743398904800415
Epoch: 32, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.110 Vali Acc: 0.678 Test Loss: 1.110 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6992838382720947
Epoch: 33, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.169 Vali Acc: 0.684 Test Loss: 1.169 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7709200382232666
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.255 Vali Acc: 0.658 Test Loss: 1.255 Test Acc: 0.658
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6050097942352295
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.270 Vali Acc: 0.678 Test Loss: 1.270 Test Acc: 0.678
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6398844718933105
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.311 Vali Acc: 0.684 Test Loss: 1.311 Test Acc: 0.684
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6747477054595947
Epoch: 37, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.369 Vali Acc: 0.691 Test Loss: 1.369 Test Acc: 0.691
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.6907894736842105
model parameter : 29648
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0406582355499268
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.422 Vali Acc: 0.243 Test Loss: 1.422 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.5929720401763916
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.404 Vali Acc: 0.276 Test Loss: 1.404 Test Acc: 0.276
Validation loss decreased (-0.243407 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 0.6634085178375244
Epoch: 3, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.386 Vali Acc: 0.296 Test Loss: 1.386 Test Acc: 0.296
Validation loss decreased (-0.276302 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 0.6636435985565186
Epoch: 4, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.365 Vali Acc: 0.303 Test Loss: 1.365 Test Acc: 0.303
Validation loss decreased (-0.296039 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 0.6052048206329346
Epoch: 5, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.342 Vali Acc: 0.329 Test Loss: 1.342 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 6 cost time: 0.5185973644256592
Epoch: 6, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.321 Vali Acc: 0.362 Test Loss: 1.321 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.5840010643005371
Epoch: 7, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.295 Vali Acc: 0.375 Test Loss: 1.295 Test Acc: 0.375
Validation loss decreased (-0.361829 --> -0.374987).  Saving model ...
Epoch: 8 cost time: 0.5699398517608643
Epoch: 8, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.272 Vali Acc: 0.421 Test Loss: 1.272 Test Acc: 0.421
Validation loss decreased (-0.374987 --> -0.421040).  Saving model ...
Epoch: 9 cost time: 0.7921981811523438
Epoch: 9, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.249 Vali Acc: 0.434 Test Loss: 1.249 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 0.5977838039398193
Epoch: 10, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.222 Vali Acc: 0.441 Test Loss: 1.222 Test Acc: 0.441
Validation loss decreased (-0.434198 --> -0.440777).  Saving model ...
Epoch: 11 cost time: 0.5727458000183105
Epoch: 11, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.194 Vali Acc: 0.467 Test Loss: 1.194 Test Acc: 0.467
Validation loss decreased (-0.440777 --> -0.467093).  Saving model ...
Epoch: 12 cost time: 0.5375337600708008
Epoch: 12, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.165 Vali Acc: 0.507 Test Loss: 1.165 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 13 cost time: 0.5711936950683594
Epoch: 13, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.120 Vali Acc: 0.618 Test Loss: 1.120 Test Acc: 0.618
Validation loss decreased (-0.506567 --> -0.618410).  Saving model ...
Epoch: 14 cost time: 0.5166609287261963
Epoch: 14, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.085 Vali Acc: 0.638 Test Loss: 1.085 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 15 cost time: 0.6397731304168701
Epoch: 15, Steps: 10 | Train Loss: 0.934 Vali Loss: 1.043 Vali Acc: 0.645 Test Loss: 1.043 Test Acc: 0.645
Validation loss decreased (-0.638147 --> -0.644726).  Saving model ...
Epoch: 16 cost time: 0.7248520851135254
Epoch: 16, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.984 Vali Acc: 0.638 Test Loss: 0.984 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7685754299163818
Epoch: 17, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.925 Vali Acc: 0.658 Test Loss: 0.925 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657885).  Saving model ...
Epoch: 18 cost time: 0.7228381633758545
Epoch: 18, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.874 Vali Acc: 0.678 Test Loss: 0.874 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677623).  Saving model ...
Epoch: 19 cost time: 0.61080002784729
Epoch: 19, Steps: 10 | Train Loss: 0.600 Vali Loss: 0.834 Vali Acc: 0.678 Test Loss: 0.834 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677623).  Saving model ...
Epoch: 20 cost time: 0.6713414192199707
Epoch: 20, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 21 cost time: 0.6277656555175781
Epoch: 21, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.789 Vali Acc: 0.658 Test Loss: 0.789 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7068896293640137
Epoch: 22, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.786 Vali Acc: 0.691 Test Loss: 0.786 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 23 cost time: 0.7346887588500977
Epoch: 23, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.762 Vali Acc: 0.671 Test Loss: 0.762 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6634650230407715
Epoch: 24, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.763 Vali Acc: 0.691 Test Loss: 0.763 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 25 cost time: 0.643883466720581
Epoch: 25, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.757 Vali Acc: 0.697 Test Loss: 0.757 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 26 cost time: 0.8257813453674316
Epoch: 26, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.804 Vali Acc: 0.697 Test Loss: 0.804 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8765246868133545
Epoch: 27, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.797 Vali Acc: 0.704 Test Loss: 0.797 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703939).  Saving model ...
Epoch: 28 cost time: 0.7804911136627197
Epoch: 28, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.817 Vali Acc: 0.704 Test Loss: 0.817 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7997500896453857
Epoch: 29, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.842 Vali Acc: 0.704 Test Loss: 0.842 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7844243049621582
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.871 Vali Acc: 0.711 Test Loss: 0.871 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 31 cost time: 0.6517784595489502
Epoch: 31, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.930 Vali Acc: 0.717 Test Loss: 0.930 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717096).  Saving model ...
Epoch: 32 cost time: 0.6106913089752197
Epoch: 32, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.942 Vali Acc: 0.724 Test Loss: 0.942 Test Acc: 0.724
Validation loss decreased (-0.717096 --> -0.723675).  Saving model ...
Epoch: 33 cost time: 0.7440857887268066
Epoch: 33, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.991 Vali Acc: 0.724 Test Loss: 0.991 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6957206726074219
Epoch: 34, Steps: 10 | Train Loss: 0.098 Vali Loss: 1.058 Vali Acc: 0.717 Test Loss: 1.058 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5795316696166992
Epoch: 35, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.075 Vali Acc: 0.724 Test Loss: 1.075 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7049219608306885
Epoch: 36, Steps: 10 | Train Loss: 0.060 Vali Loss: 1.130 Vali Acc: 0.724 Test Loss: 1.130 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.657691478729248
Epoch: 37, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.131 Vali Acc: 0.724 Test Loss: 1.131 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6146483421325684
Epoch: 38, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.198 Vali Acc: 0.711 Test Loss: 1.198 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6564445495605469
Epoch: 39, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.250 Vali Acc: 0.717 Test Loss: 1.250 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6325995922088623
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.304 Vali Acc: 0.724 Test Loss: 1.304 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6249961853027344
Epoch: 41, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.355 Vali Acc: 0.711 Test Loss: 1.355 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6105029582977295
Epoch: 42, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.362 Vali Acc: 0.717 Test Loss: 1.362 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7236842105263158
model parameter : 29022
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0883889198303223
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.405 Vali Acc: 0.283 Test Loss: 1.405 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.6952342987060547
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.394 Vali Acc: 0.296 Test Loss: 1.394 Test Acc: 0.296
Validation loss decreased (-0.282881 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 0.5893874168395996
Epoch: 3, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.380 Vali Acc: 0.303 Test Loss: 1.380 Test Acc: 0.303
Validation loss decreased (-0.296039 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.5548243522644043
Epoch: 4, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.366 Vali Acc: 0.316 Test Loss: 1.366 Test Acc: 0.316
Validation loss decreased (-0.302618 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 0.6076755523681641
Epoch: 5, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.347 Vali Acc: 0.336 Test Loss: 1.347 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 0.6926965713500977
Epoch: 6, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.326 Vali Acc: 0.368 Test Loss: 1.326 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 0.6812784671783447
Epoch: 7, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.303 Vali Acc: 0.408 Test Loss: 1.303 Test Acc: 0.408
Validation loss decreased (-0.368408 --> -0.407882).  Saving model ...
Epoch: 8 cost time: 0.6491484642028809
Epoch: 8, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.279 Vali Acc: 0.434 Test Loss: 1.279 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 9 cost time: 0.7274007797241211
Epoch: 9, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.252 Vali Acc: 0.441 Test Loss: 1.252 Test Acc: 0.441
Validation loss decreased (-0.434198 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 0.675311803817749
Epoch: 10, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.219 Vali Acc: 0.474 Test Loss: 1.219 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473672).  Saving model ...
Epoch: 11 cost time: 0.5508344173431396
Epoch: 11, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.473672 --> -0.532883).  Saving model ...
Epoch: 12 cost time: 0.6843295097351074
Epoch: 12, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.134 Vali Acc: 0.559 Test Loss: 1.134 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559199).  Saving model ...
Epoch: 13 cost time: 0.6319336891174316
Epoch: 13, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.065 Vali Acc: 0.618 Test Loss: 1.065 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 14 cost time: 0.5635035037994385
Epoch: 14, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.978 Vali Acc: 0.664 Test Loss: 0.978 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664464).  Saving model ...
Epoch: 15 cost time: 0.7070620059967041
Epoch: 15, Steps: 10 | Train Loss: 0.791 Vali Loss: 0.882 Vali Acc: 0.658 Test Loss: 0.882 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5825579166412354
Epoch: 16, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.797 Vali Acc: 0.632 Test Loss: 0.797 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7618229389190674
Epoch: 17, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.755 Vali Acc: 0.618 Test Loss: 0.755 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6214914321899414
Epoch: 18, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.755 Vali Acc: 0.618 Test Loss: 0.755 Test Acc: 0.618
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6779494285583496
Epoch: 19, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.740 Vali Acc: 0.638 Test Loss: 0.740 Test Acc: 0.638
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.709376335144043
Epoch: 20, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.741 Vali Acc: 0.651 Test Loss: 0.741 Test Acc: 0.651
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5612857341766357
Epoch: 21, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.740 Vali Acc: 0.645 Test Loss: 0.740 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7966692447662354
Epoch: 22, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.753 Vali Acc: 0.632 Test Loss: 0.753 Test Acc: 0.632
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6892714500427246
Epoch: 23, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.756 Vali Acc: 0.645 Test Loss: 0.756 Test Acc: 0.645
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6856729984283447
Epoch: 24, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.767 Vali Acc: 0.664 Test Loss: 0.767 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664466).  Saving model ...
Epoch: 25 cost time: 0.6176819801330566
Epoch: 25, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.792 Vali Acc: 0.638 Test Loss: 0.792 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5715289115905762
Epoch: 26, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.801 Vali Acc: 0.651 Test Loss: 0.801 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6018576622009277
Epoch: 27, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.821 Vali Acc: 0.658 Test Loss: 0.821 Test Acc: 0.658
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5720336437225342
Epoch: 28, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.847 Vali Acc: 0.651 Test Loss: 0.847 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7375504970550537
Epoch: 29, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.866 Vali Acc: 0.671 Test Loss: 0.866 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671044).  Saving model ...
Epoch: 30 cost time: 0.6368095874786377
Epoch: 30, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.890 Vali Acc: 0.664 Test Loss: 0.890 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6827845573425293
Epoch: 31, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.934 Vali Acc: 0.671 Test Loss: 0.934 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6205563545227051
Epoch: 32, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.976 Vali Acc: 0.664 Test Loss: 0.976 Test Acc: 0.664
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.587491512298584
Epoch: 33, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.976 Vali Acc: 0.671 Test Loss: 0.976 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.535574197769165
Epoch: 34, Steps: 10 | Train Loss: 0.118 Vali Loss: 1.012 Vali Acc: 0.664 Test Loss: 1.012 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5172154903411865
Epoch: 35, Steps: 10 | Train Loss: 0.107 Vali Loss: 1.049 Vali Acc: 0.671 Test Loss: 1.049 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.5919778347015381
Epoch: 36, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.099 Vali Acc: 0.671 Test Loss: 1.099 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.7011299133300781
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.136 Vali Acc: 0.684 Test Loss: 1.136 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684199).  Saving model ...
Epoch: 38 cost time: 0.6210181713104248
Epoch: 38, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.169 Vali Acc: 0.678 Test Loss: 1.169 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6586992740631104
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 1.204 Vali Acc: 0.684 Test Loss: 1.204 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5963835716247559
Epoch: 40, Steps: 10 | Train Loss: 0.063 Vali Loss: 1.229 Vali Acc: 0.691 Test Loss: 1.229 Test Acc: 0.691
Validation loss decreased (-0.684199 --> -0.690777).  Saving model ...
Epoch: 41 cost time: 0.5259037017822266
Epoch: 41, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.295 Vali Acc: 0.678 Test Loss: 1.295 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6575500965118408
Epoch: 42, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.341 Vali Acc: 0.671 Test Loss: 1.341 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6056902408599854
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 1.368 Vali Acc: 0.684 Test Loss: 1.368 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6810719966888428
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 1.395 Vali Acc: 0.678 Test Loss: 1.395 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5252785682678223
Epoch: 45, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.418 Vali Acc: 0.691 Test Loss: 1.418 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.536740779876709
Epoch: 46, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.495 Vali Acc: 0.684 Test Loss: 1.495 Test Acc: 0.684
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6737747192382812
Epoch: 47, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.531 Vali Acc: 0.684 Test Loss: 1.531 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5689888000488281
Epoch: 48, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.557 Vali Acc: 0.691 Test Loss: 1.557 Test Acc: 0.691
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5626437664031982
Epoch: 49, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.597 Vali Acc: 0.691 Test Loss: 1.597 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.7042405605316162
Epoch: 50, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.639 Vali Acc: 0.684 Test Loss: 1.639 Test Acc: 0.684
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.6907894736842105
model parameter : 28844
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1232285499572754
Epoch: 1, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.410 Vali Acc: 0.329 Test Loss: 1.410 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 0.6232295036315918
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.397 Vali Acc: 0.349 Test Loss: 1.397 Test Acc: 0.349
Validation loss decreased (-0.328933 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 0.6988253593444824
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.379 Vali Acc: 0.349 Test Loss: 1.379 Test Acc: 0.349
Validation loss decreased (-0.348670 --> -0.348670).  Saving model ...
Epoch: 4 cost time: 0.6162793636322021
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.358 Vali Acc: 0.362 Test Loss: 1.358 Test Acc: 0.362
Validation loss decreased (-0.348670 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 0.6786282062530518
Epoch: 5, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.334 Vali Acc: 0.388 Test Loss: 1.334 Test Acc: 0.388
Validation loss decreased (-0.361829 --> -0.388145).  Saving model ...
Epoch: 6 cost time: 0.6031613349914551
Epoch: 6, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.308 Vali Acc: 0.408 Test Loss: 1.308 Test Acc: 0.408
Validation loss decreased (-0.388145 --> -0.407882).  Saving model ...
Epoch: 7 cost time: 0.8066821098327637
Epoch: 7, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.279 Vali Acc: 0.414 Test Loss: 1.279 Test Acc: 0.414
Validation loss decreased (-0.407882 --> -0.414461).  Saving model ...
Epoch: 8 cost time: 0.6144459247589111
Epoch: 8, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.240 Vali Acc: 0.434 Test Loss: 1.240 Test Acc: 0.434
Validation loss decreased (-0.414461 --> -0.434198).  Saving model ...
Epoch: 9 cost time: 0.6076395511627197
Epoch: 9, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.199 Vali Acc: 0.447 Test Loss: 1.199 Test Acc: 0.447
Validation loss decreased (-0.434198 --> -0.447356).  Saving model ...
Epoch: 10 cost time: 0.7116413116455078
Epoch: 10, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.150 Vali Acc: 0.500 Test Loss: 1.150 Test Acc: 0.500
Validation loss decreased (-0.447356 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.6470568180084229
Epoch: 11, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.094 Vali Acc: 0.533 Test Loss: 1.094 Test Acc: 0.533
Validation loss decreased (-0.499988 --> -0.532884).  Saving model ...
Epoch: 12 cost time: 0.6986830234527588
Epoch: 12, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.021 Vali Acc: 0.599 Test Loss: 1.021 Test Acc: 0.599
Validation loss decreased (-0.532884 --> -0.598674).  Saving model ...
Epoch: 13 cost time: 0.6483333110809326
Epoch: 13, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.938 Vali Acc: 0.632 Test Loss: 0.938 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631570).  Saving model ...
Epoch: 14 cost time: 0.6808755397796631
Epoch: 14, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.866 Vali Acc: 0.625 Test Loss: 0.866 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8888053894042969
Epoch: 15, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.792 Vali Acc: 0.645 Test Loss: 0.792 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644729).  Saving model ...
Epoch: 16 cost time: 0.6222009658813477
Epoch: 16, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.734 Vali Acc: 0.684 Test Loss: 0.734 Test Acc: 0.684
Validation loss decreased (-0.644729 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 0.5951058864593506
Epoch: 17, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.691 Vali Acc: 0.737 Test Loss: 0.691 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736835).  Saving model ...
Epoch: 18 cost time: 0.7721867561340332
Epoch: 18, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 0.6161422729492188
Epoch: 19, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.646 Vali Acc: 0.724 Test Loss: 0.646 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7412765026092529
Epoch: 20, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6516342163085938
Epoch: 21, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 0.6068873405456543
Epoch: 22, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 23 cost time: 0.6643991470336914
Epoch: 23, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.629 Vali Acc: 0.757 Test Loss: 0.629 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5937821865081787
Epoch: 24, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5386350154876709
Epoch: 25, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5656740665435791
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 0.6321463584899902
Epoch: 27, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.651 Vali Acc: 0.763 Test Loss: 0.651 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7157015800476074
Epoch: 28, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6113903522491455
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.674 Vali Acc: 0.750 Test Loss: 0.674 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5701005458831787
Epoch: 30, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5659575462341309
Epoch: 31, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6524171829223633
Epoch: 32, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.770 Vali Acc: 0.763 Test Loss: 0.770 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7804646492004395
Epoch: 33, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.759 Vali Acc: 0.763 Test Loss: 0.759 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6581430435180664
Epoch: 34, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.776 Vali Acc: 0.763 Test Loss: 0.776 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8867917060852051
Epoch: 35, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.797 Vali Acc: 0.750 Test Loss: 0.797 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8527662754058838
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.835 Vali Acc: 0.750 Test Loss: 0.835 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 28550
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.017760992050171
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.430 Vali Acc: 0.171 Test Loss: 1.430 Test Acc: 0.171
Validation loss decreased (inf --> -0.171038).  Saving model ...
Epoch: 2 cost time: 0.551231861114502
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.417 Vali Acc: 0.191 Test Loss: 1.417 Test Acc: 0.191
Validation loss decreased (-0.171038 --> -0.190775).  Saving model ...
Epoch: 3 cost time: 0.6473691463470459
Epoch: 3, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.401 Vali Acc: 0.224 Test Loss: 1.401 Test Acc: 0.224
Validation loss decreased (-0.190775 --> -0.223670).  Saving model ...
Epoch: 4 cost time: 0.6816258430480957
Epoch: 4, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.383 Vali Acc: 0.257 Test Loss: 1.383 Test Acc: 0.257
Validation loss decreased (-0.223670 --> -0.256565).  Saving model ...
Epoch: 5 cost time: 0.6190330982208252
Epoch: 5, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.363 Vali Acc: 0.263 Test Loss: 1.363 Test Acc: 0.263
Validation loss decreased (-0.256565 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 0.6043412685394287
Epoch: 6, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.340 Vali Acc: 0.289 Test Loss: 1.340 Test Acc: 0.289
Validation loss decreased (-0.263144 --> -0.289460).  Saving model ...
Epoch: 7 cost time: 0.6090004444122314
Epoch: 7, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.317 Vali Acc: 0.355 Test Loss: 1.317 Test Acc: 0.355
Validation loss decreased (-0.289460 --> -0.355250).  Saving model ...
Epoch: 8 cost time: 0.775627851486206
Epoch: 8, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.292 Vali Acc: 0.408 Test Loss: 1.292 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 9 cost time: 0.5497307777404785
Epoch: 9, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.261 Vali Acc: 0.461 Test Loss: 1.261 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 10 cost time: 0.5810806751251221
Epoch: 10, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.223 Vali Acc: 0.493 Test Loss: 1.223 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 0.6978530883789062
Epoch: 11, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.175 Vali Acc: 0.546 Test Loss: 1.175 Test Acc: 0.546
Validation loss decreased (-0.493409 --> -0.546041).  Saving model ...
Epoch: 12 cost time: 0.5979230403900146
Epoch: 12, Steps: 10 | Train Loss: 1.026 Vali Loss: 1.118 Vali Acc: 0.566 Test Loss: 1.118 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 13 cost time: 0.6143217086791992
Epoch: 13, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.048 Vali Acc: 0.579 Test Loss: 1.048 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578937).  Saving model ...
Epoch: 14 cost time: 0.6194779872894287
Epoch: 14, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.976 Vali Acc: 0.618 Test Loss: 0.976 Test Acc: 0.618
Validation loss decreased (-0.578937 --> -0.618411).  Saving model ...
Epoch: 15 cost time: 0.7730591297149658
Epoch: 15, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.911 Vali Acc: 0.671 Test Loss: 0.911 Test Acc: 0.671
Validation loss decreased (-0.618411 --> -0.671044).  Saving model ...
Epoch: 16 cost time: 0.6841690540313721
Epoch: 16, Steps: 10 | Train Loss: 0.653 Vali Loss: 0.858 Vali Acc: 0.684 Test Loss: 0.858 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 17 cost time: 0.6746973991394043
Epoch: 17, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.800 Vali Acc: 0.697 Test Loss: 0.800 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 18 cost time: 0.7357187271118164
Epoch: 18, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 0.7237038612365723
Epoch: 19, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.697 Vali Acc: 0.743 Test Loss: 0.697 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 20 cost time: 0.7526087760925293
Epoch: 20, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 21 cost time: 0.7213470935821533
Epoch: 21, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 0.6355922222137451
Epoch: 22, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.610 Vali Acc: 0.763 Test Loss: 0.610 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 0.722639799118042
Epoch: 23, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 0.8276712894439697
Epoch: 24, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 25 cost time: 0.6626224517822266
Epoch: 25, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8549118041992188
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 0.6781973838806152
Epoch: 27, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 28 cost time: 0.6594657897949219
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 0.6333131790161133
Epoch: 29, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 30 cost time: 0.8397586345672607
Epoch: 30, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 0.5794515609741211
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.536 Vali Acc: 0.803 Test Loss: 0.536 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 32 cost time: 0.5580871105194092
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 33 cost time: 0.5673375129699707
Epoch: 33, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7595725059509277
Epoch: 34, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7303268909454346
Epoch: 35, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 36 cost time: 0.6369509696960449
Epoch: 36, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6892151832580566
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.650 Vali Acc: 0.803 Test Loss: 0.650 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7093441486358643
Epoch: 38, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.656 Vali Acc: 0.796 Test Loss: 0.656 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.7319862842559814
Epoch: 39, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7644937038421631
Epoch: 40, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6132140159606934
Epoch: 41, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6993110179901123
Epoch: 42, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.755 Vali Acc: 0.796 Test Loss: 0.755 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7122890949249268
Epoch: 43, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.773 Vali Acc: 0.789 Test Loss: 0.773 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6792151927947998
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.833 Vali Acc: 0.803 Test Loss: 0.833 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.606217622756958
Epoch: 45, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.854 Vali Acc: 0.789 Test Loss: 0.854 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 28448
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.049663782119751
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.497 Vali Acc: 0.151 Test Loss: 1.497 Test Acc: 0.151
Validation loss decreased (inf --> -0.151301).  Saving model ...
Epoch: 2 cost time: 0.6149075031280518
Epoch: 2, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.485 Vali Acc: 0.151 Test Loss: 1.485 Test Acc: 0.151
Validation loss decreased (-0.151301 --> -0.151301).  Saving model ...
Epoch: 3 cost time: 0.5663402080535889
Epoch: 3, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.468 Vali Acc: 0.145 Test Loss: 1.468 Test Acc: 0.145
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5645349025726318
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.451 Vali Acc: 0.151 Test Loss: 1.451 Test Acc: 0.151
Validation loss decreased (-0.151301 --> -0.151301).  Saving model ...
Epoch: 5 cost time: 0.6925928592681885
Epoch: 5, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.430 Vali Acc: 0.178 Test Loss: 1.430 Test Acc: 0.178
Validation loss decreased (-0.151301 --> -0.177617).  Saving model ...
Epoch: 6 cost time: 0.6259841918945312
Epoch: 6, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.407 Vali Acc: 0.211 Test Loss: 1.407 Test Acc: 0.211
Validation loss decreased (-0.177617 --> -0.210512).  Saving model ...
Epoch: 7 cost time: 0.6205563545227051
Epoch: 7, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.381 Vali Acc: 0.257 Test Loss: 1.381 Test Acc: 0.257
Validation loss decreased (-0.210512 --> -0.256565).  Saving model ...
Epoch: 8 cost time: 0.5467536449432373
Epoch: 8, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.353 Vali Acc: 0.296 Test Loss: 1.353 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 9 cost time: 0.7589621543884277
Epoch: 9, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.325 Vali Acc: 0.355 Test Loss: 1.325 Test Acc: 0.355
Validation loss decreased (-0.296039 --> -0.355250).  Saving model ...
Epoch: 10 cost time: 0.6206338405609131
Epoch: 10, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.293 Vali Acc: 0.421 Test Loss: 1.293 Test Acc: 0.421
Validation loss decreased (-0.355250 --> -0.421040).  Saving model ...
Epoch: 11 cost time: 0.5853736400604248
Epoch: 11, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.259 Vali Acc: 0.414 Test Loss: 1.259 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5933821201324463
Epoch: 12, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.217 Vali Acc: 0.480 Test Loss: 1.217 Test Acc: 0.480
Validation loss decreased (-0.421040 --> -0.480251).  Saving model ...
Epoch: 13 cost time: 0.6024119853973389
Epoch: 13, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.173 Vali Acc: 0.507 Test Loss: 1.173 Test Acc: 0.507
Validation loss decreased (-0.480251 --> -0.506567).  Saving model ...
Epoch: 14 cost time: 0.6941866874694824
Epoch: 14, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.121 Vali Acc: 0.520 Test Loss: 1.121 Test Acc: 0.520
Validation loss decreased (-0.506567 --> -0.519726).  Saving model ...
Epoch: 15 cost time: 0.5554924011230469
Epoch: 15, Steps: 10 | Train Loss: 0.900 Vali Loss: 1.071 Vali Acc: 0.553 Test Loss: 1.071 Test Acc: 0.553
Validation loss decreased (-0.519726 --> -0.552621).  Saving model ...
Epoch: 16 cost time: 0.5885212421417236
Epoch: 16, Steps: 10 | Train Loss: 0.828 Vali Loss: 1.020 Vali Acc: 0.553 Test Loss: 1.020 Test Acc: 0.553
Validation loss decreased (-0.552621 --> -0.552621).  Saving model ...
Epoch: 17 cost time: 0.5963938236236572
Epoch: 17, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.970 Vali Acc: 0.586 Test Loss: 0.970 Test Acc: 0.586
Validation loss decreased (-0.552621 --> -0.585517).  Saving model ...
Epoch: 18 cost time: 0.6777591705322266
Epoch: 18, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.925 Vali Acc: 0.625 Test Loss: 0.925 Test Acc: 0.625
Validation loss decreased (-0.585517 --> -0.624991).  Saving model ...
Epoch: 19 cost time: 0.60202956199646
Epoch: 19, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.880 Vali Acc: 0.605 Test Loss: 0.880 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6553456783294678
Epoch: 20, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.844 Vali Acc: 0.638 Test Loss: 0.844 Test Acc: 0.638
Validation loss decreased (-0.624991 --> -0.638149).  Saving model ...
Epoch: 21 cost time: 0.7396335601806641
Epoch: 21, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.810 Vali Acc: 0.664 Test Loss: 0.810 Test Acc: 0.664
Validation loss decreased (-0.638149 --> -0.664466).  Saving model ...
Epoch: 22 cost time: 0.6350448131561279
Epoch: 22, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.782 Vali Acc: 0.684 Test Loss: 0.782 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 23 cost time: 0.6960444450378418
Epoch: 23, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.773 Vali Acc: 0.704 Test Loss: 0.773 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 24 cost time: 0.7741067409515381
Epoch: 24, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.752 Vali Acc: 0.704 Test Loss: 0.752 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 25 cost time: 0.6262228488922119
Epoch: 25, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.751 Vali Acc: 0.697 Test Loss: 0.751 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5817980766296387
Epoch: 26, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.742 Vali Acc: 0.717 Test Loss: 0.742 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 27 cost time: 0.7364060878753662
Epoch: 27, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.729 Vali Acc: 0.724 Test Loss: 0.729 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 28 cost time: 0.5773284435272217
Epoch: 28, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.723 Vali Acc: 0.730 Test Loss: 0.723 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 29 cost time: 0.8735365867614746
Epoch: 29, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.717 Vali Acc: 0.743 Test Loss: 0.717 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 30 cost time: 0.7992980480194092
Epoch: 30, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.724 Vali Acc: 0.724 Test Loss: 0.724 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.621779203414917
Epoch: 31, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.715 Vali Acc: 0.730 Test Loss: 0.715 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6352880001068115
Epoch: 32, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.697 Vali Acc: 0.737 Test Loss: 0.697 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5363197326660156
Epoch: 33, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6033594608306885
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.755 Vali Acc: 0.724 Test Loss: 0.755 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6498003005981445
Epoch: 35, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6609344482421875
Epoch: 36, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.785 Vali Acc: 0.737 Test Loss: 0.785 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8080780506134033
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.805 Vali Acc: 0.743 Test Loss: 0.805 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.6594622135162354
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.847 Vali Acc: 0.730 Test Loss: 0.847 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7425441741943359
Epoch: 39, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.887 Vali Acc: 0.737 Test Loss: 0.887 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.743421052631579
model parameter : 28444
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9190564155578613
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.455 Vali Acc: 0.184 Test Loss: 1.455 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 0.6821842193603516
Epoch: 2, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.442 Vali Acc: 0.217 Test Loss: 1.442 Test Acc: 0.217
Validation loss decreased (-0.184196 --> -0.217091).  Saving model ...
Epoch: 3 cost time: 0.6755290031433105
Epoch: 3, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.425 Vali Acc: 0.230 Test Loss: 1.425 Test Acc: 0.230
Validation loss decreased (-0.217091 --> -0.230249).  Saving model ...
Epoch: 4 cost time: 0.7217292785644531
Epoch: 4, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.406 Vali Acc: 0.250 Test Loss: 1.406 Test Acc: 0.250
Validation loss decreased (-0.230249 --> -0.249986).  Saving model ...
Epoch: 5 cost time: 0.6082966327667236
Epoch: 5, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.385 Vali Acc: 0.270 Test Loss: 1.385 Test Acc: 0.270
Validation loss decreased (-0.249986 --> -0.269723).  Saving model ...
Epoch: 6 cost time: 0.6431629657745361
Epoch: 6, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.362 Vali Acc: 0.289 Test Loss: 1.362 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 7 cost time: 0.6791586875915527
Epoch: 7, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.336 Vali Acc: 0.355 Test Loss: 1.336 Test Acc: 0.355
Validation loss decreased (-0.289460 --> -0.355250).  Saving model ...
Epoch: 8 cost time: 0.8576757907867432
Epoch: 8, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.309 Vali Acc: 0.428 Test Loss: 1.309 Test Acc: 0.428
Validation loss decreased (-0.355250 --> -0.427618).  Saving model ...
Epoch: 9 cost time: 0.8524198532104492
Epoch: 9, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
Validation loss decreased (-0.427618 --> -0.467092).  Saving model ...
Epoch: 10 cost time: 0.7391998767852783
Epoch: 10, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.241 Vali Acc: 0.480 Test Loss: 1.241 Test Acc: 0.480
Validation loss decreased (-0.467092 --> -0.480251).  Saving model ...
Epoch: 11 cost time: 0.686337947845459
Epoch: 11, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.195 Vali Acc: 0.526 Test Loss: 1.195 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 12 cost time: 0.6909966468811035
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.139 Vali Acc: 0.566 Test Loss: 1.139 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 13 cost time: 0.9180035591125488
Epoch: 13, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.073 Vali Acc: 0.599 Test Loss: 1.073 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 14 cost time: 0.7995810508728027
Epoch: 14, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.998 Vali Acc: 0.632 Test Loss: 0.998 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631569).  Saving model ...
Epoch: 15 cost time: 0.6356585025787354
Epoch: 15, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.920 Vali Acc: 0.625 Test Loss: 0.920 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.72066330909729
Epoch: 16, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.860 Vali Acc: 0.645 Test Loss: 0.860 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644728).  Saving model ...
Epoch: 17 cost time: 0.7045466899871826
Epoch: 17, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.823 Vali Acc: 0.658 Test Loss: 0.823 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657887).  Saving model ...
Epoch: 18 cost time: 0.688499927520752
Epoch: 18, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.781 Vali Acc: 0.671 Test Loss: 0.781 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 19 cost time: 0.6250860691070557
Epoch: 19, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.759 Vali Acc: 0.678 Test Loss: 0.759 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677624).  Saving model ...
Epoch: 20 cost time: 0.6232669353485107
Epoch: 20, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.749 Vali Acc: 0.684 Test Loss: 0.749 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 0.6418642997741699
Epoch: 21, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.728 Vali Acc: 0.691 Test Loss: 0.728 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 0.6690735816955566
Epoch: 22, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.713 Vali Acc: 0.691 Test Loss: 0.713 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 23 cost time: 0.5525555610656738
Epoch: 23, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.714 Vali Acc: 0.697 Test Loss: 0.714 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 24 cost time: 0.5607466697692871
Epoch: 24, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.709 Vali Acc: 0.684 Test Loss: 0.709 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6394989490509033
Epoch: 25, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.712 Vali Acc: 0.678 Test Loss: 0.712 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5918424129486084
Epoch: 26, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.723 Vali Acc: 0.691 Test Loss: 0.723 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6195650100708008
Epoch: 27, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 28 cost time: 0.9100091457366943
Epoch: 28, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.709 Vali Acc: 0.704 Test Loss: 0.709 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7492740154266357
Epoch: 29, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 30 cost time: 0.7108783721923828
Epoch: 30, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 31 cost time: 0.7573897838592529
Epoch: 31, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.753 Vali Acc: 0.724 Test Loss: 0.753 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 32 cost time: 0.6656546592712402
Epoch: 32, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.768 Vali Acc: 0.717 Test Loss: 0.768 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7409002780914307
Epoch: 33, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.779 Vali Acc: 0.724 Test Loss: 0.779 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7016017436981201
Epoch: 34, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.773 Vali Acc: 0.730 Test Loss: 0.773 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730255).  Saving model ...
Epoch: 35 cost time: 0.6801207065582275
Epoch: 35, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.823 Vali Acc: 0.730 Test Loss: 0.823 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6749014854431152
Epoch: 36, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.833 Vali Acc: 0.717 Test Loss: 0.833 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7286503314971924
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.810 Vali Acc: 0.743 Test Loss: 0.810 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743413).  Saving model ...
Epoch: 38 cost time: 0.7239794731140137
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.888 Vali Acc: 0.724 Test Loss: 0.888 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6741290092468262
Epoch: 39, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.901 Vali Acc: 0.711 Test Loss: 0.901 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8139145374298096
Epoch: 40, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.932 Vali Acc: 0.711 Test Loss: 0.932 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7652933597564697
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.946 Vali Acc: 0.717 Test Loss: 0.946 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9101848602294922
Epoch: 42, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.970 Vali Acc: 0.724 Test Loss: 0.970 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6399576663970947
Epoch: 43, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.029 Vali Acc: 0.717 Test Loss: 1.029 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6836364269256592
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 1.053 Vali Acc: 0.717 Test Loss: 1.053 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5955085754394531
Epoch: 45, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.055 Vali Acc: 0.724 Test Loss: 1.055 Test Acc: 0.724
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6769208908081055
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.097 Vali Acc: 0.717 Test Loss: 1.097 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6855309009552002
Epoch: 47, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.116 Vali Acc: 0.724 Test Loss: 1.116 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.743421052631579
model parameter : 28336
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2397706508636475
Epoch: 1, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.375 Vali Acc: 0.316 Test Loss: 1.375 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 0.7421236038208008
Epoch: 2, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.364 Vali Acc: 0.309 Test Loss: 1.364 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8067226409912109
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
Validation loss decreased (-0.315776 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 0.9203250408172607
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.329 Vali Acc: 0.368 Test Loss: 1.329 Test Acc: 0.368
Validation loss decreased (-0.342092 --> -0.368408).  Saving model ...
Epoch: 5 cost time: 0.8233060836791992
Epoch: 5, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.306 Vali Acc: 0.401 Test Loss: 1.306 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 0.790672779083252
Epoch: 6, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.281 Vali Acc: 0.441 Test Loss: 1.281 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 7 cost time: 0.6905722618103027
Epoch: 7, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.252 Vali Acc: 0.467 Test Loss: 1.252 Test Acc: 0.467
Validation loss decreased (-0.440777 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 0.7434391975402832
Epoch: 8, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.220 Vali Acc: 0.520 Test Loss: 1.220 Test Acc: 0.520
Validation loss decreased (-0.467093 --> -0.519725).  Saving model ...
Epoch: 9 cost time: 0.6844956874847412
Epoch: 9, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.182 Vali Acc: 0.572 Test Loss: 1.182 Test Acc: 0.572
Validation loss decreased (-0.519725 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 0.7309117317199707
Epoch: 10, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.134 Vali Acc: 0.566 Test Loss: 1.134 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8335602283477783
Epoch: 11, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.087 Vali Acc: 0.579 Test Loss: 1.087 Test Acc: 0.579
Validation loss decreased (-0.572357 --> -0.578937).  Saving model ...
Epoch: 12 cost time: 0.8051354885101318
Epoch: 12, Steps: 10 | Train Loss: 0.892 Vali Loss: 1.045 Vali Acc: 0.572 Test Loss: 1.045 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7655127048492432
Epoch: 13, Steps: 10 | Train Loss: 0.800 Vali Loss: 1.019 Vali Acc: 0.579 Test Loss: 1.019 Test Acc: 0.579
Validation loss decreased (-0.578937 --> -0.578937).  Saving model ...
Epoch: 14 cost time: 0.7439851760864258
Epoch: 14, Steps: 10 | Train Loss: 0.715 Vali Loss: 1.009 Vali Acc: 0.572 Test Loss: 1.009 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7197659015655518
Epoch: 15, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.986 Vali Acc: 0.572 Test Loss: 0.986 Test Acc: 0.572
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7055580615997314
Epoch: 16, Steps: 10 | Train Loss: 0.588 Vali Loss: 0.956 Vali Acc: 0.625 Test Loss: 0.956 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 17 cost time: 0.8728275299072266
Epoch: 17, Steps: 10 | Train Loss: 0.548 Vali Loss: 0.933 Vali Acc: 0.612 Test Loss: 0.933 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8361620903015137
Epoch: 18, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.917 Vali Acc: 0.638 Test Loss: 0.917 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 19 cost time: 0.7499339580535889
Epoch: 19, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.891 Vali Acc: 0.625 Test Loss: 0.891 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5764358043670654
Epoch: 20, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.892 Vali Acc: 0.658 Test Loss: 0.892 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657886).  Saving model ...
Epoch: 21 cost time: 0.6555213928222656
Epoch: 21, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.853 Vali Acc: 0.664 Test Loss: 0.853 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 22 cost time: 0.5310933589935303
Epoch: 22, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.871 Vali Acc: 0.664 Test Loss: 0.871 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6802151203155518
Epoch: 23, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.866 Vali Acc: 0.671 Test Loss: 0.866 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 24 cost time: 0.7660171985626221
Epoch: 24, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.852 Vali Acc: 0.664 Test Loss: 0.852 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7219347953796387
Epoch: 25, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.882 Vali Acc: 0.664 Test Loss: 0.882 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7182204723358154
Epoch: 26, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.888 Vali Acc: 0.678 Test Loss: 0.888 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677623).  Saving model ...
Epoch: 27 cost time: 0.6837794780731201
Epoch: 27, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.874 Vali Acc: 0.704 Test Loss: 0.874 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 28 cost time: 0.7183244228363037
Epoch: 28, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.918 Vali Acc: 0.704 Test Loss: 0.918 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7391738891601562
Epoch: 29, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.907 Vali Acc: 0.711 Test Loss: 0.907 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710517).  Saving model ...
Epoch: 30 cost time: 0.6295993328094482
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.945 Vali Acc: 0.730 Test Loss: 0.945 Test Acc: 0.730
Validation loss decreased (-0.710517 --> -0.730254).  Saving model ...
Epoch: 31 cost time: 0.7028789520263672
Epoch: 31, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.977 Vali Acc: 0.704 Test Loss: 0.977 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7172105312347412
Epoch: 32, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.996 Vali Acc: 0.717 Test Loss: 0.996 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8365025520324707
Epoch: 33, Steps: 10 | Train Loss: 0.094 Vali Loss: 1.008 Vali Acc: 0.724 Test Loss: 1.008 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7432854175567627
Epoch: 34, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.057 Vali Acc: 0.737 Test Loss: 1.057 Test Acc: 0.737
Validation loss decreased (-0.730254 --> -0.736832).  Saving model ...
Epoch: 35 cost time: 0.6147327423095703
Epoch: 35, Steps: 10 | Train Loss: 0.074 Vali Loss: 1.126 Vali Acc: 0.730 Test Loss: 1.126 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6048696041107178
Epoch: 36, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.116 Vali Acc: 0.730 Test Loss: 1.116 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6883602142333984
Epoch: 37, Steps: 10 | Train Loss: 0.061 Vali Loss: 1.153 Vali Acc: 0.724 Test Loss: 1.153 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8254060745239258
Epoch: 38, Steps: 10 | Train Loss: 0.051 Vali Loss: 1.216 Vali Acc: 0.724 Test Loss: 1.216 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7006649971008301
Epoch: 39, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.240 Vali Acc: 0.711 Test Loss: 1.240 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6790316104888916
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.320 Vali Acc: 0.717 Test Loss: 1.320 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8301794528961182
Epoch: 41, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.349 Vali Acc: 0.717 Test Loss: 1.349 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7057459354400635
Epoch: 42, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.398 Vali Acc: 0.717 Test Loss: 1.398 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6934981346130371
Epoch: 43, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.473 Vali Acc: 0.717 Test Loss: 1.473 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.865760326385498
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.512 Vali Acc: 0.724 Test Loss: 1.512 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm256_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7368421052631579
model parameter : 28478
model size : 0.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.038760185241699
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.444 Vali Acc: 0.276 Test Loss: 1.444 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 0.6260862350463867
Epoch: 2, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.433 Vali Acc: 0.283 Test Loss: 1.433 Test Acc: 0.283
Validation loss decreased (-0.276301 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 0.6605746746063232
Epoch: 3, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.417 Vali Acc: 0.322 Test Loss: 1.417 Test Acc: 0.322
Validation loss decreased (-0.282880 --> -0.322354).  Saving model ...
Epoch: 4 cost time: 0.796698808670044
Epoch: 4, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.399 Vali Acc: 0.329 Test Loss: 1.399 Test Acc: 0.329
Validation loss decreased (-0.322354 --> -0.328933).  Saving model ...
Epoch: 5 cost time: 0.6650786399841309
Epoch: 5, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.379 Vali Acc: 0.342 Test Loss: 1.379 Test Acc: 0.342
Validation loss decreased (-0.328933 --> -0.342091).  Saving model ...
Epoch: 6 cost time: 0.7076971530914307
Epoch: 6, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.357 Vali Acc: 0.362 Test Loss: 1.357 Test Acc: 0.362
Validation loss decreased (-0.342091 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.7561883926391602
Epoch: 7, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368408).  Saving model ...
Epoch: 8 cost time: 0.8878188133239746
Epoch: 8, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.313 Vali Acc: 0.421 Test Loss: 1.313 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 9 cost time: 0.7041239738464355
Epoch: 9, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.289 Vali Acc: 0.441 Test Loss: 1.289 Test Acc: 0.441
Validation loss decreased (-0.421040 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 0.7773218154907227
Epoch: 10, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.264 Vali Acc: 0.428 Test Loss: 1.264 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7558403015136719
Epoch: 11, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.235 Vali Acc: 0.434 Test Loss: 1.235 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.87992262840271
Epoch: 12, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.205 Vali Acc: 0.461 Test Loss: 1.205 Test Acc: 0.461
Validation loss decreased (-0.440777 --> -0.460514).  Saving model ...
Epoch: 13 cost time: 0.6901586055755615
Epoch: 13, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.173 Vali Acc: 0.487 Test Loss: 1.173 Test Acc: 0.487
Validation loss decreased (-0.460514 --> -0.486830).  Saving model ...
Epoch: 14 cost time: 0.9049668312072754
Epoch: 14, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.137 Vali Acc: 0.566 Test Loss: 1.137 Test Acc: 0.566
Validation loss decreased (-0.486830 --> -0.565778).  Saving model ...
Epoch: 15 cost time: 0.7815582752227783
Epoch: 15, Steps: 10 | Train Loss: 1.023 Vali Loss: 1.102 Vali Acc: 0.579 Test Loss: 1.102 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578936).  Saving model ...
Epoch: 16 cost time: 0.7023301124572754
Epoch: 16, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.059 Vali Acc: 0.599 Test Loss: 1.059 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598674).  Saving model ...
Epoch: 17 cost time: 0.7592301368713379
Epoch: 17, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.014 Vali Acc: 0.625 Test Loss: 1.014 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.6766929626464844
Epoch: 18, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.974 Vali Acc: 0.612 Test Loss: 0.974 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7992229461669922
Epoch: 19, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.931 Vali Acc: 0.632 Test Loss: 0.931 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631570).  Saving model ...
Epoch: 20 cost time: 0.8362331390380859
Epoch: 20, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.889 Vali Acc: 0.645 Test Loss: 0.889 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 21 cost time: 0.6919975280761719
Epoch: 21, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.849 Vali Acc: 0.658 Test Loss: 0.849 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657886).  Saving model ...
Epoch: 22 cost time: 0.8305461406707764
Epoch: 22, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.818 Vali Acc: 0.658 Test Loss: 0.818 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657887).  Saving model ...
Epoch: 23 cost time: 0.7012825012207031
Epoch: 23, Steps: 10 | Train Loss: 0.571 Vali Loss: 0.807 Vali Acc: 0.651 Test Loss: 0.807 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7481608390808105
Epoch: 24, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.774 Vali Acc: 0.671 Test Loss: 0.774 Test Acc: 0.671
Validation loss decreased (-0.657887 --> -0.671045).  Saving model ...
Epoch: 25 cost time: 0.6819207668304443
Epoch: 25, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.751 Vali Acc: 0.697 Test Loss: 0.751 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 26 cost time: 0.7593472003936768
Epoch: 26, Steps: 10 | Train Loss: 0.452 Vali Loss: 0.735 Vali Acc: 0.717 Test Loss: 0.735 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 27 cost time: 0.6744215488433838
Epoch: 27, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 28 cost time: 0.6334059238433838
Epoch: 28, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 29 cost time: 0.6348705291748047
Epoch: 29, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 30 cost time: 0.5710935592651367
Epoch: 30, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.685565710067749
Epoch: 31, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.649 Vali Acc: 0.757 Test Loss: 0.649 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 32 cost time: 0.6801273822784424
Epoch: 32, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.640 Vali Acc: 0.763 Test Loss: 0.640 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 33 cost time: 0.8229610919952393
Epoch: 33, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 34 cost time: 0.7406089305877686
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 35 cost time: 0.6712188720703125
Epoch: 35, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6058337688446045
Epoch: 36, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6263728141784668
Epoch: 37, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.635 Vali Acc: 0.770 Test Loss: 0.635 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5948574542999268
Epoch: 38, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5551979541778564
Epoch: 39, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.679 Vali Acc: 0.757 Test Loss: 0.679 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6875588893890381
Epoch: 40, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 41 cost time: 0.7311394214630127
Epoch: 41, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6484198570251465
Epoch: 42, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.738 Vali Acc: 0.776 Test Loss: 0.738 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6656315326690674
Epoch: 43, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.765 Vali Acc: 0.770 Test Loss: 0.765 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7297852039337158
Epoch: 44, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.807 Vali Acc: 0.770 Test Loss: 0.807 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8842928409576416
Epoch: 45, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.822 Vali Acc: 0.770 Test Loss: 0.822 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6540656089782715
Epoch: 46, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.886 Vali Acc: 0.757 Test Loss: 0.886 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.698552131652832
Epoch: 47, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.900 Vali Acc: 0.763 Test Loss: 0.900 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7361853122711182
Epoch: 48, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.939 Vali Acc: 0.757 Test Loss: 0.939 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7907936573028564
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.999 Vali Acc: 0.757 Test Loss: 0.999 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.8506271839141846
Epoch: 50, Steps: 10 | Train Loss: 0.029 Vali Loss: 1.036 Vali Acc: 0.750 Test Loss: 1.036 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 9552
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1367061138153076
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.481 Vali Acc: 0.197 Test Loss: 1.481 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 0.6534028053283691
Epoch: 2, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.468 Vali Acc: 0.204 Test Loss: 1.468 Test Acc: 0.204
Validation loss decreased (-0.197354 --> -0.203933).  Saving model ...
Epoch: 3 cost time: 0.7621064186096191
Epoch: 3, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.451 Vali Acc: 0.211 Test Loss: 1.451 Test Acc: 0.211
Validation loss decreased (-0.203933 --> -0.210512).  Saving model ...
Epoch: 4 cost time: 0.6769280433654785
Epoch: 4, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.431 Vali Acc: 0.237 Test Loss: 1.431 Test Acc: 0.237
Validation loss decreased (-0.210512 --> -0.236828).  Saving model ...
Epoch: 5 cost time: 0.7150802612304688
Epoch: 5, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.410 Vali Acc: 0.237 Test Loss: 1.410 Test Acc: 0.237
Validation loss decreased (-0.236828 --> -0.236828).  Saving model ...
Epoch: 6 cost time: 0.6623828411102295
Epoch: 6, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.387 Vali Acc: 0.250 Test Loss: 1.387 Test Acc: 0.250
Validation loss decreased (-0.236828 --> -0.249986).  Saving model ...
Epoch: 7 cost time: 0.590787410736084
Epoch: 7, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.364 Vali Acc: 0.303 Test Loss: 1.364 Test Acc: 0.303
Validation loss decreased (-0.249986 --> -0.302618).  Saving model ...
Epoch: 8 cost time: 0.7711982727050781
Epoch: 8, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.339 Vali Acc: 0.336 Test Loss: 1.339 Test Acc: 0.336
Validation loss decreased (-0.302618 --> -0.335513).  Saving model ...
Epoch: 9 cost time: 0.6942176818847656
Epoch: 9, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.315 Vali Acc: 0.362 Test Loss: 1.315 Test Acc: 0.362
Validation loss decreased (-0.335513 --> -0.361829).  Saving model ...
Epoch: 10 cost time: 0.7451968193054199
Epoch: 10, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.289 Vali Acc: 0.355 Test Loss: 1.289 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7235672473907471
Epoch: 11, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.263 Vali Acc: 0.382 Test Loss: 1.263 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 12 cost time: 0.6211860179901123
Epoch: 12, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.234 Vali Acc: 0.454 Test Loss: 1.234 Test Acc: 0.454
Validation loss decreased (-0.381566 --> -0.453935).  Saving model ...
Epoch: 13 cost time: 0.8061892986297607
Epoch: 13, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.204 Vali Acc: 0.507 Test Loss: 1.204 Test Acc: 0.507
Validation loss decreased (-0.453935 --> -0.506567).  Saving model ...
Epoch: 14 cost time: 0.7074108123779297
Epoch: 14, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.170 Vali Acc: 0.553 Test Loss: 1.170 Test Acc: 0.553
Validation loss decreased (-0.506567 --> -0.552620).  Saving model ...
Epoch: 15 cost time: 0.6943821907043457
Epoch: 15, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.134 Vali Acc: 0.566 Test Loss: 1.134 Test Acc: 0.566
Validation loss decreased (-0.552620 --> -0.565778).  Saving model ...
Epoch: 16 cost time: 0.6456103324890137
Epoch: 16, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.091 Vali Acc: 0.599 Test Loss: 1.091 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 17 cost time: 0.6165924072265625
Epoch: 17, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.042 Vali Acc: 0.638 Test Loss: 1.042 Test Acc: 0.638
Validation loss decreased (-0.598673 --> -0.638147).  Saving model ...
Epoch: 18 cost time: 0.6649703979492188
Epoch: 18, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.989 Vali Acc: 0.651 Test Loss: 0.989 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 19 cost time: 0.6448559761047363
Epoch: 19, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.930 Vali Acc: 0.645 Test Loss: 0.930 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6660752296447754
Epoch: 20, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.882 Vali Acc: 0.638 Test Loss: 0.882 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.693173885345459
Epoch: 21, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.846 Vali Acc: 0.645 Test Loss: 0.846 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8400485515594482
Epoch: 22, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.823 Vali Acc: 0.645 Test Loss: 0.823 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6350603103637695
Epoch: 23, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.802 Vali Acc: 0.632 Test Loss: 0.802 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6782879829406738
Epoch: 24, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.806 Vali Acc: 0.638 Test Loss: 0.806 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6246860027313232
Epoch: 25, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.777 Vali Acc: 0.645 Test Loss: 0.777 Test Acc: 0.645
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6101124286651611
Epoch: 26, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.780 Vali Acc: 0.645 Test Loss: 0.780 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7009701728820801
Epoch: 27, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.798 Vali Acc: 0.638 Test Loss: 0.798 Test Acc: 0.638
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.766089677810669
Epoch: 28, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.780 Vali Acc: 0.651 Test Loss: 0.780 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651308).  Saving model ...
Epoch: 29 cost time: 0.8423471450805664
Epoch: 29, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.783 Vali Acc: 0.651 Test Loss: 0.783 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6796438694000244
Epoch: 30, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.802 Vali Acc: 0.632 Test Loss: 0.802 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.70361328125
Epoch: 31, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.808 Vali Acc: 0.632 Test Loss: 0.808 Test Acc: 0.632
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.706223726272583
Epoch: 32, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.797 Vali Acc: 0.645 Test Loss: 0.797 Test Acc: 0.645
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.7119522094726562
Epoch: 33, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.823 Vali Acc: 0.645 Test Loss: 0.823 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7226309776306152
Epoch: 34, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.788 Vali Acc: 0.671 Test Loss: 0.788 Test Acc: 0.671
Validation loss decreased (-0.651308 --> -0.671045).  Saving model ...
Epoch: 35 cost time: 0.6598715782165527
Epoch: 35, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.813 Vali Acc: 0.671 Test Loss: 0.813 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7000038623809814
Epoch: 36, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.820 Vali Acc: 0.658 Test Loss: 0.820 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7327027320861816
Epoch: 37, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.825 Vali Acc: 0.671 Test Loss: 0.825 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7457242012023926
Epoch: 38, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.841 Vali Acc: 0.664 Test Loss: 0.841 Test Acc: 0.664
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6632263660430908
Epoch: 39, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.852 Vali Acc: 0.664 Test Loss: 0.852 Test Acc: 0.664
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7376072406768799
Epoch: 40, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.876 Vali Acc: 0.678 Test Loss: 0.876 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677623).  Saving model ...
Epoch: 41 cost time: 0.588815450668335
Epoch: 41, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.924 Vali Acc: 0.664 Test Loss: 0.924 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7104849815368652
Epoch: 42, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.896 Vali Acc: 0.671 Test Loss: 0.896 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6938872337341309
Epoch: 43, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.903 Vali Acc: 0.678 Test Loss: 0.903 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5546040534973145
Epoch: 44, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.937 Vali Acc: 0.671 Test Loss: 0.937 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.709160566329956
Epoch: 45, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.935 Vali Acc: 0.684 Test Loss: 0.935 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684201).  Saving model ...
Epoch: 46 cost time: 0.733708381652832
Epoch: 46, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.963 Vali Acc: 0.697 Test Loss: 0.963 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697359).  Saving model ...
Epoch: 47 cost time: 0.5857131481170654
Epoch: 47, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.985 Vali Acc: 0.691 Test Loss: 0.985 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6823925971984863
Epoch: 48, Steps: 10 | Train Loss: 0.087 Vali Loss: 1.008 Vali Acc: 0.697 Test Loss: 1.008 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7787814140319824
Epoch: 49, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.040 Vali Acc: 0.697 Test Loss: 1.040 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6584181785583496
Epoch: 50, Steps: 10 | Train Loss: 0.078 Vali Loss: 1.052 Vali Acc: 0.697 Test Loss: 1.052 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6470296382904053
Epoch: 51, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.109 Vali Acc: 0.697 Test Loss: 1.109 Test Acc: 0.697
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6362454891204834
Epoch: 52, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.117 Vali Acc: 0.711 Test Loss: 1.117 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710515).  Saving model ...
Epoch: 53 cost time: 0.5523500442504883
Epoch: 53, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.167 Vali Acc: 0.711 Test Loss: 1.167 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6582422256469727
Epoch: 54, Steps: 10 | Train Loss: 0.053 Vali Loss: 1.205 Vali Acc: 0.704 Test Loss: 1.205 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.6498467922210693
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.235 Vali Acc: 0.691 Test Loss: 1.235 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6176581382751465
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 1.278 Vali Acc: 0.704 Test Loss: 1.278 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.6682815551757812
Epoch: 57, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.313 Vali Acc: 0.704 Test Loss: 1.313 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.8285882472991943
Epoch: 58, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.366 Vali Acc: 0.697 Test Loss: 1.366 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6236851215362549
Epoch: 59, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.362 Vali Acc: 0.691 Test Loss: 1.362 Test Acc: 0.691
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.6731424331665039
Epoch: 60, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.439 Vali Acc: 0.711 Test Loss: 1.439 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.8105940818786621
Epoch: 61, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.466 Vali Acc: 0.711 Test Loss: 1.466 Test Acc: 0.711
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.7458908557891846
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.510 Vali Acc: 0.704 Test Loss: 1.510 Test Acc: 0.704
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7105263157894737
model parameter : 9246
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0849063396453857
Epoch: 1, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.381 Vali Acc: 0.303 Test Loss: 1.381 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.798454999923706
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.370 Vali Acc: 0.309 Test Loss: 1.370 Test Acc: 0.309
Validation loss decreased (-0.302618 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.6770460605621338
Epoch: 3, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.357 Vali Acc: 0.309 Test Loss: 1.357 Test Acc: 0.309
Validation loss decreased (-0.309197 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.6944432258605957
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.341 Vali Acc: 0.349 Test Loss: 1.341 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.6820816993713379
Epoch: 5, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.324 Vali Acc: 0.362 Test Loss: 1.324 Test Acc: 0.362
Validation loss decreased (-0.348671 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 0.7836742401123047
Epoch: 6, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.306 Vali Acc: 0.401 Test Loss: 1.306 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 7 cost time: 0.6894025802612305
Epoch: 7, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.286 Vali Acc: 0.414 Test Loss: 1.286 Test Acc: 0.414
Validation loss decreased (-0.401303 --> -0.414461).  Saving model ...
Epoch: 8 cost time: 0.7128727436065674
Epoch: 8, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 9 cost time: 0.5806014537811279
Epoch: 9, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.241 Vali Acc: 0.474 Test Loss: 1.241 Test Acc: 0.474
Validation loss decreased (-0.427619 --> -0.473672).  Saving model ...
Epoch: 10 cost time: 0.6647427082061768
Epoch: 10, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.217 Vali Acc: 0.493 Test Loss: 1.217 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 0.6914341449737549
Epoch: 11, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.192 Vali Acc: 0.520 Test Loss: 1.192 Test Acc: 0.520
Validation loss decreased (-0.493409 --> -0.519725).  Saving model ...
Epoch: 12 cost time: 0.652167558670044
Epoch: 12, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.165 Vali Acc: 0.559 Test Loss: 1.165 Test Acc: 0.559
Validation loss decreased (-0.519725 --> -0.559199).  Saving model ...
Epoch: 13 cost time: 0.6043813228607178
Epoch: 13, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.136 Vali Acc: 0.572 Test Loss: 1.136 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 14 cost time: 0.6535458564758301
Epoch: 14, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.102 Vali Acc: 0.586 Test Loss: 1.102 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 15 cost time: 0.7091681957244873
Epoch: 15, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.067 Vali Acc: 0.599 Test Loss: 1.067 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 16 cost time: 0.7717711925506592
Epoch: 16, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.029 Vali Acc: 0.618 Test Loss: 1.029 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618411).  Saving model ...
Epoch: 17 cost time: 0.7840962409973145
Epoch: 17, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.986 Vali Acc: 0.625 Test Loss: 0.986 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624990).  Saving model ...
Epoch: 18 cost time: 0.7542595863342285
Epoch: 18, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.940 Vali Acc: 0.638 Test Loss: 0.940 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 19 cost time: 0.7448673248291016
Epoch: 19, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.895 Vali Acc: 0.651 Test Loss: 0.895 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 20 cost time: 0.661017656326294
Epoch: 20, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 21 cost time: 0.7232742309570312
Epoch: 21, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.814 Vali Acc: 0.697 Test Loss: 0.814 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697360).  Saving model ...
Epoch: 22 cost time: 0.771432638168335
Epoch: 22, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.780 Vali Acc: 0.697 Test Loss: 0.780 Test Acc: 0.697
Validation loss decreased (-0.697360 --> -0.697361).  Saving model ...
Epoch: 23 cost time: 0.7685978412628174
Epoch: 23, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.747 Vali Acc: 0.684 Test Loss: 0.747 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8675839900970459
Epoch: 24, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.715 Vali Acc: 0.684 Test Loss: 0.715 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6358568668365479
Epoch: 25, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 26 cost time: 0.6107282638549805
Epoch: 26, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 27 cost time: 0.6177620887756348
Epoch: 27, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.645 Vali Acc: 0.730 Test Loss: 0.645 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6800410747528076
Epoch: 28, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.628 Vali Acc: 0.724 Test Loss: 0.628 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6418719291687012
Epoch: 29, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.616 Vali Acc: 0.730 Test Loss: 0.616 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6890549659729004
Epoch: 30, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.606 Vali Acc: 0.730 Test Loss: 0.606 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.47856807708740234
Epoch: 31, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.604 Vali Acc: 0.730 Test Loss: 0.604 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5518147945404053
Epoch: 32, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.585 Vali Acc: 0.724 Test Loss: 0.585 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5674772262573242
Epoch: 33, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 34 cost time: 0.6950185298919678
Epoch: 34, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 35 cost time: 0.7209360599517822
Epoch: 35, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.585 Vali Acc: 0.743 Test Loss: 0.585 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 36 cost time: 0.6694233417510986
Epoch: 36, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 37 cost time: 0.5929956436157227
Epoch: 37, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 38 cost time: 0.6191279888153076
Epoch: 38, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7326562404632568
Epoch: 39, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6617827415466309
Epoch: 40, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.643 Vali Acc: 0.750 Test Loss: 0.643 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8085627555847168
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8074541091918945
Epoch: 42, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7285807132720947
Epoch: 43, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6616795063018799
Epoch: 44, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.733 Vali Acc: 0.770 Test Loss: 0.733 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.665621280670166
Epoch: 45, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.883772611618042
Epoch: 46, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.790 Vali Acc: 0.763 Test Loss: 0.790 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6571846008300781
Epoch: 47, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.810 Vali Acc: 0.763 Test Loss: 0.810 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 9196
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1626641750335693
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.458 Vali Acc: 0.224 Test Loss: 1.458 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 0.7231466770172119
Epoch: 2, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
Validation loss decreased (-0.223670 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 0.6635663509368896
Epoch: 3, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.431 Vali Acc: 0.276 Test Loss: 1.431 Test Acc: 0.276
Validation loss decreased (-0.243407 --> -0.276301).  Saving model ...
Epoch: 4 cost time: 0.6310324668884277
Epoch: 4, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.413 Vali Acc: 0.296 Test Loss: 1.413 Test Acc: 0.296
Validation loss decreased (-0.276301 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 0.5640761852264404
Epoch: 5, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.391 Vali Acc: 0.309 Test Loss: 1.391 Test Acc: 0.309
Validation loss decreased (-0.296039 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 0.6882224082946777
Epoch: 6, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.370 Vali Acc: 0.336 Test Loss: 1.370 Test Acc: 0.336
Validation loss decreased (-0.309197 --> -0.335513).  Saving model ...
Epoch: 7 cost time: 0.7937297821044922
Epoch: 7, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.347 Vali Acc: 0.349 Test Loss: 1.347 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 8 cost time: 0.6901814937591553
Epoch: 8, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.321 Vali Acc: 0.368 Test Loss: 1.321 Test Acc: 0.368
Validation loss decreased (-0.348671 --> -0.368408).  Saving model ...
Epoch: 9 cost time: 0.6506166458129883
Epoch: 9, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.297 Vali Acc: 0.421 Test Loss: 1.297 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 10 cost time: 0.6666595935821533
Epoch: 10, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.271 Vali Acc: 0.434 Test Loss: 1.271 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 11 cost time: 0.6422977447509766
Epoch: 11, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.243 Vali Acc: 0.474 Test Loss: 1.243 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 12 cost time: 0.6612386703491211
Epoch: 12, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.213 Vali Acc: 0.487 Test Loss: 1.213 Test Acc: 0.487
Validation loss decreased (-0.473672 --> -0.486830).  Saving model ...
Epoch: 13 cost time: 0.5994658470153809
Epoch: 13, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.184 Vali Acc: 0.520 Test Loss: 1.184 Test Acc: 0.520
Validation loss decreased (-0.486830 --> -0.519725).  Saving model ...
Epoch: 14 cost time: 1.0224037170410156
Epoch: 14, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.153 Vali Acc: 0.553 Test Loss: 1.153 Test Acc: 0.553
Validation loss decreased (-0.519725 --> -0.552620).  Saving model ...
Epoch: 15 cost time: 0.7745060920715332
Epoch: 15, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.119 Vali Acc: 0.586 Test Loss: 1.119 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 16 cost time: 0.6047606468200684
Epoch: 16, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.085 Vali Acc: 0.572 Test Loss: 1.085 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7031097412109375
Epoch: 17, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.051 Vali Acc: 0.599 Test Loss: 1.051 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 18 cost time: 0.6967072486877441
Epoch: 18, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.013 Vali Acc: 0.618 Test Loss: 1.013 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618411).  Saving model ...
Epoch: 19 cost time: 0.6316051483154297
Epoch: 19, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.974 Vali Acc: 0.632 Test Loss: 0.974 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 20 cost time: 0.7672789096832275
Epoch: 20, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.935 Vali Acc: 0.612 Test Loss: 0.935 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.727449893951416
Epoch: 21, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.900 Vali Acc: 0.645 Test Loss: 0.900 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644728).  Saving model ...
Epoch: 22 cost time: 0.7456128597259521
Epoch: 22, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.862 Vali Acc: 0.651 Test Loss: 0.862 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651307).  Saving model ...
Epoch: 23 cost time: 0.675668478012085
Epoch: 23, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.833 Vali Acc: 0.658 Test Loss: 0.833 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 24 cost time: 0.6206417083740234
Epoch: 24, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.802 Vali Acc: 0.645 Test Loss: 0.802 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6065945625305176
Epoch: 25, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.779 Vali Acc: 0.664 Test Loss: 0.779 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664466).  Saving model ...
Epoch: 26 cost time: 0.5618488788604736
Epoch: 26, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.757 Vali Acc: 0.697 Test Loss: 0.757 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 27 cost time: 0.6676971912384033
Epoch: 27, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.737 Vali Acc: 0.717 Test Loss: 0.737 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 28 cost time: 0.7948927879333496
Epoch: 28, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.722 Vali Acc: 0.730 Test Loss: 0.722 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 29 cost time: 0.7783639430999756
Epoch: 29, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.808971643447876
Epoch: 30, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.702 Vali Acc: 0.724 Test Loss: 0.702 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7358729839324951
Epoch: 31, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.686 Vali Acc: 0.737 Test Loss: 0.686 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 32 cost time: 0.5914411544799805
Epoch: 32, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.688 Vali Acc: 0.730 Test Loss: 0.688 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.609163761138916
Epoch: 33, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.674 Vali Acc: 0.737 Test Loss: 0.674 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 34 cost time: 0.7460157871246338
Epoch: 34, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 35 cost time: 0.6750948429107666
Epoch: 35, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 36 cost time: 0.761505126953125
Epoch: 36, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736835).  Saving model ...
Epoch: 37 cost time: 0.6252362728118896
Epoch: 37, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 38 cost time: 0.609236478805542
Epoch: 38, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6766159534454346
Epoch: 39, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.654268741607666
Epoch: 40, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.669 Vali Acc: 0.763 Test Loss: 0.669 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763151).  Saving model ...
Epoch: 41 cost time: 0.7043437957763672
Epoch: 41, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.655 Vali Acc: 0.750 Test Loss: 0.655 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6594860553741455
Epoch: 42, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7359669208526611
Epoch: 43, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6644203662872314
Epoch: 44, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7456982135772705
Epoch: 45, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.681 Vali Acc: 0.770 Test Loss: 0.681 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 46 cost time: 0.6523940563201904
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.704 Vali Acc: 0.757 Test Loss: 0.704 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7478182315826416
Epoch: 47, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.7734076976776123
Epoch: 48, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0426239967346191
Epoch: 49, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776309).  Saving model ...
Epoch: 50 cost time: 0.7257030010223389
Epoch: 50, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 51 cost time: 0.8187723159790039
Epoch: 51, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7353119850158691
Epoch: 52, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.750 Vali Acc: 0.770 Test Loss: 0.750 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6335265636444092
Epoch: 53, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.763 Vali Acc: 0.783 Test Loss: 0.763 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6197705268859863
Epoch: 54, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.791 Vali Acc: 0.776 Test Loss: 0.791 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.5710587501525879
Epoch: 55, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5928776264190674
Epoch: 56, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.7440285682678223
Epoch: 57, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.843 Vali Acc: 0.783 Test Loss: 0.843 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.7606358528137207
Epoch: 58, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.7257630825042725
Epoch: 59, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.876 Vali Acc: 0.783 Test Loss: 0.876 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6626150608062744
Epoch: 60, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.880 Vali Acc: 0.783 Test Loss: 0.880 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 9030
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.260528564453125
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.455 Vali Acc: 0.243 Test Loss: 1.455 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.6300520896911621
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.444 Vali Acc: 0.257 Test Loss: 1.444 Test Acc: 0.257
Validation loss decreased (-0.243407 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 0.6398799419403076
Epoch: 3, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.429 Vali Acc: 0.289 Test Loss: 1.429 Test Acc: 0.289
Validation loss decreased (-0.256565 --> -0.289459).  Saving model ...
Epoch: 4 cost time: 0.6537890434265137
Epoch: 4, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.412 Vali Acc: 0.296 Test Loss: 1.412 Test Acc: 0.296
Validation loss decreased (-0.289459 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 0.6362452507019043
Epoch: 5, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.393 Vali Acc: 0.296 Test Loss: 1.393 Test Acc: 0.296
Validation loss decreased (-0.296039 --> -0.296039).  Saving model ...
Epoch: 6 cost time: 0.72003173828125
Epoch: 6, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.372 Vali Acc: 0.322 Test Loss: 1.372 Test Acc: 0.322
Validation loss decreased (-0.296039 --> -0.322355).  Saving model ...
Epoch: 7 cost time: 0.7074108123779297
Epoch: 7, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.351 Vali Acc: 0.362 Test Loss: 1.351 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 8 cost time: 0.8942070007324219
Epoch: 8, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.328 Vali Acc: 0.382 Test Loss: 1.328 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 9 cost time: 0.7419180870056152
Epoch: 9, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.302 Vali Acc: 0.421 Test Loss: 1.302 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 10 cost time: 0.5717353820800781
Epoch: 10, Steps: 10 | Train Loss: 1.166 Vali Loss: 1.277 Vali Acc: 0.421 Test Loss: 1.277 Test Acc: 0.421
Validation loss decreased (-0.421040 --> -0.421040).  Saving model ...
Epoch: 11 cost time: 0.6682162284851074
Epoch: 11, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.247 Vali Acc: 0.434 Test Loss: 1.247 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 12 cost time: 0.6601881980895996
Epoch: 12, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.215 Vali Acc: 0.487 Test Loss: 1.215 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 13 cost time: 0.7014579772949219
Epoch: 13, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.180 Vali Acc: 0.513 Test Loss: 1.180 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513146).  Saving model ...
Epoch: 14 cost time: 0.8224637508392334
Epoch: 14, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.142 Vali Acc: 0.533 Test Loss: 1.142 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532883).  Saving model ...
Epoch: 15 cost time: 0.7222459316253662
Epoch: 15, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.105 Vali Acc: 0.566 Test Loss: 1.105 Test Acc: 0.566
Validation loss decreased (-0.532883 --> -0.565778).  Saving model ...
Epoch: 16 cost time: 0.6945509910583496
Epoch: 16, Steps: 10 | Train Loss: 0.843 Vali Loss: 1.067 Vali Acc: 0.566 Test Loss: 1.067 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565779).  Saving model ...
Epoch: 17 cost time: 0.6274700164794922
Epoch: 17, Steps: 10 | Train Loss: 0.839 Vali Loss: 1.030 Vali Acc: 0.559 Test Loss: 1.030 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7265677452087402
Epoch: 18, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.992 Vali Acc: 0.579 Test Loss: 0.992 Test Acc: 0.579
Validation loss decreased (-0.565779 --> -0.578937).  Saving model ...
Epoch: 19 cost time: 0.6715841293334961
Epoch: 19, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.962 Vali Acc: 0.605 Test Loss: 0.962 Test Acc: 0.605
Validation loss decreased (-0.578937 --> -0.605254).  Saving model ...
Epoch: 20 cost time: 0.8071079254150391
Epoch: 20, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.936 Vali Acc: 0.618 Test Loss: 0.936 Test Acc: 0.618
Validation loss decreased (-0.605254 --> -0.618412).  Saving model ...
Epoch: 21 cost time: 0.7143261432647705
Epoch: 21, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.914 Vali Acc: 0.625 Test Loss: 0.914 Test Acc: 0.625
Validation loss decreased (-0.618412 --> -0.624991).  Saving model ...
Epoch: 22 cost time: 0.6653778553009033
Epoch: 22, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.893 Vali Acc: 0.618 Test Loss: 0.893 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7681515216827393
Epoch: 23, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.876 Vali Acc: 0.651 Test Loss: 0.876 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651307).  Saving model ...
Epoch: 24 cost time: 0.7940645217895508
Epoch: 24, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.856 Vali Acc: 0.664 Test Loss: 0.856 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 25 cost time: 0.9497036933898926
Epoch: 25, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.838 Vali Acc: 0.658 Test Loss: 0.838 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8957257270812988
Epoch: 26, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.823 Vali Acc: 0.664 Test Loss: 0.823 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664465).  Saving model ...
Epoch: 27 cost time: 0.7650003433227539
Epoch: 27, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.817 Vali Acc: 0.691 Test Loss: 0.817 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 28 cost time: 0.8425235748291016
Epoch: 28, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.800 Vali Acc: 0.684 Test Loss: 0.800 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6160085201263428
Epoch: 29, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.787 Vali Acc: 0.697 Test Loss: 0.787 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 30 cost time: 0.7883012294769287
Epoch: 30, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.787 Vali Acc: 0.711 Test Loss: 0.787 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710518).  Saving model ...
Epoch: 31 cost time: 0.7627007961273193
Epoch: 31, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 32 cost time: 0.727104902267456
Epoch: 32, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.775 Vali Acc: 0.697 Test Loss: 0.775 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.647972583770752
Epoch: 33, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.776 Vali Acc: 0.704 Test Loss: 0.776 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7441344261169434
Epoch: 34, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.805 Vali Acc: 0.691 Test Loss: 0.805 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6358606815338135
Epoch: 35, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.796 Vali Acc: 0.730 Test Loss: 0.796 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 36 cost time: 0.761218786239624
Epoch: 36, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.793 Vali Acc: 0.730 Test Loss: 0.793 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730255).  Saving model ...
Epoch: 37 cost time: 0.5966963768005371
Epoch: 37, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.800 Vali Acc: 0.724 Test Loss: 0.800 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8111469745635986
Epoch: 38, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.806 Vali Acc: 0.711 Test Loss: 0.806 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7483336925506592
Epoch: 39, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.818 Vali Acc: 0.730 Test Loss: 0.818 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7185485363006592
Epoch: 40, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.818 Vali Acc: 0.730 Test Loss: 0.818 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7393524646759033
Epoch: 41, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.841 Vali Acc: 0.724 Test Loss: 0.841 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6454470157623291
Epoch: 42, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.855 Vali Acc: 0.737 Test Loss: 0.855 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 43 cost time: 0.5454189777374268
Epoch: 43, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.882 Vali Acc: 0.724 Test Loss: 0.882 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5440351963043213
Epoch: 44, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.901 Vali Acc: 0.717 Test Loss: 0.901 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.7510221004486084
Epoch: 45, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.911 Vali Acc: 0.730 Test Loss: 0.911 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.651425838470459
Epoch: 46, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.928 Vali Acc: 0.743 Test Loss: 0.928 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743412).  Saving model ...
Epoch: 47 cost time: 0.6398684978485107
Epoch: 47, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.950 Vali Acc: 0.750 Test Loss: 0.950 Test Acc: 0.750
Validation loss decreased (-0.743412 --> -0.749990).  Saving model ...
Epoch: 48 cost time: 0.7693359851837158
Epoch: 48, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.989 Vali Acc: 0.743 Test Loss: 0.989 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6991469860076904
Epoch: 49, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.017 Vali Acc: 0.743 Test Loss: 1.017 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6672735214233398
Epoch: 50, Steps: 10 | Train Loss: 0.050 Vali Loss: 1.043 Vali Acc: 0.737 Test Loss: 1.043 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.0605547428131104
Epoch: 51, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.079 Vali Acc: 0.743 Test Loss: 1.079 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.750985860824585
Epoch: 52, Steps: 10 | Train Loss: 0.047 Vali Loss: 1.122 Vali Acc: 0.730 Test Loss: 1.122 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8998568058013916
Epoch: 53, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.130 Vali Acc: 0.717 Test Loss: 1.130 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6586942672729492
Epoch: 54, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.162 Vali Acc: 0.730 Test Loss: 1.162 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6295778751373291
Epoch: 55, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.191 Vali Acc: 0.730 Test Loss: 1.191 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6802339553833008
Epoch: 56, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.235 Vali Acc: 0.730 Test Loss: 1.235 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6673388481140137
Epoch: 57, Steps: 10 | Train Loss: 0.026 Vali Loss: 1.266 Vali Acc: 0.743 Test Loss: 1.266 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.75
model parameter : 8992
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1541779041290283
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.378 Vali Acc: 0.355 Test Loss: 1.378 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 0.6501820087432861
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.367 Vali Acc: 0.368 Test Loss: 1.367 Test Acc: 0.368
Validation loss decreased (-0.355249 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 0.8152501583099365
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.352 Vali Acc: 0.382 Test Loss: 1.352 Test Acc: 0.382
Validation loss decreased (-0.368407 --> -0.381565).  Saving model ...
Epoch: 4 cost time: 0.7428290843963623
Epoch: 4, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.334 Vali Acc: 0.401 Test Loss: 1.334 Test Acc: 0.401
Validation loss decreased (-0.381565 --> -0.401302).  Saving model ...
Epoch: 5 cost time: 0.660466194152832
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.315 Vali Acc: 0.421 Test Loss: 1.315 Test Acc: 0.421
Validation loss decreased (-0.401302 --> -0.421039).  Saving model ...
Epoch: 6 cost time: 0.6774227619171143
Epoch: 6, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.296 Vali Acc: 0.467 Test Loss: 1.296 Test Acc: 0.467
Validation loss decreased (-0.421039 --> -0.467092).  Saving model ...
Epoch: 7 cost time: 0.6848609447479248
Epoch: 7, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.274 Vali Acc: 0.487 Test Loss: 1.274 Test Acc: 0.487
Validation loss decreased (-0.467092 --> -0.486829).  Saving model ...
Epoch: 8 cost time: 0.7431764602661133
Epoch: 8, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.253 Vali Acc: 0.513 Test Loss: 1.253 Test Acc: 0.513
Validation loss decreased (-0.486829 --> -0.513145).  Saving model ...
Epoch: 9 cost time: 0.6601402759552002
Epoch: 9, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.230 Vali Acc: 0.539 Test Loss: 1.230 Test Acc: 0.539
Validation loss decreased (-0.513145 --> -0.539461).  Saving model ...
Epoch: 10 cost time: 0.807621955871582
Epoch: 10, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.207 Vali Acc: 0.572 Test Loss: 1.207 Test Acc: 0.572
Validation loss decreased (-0.539461 --> -0.572356).  Saving model ...
Epoch: 11 cost time: 0.8305041790008545
Epoch: 11, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.179 Vali Acc: 0.586 Test Loss: 1.179 Test Acc: 0.586
Validation loss decreased (-0.572356 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 0.6745684146881104
Epoch: 12, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.154 Vali Acc: 0.586 Test Loss: 1.154 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 13 cost time: 0.5721211433410645
Epoch: 13, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.124 Vali Acc: 0.559 Test Loss: 1.124 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7434074878692627
Epoch: 14, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.093 Vali Acc: 0.586 Test Loss: 1.093 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 15 cost time: 0.7109560966491699
Epoch: 15, Steps: 10 | Train Loss: 0.941 Vali Loss: 1.060 Vali Acc: 0.592 Test Loss: 1.060 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 16 cost time: 0.6865313053131104
Epoch: 16, Steps: 10 | Train Loss: 0.896 Vali Loss: 1.029 Vali Acc: 0.592 Test Loss: 1.029 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592095).  Saving model ...
Epoch: 17 cost time: 0.6052751541137695
Epoch: 17, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.988 Vali Acc: 0.605 Test Loss: 0.988 Test Acc: 0.605
Validation loss decreased (-0.592095 --> -0.605253).  Saving model ...
Epoch: 18 cost time: 0.6416356563568115
Epoch: 18, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.943 Vali Acc: 0.612 Test Loss: 0.943 Test Acc: 0.612
Validation loss decreased (-0.605253 --> -0.611833).  Saving model ...
Epoch: 19 cost time: 0.5739362239837646
Epoch: 19, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.898 Vali Acc: 0.632 Test Loss: 0.898 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 20 cost time: 0.6478636264801025
Epoch: 20, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.850 Vali Acc: 0.645 Test Loss: 0.850 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 21 cost time: 0.6748831272125244
Epoch: 21, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.805 Vali Acc: 0.671 Test Loss: 0.805 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671045).  Saving model ...
Epoch: 22 cost time: 0.6615264415740967
Epoch: 22, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.765 Vali Acc: 0.671 Test Loss: 0.765 Test Acc: 0.671
Validation loss decreased (-0.671045 --> -0.671045).  Saving model ...
Epoch: 23 cost time: 0.6286122798919678
Epoch: 23, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.756 Vali Acc: 0.697 Test Loss: 0.756 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 24 cost time: 0.6906580924987793
Epoch: 24, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.732 Vali Acc: 0.697 Test Loss: 0.732 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 25 cost time: 0.7283163070678711
Epoch: 25, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 26 cost time: 0.7619502544403076
Epoch: 26, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.700 Vali Acc: 0.743 Test Loss: 0.700 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 27 cost time: 0.6556637287139893
Epoch: 27, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 28 cost time: 0.6265411376953125
Epoch: 28, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.687 Vali Acc: 0.730 Test Loss: 0.687 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7170991897583008
Epoch: 29, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 30 cost time: 0.8426163196563721
Epoch: 30, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6407554149627686
Epoch: 31, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.671 Vali Acc: 0.776 Test Loss: 0.671 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776309).  Saving model ...
Epoch: 32 cost time: 0.932009220123291
Epoch: 32, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 33 cost time: 0.7668979167938232
Epoch: 33, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.666 Vali Acc: 0.796 Test Loss: 0.666 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 34 cost time: 0.7950351238250732
Epoch: 34, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7956647872924805
Epoch: 35, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.656 Vali Acc: 0.783 Test Loss: 0.656 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6719422340393066
Epoch: 36, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6501555442810059
Epoch: 37, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.763603925704956
Epoch: 38, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.6553592681884766
Epoch: 39, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.696 Vali Acc: 0.783 Test Loss: 0.696 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7499761581420898
Epoch: 40, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.709 Vali Acc: 0.789 Test Loss: 0.709 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.6339519023895264
Epoch: 41, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.723 Vali Acc: 0.783 Test Loss: 0.723 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5980679988861084
Epoch: 42, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 43 cost time: 0.5149943828582764
Epoch: 43, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.762 Vali Acc: 0.796 Test Loss: 0.762 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6111998558044434
Epoch: 44, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.786 Vali Acc: 0.776 Test Loss: 0.786 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5961239337921143
Epoch: 45, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.805 Vali Acc: 0.789 Test Loss: 0.805 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6474130153656006
Epoch: 46, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.821 Vali Acc: 0.770 Test Loss: 0.821 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6420812606811523
Epoch: 47, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.854 Vali Acc: 0.776 Test Loss: 0.854 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6067278385162354
Epoch: 48, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.893 Vali Acc: 0.776 Test Loss: 0.893 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6469306945800781
Epoch: 49, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.914 Vali Acc: 0.783 Test Loss: 0.914 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.7955007553100586
Epoch: 50, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.926 Vali Acc: 0.770 Test Loss: 0.926 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6793293952941895
Epoch: 51, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.989 Vali Acc: 0.783 Test Loss: 0.989 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6962132453918457
Epoch: 52, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.992 Vali Acc: 0.763 Test Loss: 0.992 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 9052
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1783745288848877
Epoch: 1, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.372 Vali Acc: 0.230 Test Loss: 1.372 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 0.7902681827545166
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.362 Vali Acc: 0.243 Test Loss: 1.362 Test Acc: 0.243
Validation loss decreased (-0.230249 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 0.7799797058105469
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.348 Vali Acc: 0.250 Test Loss: 1.348 Test Acc: 0.250
Validation loss decreased (-0.243407 --> -0.249987).  Saving model ...
Epoch: 4 cost time: 0.8003063201904297
Epoch: 4, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.332 Vali Acc: 0.296 Test Loss: 1.332 Test Acc: 0.296
Validation loss decreased (-0.249987 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 1.1060991287231445
Epoch: 5, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.314 Vali Acc: 0.336 Test Loss: 1.314 Test Acc: 0.336
Validation loss decreased (-0.296039 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 0.6305744647979736
Epoch: 6, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 0.7052018642425537
Epoch: 7, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.273 Vali Acc: 0.401 Test Loss: 1.273 Test Acc: 0.401
Validation loss decreased (-0.374987 --> -0.401303).  Saving model ...
Epoch: 8 cost time: 0.7523648738861084
Epoch: 8, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.401303 --> -0.467093).  Saving model ...
Epoch: 9 cost time: 0.6731033325195312
Epoch: 9, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.228 Vali Acc: 0.487 Test Loss: 1.228 Test Acc: 0.487
Validation loss decreased (-0.467093 --> -0.486830).  Saving model ...
Epoch: 10 cost time: 0.7058589458465576
Epoch: 10, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.204 Vali Acc: 0.566 Test Loss: 1.204 Test Acc: 0.566
Validation loss decreased (-0.486830 --> -0.565777).  Saving model ...
Epoch: 11 cost time: 0.5999870300292969
Epoch: 11, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.180 Vali Acc: 0.592 Test Loss: 1.180 Test Acc: 0.592
Validation loss decreased (-0.565777 --> -0.592093).  Saving model ...
Epoch: 12 cost time: 0.6405863761901855
Epoch: 12, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.155 Vali Acc: 0.592 Test Loss: 1.155 Test Acc: 0.592
Validation loss decreased (-0.592093 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 0.6190981864929199
Epoch: 13, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.129 Vali Acc: 0.612 Test Loss: 1.129 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 14 cost time: 0.7157857418060303
Epoch: 14, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.101 Vali Acc: 0.632 Test Loss: 1.101 Test Acc: 0.632
Validation loss decreased (-0.611831 --> -0.631568).  Saving model ...
Epoch: 15 cost time: 0.6495535373687744
Epoch: 15, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.072 Vali Acc: 0.645 Test Loss: 1.072 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644726).  Saving model ...
Epoch: 16 cost time: 0.8635270595550537
Epoch: 16, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.040 Vali Acc: 0.658 Test Loss: 1.040 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657884).  Saving model ...
Epoch: 17 cost time: 0.6816227436065674
Epoch: 17, Steps: 10 | Train Loss: 0.858 Vali Loss: 1.006 Vali Acc: 0.638 Test Loss: 1.006 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6842710971832275
Epoch: 18, Steps: 10 | Train Loss: 0.809 Vali Loss: 0.970 Vali Acc: 0.632 Test Loss: 0.970 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6393828392028809
Epoch: 19, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.935 Vali Acc: 0.638 Test Loss: 0.935 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.75815749168396
Epoch: 20, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.894 Vali Acc: 0.651 Test Loss: 0.894 Test Acc: 0.651
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7293250560760498
Epoch: 21, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.849 Vali Acc: 0.664 Test Loss: 0.849 Test Acc: 0.664
Validation loss decreased (-0.657884 --> -0.664465).  Saving model ...
Epoch: 22 cost time: 0.9289932250976562
Epoch: 22, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.801 Vali Acc: 0.684 Test Loss: 0.801 Test Acc: 0.684
Validation loss decreased (-0.664465 --> -0.684203).  Saving model ...
Epoch: 23 cost time: 0.7502820491790771
Epoch: 23, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.769 Vali Acc: 0.678 Test Loss: 0.769 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.79477858543396
Epoch: 24, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.735 Vali Acc: 0.691 Test Loss: 0.735 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 25 cost time: 0.7455959320068359
Epoch: 25, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.703 Vali Acc: 0.704 Test Loss: 0.703 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 26 cost time: 0.690471887588501
Epoch: 26, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.672 Vali Acc: 0.704 Test Loss: 0.672 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703941).  Saving model ...
Epoch: 27 cost time: 0.7060630321502686
Epoch: 27, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.703941 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 0.7612385749816895
Epoch: 28, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.627 Vali Acc: 0.724 Test Loss: 0.627 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7936370372772217
Epoch: 29, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.608 Vali Acc: 0.730 Test Loss: 0.608 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7531075477600098
Epoch: 30, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 0.7729580402374268
Epoch: 31, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8237700462341309
Epoch: 32, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.593 Vali Acc: 0.743 Test Loss: 0.593 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6306972503662109
Epoch: 33, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.593 Vali Acc: 0.743 Test Loss: 0.593 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7176790237426758
Epoch: 34, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.593 Vali Acc: 0.724 Test Loss: 0.593 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6706833839416504
Epoch: 35, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6279296875
Epoch: 36, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.618340015411377
Epoch: 37, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.609 Vali Acc: 0.730 Test Loss: 0.609 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7167596817016602
Epoch: 38, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.5842940807342529
Epoch: 39, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 40 cost time: 0.7654035091400146
Epoch: 40, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.617 Vali Acc: 0.743 Test Loss: 0.617 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.614290714263916
Epoch: 41, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6416842937469482
Epoch: 42, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6501560211181641
Epoch: 43, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7834885120391846
Epoch: 44, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.660 Vali Acc: 0.750 Test Loss: 0.660 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6877284049987793
Epoch: 45, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.682 Vali Acc: 0.757 Test Loss: 0.682 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6267642974853516
Epoch: 46, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6474874019622803
Epoch: 47, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.700 Vali Acc: 0.763 Test Loss: 0.700 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5684182643890381
Epoch: 48, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.739 Vali Acc: 0.743 Test Loss: 0.739 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7082667350769043
Epoch: 49, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.762 Vali Acc: 0.737 Test Loss: 0.762 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 9008
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.134727954864502
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.458 Vali Acc: 0.243 Test Loss: 1.458 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 0.6264240741729736
Epoch: 2, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.447 Vali Acc: 0.257 Test Loss: 1.447 Test Acc: 0.257
Validation loss decreased (-0.243406 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 0.6353695392608643
Epoch: 3, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.432 Vali Acc: 0.296 Test Loss: 1.432 Test Acc: 0.296
Validation loss decreased (-0.256564 --> -0.296038).  Saving model ...
Epoch: 4 cost time: 0.5946526527404785
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.414 Vali Acc: 0.322 Test Loss: 1.414 Test Acc: 0.322
Validation loss decreased (-0.296038 --> -0.322354).  Saving model ...
Epoch: 5 cost time: 0.573927640914917
Epoch: 5, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.395 Vali Acc: 0.322 Test Loss: 1.395 Test Acc: 0.322
Validation loss decreased (-0.322354 --> -0.322354).  Saving model ...
Epoch: 6 cost time: 0.6671543121337891
Epoch: 6, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.373 Vali Acc: 0.336 Test Loss: 1.373 Test Acc: 0.336
Validation loss decreased (-0.322354 --> -0.335513).  Saving model ...
Epoch: 7 cost time: 0.6037533283233643
Epoch: 7, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.351 Vali Acc: 0.395 Test Loss: 1.351 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394723).  Saving model ...
Epoch: 8 cost time: 0.6190328598022461
Epoch: 8, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.328 Vali Acc: 0.408 Test Loss: 1.328 Test Acc: 0.408
Validation loss decreased (-0.394723 --> -0.407881).  Saving model ...
Epoch: 9 cost time: 0.6009860038757324
Epoch: 9, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.302 Vali Acc: 0.401 Test Loss: 1.302 Test Acc: 0.401
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.573298454284668
Epoch: 10, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.277 Vali Acc: 0.434 Test Loss: 1.277 Test Acc: 0.434
Validation loss decreased (-0.407881 --> -0.434198).  Saving model ...
Epoch: 11 cost time: 0.6487879753112793
Epoch: 11, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.250 Vali Acc: 0.487 Test Loss: 1.250 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 12 cost time: 0.6405019760131836
Epoch: 12, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.224 Vali Acc: 0.493 Test Loss: 1.224 Test Acc: 0.493
Validation loss decreased (-0.486830 --> -0.493409).  Saving model ...
Epoch: 13 cost time: 0.5893290042877197
Epoch: 13, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.196 Vali Acc: 0.500 Test Loss: 1.196 Test Acc: 0.500
Validation loss decreased (-0.493409 --> -0.499988).  Saving model ...
Epoch: 14 cost time: 0.6233053207397461
Epoch: 14, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.165 Vali Acc: 0.520 Test Loss: 1.165 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519725).  Saving model ...
Epoch: 15 cost time: 0.5490500926971436
Epoch: 15, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.131 Vali Acc: 0.572 Test Loss: 1.131 Test Acc: 0.572
Validation loss decreased (-0.519725 --> -0.572357).  Saving model ...
Epoch: 16 cost time: 0.536323070526123
Epoch: 16, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.094 Vali Acc: 0.572 Test Loss: 1.094 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572357).  Saving model ...
Epoch: 17 cost time: 0.6445653438568115
Epoch: 17, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.053 Vali Acc: 0.572 Test Loss: 1.053 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572358).  Saving model ...
Epoch: 18 cost time: 0.55301833152771
Epoch: 18, Steps: 10 | Train Loss: 0.851 Vali Loss: 1.009 Vali Acc: 0.625 Test Loss: 1.009 Test Acc: 0.625
Validation loss decreased (-0.572358 --> -0.624990).  Saving model ...
Epoch: 19 cost time: 0.5446076393127441
Epoch: 19, Steps: 10 | Train Loss: 0.767 Vali Loss: 0.964 Vali Acc: 0.592 Test Loss: 0.964 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.601069450378418
Epoch: 20, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.933 Vali Acc: 0.586 Test Loss: 0.933 Test Acc: 0.586
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5720782279968262
Epoch: 21, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.910 Vali Acc: 0.625 Test Loss: 0.910 Test Acc: 0.625
Validation loss decreased (-0.624990 --> -0.624991).  Saving model ...
Epoch: 22 cost time: 0.5734682083129883
Epoch: 22, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.883 Vali Acc: 0.618 Test Loss: 0.883 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.47267580032348633
Epoch: 23, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.872 Vali Acc: 0.605 Test Loss: 0.872 Test Acc: 0.605
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.63936448097229
Epoch: 24, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.830 Vali Acc: 0.618 Test Loss: 0.830 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6468477249145508
Epoch: 25, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.812 Vali Acc: 0.625 Test Loss: 0.812 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624992).  Saving model ...
Epoch: 26 cost time: 0.5208048820495605
Epoch: 26, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.784 Vali Acc: 0.638 Test Loss: 0.784 Test Acc: 0.638
Validation loss decreased (-0.624992 --> -0.638150).  Saving model ...
Epoch: 27 cost time: 0.6783509254455566
Epoch: 27, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.761 Vali Acc: 0.671 Test Loss: 0.761 Test Acc: 0.671
Validation loss decreased (-0.638150 --> -0.671045).  Saving model ...
Epoch: 28 cost time: 0.5211086273193359
Epoch: 28, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.755 Vali Acc: 0.691 Test Loss: 0.755 Test Acc: 0.691
Validation loss decreased (-0.671045 --> -0.690782).  Saving model ...
Epoch: 29 cost time: 0.5481889247894287
Epoch: 29, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.738 Vali Acc: 0.658 Test Loss: 0.738 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5649793148040771
Epoch: 30, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.732 Vali Acc: 0.671 Test Loss: 0.732 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7608771324157715
Epoch: 31, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.709 Vali Acc: 0.697 Test Loss: 0.709 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 32 cost time: 0.7794394493103027
Epoch: 32, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.706 Vali Acc: 0.697 Test Loss: 0.706 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 33 cost time: 0.6950492858886719
Epoch: 33, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.711 Vali Acc: 0.704 Test Loss: 0.711 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 34 cost time: 0.6454882621765137
Epoch: 34, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.687 Vali Acc: 0.704 Test Loss: 0.687 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703941).  Saving model ...
Epoch: 35 cost time: 0.580906867980957
Epoch: 35, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.719 Vali Acc: 0.717 Test Loss: 0.719 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717098).  Saving model ...
Epoch: 36 cost time: 0.6360597610473633
Epoch: 36, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.694 Vali Acc: 0.691 Test Loss: 0.694 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5780434608459473
Epoch: 37, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.697 Vali Acc: 0.717 Test Loss: 0.697 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717098).  Saving model ...
Epoch: 38 cost time: 0.8181991577148438
Epoch: 38, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.692 Vali Acc: 0.697 Test Loss: 0.692 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6739163398742676
Epoch: 39, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.705 Vali Acc: 0.717 Test Loss: 0.705 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7750430107116699
Epoch: 40, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.708 Vali Acc: 0.730 Test Loss: 0.708 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 41 cost time: 0.6247580051422119
Epoch: 41, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.677 Vali Acc: 0.704 Test Loss: 0.677 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6714761257171631
Epoch: 42, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.691 Vali Acc: 0.724 Test Loss: 0.691 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5798025131225586
Epoch: 43, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.686 Vali Acc: 0.724 Test Loss: 0.686 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6263577938079834
Epoch: 44, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.741 Vali Acc: 0.704 Test Loss: 0.741 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6025714874267578
Epoch: 45, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.706 Vali Acc: 0.737 Test Loss: 0.706 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 46 cost time: 0.563744068145752
Epoch: 46, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.682 Vali Acc: 0.711 Test Loss: 0.682 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6920104026794434
Epoch: 47, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.713 Vali Acc: 0.743 Test Loss: 0.713 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 48 cost time: 0.594806432723999
Epoch: 48, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.690 Vali Acc: 0.717 Test Loss: 0.690 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5798964500427246
Epoch: 49, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.695 Vali Acc: 0.724 Test Loss: 0.695 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5761301517486572
Epoch: 50, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.702 Vali Acc: 0.704 Test Loss: 0.702 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.6241858005523682
Epoch: 51, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.729 Vali Acc: 0.737 Test Loss: 0.729 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6085255146026611
Epoch: 52, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.720 Vali Acc: 0.704 Test Loss: 0.720 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6362996101379395
Epoch: 53, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749992).  Saving model ...
Epoch: 54 cost time: 0.6389038562774658
Epoch: 54, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6844983100891113
Epoch: 55, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.713 Vali Acc: 0.743 Test Loss: 0.713 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6658389568328857
Epoch: 56, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.728 Vali Acc: 0.737 Test Loss: 0.728 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5830152034759521
Epoch: 57, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.754 Vali Acc: 0.750 Test Loss: 0.754 Test Acc: 0.750
Validation loss decreased (-0.749992 --> -0.749992).  Saving model ...
Epoch: 58 cost time: 0.5919537544250488
Epoch: 58, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.758 Vali Acc: 0.743 Test Loss: 0.758 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6320967674255371
Epoch: 59, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.758 Vali Acc: 0.730 Test Loss: 0.758 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6601309776306152
Epoch: 60, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.787 Vali Acc: 0.743 Test Loss: 0.787 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7067756652832031
Epoch: 61, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.794 Vali Acc: 0.743 Test Loss: 0.794 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6046888828277588
Epoch: 62, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
Validation loss decreased (-0.749992 --> -0.763150).  Saving model ...
Epoch: 63 cost time: 0.6212201118469238
Epoch: 63, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.829 Vali Acc: 0.737 Test Loss: 0.829 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5739455223083496
Epoch: 64, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.863 Vali Acc: 0.770 Test Loss: 0.863 Test Acc: 0.770
Validation loss decreased (-0.763150 --> -0.769728).  Saving model ...
Epoch: 65 cost time: 0.5128207206726074
Epoch: 65, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.857 Vali Acc: 0.757 Test Loss: 0.857 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8112642765045166
Epoch: 66, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.865 Vali Acc: 0.757 Test Loss: 0.865 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.6975255012512207
Epoch: 67, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.922 Vali Acc: 0.737 Test Loss: 0.922 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.826016902923584
Epoch: 68, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.888 Vali Acc: 0.763 Test Loss: 0.888 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6897809505462646
Epoch: 69, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.898 Vali Acc: 0.757 Test Loss: 0.898 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.5577666759490967
Epoch: 70, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.929 Vali Acc: 0.743 Test Loss: 0.929 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5314242839813232
Epoch: 71, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.913 Vali Acc: 0.750 Test Loss: 0.913 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.5280201435089111
Epoch: 72, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.974 Vali Acc: 0.743 Test Loss: 0.974 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.6352822780609131
Epoch: 73, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.982 Vali Acc: 0.750 Test Loss: 0.982 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.6166946887969971
Epoch: 74, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.016 Vali Acc: 0.737 Test Loss: 1.016 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm128_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 9214
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2081031799316406
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.462 Vali Acc: 0.263 Test Loss: 1.462 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 0.6735715866088867
Epoch: 2, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.453 Vali Acc: 0.263 Test Loss: 1.453 Test Acc: 0.263
Validation loss decreased (-0.263143 --> -0.263143).  Saving model ...
Epoch: 3 cost time: 0.7138729095458984
Epoch: 3, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
Validation loss decreased (-0.263143 --> -0.269722).  Saving model ...
Epoch: 4 cost time: 0.7383725643157959
Epoch: 4, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
Validation loss decreased (-0.269722 --> -0.289459).  Saving model ...
Epoch: 5 cost time: 0.7232992649078369
Epoch: 5, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.408 Vali Acc: 0.303 Test Loss: 1.408 Test Acc: 0.303
Validation loss decreased (-0.289459 --> -0.302618).  Saving model ...
Epoch: 6 cost time: 0.6637094020843506
Epoch: 6, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.390 Vali Acc: 0.309 Test Loss: 1.390 Test Acc: 0.309
Validation loss decreased (-0.302618 --> -0.309197).  Saving model ...
Epoch: 7 cost time: 0.6069455146789551
Epoch: 7, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.371 Vali Acc: 0.322 Test Loss: 1.371 Test Acc: 0.322
Validation loss decreased (-0.309197 --> -0.322355).  Saving model ...
Epoch: 8 cost time: 0.5739102363586426
Epoch: 8, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 9 cost time: 0.6322684288024902
Epoch: 9, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.329 Vali Acc: 0.342 Test Loss: 1.329 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5431768894195557
Epoch: 10, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.307 Vali Acc: 0.408 Test Loss: 1.307 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 11 cost time: 0.6426401138305664
Epoch: 11, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.283 Vali Acc: 0.421 Test Loss: 1.283 Test Acc: 0.421
Validation loss decreased (-0.407882 --> -0.421040).  Saving model ...
Epoch: 12 cost time: 0.669994592666626
Epoch: 12, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.260 Vali Acc: 0.434 Test Loss: 1.260 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 13 cost time: 0.7009067535400391
Epoch: 13, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.237 Vali Acc: 0.454 Test Loss: 1.237 Test Acc: 0.454
Validation loss decreased (-0.434198 --> -0.453935).  Saving model ...
Epoch: 14 cost time: 0.5573732852935791
Epoch: 14, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.212 Vali Acc: 0.480 Test Loss: 1.212 Test Acc: 0.480
Validation loss decreased (-0.453935 --> -0.480251).  Saving model ...
Epoch: 15 cost time: 0.6540682315826416
Epoch: 15, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.184 Vali Acc: 0.500 Test Loss: 1.184 Test Acc: 0.500
Validation loss decreased (-0.480251 --> -0.499988).  Saving model ...
Epoch: 16 cost time: 0.543349027633667
Epoch: 16, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.156 Vali Acc: 0.520 Test Loss: 1.156 Test Acc: 0.520
Validation loss decreased (-0.499988 --> -0.519725).  Saving model ...
Epoch: 17 cost time: 0.45033812522888184
Epoch: 17, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.126 Vali Acc: 0.533 Test Loss: 1.126 Test Acc: 0.533
Validation loss decreased (-0.519725 --> -0.532883).  Saving model ...
Epoch: 18 cost time: 0.7823314666748047
Epoch: 18, Steps: 10 | Train Loss: 0.958 Vali Loss: 1.095 Vali Acc: 0.539 Test Loss: 1.095 Test Acc: 0.539
Validation loss decreased (-0.532883 --> -0.539463).  Saving model ...
Epoch: 19 cost time: 0.6541633605957031
Epoch: 19, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.061 Vali Acc: 0.553 Test Loss: 1.061 Test Acc: 0.553
Validation loss decreased (-0.539463 --> -0.552621).  Saving model ...
Epoch: 20 cost time: 0.7873122692108154
Epoch: 20, Steps: 10 | Train Loss: 0.861 Vali Loss: 1.028 Vali Acc: 0.579 Test Loss: 1.028 Test Acc: 0.579
Validation loss decreased (-0.552621 --> -0.578937).  Saving model ...
Epoch: 21 cost time: 0.6677165031433105
Epoch: 21, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.994 Vali Acc: 0.592 Test Loss: 0.994 Test Acc: 0.592
Validation loss decreased (-0.578937 --> -0.592095).  Saving model ...
Epoch: 22 cost time: 0.7134127616882324
Epoch: 22, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.961 Vali Acc: 0.618 Test Loss: 0.961 Test Acc: 0.618
Validation loss decreased (-0.592095 --> -0.618411).  Saving model ...
Epoch: 23 cost time: 0.6851050853729248
Epoch: 23, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.931 Vali Acc: 0.612 Test Loss: 0.931 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8858771324157715
Epoch: 24, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.904 Vali Acc: 0.625 Test Loss: 0.904 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624991).  Saving model ...
Epoch: 25 cost time: 0.6453132629394531
Epoch: 25, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.884 Vali Acc: 0.625 Test Loss: 0.884 Test Acc: 0.625
Validation loss decreased (-0.624991 --> -0.624991).  Saving model ...
Epoch: 26 cost time: 0.7868008613586426
Epoch: 26, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.864 Vali Acc: 0.618 Test Loss: 0.864 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.673717737197876
Epoch: 27, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.850 Vali Acc: 0.632 Test Loss: 0.850 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631570).  Saving model ...
Epoch: 28 cost time: 0.6998100280761719
Epoch: 28, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.837 Vali Acc: 0.651 Test Loss: 0.837 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 29 cost time: 0.6045620441436768
Epoch: 29, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.830 Vali Acc: 0.645 Test Loss: 0.830 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6380834579467773
Epoch: 30, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.825 Vali Acc: 0.638 Test Loss: 0.825 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7658257484436035
Epoch: 31, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.812 Vali Acc: 0.658 Test Loss: 0.812 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 32 cost time: 0.6111676692962646
Epoch: 32, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.798 Vali Acc: 0.684 Test Loss: 0.798 Test Acc: 0.684
Validation loss decreased (-0.657887 --> -0.684203).  Saving model ...
Epoch: 33 cost time: 0.7036178112030029
Epoch: 33, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.787 Vali Acc: 0.684 Test Loss: 0.787 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 34 cost time: 0.6020948886871338
Epoch: 34, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.777 Vali Acc: 0.704 Test Loss: 0.777 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 35 cost time: 0.6189086437225342
Epoch: 35, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.777 Vali Acc: 0.691 Test Loss: 0.777 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5357851982116699
Epoch: 36, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.777 Vali Acc: 0.697 Test Loss: 0.777 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5259950160980225
Epoch: 37, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.771 Vali Acc: 0.684 Test Loss: 0.771 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5986142158508301
Epoch: 38, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.779 Vali Acc: 0.678 Test Loss: 0.779 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7167630195617676
Epoch: 39, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.783 Vali Acc: 0.678 Test Loss: 0.783 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6896824836730957
Epoch: 40, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.783 Vali Acc: 0.678 Test Loss: 0.783 Test Acc: 0.678
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.5661413669586182
Epoch: 41, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.778 Vali Acc: 0.691 Test Loss: 0.778 Test Acc: 0.691
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.6360681056976318
Epoch: 42, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.793 Vali Acc: 0.697 Test Loss: 0.793 Test Acc: 0.697
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.643409252166748
Epoch: 43, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.793 Vali Acc: 0.691 Test Loss: 0.793 Test Acc: 0.691
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5214862823486328
Epoch: 44, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.804 Vali Acc: 0.704 Test Loss: 0.804 Test Acc: 0.704
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7039473684210527
model parameter : 4112
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.2011585235595703
Epoch: 1, Steps: 10 | Train Loss: 1.518 Vali Loss: 1.438 Vali Acc: 0.283 Test Loss: 1.438 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 0.6309399604797363
Epoch: 2, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.428 Vali Acc: 0.283 Test Loss: 1.428 Test Acc: 0.283
Validation loss decreased (-0.282880 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 0.6972873210906982
Epoch: 3, Steps: 10 | Train Loss: 1.478 Vali Loss: 1.415 Vali Acc: 0.296 Test Loss: 1.415 Test Acc: 0.296
Validation loss decreased (-0.282880 --> -0.296038).  Saving model ...
Epoch: 4 cost time: 0.6088266372680664
Epoch: 4, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.399 Vali Acc: 0.303 Test Loss: 1.399 Test Acc: 0.303
Validation loss decreased (-0.296038 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 0.7498810291290283
Epoch: 5, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.381 Vali Acc: 0.303 Test Loss: 1.381 Test Acc: 0.303
Validation loss decreased (-0.302618 --> -0.302618).  Saving model ...
Epoch: 6 cost time: 0.5845065116882324
Epoch: 6, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.362 Vali Acc: 0.322 Test Loss: 1.362 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 7 cost time: 0.5967440605163574
Epoch: 7, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 8 cost time: 0.726811408996582
Epoch: 8, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.320 Vali Acc: 0.414 Test Loss: 1.320 Test Acc: 0.414
Validation loss decreased (-0.355250 --> -0.414460).  Saving model ...
Epoch: 9 cost time: 0.8473193645477295
Epoch: 9, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.298 Vali Acc: 0.434 Test Loss: 1.298 Test Acc: 0.434
Validation loss decreased (-0.414460 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 0.7322309017181396
Epoch: 10, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.275 Vali Acc: 0.461 Test Loss: 1.275 Test Acc: 0.461
Validation loss decreased (-0.434198 --> -0.460514).  Saving model ...
Epoch: 11 cost time: 0.7470846176147461
Epoch: 11, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.251 Vali Acc: 0.467 Test Loss: 1.251 Test Acc: 0.467
Validation loss decreased (-0.460514 --> -0.467093).  Saving model ...
Epoch: 12 cost time: 0.6269221305847168
Epoch: 12, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.228 Vali Acc: 0.493 Test Loss: 1.228 Test Acc: 0.493
Validation loss decreased (-0.467093 --> -0.493409).  Saving model ...
Epoch: 13 cost time: 0.7218470573425293
Epoch: 13, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.202 Vali Acc: 0.526 Test Loss: 1.202 Test Acc: 0.526
Validation loss decreased (-0.493409 --> -0.526304).  Saving model ...
Epoch: 14 cost time: 0.6205501556396484
Epoch: 14, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.178 Vali Acc: 0.539 Test Loss: 1.178 Test Acc: 0.539
Validation loss decreased (-0.526304 --> -0.539462).  Saving model ...
Epoch: 15 cost time: 0.6882421970367432
Epoch: 15, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.152 Vali Acc: 0.586 Test Loss: 1.152 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 16 cost time: 0.887507438659668
Epoch: 16, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.125 Vali Acc: 0.586 Test Loss: 1.125 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 17 cost time: 0.7393066883087158
Epoch: 17, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.098 Vali Acc: 0.612 Test Loss: 1.098 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 18 cost time: 0.6875896453857422
Epoch: 18, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.070 Vali Acc: 0.605 Test Loss: 1.070 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7575294971466064
Epoch: 19, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.039 Vali Acc: 0.612 Test Loss: 1.039 Test Acc: 0.612
Validation loss decreased (-0.611831 --> -0.611832).  Saving model ...
Epoch: 20 cost time: 0.5882749557495117
Epoch: 20, Steps: 10 | Train Loss: 0.910 Vali Loss: 1.010 Vali Acc: 0.651 Test Loss: 1.010 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651306).  Saving model ...
Epoch: 21 cost time: 0.7578577995300293
Epoch: 21, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.981 Vali Acc: 0.651 Test Loss: 0.981 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651306).  Saving model ...
Epoch: 22 cost time: 0.7229344844818115
Epoch: 22, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.951 Vali Acc: 0.664 Test Loss: 0.951 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664464).  Saving model ...
Epoch: 23 cost time: 0.7627730369567871
Epoch: 23, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.920 Vali Acc: 0.678 Test Loss: 0.920 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677622).  Saving model ...
Epoch: 24 cost time: 0.6712963581085205
Epoch: 24, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.893 Vali Acc: 0.684 Test Loss: 0.893 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 25 cost time: 0.7337198257446289
Epoch: 25, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.862 Vali Acc: 0.697 Test Loss: 0.862 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697360).  Saving model ...
Epoch: 26 cost time: 0.5866236686706543
Epoch: 26, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.835 Vali Acc: 0.678 Test Loss: 0.835 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6601839065551758
Epoch: 27, Steps: 10 | Train Loss: 0.634 Vali Loss: 0.808 Vali Acc: 0.678 Test Loss: 0.808 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8511679172515869
Epoch: 28, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.781 Vali Acc: 0.691 Test Loss: 0.781 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7478969097137451
Epoch: 29, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.759 Vali Acc: 0.711 Test Loss: 0.759 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 30 cost time: 0.725888729095459
Epoch: 30, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.738 Vali Acc: 0.711 Test Loss: 0.738 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 31 cost time: 0.7046501636505127
Epoch: 31, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.710 Vali Acc: 0.711 Test Loss: 0.710 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 32 cost time: 0.6165592670440674
Epoch: 32, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.694 Vali Acc: 0.711 Test Loss: 0.694 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 33 cost time: 0.6319749355316162
Epoch: 33, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 34 cost time: 0.6323397159576416
Epoch: 34, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.671 Vali Acc: 0.724 Test Loss: 0.671 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 35 cost time: 0.6869697570800781
Epoch: 35, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.659 Vali Acc: 0.730 Test Loss: 0.659 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 36 cost time: 0.599189043045044
Epoch: 36, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.649 Vali Acc: 0.730 Test Loss: 0.649 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 37 cost time: 0.6664340496063232
Epoch: 37, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 38 cost time: 0.6859169006347656
Epoch: 38, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 39 cost time: 0.6577742099761963
Epoch: 39, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 40 cost time: 0.6184048652648926
Epoch: 40, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6364691257476807
Epoch: 41, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6971418857574463
Epoch: 42, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.647 Vali Acc: 0.743 Test Loss: 0.647 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6881906986236572
Epoch: 43, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 44 cost time: 0.82720947265625
Epoch: 44, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7040648460388184
Epoch: 45, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6845641136169434
Epoch: 46, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6899011135101318
Epoch: 47, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763151).  Saving model ...
Epoch: 48 cost time: 0.7426650524139404
Epoch: 48, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6421418190002441
Epoch: 49, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.687 Vali Acc: 0.757 Test Loss: 0.687 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9202785491943359
Epoch: 50, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769730).  Saving model ...
Epoch: 51 cost time: 0.9883246421813965
Epoch: 51, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.704 Vali Acc: 0.763 Test Loss: 0.704 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8622081279754639
Epoch: 52, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.714 Vali Acc: 0.763 Test Loss: 0.714 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7972896099090576
Epoch: 53, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.698549747467041
Epoch: 54, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.729 Vali Acc: 0.763 Test Loss: 0.729 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.6968059539794922
Epoch: 55, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.744 Vali Acc: 0.757 Test Loss: 0.744 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7837755680084229
Epoch: 56, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.767 Vali Acc: 0.770 Test Loss: 0.767 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0070626735687256
Epoch: 57, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.777 Vali Acc: 0.770 Test Loss: 0.777 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9492189884185791
Epoch: 58, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.794 Vali Acc: 0.763 Test Loss: 0.794 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.902198314666748
Epoch: 59, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.806 Vali Acc: 0.770 Test Loss: 0.806 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.7820992469787598
Epoch: 60, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.819 Vali Acc: 0.770 Test Loss: 0.819 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 3966
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.224271774291992
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.458 Vali Acc: 0.257 Test Loss: 1.458 Test Acc: 0.257
Validation loss decreased (inf --> -0.256564).  Saving model ...
Epoch: 2 cost time: 0.6557025909423828
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.448 Vali Acc: 0.257 Test Loss: 1.448 Test Acc: 0.257
Validation loss decreased (-0.256564 --> -0.256564).  Saving model ...
Epoch: 3 cost time: 0.5886306762695312
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.434 Vali Acc: 0.257 Test Loss: 1.434 Test Acc: 0.257
Validation loss decreased (-0.256564 --> -0.256565).  Saving model ...
Epoch: 4 cost time: 0.6585536003112793
Epoch: 4, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (-0.256565 --> -0.269723).  Saving model ...
Epoch: 5 cost time: 0.5998408794403076
Epoch: 5, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.398 Vali Acc: 0.296 Test Loss: 1.398 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 6 cost time: 0.6887946128845215
Epoch: 6, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.378 Vali Acc: 0.322 Test Loss: 1.378 Test Acc: 0.322
Validation loss decreased (-0.296039 --> -0.322355).  Saving model ...
Epoch: 7 cost time: 0.7094762325286865
Epoch: 7, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.357 Vali Acc: 0.329 Test Loss: 1.357 Test Acc: 0.329
Validation loss decreased (-0.322355 --> -0.328934).  Saving model ...
Epoch: 8 cost time: 0.5556027889251709
Epoch: 8, Steps: 10 | Train Loss: 1.246 Vali Loss: 1.334 Vali Acc: 0.362 Test Loss: 1.334 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 9 cost time: 0.565943717956543
Epoch: 9, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.309 Vali Acc: 0.388 Test Loss: 1.309 Test Acc: 0.388
Validation loss decreased (-0.361829 --> -0.388145).  Saving model ...
Epoch: 10 cost time: 0.6288909912109375
Epoch: 10, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.285 Vali Acc: 0.414 Test Loss: 1.285 Test Acc: 0.414
Validation loss decreased (-0.388145 --> -0.414461).  Saving model ...
Epoch: 11 cost time: 0.5912673473358154
Epoch: 11, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.260 Vali Acc: 0.428 Test Loss: 1.260 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 12 cost time: 0.7401301860809326
Epoch: 12, Steps: 10 | Train Loss: 1.114 Vali Loss: 1.233 Vali Acc: 0.434 Test Loss: 1.233 Test Acc: 0.434
Validation loss decreased (-0.427619 --> -0.434198).  Saving model ...
Epoch: 13 cost time: 0.5812966823577881
Epoch: 13, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.206 Vali Acc: 0.447 Test Loss: 1.206 Test Acc: 0.447
Validation loss decreased (-0.434198 --> -0.447356).  Saving model ...
Epoch: 14 cost time: 0.6990985870361328
Epoch: 14, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.177 Vali Acc: 0.474 Test Loss: 1.177 Test Acc: 0.474
Validation loss decreased (-0.447356 --> -0.473672).  Saving model ...
Epoch: 15 cost time: 0.6108253002166748
Epoch: 15, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.148 Vali Acc: 0.493 Test Loss: 1.148 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493410).  Saving model ...
Epoch: 16 cost time: 0.5795185565948486
Epoch: 16, Steps: 10 | Train Loss: 0.975 Vali Loss: 1.116 Vali Acc: 0.493 Test Loss: 1.116 Test Acc: 0.493
Validation loss decreased (-0.493410 --> -0.493410).  Saving model ...
Epoch: 17 cost time: 0.8733251094818115
Epoch: 17, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.084 Vali Acc: 0.526 Test Loss: 1.084 Test Acc: 0.526
Validation loss decreased (-0.493410 --> -0.526305).  Saving model ...
Epoch: 18 cost time: 0.831209659576416
Epoch: 18, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.049 Vali Acc: 0.546 Test Loss: 1.049 Test Acc: 0.546
Validation loss decreased (-0.526305 --> -0.546042).  Saving model ...
Epoch: 19 cost time: 0.726508617401123
Epoch: 19, Steps: 10 | Train Loss: 0.860 Vali Loss: 1.012 Vali Acc: 0.559 Test Loss: 1.012 Test Acc: 0.559
Validation loss decreased (-0.546042 --> -0.559200).  Saving model ...
Epoch: 20 cost time: 0.8729212284088135
Epoch: 20, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.972 Vali Acc: 0.572 Test Loss: 0.972 Test Acc: 0.572
Validation loss decreased (-0.559200 --> -0.572359).  Saving model ...
Epoch: 21 cost time: 0.7626965045928955
Epoch: 21, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.931 Vali Acc: 0.618 Test Loss: 0.931 Test Acc: 0.618
Validation loss decreased (-0.572359 --> -0.618412).  Saving model ...
Epoch: 22 cost time: 0.6679785251617432
Epoch: 22, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.885 Vali Acc: 0.664 Test Loss: 0.885 Test Acc: 0.664
Validation loss decreased (-0.618412 --> -0.664465).  Saving model ...
Epoch: 23 cost time: 0.8013894557952881
Epoch: 23, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.840 Vali Acc: 0.671 Test Loss: 0.840 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 24 cost time: 0.6217093467712402
Epoch: 24, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.798 Vali Acc: 0.678 Test Loss: 0.798 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 25 cost time: 0.6735539436340332
Epoch: 25, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.759 Vali Acc: 0.678 Test Loss: 0.759 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 26 cost time: 0.6974508762359619
Epoch: 26, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.724 Vali Acc: 0.697 Test Loss: 0.724 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 27 cost time: 0.6353905200958252
Epoch: 27, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.695 Vali Acc: 0.711 Test Loss: 0.695 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 28 cost time: 0.6030712127685547
Epoch: 28, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.671 Vali Acc: 0.711 Test Loss: 0.671 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 29 cost time: 0.6261463165283203
Epoch: 29, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
Validation loss decreased (-0.710520 --> -0.723678).  Saving model ...
Epoch: 30 cost time: 0.58443284034729
Epoch: 30, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.637 Vali Acc: 0.711 Test Loss: 0.637 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5614516735076904
Epoch: 31, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.626 Vali Acc: 0.724 Test Loss: 0.626 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 32 cost time: 0.6492669582366943
Epoch: 32, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.616 Vali Acc: 0.717 Test Loss: 0.616 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6089644432067871
Epoch: 33, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 34 cost time: 0.6250553131103516
Epoch: 34, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 35 cost time: 0.7752034664154053
Epoch: 35, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.594 Vali Acc: 0.724 Test Loss: 0.594 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6987605094909668
Epoch: 36, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7931504249572754
Epoch: 37, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.587 Vali Acc: 0.730 Test Loss: 0.587 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.740670919418335
Epoch: 38, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6982455253601074
Epoch: 39, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6907684803009033
Epoch: 40, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7298645973205566
Epoch: 41, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.581 Vali Acc: 0.743 Test Loss: 0.581 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7384748458862305
Epoch: 42, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.586 Vali Acc: 0.743 Test Loss: 0.586 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7878131866455078
Epoch: 43, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.593 Vali Acc: 0.743 Test Loss: 0.593 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8260054588317871
Epoch: 44, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 3980
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.0749003887176514
Epoch: 1, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.290 Vali Acc: 0.401 Test Loss: 1.290 Test Acc: 0.401
Validation loss decreased (inf --> -0.401303).  Saving model ...
Epoch: 2 cost time: 0.5322961807250977
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.281 Vali Acc: 0.421 Test Loss: 1.281 Test Acc: 0.421
Validation loss decreased (-0.401303 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 0.49993324279785156
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.268 Vali Acc: 0.428 Test Loss: 1.268 Test Acc: 0.428
Validation loss decreased (-0.421040 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 0.5939033031463623
Epoch: 4, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.253 Vali Acc: 0.447 Test Loss: 1.253 Test Acc: 0.447
Validation loss decreased (-0.427619 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 0.6413044929504395
Epoch: 5, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.237 Vali Acc: 0.507 Test Loss: 1.237 Test Acc: 0.507
Validation loss decreased (-0.447356 --> -0.506567).  Saving model ...
Epoch: 6 cost time: 0.6535828113555908
Epoch: 6, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.220 Vali Acc: 0.533 Test Loss: 1.220 Test Acc: 0.533
Validation loss decreased (-0.506567 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 0.6670877933502197
Epoch: 7, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.200 Vali Acc: 0.579 Test Loss: 1.200 Test Acc: 0.579
Validation loss decreased (-0.532883 --> -0.578935).  Saving model ...
Epoch: 8 cost time: 0.5450444221496582
Epoch: 8, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.180 Vali Acc: 0.592 Test Loss: 1.180 Test Acc: 0.592
Validation loss decreased (-0.578935 --> -0.592093).  Saving model ...
Epoch: 9 cost time: 0.5709912776947021
Epoch: 9, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.159 Vali Acc: 0.618 Test Loss: 1.159 Test Acc: 0.618
Validation loss decreased (-0.592093 --> -0.618409).  Saving model ...
Epoch: 10 cost time: 0.6924769878387451
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.137 Vali Acc: 0.645 Test Loss: 1.137 Test Acc: 0.645
Validation loss decreased (-0.618409 --> -0.644725).  Saving model ...
Epoch: 11 cost time: 0.6462528705596924
Epoch: 11, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.116 Vali Acc: 0.632 Test Loss: 1.116 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7418885231018066
Epoch: 12, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.094 Vali Acc: 0.658 Test Loss: 1.094 Test Acc: 0.658
Validation loss decreased (-0.644725 --> -0.657884).  Saving model ...
Epoch: 13 cost time: 0.7698879241943359
Epoch: 13, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.072 Vali Acc: 0.671 Test Loss: 1.072 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671042).  Saving model ...
Epoch: 14 cost time: 0.5632634162902832
Epoch: 14, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.049 Vali Acc: 0.671 Test Loss: 1.049 Test Acc: 0.671
Validation loss decreased (-0.671042 --> -0.671042).  Saving model ...
Epoch: 15 cost time: 0.5316441059112549
Epoch: 15, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.026 Vali Acc: 0.678 Test Loss: 1.026 Test Acc: 0.678
Validation loss decreased (-0.671042 --> -0.677621).  Saving model ...
Epoch: 16 cost time: 0.7447173595428467
Epoch: 16, Steps: 10 | Train Loss: 0.933 Vali Loss: 1.004 Vali Acc: 0.684 Test Loss: 1.004 Test Acc: 0.684
Validation loss decreased (-0.677621 --> -0.684200).  Saving model ...
Epoch: 17 cost time: 0.776458740234375
Epoch: 17, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.980 Vali Acc: 0.697 Test Loss: 0.980 Test Acc: 0.697
Validation loss decreased (-0.684200 --> -0.697359).  Saving model ...
Epoch: 18 cost time: 0.6510684490203857
Epoch: 18, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.958 Vali Acc: 0.711 Test Loss: 0.958 Test Acc: 0.711
Validation loss decreased (-0.697359 --> -0.710517).  Saving model ...
Epoch: 19 cost time: 0.6113111972808838
Epoch: 19, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.934 Vali Acc: 0.704 Test Loss: 0.934 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7011153697967529
Epoch: 20, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.912 Vali Acc: 0.704 Test Loss: 0.912 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7188825607299805
Epoch: 21, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.889 Vali Acc: 0.724 Test Loss: 0.889 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723675).  Saving model ...
Epoch: 22 cost time: 0.7896766662597656
Epoch: 22, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.867 Vali Acc: 0.717 Test Loss: 0.867 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5996382236480713
Epoch: 23, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6611709594726562
Epoch: 24, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.824 Vali Acc: 0.717 Test Loss: 0.824 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.582587480545044
Epoch: 25, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.805 Vali Acc: 0.724 Test Loss: 0.805 Test Acc: 0.724
Validation loss decreased (-0.723675 --> -0.723676).  Saving model ...
Epoch: 26 cost time: 0.6090600490570068
Epoch: 26, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.784 Vali Acc: 0.730 Test Loss: 0.784 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730255).  Saving model ...
Epoch: 27 cost time: 0.573969841003418
Epoch: 27, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.765 Vali Acc: 0.730 Test Loss: 0.765 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 28 cost time: 0.5525534152984619
Epoch: 28, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.747 Vali Acc: 0.730 Test Loss: 0.747 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 29 cost time: 0.7120215892791748
Epoch: 29, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.729 Vali Acc: 0.724 Test Loss: 0.729 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6833016872406006
Epoch: 30, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.710 Vali Acc: 0.743 Test Loss: 0.710 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 31 cost time: 0.7015206813812256
Epoch: 31, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.695 Vali Acc: 0.750 Test Loss: 0.695 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 32 cost time: 0.669109582901001
Epoch: 32, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.681 Vali Acc: 0.730 Test Loss: 0.681 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7181847095489502
Epoch: 33, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 34 cost time: 0.68660569190979
Epoch: 34, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756572).  Saving model ...
Epoch: 35 cost time: 0.5625193119049072
Epoch: 35, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6832466125488281
Epoch: 36, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 37 cost time: 0.6143007278442383
Epoch: 37, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6162571907043457
Epoch: 38, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 39 cost time: 0.6494424343109131
Epoch: 39, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 40 cost time: 0.6387078762054443
Epoch: 40, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6823670864105225
Epoch: 41, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.618 Vali Acc: 0.757 Test Loss: 0.618 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6473233699798584
Epoch: 42, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 43 cost time: 0.6373500823974609
Epoch: 43, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 44 cost time: 0.5754094123840332
Epoch: 44, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8348648548126221
Epoch: 45, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6051630973815918
Epoch: 46, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7220900058746338
Epoch: 47, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5294303894042969
Epoch: 48, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5968058109283447
Epoch: 49, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.590338945388794
Epoch: 50, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6412408351898193
Epoch: 51, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.642 Vali Acc: 0.776 Test Loss: 0.642 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5887625217437744
Epoch: 52, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.651 Vali Acc: 0.776 Test Loss: 0.651 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6008429527282715
Epoch: 53, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 54 cost time: 0.6519217491149902
Epoch: 54, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6362349987030029
Epoch: 55, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6300244331359863
Epoch: 56, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6555266380310059
Epoch: 57, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6033675670623779
Epoch: 58, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7193450927734375
Epoch: 59, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6472165584564209
Epoch: 60, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.731 Vali Acc: 0.776 Test Loss: 0.731 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.7761082649230957
Epoch: 61, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.752 Vali Acc: 0.770 Test Loss: 0.752 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.7451438903808594
Epoch: 62, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.767 Vali Acc: 0.770 Test Loss: 0.767 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.952996015548706
Epoch: 63, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.776 Vali Acc: 0.776 Test Loss: 0.776 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 3878
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.272847890853882
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.657517671585083
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.423 Vali Acc: 0.270 Test Loss: 1.423 Test Acc: 0.270
Validation loss decreased (-0.269723 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.619699239730835
Epoch: 3, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.408 Vali Acc: 0.283 Test Loss: 1.408 Test Acc: 0.283
Validation loss decreased (-0.269723 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 0.6864972114562988
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.392 Vali Acc: 0.289 Test Loss: 1.392 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 0.667546272277832
Epoch: 5, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.372 Vali Acc: 0.309 Test Loss: 1.372 Test Acc: 0.309
Validation loss decreased (-0.289460 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 0.6039254665374756
Epoch: 6, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.351 Vali Acc: 0.329 Test Loss: 1.351 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 7 cost time: 0.7002222537994385
Epoch: 7, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.330 Vali Acc: 0.382 Test Loss: 1.330 Test Acc: 0.382
Validation loss decreased (-0.328934 --> -0.381566).  Saving model ...
Epoch: 8 cost time: 0.5988836288452148
Epoch: 8, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.307 Vali Acc: 0.441 Test Loss: 1.307 Test Acc: 0.441
Validation loss decreased (-0.381566 --> -0.440776).  Saving model ...
Epoch: 9 cost time: 0.628242015838623
Epoch: 9, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.284 Vali Acc: 0.467 Test Loss: 1.284 Test Acc: 0.467
Validation loss decreased (-0.440776 --> -0.467092).  Saving model ...
Epoch: 10 cost time: 0.577871561050415
Epoch: 10, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.260 Vali Acc: 0.474 Test Loss: 1.260 Test Acc: 0.474
Validation loss decreased (-0.467092 --> -0.473672).  Saving model ...
Epoch: 11 cost time: 0.5768539905548096
Epoch: 11, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.236 Vali Acc: 0.493 Test Loss: 1.236 Test Acc: 0.493
Validation loss decreased (-0.473672 --> -0.493409).  Saving model ...
Epoch: 12 cost time: 0.696871280670166
Epoch: 12, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.210 Vali Acc: 0.546 Test Loss: 1.210 Test Acc: 0.546
Validation loss decreased (-0.493409 --> -0.546041).  Saving model ...
Epoch: 13 cost time: 0.6697995662689209
Epoch: 13, Steps: 10 | Train Loss: 1.134 Vali Loss: 1.184 Vali Acc: 0.559 Test Loss: 1.184 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 14 cost time: 0.6698501110076904
Epoch: 14, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.159 Vali Acc: 0.579 Test Loss: 1.159 Test Acc: 0.579
Validation loss decreased (-0.559199 --> -0.578936).  Saving model ...
Epoch: 15 cost time: 0.5344724655151367
Epoch: 15, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.134 Vali Acc: 0.592 Test Loss: 1.134 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592094).  Saving model ...
Epoch: 16 cost time: 0.5828981399536133
Epoch: 16, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.108 Vali Acc: 0.618 Test Loss: 1.108 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 17 cost time: 0.5744426250457764
Epoch: 17, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.081 Vali Acc: 0.605 Test Loss: 1.081 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6038892269134521
Epoch: 18, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.055 Vali Acc: 0.618 Test Loss: 1.055 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618411).  Saving model ...
Epoch: 19 cost time: 0.5997011661529541
Epoch: 19, Steps: 10 | Train Loss: 0.911 Vali Loss: 1.027 Vali Acc: 0.618 Test Loss: 1.027 Test Acc: 0.618
Validation loss decreased (-0.618411 --> -0.618411).  Saving model ...
Epoch: 20 cost time: 0.6096029281616211
Epoch: 20, Steps: 10 | Train Loss: 0.864 Vali Loss: 1.000 Vali Acc: 0.625 Test Loss: 1.000 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624990).  Saving model ...
Epoch: 21 cost time: 0.5605440139770508
Epoch: 21, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.975 Vali Acc: 0.638 Test Loss: 0.975 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 22 cost time: 0.5728650093078613
Epoch: 22, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.949 Vali Acc: 0.638 Test Loss: 0.949 Test Acc: 0.638
Validation loss decreased (-0.638148 --> -0.638148).  Saving model ...
Epoch: 23 cost time: 0.6959052085876465
Epoch: 23, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.922 Vali Acc: 0.638 Test Loss: 0.922 Test Acc: 0.638
Validation loss decreased (-0.638148 --> -0.638149).  Saving model ...
Epoch: 24 cost time: 0.45142340660095215
Epoch: 24, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.897 Vali Acc: 0.645 Test Loss: 0.897 Test Acc: 0.645
Validation loss decreased (-0.638149 --> -0.644728).  Saving model ...
Epoch: 25 cost time: 0.6328246593475342
Epoch: 25, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.873 Vali Acc: 0.645 Test Loss: 0.873 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644728).  Saving model ...
Epoch: 26 cost time: 0.6003963947296143
Epoch: 26, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.849 Vali Acc: 0.651 Test Loss: 0.849 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651307).  Saving model ...
Epoch: 27 cost time: 0.6580679416656494
Epoch: 27, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.827 Vali Acc: 0.645 Test Loss: 0.827 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7034010887145996
Epoch: 28, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.806 Vali Acc: 0.645 Test Loss: 0.806 Test Acc: 0.645
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6206295490264893
Epoch: 29, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.786 Vali Acc: 0.645 Test Loss: 0.786 Test Acc: 0.645
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5826749801635742
Epoch: 30, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.768 Vali Acc: 0.638 Test Loss: 0.768 Test Acc: 0.638
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5936179161071777
Epoch: 31, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.754 Vali Acc: 0.645 Test Loss: 0.754 Test Acc: 0.645
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5929334163665771
Epoch: 32, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.745 Vali Acc: 0.638 Test Loss: 0.745 Test Acc: 0.638
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6164693832397461
Epoch: 33, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.739 Vali Acc: 0.638 Test Loss: 0.739 Test Acc: 0.638
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7016844749450684
Epoch: 34, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.731 Vali Acc: 0.645 Test Loss: 0.731 Test Acc: 0.645
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8123018741607666
Epoch: 35, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.728 Vali Acc: 0.664 Test Loss: 0.728 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 36 cost time: 0.6578152179718018
Epoch: 36, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.730 Vali Acc: 0.678 Test Loss: 0.730 Test Acc: 0.678
Validation loss decreased (-0.664466 --> -0.677624).  Saving model ...
Epoch: 37 cost time: 0.5873475074768066
Epoch: 37, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.727 Vali Acc: 0.684 Test Loss: 0.727 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 38 cost time: 0.6531267166137695
Epoch: 38, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.728 Vali Acc: 0.684 Test Loss: 0.728 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6053135395050049
Epoch: 39, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.732 Vali Acc: 0.678 Test Loss: 0.732 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.633371114730835
Epoch: 40, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.739 Vali Acc: 0.691 Test Loss: 0.739 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 41 cost time: 0.6089024543762207
Epoch: 41, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.745 Vali Acc: 0.691 Test Loss: 0.745 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6039464473724365
Epoch: 42, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.751 Vali Acc: 0.684 Test Loss: 0.751 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5633852481842041
Epoch: 43, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.758 Vali Acc: 0.684 Test Loss: 0.758 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6290364265441895
Epoch: 44, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.769 Vali Acc: 0.684 Test Loss: 0.769 Test Acc: 0.684
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6688234806060791
Epoch: 45, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.774 Vali Acc: 0.678 Test Loss: 0.774 Test Acc: 0.678
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.579871416091919
Epoch: 46, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.795 Vali Acc: 0.691 Test Loss: 0.795 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7435741424560547
Epoch: 47, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.803 Vali Acc: 0.684 Test Loss: 0.803 Test Acc: 0.684
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6252756118774414
Epoch: 48, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.816 Vali Acc: 0.684 Test Loss: 0.816 Test Acc: 0.684
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5577988624572754
Epoch: 49, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6016273498535156
Epoch: 50, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.836 Vali Acc: 0.678 Test Loss: 0.836 Test Acc: 0.678
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.6907894736842105
model parameter : 3872
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8492298126220703
Epoch: 1, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.430 Vali Acc: 0.276 Test Loss: 1.430 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 0.5706048011779785
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6654410362243652
Epoch: 3, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.405 Vali Acc: 0.263 Test Loss: 1.405 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.592151403427124
Epoch: 4, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.387 Vali Acc: 0.283 Test Loss: 1.387 Test Acc: 0.283
Validation loss decreased (-0.276301 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 0.6575267314910889
Epoch: 5, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.367 Vali Acc: 0.322 Test Loss: 1.367 Test Acc: 0.322
Validation loss decreased (-0.282881 --> -0.322355).  Saving model ...
Epoch: 6 cost time: 0.6639180183410645
Epoch: 6, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.346 Vali Acc: 0.342 Test Loss: 1.346 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342092).  Saving model ...
Epoch: 7 cost time: 0.5775108337402344
Epoch: 7, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.323 Vali Acc: 0.362 Test Loss: 1.323 Test Acc: 0.362
Validation loss decreased (-0.342092 --> -0.361829).  Saving model ...
Epoch: 8 cost time: 0.5911598205566406
Epoch: 8, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.299 Vali Acc: 0.421 Test Loss: 1.299 Test Acc: 0.421
Validation loss decreased (-0.361829 --> -0.421040).  Saving model ...
Epoch: 9 cost time: 0.6134710311889648
Epoch: 9, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.274 Vali Acc: 0.434 Test Loss: 1.274 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 0.5997951030731201
Epoch: 10, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.246 Vali Acc: 0.461 Test Loss: 1.246 Test Acc: 0.461
Validation loss decreased (-0.434198 --> -0.460514).  Saving model ...
Epoch: 11 cost time: 0.6268606185913086
Epoch: 11, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.218 Vali Acc: 0.474 Test Loss: 1.218 Test Acc: 0.474
Validation loss decreased (-0.460514 --> -0.473672).  Saving model ...
Epoch: 12 cost time: 0.5921969413757324
Epoch: 12, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.191 Vali Acc: 0.513 Test Loss: 1.191 Test Acc: 0.513
Validation loss decreased (-0.473672 --> -0.513146).  Saving model ...
Epoch: 13 cost time: 0.6406793594360352
Epoch: 13, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.163 Vali Acc: 0.507 Test Loss: 1.163 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.601161003112793
Epoch: 14, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.132 Vali Acc: 0.526 Test Loss: 1.132 Test Acc: 0.526
Validation loss decreased (-0.513146 --> -0.526304).  Saving model ...
Epoch: 15 cost time: 0.7507815361022949
Epoch: 15, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.100 Vali Acc: 0.559 Test Loss: 1.100 Test Acc: 0.559
Validation loss decreased (-0.526304 --> -0.559200).  Saving model ...
Epoch: 16 cost time: 0.6156857013702393
Epoch: 16, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.068 Vali Acc: 0.572 Test Loss: 1.068 Test Acc: 0.572
Validation loss decreased (-0.559200 --> -0.572358).  Saving model ...
Epoch: 17 cost time: 0.6270923614501953
Epoch: 17, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.034 Vali Acc: 0.566 Test Loss: 1.034 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.659642219543457
Epoch: 18, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.999 Vali Acc: 0.592 Test Loss: 0.999 Test Acc: 0.592
Validation loss decreased (-0.572358 --> -0.592095).  Saving model ...
Epoch: 19 cost time: 0.7400755882263184
Epoch: 19, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.963 Vali Acc: 0.612 Test Loss: 0.963 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611832).  Saving model ...
Epoch: 20 cost time: 0.6968340873718262
Epoch: 20, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.925 Vali Acc: 0.645 Test Loss: 0.925 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644728).  Saving model ...
Epoch: 21 cost time: 0.6897971630096436
Epoch: 21, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.888 Vali Acc: 0.638 Test Loss: 0.888 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6348259449005127
Epoch: 22, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.853 Vali Acc: 0.645 Test Loss: 0.853 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644728).  Saving model ...
Epoch: 23 cost time: 0.672738790512085
Epoch: 23, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.818 Vali Acc: 0.651 Test Loss: 0.818 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651308).  Saving model ...
Epoch: 24 cost time: 0.570685625076294
Epoch: 24, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.782 Vali Acc: 0.658 Test Loss: 0.782 Test Acc: 0.658
Validation loss decreased (-0.651308 --> -0.657887).  Saving model ...
Epoch: 25 cost time: 0.678473711013794
Epoch: 25, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.749 Vali Acc: 0.704 Test Loss: 0.749 Test Acc: 0.704
Validation loss decreased (-0.657887 --> -0.703940).  Saving model ...
Epoch: 26 cost time: 0.6195170879364014
Epoch: 26, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.726 Vali Acc: 0.704 Test Loss: 0.726 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 27 cost time: 0.6469173431396484
Epoch: 27, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.700 Vali Acc: 0.711 Test Loss: 0.700 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 28 cost time: 0.5774135589599609
Epoch: 28, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.687 Vali Acc: 0.704 Test Loss: 0.687 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6047391891479492
Epoch: 29, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.672 Vali Acc: 0.711 Test Loss: 0.672 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 30 cost time: 0.6038281917572021
Epoch: 30, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.655 Vali Acc: 0.711 Test Loss: 0.655 Test Acc: 0.711
Validation loss decreased (-0.710520 --> -0.710520).  Saving model ...
Epoch: 31 cost time: 0.7677254676818848
Epoch: 31, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.646 Vali Acc: 0.717 Test Loss: 0.646 Test Acc: 0.717
Validation loss decreased (-0.710520 --> -0.717099).  Saving model ...
Epoch: 32 cost time: 0.6517064571380615
Epoch: 32, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.629 Vali Acc: 0.730 Test Loss: 0.629 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 33 cost time: 0.7542755603790283
Epoch: 33, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.628 Vali Acc: 0.730 Test Loss: 0.628 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 34 cost time: 0.6110124588012695
Epoch: 34, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.621 Vali Acc: 0.730 Test Loss: 0.621 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 35 cost time: 0.8356750011444092
Epoch: 35, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.614 Vali Acc: 0.724 Test Loss: 0.614 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6586415767669678
Epoch: 36, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.604 Vali Acc: 0.724 Test Loss: 0.604 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7751741409301758
Epoch: 37, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 38 cost time: 0.7017672061920166
Epoch: 38, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.599 Vali Acc: 0.743 Test Loss: 0.599 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 39 cost time: 0.799142599105835
Epoch: 39, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.595 Vali Acc: 0.743 Test Loss: 0.595 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 40 cost time: 0.677532434463501
Epoch: 40, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.588 Vali Acc: 0.743 Test Loss: 0.588 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 41 cost time: 0.6690511703491211
Epoch: 41, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 42 cost time: 0.5389859676361084
Epoch: 42, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 43 cost time: 0.7146637439727783
Epoch: 43, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 44 cost time: 0.6080186367034912
Epoch: 44, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 45 cost time: 0.7833189964294434
Epoch: 45, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 46 cost time: 0.5066883563995361
Epoch: 46, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6220684051513672
Epoch: 47, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6105978488922119
Epoch: 48, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.47703051567077637
Epoch: 49, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.588 Vali Acc: 0.743 Test Loss: 0.588 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.6428849697113037
Epoch: 50, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6997239589691162
Epoch: 51, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5810775756835938
Epoch: 52, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.4996309280395508
Epoch: 53, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.5033931732177734
Epoch: 54, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.4918544292449951
Epoch: 55, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.631 Vali Acc: 0.743 Test Loss: 0.631 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 3964
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.373096466064453
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.429 Vali Acc: 0.355 Test Loss: 1.429 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 0.8244712352752686
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.415 Vali Acc: 0.349 Test Loss: 1.415 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8765819072723389
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.398 Vali Acc: 0.342 Test Loss: 1.398 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6372747421264648
Epoch: 4, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.378 Vali Acc: 0.349 Test Loss: 1.378 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6231949329376221
Epoch: 5, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.357 Vali Acc: 0.349 Test Loss: 1.357 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.6549632549285889
Epoch: 6, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.334 Vali Acc: 0.368 Test Loss: 1.334 Test Acc: 0.368
Validation loss decreased (-0.355249 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 0.7203483581542969
Epoch: 7, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.309 Vali Acc: 0.395 Test Loss: 1.309 Test Acc: 0.395
Validation loss decreased (-0.368408 --> -0.394724).  Saving model ...
Epoch: 8 cost time: 0.8810203075408936
Epoch: 8, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.285 Vali Acc: 0.421 Test Loss: 1.285 Test Acc: 0.421
Validation loss decreased (-0.394724 --> -0.421040).  Saving model ...
Epoch: 9 cost time: 0.6382710933685303
Epoch: 9, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.259 Vali Acc: 0.461 Test Loss: 1.259 Test Acc: 0.461
Validation loss decreased (-0.421040 --> -0.460514).  Saving model ...
Epoch: 10 cost time: 0.6657941341400146
Epoch: 10, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.234 Vali Acc: 0.493 Test Loss: 1.234 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493409).  Saving model ...
Epoch: 11 cost time: 0.6052286624908447
Epoch: 11, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.211 Vali Acc: 0.507 Test Loss: 1.211 Test Acc: 0.507
Validation loss decreased (-0.493409 --> -0.506567).  Saving model ...
Epoch: 12 cost time: 0.6284322738647461
Epoch: 12, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.187 Vali Acc: 0.546 Test Loss: 1.187 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546041).  Saving model ...
Epoch: 13 cost time: 0.6742889881134033
Epoch: 13, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.162 Vali Acc: 0.566 Test Loss: 1.162 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 14 cost time: 0.6423442363739014
Epoch: 14, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.138 Vali Acc: 0.579 Test Loss: 1.138 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578936).  Saving model ...
Epoch: 15 cost time: 0.6671063899993896
Epoch: 15, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.114 Vali Acc: 0.592 Test Loss: 1.114 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592094).  Saving model ...
Epoch: 16 cost time: 0.7081246376037598
Epoch: 16, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.090 Vali Acc: 0.586 Test Loss: 1.090 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6327927112579346
Epoch: 17, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.066 Vali Acc: 0.618 Test Loss: 1.066 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618410).  Saving model ...
Epoch: 18 cost time: 0.6877117156982422
Epoch: 18, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.039 Vali Acc: 0.618 Test Loss: 1.039 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618411).  Saving model ...
Epoch: 19 cost time: 0.668358325958252
Epoch: 19, Steps: 10 | Train Loss: 0.895 Vali Loss: 1.014 Vali Acc: 0.651 Test Loss: 1.014 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651306).  Saving model ...
Epoch: 20 cost time: 0.6425671577453613
Epoch: 20, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.989 Vali Acc: 0.671 Test Loss: 0.989 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 21 cost time: 0.6885626316070557
Epoch: 21, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.965 Vali Acc: 0.678 Test Loss: 0.965 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 22 cost time: 0.6469416618347168
Epoch: 22, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.942 Vali Acc: 0.678 Test Loss: 0.942 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677622).  Saving model ...
Epoch: 23 cost time: 0.6046276092529297
Epoch: 23, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.918 Vali Acc: 0.664 Test Loss: 0.918 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.590207576751709
Epoch: 24, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.891 Vali Acc: 0.671 Test Loss: 0.891 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5544383525848389
Epoch: 25, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.864 Vali Acc: 0.684 Test Loss: 0.864 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 26 cost time: 0.5685329437255859
Epoch: 26, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.836 Vali Acc: 0.684 Test Loss: 0.836 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 27 cost time: 0.5761065483093262
Epoch: 27, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.807 Vali Acc: 0.704 Test Loss: 0.807 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 28 cost time: 0.569451093673706
Epoch: 28, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.778 Vali Acc: 0.704 Test Loss: 0.778 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 29 cost time: 0.5834739208221436
Epoch: 29, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.749 Vali Acc: 0.730 Test Loss: 0.749 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 30 cost time: 0.6634383201599121
Epoch: 30, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.725 Vali Acc: 0.730 Test Loss: 0.725 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 31 cost time: 0.6742637157440186
Epoch: 31, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.698 Vali Acc: 0.743 Test Loss: 0.698 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 32 cost time: 0.5914263725280762
Epoch: 32, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.676 Vali Acc: 0.730 Test Loss: 0.676 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7253913879394531
Epoch: 33, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 34 cost time: 0.6203272342681885
Epoch: 34, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.638 Vali Acc: 0.750 Test Loss: 0.638 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 35 cost time: 0.530165433883667
Epoch: 35, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7196097373962402
Epoch: 36, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.615 Vali Acc: 0.743 Test Loss: 0.615 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7208428382873535
Epoch: 37, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.602 Vali Acc: 0.743 Test Loss: 0.602 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6819148063659668
Epoch: 38, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 39 cost time: 0.5700850486755371
Epoch: 39, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 40 cost time: 0.6823639869689941
Epoch: 40, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 41 cost time: 0.6128404140472412
Epoch: 41, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.574 Vali Acc: 0.770 Test Loss: 0.574 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 42 cost time: 0.5837719440460205
Epoch: 42, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7958366870880127
Epoch: 43, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6712579727172852
Epoch: 44, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7374486923217773
Epoch: 45, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6593780517578125
Epoch: 46, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6303105354309082
Epoch: 47, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8141746520996094
Epoch: 48, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6303660869598389
Epoch: 49, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7534613609313965
Epoch: 50, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6123435497283936
Epoch: 51, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 3952
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.218872547149658
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.6757776737213135
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
Validation loss decreased (-0.269723 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 0.6374075412750244
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.396 Vali Acc: 0.289 Test Loss: 1.396 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 0.6555662155151367
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.381 Vali Acc: 0.289 Test Loss: 1.381 Test Acc: 0.289
Validation loss decreased (-0.289460 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 0.6401119232177734
Epoch: 5, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.364 Vali Acc: 0.309 Test Loss: 1.364 Test Acc: 0.309
Validation loss decreased (-0.289460 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 0.6865026950836182
Epoch: 6, Steps: 10 | Train Loss: 1.307 Vali Loss: 1.347 Vali Acc: 0.355 Test Loss: 1.347 Test Acc: 0.355
Validation loss decreased (-0.309197 --> -0.355250).  Saving model ...
Epoch: 7 cost time: 0.6476774215698242
Epoch: 7, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.328 Vali Acc: 0.395 Test Loss: 1.328 Test Acc: 0.395
Validation loss decreased (-0.355250 --> -0.394724).  Saving model ...
Epoch: 8 cost time: 0.5872395038604736
Epoch: 8, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.306 Vali Acc: 0.401 Test Loss: 1.306 Test Acc: 0.401
Validation loss decreased (-0.394724 --> -0.401303).  Saving model ...
Epoch: 9 cost time: 0.7466814517974854
Epoch: 9, Steps: 10 | Train Loss: 1.229 Vali Loss: 1.284 Vali Acc: 0.434 Test Loss: 1.284 Test Acc: 0.434
Validation loss decreased (-0.401303 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 0.71047043800354
Epoch: 10, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.263 Vali Acc: 0.447 Test Loss: 1.263 Test Acc: 0.447
Validation loss decreased (-0.434198 --> -0.447356).  Saving model ...
Epoch: 11 cost time: 0.7476694583892822
Epoch: 11, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.238 Vali Acc: 0.461 Test Loss: 1.238 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 12 cost time: 0.5742530822753906
Epoch: 12, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.214 Vali Acc: 0.474 Test Loss: 1.214 Test Acc: 0.474
Validation loss decreased (-0.460514 --> -0.473672).  Saving model ...
Epoch: 13 cost time: 0.5652580261230469
Epoch: 13, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.187 Vali Acc: 0.487 Test Loss: 1.187 Test Acc: 0.487
Validation loss decreased (-0.473672 --> -0.486830).  Saving model ...
Epoch: 14 cost time: 0.505986213684082
Epoch: 14, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.160 Vali Acc: 0.513 Test Loss: 1.160 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513146).  Saving model ...
Epoch: 15 cost time: 0.5844740867614746
Epoch: 15, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.129 Vali Acc: 0.546 Test Loss: 1.129 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546041).  Saving model ...
Epoch: 16 cost time: 0.5795133113861084
Epoch: 16, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.096 Vali Acc: 0.592 Test Loss: 1.096 Test Acc: 0.592
Validation loss decreased (-0.546041 --> -0.592094).  Saving model ...
Epoch: 17 cost time: 0.6096146106719971
Epoch: 17, Steps: 10 | Train Loss: 0.908 Vali Loss: 1.060 Vali Acc: 0.612 Test Loss: 1.060 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611832).  Saving model ...
Epoch: 18 cost time: 0.6861510276794434
Epoch: 18, Steps: 10 | Train Loss: 0.852 Vali Loss: 1.022 Vali Acc: 0.612 Test Loss: 1.022 Test Acc: 0.612
Validation loss decreased (-0.611832 --> -0.611832).  Saving model ...
Epoch: 19 cost time: 0.507784366607666
Epoch: 19, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.979 Vali Acc: 0.612 Test Loss: 0.979 Test Acc: 0.612
Validation loss decreased (-0.611832 --> -0.611832).  Saving model ...
Epoch: 20 cost time: 0.6527235507965088
Epoch: 20, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.941 Vali Acc: 0.612 Test Loss: 0.941 Test Acc: 0.612
Validation loss decreased (-0.611832 --> -0.611833).  Saving model ...
Epoch: 21 cost time: 0.5141677856445312
Epoch: 21, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.907 Vali Acc: 0.618 Test Loss: 0.907 Test Acc: 0.618
Validation loss decreased (-0.611833 --> -0.618412).  Saving model ...
Epoch: 22 cost time: 0.6119673252105713
Epoch: 22, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.877 Vali Acc: 0.618 Test Loss: 0.877 Test Acc: 0.618
Validation loss decreased (-0.618412 --> -0.618412).  Saving model ...
Epoch: 23 cost time: 0.5500950813293457
Epoch: 23, Steps: 10 | Train Loss: 0.640 Vali Loss: 0.852 Vali Acc: 0.625 Test Loss: 0.852 Test Acc: 0.625
Validation loss decreased (-0.618412 --> -0.624991).  Saving model ...
Epoch: 24 cost time: 0.728632926940918
Epoch: 24, Steps: 10 | Train Loss: 0.590 Vali Loss: 0.831 Vali Acc: 0.632 Test Loss: 0.831 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631571).  Saving model ...
Epoch: 25 cost time: 0.5831224918365479
Epoch: 25, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.815 Vali Acc: 0.638 Test Loss: 0.815 Test Acc: 0.638
Validation loss decreased (-0.631571 --> -0.638150).  Saving model ...
Epoch: 26 cost time: 0.5988771915435791
Epoch: 26, Steps: 10 | Train Loss: 0.555 Vali Loss: 0.798 Vali Acc: 0.658 Test Loss: 0.798 Test Acc: 0.658
Validation loss decreased (-0.638150 --> -0.657887).  Saving model ...
Epoch: 27 cost time: 0.5361824035644531
Epoch: 27, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.785 Vali Acc: 0.664 Test Loss: 0.785 Test Acc: 0.664
Validation loss decreased (-0.657887 --> -0.664466).  Saving model ...
Epoch: 28 cost time: 0.601060152053833
Epoch: 28, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.769 Vali Acc: 0.671 Test Loss: 0.769 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 29 cost time: 0.5845000743865967
Epoch: 29, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.763 Vali Acc: 0.684 Test Loss: 0.763 Test Acc: 0.684
Validation loss decreased (-0.671045 --> -0.684203).  Saving model ...
Epoch: 30 cost time: 0.6551001071929932
Epoch: 30, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.760 Vali Acc: 0.684 Test Loss: 0.760 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 31 cost time: 0.6358296871185303
Epoch: 31, Steps: 10 | Train Loss: 0.425 Vali Loss: 0.757 Vali Acc: 0.697 Test Loss: 0.757 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 32 cost time: 0.727973222732544
Epoch: 32, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.754 Vali Acc: 0.704 Test Loss: 0.754 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 33 cost time: 0.6517133712768555
Epoch: 33, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 34 cost time: 0.7516140937805176
Epoch: 34, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7637207508087158
Epoch: 35, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 36 cost time: 0.7328307628631592
Epoch: 36, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7685647010803223
Epoch: 37, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6711275577545166
Epoch: 38, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.741 Vali Acc: 0.724 Test Loss: 0.741 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 39 cost time: 0.6331658363342285
Epoch: 39, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.741 Vali Acc: 0.711 Test Loss: 0.741 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6606802940368652
Epoch: 40, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.742 Vali Acc: 0.697 Test Loss: 0.742 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.591317892074585
Epoch: 41, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.746 Vali Acc: 0.711 Test Loss: 0.746 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6306138038635254
Epoch: 42, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.743 Vali Acc: 0.704 Test Loss: 0.743 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6498947143554688
Epoch: 43, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6764590740203857
Epoch: 44, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.750 Vali Acc: 0.697 Test Loss: 0.750 Test Acc: 0.697
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6210241317749023
Epoch: 45, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.750 Vali Acc: 0.697 Test Loss: 0.750 Test Acc: 0.697
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5478370189666748
Epoch: 46, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.758 Vali Acc: 0.691 Test Loss: 0.758 Test Acc: 0.691
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5813250541687012
Epoch: 47, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.763 Vali Acc: 0.684 Test Loss: 0.763 Test Acc: 0.684
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.5677037239074707
Epoch: 48, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.762 Vali Acc: 0.697 Test Loss: 0.762 Test Acc: 0.697
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm64_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7236842105263158
model parameter : 4190
model size : 0.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.9982490539550781
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.461 Vali Acc: 0.191 Test Loss: 1.461 Test Acc: 0.191
Validation loss decreased (inf --> -0.190775).  Saving model ...
Epoch: 2 cost time: 0.5795722007751465
Epoch: 2, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.448 Vali Acc: 0.204 Test Loss: 1.448 Test Acc: 0.204
Validation loss decreased (-0.190775 --> -0.203933).  Saving model ...
Epoch: 3 cost time: 0.5848097801208496
Epoch: 3, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.429 Vali Acc: 0.217 Test Loss: 1.429 Test Acc: 0.217
Validation loss decreased (-0.203933 --> -0.217091).  Saving model ...
Epoch: 4 cost time: 0.6070163249969482
Epoch: 4, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.408 Vali Acc: 0.243 Test Loss: 1.408 Test Acc: 0.243
Validation loss decreased (-0.217091 --> -0.243407).  Saving model ...
Epoch: 5 cost time: 0.5537152290344238
Epoch: 5, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.385 Vali Acc: 0.263 Test Loss: 1.385 Test Acc: 0.263
Validation loss decreased (-0.243407 --> -0.263144).  Saving model ...
Epoch: 6 cost time: 0.5782580375671387
Epoch: 6, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.361 Vali Acc: 0.276 Test Loss: 1.361 Test Acc: 0.276
Validation loss decreased (-0.263144 --> -0.276302).  Saving model ...
Epoch: 7 cost time: 0.5486407279968262
Epoch: 7, Steps: 10 | Train Loss: 1.321 Vali Loss: 1.336 Vali Acc: 0.303 Test Loss: 1.336 Test Acc: 0.303
Validation loss decreased (-0.276302 --> -0.302618).  Saving model ...
Epoch: 8 cost time: 0.5320520401000977
Epoch: 8, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.310 Vali Acc: 0.355 Test Loss: 1.310 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 9 cost time: 0.6650111675262451
Epoch: 9, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.283 Vali Acc: 0.408 Test Loss: 1.283 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 10 cost time: 0.5016603469848633
Epoch: 10, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
Validation loss decreased (-0.407882 --> -0.453935).  Saving model ...
Epoch: 11 cost time: 0.5560812950134277
Epoch: 11, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.232 Vali Acc: 0.487 Test Loss: 1.232 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 12 cost time: 0.5432274341583252
Epoch: 12, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.207 Vali Acc: 0.513 Test Loss: 1.207 Test Acc: 0.513
Validation loss decreased (-0.486830 --> -0.513146).  Saving model ...
Epoch: 13 cost time: 0.5595748424530029
Epoch: 13, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.181 Vali Acc: 0.533 Test Loss: 1.181 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532883).  Saving model ...
Epoch: 14 cost time: 0.5619969367980957
Epoch: 14, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.157 Vali Acc: 0.553 Test Loss: 1.157 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 15 cost time: 0.6516749858856201
Epoch: 15, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.552620 --> -0.572357).  Saving model ...
Epoch: 16 cost time: 0.6177980899810791
Epoch: 16, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.105 Vali Acc: 0.579 Test Loss: 1.105 Test Acc: 0.579
Validation loss decreased (-0.572357 --> -0.578936).  Saving model ...
Epoch: 17 cost time: 0.5628857612609863
Epoch: 17, Steps: 10 | Train Loss: 0.969 Vali Loss: 1.082 Vali Acc: 0.579 Test Loss: 1.082 Test Acc: 0.579
Validation loss decreased (-0.578936 --> -0.578937).  Saving model ...
Epoch: 18 cost time: 0.5644619464874268
Epoch: 18, Steps: 10 | Train Loss: 0.949 Vali Loss: 1.055 Vali Acc: 0.592 Test Loss: 1.055 Test Acc: 0.592
Validation loss decreased (-0.578937 --> -0.592095).  Saving model ...
Epoch: 19 cost time: 0.6552078723907471
Epoch: 19, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.030 Vali Acc: 0.605 Test Loss: 1.030 Test Acc: 0.605
Validation loss decreased (-0.592095 --> -0.605253).  Saving model ...
Epoch: 20 cost time: 0.5671141147613525
Epoch: 20, Steps: 10 | Train Loss: 0.874 Vali Loss: 1.005 Vali Acc: 0.618 Test Loss: 1.005 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618411).  Saving model ...
Epoch: 21 cost time: 0.5383515357971191
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.982 Vali Acc: 0.632 Test Loss: 0.982 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 22 cost time: 0.7572791576385498
Epoch: 22, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.960 Vali Acc: 0.625 Test Loss: 0.960 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5986759662628174
Epoch: 23, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.939 Vali Acc: 0.632 Test Loss: 0.939 Test Acc: 0.632
Validation loss decreased (-0.631569 --> -0.631570).  Saving model ...
Epoch: 24 cost time: 0.5679025650024414
Epoch: 24, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.917 Vali Acc: 0.632 Test Loss: 0.917 Test Acc: 0.632
Validation loss decreased (-0.631570 --> -0.631570).  Saving model ...
Epoch: 25 cost time: 0.7038137912750244
Epoch: 25, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.894 Vali Acc: 0.645 Test Loss: 0.894 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 26 cost time: 0.6168670654296875
Epoch: 26, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.873 Vali Acc: 0.664 Test Loss: 0.873 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 27 cost time: 0.642322301864624
Epoch: 27, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.851 Vali Acc: 0.664 Test Loss: 0.851 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664465).  Saving model ...
Epoch: 28 cost time: 0.5828936100006104
Epoch: 28, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.831 Vali Acc: 0.645 Test Loss: 0.831 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6438815593719482
Epoch: 29, Steps: 10 | Train Loss: 0.655 Vali Loss: 0.812 Vali Acc: 0.658 Test Loss: 0.812 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6933162212371826
Epoch: 30, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.792 Vali Acc: 0.671 Test Loss: 0.792 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671045).  Saving model ...
Epoch: 31 cost time: 0.6519069671630859
Epoch: 31, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.776 Vali Acc: 0.684 Test Loss: 0.776 Test Acc: 0.684
Validation loss decreased (-0.671045 --> -0.684203).  Saving model ...
Epoch: 32 cost time: 0.6647367477416992
Epoch: 32, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.760 Vali Acc: 0.684 Test Loss: 0.760 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 33 cost time: 0.6358723640441895
Epoch: 33, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.743 Vali Acc: 0.691 Test Loss: 0.743 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 34 cost time: 0.6821730136871338
Epoch: 34, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.727 Vali Acc: 0.704 Test Loss: 0.727 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 35 cost time: 0.6840319633483887
Epoch: 35, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.713 Vali Acc: 0.704 Test Loss: 0.713 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 36 cost time: 0.6533777713775635
Epoch: 36, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.699 Vali Acc: 0.717 Test Loss: 0.699 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 37 cost time: 0.7909305095672607
Epoch: 37, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.685 Vali Acc: 0.730 Test Loss: 0.685 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 38 cost time: 0.8281223773956299
Epoch: 38, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.672 Vali Acc: 0.737 Test Loss: 0.672 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 39 cost time: 0.7186589241027832
Epoch: 39, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 40 cost time: 0.8761110305786133
Epoch: 40, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.647 Vali Acc: 0.750 Test Loss: 0.647 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 41 cost time: 0.694878339767456
Epoch: 41, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.637 Vali Acc: 0.757 Test Loss: 0.637 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 42 cost time: 0.6234731674194336
Epoch: 42, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 43 cost time: 0.8419630527496338
Epoch: 43, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7441833019256592
Epoch: 44, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 45 cost time: 0.841064453125
Epoch: 45, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.682471513748169
Epoch: 46, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6740906238555908
Epoch: 47, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.570 Vali Acc: 0.763 Test Loss: 0.570 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 48 cost time: 0.6070618629455566
Epoch: 48, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 49 cost time: 0.9304742813110352
Epoch: 49, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 50 cost time: 0.7671751976013184
Epoch: 50, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7912466526031494
Epoch: 51, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 52 cost time: 0.7412538528442383
Epoch: 52, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.526 Vali Acc: 0.763 Test Loss: 0.526 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 53 cost time: 0.6869528293609619
Epoch: 53, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 54 cost time: 0.7864727973937988
Epoch: 54, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.513 Vali Acc: 0.783 Test Loss: 0.513 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 55 cost time: 0.7742824554443359
Epoch: 55, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8048875331878662
Epoch: 56, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6998636722564697
Epoch: 57, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8263726234436035
Epoch: 58, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9175167083740234
Epoch: 59, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8778107166290283
Epoch: 60, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.8163530826568604
Epoch: 61, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.793454647064209
Epoch: 62, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7380480766296387
Epoch: 63, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.780975341796875
Epoch: 64, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 2544
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.1482927799224854
Epoch: 1, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.404 Vali Acc: 0.303 Test Loss: 1.404 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.6320805549621582
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.394 Vali Acc: 0.309 Test Loss: 1.394 Test Acc: 0.309
Validation loss decreased (-0.302618 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.6910715103149414
Epoch: 3, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.379 Vali Acc: 0.303 Test Loss: 1.379 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6095008850097656
Epoch: 4, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.363 Vali Acc: 0.322 Test Loss: 1.363 Test Acc: 0.322
Validation loss decreased (-0.309197 --> -0.322355).  Saving model ...
Epoch: 5 cost time: 0.7405266761779785
Epoch: 5, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.344 Vali Acc: 0.355 Test Loss: 1.344 Test Acc: 0.355
Validation loss decreased (-0.322355 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 0.5536971092224121
Epoch: 6, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.325 Vali Acc: 0.368 Test Loss: 1.325 Test Acc: 0.368
Validation loss decreased (-0.355250 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 0.6189298629760742
Epoch: 7, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.303 Vali Acc: 0.401 Test Loss: 1.303 Test Acc: 0.401
Validation loss decreased (-0.368408 --> -0.401303).  Saving model ...
Epoch: 8 cost time: 0.5936405658721924
Epoch: 8, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.282 Vali Acc: 0.408 Test Loss: 1.282 Test Acc: 0.408
Validation loss decreased (-0.401303 --> -0.407882).  Saving model ...
Epoch: 9 cost time: 0.46842050552368164
Epoch: 9, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.258 Vali Acc: 0.454 Test Loss: 1.258 Test Acc: 0.454
Validation loss decreased (-0.407882 --> -0.453935).  Saving model ...
Epoch: 10 cost time: 0.7215414047241211
Epoch: 10, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.236 Vali Acc: 0.507 Test Loss: 1.236 Test Acc: 0.507
Validation loss decreased (-0.453935 --> -0.506567).  Saving model ...
Epoch: 11 cost time: 0.539872407913208
Epoch: 11, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.211 Vali Acc: 0.559 Test Loss: 1.211 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559198).  Saving model ...
Epoch: 12 cost time: 0.6213159561157227
Epoch: 12, Steps: 10 | Train Loss: 1.121 Vali Loss: 1.187 Vali Acc: 0.572 Test Loss: 1.187 Test Acc: 0.572
Validation loss decreased (-0.559198 --> -0.572357).  Saving model ...
Epoch: 13 cost time: 0.6104087829589844
Epoch: 13, Steps: 10 | Train Loss: 1.091 Vali Loss: 1.163 Vali Acc: 0.599 Test Loss: 1.163 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 14 cost time: 0.6763095855712891
Epoch: 14, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.138 Vali Acc: 0.579 Test Loss: 1.138 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5882601737976074
Epoch: 15, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.115 Vali Acc: 0.599 Test Loss: 1.115 Test Acc: 0.599
Validation loss decreased (-0.598673 --> -0.598673).  Saving model ...
Epoch: 16 cost time: 0.5893368721008301
Epoch: 16, Steps: 10 | Train Loss: 0.988 Vali Loss: 1.090 Vali Acc: 0.599 Test Loss: 1.090 Test Acc: 0.599
Validation loss decreased (-0.598673 --> -0.598673).  Saving model ...
Epoch: 17 cost time: 0.5790343284606934
Epoch: 17, Steps: 10 | Train Loss: 0.954 Vali Loss: 1.065 Vali Acc: 0.612 Test Loss: 1.065 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611831).  Saving model ...
Epoch: 18 cost time: 0.5687997341156006
Epoch: 18, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.039 Vali Acc: 0.651 Test Loss: 1.039 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651305).  Saving model ...
Epoch: 19 cost time: 0.6216821670532227
Epoch: 19, Steps: 10 | Train Loss: 0.886 Vali Loss: 1.013 Vali Acc: 0.645 Test Loss: 1.013 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4295830726623535
Epoch: 20, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.986 Vali Acc: 0.658 Test Loss: 0.986 Test Acc: 0.658
Validation loss decreased (-0.651305 --> -0.657885).  Saving model ...
Epoch: 21 cost time: 0.7517364025115967
Epoch: 21, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.959 Vali Acc: 0.651 Test Loss: 0.959 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6265411376953125
Epoch: 22, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.936 Vali Acc: 0.658 Test Loss: 0.936 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 23 cost time: 0.5993692874908447
Epoch: 23, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.909 Vali Acc: 0.658 Test Loss: 0.909 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657886).  Saving model ...
Epoch: 24 cost time: 0.6790783405303955
Epoch: 24, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.884 Vali Acc: 0.658 Test Loss: 0.884 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657886).  Saving model ...
Epoch: 25 cost time: 0.6382765769958496
Epoch: 25, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.858 Vali Acc: 0.651 Test Loss: 0.858 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.517101526260376
Epoch: 26, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.835 Vali Acc: 0.651 Test Loss: 0.835 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6044661998748779
Epoch: 27, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.811 Vali Acc: 0.664 Test Loss: 0.811 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664466).  Saving model ...
Epoch: 28 cost time: 0.8654563426971436
Epoch: 28, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.790 Vali Acc: 0.671 Test Loss: 0.790 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 29 cost time: 0.7778120040893555
Epoch: 29, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
Validation loss decreased (-0.671045 --> -0.671045).  Saving model ...
Epoch: 30 cost time: 0.6586108207702637
Epoch: 30, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.752 Vali Acc: 0.671 Test Loss: 0.752 Test Acc: 0.671
Validation loss decreased (-0.671045 --> -0.671045).  Saving model ...
Epoch: 31 cost time: 0.7214465141296387
Epoch: 31, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.735 Vali Acc: 0.671 Test Loss: 0.735 Test Acc: 0.671
Validation loss decreased (-0.671045 --> -0.671045).  Saving model ...
Epoch: 32 cost time: 0.6990640163421631
Epoch: 32, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.718 Vali Acc: 0.678 Test Loss: 0.718 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677624).  Saving model ...
Epoch: 33 cost time: 0.7246813774108887
Epoch: 33, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.703 Vali Acc: 0.684 Test Loss: 0.703 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 34 cost time: 0.7830557823181152
Epoch: 34, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.690 Vali Acc: 0.684 Test Loss: 0.690 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684204).  Saving model ...
Epoch: 35 cost time: 0.656646728515625
Epoch: 35, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.678 Vali Acc: 0.678 Test Loss: 0.678 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7261693477630615
Epoch: 36, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.665 Vali Acc: 0.678 Test Loss: 0.665 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6681554317474365
Epoch: 37, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.654 Vali Acc: 0.691 Test Loss: 0.654 Test Acc: 0.691
Validation loss decreased (-0.684204 --> -0.690783).  Saving model ...
Epoch: 38 cost time: 0.647028923034668
Epoch: 38, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.643 Vali Acc: 0.697 Test Loss: 0.643 Test Acc: 0.697
Validation loss decreased (-0.690783 --> -0.697362).  Saving model ...
Epoch: 39 cost time: 0.7159163951873779
Epoch: 39, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.635 Vali Acc: 0.704 Test Loss: 0.635 Test Acc: 0.704
Validation loss decreased (-0.697362 --> -0.703941).  Saving model ...
Epoch: 40 cost time: 0.7236812114715576
Epoch: 40, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.630 Vali Acc: 0.717 Test Loss: 0.630 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 41 cost time: 0.5319852828979492
Epoch: 41, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.621 Vali Acc: 0.717 Test Loss: 0.621 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 42 cost time: 0.6736757755279541
Epoch: 42, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 43 cost time: 0.8297052383422852
Epoch: 43, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.608 Vali Acc: 0.717 Test Loss: 0.608 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6529765129089355
Epoch: 44, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.602 Vali Acc: 0.717 Test Loss: 0.602 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8118071556091309
Epoch: 45, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.598 Vali Acc: 0.724 Test Loss: 0.598 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6878504753112793
Epoch: 46, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6446325778961182
Epoch: 47, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.588 Vali Acc: 0.724 Test Loss: 0.588 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6432700157165527
Epoch: 48, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.587 Vali Acc: 0.724 Test Loss: 0.587 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5921039581298828
Epoch: 49, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.583 Vali Acc: 0.737 Test Loss: 0.583 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 50 cost time: 0.7991411685943604
Epoch: 50, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.582 Vali Acc: 0.743 Test Loss: 0.582 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 51 cost time: 0.764150857925415
Epoch: 51, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 52 cost time: 0.6720273494720459
Epoch: 52, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.578 Vali Acc: 0.743 Test Loss: 0.578 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7796165943145752
Epoch: 53, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.580 Vali Acc: 0.743 Test Loss: 0.580 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6165904998779297
Epoch: 54, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 55 cost time: 0.6287565231323242
Epoch: 55, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6989514827728271
Epoch: 56, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.7528533935546875
Epoch: 57, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.584 Vali Acc: 0.743 Test Loss: 0.584 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7020022869110107
Epoch: 58, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6756107807159424
Epoch: 59, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6608779430389404
Epoch: 60, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7339978218078613
Epoch: 61, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.588 Vali Acc: 0.757 Test Loss: 0.588 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.8962540626525879
Epoch: 62, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7476544380187988
Epoch: 63, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.7591478824615479
Epoch: 64, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 2478
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8549113273620605
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.406 Vali Acc: 0.283 Test Loss: 1.406 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 0.578484058380127
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.395 Vali Acc: 0.289 Test Loss: 1.395 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 0.582014799118042
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.380 Vali Acc: 0.316 Test Loss: 1.380 Test Acc: 0.316
Validation loss decreased (-0.289460 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 0.5246343612670898
Epoch: 4, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.361 Vali Acc: 0.316 Test Loss: 1.361 Test Acc: 0.316
Validation loss decreased (-0.315776 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 0.723792552947998
Epoch: 5, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.342 Vali Acc: 0.336 Test Loss: 1.342 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 0.5403797626495361
Epoch: 6, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.321 Vali Acc: 0.368 Test Loss: 1.321 Test Acc: 0.368
Validation loss decreased (-0.335513 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 0.5604512691497803
Epoch: 7, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 8 cost time: 0.5506460666656494
Epoch: 8, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.277 Vali Acc: 0.434 Test Loss: 1.277 Test Acc: 0.434
Validation loss decreased (-0.414461 --> -0.434198).  Saving model ...
Epoch: 9 cost time: 0.5579288005828857
Epoch: 9, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.434198 --> -0.480251).  Saving model ...
Epoch: 10 cost time: 0.563779354095459
Epoch: 10, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.232 Vali Acc: 0.500 Test Loss: 1.232 Test Acc: 0.500
Validation loss decreased (-0.480251 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 0.5407273769378662
Epoch: 11, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.208 Vali Acc: 0.513 Test Loss: 1.208 Test Acc: 0.513
Validation loss decreased (-0.499988 --> -0.513146).  Saving model ...
Epoch: 12 cost time: 0.49674057960510254
Epoch: 12, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
Validation loss decreased (-0.513146 --> -0.519725).  Saving model ...
Epoch: 13 cost time: 0.5169878005981445
Epoch: 13, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.162 Vali Acc: 0.526 Test Loss: 1.162 Test Acc: 0.526
Validation loss decreased (-0.519725 --> -0.526304).  Saving model ...
Epoch: 14 cost time: 0.47808146476745605
Epoch: 14, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.138 Vali Acc: 0.579 Test Loss: 1.138 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578936).  Saving model ...
Epoch: 15 cost time: 0.5045592784881592
Epoch: 15, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.115 Vali Acc: 0.579 Test Loss: 1.115 Test Acc: 0.579
Validation loss decreased (-0.578936 --> -0.578936).  Saving model ...
Epoch: 16 cost time: 0.48895740509033203
Epoch: 16, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.091 Vali Acc: 0.592 Test Loss: 1.091 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592094).  Saving model ...
Epoch: 17 cost time: 0.5690057277679443
Epoch: 17, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.069 Vali Acc: 0.605 Test Loss: 1.069 Test Acc: 0.605
Validation loss decreased (-0.592094 --> -0.605252).  Saving model ...
Epoch: 18 cost time: 0.534045934677124
Epoch: 18, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.044 Vali Acc: 0.618 Test Loss: 1.044 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618411).  Saving model ...
Epoch: 19 cost time: 0.5100290775299072
Epoch: 19, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.020 Vali Acc: 0.605 Test Loss: 1.020 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5024890899658203
Epoch: 20, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.997 Vali Acc: 0.612 Test Loss: 0.997 Test Acc: 0.612
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5621769428253174
Epoch: 21, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.975 Vali Acc: 0.625 Test Loss: 0.975 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624990).  Saving model ...
Epoch: 22 cost time: 0.477830171585083
Epoch: 22, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.954 Vali Acc: 0.632 Test Loss: 0.954 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631569).  Saving model ...
Epoch: 23 cost time: 0.6693024635314941
Epoch: 23, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.932 Vali Acc: 0.651 Test Loss: 0.932 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651306).  Saving model ...
Epoch: 24 cost time: 0.49976181983947754
Epoch: 24, Steps: 10 | Train Loss: 0.766 Vali Loss: 0.911 Vali Acc: 0.658 Test Loss: 0.911 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 25 cost time: 0.5667223930358887
Epoch: 25, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.891 Vali Acc: 0.664 Test Loss: 0.891 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664465).  Saving model ...
Epoch: 26 cost time: 0.5772440433502197
Epoch: 26, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.871 Vali Acc: 0.671 Test Loss: 0.871 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671044).  Saving model ...
Epoch: 27 cost time: 0.6059298515319824
Epoch: 27, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.853 Vali Acc: 0.684 Test Loss: 0.853 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 28 cost time: 0.5569305419921875
Epoch: 28, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.836 Vali Acc: 0.678 Test Loss: 0.836 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.48635149002075195
Epoch: 29, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.820 Vali Acc: 0.678 Test Loss: 0.820 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7087795734405518
Epoch: 30, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.804 Vali Acc: 0.684 Test Loss: 0.804 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684202).  Saving model ...
Epoch: 31 cost time: 0.5635316371917725
Epoch: 31, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.790 Vali Acc: 0.691 Test Loss: 0.790 Test Acc: 0.691
Validation loss decreased (-0.684202 --> -0.690782).  Saving model ...
Epoch: 32 cost time: 0.6028079986572266
Epoch: 32, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.776 Vali Acc: 0.691 Test Loss: 0.776 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 33 cost time: 0.5718882083892822
Epoch: 33, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.762 Vali Acc: 0.691 Test Loss: 0.762 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 34 cost time: 0.570807695388794
Epoch: 34, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.751 Vali Acc: 0.697 Test Loss: 0.751 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 35 cost time: 0.5892410278320312
Epoch: 35, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.738 Vali Acc: 0.697 Test Loss: 0.738 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 36 cost time: 0.5483982563018799
Epoch: 36, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.728 Vali Acc: 0.697 Test Loss: 0.728 Test Acc: 0.697
Validation loss decreased (-0.697361 --> -0.697361).  Saving model ...
Epoch: 37 cost time: 0.5771036148071289
Epoch: 37, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.717 Vali Acc: 0.717 Test Loss: 0.717 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 38 cost time: 0.615703821182251
Epoch: 38, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.708 Vali Acc: 0.724 Test Loss: 0.708 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 39 cost time: 0.6783902645111084
Epoch: 39, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.700 Vali Acc: 0.730 Test Loss: 0.700 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 40 cost time: 0.6123058795928955
Epoch: 40, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 41 cost time: 0.617027759552002
Epoch: 41, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.688 Vali Acc: 0.750 Test Loss: 0.688 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 42 cost time: 0.6024527549743652
Epoch: 42, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.683 Vali Acc: 0.743 Test Loss: 0.683 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5660803318023682
Epoch: 43, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.5223429203033447
Epoch: 44, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.675 Vali Acc: 0.743 Test Loss: 0.675 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.5433595180511475
Epoch: 45, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 46 cost time: 0.6531713008880615
Epoch: 46, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.669 Vali Acc: 0.750 Test Loss: 0.669 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 47 cost time: 0.6146798133850098
Epoch: 47, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.662 Vali Acc: 0.743 Test Loss: 0.662 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5849108695983887
Epoch: 48, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.658 Vali Acc: 0.743 Test Loss: 0.658 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.529780387878418
Epoch: 49, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5212275981903076
Epoch: 50, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5556061267852783
Epoch: 51, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.6044700145721436
Epoch: 52, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.656 Vali Acc: 0.743 Test Loss: 0.656 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5468034744262695
Epoch: 53, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5511398315429688
Epoch: 54, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.657 Vali Acc: 0.743 Test Loss: 0.657 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5666279792785645
Epoch: 55, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749993).  Saving model ...
Epoch: 56 cost time: 0.5650715827941895
Epoch: 56, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.659 Vali Acc: 0.750 Test Loss: 0.659 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.4673340320587158
Epoch: 57, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.662 Vali Acc: 0.750 Test Loss: 0.662 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5302066802978516
Epoch: 58, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.671 Vali Acc: 0.750 Test Loss: 0.671 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5029342174530029
Epoch: 59, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5177335739135742
Epoch: 60, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5697150230407715
Epoch: 61, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.557023286819458
Epoch: 62, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5324718952178955
Epoch: 63, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5699100494384766
Epoch: 64, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5051693916320801
Epoch: 65, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.695 Vali Acc: 0.737 Test Loss: 0.695 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.75
model parameter : 2524
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8963727951049805
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.473 Vali Acc: 0.263 Test Loss: 1.473 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 0.588348388671875
Epoch: 2, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.459 Vali Acc: 0.276 Test Loss: 1.459 Test Acc: 0.276
Validation loss decreased (-0.263143 --> -0.276301).  Saving model ...
Epoch: 3 cost time: 0.6528050899505615
Epoch: 3, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.439 Vali Acc: 0.296 Test Loss: 1.439 Test Acc: 0.296
Validation loss decreased (-0.276301 --> -0.296038).  Saving model ...
Epoch: 4 cost time: 0.7014405727386475
Epoch: 4, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.416 Vali Acc: 0.329 Test Loss: 1.416 Test Acc: 0.329
Validation loss decreased (-0.296038 --> -0.328933).  Saving model ...
Epoch: 5 cost time: 0.6201589107513428
Epoch: 5, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.391 Vali Acc: 0.355 Test Loss: 1.391 Test Acc: 0.355
Validation loss decreased (-0.328933 --> -0.355249).  Saving model ...
Epoch: 6 cost time: 0.5393400192260742
Epoch: 6, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.365 Vali Acc: 0.375 Test Loss: 1.365 Test Acc: 0.375
Validation loss decreased (-0.355249 --> -0.374986).  Saving model ...
Epoch: 7 cost time: 0.6780657768249512
Epoch: 7, Steps: 10 | Train Loss: 1.298 Vali Loss: 1.340 Vali Acc: 0.388 Test Loss: 1.340 Test Acc: 0.388
Validation loss decreased (-0.374986 --> -0.388144).  Saving model ...
Epoch: 8 cost time: 0.6783223152160645
Epoch: 8, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.314 Vali Acc: 0.401 Test Loss: 1.314 Test Acc: 0.401
Validation loss decreased (-0.388144 --> -0.401303).  Saving model ...
Epoch: 9 cost time: 0.6940019130706787
Epoch: 9, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.287 Vali Acc: 0.428 Test Loss: 1.287 Test Acc: 0.428
Validation loss decreased (-0.401303 --> -0.427619).  Saving model ...
Epoch: 10 cost time: 0.646477460861206
Epoch: 10, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.259 Vali Acc: 0.467 Test Loss: 1.259 Test Acc: 0.467
Validation loss decreased (-0.427619 --> -0.467093).  Saving model ...
Epoch: 11 cost time: 0.7188973426818848
Epoch: 11, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.232 Vali Acc: 0.507 Test Loss: 1.232 Test Acc: 0.507
Validation loss decreased (-0.467093 --> -0.506567).  Saving model ...
Epoch: 12 cost time: 0.5045969486236572
Epoch: 12, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.204 Vali Acc: 0.500 Test Loss: 1.204 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5694637298583984
Epoch: 13, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.177 Vali Acc: 0.520 Test Loss: 1.177 Test Acc: 0.520
Validation loss decreased (-0.506567 --> -0.519725).  Saving model ...
Epoch: 14 cost time: 0.5731468200683594
Epoch: 14, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.149 Vali Acc: 0.539 Test Loss: 1.149 Test Acc: 0.539
Validation loss decreased (-0.519725 --> -0.539462).  Saving model ...
Epoch: 15 cost time: 0.9304409027099609
Epoch: 15, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.122 Vali Acc: 0.546 Test Loss: 1.122 Test Acc: 0.546
Validation loss decreased (-0.539462 --> -0.546041).  Saving model ...
Epoch: 16 cost time: 0.7262842655181885
Epoch: 16, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.095 Vali Acc: 0.553 Test Loss: 1.095 Test Acc: 0.553
Validation loss decreased (-0.546041 --> -0.552621).  Saving model ...
Epoch: 17 cost time: 0.6760475635528564
Epoch: 17, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.068 Vali Acc: 0.559 Test Loss: 1.068 Test Acc: 0.559
Validation loss decreased (-0.552621 --> -0.559200).  Saving model ...
Epoch: 18 cost time: 0.5614504814147949
Epoch: 18, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.043 Vali Acc: 0.559 Test Loss: 1.043 Test Acc: 0.559
Validation loss decreased (-0.559200 --> -0.559200).  Saving model ...
Epoch: 19 cost time: 0.6163759231567383
Epoch: 19, Steps: 10 | Train Loss: 0.899 Vali Loss: 1.018 Vali Acc: 0.566 Test Loss: 1.018 Test Acc: 0.566
Validation loss decreased (-0.559200 --> -0.565779).  Saving model ...
Epoch: 20 cost time: 0.7069647312164307
Epoch: 20, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.993 Vali Acc: 0.572 Test Loss: 0.993 Test Acc: 0.572
Validation loss decreased (-0.565779 --> -0.572358).  Saving model ...
Epoch: 21 cost time: 0.5457406044006348
Epoch: 21, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.969 Vali Acc: 0.586 Test Loss: 0.969 Test Acc: 0.586
Validation loss decreased (-0.572358 --> -0.585517).  Saving model ...
Epoch: 22 cost time: 0.6071579456329346
Epoch: 22, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.945 Vali Acc: 0.605 Test Loss: 0.945 Test Acc: 0.605
Validation loss decreased (-0.585517 --> -0.605254).  Saving model ...
Epoch: 23 cost time: 0.5294630527496338
Epoch: 23, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.921 Vali Acc: 0.618 Test Loss: 0.921 Test Acc: 0.618
Validation loss decreased (-0.605254 --> -0.618412).  Saving model ...
Epoch: 24 cost time: 0.6604197025299072
Epoch: 24, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.898 Vali Acc: 0.632 Test Loss: 0.898 Test Acc: 0.632
Validation loss decreased (-0.618412 --> -0.631570).  Saving model ...
Epoch: 25 cost time: 0.5499460697174072
Epoch: 25, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.878 Vali Acc: 0.632 Test Loss: 0.878 Test Acc: 0.632
Validation loss decreased (-0.631570 --> -0.631570).  Saving model ...
Epoch: 26 cost time: 0.5162327289581299
Epoch: 26, Steps: 10 | Train Loss: 0.693 Vali Loss: 0.857 Vali Acc: 0.651 Test Loss: 0.857 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 27 cost time: 0.5745806694030762
Epoch: 27, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.836 Vali Acc: 0.658 Test Loss: 0.836 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 28 cost time: 0.5195703506469727
Epoch: 28, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.816 Vali Acc: 0.651 Test Loss: 0.816 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6014413833618164
Epoch: 29, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.798 Vali Acc: 0.671 Test Loss: 0.798 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671045).  Saving model ...
Epoch: 30 cost time: 0.6029162406921387
Epoch: 30, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.779 Vali Acc: 0.678 Test Loss: 0.779 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677624).  Saving model ...
Epoch: 31 cost time: 0.5579731464385986
Epoch: 31, Steps: 10 | Train Loss: 0.565 Vali Loss: 0.762 Vali Acc: 0.684 Test Loss: 0.762 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 32 cost time: 0.49957799911499023
Epoch: 32, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.747 Vali Acc: 0.697 Test Loss: 0.747 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 33 cost time: 0.5559325218200684
Epoch: 33, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.732 Vali Acc: 0.704 Test Loss: 0.732 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 34 cost time: 0.4472341537475586
Epoch: 34, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.719 Vali Acc: 0.704 Test Loss: 0.719 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703940).  Saving model ...
Epoch: 35 cost time: 0.537041187286377
Epoch: 35, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.705 Vali Acc: 0.724 Test Loss: 0.705 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 36 cost time: 0.5584218502044678
Epoch: 36, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.694 Vali Acc: 0.730 Test Loss: 0.694 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 37 cost time: 0.5593447685241699
Epoch: 37, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.682 Vali Acc: 0.730 Test Loss: 0.682 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730256).  Saving model ...
Epoch: 38 cost time: 0.5891909599304199
Epoch: 38, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.673 Vali Acc: 0.737 Test Loss: 0.673 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 39 cost time: 0.6033542156219482
Epoch: 39, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743414).  Saving model ...
Epoch: 40 cost time: 0.6429598331451416
Epoch: 40, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 41 cost time: 0.588651180267334
Epoch: 41, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756572).  Saving model ...
Epoch: 42 cost time: 0.6340932846069336
Epoch: 42, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.639 Vali Acc: 0.763 Test Loss: 0.639 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 43 cost time: 0.5879271030426025
Epoch: 43, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.634 Vali Acc: 0.776 Test Loss: 0.634 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776309).  Saving model ...
Epoch: 44 cost time: 0.6348593235015869
Epoch: 44, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776309).  Saving model ...
Epoch: 45 cost time: 0.6030290126800537
Epoch: 45, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 46 cost time: 0.583714485168457
Epoch: 46, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.626 Vali Acc: 0.783 Test Loss: 0.626 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 47 cost time: 0.6811461448669434
Epoch: 47, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 48 cost time: 0.6013753414154053
Epoch: 48, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 49 cost time: 0.6282408237457275
Epoch: 49, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7324409484863281
Epoch: 50, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.632 Vali Acc: 0.783 Test Loss: 0.632 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6032633781433105
Epoch: 51, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 52 cost time: 0.7253179550170898
Epoch: 52, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5422091484069824
Epoch: 53, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.649 Vali Acc: 0.789 Test Loss: 0.649 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6755316257476807
Epoch: 54, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.659 Vali Acc: 0.789 Test Loss: 0.659 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5620644092559814
Epoch: 55, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6875934600830078
Epoch: 56, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5825767517089844
Epoch: 57, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.5986654758453369
Epoch: 58, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 59 cost time: 0.5947067737579346
Epoch: 59, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.644463062286377
Epoch: 60, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6582708358764648
Epoch: 61, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.709 Vali Acc: 0.783 Test Loss: 0.709 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.5285589694976807
Epoch: 62, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.47896909713745117
Epoch: 63, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.5133073329925537
Epoch: 64, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.5499980449676514
Epoch: 65, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.763 Vali Acc: 0.796 Test Loss: 0.763 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.5448603630065918
Epoch: 66, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.756 Vali Acc: 0.803 Test Loss: 0.756 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.5681664943695068
Epoch: 67, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.6193866729736328
Epoch: 68, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2454
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8538601398468018
Epoch: 1, Steps: 10 | Train Loss: 1.498 Vali Loss: 1.444 Vali Acc: 0.217 Test Loss: 1.444 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 0.6347622871398926
Epoch: 2, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.432 Vali Acc: 0.230 Test Loss: 1.432 Test Acc: 0.230
Validation loss decreased (-0.217091 --> -0.230249).  Saving model ...
Epoch: 3 cost time: 0.665550947189331
Epoch: 3, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.415 Vali Acc: 0.237 Test Loss: 1.415 Test Acc: 0.237
Validation loss decreased (-0.230249 --> -0.236828).  Saving model ...
Epoch: 4 cost time: 0.7411336898803711
Epoch: 4, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.396 Vali Acc: 0.257 Test Loss: 1.396 Test Acc: 0.257
Validation loss decreased (-0.236828 --> -0.256565).  Saving model ...
Epoch: 5 cost time: 0.669914722442627
Epoch: 5, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.375 Vali Acc: 0.309 Test Loss: 1.375 Test Acc: 0.309
Validation loss decreased (-0.256565 --> -0.309197).  Saving model ...
Epoch: 6 cost time: 0.6521306037902832
Epoch: 6, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.353 Vali Acc: 0.322 Test Loss: 1.353 Test Acc: 0.322
Validation loss decreased (-0.309197 --> -0.322355).  Saving model ...
Epoch: 7 cost time: 0.6462767124176025
Epoch: 7, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.331 Vali Acc: 0.362 Test Loss: 1.331 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 8 cost time: 0.5858020782470703
Epoch: 8, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.307 Vali Acc: 0.401 Test Loss: 1.307 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 9 cost time: 0.5468645095825195
Epoch: 9, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.285 Vali Acc: 0.434 Test Loss: 1.285 Test Acc: 0.434
Validation loss decreased (-0.401303 --> -0.434198).  Saving model ...
Epoch: 10 cost time: 0.593940019607544
Epoch: 10, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.261 Vali Acc: 0.480 Test Loss: 1.261 Test Acc: 0.480
Validation loss decreased (-0.434198 --> -0.480251).  Saving model ...
Epoch: 11 cost time: 0.6608662605285645
Epoch: 11, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.238 Vali Acc: 0.507 Test Loss: 1.238 Test Acc: 0.507
Validation loss decreased (-0.480251 --> -0.506567).  Saving model ...
Epoch: 12 cost time: 0.6150376796722412
Epoch: 12, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.215 Vali Acc: 0.533 Test Loss: 1.215 Test Acc: 0.533
Validation loss decreased (-0.506567 --> -0.532883).  Saving model ...
Epoch: 13 cost time: 0.5636930465698242
Epoch: 13, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.191 Vali Acc: 0.526 Test Loss: 1.191 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6621856689453125
Epoch: 14, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.166 Vali Acc: 0.553 Test Loss: 1.166 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552620).  Saving model ...
Epoch: 15 cost time: 0.5820248126983643
Epoch: 15, Steps: 10 | Train Loss: 1.069 Vali Loss: 1.143 Vali Acc: 0.586 Test Loss: 1.143 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585515).  Saving model ...
Epoch: 16 cost time: 0.6206729412078857
Epoch: 16, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.117 Vali Acc: 0.612 Test Loss: 1.117 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 17 cost time: 0.7715785503387451
Epoch: 17, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.093 Vali Acc: 0.618 Test Loss: 1.093 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618410).  Saving model ...
Epoch: 18 cost time: 0.6198840141296387
Epoch: 18, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.069 Vali Acc: 0.632 Test Loss: 1.069 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631568).  Saving model ...
Epoch: 19 cost time: 0.6452460289001465
Epoch: 19, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.044 Vali Acc: 0.632 Test Loss: 1.044 Test Acc: 0.632
Validation loss decreased (-0.631568 --> -0.631569).  Saving model ...
Epoch: 20 cost time: 0.6013290882110596
Epoch: 20, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.020 Vali Acc: 0.645 Test Loss: 1.020 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644727).  Saving model ...
Epoch: 21 cost time: 0.590867280960083
Epoch: 21, Steps: 10 | Train Loss: 0.870 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5744082927703857
Epoch: 22, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.972 Vali Acc: 0.638 Test Loss: 0.972 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7872788906097412
Epoch: 23, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.950 Vali Acc: 0.638 Test Loss: 0.950 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7284953594207764
Epoch: 24, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.927 Vali Acc: 0.632 Test Loss: 0.927 Test Acc: 0.632
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5659997463226318
Epoch: 25, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.904 Vali Acc: 0.632 Test Loss: 0.904 Test Acc: 0.632
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5667724609375
Epoch: 26, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.882 Vali Acc: 0.645 Test Loss: 0.882 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 27 cost time: 0.5148041248321533
Epoch: 27, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.862 Vali Acc: 0.638 Test Loss: 0.862 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5356969833374023
Epoch: 28, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.842 Vali Acc: 0.651 Test Loss: 0.842 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651307).  Saving model ...
Epoch: 29 cost time: 0.5725290775299072
Epoch: 29, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.822 Vali Acc: 0.658 Test Loss: 0.822 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 30 cost time: 0.6913237571716309
Epoch: 30, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.804 Vali Acc: 0.658 Test Loss: 0.804 Test Acc: 0.658
Validation loss decreased (-0.657887 --> -0.657887).  Saving model ...
Epoch: 31 cost time: 0.5269570350646973
Epoch: 31, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.787 Vali Acc: 0.664 Test Loss: 0.787 Test Acc: 0.664
Validation loss decreased (-0.657887 --> -0.664466).  Saving model ...
Epoch: 32 cost time: 0.4810447692871094
Epoch: 32, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.771 Vali Acc: 0.671 Test Loss: 0.771 Test Acc: 0.671
Validation loss decreased (-0.664466 --> -0.671045).  Saving model ...
Epoch: 33 cost time: 0.49982619285583496
Epoch: 33, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.757 Vali Acc: 0.684 Test Loss: 0.757 Test Acc: 0.684
Validation loss decreased (-0.671045 --> -0.684203).  Saving model ...
Epoch: 34 cost time: 0.5149493217468262
Epoch: 34, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.742 Vali Acc: 0.684 Test Loss: 0.742 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684203).  Saving model ...
Epoch: 35 cost time: 0.6166861057281494
Epoch: 35, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.729 Vali Acc: 0.697 Test Loss: 0.729 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 36 cost time: 0.5488801002502441
Epoch: 36, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 37 cost time: 0.5984344482421875
Epoch: 37, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 38 cost time: 0.530996561050415
Epoch: 38, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.693 Vali Acc: 0.724 Test Loss: 0.693 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 39 cost time: 0.5042872428894043
Epoch: 39, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5710933208465576
Epoch: 40, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.671 Vali Acc: 0.730 Test Loss: 0.671 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 41 cost time: 0.6450133323669434
Epoch: 41, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.659 Vali Acc: 0.717 Test Loss: 0.659 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7078585624694824
Epoch: 42, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7195041179656982
Epoch: 43, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6699426174163818
Epoch: 44, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 45 cost time: 0.5716552734375
Epoch: 45, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 46 cost time: 0.5382778644561768
Epoch: 46, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.621 Vali Acc: 0.730 Test Loss: 0.621 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6748151779174805
Epoch: 47, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.611 Vali Acc: 0.743 Test Loss: 0.611 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 48 cost time: 0.7016541957855225
Epoch: 48, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 49 cost time: 0.7084486484527588
Epoch: 49, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 50 cost time: 0.6810359954833984
Epoch: 50, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 51 cost time: 0.5692856311798096
Epoch: 51, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 52 cost time: 0.6078393459320068
Epoch: 52, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 53 cost time: 0.5687546730041504
Epoch: 53, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 54 cost time: 0.6224362850189209
Epoch: 54, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6355695724487305
Epoch: 55, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 56 cost time: 0.6731030941009521
Epoch: 56, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7144889831542969
Epoch: 57, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6043179035186768
Epoch: 58, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.7242085933685303
Epoch: 59, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5982515811920166
Epoch: 60, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6036536693572998
Epoch: 61, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5783021450042725
Epoch: 62, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6726770401000977
Epoch: 63, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.7118110656738281
Epoch: 64, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5298810005187988
Epoch: 65, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 66 cost time: 0.546410322189331
Epoch: 66, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.571 Vali Acc: 0.789 Test Loss: 0.571 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.541412353515625
Epoch: 67, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.639052152633667
Epoch: 68, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.582 Vali Acc: 0.796 Test Loss: 0.582 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5853676795959473
Epoch: 69, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6349213123321533
Epoch: 70, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.5520997047424316
Epoch: 71, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5318467617034912
Epoch: 72, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5467257499694824
Epoch: 73, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.614 Vali Acc: 0.796 Test Loss: 0.614 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.4636502265930176
Epoch: 74, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.46843862533569336
Epoch: 75, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2464
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.745150089263916
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.351 Vali Acc: 0.322 Test Loss: 1.351 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.47804856300354004
Epoch: 2, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.341 Vali Acc: 0.322 Test Loss: 1.341 Test Acc: 0.322
Validation loss decreased (-0.322355 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 0.4524400234222412
Epoch: 3, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.329 Vali Acc: 0.349 Test Loss: 1.329 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 0.46825170516967773
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.314 Vali Acc: 0.355 Test Loss: 1.314 Test Acc: 0.355
Validation loss decreased (-0.348671 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 0.5826315879821777
Epoch: 5, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.296 Vali Acc: 0.368 Test Loss: 1.296 Test Acc: 0.368
Validation loss decreased (-0.355250 --> -0.368408).  Saving model ...
Epoch: 6 cost time: 0.5787909030914307
Epoch: 6, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.278 Vali Acc: 0.421 Test Loss: 1.278 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 7 cost time: 0.6074068546295166
Epoch: 7, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.259 Vali Acc: 0.434 Test Loss: 1.259 Test Acc: 0.434
Validation loss decreased (-0.421040 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 0.4741675853729248
Epoch: 8, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.237 Vali Acc: 0.434 Test Loss: 1.237 Test Acc: 0.434
Validation loss decreased (-0.434198 --> -0.434198).  Saving model ...
Epoch: 9 cost time: 0.48308610916137695
Epoch: 9, Steps: 10 | Train Loss: 1.264 Vali Loss: 1.216 Vali Acc: 0.441 Test Loss: 1.216 Test Acc: 0.441
Validation loss decreased (-0.434198 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 0.5626118183135986
Epoch: 10, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.194 Vali Acc: 0.441 Test Loss: 1.194 Test Acc: 0.441
Validation loss decreased (-0.440777 --> -0.440778).  Saving model ...
Epoch: 11 cost time: 0.5854113101959229
Epoch: 11, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.172 Vali Acc: 0.467 Test Loss: 1.172 Test Acc: 0.467
Validation loss decreased (-0.440778 --> -0.467094).  Saving model ...
Epoch: 12 cost time: 0.5383450984954834
Epoch: 12, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.149 Vali Acc: 0.487 Test Loss: 1.149 Test Acc: 0.487
Validation loss decreased (-0.467094 --> -0.486831).  Saving model ...
Epoch: 13 cost time: 0.5309469699859619
Epoch: 13, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.125 Vali Acc: 0.493 Test Loss: 1.125 Test Acc: 0.493
Validation loss decreased (-0.486831 --> -0.493410).  Saving model ...
Epoch: 14 cost time: 0.5850777626037598
Epoch: 14, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.101 Vali Acc: 0.513 Test Loss: 1.101 Test Acc: 0.513
Validation loss decreased (-0.493410 --> -0.513147).  Saving model ...
Epoch: 15 cost time: 0.4688112735748291
Epoch: 15, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.077 Vali Acc: 0.533 Test Loss: 1.077 Test Acc: 0.533
Validation loss decreased (-0.513147 --> -0.532884).  Saving model ...
Epoch: 16 cost time: 0.4095900058746338
Epoch: 16, Steps: 10 | Train Loss: 1.029 Vali Loss: 1.053 Vali Acc: 0.553 Test Loss: 1.053 Test Acc: 0.553
Validation loss decreased (-0.532884 --> -0.552621).  Saving model ...
Epoch: 17 cost time: 0.5634217262268066
Epoch: 17, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.029 Vali Acc: 0.579 Test Loss: 1.029 Test Acc: 0.579
Validation loss decreased (-0.552621 --> -0.578937).  Saving model ...
Epoch: 18 cost time: 0.5872070789337158
Epoch: 18, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.005 Vali Acc: 0.586 Test Loss: 1.005 Test Acc: 0.586
Validation loss decreased (-0.578937 --> -0.585516).  Saving model ...
Epoch: 19 cost time: 0.5918846130371094
Epoch: 19, Steps: 10 | Train Loss: 0.917 Vali Loss: 0.980 Vali Acc: 0.605 Test Loss: 0.980 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605253).  Saving model ...
Epoch: 20 cost time: 0.5828158855438232
Epoch: 20, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.956 Vali Acc: 0.605 Test Loss: 0.956 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605254).  Saving model ...
Epoch: 21 cost time: 0.6029374599456787
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.932 Vali Acc: 0.625 Test Loss: 0.932 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624991).  Saving model ...
Epoch: 22 cost time: 0.562237024307251
Epoch: 22, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.908 Vali Acc: 0.651 Test Loss: 0.908 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651307).  Saving model ...
Epoch: 23 cost time: 0.634521484375
Epoch: 23, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.887 Vali Acc: 0.658 Test Loss: 0.887 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657886).  Saving model ...
Epoch: 24 cost time: 0.6083636283874512
Epoch: 24, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.864 Vali Acc: 0.678 Test Loss: 0.864 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 25 cost time: 0.5955245494842529
Epoch: 25, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.842 Vali Acc: 0.691 Test Loss: 0.842 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 26 cost time: 0.6323394775390625
Epoch: 26, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.822 Vali Acc: 0.711 Test Loss: 0.822 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 27 cost time: 0.6188325881958008
Epoch: 27, Steps: 10 | Train Loss: 0.675 Vali Loss: 0.801 Vali Acc: 0.730 Test Loss: 0.801 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 28 cost time: 0.6173338890075684
Epoch: 28, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.782 Vali Acc: 0.730 Test Loss: 0.782 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730255).  Saving model ...
Epoch: 29 cost time: 0.48217058181762695
Epoch: 29, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736834).  Saving model ...
Epoch: 30 cost time: 0.607616662979126
Epoch: 30, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.747 Vali Acc: 0.724 Test Loss: 0.747 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.516453742980957
Epoch: 31, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.730 Vali Acc: 0.730 Test Loss: 0.730 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5946054458618164
Epoch: 32, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.715 Vali Acc: 0.724 Test Loss: 0.715 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5842351913452148
Epoch: 33, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7294182777404785
Epoch: 34, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.688 Vali Acc: 0.730 Test Loss: 0.688 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5734713077545166
Epoch: 35, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.675 Vali Acc: 0.743 Test Loss: 0.675 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 36 cost time: 0.5547671318054199
Epoch: 36, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 37 cost time: 0.5813202857971191
Epoch: 37, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.654 Vali Acc: 0.743 Test Loss: 0.654 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743415).  Saving model ...
Epoch: 38 cost time: 0.5747377872467041
Epoch: 38, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.644 Vali Acc: 0.743 Test Loss: 0.644 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 39 cost time: 0.6588292121887207
Epoch: 39, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 40 cost time: 0.548898458480835
Epoch: 40, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 41 cost time: 0.5991992950439453
Epoch: 41, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 42 cost time: 0.6908645629882812
Epoch: 42, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.608 Vali Acc: 0.750 Test Loss: 0.608 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 43 cost time: 0.6290137767791748
Epoch: 43, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 44 cost time: 0.6967442035675049
Epoch: 44, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 45 cost time: 0.5823862552642822
Epoch: 45, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.589 Vali Acc: 0.750 Test Loss: 0.589 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 46 cost time: 0.6144652366638184
Epoch: 46, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 47 cost time: 0.5426921844482422
Epoch: 47, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 48 cost time: 0.6314103603363037
Epoch: 48, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 49 cost time: 0.6487088203430176
Epoch: 49, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 50 cost time: 0.5562376976013184
Epoch: 50, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 51 cost time: 0.5862298011779785
Epoch: 51, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.574 Vali Acc: 0.763 Test Loss: 0.574 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 52 cost time: 0.46465373039245605
Epoch: 52, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 53 cost time: 0.5120234489440918
Epoch: 53, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 54 cost time: 0.6726927757263184
Epoch: 54, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 55 cost time: 0.5495953559875488
Epoch: 55, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.48511457443237305
Epoch: 56, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.4645848274230957
Epoch: 57, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6107110977172852
Epoch: 58, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 59 cost time: 0.5455007553100586
Epoch: 59, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 60 cost time: 0.6591300964355469
Epoch: 60, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.58345627784729
Epoch: 61, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6254312992095947
Epoch: 62, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5687198638916016
Epoch: 63, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 64 cost time: 0.5635876655578613
Epoch: 64, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5374364852905273
Epoch: 65, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6133127212524414
Epoch: 66, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5923004150390625
Epoch: 67, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.6648099422454834
Epoch: 68, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.7239091396331787
Epoch: 69, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.5933332443237305
Epoch: 70, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.6730899810791016
Epoch: 71, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.712 Vali Acc: 0.796 Test Loss: 0.712 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.6392579078674316
Epoch: 72, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.6633892059326172
Epoch: 73, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.733 Vali Acc: 0.796 Test Loss: 0.733 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2572
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.8093011379241943
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.476 Vali Acc: 0.263 Test Loss: 1.476 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 0.5954563617706299
Epoch: 2, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.463 Vali Acc: 0.263 Test Loss: 1.463 Test Acc: 0.263
Validation loss decreased (-0.263143 --> -0.263143).  Saving model ...
Epoch: 3 cost time: 0.6484873294830322
Epoch: 3, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
Validation loss decreased (-0.263143 --> -0.269722).  Saving model ...
Epoch: 4 cost time: 0.6245331764221191
Epoch: 4, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.426 Vali Acc: 0.270 Test Loss: 1.426 Test Acc: 0.270
Validation loss decreased (-0.269722 --> -0.269723).  Saving model ...
Epoch: 5 cost time: 0.4930126667022705
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.405 Vali Acc: 0.270 Test Loss: 1.405 Test Acc: 0.270
Validation loss decreased (-0.269723 --> -0.269723).  Saving model ...
Epoch: 6 cost time: 0.5261895656585693
Epoch: 6, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.383 Vali Acc: 0.296 Test Loss: 1.383 Test Acc: 0.296
Validation loss decreased (-0.269723 --> -0.296039).  Saving model ...
Epoch: 7 cost time: 0.47886157035827637
Epoch: 7, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.358 Vali Acc: 0.342 Test Loss: 1.358 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342092).  Saving model ...
Epoch: 8 cost time: 0.5356006622314453
Epoch: 8, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.335 Vali Acc: 0.349 Test Loss: 1.335 Test Acc: 0.349
Validation loss decreased (-0.342092 --> -0.348671).  Saving model ...
Epoch: 9 cost time: 0.5598728656768799
Epoch: 9, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.312 Vali Acc: 0.362 Test Loss: 1.312 Test Acc: 0.362
Validation loss decreased (-0.348671 --> -0.361829).  Saving model ...
Epoch: 10 cost time: 0.6728878021240234
Epoch: 10, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.289 Vali Acc: 0.382 Test Loss: 1.289 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 11 cost time: 0.5335443019866943
Epoch: 11, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.264 Vali Acc: 0.408 Test Loss: 1.264 Test Acc: 0.408
Validation loss decreased (-0.381566 --> -0.407882).  Saving model ...
Epoch: 12 cost time: 0.5908858776092529
Epoch: 12, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.240 Vali Acc: 0.428 Test Loss: 1.240 Test Acc: 0.428
Validation loss decreased (-0.407882 --> -0.427619).  Saving model ...
Epoch: 13 cost time: 0.5503137111663818
Epoch: 13, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.216 Vali Acc: 0.441 Test Loss: 1.216 Test Acc: 0.441
Validation loss decreased (-0.427619 --> -0.440777).  Saving model ...
Epoch: 14 cost time: 0.6044228076934814
Epoch: 14, Steps: 10 | Train Loss: 1.107 Vali Loss: 1.190 Vali Acc: 0.434 Test Loss: 1.190 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.661426305770874
Epoch: 15, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.166 Vali Acc: 0.461 Test Loss: 1.166 Test Acc: 0.461
Validation loss decreased (-0.440777 --> -0.460515).  Saving model ...
Epoch: 16 cost time: 0.6473281383514404
Epoch: 16, Steps: 10 | Train Loss: 1.036 Vali Loss: 1.141 Vali Acc: 0.480 Test Loss: 1.141 Test Acc: 0.480
Validation loss decreased (-0.460515 --> -0.480252).  Saving model ...
Epoch: 17 cost time: 0.6110353469848633
Epoch: 17, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.480252 --> -0.519726).  Saving model ...
Epoch: 18 cost time: 0.6478283405303955
Epoch: 18, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.094 Vali Acc: 0.526 Test Loss: 1.094 Test Acc: 0.526
Validation loss decreased (-0.519726 --> -0.526305).  Saving model ...
Epoch: 19 cost time: 0.5549662113189697
Epoch: 19, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.071 Vali Acc: 0.533 Test Loss: 1.071 Test Acc: 0.533
Validation loss decreased (-0.526305 --> -0.532884).  Saving model ...
Epoch: 20 cost time: 0.5198571681976318
Epoch: 20, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.047 Vali Acc: 0.539 Test Loss: 1.047 Test Acc: 0.539
Validation loss decreased (-0.532884 --> -0.539463).  Saving model ...
Epoch: 21 cost time: 0.5631539821624756
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.021 Vali Acc: 0.553 Test Loss: 1.021 Test Acc: 0.553
Validation loss decreased (-0.539463 --> -0.552621).  Saving model ...
Epoch: 22 cost time: 0.7415304183959961
Epoch: 22, Steps: 10 | Train Loss: 0.853 Vali Loss: 0.997 Vali Acc: 0.566 Test Loss: 0.997 Test Acc: 0.566
Validation loss decreased (-0.552621 --> -0.565779).  Saving model ...
Epoch: 23 cost time: 0.5644073486328125
Epoch: 23, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.972 Vali Acc: 0.592 Test Loss: 0.972 Test Acc: 0.592
Validation loss decreased (-0.565779 --> -0.592096).  Saving model ...
Epoch: 24 cost time: 0.6175804138183594
Epoch: 24, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.947 Vali Acc: 0.605 Test Loss: 0.947 Test Acc: 0.605
Validation loss decreased (-0.592096 --> -0.605254).  Saving model ...
Epoch: 25 cost time: 0.5776321887969971
Epoch: 25, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.924 Vali Acc: 0.612 Test Loss: 0.924 Test Acc: 0.612
Validation loss decreased (-0.605254 --> -0.611833).  Saving model ...
Epoch: 26 cost time: 0.6086752414703369
Epoch: 26, Steps: 10 | Train Loss: 0.718 Vali Loss: 0.899 Vali Acc: 0.612 Test Loss: 0.899 Test Acc: 0.612
Validation loss decreased (-0.611833 --> -0.611833).  Saving model ...
Epoch: 27 cost time: 0.5978372097015381
Epoch: 27, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.877 Vali Acc: 0.612 Test Loss: 0.877 Test Acc: 0.612
Validation loss decreased (-0.611833 --> -0.611833).  Saving model ...
Epoch: 28 cost time: 0.818289041519165
Epoch: 28, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.855 Vali Acc: 0.632 Test Loss: 0.855 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 29 cost time: 0.7321977615356445
Epoch: 29, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.833 Vali Acc: 0.638 Test Loss: 0.833 Test Acc: 0.638
Validation loss decreased (-0.631570 --> -0.638150).  Saving model ...
Epoch: 30 cost time: 0.6413142681121826
Epoch: 30, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.811 Vali Acc: 0.651 Test Loss: 0.811 Test Acc: 0.651
Validation loss decreased (-0.638150 --> -0.651308).  Saving model ...
Epoch: 31 cost time: 0.6035220623016357
Epoch: 31, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.790 Vali Acc: 0.678 Test Loss: 0.790 Test Acc: 0.678
Validation loss decreased (-0.651308 --> -0.677624).  Saving model ...
Epoch: 32 cost time: 0.5971784591674805
Epoch: 32, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5678377151489258
Epoch: 33, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.750 Vali Acc: 0.664 Test Loss: 0.750 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7638397216796875
Epoch: 34, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.731 Vali Acc: 0.684 Test Loss: 0.731 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 35 cost time: 0.6314389705657959
Epoch: 35, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.712 Vali Acc: 0.691 Test Loss: 0.712 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 36 cost time: 0.6492650508880615
Epoch: 36, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.694 Vali Acc: 0.704 Test Loss: 0.694 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 37 cost time: 0.6157975196838379
Epoch: 37, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.681 Vali Acc: 0.697 Test Loss: 0.681 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7078473567962646
Epoch: 38, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.666 Vali Acc: 0.717 Test Loss: 0.666 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717099).  Saving model ...
Epoch: 39 cost time: 0.5965852737426758
Epoch: 39, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.648 Vali Acc: 0.711 Test Loss: 0.648 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.703582763671875
Epoch: 40, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 41 cost time: 0.521618127822876
Epoch: 41, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
Validation loss decreased (-0.717099 --> -0.717099).  Saving model ...
Epoch: 42 cost time: 0.8200068473815918
Epoch: 42, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 43 cost time: 0.5869174003601074
Epoch: 43, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.608 Vali Acc: 0.743 Test Loss: 0.608 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 44 cost time: 0.5949749946594238
Epoch: 44, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 45 cost time: 0.5589456558227539
Epoch: 45, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 46 cost time: 0.6013331413269043
Epoch: 46, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 47 cost time: 0.5879600048065186
Epoch: 47, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 48 cost time: 0.5582590103149414
Epoch: 48, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 49 cost time: 0.7403609752655029
Epoch: 49, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.567 Vali Acc: 0.750 Test Loss: 0.567 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5928430557250977
Epoch: 50, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5358960628509521
Epoch: 51, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.590329647064209
Epoch: 52, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.557 Vali Acc: 0.750 Test Loss: 0.557 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5942659378051758
Epoch: 53, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5466506481170654
Epoch: 54, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 55 cost time: 0.6126806735992432
Epoch: 55, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.556 Vali Acc: 0.757 Test Loss: 0.556 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.5929062366485596
Epoch: 56, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6314353942871094
Epoch: 57, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.548 Vali Acc: 0.750 Test Loss: 0.548 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6691160202026367
Epoch: 58, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 59 cost time: 0.7588918209075928
Epoch: 59, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 60 cost time: 0.6605715751647949
Epoch: 60, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5881321430206299
Epoch: 61, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 62 cost time: 0.7061142921447754
Epoch: 62, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.549 Vali Acc: 0.757 Test Loss: 0.549 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5931518077850342
Epoch: 63, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6473469734191895
Epoch: 64, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5796911716461182
Epoch: 65, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 66 cost time: 0.6182167530059814
Epoch: 66, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 67 cost time: 0.533435583114624
Epoch: 67, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6569976806640625
Epoch: 68, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5609612464904785
Epoch: 69, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.7586219310760498
Epoch: 70, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5524885654449463
Epoch: 71, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6403379440307617
Epoch: 72, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.5910334587097168
Epoch: 73, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5699574947357178
Epoch: 74, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.536675214767456
Epoch: 75, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.5982365608215332
Epoch: 76, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 2576
model size : 0.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 1.610229730606079
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.360 Vali Acc: 0.322 Test Loss: 1.360 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 0.5004324913024902
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.352 Vali Acc: 0.329 Test Loss: 1.352 Test Acc: 0.329
Validation loss decreased (-0.322355 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 0.646303653717041
Epoch: 3, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.341 Vali Acc: 0.336 Test Loss: 1.341 Test Acc: 0.336
Validation loss decreased (-0.328934 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 0.5437004566192627
Epoch: 4, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.328 Vali Acc: 0.349 Test Loss: 1.328 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.5281333923339844
Epoch: 5, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.313 Vali Acc: 0.342 Test Loss: 1.313 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.46663403511047363
Epoch: 6, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.297 Vali Acc: 0.362 Test Loss: 1.297 Test Acc: 0.362
Validation loss decreased (-0.348671 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 0.4608592987060547
Epoch: 7, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.280 Vali Acc: 0.388 Test Loss: 1.280 Test Acc: 0.388
Validation loss decreased (-0.361829 --> -0.388145).  Saving model ...
Epoch: 8 cost time: 0.558786153793335
Epoch: 8, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.263 Vali Acc: 0.421 Test Loss: 1.263 Test Acc: 0.421
Validation loss decreased (-0.388145 --> -0.421040).  Saving model ...
Epoch: 9 cost time: 0.5129380226135254
Epoch: 9, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.244 Vali Acc: 0.428 Test Loss: 1.244 Test Acc: 0.428
Validation loss decreased (-0.421040 --> -0.427619).  Saving model ...
Epoch: 10 cost time: 0.599071741104126
Epoch: 10, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.224 Vali Acc: 0.461 Test Loss: 1.224 Test Acc: 0.461
Validation loss decreased (-0.427619 --> -0.460514).  Saving model ...
Epoch: 11 cost time: 0.559241533279419
Epoch: 11, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.204 Vali Acc: 0.513 Test Loss: 1.204 Test Acc: 0.513
Validation loss decreased (-0.460514 --> -0.513146).  Saving model ...
Epoch: 12 cost time: 0.5376579761505127
Epoch: 12, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.183 Vali Acc: 0.533 Test Loss: 1.183 Test Acc: 0.533
Validation loss decreased (-0.513146 --> -0.532883).  Saving model ...
Epoch: 13 cost time: 0.59297776222229
Epoch: 13, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.161 Vali Acc: 0.599 Test Loss: 1.161 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598673).  Saving model ...
Epoch: 14 cost time: 0.6021051406860352
Epoch: 14, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.140 Vali Acc: 0.605 Test Loss: 1.140 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605252).  Saving model ...
Epoch: 15 cost time: 0.5486528873443604
Epoch: 15, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.116 Vali Acc: 0.645 Test Loss: 1.116 Test Acc: 0.645
Validation loss decreased (-0.605252 --> -0.644726).  Saving model ...
Epoch: 16 cost time: 0.7193200588226318
Epoch: 16, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.093 Vali Acc: 0.645 Test Loss: 1.093 Test Acc: 0.645
Validation loss decreased (-0.644726 --> -0.644726).  Saving model ...
Epoch: 17 cost time: 0.6036961078643799
Epoch: 17, Steps: 10 | Train Loss: 1.003 Vali Loss: 1.070 Vali Acc: 0.658 Test Loss: 1.070 Test Acc: 0.658
Validation loss decreased (-0.644726 --> -0.657884).  Saving model ...
Epoch: 18 cost time: 0.538752555847168
Epoch: 18, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.047 Vali Acc: 0.658 Test Loss: 1.047 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657884).  Saving model ...
Epoch: 19 cost time: 0.5197134017944336
Epoch: 19, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.025 Vali Acc: 0.684 Test Loss: 1.025 Test Acc: 0.684
Validation loss decreased (-0.657884 --> -0.684200).  Saving model ...
Epoch: 20 cost time: 0.5867898464202881
Epoch: 20, Steps: 10 | Train Loss: 0.898 Vali Loss: 1.000 Vali Acc: 0.691 Test Loss: 1.000 Test Acc: 0.691
Validation loss decreased (-0.684200 --> -0.690779).  Saving model ...
Epoch: 21 cost time: 0.5411586761474609
Epoch: 21, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.975 Vali Acc: 0.691 Test Loss: 0.975 Test Acc: 0.691
Validation loss decreased (-0.690779 --> -0.690780).  Saving model ...
Epoch: 22 cost time: 0.5067460536956787
Epoch: 22, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.948 Vali Acc: 0.684 Test Loss: 0.948 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4846169948577881
Epoch: 23, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.922 Vali Acc: 0.684 Test Loss: 0.922 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5369873046875
Epoch: 24, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.898 Vali Acc: 0.678 Test Loss: 0.898 Test Acc: 0.678
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6567211151123047
Epoch: 25, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.875 Vali Acc: 0.678 Test Loss: 0.875 Test Acc: 0.678
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5150799751281738
Epoch: 26, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.853 Vali Acc: 0.671 Test Loss: 0.853 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5216577053070068
Epoch: 27, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.834 Vali Acc: 0.664 Test Loss: 0.834 Test Acc: 0.664
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.4758012294769287
Epoch: 28, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.671 Test Loss: 0.815 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.48653197288513184
Epoch: 29, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.798 Vali Acc: 0.671 Test Loss: 0.798 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5313715934753418
Epoch: 30, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.783 Vali Acc: 0.671 Test Loss: 0.783 Test Acc: 0.671
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5418798923492432
Epoch: 31, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_LightTS_UEA_ftM_sl30_ll0_pl0_dm32_cs2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.6907894736842105
model parameter : 2830
model size : 0.02MB
