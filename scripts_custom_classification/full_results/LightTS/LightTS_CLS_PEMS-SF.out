Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.920738458633423
Epoch: 1, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.161 Vali Acc: 0.543 Test Loss: 1.161 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 1.4397447109222412
Epoch: 2, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.752 Vali Acc: 0.740 Test Loss: 0.752 Test Acc: 0.740
Validation loss decreased (-0.543341 --> -0.739877).  Saving model ...
Epoch: 3 cost time: 1.3842625617980957
Epoch: 3, Steps: 17 | Train Loss: 0.318 Vali Loss: 1.300 Vali Acc: 0.688 Test Loss: 1.300 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.580228328704834
Epoch: 4, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.562 Vali Acc: 0.786 Test Loss: 0.562 Test Acc: 0.786
Validation loss decreased (-0.739877 --> -0.786122).  Saving model ...
Epoch: 5 cost time: 1.5818989276885986
Epoch: 5, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.773 Vali Acc: 0.832 Test Loss: 0.773 Test Acc: 0.832
Validation loss decreased (-0.786122 --> -0.832362).  Saving model ...
Epoch: 6 cost time: 1.474552869796753
Epoch: 6, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.008 Vali Acc: 0.775 Test Loss: 1.008 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.579089641571045
Epoch: 7, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.619 Vali Acc: 0.855 Test Loss: 0.619 Test Acc: 0.855
Validation loss decreased (-0.832362 --> -0.855485).  Saving model ...
Epoch: 8 cost time: 1.3853003978729248
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.821 Test Loss: 0.683 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.445866346359253
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.832 Test Loss: 0.602 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3858728408813477
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.344414234161377
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.827 Test Loss: 0.584 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4230189323425293
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.827 Test Loss: 0.583 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3272972106933594
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3495783805847168
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.587 Vali Acc: 0.832 Test Loss: 0.587 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3501672744750977
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.821 Test Loss: 0.590 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3843955993652344
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.821 Test Loss: 0.591 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.408397912979126
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.821 Test Loss: 0.593 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2046933
model size : 7.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0200355052948
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.036 Vali Acc: 0.514 Test Loss: 1.036 Test Acc: 0.514
Validation loss decreased (inf --> -0.514441).  Saving model ...
Epoch: 2 cost time: 1.3289220333099365
Epoch: 2, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.837 Vali Acc: 0.723 Test Loss: 0.837 Test Acc: 0.723
Validation loss decreased (-0.514441 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.397700548171997
Epoch: 3, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.864 Vali Acc: 0.740 Test Loss: 0.864 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739876).  Saving model ...
Epoch: 4 cost time: 1.506744384765625
Epoch: 4, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.739876 --> -0.774558).  Saving model ...
Epoch: 5 cost time: 1.4429433345794678
Epoch: 5, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
Validation loss decreased (-0.774558 --> -0.803460).  Saving model ...
Epoch: 6 cost time: 1.4611937999725342
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.898 Vali Acc: 0.786 Test Loss: 0.898 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4861640930175781
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.642 Vali Acc: 0.815 Test Loss: 0.642 Test Acc: 0.815
Validation loss decreased (-0.803460 --> -0.815022).  Saving model ...
Epoch: 8 cost time: 1.501286268234253
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
Validation loss decreased (-0.815022 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 1.621495008468628
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6679973602294922
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.764 Vali Acc: 0.827 Test Loss: 0.764 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.529048204421997
Epoch: 11, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.848 Vali Acc: 0.827 Test Loss: 0.848 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5993576049804688
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.790 Vali Acc: 0.855 Test Loss: 0.790 Test Acc: 0.855
Validation loss decreased (-0.843925 --> -0.855483).  Saving model ...
Epoch: 13 cost time: 1.7975754737854004
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.720898151397705
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.844 Test Loss: 0.754 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6001150608062744
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5386710166931152
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.844 Test Loss: 0.711 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4203886985778809
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.538353681564331
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.832 Test Loss: 0.705 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5591964721679688
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.832 Test Loss: 0.704 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4460349082946777
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5652053356170654
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4897937774658203
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2040803
model size : 7.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.517366886138916
Epoch: 1, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.168 Vali Acc: 0.491 Test Loss: 1.168 Test Acc: 0.491
Validation loss decreased (inf --> -0.491318).  Saving model ...
Epoch: 2 cost time: 1.4984815120697021
Epoch: 2, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.808 Vali Acc: 0.694 Test Loss: 0.808 Test Acc: 0.694
Validation loss decreased (-0.491318 --> -0.693634).  Saving model ...
Epoch: 3 cost time: 1.7749974727630615
Epoch: 3, Steps: 17 | Train Loss: 0.314 Vali Loss: 0.861 Vali Acc: 0.705 Test Loss: 0.861 Test Acc: 0.705
Validation loss decreased (-0.693634 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 1.4342217445373535
Epoch: 4, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.719 Vali Acc: 0.798 Test Loss: 0.719 Test Acc: 0.798
Validation loss decreased (-0.705194 --> -0.797681).  Saving model ...
Epoch: 5 cost time: 1.4964780807495117
Epoch: 5, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803461).  Saving model ...
Epoch: 6 cost time: 1.5019562244415283
Epoch: 6, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.622 Vali Acc: 0.798 Test Loss: 0.622 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7296741008758545
Epoch: 7, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.905 Vali Acc: 0.780 Test Loss: 0.905 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6848821640014648
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.903 Vali Acc: 0.832 Test Loss: 0.903 Test Acc: 0.832
Validation loss decreased (-0.803461 --> -0.832361).  Saving model ...
Epoch: 9 cost time: 1.5066497325897217
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7740705013275146
Epoch: 10, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.663 Vali Acc: 0.798 Test Loss: 0.663 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6944115161895752
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.580 Vali Acc: 0.838 Test Loss: 0.580 Test Acc: 0.838
Validation loss decreased (-0.832361 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 1.44097900390625
Epoch: 12, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.877 Vali Acc: 0.751 Test Loss: 0.877 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6259419918060303
Epoch: 13, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.736 Vali Acc: 0.775 Test Loss: 0.736 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.759671926498413
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5429449081420898
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4858195781707764
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.815 Test Loss: 0.628 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5559687614440918
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.815 Test Loss: 0.630 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.533647060394287
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.821 Test Loss: 0.632 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5187091827392578
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.587059736251831
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5664687156677246
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2037749
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.058488130569458
Epoch: 1, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.065 Vali Acc: 0.572 Test Loss: 1.065 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 1.6553797721862793
Epoch: 2, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.672 Vali Acc: 0.746 Test Loss: 0.672 Test Acc: 0.746
Validation loss decreased (-0.572244 --> -0.745658).  Saving model ...
Epoch: 3 cost time: 1.6270766258239746
Epoch: 3, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
Validation loss decreased (-0.745658 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 1.550011396408081
Epoch: 4, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 5 cost time: 1.6738719940185547
Epoch: 5, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.930 Vali Acc: 0.769 Test Loss: 0.930 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8099262714385986
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.552 Vali Acc: 0.757 Test Loss: 1.552 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5243525505065918
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.890 Vali Acc: 0.792 Test Loss: 0.890 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4926276206970215
Epoch: 8, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.134 Vali Acc: 0.803 Test Loss: 1.134 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5621931552886963
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.822 Vali Acc: 0.827 Test Loss: 0.822 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826581).  Saving model ...
Epoch: 10 cost time: 1.5392286777496338
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.844 Vali Acc: 0.844 Test Loss: 0.844 Test Acc: 0.844
Validation loss decreased (-0.826581 --> -0.843922).  Saving model ...
Epoch: 11 cost time: 1.6276676654815674
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.906 Vali Acc: 0.827 Test Loss: 0.906 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5931007862091064
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.773 Vali Acc: 0.827 Test Loss: 0.773 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.536987543106079
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.994 Vali Acc: 0.809 Test Loss: 0.994 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5044364929199219
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.877 Vali Acc: 0.803 Test Loss: 0.877 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5533819198608398
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.843 Vali Acc: 0.798 Test Loss: 0.843 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5265021324157715
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.829 Vali Acc: 0.798 Test Loss: 0.829 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.565575361251831
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.798 Test Loss: 0.822 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7554666996002197
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.798 Test Loss: 0.816 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.733994483947754
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.798 Test Loss: 0.811 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.6866660118103027
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.807 Vali Acc: 0.792 Test Loss: 0.807 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2036123
model size : 7.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9816701412200928
Epoch: 1, Steps: 17 | Train Loss: 1.796 Vali Loss: 1.002 Vali Acc: 0.584 Test Loss: 1.002 Test Acc: 0.584
Validation loss decreased (inf --> -0.583805).  Saving model ...
Epoch: 2 cost time: 1.528113842010498
Epoch: 2, Steps: 17 | Train Loss: 0.724 Vali Loss: 1.080 Vali Acc: 0.676 Test Loss: 1.080 Test Acc: 0.676
Validation loss decreased (-0.583805 --> -0.676290).  Saving model ...
Epoch: 3 cost time: 1.4431989192962646
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.072 Vali Acc: 0.694 Test Loss: 1.072 Test Acc: 0.694
Validation loss decreased (-0.676290 --> -0.693631).  Saving model ...
Epoch: 4 cost time: 1.5017876625061035
Epoch: 4, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.782 Vali Acc: 0.769 Test Loss: 0.782 Test Acc: 0.769
Validation loss decreased (-0.693631 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 1.4447352886199951
Epoch: 5, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.702 Vali Acc: 0.780 Test Loss: 0.702 Test Acc: 0.780
Validation loss decreased (-0.768778 --> -0.780340).  Saving model ...
Epoch: 6 cost time: 1.6389410495758057
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.689 Vali Acc: 0.786 Test Loss: 0.689 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 1.630875587463379
Epoch: 7, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.044 Vali Acc: 0.751 Test Loss: 1.044 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.671217679977417
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.053 Vali Acc: 0.792 Test Loss: 1.053 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791897).  Saving model ...
Epoch: 9 cost time: 1.5619797706604004
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.774 Vali Acc: 0.821 Test Loss: 0.774 Test Acc: 0.821
Validation loss decreased (-0.791897 --> -0.820802).  Saving model ...
Epoch: 10 cost time: 1.6679012775421143
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.682 Vali Acc: 0.832 Test Loss: 0.682 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832363).  Saving model ...
Epoch: 11 cost time: 1.5596814155578613
Epoch: 11, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.083 Vali Acc: 0.832 Test Loss: 1.083 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6178381443023682
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.715 Vali Acc: 0.821 Test Loss: 0.715 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8533949851989746
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.022 Vali Acc: 0.786 Test Loss: 1.022 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4882862567901611
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.279 Vali Acc: 0.792 Test Loss: 1.279 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6416454315185547
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.939 Vali Acc: 0.798 Test Loss: 0.939 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.5568366050720215
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.798 Test Loss: 0.922 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7662498950958252
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.906 Vali Acc: 0.798 Test Loss: 0.906 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5698797702789307
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.903 Vali Acc: 0.798 Test Loss: 0.903 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.535663366317749
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.701719045639038
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2034725
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.467291831970215
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.045 Vali Acc: 0.572 Test Loss: 1.045 Test Acc: 0.572
Validation loss decreased (inf --> -0.572244).  Saving model ...
Epoch: 2 cost time: 1.9103336334228516
Epoch: 2, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.422 Vali Acc: 0.636 Test Loss: 1.422 Test Acc: 0.636
Validation loss decreased (-0.572244 --> -0.635824).  Saving model ...
Epoch: 3 cost time: 1.6618621349334717
Epoch: 3, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.136 Vali Acc: 0.734 Test Loss: 1.136 Test Acc: 0.734
Validation loss decreased (-0.635824 --> -0.734093).  Saving model ...
Epoch: 4 cost time: 1.691603660583496
Epoch: 4, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
Validation loss decreased (-0.734093 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 1.799480676651001
Epoch: 5, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
Validation loss decreased (-0.803462 --> -0.849705).  Saving model ...
Epoch: 6 cost time: 1.7393765449523926
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.472 Vali Acc: 0.855 Test Loss: 0.472 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855487).  Saving model ...
Epoch: 7 cost time: 1.8412694931030273
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7845892906188965
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.510 Vali Acc: 0.827 Test Loss: 0.510 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6177303791046143
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.492 Vali Acc: 0.832 Test Loss: 0.492 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9350285530090332
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.481 Vali Acc: 0.850 Test Loss: 0.481 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.0167250633239746
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.850 Test Loss: 0.476 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.7075200080871582
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.9815878868103027
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.9012207984924316
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.919499158859253
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.844 Test Loss: 0.476 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.8576676845550537
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2034419
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.026514768600464
Epoch: 1, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.008 Vali Acc: 0.607 Test Loss: 1.008 Test Acc: 0.607
Validation loss decreased (inf --> -0.606926).  Saving model ...
Epoch: 2 cost time: 1.546649694442749
Epoch: 2, Steps: 17 | Train Loss: 0.712 Vali Loss: 1.312 Vali Acc: 0.509 Test Loss: 1.312 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.666428565979004
Epoch: 3, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.932 Vali Acc: 0.728 Test Loss: 0.932 Test Acc: 0.728
Validation loss decreased (-0.606926 --> -0.728314).  Saving model ...
Epoch: 4 cost time: 1.61080002784729
Epoch: 4, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.162 Vali Acc: 0.775 Test Loss: 1.162 Test Acc: 0.775
Validation loss decreased (-0.728314 --> -0.774555).  Saving model ...
Epoch: 5 cost time: 1.5650742053985596
Epoch: 5, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6356580257415771
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.831 Vali Acc: 0.763 Test Loss: 0.831 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5674524307250977
Epoch: 7, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.774555 --> -0.838145).  Saving model ...
Epoch: 8 cost time: 1.8222744464874268
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.517 Vali Acc: 0.844 Test Loss: 0.517 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 1.6941897869110107
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.832 Test Loss: 0.599 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6956076622009277
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.559 Vali Acc: 0.827 Test Loss: 0.559 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7394359111785889
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.832 Test Loss: 0.544 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6077463626861572
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.832 Test Loss: 0.543 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9426722526550293
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.832 Test Loss: 0.544 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.6651716232299805
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.827 Test Loss: 0.543 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7574329376220703
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7442679405212402
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6143736839294434
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5230839252471924
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.838 Test Loss: 0.535 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2033253
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.386411428451538
Epoch: 1, Steps: 17 | Train Loss: 1.638 Vali Loss: 0.969 Vali Acc: 0.572 Test Loss: 0.969 Test Acc: 0.572
Validation loss decreased (inf --> -0.572245).  Saving model ...
Epoch: 2 cost time: 1.6914873123168945
Epoch: 2, Steps: 17 | Train Loss: 0.528 Vali Loss: 0.909 Vali Acc: 0.699 Test Loss: 0.909 Test Acc: 0.699
Validation loss decreased (-0.572245 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.4205820560455322
Epoch: 3, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.772 Vali Acc: 0.757 Test Loss: 0.772 Test Acc: 0.757
Validation loss decreased (-0.699413 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 1.5814142227172852
Epoch: 4, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.594 Vali Acc: 0.838 Test Loss: 0.594 Test Acc: 0.838
Validation loss decreased (-0.757218 --> -0.838144).  Saving model ...
Epoch: 5 cost time: 1.6739141941070557
Epoch: 5, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.002 Vali Acc: 0.798 Test Loss: 1.002 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6782336235046387
Epoch: 6, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.930 Vali Acc: 0.775 Test Loss: 0.930 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7994530200958252
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.806 Vali Acc: 0.821 Test Loss: 0.806 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8553566932678223
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.662 Vali Acc: 0.757 Test Loss: 0.662 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6694185733795166
Epoch: 9, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
Validation loss decreased (-0.838144 --> -0.867047).  Saving model ...
Epoch: 10 cost time: 1.642491102218628
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.809 Test Loss: 0.895 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6193335056304932
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.064 Vali Acc: 0.809 Test Loss: 1.064 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7006874084472656
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.059 Vali Acc: 0.821 Test Loss: 1.059 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.594031572341919
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.821 Test Loss: 1.045 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4836750030517578
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.038 Vali Acc: 0.821 Test Loss: 1.038 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.785088300704956
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.035 Vali Acc: 0.821 Test Loss: 1.035 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.485992431640625
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.821 Test Loss: 1.031 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.639869213104248
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.821 Test Loss: 1.029 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7321529388427734
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.803 Test Loss: 1.030 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.595979928970337
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.030 Vali Acc: 0.803 Test Loss: 1.030 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2032779
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2370429039001465
Epoch: 1, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.156 Vali Acc: 0.468 Test Loss: 1.156 Test Acc: 0.468
Validation loss decreased (inf --> -0.468197).  Saving model ...
Epoch: 2 cost time: 1.7210347652435303
Epoch: 2, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.875 Vali Acc: 0.723 Test Loss: 0.875 Test Acc: 0.723
Validation loss decreased (-0.468197 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.821291208267212
Epoch: 3, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.825 Vali Acc: 0.751 Test Loss: 0.825 Test Acc: 0.751
Validation loss decreased (-0.722535 --> -0.751437).  Saving model ...
Epoch: 4 cost time: 1.8006846904754639
Epoch: 4, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.955 Vali Acc: 0.740 Test Loss: 0.955 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7142817974090576
Epoch: 5, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.049 Vali Acc: 0.746 Test Loss: 1.049 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8146052360534668
Epoch: 6, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
Validation loss decreased (-0.751437 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 1.7184555530548096
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9672558307647705
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.894 Vali Acc: 0.757 Test Loss: 0.894 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8543436527252197
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809241).  Saving model ...
Epoch: 10 cost time: 1.776153326034546
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.694 Vali Acc: 0.803 Test Loss: 0.694 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.840289831161499
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.792 Test Loss: 0.736 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7114410400390625
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.792 Test Loss: 0.669 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.898827075958252
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.798 Test Loss: 0.652 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8477559089660645
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8566927909851074
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8916692733764648
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.8360621929168701
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.698376178741455
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.631505012512207
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.803 Test Loss: 0.623 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 2033429
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.080225467681885
Epoch: 1, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.002 Vali Acc: 0.618 Test Loss: 1.002 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 1.7447643280029297
Epoch: 2, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.714 Vali Acc: 0.780 Test Loss: 0.714 Test Acc: 0.780
Validation loss decreased (-0.618487 --> -0.780340).  Saving model ...
Epoch: 3 cost time: 1.659501552581787
Epoch: 3, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6614224910736084
Epoch: 4, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.579 Vali Acc: 0.798 Test Loss: 0.579 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 1.6692214012145996
Epoch: 5, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.656 Vali Acc: 0.832 Test Loss: 0.656 Test Acc: 0.832
Validation loss decreased (-0.797682 --> -0.832363).  Saving model ...
Epoch: 6 cost time: 1.7154006958007812
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843925).  Saving model ...
Epoch: 7 cost time: 1.6603641510009766
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.560 Vali Acc: 0.838 Test Loss: 0.560 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8590471744537354
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.832 Test Loss: 0.688 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9747354984283447
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.002 Vali Acc: 0.821 Test Loss: 1.002 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.765533685684204
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.981809139251709
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.968 Vali Acc: 0.850 Test Loss: 0.968 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849701).  Saving model ...
Epoch: 12 cost time: 1.832801342010498
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.809 Test Loss: 1.059 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7056241035461426
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.998 Vali Acc: 0.827 Test Loss: 0.998 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9488029479980469
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.951 Vali Acc: 0.838 Test Loss: 0.951 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8129637241363525
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.935 Vali Acc: 0.838 Test Loss: 0.935 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.682244062423706
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.930 Vali Acc: 0.832 Test Loss: 0.930 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.96464204788208
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.927 Vali Acc: 0.832 Test Loss: 0.927 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0114407539367676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.821 Test Loss: 0.924 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.711557149887085
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.821 Test Loss: 0.924 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9962525367736816
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.924 Vali Acc: 0.821 Test Loss: 0.924 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.913677453994751
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.925 Vali Acc: 0.821 Test Loss: 0.925 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2033795
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8945131301879883
Epoch: 1, Steps: 17 | Train Loss: 1.665 Vali Loss: 1.217 Vali Acc: 0.584 Test Loss: 1.217 Test Acc: 0.584
Validation loss decreased (inf --> -0.583803).  Saving model ...
Epoch: 2 cost time: 1.660766363143921
Epoch: 2, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.851 Vali Acc: 0.711 Test Loss: 0.851 Test Acc: 0.711
Validation loss decreased (-0.583803 --> -0.710974).  Saving model ...
Epoch: 3 cost time: 1.7682735919952393
Epoch: 3, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.778 Vali Acc: 0.717 Test Loss: 0.778 Test Acc: 0.717
Validation loss decreased (-0.710974 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 1.6337289810180664
Epoch: 4, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.048 Vali Acc: 0.711 Test Loss: 1.048 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6250789165496826
Epoch: 5, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.934 Vali Acc: 0.803 Test Loss: 0.934 Test Acc: 0.803
Validation loss decreased (-0.716755 --> -0.803459).  Saving model ...
Epoch: 6 cost time: 1.6636807918548584
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.117 Vali Acc: 0.757 Test Loss: 1.117 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7260563373565674
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.627 Vali Acc: 0.832 Test Loss: 0.627 Test Acc: 0.832
Validation loss decreased (-0.803459 --> -0.832364).  Saving model ...
Epoch: 8 cost time: 1.6883752346038818
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.900 Vali Acc: 0.775 Test Loss: 0.900 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5133073329925537
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.730 Vali Acc: 0.838 Test Loss: 0.730 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838143).  Saving model ...
Epoch: 10 cost time: 1.568425178527832
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.969 Vali Acc: 0.803 Test Loss: 0.969 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.630950927734375
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.815 Test Loss: 0.820 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6789445877075195
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.815 Test Loss: 0.755 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5513265132904053
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6461458206176758
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.809 Test Loss: 0.738 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6512298583984375
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.803 Test Loss: 0.740 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6226444244384766
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.803 Test Loss: 0.738 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5990445613861084
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.803 Test Loss: 0.735 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.7044720649719238
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.60129714012146
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2031893
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.428302764892578
Epoch: 1, Steps: 17 | Train Loss: 1.640 Vali Loss: 1.625 Vali Acc: 0.382 Test Loss: 1.625 Test Acc: 0.382
Validation loss decreased (inf --> -0.381487).  Saving model ...
Epoch: 2 cost time: 1.8611602783203125
Epoch: 2, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.071 Vali Acc: 0.572 Test Loss: 1.071 Test Acc: 0.572
Validation loss decreased (-0.381487 --> -0.572244).  Saving model ...
Epoch: 3 cost time: 1.8759312629699707
Epoch: 3, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.679 Vali Acc: 0.763 Test Loss: 0.679 Test Acc: 0.763
Validation loss decreased (-0.572244 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 1.9149856567382812
Epoch: 4, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.261 Vali Acc: 0.728 Test Loss: 1.261 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9333925247192383
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.983 Vali Acc: 0.798 Test Loss: 0.983 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797678).  Saving model ...
Epoch: 6 cost time: 2.0135130882263184
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.711 Vali Acc: 0.769 Test Loss: 0.711 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0820086002349854
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.716 Vali Acc: 0.815 Test Loss: 0.716 Test Acc: 0.815
Validation loss decreased (-0.797678 --> -0.815022).  Saving model ...
Epoch: 8 cost time: 2.009782552719116
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.741 Vali Acc: 0.786 Test Loss: 0.741 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0321602821350098
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.682 Vali Acc: 0.815 Test Loss: 0.682 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 2.0749003887176514
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
Validation loss decreased (-0.815022 --> -0.843924).  Saving model ...
Epoch: 11 cost time: 2.0582022666931152
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.827 Test Loss: 0.621 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.071359157562256
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.613 Vali Acc: 0.815 Test Loss: 0.613 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3559632301330566
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.815 Test Loss: 0.612 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.051832675933838
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.118872880935669
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.821 Test Loss: 0.611 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.31585693359375
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.821 Test Loss: 0.611 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.1478219032287598
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.821 Test Loss: 0.612 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0870559215545654
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.821 Test Loss: 0.614 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9923584461212158
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.821 Test Loss: 0.615 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1052212715148926
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.821 Test Loss: 0.617 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2033189
model size : 7.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.346917152404785
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.040 Vali Acc: 0.578 Test Loss: 1.040 Test Acc: 0.578
Validation loss decreased (inf --> -0.578024).  Saving model ...
Epoch: 2 cost time: 2.0743117332458496
Epoch: 2, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.887 Vali Acc: 0.665 Test Loss: 0.887 Test Acc: 0.665
Validation loss decreased (-0.578024 --> -0.664731).  Saving model ...
Epoch: 3 cost time: 2.295985221862793
Epoch: 3, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.588 Vali Acc: 0.792 Test Loss: 0.588 Test Acc: 0.792
Validation loss decreased (-0.664731 --> -0.791902).  Saving model ...
Epoch: 4 cost time: 2.098742961883545
Epoch: 4, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.041 Vali Acc: 0.740 Test Loss: 1.041 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1221089363098145
Epoch: 5, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.632 Vali Acc: 0.792 Test Loss: 0.632 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.007502794265747
Epoch: 6, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.766 Vali Acc: 0.798 Test Loss: 0.766 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797680).  Saving model ...
Epoch: 7 cost time: 2.0355191230773926
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 2.0470216274261475
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.823 Vali Acc: 0.792 Test Loss: 0.823 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9040627479553223
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.898 Vali Acc: 0.775 Test Loss: 0.898 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9046142101287842
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.696 Vali Acc: 0.832 Test Loss: 0.696 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832363).  Saving model ...
Epoch: 11 cost time: 1.988121509552002
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.844 Test Loss: 0.665 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843924).  Saving model ...
Epoch: 12 cost time: 2.337531328201294
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.832 Test Loss: 0.656 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2840969562530518
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.844 Test Loss: 0.644 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 14 cost time: 2.1969497203826904
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 15 cost time: 2.0658535957336426
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.844 Test Loss: 0.634 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 16 cost time: 1.8578214645385742
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 17 cost time: 2.248213529586792
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 18 cost time: 2.058515787124634
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.844 Test Loss: 0.629 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 19 cost time: 1.9248812198638916
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 20 cost time: 2.1285693645477295
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843924).  Saving model ...
Epoch: 21 cost time: 1.8528378009796143
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849705).  Saving model ...
Epoch: 22 cost time: 2.027400255203247
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
Validation loss decreased (-0.849705 --> -0.849705).  Saving model ...
Epoch: 23 cost time: 1.9748761653900146
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.849705 --> -0.849705).  Saving model ...
Epoch: 24 cost time: 2.1323904991149902
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0553812980651855
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1683192253112793
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.850 Test Loss: 0.625 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.286559820175171
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.850 Test Loss: 0.626 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.185615301132202
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (-0.849705 --> -0.861265).  Saving model ...
Epoch: 29 cost time: 1.9776420593261719
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
Validation loss decreased (-0.861265 --> -0.861265).  Saving model ...
Epoch: 30 cost time: 2.1086933612823486
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.938812255859375
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.861 Test Loss: 0.625 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.072442054748535
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3596394062042236
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.174935817718506
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.218991994857788
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.288877248764038
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.074488639831543
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.2154946327209473
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.861 Test Loss: 0.627 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.428494453430176
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.861 Test Loss: 0.628 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2032419
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.43204927444458
Epoch: 1, Steps: 17 | Train Loss: 1.557 Vali Loss: 0.993 Vali Acc: 0.618 Test Loss: 0.993 Test Acc: 0.618
Validation loss decreased (inf --> -0.618487).  Saving model ...
Epoch: 2 cost time: 1.953104019165039
Epoch: 2, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
Validation loss decreased (-0.618487 --> -0.734096).  Saving model ...
Epoch: 3 cost time: 2.1989872455596924
Epoch: 3, Steps: 17 | Train Loss: 0.236 Vali Loss: 0.977 Vali Acc: 0.775 Test Loss: 0.977 Test Acc: 0.775
Validation loss decreased (-0.734096 --> -0.774557).  Saving model ...
Epoch: 4 cost time: 1.9842708110809326
Epoch: 4, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.775 Vali Acc: 0.763 Test Loss: 0.775 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.895585536956787
Epoch: 5, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.759 Vali Acc: 0.792 Test Loss: 0.759 Test Acc: 0.792
Validation loss decreased (-0.774557 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 1.9132983684539795
Epoch: 6, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.786 Test Loss: 0.724 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.134906053543091
Epoch: 7, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
Validation loss decreased (-0.791900 --> -0.867046).  Saving model ...
Epoch: 8 cost time: 1.8412973880767822
Epoch: 8, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.815 Test Loss: 0.546 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0908162593841553
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8153789043426514
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.792 Test Loss: 0.552 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.624037742614746
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.798 Test Loss: 0.542 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9094085693359375
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.798 Test Loss: 0.550 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.8844492435455322
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.7639110088348389
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.798 Test Loss: 0.549 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9504408836364746
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.798 Test Loss: 0.552 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.9197993278503418
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.798 Test Loss: 0.553 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.9096057415008545
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.798 Test Loss: 0.554 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2031365
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.266357421875
Epoch: 1, Steps: 17 | Train Loss: 1.567 Vali Loss: 0.946 Vali Acc: 0.601 Test Loss: 0.946 Test Acc: 0.601
Validation loss decreased (inf --> -0.601147).  Saving model ...
Epoch: 2 cost time: 1.8427023887634277
Epoch: 2, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.289 Vali Acc: 0.543 Test Loss: 1.289 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9474117755889893
Epoch: 3, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.986 Vali Acc: 0.769 Test Loss: 0.986 Test Acc: 0.769
Validation loss decreased (-0.601147 --> -0.768776).  Saving model ...
Epoch: 4 cost time: 1.9199411869049072
Epoch: 4, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.930 Vali Acc: 0.780 Test Loss: 0.930 Test Acc: 0.780
Validation loss decreased (-0.768776 --> -0.780338).  Saving model ...
Epoch: 5 cost time: 2.0049548149108887
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
Validation loss decreased (-0.780338 --> -0.843923).  Saving model ...
Epoch: 6 cost time: 2.1504530906677246
Epoch: 6, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.944218635559082
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.847 Vali Acc: 0.792 Test Loss: 0.847 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.063868522644043
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.795 Vali Acc: 0.775 Test Loss: 0.795 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2630155086517334
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.645 Vali Acc: 0.815 Test Loss: 0.645 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.2410707473754883
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.815 Test Loss: 0.645 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.0191404819488525
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0083398818969727
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.9915249347686768
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.2211201190948486
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0288734436035156
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2031253
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9720330238342285
Epoch: 1, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.111 Vali Acc: 0.624 Test Loss: 1.111 Test Acc: 0.624
Validation loss decreased (inf --> -0.624266).  Saving model ...
Epoch: 2 cost time: 2.3043606281280518
Epoch: 2, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.887 Vali Acc: 0.786 Test Loss: 0.887 Test Acc: 0.786
Validation loss decreased (-0.624266 --> -0.786118).  Saving model ...
Epoch: 3 cost time: 2.2371602058410645
Epoch: 3, Steps: 17 | Train Loss: 0.398 Vali Loss: 1.515 Vali Acc: 0.665 Test Loss: 1.515 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2810330390930176
Epoch: 4, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.184 Vali Acc: 0.723 Test Loss: 1.184 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3098907470703125
Epoch: 5, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.248 Vali Acc: 0.775 Test Loss: 1.248 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.456225633621216
Epoch: 6, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.987 Vali Acc: 0.769 Test Loss: 0.987 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.295539140701294
Epoch: 7, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.013 Vali Acc: 0.780 Test Loss: 1.013 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.2690491676330566
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.786 Vali Acc: 0.821 Test Loss: 0.786 Test Acc: 0.821
Validation loss decreased (-0.786118 --> -0.820801).  Saving model ...
Epoch: 9 cost time: 2.212350606918335
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2194900512695312
Epoch: 10, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.871 Vali Acc: 0.780 Test Loss: 0.871 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.2676539421081543
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.524 Vali Acc: 0.751 Test Loss: 1.524 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.084580421447754
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.967 Vali Acc: 0.815 Test Loss: 0.967 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3400988578796387
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.313 Vali Acc: 0.763 Test Loss: 1.313 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3471879959106445
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.769 Test Loss: 1.101 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.3457963466644287
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.029 Vali Acc: 0.775 Test Loss: 1.029 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.291116237640381
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.775 Test Loss: 1.012 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.3807778358459473
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.996 Vali Acc: 0.780 Test Loss: 0.996 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.315870523452759
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.780 Test Loss: 0.986 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 2031675
model size : 7.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.097254753112793
Epoch: 1, Steps: 17 | Train Loss: 1.604 Vali Loss: 0.991 Vali Acc: 0.630 Test Loss: 0.991 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.3118228912353516
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.671 Vali Acc: 0.792 Test Loss: 0.671 Test Acc: 0.792
Validation loss decreased (-0.630048 --> -0.791901).  Saving model ...
Epoch: 3 cost time: 1.2448334693908691
Epoch: 3, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.878 Vali Acc: 0.723 Test Loss: 0.878 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4041004180908203
Epoch: 4, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.647 Vali Acc: 0.809 Test Loss: 0.647 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809242).  Saving model ...
Epoch: 5 cost time: 1.6086041927337646
Epoch: 5, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.840 Vali Acc: 0.786 Test Loss: 0.840 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4836487770080566
Epoch: 6, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.809242 --> -0.838145).  Saving model ...
Epoch: 7 cost time: 1.6212728023529053
Epoch: 7, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.945 Vali Acc: 0.769 Test Loss: 0.945 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7633347511291504
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.752 Vali Acc: 0.798 Test Loss: 0.752 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5917248725891113
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.803 Test Loss: 0.703 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.462670087814331
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.792 Test Loss: 0.710 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6476919651031494
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.792 Test Loss: 0.709 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.407487154006958
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.792 Test Loss: 0.700 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4461286067962646
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.792 Test Loss: 0.694 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5808110237121582
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.6491544246673584
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4097278118133545
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1958933
model size : 7.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.874969720840454
Epoch: 1, Steps: 17 | Train Loss: 1.605 Vali Loss: 0.938 Vali Acc: 0.595 Test Loss: 0.938 Test Acc: 0.595
Validation loss decreased (inf --> -0.595366).  Saving model ...
Epoch: 2 cost time: 1.3073599338531494
Epoch: 2, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.872 Vali Acc: 0.734 Test Loss: 0.872 Test Acc: 0.734
Validation loss decreased (-0.595366 --> -0.734095).  Saving model ...
Epoch: 3 cost time: 1.3255319595336914
Epoch: 3, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.193 Vali Acc: 0.659 Test Loss: 1.193 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4229986667633057
Epoch: 4, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.815 Vali Acc: 0.803 Test Loss: 0.815 Test Acc: 0.803
Validation loss decreased (-0.734095 --> -0.803460).  Saving model ...
Epoch: 5 cost time: 1.325648546218872
Epoch: 5, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.082 Vali Acc: 0.769 Test Loss: 1.082 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2474219799041748
Epoch: 6, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.850 Vali Acc: 0.827 Test Loss: 0.850 Test Acc: 0.827
Validation loss decreased (-0.803460 --> -0.826581).  Saving model ...
Epoch: 7 cost time: 1.1789946556091309
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.809 Test Loss: 0.824 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.302936315536499
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.787 Vali Acc: 0.792 Test Loss: 0.787 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3340427875518799
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.948 Vali Acc: 0.757 Test Loss: 0.948 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4046823978424072
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.770 Vali Acc: 0.786 Test Loss: 0.770 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.496711254119873
Epoch: 11, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.765 Vali Acc: 0.792 Test Loss: 0.765 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3097960948944092
Epoch: 12, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.675 Vali Acc: 0.838 Test Loss: 0.675 Test Acc: 0.838
Validation loss decreased (-0.826581 --> -0.838144).  Saving model ...
Epoch: 13 cost time: 1.3110294342041016
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.817 Vali Acc: 0.838 Test Loss: 0.817 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3522472381591797
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.778 Vali Acc: 0.815 Test Loss: 0.778 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.465836524963379
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.679 Vali Acc: 0.850 Test Loss: 0.679 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849704).  Saving model ...
Epoch: 16 cost time: 1.7898509502410889
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.080 Vali Acc: 0.838 Test Loss: 1.080 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4170000553131104
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.921 Vali Acc: 0.803 Test Loss: 0.921 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5813515186309814
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.803 Test Loss: 0.853 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3572592735290527
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.803 Test Loss: 0.832 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5860786437988281
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6720669269561768
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.808 Vali Acc: 0.798 Test Loss: 0.808 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4433517456054688
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.798 Test Loss: 0.801 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3359441757202148
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.798 Test Loss: 0.796 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3051860332489014
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.798 Test Loss: 0.794 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5637707710266113
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.792 Vali Acc: 0.798 Test Loss: 0.792 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1955875
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.086944341659546
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.009 Vali Acc: 0.665 Test Loss: 1.009 Test Acc: 0.665
Validation loss decreased (inf --> -0.664730).  Saving model ...
Epoch: 2 cost time: 1.2764225006103516
Epoch: 2, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.022 Vali Acc: 0.653 Test Loss: 1.022 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2096185684204102
Epoch: 3, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.670 Vali Acc: 0.769 Test Loss: 0.670 Test Acc: 0.769
Validation loss decreased (-0.664730 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 1.2265679836273193
Epoch: 4, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.768779 --> -0.843924).  Saving model ...
Epoch: 5 cost time: 1.2743890285491943
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.227 Vali Acc: 0.769 Test Loss: 1.227 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2626681327819824
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.825 Vali Acc: 0.821 Test Loss: 0.825 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3993299007415771
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.899 Vali Acc: 0.850 Test Loss: 0.899 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849702).  Saving model ...
Epoch: 8 cost time: 1.3196730613708496
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.954 Vali Acc: 0.850 Test Loss: 0.954 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2952561378479004
Epoch: 9, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.902 Vali Acc: 0.775 Test Loss: 0.902 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4808144569396973
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.827 Test Loss: 0.745 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.345449447631836
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.855 Test Loss: 0.777 Test Acc: 0.855
Validation loss decreased (-0.849702 --> -0.855484).  Saving model ...
Epoch: 12 cost time: 1.3475446701049805
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.855 Test Loss: 0.740 Test Acc: 0.855
Validation loss decreased (-0.855484 --> -0.855484).  Saving model ...
Epoch: 13 cost time: 1.4695634841918945
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.838 Test Loss: 0.726 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.522883415222168
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.838 Test Loss: 0.720 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.281559944152832
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.838 Test Loss: 0.717 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1845805644989014
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3671410083770752
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2419040203094482
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1971180438995361
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.291635513305664
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.480809211730957
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.844 Test Loss: 0.714 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4451484680175781
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.844 Test Loss: 0.713 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1954357
model size : 7.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.712494373321533
Epoch: 1, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.018 Vali Acc: 0.630 Test Loss: 1.018 Test Acc: 0.630
Validation loss decreased (inf --> -0.630048).  Saving model ...
Epoch: 2 cost time: 1.4834961891174316
Epoch: 2, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.859 Vali Acc: 0.699 Test Loss: 0.859 Test Acc: 0.699
Validation loss decreased (-0.630048 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.2336411476135254
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.758 Vali Acc: 0.751 Test Loss: 0.758 Test Acc: 0.751
Validation loss decreased (-0.699413 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 1.3092281818389893
Epoch: 4, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.937 Vali Acc: 0.740 Test Loss: 0.937 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.397897481918335
Epoch: 5, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.961 Vali Acc: 0.757 Test Loss: 0.961 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757216).  Saving model ...
Epoch: 6 cost time: 1.4865467548370361
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.938 Vali Acc: 0.780 Test Loss: 0.938 Test Acc: 0.780
Validation loss decreased (-0.757216 --> -0.780337).  Saving model ...
Epoch: 7 cost time: 1.468163251876831
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.864 Vali Acc: 0.821 Test Loss: 0.864 Test Acc: 0.821
Validation loss decreased (-0.780337 --> -0.820801).  Saving model ...
Epoch: 8 cost time: 1.7515740394592285
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.651 Vali Acc: 0.832 Test Loss: 0.651 Test Acc: 0.832
Validation loss decreased (-0.820801 --> -0.832363).  Saving model ...
Epoch: 9 cost time: 1.342482328414917
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.619 Vali Acc: 0.821 Test Loss: 0.619 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4341044425964355
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.832363 --> -0.849705).  Saving model ...
Epoch: 11 cost time: 1.5765488147735596
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.850 Test Loss: 0.583 Test Acc: 0.850
Validation loss decreased (-0.849705 --> -0.849705).  Saving model ...
Epoch: 12 cost time: 1.3066747188568115
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.580 Vali Acc: 0.855 Test Loss: 0.580 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855486).  Saving model ...
Epoch: 13 cost time: 1.3429741859436035
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.452803373336792
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.844 Test Loss: 0.583 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.428410291671753
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4676828384399414
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.844 Test Loss: 0.584 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.358708381652832
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.585 Vali Acc: 0.844 Test Loss: 0.585 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2441484928131104
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.474578619003296
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.430647850036621
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.855 Test Loss: 0.595 Test Acc: 0.855
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5632057189941406
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.855 Test Loss: 0.592 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3701975345611572
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.593 Vali Acc: 0.855 Test Loss: 0.593 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1953627
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.878847360610962
Epoch: 1, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.009 Vali Acc: 0.601 Test Loss: 1.009 Test Acc: 0.601
Validation loss decreased (inf --> -0.601146).  Saving model ...
Epoch: 2 cost time: 1.5687966346740723
Epoch: 2, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.889 Vali Acc: 0.699 Test Loss: 0.889 Test Acc: 0.699
Validation loss decreased (-0.601146 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 1.44087815284729
Epoch: 3, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.624 Vali Acc: 0.821 Test Loss: 0.624 Test Acc: 0.821
Validation loss decreased (-0.699413 --> -0.820803).  Saving model ...
Epoch: 4 cost time: 1.3246073722839355
Epoch: 4, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.564 Vali Acc: 0.850 Test Loss: 0.564 Test Acc: 0.850
Validation loss decreased (-0.820803 --> -0.849705).  Saving model ...
Epoch: 5 cost time: 1.4012715816497803
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4383392333984375
Epoch: 6, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.053 Vali Acc: 0.792 Test Loss: 1.053 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3611485958099365
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.819 Vali Acc: 0.832 Test Loss: 0.819 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.393197774887085
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.009 Vali Acc: 0.832 Test Loss: 1.009 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4078845977783203
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.923 Vali Acc: 0.861 Test Loss: 0.923 Test Acc: 0.861
Validation loss decreased (-0.849705 --> -0.861262).  Saving model ...
Epoch: 10 cost time: 1.317917823791504
Epoch: 10, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.995 Vali Acc: 0.786 Test Loss: 0.995 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3676705360412598
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.926 Vali Acc: 0.821 Test Loss: 0.926 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2877864837646484
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.832 Test Loss: 0.791 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.3299789428710938
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.838 Test Loss: 0.723 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.431030511856079
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.838 Test Loss: 0.717 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.4534740447998047
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.838 Test Loss: 0.714 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4338252544403076
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.832 Test Loss: 0.715 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.3812575340270996
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.832 Test Loss: 0.714 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.5036594867706299
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.832 Test Loss: 0.715 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3859117031097412
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.716 Vali Acc: 0.832 Test Loss: 0.716 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1952869
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8840785026550293
Epoch: 1, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.109 Vali Acc: 0.480 Test Loss: 1.109 Test Acc: 0.480
Validation loss decreased (inf --> -0.479758).  Saving model ...
Epoch: 2 cost time: 1.547215461730957
Epoch: 2, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
Validation loss decreased (-0.479758 --> -0.757219).  Saving model ...
Epoch: 3 cost time: 1.4837925434112549
Epoch: 3, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.782 Vali Acc: 0.786 Test Loss: 0.782 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786119).  Saving model ...
Epoch: 4 cost time: 1.45334792137146
Epoch: 4, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.626 Vali Acc: 0.798 Test Loss: 0.626 Test Acc: 0.798
Validation loss decreased (-0.786119 --> -0.797682).  Saving model ...
Epoch: 5 cost time: 1.5387041568756104
Epoch: 5, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.572 Vali Acc: 0.855 Test Loss: 0.572 Test Acc: 0.855
Validation loss decreased (-0.797682 --> -0.855486).  Saving model ...
Epoch: 6 cost time: 1.6277105808258057
Epoch: 6, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.805 Vali Acc: 0.809 Test Loss: 0.805 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5878524780273438
Epoch: 7, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.733 Vali Acc: 0.815 Test Loss: 0.733 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5607738494873047
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.570 Vali Acc: 0.855 Test Loss: 0.570 Test Acc: 0.855
Validation loss decreased (-0.855486 --> -0.855486).  Saving model ...
Epoch: 9 cost time: 1.4794421195983887
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.627 Vali Acc: 0.832 Test Loss: 0.627 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6165878772735596
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.441 Vali Acc: 0.873 Test Loss: 0.441 Test Acc: 0.873
Validation loss decreased (-0.855486 --> -0.872828).  Saving model ...
Epoch: 11 cost time: 1.4971604347229004
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.437 Vali Acc: 0.879 Test Loss: 0.437 Test Acc: 0.879
Validation loss decreased (-0.872828 --> -0.878608).  Saving model ...
Epoch: 12 cost time: 1.5043606758117676
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.461 Vali Acc: 0.861 Test Loss: 0.461 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.615135669708252
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.463 Vali Acc: 0.861 Test Loss: 0.463 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7008745670318604
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.464 Vali Acc: 0.867 Test Loss: 0.464 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4071896076202393
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3880119323730469
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.468 Vali Acc: 0.867 Test Loss: 0.468 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4432334899902344
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.470 Vali Acc: 0.867 Test Loss: 0.470 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.686631679534912
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.867 Test Loss: 0.469 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5280821323394775
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.474 Vali Acc: 0.867 Test Loss: 0.474 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4362735748291016
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.475 Vali Acc: 0.861 Test Loss: 0.475 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6897294521331787
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.477 Vali Acc: 0.861 Test Loss: 0.477 Test Acc: 0.861
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1952947
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9041829109191895
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.100 Vali Acc: 0.590 Test Loss: 1.100 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 1.4266254901885986
Epoch: 2, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.811 Vali Acc: 0.699 Test Loss: 0.811 Test Acc: 0.699
Validation loss decreased (-0.589584 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 1.380101203918457
Epoch: 3, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.699414 --> -0.809242).  Saving model ...
Epoch: 4 cost time: 1.3350329399108887
Epoch: 4, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.794 Vali Acc: 0.757 Test Loss: 0.794 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.509378433227539
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
Validation loss decreased (-0.809242 --> -0.843924).  Saving model ...
Epoch: 6 cost time: 1.5005669593811035
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.820 Vali Acc: 0.803 Test Loss: 0.820 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.287231206893921
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.845 Vali Acc: 0.798 Test Loss: 0.845 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5626094341278076
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.724 Vali Acc: 0.815 Test Loss: 0.724 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.463447093963623
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.755 Vali Acc: 0.815 Test Loss: 0.755 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.894399642944336
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.798 Test Loss: 0.834 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5371873378753662
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5506947040557861
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4949719905853271
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.674572467803955
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5835888385772705
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1952165
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.114379405975342
Epoch: 1, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.001 Vali Acc: 0.647 Test Loss: 1.001 Test Acc: 0.647
Validation loss decreased (inf --> -0.647389).  Saving model ...
Epoch: 2 cost time: 1.4249305725097656
Epoch: 2, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.015 Vali Acc: 0.682 Test Loss: 1.015 Test Acc: 0.682
Validation loss decreased (-0.647389 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 1.5390570163726807
Epoch: 3, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.700 Vali Acc: 0.786 Test Loss: 0.700 Test Acc: 0.786
Validation loss decreased (-0.682071 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 1.4305601119995117
Epoch: 4, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.668 Vali Acc: 0.786 Test Loss: 0.668 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786120).  Saving model ...
Epoch: 5 cost time: 1.5092554092407227
Epoch: 5, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.917 Vali Acc: 0.775 Test Loss: 0.917 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6799230575561523
Epoch: 6, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.676 Vali Acc: 0.821 Test Loss: 0.676 Test Acc: 0.821
Validation loss decreased (-0.786120 --> -0.820802).  Saving model ...
Epoch: 7 cost time: 1.4467394351959229
Epoch: 7, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5538897514343262
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.820802 --> -0.867046).  Saving model ...
Epoch: 9 cost time: 1.4368815422058105
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.809 Test Loss: 0.960 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.509688377380371
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3480510711669922
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.827 Test Loss: 0.624 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.377063274383545
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.832 Test Loss: 0.634 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3480818271636963
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.838 Test Loss: 0.637 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4916648864746094
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6524231433868408
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.838 Test Loss: 0.631 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4543495178222656
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.7487452030181885
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.838 Test Loss: 0.628 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4897868633270264
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.827 Test Loss: 0.627 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1951947
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.2670090198516846
Epoch: 1, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.233 Vali Acc: 0.503 Test Loss: 1.233 Test Acc: 0.503
Validation loss decreased (inf --> -0.502878).  Saving model ...
Epoch: 2 cost time: 1.5164215564727783
Epoch: 2, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.651 Vali Acc: 0.751 Test Loss: 0.651 Test Acc: 0.751
Validation loss decreased (-0.502878 --> -0.751439).  Saving model ...
Epoch: 3 cost time: 1.567148208618164
Epoch: 3, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.688474416732788
Epoch: 4, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.643 Vali Acc: 0.740 Test Loss: 0.643 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.487381935119629
Epoch: 5, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.815 Test Loss: 0.633 Test Acc: 0.815
Validation loss decreased (-0.751439 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 1.6639788150787354
Epoch: 6, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.897 Vali Acc: 0.757 Test Loss: 0.897 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.523998498916626
Epoch: 7, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.086 Vali Acc: 0.775 Test Loss: 1.086 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.478837013244629
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.434 Vali Acc: 0.780 Test Loss: 1.434 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.497492790222168
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.278 Vali Acc: 0.757 Test Loss: 1.278 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5636873245239258
Epoch: 10, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.374 Vali Acc: 0.786 Test Loss: 1.374 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.7596995830535889
Epoch: 11, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.240 Vali Acc: 0.827 Test Loss: 1.240 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826577).  Saving model ...
Epoch: 12 cost time: 1.8124358654022217
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.813 Vali Acc: 0.832 Test Loss: 0.813 Test Acc: 0.832
Validation loss decreased (-0.826577 --> -0.832362).  Saving model ...
Epoch: 13 cost time: 1.5602209568023682
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.891 Vali Acc: 0.838 Test Loss: 0.891 Test Acc: 0.838
Validation loss decreased (-0.832362 --> -0.838141).  Saving model ...
Epoch: 14 cost time: 1.737189531326294
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.915 Vali Acc: 0.815 Test Loss: 0.915 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6798198223114014
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.898 Vali Acc: 0.815 Test Loss: 0.898 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.561539649963379
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.832 Test Loss: 0.876 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6736254692077637
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.838 Test Loss: 0.862 Test Acc: 0.838
Validation loss decreased (-0.838141 --> -0.838142).  Saving model ...
Epoch: 18 cost time: 1.5997653007507324
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.838 Test Loss: 0.854 Test Acc: 0.838
Validation loss decreased (-0.838142 --> -0.838142).  Saving model ...
Epoch: 19 cost time: 1.5981848239898682
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.844 Test Loss: 0.849 Test Acc: 0.844
Validation loss decreased (-0.838142 --> -0.843922).  Saving model ...
Epoch: 20 cost time: 1.51249361038208
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.844 Test Loss: 0.844 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 21 cost time: 1.5522840023040771
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.841 Vali Acc: 0.844 Test Loss: 0.841 Test Acc: 0.844
Validation loss decreased (-0.843922 --> -0.843922).  Saving model ...
Epoch: 22 cost time: 1.5036389827728271
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.850 Test Loss: 0.839 Test Acc: 0.850
Validation loss decreased (-0.843922 --> -0.849703).  Saving model ...
Epoch: 23 cost time: 1.5481879711151123
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.837 Vali Acc: 0.850 Test Loss: 0.837 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 24 cost time: 1.4669530391693115
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.836 Vali Acc: 0.850 Test Loss: 0.836 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 25 cost time: 1.4980337619781494
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.835 Vali Acc: 0.850 Test Loss: 0.835 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 26 cost time: 1.445373296737671
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.834 Vali Acc: 0.850 Test Loss: 0.834 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 27 cost time: 1.4285707473754883
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 28 cost time: 1.551278829574585
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 29 cost time: 1.5786237716674805
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.850 Test Loss: 0.833 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8143484592437744
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 31 cost time: 1.483210563659668
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 32 cost time: 1.6548221111297607
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7378809452056885
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 34 cost time: 1.604053020477295
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5994291305541992
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 36 cost time: 1.598369836807251
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 37 cost time: 1.6874921321868896
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 38 cost time: 1.6833572387695312
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 39 cost time: 1.5579297542572021
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.832 Vali Acc: 0.850 Test Loss: 0.832 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.5886614322662354
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.850 Test Loss: 0.831 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 41 cost time: 1.4985566139221191
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.844 Test Loss: 0.831 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.685194730758667
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.844 Test Loss: 0.831 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.710008144378662
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.6661982536315918
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.664278507232666
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.8529958724975586
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.832 Test Loss: 0.830 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.6598362922668457
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.6885840892791748
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.7961714267730713
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.7223639488220215
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.831 Vali Acc: 0.832 Test Loss: 0.831 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1952725
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.304672956466675
Epoch: 1, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.226 Vali Acc: 0.503 Test Loss: 1.226 Test Acc: 0.503
Validation loss decreased (inf --> -0.502878).  Saving model ...
Epoch: 2 cost time: 1.6098411083221436
Epoch: 2, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.952 Vali Acc: 0.647 Test Loss: 0.952 Test Acc: 0.647
Validation loss decreased (-0.502878 --> -0.647389).  Saving model ...
Epoch: 3 cost time: 1.6172456741333008
Epoch: 3, Steps: 17 | Train Loss: 0.275 Vali Loss: 1.049 Vali Acc: 0.630 Test Loss: 1.049 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6933887004852295
Epoch: 4, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.822 Vali Acc: 0.757 Test Loss: 0.822 Test Acc: 0.757
Validation loss decreased (-0.647389 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 1.5021631717681885
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.582 Vali Acc: 0.838 Test Loss: 0.582 Test Acc: 0.838
Validation loss decreased (-0.757217 --> -0.838144).  Saving model ...
Epoch: 6 cost time: 1.4358057975769043
Epoch: 6, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.827 Test Loss: 0.760 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6426894664764404
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.764 Vali Acc: 0.740 Test Loss: 0.764 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.557168960571289
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.520 Vali Acc: 0.844 Test Loss: 0.520 Test Acc: 0.844
Validation loss decreased (-0.838144 --> -0.843925).  Saving model ...
Epoch: 9 cost time: 1.5129659175872803
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.552 Vali Acc: 0.815 Test Loss: 0.552 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7190465927124023
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5545446872711182
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5955150127410889
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.786 Test Loss: 0.689 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5787532329559326
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.798 Test Loss: 0.679 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4849200248718262
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.803 Test Loss: 0.644 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6628944873809814
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.798 Test Loss: 0.634 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.626845359802246
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6829981803894043
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7157514095306396
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.641 Vali Acc: 0.792 Test Loss: 0.641 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1953219
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7826974391937256
Epoch: 1, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.172 Vali Acc: 0.555 Test Loss: 1.172 Test Acc: 0.555
Validation loss decreased (inf --> -0.554902).  Saving model ...
Epoch: 2 cost time: 1.3845133781433105
Epoch: 2, Steps: 17 | Train Loss: 0.586 Vali Loss: 0.633 Vali Acc: 0.775 Test Loss: 0.633 Test Acc: 0.775
Validation loss decreased (-0.554902 --> -0.774560).  Saving model ...
Epoch: 3 cost time: 1.4285392761230469
Epoch: 3, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.017 Vali Acc: 0.705 Test Loss: 1.017 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4248356819152832
Epoch: 4, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.784 Vali Acc: 0.775 Test Loss: 0.784 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5459983348846436
Epoch: 5, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.994 Vali Acc: 0.803 Test Loss: 0.994 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803458).  Saving model ...
Epoch: 6 cost time: 1.456486701965332
Epoch: 6, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.810 Vali Acc: 0.792 Test Loss: 0.810 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4280586242675781
Epoch: 7, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.700 Vali Acc: 0.815 Test Loss: 0.700 Test Acc: 0.815
Validation loss decreased (-0.803458 --> -0.815022).  Saving model ...
Epoch: 8 cost time: 1.4475679397583008
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.692 Vali Acc: 0.815 Test Loss: 0.692 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 9 cost time: 1.4187061786651611
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.844 Test Loss: 0.650 Test Acc: 0.844
Validation loss decreased (-0.815022 --> -0.843924).  Saving model ...
Epoch: 10 cost time: 1.4810867309570312
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.832 Test Loss: 0.634 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4922683238983154
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.832 Test Loss: 0.624 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4754881858825684
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.832 Test Loss: 0.615 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4318900108337402
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.612 Vali Acc: 0.832 Test Loss: 0.612 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4694530963897705
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.832 Test Loss: 0.609 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.332658052444458
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.832 Test Loss: 0.610 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4885883331298828
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.832 Test Loss: 0.608 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.4272453784942627
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.832 Test Loss: 0.602 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4255692958831787
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.832 Test Loss: 0.602 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.52409029006958
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.832 Test Loss: 0.605 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1951573
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.8998663425445557
Epoch: 1, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.227 Vali Acc: 0.480 Test Loss: 1.227 Test Acc: 0.480
Validation loss decreased (inf --> -0.479757).  Saving model ...
Epoch: 2 cost time: 1.5628228187561035
Epoch: 2, Steps: 17 | Train Loss: 0.627 Vali Loss: 1.129 Vali Acc: 0.647 Test Loss: 1.129 Test Acc: 0.647
Validation loss decreased (-0.479757 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 1.5519795417785645
Epoch: 3, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.673 Vali Acc: 0.786 Test Loss: 0.673 Test Acc: 0.786
Validation loss decreased (-0.647388 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 1.5442469120025635
Epoch: 4, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.699 Vali Acc: 0.832 Test Loss: 0.699 Test Acc: 0.832
Validation loss decreased (-0.786120 --> -0.832363).  Saving model ...
Epoch: 5 cost time: 1.6669528484344482
Epoch: 5, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.734 Vali Acc: 0.809 Test Loss: 0.734 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5481691360473633
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.817 Vali Acc: 0.844 Test Loss: 0.817 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843922).  Saving model ...
Epoch: 7 cost time: 1.4182491302490234
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.641 Vali Acc: 0.821 Test Loss: 0.641 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.447779655456543
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4685819149017334
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.428360939025879
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.821 Test Loss: 0.679 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.465649127960205
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.821 Test Loss: 0.666 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4126708507537842
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.815 Test Loss: 0.660 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.5117135047912598
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4226830005645752
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.815 Test Loss: 0.645 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.687525987625122
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.815 Test Loss: 0.637 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.656553030014038
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.815 Test Loss: 0.633 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1952997
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.0964529514312744
Epoch: 1, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.124 Vali Acc: 0.561 Test Loss: 1.124 Test Acc: 0.561
Validation loss decreased (inf --> -0.560682).  Saving model ...
Epoch: 2 cost time: 1.5459346771240234
Epoch: 2, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.725 Vali Acc: 0.757 Test Loss: 0.725 Test Acc: 0.757
Validation loss decreased (-0.560682 --> -0.757218).  Saving model ...
Epoch: 3 cost time: 1.6158568859100342
Epoch: 3, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.801 Vali Acc: 0.740 Test Loss: 0.801 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4932522773742676
Epoch: 4, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.961 Vali Acc: 0.757 Test Loss: 0.961 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4930806159973145
Epoch: 5, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.074 Vali Acc: 0.746 Test Loss: 1.074 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7195696830749512
Epoch: 6, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.726 Vali Acc: 0.780 Test Loss: 0.726 Test Acc: 0.780
Validation loss decreased (-0.757218 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 1.5665984153747559
Epoch: 7, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.798 Test Loss: 0.806 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797680).  Saving model ...
Epoch: 8 cost time: 1.4994888305664062
Epoch: 8, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.635 Vali Acc: 0.844 Test Loss: 0.635 Test Acc: 0.844
Validation loss decreased (-0.797680 --> -0.843924).  Saving model ...
Epoch: 9 cost time: 1.6041810512542725
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.593 Vali Acc: 0.827 Test Loss: 0.593 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5788958072662354
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.832 Test Loss: 0.536 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4899494647979736
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9968111515045166
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4524896144866943
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4961767196655273
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5683367252349854
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.533 Vali Acc: 0.821 Test Loss: 0.533 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.617332935333252
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.535 Vali Acc: 0.821 Test Loss: 0.535 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5024127960205078
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.821 Test Loss: 0.537 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4892425537109375
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.821 Test Loss: 0.539 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1952355
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.1150708198547363
Epoch: 1, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.868 Vali Acc: 0.382 Test Loss: 1.868 Test Acc: 0.382
Validation loss decreased (inf --> -0.381484).  Saving model ...
Epoch: 2 cost time: 1.459498643875122
Epoch: 2, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.047 Vali Acc: 0.705 Test Loss: 1.047 Test Acc: 0.705
Validation loss decreased (-0.381484 --> -0.705192).  Saving model ...
Epoch: 3 cost time: 1.3939099311828613
Epoch: 3, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.927 Vali Acc: 0.717 Test Loss: 0.927 Test Acc: 0.717
Validation loss decreased (-0.705192 --> -0.716754).  Saving model ...
Epoch: 4 cost time: 1.4104900360107422
Epoch: 4, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.899 Vali Acc: 0.717 Test Loss: 0.899 Test Acc: 0.717
Validation loss decreased (-0.716754 --> -0.716754).  Saving model ...
Epoch: 5 cost time: 1.4874165058135986
Epoch: 5, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.621 Vali Acc: 0.815 Test Loss: 0.621 Test Acc: 0.815
Validation loss decreased (-0.716754 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 1.5011792182922363
Epoch: 6, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.861 Vali Acc: 0.780 Test Loss: 0.861 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5538718700408936
Epoch: 7, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.993 Vali Acc: 0.780 Test Loss: 0.993 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5266335010528564
Epoch: 8, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.148 Vali Acc: 0.775 Test Loss: 1.148 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4414207935333252
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.753 Vali Acc: 0.815 Test Loss: 0.753 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6478016376495361
Epoch: 10, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.195 Vali Acc: 0.757 Test Loss: 1.195 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4456920623779297
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.660 Vali Acc: 0.827 Test Loss: 0.660 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 1.5800442695617676
Epoch: 12, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.124 Vali Acc: 0.809 Test Loss: 1.124 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4871094226837158
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.827 Test Loss: 0.798 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4698388576507568
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.740 Vali Acc: 0.855 Test Loss: 0.740 Test Acc: 0.855
Validation loss decreased (-0.826583 --> -0.855484).  Saving model ...
Epoch: 15 cost time: 1.6122384071350098
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.861 Test Loss: 0.691 Test Acc: 0.861
Validation loss decreased (-0.855484 --> -0.861265).  Saving model ...
Epoch: 16 cost time: 1.4626712799072266
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.388545274734497
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.838 Test Loss: 0.696 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6267876625061035
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.838 Test Loss: 0.692 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.598905324935913
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.838 Test Loss: 0.691 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.652083158493042
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.838 Test Loss: 0.692 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7319097518920898
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.693 Vali Acc: 0.838 Test Loss: 0.693 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.557481288909912
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.838 Test Loss: 0.694 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5827677249908447
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.838 Test Loss: 0.696 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4845912456512451
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.838 Test Loss: 0.697 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.625337839126587
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1951429
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.186734914779663
Epoch: 1, Steps: 17 | Train Loss: 1.686 Vali Loss: 1.267 Vali Acc: 0.497 Test Loss: 1.267 Test Acc: 0.497
Validation loss decreased (inf --> -0.497097).  Saving model ...
Epoch: 2 cost time: 1.555241346359253
Epoch: 2, Steps: 17 | Train Loss: 0.646 Vali Loss: 1.019 Vali Acc: 0.694 Test Loss: 1.019 Test Acc: 0.694
Validation loss decreased (-0.497097 --> -0.693631).  Saving model ...
Epoch: 3 cost time: 1.5249848365783691
Epoch: 3, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.687 Vali Acc: 0.780 Test Loss: 0.687 Test Acc: 0.780
Validation loss decreased (-0.693631 --> -0.780340).  Saving model ...
Epoch: 4 cost time: 1.6428418159484863
Epoch: 4, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.995 Vali Acc: 0.757 Test Loss: 0.995 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6227009296417236
Epoch: 5, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.870 Vali Acc: 0.786 Test Loss: 0.870 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786118).  Saving model ...
Epoch: 6 cost time: 1.475219964981079
Epoch: 6, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5987305641174316
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.736 Vali Acc: 0.809 Test Loss: 0.736 Test Acc: 0.809
Validation loss decreased (-0.786118 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 1.5721087455749512
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.903 Vali Acc: 0.769 Test Loss: 0.903 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4946398735046387
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.792 Test Loss: 0.877 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5562279224395752
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.792 Test Loss: 0.777 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5303220748901367
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.815 Test Loss: 0.765 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815021).  Saving model ...
Epoch: 12 cost time: 1.3724868297576904
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.715 Vali Acc: 0.861 Test Loss: 0.715 Test Acc: 0.861
Validation loss decreased (-0.815021 --> -0.861265).  Saving model ...
Epoch: 13 cost time: 1.382227897644043
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.850 Test Loss: 0.697 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5362732410430908
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3903517723083496
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.844 Test Loss: 0.689 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.437422513961792
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4957635402679443
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.844 Test Loss: 0.685 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4822075366973877
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.832 Test Loss: 0.686 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.419670581817627
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.838 Test Loss: 0.684 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5598905086517334
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.832 Test Loss: 0.682 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4566667079925537
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.832 Test Loss: 0.682 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.58876633644104
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.827 Test Loss: 0.681 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1951445
model size : 7.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.3467862606048584
Epoch: 1, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.182 Vali Acc: 0.543 Test Loss: 1.182 Test Acc: 0.543
Validation loss decreased (inf --> -0.543341).  Saving model ...
Epoch: 2 cost time: 1.678379774093628
Epoch: 2, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.509 Vali Acc: 0.844 Test Loss: 0.509 Test Acc: 0.844
Validation loss decreased (-0.543341 --> -0.843926).  Saving model ...
Epoch: 3 cost time: 1.842785358428955
Epoch: 3, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.252 Vali Acc: 0.717 Test Loss: 1.252 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7812602519989014
Epoch: 4, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.536 Vali Acc: 0.844 Test Loss: 0.536 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.2327704429626465
Epoch: 5, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.869 Vali Acc: 0.763 Test Loss: 0.869 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.810051441192627
Epoch: 6, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.8411643505096436
Epoch: 7, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.017 Vali Acc: 0.827 Test Loss: 1.017 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.848097801208496
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.832 Test Loss: 0.642 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.8424696922302246
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.827 Test Loss: 0.638 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.7694222927093506
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.8025496006011963
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.8481566905975342
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1951995
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.9048211574554443
Epoch: 1, Steps: 17 | Train Loss: 1.675 Vali Loss: 1.356 Vali Acc: 0.347 Test Loss: 1.356 Test Acc: 0.347
Validation loss decreased (inf --> -0.346807).  Saving model ...
Epoch: 2 cost time: 1.1894619464874268
Epoch: 2, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.928 Vali Acc: 0.613 Test Loss: 0.928 Test Acc: 0.613
Validation loss decreased (-0.346807 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 1.2328834533691406
Epoch: 3, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.892 Vali Acc: 0.711 Test Loss: 0.892 Test Acc: 0.711
Validation loss decreased (-0.612707 --> -0.710974).  Saving model ...
Epoch: 4 cost time: 1.1798970699310303
Epoch: 4, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
Validation loss decreased (-0.710974 --> -0.803462).  Saving model ...
Epoch: 5 cost time: 1.153146743774414
Epoch: 5, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.833 Vali Acc: 0.769 Test Loss: 0.833 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0574047565460205
Epoch: 6, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.703 Vali Acc: 0.803 Test Loss: 0.703 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2643330097198486
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.687 Vali Acc: 0.832 Test Loss: 0.687 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832363).  Saving model ...
Epoch: 8 cost time: 1.302795648574829
Epoch: 8, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.830 Vali Acc: 0.757 Test Loss: 0.830 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.170865535736084
Epoch: 9, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3130083084106445
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.662 Vali Acc: 0.815 Test Loss: 0.662 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2460572719573975
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.832 Test Loss: 0.634 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 1.1559414863586426
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.832 Test Loss: 0.646 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2960824966430664
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0798256397247314
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.378730297088623
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.827 Test Loss: 0.636 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.198028326034546
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.827 Test Loss: 0.635 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0597500801086426
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.821 Test Loss: 0.637 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.111264705657959
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.821 Test Loss: 0.634 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9846892356872559
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.821 Test Loss: 0.636 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1897001266479492
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.815 Test Loss: 0.636 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1533150672912598
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1933365
model size : 7.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.727919578552246
Epoch: 1, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.178 Vali Acc: 0.474 Test Loss: 1.178 Test Acc: 0.474
Validation loss decreased (inf --> -0.473977).  Saving model ...
Epoch: 2 cost time: 1.1931486129760742
Epoch: 2, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.050 Vali Acc: 0.647 Test Loss: 1.050 Test Acc: 0.647
Validation loss decreased (-0.473977 --> -0.647388).  Saving model ...
Epoch: 3 cost time: 1.240203619003296
Epoch: 3, Steps: 17 | Train Loss: 0.451 Vali Loss: 1.095 Vali Acc: 0.717 Test Loss: 1.095 Test Acc: 0.717
Validation loss decreased (-0.647388 --> -0.716752).  Saving model ...
Epoch: 4 cost time: 1.1680617332458496
Epoch: 4, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.001 Vali Acc: 0.740 Test Loss: 1.001 Test Acc: 0.740
Validation loss decreased (-0.716752 --> -0.739874).  Saving model ...
Epoch: 5 cost time: 1.1457114219665527
Epoch: 5, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.941 Vali Acc: 0.769 Test Loss: 0.941 Test Acc: 0.769
Validation loss decreased (-0.739874 --> -0.768777).  Saving model ...
Epoch: 6 cost time: 1.470266580581665
Epoch: 6, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.016 Vali Acc: 0.734 Test Loss: 1.016 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4185166358947754
Epoch: 7, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.248 Vali Acc: 0.780 Test Loss: 1.248 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780334).  Saving model ...
Epoch: 8 cost time: 1.391017198562622
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.834 Vali Acc: 0.821 Test Loss: 0.834 Test Acc: 0.821
Validation loss decreased (-0.780334 --> -0.820801).  Saving model ...
Epoch: 9 cost time: 1.3659820556640625
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.002 Vali Acc: 0.775 Test Loss: 1.002 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2285761833190918
Epoch: 10, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.133 Vali Acc: 0.803 Test Loss: 1.133 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1947758197784424
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.803 Test Loss: 0.947 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.139002799987793
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.827 Test Loss: 0.794 Test Acc: 0.827
Validation loss decreased (-0.820801 --> -0.826582).  Saving model ...
Epoch: 13 cost time: 1.1641783714294434
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.821 Test Loss: 0.774 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1484174728393555
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.815 Test Loss: 0.777 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3520753383636475
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.815 Test Loss: 0.780 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1868319511413574
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.815 Test Loss: 0.785 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.240936040878296
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.821 Test Loss: 0.787 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3123083114624023
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.791 Vali Acc: 0.821 Test Loss: 0.791 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3959269523620605
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.794 Vali Acc: 0.821 Test Loss: 0.794 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3673455715179443
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.797 Vali Acc: 0.821 Test Loss: 0.797 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3016235828399658
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.821 Test Loss: 0.801 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2710163593292236
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.821 Test Loss: 0.802 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1931843
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5987749099731445
Epoch: 1, Steps: 17 | Train Loss: 1.579 Vali Loss: 1.419 Vali Acc: 0.376 Test Loss: 1.419 Test Acc: 0.376
Validation loss decreased (inf --> -0.375708).  Saving model ...
Epoch: 2 cost time: 1.369866132736206
Epoch: 2, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.718 Vali Acc: 0.682 Test Loss: 0.718 Test Acc: 0.682
Validation loss decreased (-0.375708 --> -0.682074).  Saving model ...
Epoch: 3 cost time: 1.0929818153381348
Epoch: 3, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.673 Vali Acc: 0.769 Test Loss: 0.673 Test Acc: 0.769
Validation loss decreased (-0.682074 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 1.1216695308685303
Epoch: 4, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.358 Vali Acc: 0.699 Test Loss: 1.358 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1536128520965576
Epoch: 5, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.969 Vali Acc: 0.780 Test Loss: 0.969 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780337).  Saving model ...
Epoch: 6 cost time: 1.0841805934906006
Epoch: 6, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.674 Vali Acc: 0.803 Test Loss: 0.674 Test Acc: 0.803
Validation loss decreased (-0.780337 --> -0.803461).  Saving model ...
Epoch: 7 cost time: 1.0592198371887207
Epoch: 7, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.141 Vali Acc: 0.676 Test Loss: 1.141 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1876063346862793
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.848 Vali Acc: 0.780 Test Loss: 0.848 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1559913158416748
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.794 Vali Acc: 0.821 Test Loss: 0.794 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820801).  Saving model ...
Epoch: 10 cost time: 1.2720787525177002
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.775 Vali Acc: 0.850 Test Loss: 0.775 Test Acc: 0.850
Validation loss decreased (-0.820801 --> -0.849703).  Saving model ...
Epoch: 11 cost time: 1.089219570159912
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.648 Vali Acc: 0.792 Test Loss: 0.648 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.09405517578125
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.698 Vali Acc: 0.809 Test Loss: 0.698 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.288501262664795
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.499 Vali Acc: 0.861 Test Loss: 0.499 Test Acc: 0.861
Validation loss decreased (-0.849703 --> -0.861267).  Saving model ...
Epoch: 14 cost time: 1.2428007125854492
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.503 Vali Acc: 0.861 Test Loss: 0.503 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3852903842926025
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.507 Vali Acc: 0.850 Test Loss: 0.507 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.332259178161621
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.504 Vali Acc: 0.861 Test Loss: 0.504 Test Acc: 0.861
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2590429782867432
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.509 Vali Acc: 0.850 Test Loss: 0.509 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.168515920639038
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1888079643249512
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.512 Vali Acc: 0.850 Test Loss: 0.512 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2342870235443115
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2127199172973633
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.514 Vali Acc: 0.850 Test Loss: 0.514 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2970199584960938
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.515 Vali Acc: 0.850 Test Loss: 0.515 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2017097473144531
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1931093
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.568009853363037
Epoch: 1, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.156 Vali Acc: 0.549 Test Loss: 1.156 Test Acc: 0.549
Validation loss decreased (inf --> -0.549121).  Saving model ...
Epoch: 2 cost time: 1.0457870960235596
Epoch: 2, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.816 Vali Acc: 0.705 Test Loss: 0.816 Test Acc: 0.705
Validation loss decreased (-0.549121 --> -0.705194).  Saving model ...
Epoch: 3 cost time: 1.206038475036621
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.802 Vali Acc: 0.763 Test Loss: 0.802 Test Acc: 0.763
Validation loss decreased (-0.705194 --> -0.762998).  Saving model ...
Epoch: 4 cost time: 1.0554370880126953
Epoch: 4, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.718 Vali Acc: 0.815 Test Loss: 0.718 Test Acc: 0.815
Validation loss decreased (-0.762998 --> -0.815022).  Saving model ...
Epoch: 5 cost time: 1.0954749584197998
Epoch: 5, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.873 Vali Acc: 0.798 Test Loss: 0.873 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.099104642868042
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.857 Vali Acc: 0.780 Test Loss: 0.857 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9977264404296875
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.832 Vali Acc: 0.792 Test Loss: 0.832 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.109438419342041
Epoch: 8, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.686 Vali Acc: 0.815 Test Loss: 0.686 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 9 cost time: 1.1965117454528809
Epoch: 9, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.856 Vali Acc: 0.832 Test Loss: 0.856 Test Acc: 0.832
Validation loss decreased (-0.815022 --> -0.832361).  Saving model ...
Epoch: 10 cost time: 1.1181261539459229
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.941 Vali Acc: 0.786 Test Loss: 0.941 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0182521343231201
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.792 Test Loss: 0.762 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1924922466278076
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9982104301452637
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.792 Test Loss: 0.762 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.006730318069458
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.786 Test Loss: 0.755 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1734669208526611
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.786 Test Loss: 0.745 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2414374351501465
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.786 Test Loss: 0.738 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0876822471618652
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.733 Vali Acc: 0.792 Test Loss: 0.733 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0706334114074707
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1672136783599854
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1930811
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.495974540710449
Epoch: 1, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.683 Vali Acc: 0.503 Test Loss: 1.683 Test Acc: 0.503
Validation loss decreased (inf --> -0.502873).  Saving model ...
Epoch: 2 cost time: 1.0874006748199463
Epoch: 2, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.895 Vali Acc: 0.740 Test Loss: 0.895 Test Acc: 0.740
Validation loss decreased (-0.502873 --> -0.739875).  Saving model ...
Epoch: 3 cost time: 1.169527292251587
Epoch: 3, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
Validation loss decreased (-0.739875 --> -0.757219).  Saving model ...
Epoch: 4 cost time: 1.2242472171783447
Epoch: 4, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 1.1036324501037598
Epoch: 5, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.526 Vali Acc: 0.867 Test Loss: 0.526 Test Acc: 0.867
Validation loss decreased (-0.791901 --> -0.867047).  Saving model ...
Epoch: 6 cost time: 1.263826847076416
Epoch: 6, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.540 Vali Acc: 0.838 Test Loss: 0.540 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2099997997283936
Epoch: 7, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.609 Vali Acc: 0.838 Test Loss: 0.609 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1307544708251953
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.564 Vali Acc: 0.838 Test Loss: 0.564 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1945245265960693
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.483 Vali Acc: 0.832 Test Loss: 0.483 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4363751411437988
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.476 Vali Acc: 0.827 Test Loss: 0.476 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2927305698394775
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.482 Vali Acc: 0.827 Test Loss: 0.482 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1071186065673828
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.480 Vali Acc: 0.832 Test Loss: 0.480 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.180018663406372
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.486 Vali Acc: 0.832 Test Loss: 0.486 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2156932353973389
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.832 Test Loss: 0.490 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.1032671928405762
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.490 Vali Acc: 0.832 Test Loss: 0.490 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1930373
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3795666694641113
Epoch: 1, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.174 Vali Acc: 0.422 Test Loss: 1.174 Test Acc: 0.422
Validation loss decreased (inf --> -0.421954).  Saving model ...
Epoch: 2 cost time: 1.189781665802002
Epoch: 2, Steps: 17 | Train Loss: 0.674 Vali Loss: 1.033 Vali Acc: 0.682 Test Loss: 1.033 Test Acc: 0.682
Validation loss decreased (-0.421954 --> -0.682071).  Saving model ...
Epoch: 3 cost time: 1.2112970352172852
Epoch: 3, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.781 Vali Acc: 0.757 Test Loss: 0.781 Test Acc: 0.757
Validation loss decreased (-0.682071 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 1.3114213943481445
Epoch: 4, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.761 Vali Acc: 0.798 Test Loss: 0.761 Test Acc: 0.798
Validation loss decreased (-0.757218 --> -0.797680).  Saving model ...
Epoch: 5 cost time: 1.285783290863037
Epoch: 5, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
Validation loss decreased (-0.797680 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 1.158893346786499
Epoch: 6, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.834 Vali Acc: 0.775 Test Loss: 0.834 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2536485195159912
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.496 Vali Acc: 0.821 Test Loss: 0.496 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 1.4405927658081055
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.546 Vali Acc: 0.832 Test Loss: 0.546 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 1.186171054840088
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.020 Vali Acc: 0.803 Test Loss: 1.020 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4710898399353027
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.832364 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 1.3058404922485352
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.815 Test Loss: 0.554 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3625829219818115
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.809 Test Loss: 0.551 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3413918018341064
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.821 Test Loss: 0.545 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6274454593658447
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.541 Vali Acc: 0.815 Test Loss: 0.541 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4052858352661133
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.536 Vali Acc: 0.815 Test Loss: 0.536 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3013989925384521
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.821 Test Loss: 0.534 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3886909484863281
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.821 Test Loss: 0.530 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.281430721282959
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.821 Test Loss: 0.529 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1580274105072021
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.815 Test Loss: 0.530 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2447216510772705
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.528 Vali Acc: 0.815 Test Loss: 0.528 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1930643
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.673337697982788
Epoch: 1, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.081 Vali Acc: 0.480 Test Loss: 1.081 Test Acc: 0.480
Validation loss decreased (inf --> -0.479758).  Saving model ...
Epoch: 2 cost time: 1.2234218120574951
Epoch: 2, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.071 Vali Acc: 0.682 Test Loss: 1.071 Test Acc: 0.682
Validation loss decreased (-0.479758 --> -0.682070).  Saving model ...
Epoch: 3 cost time: 1.2417173385620117
Epoch: 3, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.046 Vali Acc: 0.757 Test Loss: 1.046 Test Acc: 0.757
Validation loss decreased (-0.682070 --> -0.757215).  Saving model ...
Epoch: 4 cost time: 1.3326842784881592
Epoch: 4, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.694 Vali Acc: 0.780 Test Loss: 0.694 Test Acc: 0.780
Validation loss decreased (-0.757215 --> -0.780340).  Saving model ...
Epoch: 5 cost time: 1.4532322883605957
Epoch: 5, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.656 Vali Acc: 0.798 Test Loss: 0.656 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 1.319864273071289
Epoch: 6, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.793 Vali Acc: 0.792 Test Loss: 0.793 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.21223783493042
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.808 Vali Acc: 0.792 Test Loss: 0.808 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2376205921173096
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.896 Vali Acc: 0.809 Test Loss: 0.896 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809240).  Saving model ...
Epoch: 9 cost time: 1.248347520828247
Epoch: 9, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.827 Test Loss: 0.795 Test Acc: 0.827
Validation loss decreased (-0.809240 --> -0.826582).  Saving model ...
Epoch: 10 cost time: 1.2974605560302734
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.716 Vali Acc: 0.850 Test Loss: 0.716 Test Acc: 0.850
Validation loss decreased (-0.826582 --> -0.849704).  Saving model ...
Epoch: 11 cost time: 1.3113608360290527
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1546518802642822
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.827 Test Loss: 0.648 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2648570537567139
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.644 Vali Acc: 0.827 Test Loss: 0.644 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1827683448791504
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.821 Test Loss: 0.640 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2290701866149902
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.233910083770752
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.821 Test Loss: 0.635 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.035494089126587
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.815 Test Loss: 0.634 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0777177810668945
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.815 Test Loss: 0.632 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1820530891418457
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.815 Test Loss: 0.632 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3893649578094482
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.631 Vali Acc: 0.815 Test Loss: 0.631 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1930053
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5600478649139404
Epoch: 1, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.290 Vali Acc: 0.514 Test Loss: 1.290 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 1.213855266571045
Epoch: 2, Steps: 17 | Train Loss: 0.667 Vali Loss: 0.621 Vali Acc: 0.769 Test Loss: 0.621 Test Acc: 0.769
Validation loss decreased (-0.514438 --> -0.768780).  Saving model ...
Epoch: 3 cost time: 1.1636412143707275
Epoch: 3, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.022 Vali Acc: 0.676 Test Loss: 1.022 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.30491304397583
Epoch: 4, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.998 Vali Acc: 0.740 Test Loss: 0.998 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2765882015228271
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1699228286743164
Epoch: 6, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.909 Vali Acc: 0.751 Test Loss: 0.909 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1250813007354736
Epoch: 7, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.813 Vali Acc: 0.815 Test Loss: 0.813 Test Acc: 0.815
Validation loss decreased (-0.768780 --> -0.815021).  Saving model ...
Epoch: 8 cost time: 1.073622465133667
Epoch: 8, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.069 Vali Acc: 0.844 Test Loss: 1.069 Test Acc: 0.844
Validation loss decreased (-0.815021 --> -0.843920).  Saving model ...
Epoch: 9 cost time: 1.1296484470367432
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.884 Vali Acc: 0.798 Test Loss: 0.884 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2066104412078857
Epoch: 10, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.991 Vali Acc: 0.815 Test Loss: 0.991 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1801068782806396
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.970 Vali Acc: 0.786 Test Loss: 0.970 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.135122537612915
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.973 Vali Acc: 0.792 Test Loss: 0.973 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1726722717285156
Epoch: 13, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.948 Vali Acc: 0.809 Test Loss: 0.948 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.182462215423584
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.899 Vali Acc: 0.809 Test Loss: 0.899 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1791985034942627
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.912 Vali Acc: 0.809 Test Loss: 0.912 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0586175918579102
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.809 Test Loss: 0.884 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2872576713562012
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.809 Test Loss: 0.862 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2243456840515137
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1929963
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6542463302612305
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 0.976 Vali Acc: 0.595 Test Loss: 0.976 Test Acc: 0.595
Validation loss decreased (inf --> -0.595366).  Saving model ...
Epoch: 2 cost time: 1.2532989978790283
Epoch: 2, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.595366 --> -0.716756).  Saving model ...
Epoch: 3 cost time: 1.2692959308624268
Epoch: 3, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.711 Vali Acc: 0.775 Test Loss: 0.711 Test Acc: 0.775
Validation loss decreased (-0.716756 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 1.187495231628418
Epoch: 4, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.669 Vali Acc: 0.780 Test Loss: 0.669 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780340).  Saving model ...
Epoch: 5 cost time: 1.376115083694458
Epoch: 5, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.634 Vali Acc: 0.838 Test Loss: 0.634 Test Acc: 0.838
Validation loss decreased (-0.780340 --> -0.838144).  Saving model ...
Epoch: 6 cost time: 1.3137049674987793
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.880 Vali Acc: 0.798 Test Loss: 0.880 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2866108417510986
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.091 Vali Acc: 0.780 Test Loss: 1.091 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3860783576965332
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.503 Vali Acc: 0.855 Test Loss: 0.503 Test Acc: 0.855
Validation loss decreased (-0.838144 --> -0.855486).  Saving model ...
Epoch: 9 cost time: 1.044891595840454
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.670 Vali Acc: 0.873 Test Loss: 0.670 Test Acc: 0.873
Validation loss decreased (-0.855486 --> -0.872826).  Saving model ...
Epoch: 10 cost time: 1.0957167148590088
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.867 Test Loss: 0.529 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.125821828842163
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.523 Vali Acc: 0.844 Test Loss: 0.523 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1069889068603516
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.530 Vali Acc: 0.838 Test Loss: 0.530 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0817961692810059
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.534 Vali Acc: 0.832 Test Loss: 0.534 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1963191032409668
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2485826015472412
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.832 Test Loss: 0.538 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.1334342956542969
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.538 Vali Acc: 0.821 Test Loss: 0.538 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1425011157989502
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.539 Vali Acc: 0.821 Test Loss: 0.539 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2686090469360352
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.542 Vali Acc: 0.821 Test Loss: 0.542 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.1371991634368896
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.543 Vali Acc: 0.821 Test Loss: 0.543 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1930805
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.6693670749664307
Epoch: 1, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.152 Vali Acc: 0.497 Test Loss: 1.152 Test Acc: 0.497
Validation loss decreased (inf --> -0.497098).  Saving model ...
Epoch: 2 cost time: 1.2814385890960693
Epoch: 2, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.588 Vali Acc: 0.775 Test Loss: 0.588 Test Acc: 0.775
Validation loss decreased (-0.497098 --> -0.774561).  Saving model ...
Epoch: 3 cost time: 1.2862963676452637
Epoch: 3, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.910 Vali Acc: 0.746 Test Loss: 0.910 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1733729839324951
Epoch: 4, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.624 Vali Acc: 0.827 Test Loss: 0.624 Test Acc: 0.827
Validation loss decreased (-0.774561 --> -0.826583).  Saving model ...
Epoch: 5 cost time: 1.2484033107757568
Epoch: 5, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.845 Vali Acc: 0.798 Test Loss: 0.845 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3192379474639893
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.688 Vali Acc: 0.832 Test Loss: 0.688 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832363).  Saving model ...
Epoch: 7 cost time: 1.3657827377319336
Epoch: 7, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.905 Vali Acc: 0.809 Test Loss: 0.905 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2291874885559082
Epoch: 8, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.133 Vali Acc: 0.775 Test Loss: 1.133 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4171464443206787
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.140 Vali Acc: 0.763 Test Loss: 1.140 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3590235710144043
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.067 Vali Acc: 0.786 Test Loss: 1.067 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.432138204574585
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3039860725402832
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.999 Vali Acc: 0.798 Test Loss: 0.999 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2296688556671143
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.990 Vali Acc: 0.792 Test Loss: 0.990 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2644546031951904
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.986 Vali Acc: 0.792 Test Loss: 0.986 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.193042516708374
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.981 Vali Acc: 0.792 Test Loss: 0.981 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2028923034667969
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.792 Test Loss: 0.975 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1931363
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.5117087364196777
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.157 Vali Acc: 0.474 Test Loss: 1.157 Test Acc: 0.474
Validation loss decreased (inf --> -0.473977).  Saving model ...
Epoch: 2 cost time: 1.3678584098815918
Epoch: 2, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.609 Vali Acc: 0.815 Test Loss: 0.609 Test Acc: 0.815
Validation loss decreased (-0.473977 --> -0.815023).  Saving model ...
Epoch: 3 cost time: 1.1267187595367432
Epoch: 3, Steps: 17 | Train Loss: 0.276 Vali Loss: 1.216 Vali Acc: 0.711 Test Loss: 1.216 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1397275924682617
Epoch: 4, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.750 Vali Acc: 0.827 Test Loss: 0.750 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826582).  Saving model ...
Epoch: 5 cost time: 1.1992480754852295
Epoch: 5, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.925 Vali Acc: 0.751 Test Loss: 0.925 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1712605953216553
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.725 Vali Acc: 0.861 Test Loss: 0.725 Test Acc: 0.861
Validation loss decreased (-0.826582 --> -0.861264).  Saving model ...
Epoch: 7 cost time: 1.0737981796264648
Epoch: 7, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.811 Vali Acc: 0.798 Test Loss: 0.811 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.154642105102539
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.016 Vali Acc: 0.798 Test Loss: 1.016 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1427690982818604
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.703 Vali Acc: 0.798 Test Loss: 0.703 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2243611812591553
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.838 Test Loss: 0.640 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1013500690460205
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.204 Vali Acc: 0.815 Test Loss: 1.204 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2164130210876465
Epoch: 12, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.850 Vali Acc: 0.809 Test Loss: 0.850 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1691017150878906
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.930 Vali Acc: 0.798 Test Loss: 0.930 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1036429405212402
Epoch: 14, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.746 Vali Acc: 0.798 Test Loss: 0.746 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2952699661254883
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.827 Test Loss: 0.576 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.33095383644104
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.844 Test Loss: 0.551 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1929845
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7923030853271484
Epoch: 1, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.474 Vali Acc: 0.526 Test Loss: 1.474 Test Acc: 0.526
Validation loss decreased (inf --> -0.525997).  Saving model ...
Epoch: 2 cost time: 1.374760389328003
Epoch: 2, Steps: 17 | Train Loss: 0.858 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
Validation loss decreased (-0.525997 --> -0.763000).  Saving model ...
Epoch: 3 cost time: 1.416964054107666
Epoch: 3, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.972 Vali Acc: 0.694 Test Loss: 0.972 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.335942029953003
Epoch: 4, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.695 Vali Acc: 0.740 Test Loss: 0.695 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3580374717712402
Epoch: 5, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.856 Vali Acc: 0.792 Test Loss: 0.856 Test Acc: 0.792
Validation loss decreased (-0.763000 --> -0.791899).  Saving model ...
Epoch: 6 cost time: 1.3206799030303955
Epoch: 6, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.594 Vali Acc: 0.832 Test Loss: 0.594 Test Acc: 0.832
Validation loss decreased (-0.791899 --> -0.832364).  Saving model ...
Epoch: 7 cost time: 1.4146945476531982
Epoch: 7, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.926 Vali Acc: 0.809 Test Loss: 0.926 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2581186294555664
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3134818077087402
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.891 Vali Acc: 0.815 Test Loss: 0.891 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.337294340133667
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.894 Vali Acc: 0.821 Test Loss: 0.894 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.342834711074829
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.162 Vali Acc: 0.792 Test Loss: 1.162 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.410412073135376
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.824 Vali Acc: 0.815 Test Loss: 0.824 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3460938930511475
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.850 Test Loss: 0.772 Test Acc: 0.850
Validation loss decreased (-0.832364 --> -0.849703).  Saving model ...
Epoch: 14 cost time: 1.3008449077606201
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.832 Test Loss: 0.773 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2566163539886475
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.773 Vali Acc: 0.832 Test Loss: 0.773 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3020436763763428
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.772 Vali Acc: 0.832 Test Loss: 0.772 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1777901649475098
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.832 Test Loss: 0.769 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.31905198097229
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.768 Vali Acc: 0.832 Test Loss: 0.768 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2915637493133545
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.832 Test Loss: 0.765 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3519065380096436
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.763 Vali Acc: 0.832 Test Loss: 0.763 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4383134841918945
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.832 Test Loss: 0.760 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4712762832641602
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.832 Test Loss: 0.760 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.396754503250122
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.759 Vali Acc: 0.832 Test Loss: 0.759 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1931333
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.404916763305664
Epoch: 1, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.582 Vali Acc: 0.410 Test Loss: 1.582 Test Acc: 0.410
Validation loss decreased (inf --> -0.410389).  Saving model ...
Epoch: 2 cost time: 1.2175061702728271
Epoch: 2, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.946 Vali Acc: 0.671 Test Loss: 0.946 Test Acc: 0.671
Validation loss decreased (-0.410389 --> -0.670511).  Saving model ...
Epoch: 3 cost time: 1.139617919921875
Epoch: 3, Steps: 17 | Train Loss: 0.260 Vali Loss: 1.335 Vali Acc: 0.676 Test Loss: 1.335 Test Acc: 0.676
Validation loss decreased (-0.670511 --> -0.676287).  Saving model ...
Epoch: 4 cost time: 1.323288917541504
Epoch: 4, Steps: 17 | Train Loss: 0.367 Vali Loss: 1.014 Vali Acc: 0.711 Test Loss: 1.014 Test Acc: 0.711
Validation loss decreased (-0.676287 --> -0.710973).  Saving model ...
Epoch: 5 cost time: 1.476060390472412
Epoch: 5, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.461 Vali Acc: 0.832 Test Loss: 0.461 Test Acc: 0.832
Validation loss decreased (-0.710973 --> -0.832365).  Saving model ...
Epoch: 6 cost time: 1.2523539066314697
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.993 Vali Acc: 0.792 Test Loss: 0.993 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3215718269348145
Epoch: 7, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.904 Vali Acc: 0.809 Test Loss: 0.904 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2717864513397217
Epoch: 8, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.848 Vali Acc: 0.780 Test Loss: 0.848 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2567965984344482
Epoch: 9, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.246 Vali Acc: 0.798 Test Loss: 1.246 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3623967170715332
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.928 Vali Acc: 0.792 Test Loss: 0.928 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4656059741973877
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2941575050354004
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.904 Vali Acc: 0.809 Test Loss: 0.904 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.300405740737915
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.445 Vali Acc: 0.746 Test Loss: 1.445 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.250413417816162
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.222 Vali Acc: 0.769 Test Loss: 1.222 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.341707468032837
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.809 Test Loss: 1.099 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1930755
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4935336112976074
Epoch: 1, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.055 Vali Acc: 0.624 Test Loss: 1.055 Test Acc: 0.624
Validation loss decreased (inf --> -0.624267).  Saving model ...
Epoch: 2 cost time: 1.182342529296875
Epoch: 2, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.913 Vali Acc: 0.717 Test Loss: 0.913 Test Acc: 0.717
Validation loss decreased (-0.624267 --> -0.716754).  Saving model ...
Epoch: 3 cost time: 1.0905141830444336
Epoch: 3, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.702 Vali Acc: 0.751 Test Loss: 0.702 Test Acc: 0.751
Validation loss decreased (-0.716754 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 1.1189568042755127
Epoch: 4, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.177 Vali Acc: 0.723 Test Loss: 1.177 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1550629138946533
Epoch: 5, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.973 Vali Acc: 0.792 Test Loss: 0.973 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791898).  Saving model ...
Epoch: 6 cost time: 1.0584917068481445
Epoch: 6, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.115 Vali Acc: 0.723 Test Loss: 1.115 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2027275562286377
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.871 Vali Acc: 0.775 Test Loss: 0.871 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3444688320159912
Epoch: 8, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.879 Vali Acc: 0.786 Test Loss: 0.879 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.22007155418396
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
Validation loss decreased (-0.791898 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 1.188514232635498
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.157 Vali Acc: 0.809 Test Loss: 1.157 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2293732166290283
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.827 Vali Acc: 0.786 Test Loss: 0.827 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1479878425598145
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.140268087387085
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.714 Vali Acc: 0.792 Test Loss: 0.714 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1807045936584473
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.792 Test Loss: 0.710 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1280333995819092
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.798 Test Loss: 0.711 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.143306016921997
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.792 Test Loss: 0.711 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1552894115447998
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.792 Test Loss: 0.712 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2021205425262451
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.792 Test Loss: 0.712 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0811970233917236
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.713 Vali Acc: 0.786 Test Loss: 0.713 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1929893
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4142441749572754
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.098 Vali Acc: 0.520 Test Loss: 1.098 Test Acc: 0.520
Validation loss decreased (inf --> -0.520220).  Saving model ...
Epoch: 2 cost time: 1.19368577003479
Epoch: 2, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.923 Vali Acc: 0.751 Test Loss: 0.923 Test Acc: 0.751
Validation loss decreased (-0.520220 --> -0.751436).  Saving model ...
Epoch: 3 cost time: 1.2017652988433838
Epoch: 3, Steps: 17 | Train Loss: 0.337 Vali Loss: 1.049 Vali Acc: 0.728 Test Loss: 1.049 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2363271713256836
Epoch: 4, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.628 Vali Acc: 0.780 Test Loss: 0.628 Test Acc: 0.780
Validation loss decreased (-0.751436 --> -0.780341).  Saving model ...
Epoch: 5 cost time: 1.1881306171417236
Epoch: 5, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803460).  Saving model ...
Epoch: 6 cost time: 1.2266240119934082
Epoch: 6, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.841 Vali Acc: 0.792 Test Loss: 0.841 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1746366024017334
Epoch: 7, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.551 Vali Acc: 0.873 Test Loss: 0.551 Test Acc: 0.873
Validation loss decreased (-0.803460 --> -0.872827).  Saving model ...
Epoch: 8 cost time: 1.2866055965423584
Epoch: 8, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.598 Vali Acc: 0.827 Test Loss: 0.598 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1926696300506592
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.544 Vali Acc: 0.855 Test Loss: 0.544 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2343337535858154
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.522 Vali Acc: 0.844 Test Loss: 0.522 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2072532176971436
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1467695236206055
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.508 Vali Acc: 0.850 Test Loss: 0.508 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.225999355316162
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.510 Vali Acc: 0.850 Test Loss: 0.510 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.14442777633667
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.511 Vali Acc: 0.850 Test Loss: 0.511 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2119228839874268
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.517 Vali Acc: 0.850 Test Loss: 0.517 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.144965410232544
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.516 Vali Acc: 0.850 Test Loss: 0.516 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.2670762538909912
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.519 Vali Acc: 0.850 Test Loss: 0.519 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1929973
model size : 7.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.7452504634857178
Epoch: 1, Steps: 17 | Train Loss: 1.538 Vali Loss: 0.952 Vali Acc: 0.653 Test Loss: 0.952 Test Acc: 0.653
Validation loss decreased (inf --> -0.653170).  Saving model ...
Epoch: 2 cost time: 1.4059844017028809
Epoch: 2, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.816 Vali Acc: 0.699 Test Loss: 0.816 Test Acc: 0.699
Validation loss decreased (-0.653170 --> -0.699414).  Saving model ...
Epoch: 3 cost time: 1.3055195808410645
Epoch: 3, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.056 Vali Acc: 0.723 Test Loss: 1.056 Test Acc: 0.723
Validation loss decreased (-0.699414 --> -0.722533).  Saving model ...
Epoch: 4 cost time: 1.3436470031738281
Epoch: 4, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.770 Vali Acc: 0.798 Test Loss: 0.770 Test Acc: 0.798
Validation loss decreased (-0.722533 --> -0.797680).  Saving model ...
Epoch: 5 cost time: 1.3856101036071777
Epoch: 5, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.928 Vali Acc: 0.769 Test Loss: 0.928 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3493952751159668
Epoch: 6, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.865 Vali Acc: 0.780 Test Loss: 0.865 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4321577548980713
Epoch: 7, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.708 Vali Acc: 0.827 Test Loss: 0.708 Test Acc: 0.827
Validation loss decreased (-0.797680 --> -0.826583).  Saving model ...
Epoch: 8 cost time: 1.4104371070861816
Epoch: 8, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.275571584701538
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.629 Vali Acc: 0.827 Test Loss: 0.629 Test Acc: 0.827
Validation loss decreased (-0.826583 --> -0.826583).  Saving model ...
Epoch: 10 cost time: 1.2674291133880615
Epoch: 10, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.538 Vali Acc: 0.815 Test Loss: 0.538 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2869033813476562
Epoch: 11, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2700145244598389
Epoch: 12, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.594 Vali Acc: 0.792 Test Loss: 0.594 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4226233959197998
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.792 Test Loss: 0.636 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2338085174560547
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.792 Test Loss: 0.625 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2808680534362793
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.786 Test Loss: 0.614 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3672122955322266
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.611 Vali Acc: 0.786 Test Loss: 0.611 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.443232774734497
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.798 Test Loss: 0.608 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3329739570617676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.798 Test Loss: 0.605 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.388108253479004
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.605 Vali Acc: 0.798 Test Loss: 0.605 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1930587
model size : 7.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.278148651123047
Epoch: 1, Steps: 17 | Train Loss: 1.726 Vali Loss: 1.288 Vali Acc: 0.410 Test Loss: 1.288 Test Acc: 0.410
Validation loss decreased (inf --> -0.410392).  Saving model ...
Epoch: 2 cost time: 1.0213351249694824
Epoch: 2, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.079 Vali Acc: 0.653 Test Loss: 1.079 Test Acc: 0.653
Validation loss decreased (-0.410392 --> -0.653168).  Saving model ...
Epoch: 3 cost time: 1.0138263702392578
Epoch: 3, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.870 Vali Acc: 0.769 Test Loss: 0.870 Test Acc: 0.769
Validation loss decreased (-0.653168 --> -0.768777).  Saving model ...
Epoch: 4 cost time: 0.8272066116333008
Epoch: 4, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
Validation loss decreased (-0.768777 --> -0.803461).  Saving model ...
Epoch: 5 cost time: 1.0338160991668701
Epoch: 5, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.249 Vali Acc: 0.728 Test Loss: 1.249 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9534180164337158
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.937 Vali Acc: 0.798 Test Loss: 0.937 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0030872821807861
Epoch: 7, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.119 Vali Acc: 0.757 Test Loss: 1.119 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9307155609130859
Epoch: 8, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.409 Vali Acc: 0.740 Test Loss: 1.409 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.135315179824829
Epoch: 9, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.982 Vali Acc: 0.803 Test Loss: 0.982 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1860833168029785
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.863 Vali Acc: 0.803 Test Loss: 0.863 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0173814296722412
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.963 Vali Acc: 0.757 Test Loss: 0.963 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0880746841430664
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.147956132888794
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.873 Vali Acc: 0.780 Test Loss: 0.873 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.039520502090454
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.851 Vali Acc: 0.792 Test Loss: 0.851 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1925189
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.529719829559326
Epoch: 1, Steps: 17 | Train Loss: 1.642 Vali Loss: 1.260 Vali Acc: 0.514 Test Loss: 1.260 Test Acc: 0.514
Validation loss decreased (inf --> -0.514438).  Saving model ...
Epoch: 2 cost time: 0.9758658409118652
Epoch: 2, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.838 Vali Acc: 0.688 Test Loss: 0.838 Test Acc: 0.688
Validation loss decreased (-0.514438 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 0.9801337718963623
Epoch: 3, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.893 Vali Acc: 0.734 Test Loss: 0.893 Test Acc: 0.734
Validation loss decreased (-0.687853 --> -0.734095).  Saving model ...
Epoch: 4 cost time: 0.9659378528594971
Epoch: 4, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.963 Vali Acc: 0.740 Test Loss: 0.963 Test Acc: 0.740
Validation loss decreased (-0.734095 --> -0.739875).  Saving model ...
Epoch: 5 cost time: 0.9385116100311279
Epoch: 5, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.795 Vali Acc: 0.786 Test Loss: 0.795 Test Acc: 0.786
Validation loss decreased (-0.739875 --> -0.786119).  Saving model ...
Epoch: 6 cost time: 0.9426908493041992
Epoch: 6, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.398 Vali Acc: 0.728 Test Loss: 1.398 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0228917598724365
Epoch: 7, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.882 Vali Acc: 0.798 Test Loss: 0.882 Test Acc: 0.798
Validation loss decreased (-0.786119 --> -0.797679).  Saving model ...
Epoch: 8 cost time: 0.9917821884155273
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.619 Vali Acc: 0.844 Test Loss: 0.619 Test Acc: 0.844
Validation loss decreased (-0.797679 --> -0.843924).  Saving model ...
Epoch: 9 cost time: 0.8342587947845459
Epoch: 9, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.850 Test Loss: 0.579 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849705).  Saving model ...
Epoch: 10 cost time: 1.0331413745880127
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.719 Vali Acc: 0.821 Test Loss: 0.719 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0212726593017578
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9533572196960449
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.838 Test Loss: 0.767 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2054085731506348
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.838 Test Loss: 0.743 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0694127082824707
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.838 Test Loss: 0.705 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0596563816070557
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.844 Test Loss: 0.682 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9615976810455322
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.832 Test Loss: 0.668 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.178307056427002
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.832 Test Loss: 0.661 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0766892433166504
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.832 Test Loss: 0.654 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0011913776397705
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.650 Vali Acc: 0.827 Test Loss: 0.650 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1924435
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.202627182006836
Epoch: 1, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.024 Vali Acc: 0.532 Test Loss: 1.024 Test Acc: 0.532
Validation loss decreased (inf --> -0.531782).  Saving model ...
Epoch: 2 cost time: 0.8951570987701416
Epoch: 2, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.791 Vali Acc: 0.682 Test Loss: 0.791 Test Acc: 0.682
Validation loss decreased (-0.531782 --> -0.682073).  Saving model ...
Epoch: 3 cost time: 0.9947006702423096
Epoch: 3, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
Validation loss decreased (-0.682073 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 0.915769100189209
Epoch: 4, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.107 Vali Acc: 0.711 Test Loss: 1.107 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0651252269744873
Epoch: 5, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.937 Vali Acc: 0.751 Test Loss: 0.937 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.008943796157837
Epoch: 6, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.989 Vali Acc: 0.792 Test Loss: 0.989 Test Acc: 0.792
Validation loss decreased (-0.762999 --> -0.791898).  Saving model ...
Epoch: 7 cost time: 1.0659046173095703
Epoch: 7, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.773 Vali Acc: 0.815 Test Loss: 0.773 Test Acc: 0.815
Validation loss decreased (-0.791898 --> -0.815021).  Saving model ...
Epoch: 8 cost time: 1.0561494827270508
Epoch: 8, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.197 Vali Acc: 0.711 Test Loss: 1.197 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9695274829864502
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.050 Vali Acc: 0.838 Test Loss: 1.050 Test Acc: 0.838
Validation loss decreased (-0.815021 --> -0.838140).  Saving model ...
Epoch: 10 cost time: 0.9681284427642822
Epoch: 10, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.838140 --> -0.843924).  Saving model ...
Epoch: 11 cost time: 0.9787802696228027
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.870 Vali Acc: 0.815 Test Loss: 0.870 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0150806903839111
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.827 Test Loss: 0.704 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0118484497070312
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.626 Vali Acc: 0.838 Test Loss: 0.626 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0232234001159668
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.618 Vali Acc: 0.838 Test Loss: 0.618 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0747482776641846
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.838 Test Loss: 0.615 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9750001430511475
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.961040735244751
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.614 Vali Acc: 0.838 Test Loss: 0.614 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.942255973815918
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.962852954864502
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8822722434997559
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1924069
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.246415853500366
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.389 Vali Acc: 0.503 Test Loss: 1.389 Test Acc: 0.503
Validation loss decreased (inf --> -0.502876).  Saving model ...
Epoch: 2 cost time: 0.9566140174865723
Epoch: 2, Steps: 17 | Train Loss: 0.871 Vali Loss: 0.818 Vali Acc: 0.676 Test Loss: 0.818 Test Acc: 0.676
Validation loss decreased (-0.502876 --> -0.676292).  Saving model ...
Epoch: 3 cost time: 0.9424271583557129
Epoch: 3, Steps: 17 | Train Loss: 0.284 Vali Loss: 1.084 Vali Acc: 0.688 Test Loss: 1.084 Test Acc: 0.688
Validation loss decreased (-0.676292 --> -0.687850).  Saving model ...
Epoch: 4 cost time: 0.9825866222381592
Epoch: 4, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.843 Vali Acc: 0.786 Test Loss: 0.843 Test Acc: 0.786
Validation loss decreased (-0.687850 --> -0.786119).  Saving model ...
Epoch: 5 cost time: 0.8755028247833252
Epoch: 5, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.393 Vali Acc: 0.682 Test Loss: 1.393 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1284680366516113
Epoch: 6, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.927 Vali Acc: 0.803 Test Loss: 0.927 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803459).  Saving model ...
Epoch: 7 cost time: 1.0832371711730957
Epoch: 7, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.936 Vali Acc: 0.786 Test Loss: 0.936 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0074670314788818
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.705 Vali Acc: 0.838 Test Loss: 0.705 Test Acc: 0.838
Validation loss decreased (-0.803459 --> -0.838143).  Saving model ...
Epoch: 9 cost time: 1.0996589660644531
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.852 Vali Acc: 0.821 Test Loss: 0.852 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1715707778930664
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.686 Vali Acc: 0.832 Test Loss: 0.686 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1117503643035889
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.827 Test Loss: 0.640 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8465213775634766
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.838 Test Loss: 0.636 Test Acc: 0.838
Validation loss decreased (-0.838143 --> -0.838144).  Saving model ...
Epoch: 13 cost time: 1.160177230834961
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.838 Test Loss: 0.636 Test Acc: 0.838
Validation loss decreased (-0.838144 --> -0.838144).  Saving model ...
Epoch: 14 cost time: 1.0405738353729248
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.638 Vali Acc: 0.832 Test Loss: 0.638 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9918913841247559
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.832 Test Loss: 0.636 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8906078338623047
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9903531074523926
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9655423164367676
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9500086307525635
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0069353580474854
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2402606010437012
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.832 Test Loss: 0.637 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9819564819335938
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0672214031219482
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1924011
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.494638681411743
Epoch: 1, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.125 Vali Acc: 0.590 Test Loss: 1.125 Test Acc: 0.590
Validation loss decreased (inf --> -0.589584).  Saving model ...
Epoch: 2 cost time: 1.1751177310943604
Epoch: 2, Steps: 17 | Train Loss: 0.741 Vali Loss: 1.413 Vali Acc: 0.630 Test Loss: 1.413 Test Acc: 0.630
Validation loss decreased (-0.589584 --> -0.630044).  Saving model ...
Epoch: 3 cost time: 0.9739470481872559
Epoch: 3, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.865 Vali Acc: 0.740 Test Loss: 0.865 Test Acc: 0.740
Validation loss decreased (-0.630044 --> -0.739876).  Saving model ...
Epoch: 4 cost time: 0.9245147705078125
Epoch: 4, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.100 Vali Acc: 0.665 Test Loss: 1.100 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0576961040496826
Epoch: 5, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.958 Vali Acc: 0.734 Test Loss: 0.958 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0537309646606445
Epoch: 6, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.062 Vali Acc: 0.728 Test Loss: 1.062 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9873886108398438
Epoch: 7, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.800 Vali Acc: 0.798 Test Loss: 0.800 Test Acc: 0.798
Validation loss decreased (-0.739876 --> -0.797680).  Saving model ...
Epoch: 8 cost time: 0.8908133506774902
Epoch: 8, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
Validation loss decreased (-0.797680 --> -0.843924).  Saving model ...
Epoch: 9 cost time: 1.0084662437438965
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.838 Vali Acc: 0.763 Test Loss: 0.838 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9458138942718506
Epoch: 10, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.939 Vali Acc: 0.792 Test Loss: 0.939 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.10048508644104
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.805 Vali Acc: 0.809 Test Loss: 0.805 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1432459354400635
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.078 Vali Acc: 0.815 Test Loss: 1.078 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1688408851623535
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.910 Vali Acc: 0.786 Test Loss: 0.910 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1511764526367188
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.976 Vali Acc: 0.821 Test Loss: 0.976 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2581734657287598
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.832 Test Loss: 0.701 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0673537254333496
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.832 Test Loss: 0.679 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0498359203338623
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.838 Test Loss: 0.673 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1446101665496826
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1923733
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4035897254943848
Epoch: 1, Steps: 17 | Train Loss: 1.659 Vali Loss: 1.223 Vali Acc: 0.526 Test Loss: 1.223 Test Acc: 0.526
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 1.0941433906555176
Epoch: 2, Steps: 17 | Train Loss: 0.634 Vali Loss: 1.214 Vali Acc: 0.694 Test Loss: 1.214 Test Acc: 0.694
Validation loss decreased (-0.525999 --> -0.693629).  Saving model ...
Epoch: 3 cost time: 1.1160311698913574
Epoch: 3, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
Validation loss decreased (-0.693629 --> -0.803462).  Saving model ...
Epoch: 4 cost time: 1.1586308479309082
Epoch: 4, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.807 Vali Acc: 0.775 Test Loss: 0.807 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0529375076293945
Epoch: 5, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.672 Vali Acc: 0.832 Test Loss: 0.672 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832363).  Saving model ...
Epoch: 6 cost time: 1.0360641479492188
Epoch: 6, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.785 Vali Acc: 0.775 Test Loss: 0.785 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1273486614227295
Epoch: 7, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.748 Vali Acc: 0.815 Test Loss: 0.748 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1601147651672363
Epoch: 8, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.681 Vali Acc: 0.792 Test Loss: 0.681 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1240673065185547
Epoch: 9, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.791 Vali Acc: 0.815 Test Loss: 0.791 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2758111953735352
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.883 Vali Acc: 0.780 Test Loss: 0.883 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5172724723815918
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.780 Vali Acc: 0.792 Test Loss: 0.780 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1259794235229492
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.920 Vali Acc: 0.792 Test Loss: 0.920 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0344347953796387
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.921 Vali Acc: 0.775 Test Loss: 0.921 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2910234928131104
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.908 Vali Acc: 0.786 Test Loss: 0.908 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.282778024673462
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.897 Vali Acc: 0.792 Test Loss: 0.897 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1924099
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.327641248703003
Epoch: 1, Steps: 17 | Train Loss: 1.538 Vali Loss: 0.893 Vali Acc: 0.688 Test Loss: 0.893 Test Acc: 0.688
Validation loss decreased (inf --> -0.687852).  Saving model ...
Epoch: 2 cost time: 1.0711495876312256
Epoch: 2, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.609 Vali Acc: 0.526 Test Loss: 1.609 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8753452301025391
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.716 Vali Acc: 0.792 Test Loss: 0.716 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791900).  Saving model ...
Epoch: 4 cost time: 0.9574320316314697
Epoch: 4, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.907 Vali Acc: 0.763 Test Loss: 0.907 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9156379699707031
Epoch: 5, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.944 Vali Acc: 0.717 Test Loss: 0.944 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1487607955932617
Epoch: 6, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.640 Vali Acc: 0.815 Test Loss: 0.640 Test Acc: 0.815
Validation loss decreased (-0.791900 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 1.02474045753479
Epoch: 7, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.101 Vali Acc: 0.809 Test Loss: 1.101 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8421807289123535
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.138 Vali Acc: 0.775 Test Loss: 1.138 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.024787425994873
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.858 Vali Acc: 0.821 Test Loss: 0.858 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820801).  Saving model ...
Epoch: 10 cost time: 0.9148814678192139
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.832 Test Loss: 0.803 Test Acc: 0.832
Validation loss decreased (-0.820801 --> -0.832362).  Saving model ...
Epoch: 11 cost time: 0.9569177627563477
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.076 Vali Acc: 0.809 Test Loss: 1.076 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0773346424102783
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9696922302246094
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9871220588684082
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.844 Test Loss: 0.756 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843923).  Saving model ...
Epoch: 15 cost time: 0.9902825355529785
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.850 Test Loss: 0.696 Test Acc: 0.850
Validation loss decreased (-0.843923 --> -0.849704).  Saving model ...
Epoch: 16 cost time: 1.1846427917480469
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.850 Test Loss: 0.678 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849704).  Saving model ...
Epoch: 17 cost time: 1.0909507274627686
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.088395118713379
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1040966510772705
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.0573070049285889
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.838 Test Loss: 0.665 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9426615238189697
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.664 Vali Acc: 0.838 Test Loss: 0.664 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1396877765655518
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.838 Test Loss: 0.665 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0476438999176025
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.016256332397461
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.663 Vali Acc: 0.838 Test Loss: 0.663 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.135969638824463
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1371567249298096
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1923605
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.448986053466797
Epoch: 1, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.094 Vali Acc: 0.549 Test Loss: 1.094 Test Acc: 0.549
Validation loss decreased (inf --> -0.549122).  Saving model ...
Epoch: 2 cost time: 1.0608046054840088
Epoch: 2, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.811 Vali Acc: 0.682 Test Loss: 0.811 Test Acc: 0.682
Validation loss decreased (-0.549122 --> -0.682073).  Saving model ...
Epoch: 3 cost time: 0.9823238849639893
Epoch: 3, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.789 Vali Acc: 0.734 Test Loss: 0.789 Test Acc: 0.734
Validation loss decreased (-0.682073 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 1.0753841400146484
Epoch: 4, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.745 Vali Acc: 0.763 Test Loss: 0.745 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762998).  Saving model ...
Epoch: 5 cost time: 1.0793509483337402
Epoch: 5, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.753 Vali Acc: 0.809 Test Loss: 0.753 Test Acc: 0.809
Validation loss decreased (-0.762998 --> -0.809241).  Saving model ...
Epoch: 6 cost time: 0.999579668045044
Epoch: 6, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.556 Vali Acc: 0.879 Test Loss: 0.556 Test Acc: 0.879
Validation loss decreased (-0.809241 --> -0.878607).  Saving model ...
Epoch: 7 cost time: 1.0505247116088867
Epoch: 7, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.044 Vali Acc: 0.803 Test Loss: 1.044 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.097438097000122
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.701 Vali Acc: 0.832 Test Loss: 0.701 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9842324256896973
Epoch: 9, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.711 Vali Acc: 0.855 Test Loss: 0.711 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9919936656951904
Epoch: 10, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.707 Vali Acc: 0.832 Test Loss: 0.707 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1578044891357422
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.609 Vali Acc: 0.855 Test Loss: 0.609 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.052377462387085
Epoch: 12, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.079 Vali Acc: 0.827 Test Loss: 1.079 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0112175941467285
Epoch: 13, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.684 Vali Acc: 0.827 Test Loss: 0.684 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.038731336593628
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.844 Test Loss: 1.007 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0007431507110596
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.785 Vali Acc: 0.850 Test Loss: 0.785 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8560183048248291
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.827 Test Loss: 0.742 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 1923579
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.536985397338867
Epoch: 1, Steps: 17 | Train Loss: 1.677 Vali Loss: 1.165 Vali Acc: 0.462 Test Loss: 1.165 Test Acc: 0.462
Validation loss decreased (inf --> -0.462416).  Saving model ...
Epoch: 2 cost time: 1.3545567989349365
Epoch: 2, Steps: 17 | Train Loss: 0.705 Vali Loss: 0.891 Vali Acc: 0.705 Test Loss: 0.891 Test Acc: 0.705
Validation loss decreased (-0.462416 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 1.178598403930664
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.418 Vali Acc: 0.578 Test Loss: 1.418 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1884684562683105
Epoch: 4, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.715 Vali Acc: 0.780 Test Loss: 0.715 Test Acc: 0.780
Validation loss decreased (-0.705193 --> -0.780340).  Saving model ...
Epoch: 5 cost time: 1.3201799392700195
Epoch: 5, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.889 Vali Acc: 0.734 Test Loss: 0.889 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3134410381317139
Epoch: 6, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.354 Vali Acc: 0.734 Test Loss: 1.354 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1619341373443604
Epoch: 7, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.879 Vali Acc: 0.798 Test Loss: 0.879 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797679).  Saving model ...
Epoch: 8 cost time: 1.2252061367034912
Epoch: 8, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.877 Vali Acc: 0.832 Test Loss: 0.877 Test Acc: 0.832
Validation loss decreased (-0.797679 --> -0.832361).  Saving model ...
Epoch: 9 cost time: 1.239206075668335
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.459 Vali Acc: 0.769 Test Loss: 1.459 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.03509521484375
Epoch: 10, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.787 Vali Acc: 0.827 Test Loss: 0.787 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.162013053894043
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0571889877319336
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.819 Vali Acc: 0.786 Test Loss: 0.819 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.8888404369354248
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.783 Vali Acc: 0.786 Test Loss: 0.783 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.29616117477417
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.786 Test Loss: 0.767 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9581542015075684
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.755 Vali Acc: 0.798 Test Loss: 0.755 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8597006797790527
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.9908089637756348
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.803 Test Loss: 0.738 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.150547742843628
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1924453
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.4576258659362793
Epoch: 1, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.488 Vali Acc: 0.474 Test Loss: 1.488 Test Acc: 0.474
Validation loss decreased (inf --> -0.473974).  Saving model ...
Epoch: 2 cost time: 1.16432523727417
Epoch: 2, Steps: 17 | Train Loss: 0.819 Vali Loss: 0.994 Vali Acc: 0.665 Test Loss: 0.994 Test Acc: 0.665
Validation loss decreased (-0.473974 --> -0.664730).  Saving model ...
Epoch: 3 cost time: 1.074113130569458
Epoch: 3, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
Validation loss decreased (-0.664730 --> -0.803461).  Saving model ...
Epoch: 4 cost time: 1.0523407459259033
Epoch: 4, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.585 Vali Acc: 0.821 Test Loss: 0.585 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820803).  Saving model ...
Epoch: 5 cost time: 1.082078456878662
Epoch: 5, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.148 Vali Acc: 0.624 Test Loss: 1.148 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8813395500183105
Epoch: 6, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0003197193145752
Epoch: 7, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.689 Vali Acc: 0.769 Test Loss: 0.689 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1340603828430176
Epoch: 8, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.993 Vali Acc: 0.740 Test Loss: 0.993 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.064241647720337
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.624 Vali Acc: 0.803 Test Loss: 0.624 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.103560209274292
Epoch: 10, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.915 Vali Acc: 0.746 Test Loss: 0.915 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1926906108856201
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.570 Vali Acc: 0.815 Test Loss: 0.570 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1299476623535156
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.526 Vali Acc: 0.838 Test Loss: 0.526 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 1.2065763473510742
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.529 Vali Acc: 0.832 Test Loss: 0.529 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2162754535675049
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.537 Vali Acc: 0.832 Test Loss: 0.537 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1273388862609863
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.821 Test Loss: 0.546 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1411941051483154
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.821 Test Loss: 0.551 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1660871505737305
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2276122570037842
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.554 Vali Acc: 0.821 Test Loss: 0.554 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1814942359924316
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.555 Vali Acc: 0.827 Test Loss: 0.555 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.184072494506836
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.556 Vali Acc: 0.821 Test Loss: 0.556 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0959687232971191
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.821 Test Loss: 0.557 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.2149763107299805
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.557 Vali Acc: 0.827 Test Loss: 0.557 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1925043
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.0867435932159424
Epoch: 1, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.341 Vali Acc: 0.434 Test Loss: 1.341 Test Acc: 0.434
Validation loss decreased (inf --> -0.433513).  Saving model ...
Epoch: 2 cost time: 1.0576465129852295
Epoch: 2, Steps: 17 | Train Loss: 0.765 Vali Loss: 1.040 Vali Acc: 0.694 Test Loss: 1.040 Test Acc: 0.694
Validation loss decreased (-0.433513 --> -0.693631).  Saving model ...
Epoch: 3 cost time: 0.9674222469329834
Epoch: 3, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.872 Vali Acc: 0.763 Test Loss: 0.872 Test Acc: 0.763
Validation loss decreased (-0.693631 --> -0.762997).  Saving model ...
Epoch: 4 cost time: 0.943117618560791
Epoch: 4, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.451 Vali Acc: 0.630 Test Loss: 1.451 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9931826591491699
Epoch: 5, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.595 Vali Acc: 0.792 Test Loss: 0.595 Test Acc: 0.792
Validation loss decreased (-0.762997 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 1.008833408355713
Epoch: 6, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.143 Vali Acc: 0.780 Test Loss: 1.143 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0087873935699463
Epoch: 7, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.808 Vali Acc: 0.844 Test Loss: 0.808 Test Acc: 0.844
Validation loss decreased (-0.791902 --> -0.843923).  Saving model ...
Epoch: 8 cost time: 0.9303531646728516
Epoch: 8, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9999427795410156
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.821 Test Loss: 0.685 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9684865474700928
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.655 Vali Acc: 0.815 Test Loss: 0.655 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0011167526245117
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.827 Test Loss: 0.645 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0002026557922363
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.645 Vali Acc: 0.827 Test Loss: 0.645 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.9733030796051025
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.827 Test Loss: 0.648 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9257073402404785
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.648 Vali Acc: 0.827 Test Loss: 0.648 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.9939031600952148
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.646 Vali Acc: 0.827 Test Loss: 0.646 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9526898860931396
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.827 Test Loss: 0.649 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.8352832794189453
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.651 Vali Acc: 0.827 Test Loss: 0.651 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1923589
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3538928031921387
Epoch: 1, Steps: 17 | Train Loss: 1.675 Vali Loss: 1.279 Vali Acc: 0.393 Test Loss: 1.279 Test Acc: 0.393
Validation loss decreased (inf --> -0.393051).  Saving model ...
Epoch: 2 cost time: 1.1639447212219238
Epoch: 2, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.202 Vali Acc: 0.584 Test Loss: 1.202 Test Acc: 0.584
Validation loss decreased (-0.393051 --> -0.583803).  Saving model ...
Epoch: 3 cost time: 1.1119563579559326
Epoch: 3, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.924 Vali Acc: 0.751 Test Loss: 0.924 Test Acc: 0.751
Validation loss decreased (-0.583803 --> -0.751436).  Saving model ...
Epoch: 4 cost time: 1.1164898872375488
Epoch: 4, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.717 Vali Acc: 0.740 Test Loss: 0.717 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1432220935821533
Epoch: 5, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.888 Vali Acc: 0.775 Test Loss: 0.888 Test Acc: 0.775
Validation loss decreased (-0.751436 --> -0.774558).  Saving model ...
Epoch: 6 cost time: 1.0704014301300049
Epoch: 6, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.895 Vali Acc: 0.815 Test Loss: 0.895 Test Acc: 0.815
Validation loss decreased (-0.774558 --> -0.815020).  Saving model ...
Epoch: 7 cost time: 1.0560302734375
Epoch: 7, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.824 Vali Acc: 0.792 Test Loss: 0.824 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1900856494903564
Epoch: 8, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.746 Vali Acc: 0.821 Test Loss: 0.746 Test Acc: 0.821
Validation loss decreased (-0.815020 --> -0.820802).  Saving model ...
Epoch: 9 cost time: 1.1453189849853516
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.786 Test Loss: 0.696 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0238139629364014
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.780 Test Loss: 0.691 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.077693223953247
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.684 Vali Acc: 0.780 Test Loss: 0.684 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0282542705535889
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.792 Test Loss: 0.673 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9538936614990234
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.792 Test Loss: 0.666 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9029953479766846
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.661 Vali Acc: 0.792 Test Loss: 0.661 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1277694702148438
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.656 Vali Acc: 0.792 Test Loss: 0.656 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0985686779022217
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.792 Test Loss: 0.652 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0492072105407715
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0193774700164795
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1925109
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.365391731262207
Epoch: 1, Steps: 17 | Train Loss: 1.638 Vali Loss: 1.050 Vali Acc: 0.526 Test Loss: 1.050 Test Acc: 0.526
Validation loss decreased (inf --> -0.526001).  Saving model ...
Epoch: 2 cost time: 1.1093149185180664
Epoch: 2, Steps: 17 | Train Loss: 0.876 Vali Loss: 0.925 Vali Acc: 0.711 Test Loss: 0.925 Test Acc: 0.711
Validation loss decreased (-0.526001 --> -0.710973).  Saving model ...
Epoch: 3 cost time: 1.0482842922210693
Epoch: 3, Steps: 17 | Train Loss: 0.473 Vali Loss: 0.711 Vali Acc: 0.786 Test Loss: 0.711 Test Acc: 0.786
Validation loss decreased (-0.710973 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 1.2430105209350586
Epoch: 4, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.376 Vali Acc: 0.740 Test Loss: 1.376 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3235974311828613
Epoch: 5, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.284 Vali Acc: 0.699 Test Loss: 1.284 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0023984909057617
Epoch: 6, Steps: 17 | Train Loss: 0.110 Vali Loss: 1.876 Vali Acc: 0.711 Test Loss: 1.876 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1308643817901611
Epoch: 7, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.208 Vali Acc: 0.775 Test Loss: 1.208 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.051548957824707
Epoch: 8, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.069 Vali Acc: 0.798 Test Loss: 1.069 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797677).  Saving model ...
Epoch: 9 cost time: 0.9179234504699707
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.117 Vali Acc: 0.815 Test Loss: 1.117 Test Acc: 0.815
Validation loss decreased (-0.797677 --> -0.815018).  Saving model ...
Epoch: 10 cost time: 0.9723217487335205
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.263 Vali Acc: 0.780 Test Loss: 1.263 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.235948085784912
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.047 Vali Acc: 0.803 Test Loss: 1.047 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.92124342918396
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.007 Vali Acc: 0.798 Test Loss: 1.007 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0595674514770508
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.803 Test Loss: 1.010 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1020848751068115
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.070 Vali Acc: 0.786 Test Loss: 1.070 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0607187747955322
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.025 Vali Acc: 0.786 Test Loss: 1.025 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4437360763549805
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.311 Vali Acc: 0.751 Test Loss: 1.311 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.2215144634246826
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.043 Vali Acc: 0.757 Test Loss: 1.043 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1727280616760254
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.792 Test Loss: 0.959 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.3631446361541748
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.936 Vali Acc: 0.792 Test Loss: 0.936 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1924563
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.297287702560425
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.086 Vali Acc: 0.590 Test Loss: 1.086 Test Acc: 0.590
Validation loss decreased (inf --> -0.589585).  Saving model ...
Epoch: 2 cost time: 0.939568042755127
Epoch: 2, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.338 Vali Acc: 0.659 Test Loss: 1.338 Test Acc: 0.659
Validation loss decreased (-0.589585 --> -0.658946).  Saving model ...
Epoch: 3 cost time: 1.0192921161651611
Epoch: 3, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.854 Vali Acc: 0.751 Test Loss: 0.854 Test Acc: 0.751
Validation loss decreased (-0.658946 --> -0.751437).  Saving model ...
Epoch: 4 cost time: 0.9845755100250244
Epoch: 4, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.191 Vali Acc: 0.723 Test Loss: 1.191 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8914203643798828
Epoch: 5, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.750 Vali Acc: 0.792 Test Loss: 0.750 Test Acc: 0.792
Validation loss decreased (-0.751437 --> -0.791900).  Saving model ...
Epoch: 6 cost time: 0.9616751670837402
Epoch: 6, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.752 Vali Acc: 0.815 Test Loss: 0.752 Test Acc: 0.815
Validation loss decreased (-0.791900 --> -0.815021).  Saving model ...
Epoch: 7 cost time: 1.0487959384918213
Epoch: 7, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.317 Vali Acc: 0.723 Test Loss: 1.317 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0386552810668945
Epoch: 8, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.149 Vali Acc: 0.757 Test Loss: 1.149 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9562687873840332
Epoch: 9, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.670 Vali Acc: 0.838 Test Loss: 0.670 Test Acc: 0.838
Validation loss decreased (-0.815021 --> -0.838144).  Saving model ...
Epoch: 10 cost time: 1.0543701648712158
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.085 Vali Acc: 0.757 Test Loss: 1.085 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0133607387542725
Epoch: 11, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.904 Vali Acc: 0.775 Test Loss: 0.904 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.0386629104614258
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.751 Test Loss: 0.949 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0093350410461426
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.012 Vali Acc: 0.751 Test Loss: 1.012 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0551352500915527
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.944 Vali Acc: 0.775 Test Loss: 0.944 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.958613395690918
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.902 Vali Acc: 0.780 Test Loss: 0.902 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9576928615570068
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.881 Vali Acc: 0.780 Test Loss: 0.881 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9239678382873535
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.866 Vali Acc: 0.780 Test Loss: 0.866 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0037741661071777
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.857 Vali Acc: 0.780 Test Loss: 0.857 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0857555866241455
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.850 Vali Acc: 0.775 Test Loss: 0.850 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1923733
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2251343727111816
Epoch: 1, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.085 Vali Acc: 0.590 Test Loss: 1.085 Test Acc: 0.590
Validation loss decreased (inf --> -0.589585).  Saving model ...
Epoch: 2 cost time: 0.9727046489715576
Epoch: 2, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.834 Vali Acc: 0.723 Test Loss: 0.834 Test Acc: 0.723
Validation loss decreased (-0.589585 --> -0.722535).  Saving model ...
Epoch: 3 cost time: 1.0344126224517822
Epoch: 3, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.902 Vali Acc: 0.705 Test Loss: 0.902 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.019057035446167
Epoch: 4, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.109 Vali Acc: 0.775 Test Loss: 1.109 Test Acc: 0.775
Validation loss decreased (-0.722535 --> -0.774555).  Saving model ...
Epoch: 5 cost time: 0.9273810386657715
Epoch: 5, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.855 Vali Acc: 0.763 Test Loss: 0.855 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0661885738372803
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.847 Vali Acc: 0.792 Test Loss: 0.847 Test Acc: 0.792
Validation loss decreased (-0.774555 --> -0.791899).  Saving model ...
Epoch: 7 cost time: 1.106212854385376
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.478 Vali Acc: 0.769 Test Loss: 1.478 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9948029518127441
Epoch: 8, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.955 Vali Acc: 0.792 Test Loss: 0.955 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.032879114151001
Epoch: 9, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.902 Vali Acc: 0.792 Test Loss: 0.902 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1237239837646484
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
Validation loss decreased (-0.791899 --> -0.809241).  Saving model ...
Epoch: 11 cost time: 1.0608088970184326
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.803 Test Loss: 0.762 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9651603698730469
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.815 Test Loss: 0.756 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815021).  Saving model ...
Epoch: 13 cost time: 1.006136417388916
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0725266933441162
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9608559608459473
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0298564434051514
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.071598768234253
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.9421789646148682
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.010157823562622
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.9190323352813721
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.821 Test Loss: 0.736 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820802).  Saving model ...
Epoch: 21 cost time: 0.9586360454559326
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.832 Test Loss: 0.736 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832363).  Saving model ...
Epoch: 22 cost time: 0.9275283813476562
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.832 Test Loss: 0.732 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 23 cost time: 1.0723087787628174
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.832 Test Loss: 0.731 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 24 cost time: 1.012789249420166
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.832 Test Loss: 0.732 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9010848999023438
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.729 Vali Acc: 0.832 Test Loss: 0.729 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 26 cost time: 1.015625238418579
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.730 Vali Acc: 0.832 Test Loss: 0.730 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0763766765594482
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.832 Test Loss: 0.726 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 28 cost time: 1.0128364562988281
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.832 Test Loss: 0.725 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 29 cost time: 1.0736627578735352
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.726 Vali Acc: 0.832 Test Loss: 0.726 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1062569618225098
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.832 Test Loss: 0.725 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 31 cost time: 0.939293622970581
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.725 Vali Acc: 0.832 Test Loss: 0.725 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 32 cost time: 0.992271900177002
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.832 Test Loss: 0.724 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 33 cost time: 1.0111734867095947
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.832 Test Loss: 0.723 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 34 cost time: 1.0571908950805664
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.832 Test Loss: 0.723 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9975976943969727
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.832 Test Loss: 0.724 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.070518970489502
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 37 cost time: 1.1031146049499512
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.832 Test Loss: 0.723 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0793144702911377
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 39 cost time: 1.0122699737548828
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 40 cost time: 0.9936954975128174
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 41 cost time: 1.049328327178955
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.058058500289917
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 43 cost time: 0.983238935470581
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
Validation loss decreased (-0.832363 --> -0.832363).  Saving model ...
Epoch: 44 cost time: 1.0378930568695068
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0265705585479736
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9630260467529297
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9538767337799072
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9902176856994629
Epoch: 48, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.723 Vali Acc: 0.832 Test Loss: 0.723 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0248212814331055
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.9411871433258057
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.721 Vali Acc: 0.832 Test Loss: 0.721 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.0390946865081787
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.0591645240783691
Epoch: 52, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.986039400100708
Epoch: 53, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1923845
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.381671190261841
Epoch: 1, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.423 Vali Acc: 0.405 Test Loss: 1.423 Test Acc: 0.405
Validation loss decreased (inf --> -0.404610).  Saving model ...
Epoch: 2 cost time: 1.1409492492675781
Epoch: 2, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
Validation loss decreased (-0.404610 --> -0.803462).  Saving model ...
Epoch: 3 cost time: 1.1476564407348633
Epoch: 3, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.839 Vali Acc: 0.769 Test Loss: 0.839 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1210646629333496
Epoch: 4, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.105 Vali Acc: 0.717 Test Loss: 1.105 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1649212837219238
Epoch: 5, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.757 Vali Acc: 0.798 Test Loss: 0.757 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0275845527648926
Epoch: 6, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.676 Vali Acc: 0.821 Test Loss: 0.676 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820802).  Saving model ...
Epoch: 7 cost time: 1.0753164291381836
Epoch: 7, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.291172981262207
Epoch: 8, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.059 Vali Acc: 0.827 Test Loss: 1.059 Test Acc: 0.827
Validation loss decreased (-0.820802 --> -0.826579).  Saving model ...
Epoch: 9 cost time: 1.1592371463775635
Epoch: 9, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.843 Vali Acc: 0.815 Test Loss: 0.843 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1866180896759033
Epoch: 10, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.815 Test Loss: 0.873 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0895073413848877
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.909 Vali Acc: 0.803 Test Loss: 0.909 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.208909273147583
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.827 Test Loss: 0.711 Test Acc: 0.827
Validation loss decreased (-0.826579 --> -0.826582).  Saving model ...
Epoch: 13 cost time: 1.1542096138000488
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.815 Test Loss: 0.775 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1234498023986816
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.809 Test Loss: 0.760 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1108858585357666
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.109825849533081
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0390331745147705
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.175419569015503
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1205689907073975
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0060949325561523
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.745 Vali Acc: 0.809 Test Loss: 0.745 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1864604949951172
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1148099899291992
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.809 Test Loss: 0.744 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1924491
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs72_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.370907783508301
Epoch: 1, Steps: 17 | Train Loss: 1.715 Vali Loss: 1.235 Vali Acc: 0.434 Test Loss: 1.235 Test Acc: 0.434
Validation loss decreased (inf --> -0.433514).  Saving model ...
Epoch: 2 cost time: 1.0018270015716553
Epoch: 2, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.950 Vali Acc: 0.630 Test Loss: 0.950 Test Acc: 0.630
Validation loss decreased (-0.433514 --> -0.630048).  Saving model ...
Epoch: 3 cost time: 0.8944497108459473
Epoch: 3, Steps: 17 | Train Loss: 0.457 Vali Loss: 1.114 Vali Acc: 0.757 Test Loss: 1.114 Test Acc: 0.757
Validation loss decreased (-0.630048 --> -0.757214).  Saving model ...
Epoch: 4 cost time: 0.9705181121826172
Epoch: 4, Steps: 17 | Train Loss: 0.397 Vali Loss: 1.687 Vali Acc: 0.676 Test Loss: 1.687 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0647125244140625
Epoch: 5, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.816 Vali Acc: 0.775 Test Loss: 0.816 Test Acc: 0.775
Validation loss decreased (-0.757214 --> -0.774558).  Saving model ...
Epoch: 6 cost time: 0.9874715805053711
Epoch: 6, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.124 Vali Acc: 0.792 Test Loss: 1.124 Test Acc: 0.792
Validation loss decreased (-0.774558 --> -0.791896).  Saving model ...
Epoch: 7 cost time: 1.004453182220459
Epoch: 7, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.078 Vali Acc: 0.844 Test Loss: 1.078 Test Acc: 0.844
Validation loss decreased (-0.791896 --> -0.843920).  Saving model ...
Epoch: 8 cost time: 0.9990785121917725
Epoch: 8, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.742 Vali Acc: 0.832 Test Loss: 0.742 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.093492031097412
Epoch: 9, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.838 Test Loss: 0.703 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0470073223114014
Epoch: 10, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.844 Test Loss: 0.704 Test Acc: 0.844
Validation loss decreased (-0.843920 --> -0.843924).  Saving model ...
Epoch: 11 cost time: 1.0813899040222168
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.838 Test Loss: 0.700 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9845726490020752
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.838 Test Loss: 0.696 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8509097099304199
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.691 Vali Acc: 0.838 Test Loss: 0.691 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9579818248748779
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.838 Test Loss: 0.690 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8273639678955078
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.838 Test Loss: 0.688 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7987089157104492
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.838 Test Loss: 0.685 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.8652126789093018
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.838 Test Loss: 0.683 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.817509651184082
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.838 Test Loss: 0.680 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8933029174804688
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.678 Vali Acc: 0.832 Test Loss: 0.678 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8621735572814941
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.676 Vali Acc: 0.832 Test Loss: 0.676 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs72_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1922253
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs48_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.305354595184326
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.414 Vali Acc: 0.405 Test Loss: 1.414 Test Acc: 0.405
Validation loss decreased (inf --> -0.404610).  Saving model ...
Epoch: 2 cost time: 0.9262897968292236
Epoch: 2, Steps: 17 | Train Loss: 1.088 Vali Loss: 0.775 Vali Acc: 0.705 Test Loss: 0.775 Test Acc: 0.705
Validation loss decreased (-0.404610 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 0.9541869163513184
Epoch: 3, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.899 Vali Acc: 0.723 Test Loss: 0.899 Test Acc: 0.723
Validation loss decreased (-0.705195 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 0.977564811706543
Epoch: 4, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.970 Vali Acc: 0.746 Test Loss: 0.970 Test Acc: 0.746
Validation loss decreased (-0.722534 --> -0.745655).  Saving model ...
Epoch: 5 cost time: 1.0452191829681396
Epoch: 5, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.530 Vali Acc: 0.653 Test Loss: 1.530 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9121749401092529
Epoch: 6, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.477 Vali Acc: 0.717 Test Loss: 1.477 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0684995651245117
Epoch: 7, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.846 Vali Acc: 0.746 Test Loss: 0.846 Test Acc: 0.746
Validation loss decreased (-0.745655 --> -0.745656).  Saving model ...
Epoch: 8 cost time: 1.0668346881866455
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.877 Vali Acc: 0.803 Test Loss: 0.877 Test Acc: 0.803
Validation loss decreased (-0.745656 --> -0.803459).  Saving model ...
Epoch: 9 cost time: 0.9783916473388672
Epoch: 9, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.226 Vali Acc: 0.769 Test Loss: 1.226 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0588459968566895
Epoch: 10, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.026 Vali Acc: 0.786 Test Loss: 1.026 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0455729961395264
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.769 Test Loss: 1.000 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0538442134857178
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
Validation loss decreased (-0.803459 --> -0.809241).  Saving model ...
Epoch: 13 cost time: 0.9140863418579102
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.944934606552124
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8267524242401123
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0447604656219482
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7998223304748535
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.707 Vali Acc: 0.803 Test Loss: 0.707 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8054599761962891
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.803 Test Loss: 0.703 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0204870700836182
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8395202159881592
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.696 Vali Acc: 0.815 Test Loss: 0.696 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815022).  Saving model ...
Epoch: 21 cost time: 0.9281904697418213
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.692 Vali Acc: 0.815 Test Loss: 0.692 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 22 cost time: 1.0298140048980713
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9908707141876221
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0337257385253906
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.685 Vali Acc: 0.798 Test Loss: 0.685 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0212037563323975
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9778690338134766
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.011972188949585
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.679 Vali Acc: 0.798 Test Loss: 0.679 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0321481227874756
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.798 Test Loss: 0.677 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0247266292572021
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.798 Test Loss: 0.675 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9622366428375244
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.798 Test Loss: 0.673 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9552385807037354
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.798 Test Loss: 0.673 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs48_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1921883
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs36_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.228950262069702
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.166 Vali Acc: 0.538 Test Loss: 1.166 Test Acc: 0.538
Validation loss decreased (inf --> -0.537561).  Saving model ...
Epoch: 2 cost time: 0.9498786926269531
Epoch: 2, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.983 Vali Acc: 0.659 Test Loss: 0.983 Test Acc: 0.659
Validation loss decreased (-0.537561 --> -0.658950).  Saving model ...
Epoch: 3 cost time: 0.9923422336578369
Epoch: 3, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
Validation loss decreased (-0.658950 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 1.0205488204956055
Epoch: 4, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.600 Vali Acc: 0.838 Test Loss: 0.600 Test Acc: 0.838
Validation loss decreased (-0.762999 --> -0.838144).  Saving model ...
Epoch: 5 cost time: 0.8584280014038086
Epoch: 5, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.213 Vali Acc: 0.815 Test Loss: 1.213 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9891245365142822
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.802 Vali Acc: 0.786 Test Loss: 0.802 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9991827011108398
Epoch: 7, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.749 Vali Acc: 0.798 Test Loss: 0.749 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8960788249969482
Epoch: 8, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.804 Vali Acc: 0.838 Test Loss: 0.804 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8299543857574463
Epoch: 9, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.049 Vali Acc: 0.827 Test Loss: 1.049 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0686631202697754
Epoch: 10, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.819 Vali Acc: 0.827 Test Loss: 0.819 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.7657294273376465
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.806 Vali Acc: 0.780 Test Loss: 0.806 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.7799627780914307
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.8666143417358398
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.920783519744873
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.752 Vali Acc: 0.809 Test Loss: 0.752 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs36_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1921709
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs29_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.9979958534240723
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 2.467 Vali Acc: 0.289 Test Loss: 2.467 Test Acc: 0.289
Validation loss decreased (inf --> -0.288993).  Saving model ...
Epoch: 2 cost time: 0.9553189277648926
Epoch: 2, Steps: 17 | Train Loss: 0.975 Vali Loss: 0.997 Vali Acc: 0.607 Test Loss: 0.997 Test Acc: 0.607
Validation loss decreased (-0.288993 --> -0.606926).  Saving model ...
Epoch: 3 cost time: 0.992478609085083
Epoch: 3, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.950 Vali Acc: 0.723 Test Loss: 0.950 Test Acc: 0.723
Validation loss decreased (-0.606926 --> -0.722534).  Saving model ...
Epoch: 4 cost time: 0.8729696273803711
Epoch: 4, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.965 Vali Acc: 0.728 Test Loss: 0.965 Test Acc: 0.728
Validation loss decreased (-0.722534 --> -0.728314).  Saving model ...
Epoch: 5 cost time: 0.9441308975219727
Epoch: 5, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.927 Vali Acc: 0.757 Test Loss: 0.927 Test Acc: 0.757
Validation loss decreased (-0.728314 --> -0.757216).  Saving model ...
Epoch: 6 cost time: 0.9776179790496826
Epoch: 6, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.623 Vali Acc: 0.815 Test Loss: 0.623 Test Acc: 0.815
Validation loss decreased (-0.757216 --> -0.815023).  Saving model ...
Epoch: 7 cost time: 0.9823257923126221
Epoch: 7, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.673 Vali Acc: 0.838 Test Loss: 0.673 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838144).  Saving model ...
Epoch: 8 cost time: 0.8858461380004883
Epoch: 8, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.134 Vali Acc: 0.746 Test Loss: 1.134 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8154704570770264
Epoch: 9, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.797 Vali Acc: 0.798 Test Loss: 0.797 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8626306056976318
Epoch: 10, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.819 Vali Acc: 0.786 Test Loss: 0.819 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7555766105651855
Epoch: 11, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.956 Vali Acc: 0.844 Test Loss: 0.956 Test Acc: 0.844
Validation loss decreased (-0.838144 --> -0.843921).  Saving model ...
Epoch: 12 cost time: 0.8473513126373291
Epoch: 12, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.155 Vali Acc: 0.763 Test Loss: 1.155 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8460581302642822
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.893 Vali Acc: 0.769 Test Loss: 0.893 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.914193868637085
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.825 Vali Acc: 0.786 Test Loss: 0.825 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8523993492126465
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.720 Vali Acc: 0.850 Test Loss: 0.720 Test Acc: 0.850
Validation loss decreased (-0.843921 --> -0.849704).  Saving model ...
Epoch: 16 cost time: 0.8233907222747803
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.850 Test Loss: 0.596 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849705).  Saving model ...
Epoch: 17 cost time: 0.9801647663116455
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.855 Test Loss: 0.583 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855485).  Saving model ...
Epoch: 18 cost time: 0.9265518188476562
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.581 Vali Acc: 0.855 Test Loss: 0.581 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855486).  Saving model ...
Epoch: 19 cost time: 0.9730377197265625
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
Validation loss decreased (-0.855486 --> -0.855486).  Saving model ...
Epoch: 20 cost time: 1.0751807689666748
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
Validation loss decreased (-0.855486 --> -0.855486).  Saving model ...
Epoch: 21 cost time: 1.1089117527008057
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.576 Vali Acc: 0.844 Test Loss: 0.576 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.015631914138794
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0152969360351562
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.575 Vali Acc: 0.844 Test Loss: 0.575 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2443809509277344
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.574 Vali Acc: 0.844 Test Loss: 0.574 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0977582931518555
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.065701961517334
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.573 Vali Acc: 0.844 Test Loss: 0.573 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1053481101989746
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9870989322662354
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.572 Vali Acc: 0.844 Test Loss: 0.572 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0763914585113525
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.173633098602295
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs29_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1921763
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs24_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.1290102005004883
Epoch: 1, Steps: 17 | Train Loss: 1.640 Vali Loss: 0.967 Vali Acc: 0.590 Test Loss: 0.967 Test Acc: 0.590
Validation loss decreased (inf --> -0.589586).  Saving model ...
Epoch: 2 cost time: 0.8568592071533203
Epoch: 2, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.928 Vali Acc: 0.671 Test Loss: 0.928 Test Acc: 0.671
Validation loss decreased (-0.589586 --> -0.670511).  Saving model ...
Epoch: 3 cost time: 0.991769552230835
Epoch: 3, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
Validation loss decreased (-0.670511 --> -0.797681).  Saving model ...
Epoch: 4 cost time: 0.9459457397460938
Epoch: 4, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809243).  Saving model ...
Epoch: 5 cost time: 0.90399169921875
Epoch: 5, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.773 Vali Acc: 0.821 Test Loss: 0.773 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820802).  Saving model ...
Epoch: 6 cost time: 0.9958579540252686
Epoch: 6, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
Validation loss decreased (-0.820802 --> -0.849704).  Saving model ...
Epoch: 7 cost time: 1.0125322341918945
Epoch: 7, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.703 Vali Acc: 0.798 Test Loss: 0.703 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.948544979095459
Epoch: 8, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.135 Vali Acc: 0.798 Test Loss: 1.135 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7943704128265381
Epoch: 9, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.790 Vali Acc: 0.786 Test Loss: 0.790 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8688580989837646
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.649 Vali Acc: 0.821 Test Loss: 0.649 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.014568567276001
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.583 Vali Acc: 0.821 Test Loss: 0.583 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8076655864715576
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.821 Test Loss: 0.596 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8273308277130127
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9490222930908203
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.7520749568939209
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.8259761333465576
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs24_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1921565
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3394229412078857
Epoch: 1, Steps: 17 | Train Loss: 1.704 Vali Loss: 1.210 Vali Acc: 0.526 Test Loss: 1.210 Test Acc: 0.526
Validation loss decreased (inf --> -0.525999).  Saving model ...
Epoch: 2 cost time: 1.039733648300171
Epoch: 2, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.838 Vali Acc: 0.717 Test Loss: 0.838 Test Acc: 0.717
Validation loss decreased (-0.525999 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 0.9575538635253906
Epoch: 3, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.560 Vali Acc: 0.775 Test Loss: 0.560 Test Acc: 0.775
Validation loss decreased (-0.716755 --> -0.774561).  Saving model ...
Epoch: 4 cost time: 1.0547468662261963
Epoch: 4, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.968 Vali Acc: 0.728 Test Loss: 0.968 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9324908256530762
Epoch: 5, Steps: 17 | Train Loss: 0.087 Vali Loss: 1.087 Vali Acc: 0.665 Test Loss: 1.087 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8856654167175293
Epoch: 6, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.390 Vali Acc: 0.624 Test Loss: 2.390 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8691575527191162
Epoch: 7, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.827 Vali Acc: 0.763 Test Loss: 0.827 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.018251657485962
Epoch: 8, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.356 Vali Acc: 0.717 Test Loss: 1.356 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8581945896148682
Epoch: 9, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.809 Test Loss: 1.015 Test Acc: 0.809
Validation loss decreased (-0.774561 --> -0.809238).  Saving model ...
Epoch: 10 cost time: 0.8840916156768799
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.757 Test Loss: 1.056 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1616296768188477
Epoch: 11, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8458771705627441
Epoch: 12, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.906 Vali Acc: 0.763 Test Loss: 0.906 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0009212493896484
Epoch: 13, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.043 Vali Acc: 0.809 Test Loss: 1.043 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0510125160217285
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.016 Vali Acc: 0.792 Test Loss: 1.016 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0670840740203857
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.792 Test Loss: 0.719 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.032515287399292
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.798 Test Loss: 0.686 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9718008041381836
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.815 Test Loss: 0.682 Test Acc: 0.815
Validation loss decreased (-0.809238 --> -0.815022).  Saving model ...
Epoch: 18 cost time: 1.0308189392089844
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.815 Test Loss: 0.680 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 19 cost time: 1.0553357601165771
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.677 Vali Acc: 0.815 Test Loss: 0.677 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 20 cost time: 1.0790903568267822
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.675 Vali Acc: 0.815 Test Loss: 0.675 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 21 cost time: 1.0945184230804443
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.674 Vali Acc: 0.815 Test Loss: 0.674 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 22 cost time: 1.048781156539917
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.673 Vali Acc: 0.815 Test Loss: 0.673 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 23 cost time: 0.9749929904937744
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.672 Vali Acc: 0.815 Test Loss: 0.672 Test Acc: 0.815
Validation loss decreased (-0.815022 --> -0.815022).  Saving model ...
Epoch: 24 cost time: 0.8750758171081543
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.019045352935791
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9508407115936279
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8018875122070312
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9967782497406006
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8583838939666748
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7580337524414062
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0707507133483887
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9874119758605957
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9456846714019775
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.665 Vali Acc: 0.803 Test Loss: 0.665 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1921979
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs18_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.010544538497925
Epoch: 1, Steps: 17 | Train Loss: 1.731 Vali Loss: 1.986 Vali Acc: 0.376 Test Loss: 1.986 Test Acc: 0.376
Validation loss decreased (inf --> -0.375703).  Saving model ...
Epoch: 2 cost time: 0.8399407863616943
Epoch: 2, Steps: 17 | Train Loss: 0.995 Vali Loss: 0.888 Vali Acc: 0.636 Test Loss: 0.888 Test Acc: 0.636
Validation loss decreased (-0.375703 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 0.9205405712127686
Epoch: 3, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
Validation loss decreased (-0.635829 --> -0.809242).  Saving model ...
Epoch: 4 cost time: 0.8260574340820312
Epoch: 4, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.268 Vali Acc: 0.676 Test Loss: 1.268 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8052985668182373
Epoch: 5, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.812 Vali Acc: 0.769 Test Loss: 0.812 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9077353477478027
Epoch: 6, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.245 Vali Acc: 0.734 Test Loss: 1.245 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.8925163745880127
Epoch: 7, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.622 Vali Acc: 0.746 Test Loss: 1.622 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.8328361511230469
Epoch: 8, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.724 Vali Acc: 0.809 Test Loss: 0.724 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.8227810859680176
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.635 Vali Acc: 0.855 Test Loss: 0.635 Test Acc: 0.855
Validation loss decreased (-0.809242 --> -0.855485).  Saving model ...
Epoch: 10 cost time: 0.9713337421417236
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.675 Vali Acc: 0.827 Test Loss: 0.675 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9148211479187012
Epoch: 11, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.710 Vali Acc: 0.850 Test Loss: 0.710 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9216456413269043
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.640 Vali Acc: 0.850 Test Loss: 0.640 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9825296401977539
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855486).  Saving model ...
Epoch: 14 cost time: 0.9071118831634521
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.861 Test Loss: 0.553 Test Acc: 0.861
Validation loss decreased (-0.855486 --> -0.861266).  Saving model ...
Epoch: 15 cost time: 0.8926088809967041
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 16 cost time: 0.93194580078125
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.549 Vali Acc: 0.861 Test Loss: 0.549 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8736379146575928
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 18 cost time: 0.8881344795227051
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.547 Vali Acc: 0.861 Test Loss: 0.547 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9362671375274658
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 20 cost time: 0.9303247928619385
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.861 Test Loss: 0.546 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 21 cost time: 0.8892278671264648
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 22 cost time: 0.8955066204071045
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.861 Test Loss: 0.545 Test Acc: 0.861
Validation loss decreased (-0.861266 --> -0.861266).  Saving model ...
Epoch: 23 cost time: 0.7788417339324951
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7747433185577393
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7529745101928711
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7458932399749756
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7589740753173828
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8325676918029785
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8432698249816895
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.855 Test Loss: 0.545 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9360640048980713
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9634876251220703
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.850 Test Loss: 0.545 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9556987285614014
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.544 Vali Acc: 0.850 Test Loss: 0.544 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs18_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1921533
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.8439319133758545
Epoch: 1, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.078 Vali Acc: 0.566 Test Loss: 1.078 Test Acc: 0.566
Validation loss decreased (inf --> -0.566463).  Saving model ...
Epoch: 2 cost time: 0.886847972869873
Epoch: 2, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.566463 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 0.8917782306671143
Epoch: 3, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.941 Vali Acc: 0.694 Test Loss: 0.941 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7406790256500244
Epoch: 4, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.948 Vali Acc: 0.775 Test Loss: 0.948 Test Acc: 0.775
Validation loss decreased (-0.716755 --> -0.774557).  Saving model ...
Epoch: 5 cost time: 0.8070454597473145
Epoch: 5, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.371 Vali Acc: 0.746 Test Loss: 1.371 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9266805648803711
Epoch: 6, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
Validation loss decreased (-0.774557 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 0.9092180728912354
Epoch: 7, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.812 Vali Acc: 0.792 Test Loss: 0.812 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7661724090576172
Epoch: 8, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.674 Vali Acc: 0.832 Test Loss: 0.674 Test Acc: 0.832
Validation loss decreased (-0.809242 --> -0.832363).  Saving model ...
Epoch: 9 cost time: 0.8021745681762695
Epoch: 9, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.821 Vali Acc: 0.740 Test Loss: 0.821 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8564701080322266
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.556 Vali Acc: 0.763 Test Loss: 1.556 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7906143665313721
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.865 Vali Acc: 0.775 Test Loss: 0.865 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8663187026977539
Epoch: 12, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.655 Vali Acc: 0.809 Test Loss: 0.655 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9624989032745361
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9511935710906982
Epoch: 14, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.660 Vali Acc: 0.809 Test Loss: 0.660 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0299603939056396
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.8825328350067139
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.8371469974517822
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.815 Test Loss: 0.666 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0369324684143066
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.647 Vali Acc: 0.821 Test Loss: 0.647 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1921539
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs15_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.6985177993774414
Epoch: 1, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.276 Vali Acc: 0.410 Test Loss: 1.276 Test Acc: 0.410
Validation loss decreased (inf --> -0.410392).  Saving model ...
Epoch: 2 cost time: 0.9212470054626465
Epoch: 2, Steps: 17 | Train Loss: 1.010 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
Validation loss decreased (-0.410392 --> -0.803462).  Saving model ...
Epoch: 3 cost time: 0.8409156799316406
Epoch: 3, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.176 Vali Acc: 0.723 Test Loss: 1.176 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9216179847717285
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 1.731 Vali Acc: 0.665 Test Loss: 1.731 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0207135677337646
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.676 Vali Acc: 0.803 Test Loss: 0.676 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.126206874847412
Epoch: 6, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.950 Vali Acc: 0.740 Test Loss: 0.950 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0562877655029297
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.549 Vali Acc: 0.873 Test Loss: 0.549 Test Acc: 0.873
Validation loss decreased (-0.803462 --> -0.872827).  Saving model ...
Epoch: 8 cost time: 1.1390700340270996
Epoch: 8, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.909 Vali Acc: 0.798 Test Loss: 0.909 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9805986881256104
Epoch: 9, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.762 Vali Acc: 0.850 Test Loss: 0.762 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.9802219867706299
Epoch: 10, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.759 Vali Acc: 0.855 Test Loss: 0.759 Test Acc: 0.855
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1439824104309082
Epoch: 11, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.734 Vali Acc: 0.780 Test Loss: 0.734 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.131497859954834
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.814 Vali Acc: 0.786 Test Loss: 0.814 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0538058280944824
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.809 Test Loss: 0.748 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.127845048904419
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.737 Vali Acc: 0.809 Test Loss: 0.737 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.180574655532837
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.821 Test Loss: 0.750 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0016145706176758
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.827 Test Loss: 0.736 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0862760543823242
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs15_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 1922429
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2154300212860107
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 2.126 Vali Acc: 0.301 Test Loss: 2.126 Test Acc: 0.301
Validation loss decreased (inf --> -0.300557).  Saving model ...
Epoch: 2 cost time: 0.8672394752502441
Epoch: 2, Steps: 17 | Train Loss: 0.942 Vali Loss: 0.868 Vali Acc: 0.694 Test Loss: 0.868 Test Acc: 0.694
Validation loss decreased (-0.300557 --> -0.693633).  Saving model ...
Epoch: 3 cost time: 1.1721341609954834
Epoch: 3, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.711 Vali Acc: 0.746 Test Loss: 0.711 Test Acc: 0.746
Validation loss decreased (-0.693633 --> -0.745658).  Saving model ...
Epoch: 4 cost time: 0.9824268817901611
Epoch: 4, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.131 Vali Acc: 0.694 Test Loss: 1.131 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8451817035675049
Epoch: 5, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.681 Vali Acc: 0.815 Test Loss: 0.681 Test Acc: 0.815
Validation loss decreased (-0.745658 --> -0.815022).  Saving model ...
Epoch: 6 cost time: 1.0932962894439697
Epoch: 6, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.703 Vali Acc: 0.786 Test Loss: 0.703 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9626739025115967
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.954 Vali Acc: 0.780 Test Loss: 0.954 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8249437808990479
Epoch: 8, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.941 Vali Acc: 0.740 Test Loss: 0.941 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0670881271362305
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.800 Vali Acc: 0.815 Test Loss: 0.800 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9693944454193115
Epoch: 10, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.792 Vali Acc: 0.821 Test Loss: 0.792 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820801).  Saving model ...
Epoch: 11 cost time: 0.8674657344818115
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.737 Vali Acc: 0.815 Test Loss: 0.737 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1178743839263916
Epoch: 12, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.819 Vali Acc: 0.786 Test Loss: 0.819 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0365269184112549
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.783 Vali Acc: 0.844 Test Loss: 0.783 Test Acc: 0.844
Validation loss decreased (-0.820801 --> -0.843923).  Saving model ...
Epoch: 14 cost time: 1.0448102951049805
Epoch: 14, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.630 Vali Acc: 0.832 Test Loss: 0.630 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0506081581115723
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.598 Vali Acc: 0.827 Test Loss: 0.598 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0965518951416016
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.827 Test Loss: 0.592 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0156841278076172
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.832 Test Loss: 0.590 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0448663234710693
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.832 Test Loss: 0.590 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0931310653686523
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.591 Vali Acc: 0.832 Test Loss: 0.591 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.063734531402588
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843925).  Saving model ...
Epoch: 21 cost time: 1.191704273223877
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0121407508850098
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.595 Vali Acc: 0.844 Test Loss: 0.595 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.95391845703125
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9590916633605957
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849705).  Saving model ...
Epoch: 25 cost time: 1.0248839855194092
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9802072048187256
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9897713661193848
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.949580192565918
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.603 Vali Acc: 0.844 Test Loss: 0.603 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9502851963043213
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.844 Test Loss: 0.604 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9065151214599609
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.1762580871582031
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.607 Vali Acc: 0.844 Test Loss: 0.607 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.081904411315918
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.844 Test Loss: 0.608 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0243592262268066
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.609 Vali Acc: 0.844 Test Loss: 0.609 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.251368761062622
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.610 Vali Acc: 0.844 Test Loss: 0.610 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1923035
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.9489195346832275
Epoch: 1, Steps: 17 | Train Loss: 1.753 Vali Loss: 1.352 Vali Acc: 0.399 Test Loss: 1.352 Test Acc: 0.399
Validation loss decreased (inf --> -0.398830).  Saving model ...
Epoch: 2 cost time: 0.9574489593505859
Epoch: 2, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.759 Vali Acc: 0.746 Test Loss: 0.759 Test Acc: 0.746
Validation loss decreased (-0.398830 --> -0.745657).  Saving model ...
Epoch: 3 cost time: 0.8361129760742188
Epoch: 3, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.045 Vali Acc: 0.682 Test Loss: 1.045 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8771893978118896
Epoch: 4, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.761 Vali Acc: 0.792 Test Loss: 0.761 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791900).  Saving model ...
Epoch: 5 cost time: 0.8891994953155518
Epoch: 5, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.851 Vali Acc: 0.746 Test Loss: 0.851 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.831779956817627
Epoch: 6, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.799 Vali Acc: 0.844 Test Loss: 0.799 Test Acc: 0.844
Validation loss decreased (-0.791900 --> -0.843923).  Saving model ...
Epoch: 7 cost time: 1.0011234283447266
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.872 Vali Acc: 0.775 Test Loss: 0.872 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9931151866912842
Epoch: 8, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.720 Vali Acc: 0.786 Test Loss: 0.720 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8867292404174805
Epoch: 9, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.574 Vali Acc: 0.838 Test Loss: 0.574 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.01224684715271
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.527 Vali Acc: 0.861 Test Loss: 0.527 Test Acc: 0.861
Validation loss decreased (-0.843923 --> -0.861266).  Saving model ...
Epoch: 11 cost time: 1.0064921379089355
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0602340698242188
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9699516296386719
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.815 Test Loss: 0.548 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9825003147125244
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.551 Vali Acc: 0.815 Test Loss: 0.551 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.012082576751709
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.545 Vali Acc: 0.815 Test Loss: 0.545 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0309484004974365
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.815 Test Loss: 0.548 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9658269882202148
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.548 Vali Acc: 0.815 Test Loss: 0.548 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8346900939941406
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.815 Test Loss: 0.546 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9763433933258057
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.550 Vali Acc: 0.815 Test Loss: 0.550 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.9206638336181641
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.546 Vali Acc: 0.815 Test Loss: 0.546 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1921613
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3577487468719482
Epoch: 1, Steps: 17 | Train Loss: 1.734 Vali Loss: 1.667 Vali Acc: 0.382 Test Loss: 1.667 Test Acc: 0.382
Validation loss decreased (inf --> -0.381486).  Saving model ...
Epoch: 2 cost time: 1.1712052822113037
Epoch: 2, Steps: 17 | Train Loss: 1.124 Vali Loss: 0.927 Vali Acc: 0.682 Test Loss: 0.927 Test Acc: 0.682
Validation loss decreased (-0.381486 --> -0.682072).  Saving model ...
Epoch: 3 cost time: 1.042475938796997
Epoch: 3, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.745 Vali Acc: 0.520 Test Loss: 1.745 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0540738105773926
Epoch: 4, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.954 Vali Acc: 0.746 Test Loss: 0.954 Test Acc: 0.746
Validation loss decreased (-0.682072 --> -0.745655).  Saving model ...
Epoch: 5 cost time: 1.43721342086792
Epoch: 5, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.244 Vali Acc: 0.734 Test Loss: 1.244 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.108628273010254
Epoch: 6, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.771 Vali Acc: 0.769 Test Loss: 0.771 Test Acc: 0.769
Validation loss decreased (-0.745655 --> -0.768778).  Saving model ...
Epoch: 7 cost time: 1.0579688549041748
Epoch: 7, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.771 Vali Acc: 0.815 Test Loss: 0.771 Test Acc: 0.815
Validation loss decreased (-0.768778 --> -0.815021).  Saving model ...
Epoch: 8 cost time: 1.0706462860107422
Epoch: 8, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.928 Vali Acc: 0.815 Test Loss: 0.928 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9764282703399658
Epoch: 9, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.000 Vali Acc: 0.798 Test Loss: 1.000 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.933870792388916
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.274 Vali Acc: 0.728 Test Loss: 1.274 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0440070629119873
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.736 Vali Acc: 0.815 Test Loss: 0.736 Test Acc: 0.815
Validation loss decreased (-0.815021 --> -0.815022).  Saving model ...
Epoch: 12 cost time: 0.9643561840057373
Epoch: 12, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.798 Test Loss: 0.729 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1244745254516602
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.792 Test Loss: 0.765 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1802549362182617
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.815 Test Loss: 0.798 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0240952968597412
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.207705020904541
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.780 Test Loss: 0.738 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3498287200927734
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.727 Vali Acc: 0.786 Test Loss: 0.727 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1233336925506592
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0872337818145752
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.775 Test Loss: 0.710 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.232673168182373
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.704 Vali Acc: 0.775 Test Loss: 0.704 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0710856914520264
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.775 Test Loss: 0.699 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1923149
model size : 7.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.2340121269226074
Epoch: 1, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.398 Vali Acc: 0.462 Test Loss: 1.398 Test Acc: 0.462
Validation loss decreased (inf --> -0.462414).  Saving model ...
Epoch: 2 cost time: 1.1232435703277588
Epoch: 2, Steps: 17 | Train Loss: 0.843 Vali Loss: 0.974 Vali Acc: 0.705 Test Loss: 0.974 Test Acc: 0.705
Validation loss decreased (-0.462414 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 1.015268325805664
Epoch: 3, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.874 Vali Acc: 0.624 Test Loss: 1.874 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9743928909301758
Epoch: 4, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.043 Vali Acc: 0.711 Test Loss: 1.043 Test Acc: 0.711
Validation loss decreased (-0.705193 --> -0.710972).  Saving model ...
Epoch: 5 cost time: 0.9929077625274658
Epoch: 5, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.201 Vali Acc: 0.740 Test Loss: 1.201 Test Acc: 0.740
Validation loss decreased (-0.710972 --> -0.739872).  Saving model ...
Epoch: 6 cost time: 0.9504992961883545
Epoch: 6, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.813 Vali Acc: 0.769 Test Loss: 0.813 Test Acc: 0.769
Validation loss decreased (-0.739872 --> -0.768778).  Saving model ...
Epoch: 7 cost time: 1.0153403282165527
Epoch: 7, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.977 Vali Acc: 0.786 Test Loss: 0.977 Test Acc: 0.786
Validation loss decreased (-0.768778 --> -0.786117).  Saving model ...
Epoch: 8 cost time: 1.1497321128845215
Epoch: 8, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.854 Vali Acc: 0.786 Test Loss: 0.854 Test Acc: 0.786
Validation loss decreased (-0.786117 --> -0.786119).  Saving model ...
Epoch: 9 cost time: 1.0949985980987549
Epoch: 9, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.866 Vali Acc: 0.803 Test Loss: 0.866 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803460).  Saving model ...
Epoch: 10 cost time: 1.0093977451324463
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.821 Test Loss: 0.729 Test Acc: 0.821
Validation loss decreased (-0.803460 --> -0.820802).  Saving model ...
Epoch: 11 cost time: 1.042400598526001
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.815 Test Loss: 0.742 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0765998363494873
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.815 Test Loss: 0.724 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9698491096496582
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.815 Test Loss: 0.711 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.0231475830078125
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1205940246582031
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.701 Vali Acc: 0.803 Test Loss: 0.701 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1406605243682861
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.803 Test Loss: 0.700 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0505788326263428
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0693035125732422
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.695 Vali Acc: 0.803 Test Loss: 0.695 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1035172939300537
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0710313320159912
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.803 Test Loss: 0.697 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1922619
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3840603828430176
Epoch: 1, Steps: 17 | Train Loss: 1.853 Vali Loss: 1.212 Vali Acc: 0.497 Test Loss: 1.212 Test Acc: 0.497
Validation loss decreased (inf --> -0.497098).  Saving model ...
Epoch: 2 cost time: 1.0680510997772217
Epoch: 2, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.716 Vali Acc: 0.671 Test Loss: 1.716 Test Acc: 0.671
Validation loss decreased (-0.497098 --> -0.670503).  Saving model ...
Epoch: 3 cost time: 0.9495532512664795
Epoch: 3, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.408 Vali Acc: 0.682 Test Loss: 1.408 Test Acc: 0.682
Validation loss decreased (-0.670503 --> -0.682067).  Saving model ...
Epoch: 4 cost time: 1.128843069076538
Epoch: 4, Steps: 17 | Train Loss: 0.220 Vali Loss: 1.892 Vali Acc: 0.561 Test Loss: 1.892 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0453855991363525
Epoch: 5, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.699 Vali Acc: 0.757 Test Loss: 0.699 Test Acc: 0.757
Validation loss decreased (-0.682067 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 1.0714571475982666
Epoch: 6, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809241).  Saving model ...
Epoch: 7 cost time: 1.0243792533874512
Epoch: 7, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.960 Vali Acc: 0.803 Test Loss: 0.960 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9990525245666504
Epoch: 8, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.800 Vali Acc: 0.786 Test Loss: 0.800 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.954740047454834
Epoch: 9, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.806 Vali Acc: 0.850 Test Loss: 0.806 Test Acc: 0.850
Validation loss decreased (-0.809241 --> -0.849703).  Saving model ...
Epoch: 10 cost time: 0.9160733222961426
Epoch: 10, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.890 Vali Acc: 0.821 Test Loss: 0.890 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9951925277709961
Epoch: 11, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.815 Test Loss: 0.787 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9545042514801025
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.666 Vali Acc: 0.844 Test Loss: 0.666 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9267802238464355
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.855 Test Loss: 0.630 Test Acc: 0.855
Validation loss decreased (-0.849703 --> -0.855485).  Saving model ...
Epoch: 14 cost time: 0.8974213600158691
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.855 Test Loss: 0.629 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855485).  Saving model ...
Epoch: 15 cost time: 0.9281437397003174
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855485).  Saving model ...
Epoch: 16 cost time: 0.9040193557739258
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
Validation loss decreased (-0.855485 --> -0.855485).  Saving model ...
Epoch: 17 cost time: 0.9184653759002686
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.855 Test Loss: 0.628 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9959022998809814
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
Validation loss decreased (-0.855485 --> -0.867046).  Saving model ...
Epoch: 19 cost time: 0.9790816307067871
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9902536869049072
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.629 Vali Acc: 0.867 Test Loss: 0.629 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9515829086303711
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.630 Vali Acc: 0.867 Test Loss: 0.630 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0141017436981201
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1186470985412598
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9553539752960205
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0005667209625244
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.634 Vali Acc: 0.867 Test Loss: 0.634 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1136553287506104
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.867 Test Loss: 0.635 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9256744384765625
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9712367057800293
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1921805
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 1.9725844860076904
Epoch: 1, Steps: 17 | Train Loss: 1.816 Vali Loss: 1.785 Vali Acc: 0.405 Test Loss: 1.785 Test Acc: 0.405
Validation loss decreased (inf --> -0.404606).  Saving model ...
Epoch: 2 cost time: 0.9699313640594482
Epoch: 2, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.949 Vali Acc: 0.676 Test Loss: 0.949 Test Acc: 0.676
Validation loss decreased (-0.404606 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 0.9861540794372559
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.069 Vali Acc: 0.688 Test Loss: 1.069 Test Acc: 0.688
Validation loss decreased (-0.676291 --> -0.687851).  Saving model ...
Epoch: 4 cost time: 1.0932080745697021
Epoch: 4, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.806 Vali Acc: 0.723 Test Loss: 0.806 Test Acc: 0.723
Validation loss decreased (-0.687851 --> -0.722535).  Saving model ...
Epoch: 5 cost time: 1.0089404582977295
Epoch: 5, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.840 Vali Acc: 0.798 Test Loss: 0.840 Test Acc: 0.798
Validation loss decreased (-0.722535 --> -0.797679).  Saving model ...
Epoch: 6 cost time: 0.9119441509246826
Epoch: 6, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.397 Vali Acc: 0.757 Test Loss: 1.397 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1063377857208252
Epoch: 7, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.774 Vali Acc: 0.809 Test Loss: 0.774 Test Acc: 0.809
Validation loss decreased (-0.797679 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 1.1481361389160156
Epoch: 8, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.200 Vali Acc: 0.798 Test Loss: 1.200 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.13087797164917
Epoch: 9, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.070 Vali Acc: 0.775 Test Loss: 1.070 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.084141492843628
Epoch: 10, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.826 Vali Acc: 0.809 Test Loss: 0.826 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1272144317626953
Epoch: 11, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.782 Vali Acc: 0.832 Test Loss: 0.782 Test Acc: 0.832
Validation loss decreased (-0.809241 --> -0.832362).  Saving model ...
Epoch: 12 cost time: 1.0413424968719482
Epoch: 12, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.779 Vali Acc: 0.827 Test Loss: 0.779 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0727195739746094
Epoch: 13, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.838 Test Loss: 0.767 Test Acc: 0.838
Validation loss decreased (-0.832362 --> -0.838143).  Saving model ...
Epoch: 14 cost time: 1.0888030529022217
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.844 Test Loss: 0.756 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843923).  Saving model ...
Epoch: 15 cost time: 0.9981882572174072
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.753 Vali Acc: 0.844 Test Loss: 0.753 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843923).  Saving model ...
Epoch: 16 cost time: 1.0924694538116455
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.751 Vali Acc: 0.838 Test Loss: 0.751 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9435360431671143
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.749 Vali Acc: 0.838 Test Loss: 0.749 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1054210662841797
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2021193504333496
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.838 Test Loss: 0.746 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1534504890441895
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.838 Test Loss: 0.746 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1769368648529053
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.838 Test Loss: 0.746 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.200709581375122
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.838 Test Loss: 0.748 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9789538383483887
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.838 Test Loss: 0.748 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1539511680603027
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1051280498504639
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.838 Test Loss: 0.748 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1921933
model size : 7.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 2.3196628093719482
Epoch: 1, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.454 Vali Acc: 0.480 Test Loss: 1.454 Test Acc: 0.480
Validation loss decreased (inf --> -0.479754).  Saving model ...
Epoch: 2 cost time: 1.0320374965667725
Epoch: 2, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.681 Vali Acc: 0.769 Test Loss: 0.681 Test Acc: 0.769
Validation loss decreased (-0.479754 --> -0.768779).  Saving model ...
Epoch: 3 cost time: 1.1233181953430176
Epoch: 3, Steps: 17 | Train Loss: 0.352 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
Validation loss decreased (-0.768779 --> -0.803461).  Saving model ...
Epoch: 4 cost time: 1.1144077777862549
Epoch: 4, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.150 Vali Acc: 0.630 Test Loss: 1.150 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0284159183502197
Epoch: 5, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.699 Vali Acc: 0.780 Test Loss: 0.699 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.11838960647583
Epoch: 6, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.053 Vali Acc: 0.803 Test Loss: 1.053 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0788657665252686
Epoch: 7, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.651 Vali Acc: 0.838 Test Loss: 0.651 Test Acc: 0.838
Validation loss decreased (-0.803461 --> -0.838144).  Saving model ...
Epoch: 8 cost time: 1.0927176475524902
Epoch: 8, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.792 Vali Acc: 0.792 Test Loss: 0.792 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1113395690917969
Epoch: 9, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.835 Vali Acc: 0.809 Test Loss: 0.835 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1111905574798584
Epoch: 10, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.551 Vali Acc: 0.827 Test Loss: 0.551 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0562288761138916
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.763 Vali Acc: 0.775 Test Loss: 0.763 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0506000518798828
Epoch: 12, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.770 Vali Acc: 0.815 Test Loss: 0.770 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0286521911621094
Epoch: 13, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.821 Test Loss: 0.789 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1120696067810059
Epoch: 14, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.850 Test Loss: 0.746 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849704).  Saving model ...
Epoch: 15 cost time: 1.0813724994659424
Epoch: 15, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.765 Vali Acc: 0.827 Test Loss: 0.765 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9936401844024658
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.760 Vali Acc: 0.827 Test Loss: 0.760 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0989408493041992
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.754 Vali Acc: 0.815 Test Loss: 0.754 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2154383659362793
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.748 Vali Acc: 0.815 Test Loss: 0.748 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.196516513824463
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.815 Test Loss: 0.742 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.349536657333374
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.738 Vali Acc: 0.821 Test Loss: 0.738 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3466551303863525
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.827 Test Loss: 0.736 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3628778457641602
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.734 Vali Acc: 0.827 Test Loss: 0.734 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2766687870025635
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.732 Vali Acc: 0.827 Test Loss: 0.732 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2839076519012451
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.731 Vali Acc: 0.827 Test Loss: 0.731 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_LightTS_UEA_ftM_sl144_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1922595
model size : 7.34MB
