Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7335002422332764
Epoch: 1, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.744 Vali Acc: 0.215 Test Loss: 1.744 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.4145636558532715
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.728 Vali Acc: 0.241 Test Loss: 1.728 Test Acc: 0.241
Validation loss decreased (-0.214797 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.48921680450439453
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.717 Vali Acc: 0.248 Test Loss: 1.717 Test Acc: 0.248
Validation loss decreased (-0.240723 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.5714142322540283
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.706 Vali Acc: 0.259 Test Loss: 1.706 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.5745725631713867
Epoch: 5, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.692 Vali Acc: 0.267 Test Loss: 1.692 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266650).  Saving model ...
Epoch: 6 cost time: 0.5188202857971191
Epoch: 6, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.676 Vali Acc: 0.307 Test Loss: 1.676 Test Acc: 0.307
Validation loss decreased (-0.266650 --> -0.307391).  Saving model ...
Epoch: 7 cost time: 0.5925314426422119
Epoch: 7, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.657 Vali Acc: 0.326 Test Loss: 1.657 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 0.4481480121612549
Epoch: 8, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.637 Vali Acc: 0.359 Test Loss: 1.637 Test Acc: 0.359
Validation loss decreased (-0.325909 --> -0.359243).  Saving model ...
Epoch: 9 cost time: 0.524754524230957
Epoch: 9, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.616 Vali Acc: 0.370 Test Loss: 1.616 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 10 cost time: 0.5504553318023682
Epoch: 10, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.593 Vali Acc: 0.393 Test Loss: 1.593 Test Acc: 0.393
Validation loss decreased (-0.370354 --> -0.392577).  Saving model ...
Epoch: 11 cost time: 0.5055108070373535
Epoch: 11, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.568 Vali Acc: 0.407 Test Loss: 1.568 Test Acc: 0.407
Validation loss decreased (-0.392577 --> -0.407392).  Saving model ...
Epoch: 12 cost time: 0.508112907409668
Epoch: 12, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.543 Vali Acc: 0.430 Test Loss: 1.543 Test Acc: 0.430
Validation loss decreased (-0.407392 --> -0.429614).  Saving model ...
Epoch: 13 cost time: 0.46442246437072754
Epoch: 13, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.517 Vali Acc: 0.444 Test Loss: 1.517 Test Acc: 0.444
Validation loss decreased (-0.429614 --> -0.444429).  Saving model ...
Epoch: 14 cost time: 0.41144394874572754
Epoch: 14, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.489 Vali Acc: 0.478 Test Loss: 1.489 Test Acc: 0.478
Validation loss decreased (-0.444429 --> -0.477763).  Saving model ...
Epoch: 15 cost time: 0.4795565605163574
Epoch: 15, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.461 Vali Acc: 0.493 Test Loss: 1.461 Test Acc: 0.493
Validation loss decreased (-0.477763 --> -0.492578).  Saving model ...
Epoch: 16 cost time: 0.49778270721435547
Epoch: 16, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.430 Vali Acc: 0.500 Test Loss: 1.430 Test Acc: 0.500
Validation loss decreased (-0.492578 --> -0.499986).  Saving model ...
Epoch: 17 cost time: 0.43289709091186523
Epoch: 17, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.399 Vali Acc: 0.530 Test Loss: 1.399 Test Acc: 0.530
Validation loss decreased (-0.499986 --> -0.529616).  Saving model ...
Epoch: 18 cost time: 0.4636096954345703
Epoch: 18, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.366 Vali Acc: 0.556 Test Loss: 1.366 Test Acc: 0.556
Validation loss decreased (-0.529616 --> -0.555542).  Saving model ...
Epoch: 19 cost time: 0.5484604835510254
Epoch: 19, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.331 Vali Acc: 0.593 Test Loss: 1.331 Test Acc: 0.593
Validation loss decreased (-0.555542 --> -0.592579).  Saving model ...
Epoch: 20 cost time: 0.5088307857513428
Epoch: 20, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.296 Vali Acc: 0.619 Test Loss: 1.296 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618506).  Saving model ...
Epoch: 21 cost time: 0.46667003631591797
Epoch: 21, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.258 Vali Acc: 0.633 Test Loss: 1.258 Test Acc: 0.633
Validation loss decreased (-0.618506 --> -0.633321).  Saving model ...
Epoch: 22 cost time: 0.4909381866455078
Epoch: 22, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.219 Vali Acc: 0.641 Test Loss: 1.219 Test Acc: 0.641
Validation loss decreased (-0.633321 --> -0.640729).  Saving model ...
Epoch: 23 cost time: 0.5319130420684814
Epoch: 23, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.178 Vali Acc: 0.670 Test Loss: 1.178 Test Acc: 0.670
Validation loss decreased (-0.640729 --> -0.670359).  Saving model ...
Epoch: 24 cost time: 0.4149651527404785
Epoch: 24, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.135 Vali Acc: 0.700 Test Loss: 1.135 Test Acc: 0.700
Validation loss decreased (-0.670359 --> -0.699989).  Saving model ...
Epoch: 25 cost time: 0.42911624908447266
Epoch: 25, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.091 Vali Acc: 0.715 Test Loss: 1.091 Test Acc: 0.715
Validation loss decreased (-0.699989 --> -0.714804).  Saving model ...
Epoch: 26 cost time: 0.5350408554077148
Epoch: 26, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.044 Vali Acc: 0.730 Test Loss: 1.044 Test Acc: 0.730
Validation loss decreased (-0.714804 --> -0.729619).  Saving model ...
Epoch: 27 cost time: 0.464141845703125
Epoch: 27, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.997 Vali Acc: 0.733 Test Loss: 0.997 Test Acc: 0.733
Validation loss decreased (-0.729619 --> -0.733323).  Saving model ...
Epoch: 28 cost time: 0.4453771114349365
Epoch: 28, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.948 Vali Acc: 0.752 Test Loss: 0.948 Test Acc: 0.752
Validation loss decreased (-0.733323 --> -0.751842).  Saving model ...
Epoch: 29 cost time: 0.40400171279907227
Epoch: 29, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.898 Vali Acc: 0.767 Test Loss: 0.898 Test Acc: 0.767
Validation loss decreased (-0.751842 --> -0.766658).  Saving model ...
Epoch: 30 cost time: 0.44710493087768555
Epoch: 30, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.847 Vali Acc: 0.785 Test Loss: 0.847 Test Acc: 0.785
Validation loss decreased (-0.766658 --> -0.785177).  Saving model ...
Epoch: 31 cost time: 0.45903658866882324
Epoch: 31, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.797 Vali Acc: 0.796 Test Loss: 0.797 Test Acc: 0.796
Validation loss decreased (-0.785177 --> -0.796288).  Saving model ...
Epoch: 32 cost time: 0.48957157135009766
Epoch: 32, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
Validation loss decreased (-0.796288 --> -0.822215).  Saving model ...
Epoch: 33 cost time: 0.5785853862762451
Epoch: 33, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.699 Vali Acc: 0.837 Test Loss: 0.699 Test Acc: 0.837
Validation loss decreased (-0.822215 --> -0.837030).  Saving model ...
Epoch: 34 cost time: 0.45200324058532715
Epoch: 34, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.652 Vali Acc: 0.837 Test Loss: 0.652 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837031).  Saving model ...
Epoch: 35 cost time: 0.3434467315673828
Epoch: 35, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.607 Vali Acc: 0.863 Test Loss: 0.607 Test Acc: 0.863
Validation loss decreased (-0.837031 --> -0.862957).  Saving model ...
Epoch: 36 cost time: 0.4732985496520996
Epoch: 36, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.564 Vali Acc: 0.870 Test Loss: 0.564 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870365).  Saving model ...
Epoch: 37 cost time: 0.47516632080078125
Epoch: 37, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.526 Vali Acc: 0.878 Test Loss: 0.526 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877773).  Saving model ...
Epoch: 38 cost time: 0.3936347961425781
Epoch: 38, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.490 Vali Acc: 0.885 Test Loss: 0.490 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885180).  Saving model ...
Epoch: 39 cost time: 0.4762539863586426
Epoch: 39, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 40 cost time: 0.42440223693847656
Epoch: 40, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
Validation loss decreased (-0.888884 --> -0.907403).  Saving model ...
Epoch: 41 cost time: 0.5061724185943604
Epoch: 41, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 42 cost time: 0.48852062225341797
Epoch: 42, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.376 Vali Acc: 0.915 Test Loss: 0.376 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 43 cost time: 0.4889984130859375
Epoch: 43, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 44 cost time: 0.4240751266479492
Epoch: 44, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.339 Vali Acc: 0.907 Test Loss: 0.339 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4193553924560547
Epoch: 45, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.325 Vali Acc: 0.896 Test Loss: 0.325 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.497086763381958
Epoch: 46, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.315 Vali Acc: 0.893 Test Loss: 0.315 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5870480537414551
Epoch: 47, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5176546573638916
Epoch: 48, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.303 Vali Acc: 0.878 Test Loss: 0.303 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.42929601669311523
Epoch: 49, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.301 Vali Acc: 0.881 Test Loss: 0.301 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5190763473510742
Epoch: 50, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.301 Vali Acc: 0.878 Test Loss: 0.301 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.4850761890411377
Epoch: 51, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.302 Vali Acc: 0.878 Test Loss: 0.302 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.36457157135009766
Epoch: 52, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.305 Vali Acc: 0.867 Test Loss: 0.305 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5298280715942383
Epoch: 53, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.309 Vali Acc: 0.863 Test Loss: 0.309 Test Acc: 0.863
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 117832
model size : 0.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8086574077606201
Epoch: 1, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.799 Vali Acc: 0.215 Test Loss: 1.799 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.42198896408081055
Epoch: 2, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.779 Vali Acc: 0.226 Test Loss: 1.779 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.49330830574035645
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.765 Vali Acc: 0.233 Test Loss: 1.765 Test Acc: 0.233
Validation loss decreased (-0.225908 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.5339243412017822
Epoch: 4, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.755 Vali Acc: 0.237 Test Loss: 1.755 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.4748880863189697
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.743 Vali Acc: 0.248 Test Loss: 1.743 Test Acc: 0.248
Validation loss decreased (-0.237019 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 0.3835315704345703
Epoch: 6, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.728 Vali Acc: 0.259 Test Loss: 1.728 Test Acc: 0.259
Validation loss decreased (-0.248131 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.4135904312133789
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.711 Vali Acc: 0.267 Test Loss: 1.711 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 0.47870612144470215
Epoch: 8, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.693 Vali Acc: 0.278 Test Loss: 1.693 Test Acc: 0.278
Validation loss decreased (-0.266650 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.4348902702331543
Epoch: 9, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.673 Vali Acc: 0.289 Test Loss: 1.673 Test Acc: 0.289
Validation loss decreased (-0.277761 --> -0.288872).  Saving model ...
Epoch: 10 cost time: 0.48293495178222656
Epoch: 10, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.652 Vali Acc: 0.326 Test Loss: 1.652 Test Acc: 0.326
Validation loss decreased (-0.288872 --> -0.325909).  Saving model ...
Epoch: 11 cost time: 0.5321459770202637
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.630 Vali Acc: 0.352 Test Loss: 1.630 Test Acc: 0.352
Validation loss decreased (-0.325909 --> -0.351836).  Saving model ...
Epoch: 12 cost time: 0.505119800567627
Epoch: 12, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.607 Vali Acc: 0.374 Test Loss: 1.607 Test Acc: 0.374
Validation loss decreased (-0.351836 --> -0.374058).  Saving model ...
Epoch: 13 cost time: 0.41019487380981445
Epoch: 13, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.583 Vali Acc: 0.407 Test Loss: 1.583 Test Acc: 0.407
Validation loss decreased (-0.374058 --> -0.407392).  Saving model ...
Epoch: 14 cost time: 0.4351685047149658
Epoch: 14, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.558 Vali Acc: 0.452 Test Loss: 1.558 Test Acc: 0.452
Validation loss decreased (-0.407392 --> -0.451836).  Saving model ...
Epoch: 15 cost time: 0.5465495586395264
Epoch: 15, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.533 Vali Acc: 0.481 Test Loss: 1.533 Test Acc: 0.481
Validation loss decreased (-0.451836 --> -0.481466).  Saving model ...
Epoch: 16 cost time: 0.4450557231903076
Epoch: 16, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.508 Vali Acc: 0.515 Test Loss: 1.508 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514800).  Saving model ...
Epoch: 17 cost time: 0.5591752529144287
Epoch: 17, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.481 Vali Acc: 0.574 Test Loss: 1.481 Test Acc: 0.574
Validation loss decreased (-0.514800 --> -0.574059).  Saving model ...
Epoch: 18 cost time: 0.4286949634552002
Epoch: 18, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.455 Vali Acc: 0.619 Test Loss: 1.455 Test Acc: 0.619
Validation loss decreased (-0.574059 --> -0.618504).  Saving model ...
Epoch: 19 cost time: 0.4636831283569336
Epoch: 19, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.427 Vali Acc: 0.633 Test Loss: 1.427 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633319).  Saving model ...
Epoch: 20 cost time: 0.6311314105987549
Epoch: 20, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.400 Vali Acc: 0.652 Test Loss: 1.400 Test Acc: 0.652
Validation loss decreased (-0.633319 --> -0.651838).  Saving model ...
Epoch: 21 cost time: 0.4633903503417969
Epoch: 21, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.372 Vali Acc: 0.693 Test Loss: 1.372 Test Acc: 0.693
Validation loss decreased (-0.651838 --> -0.692579).  Saving model ...
Epoch: 22 cost time: 0.47712159156799316
Epoch: 22, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.344 Vali Acc: 0.726 Test Loss: 1.344 Test Acc: 0.726
Validation loss decreased (-0.692579 --> -0.725912).  Saving model ...
Epoch: 23 cost time: 0.4301719665527344
Epoch: 23, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.315 Vali Acc: 0.759 Test Loss: 1.315 Test Acc: 0.759
Validation loss decreased (-0.725912 --> -0.759246).  Saving model ...
Epoch: 24 cost time: 0.47144603729248047
Epoch: 24, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.286 Vali Acc: 0.781 Test Loss: 1.286 Test Acc: 0.781
Validation loss decreased (-0.759246 --> -0.781469).  Saving model ...
Epoch: 25 cost time: 0.5286195278167725
Epoch: 25, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.258 Vali Acc: 0.793 Test Loss: 1.258 Test Acc: 0.793
Validation loss decreased (-0.781469 --> -0.792580).  Saving model ...
Epoch: 26 cost time: 0.5749197006225586
Epoch: 26, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.228 Vali Acc: 0.804 Test Loss: 1.228 Test Acc: 0.804
Validation loss decreased (-0.792580 --> -0.803691).  Saving model ...
Epoch: 27 cost time: 0.476046085357666
Epoch: 27, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.199 Vali Acc: 0.819 Test Loss: 1.199 Test Acc: 0.819
Validation loss decreased (-0.803691 --> -0.818507).  Saving model ...
Epoch: 28 cost time: 0.46349143981933594
Epoch: 28, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.169 Vali Acc: 0.833 Test Loss: 1.169 Test Acc: 0.833
Validation loss decreased (-0.818507 --> -0.833322).  Saving model ...
Epoch: 29 cost time: 0.4499552249908447
Epoch: 29, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.139 Vali Acc: 0.844 Test Loss: 1.139 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844433).  Saving model ...
Epoch: 30 cost time: 0.5252323150634766
Epoch: 30, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.109 Vali Acc: 0.852 Test Loss: 1.109 Test Acc: 0.852
Validation loss decreased (-0.844433 --> -0.851841).  Saving model ...
Epoch: 31 cost time: 0.49313879013061523
Epoch: 31, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.078 Vali Acc: 0.856 Test Loss: 1.078 Test Acc: 0.856
Validation loss decreased (-0.851841 --> -0.855545).  Saving model ...
Epoch: 32 cost time: 0.5310866832733154
Epoch: 32, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.047 Vali Acc: 0.867 Test Loss: 1.047 Test Acc: 0.867
Validation loss decreased (-0.855545 --> -0.866656).  Saving model ...
Epoch: 33 cost time: 0.4772307872772217
Epoch: 33, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.017 Vali Acc: 0.878 Test Loss: 1.017 Test Acc: 0.878
Validation loss decreased (-0.866656 --> -0.877768).  Saving model ...
Epoch: 34 cost time: 0.5086765289306641
Epoch: 34, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.986 Vali Acc: 0.881 Test Loss: 0.986 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 35 cost time: 0.4685173034667969
Epoch: 35, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.954 Vali Acc: 0.889 Test Loss: 0.954 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888879).  Saving model ...
Epoch: 36 cost time: 0.46752309799194336
Epoch: 36, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.922 Vali Acc: 0.881 Test Loss: 0.922 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.48923516273498535
Epoch: 37, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.890 Vali Acc: 0.885 Test Loss: 0.890 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5677821636199951
Epoch: 38, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.857 Vali Acc: 0.900 Test Loss: 0.857 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899991).  Saving model ...
Epoch: 39 cost time: 0.4807126522064209
Epoch: 39, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.824 Vali Acc: 0.904 Test Loss: 0.824 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 40 cost time: 0.5299718379974365
Epoch: 40, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.790 Vali Acc: 0.907 Test Loss: 0.790 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907400).  Saving model ...
Epoch: 41 cost time: 0.6296141147613525
Epoch: 41, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.754 Vali Acc: 0.915 Test Loss: 0.754 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 42 cost time: 0.4688599109649658
Epoch: 42, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.719 Vali Acc: 0.915 Test Loss: 0.719 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 43 cost time: 0.5215935707092285
Epoch: 43, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.683 Vali Acc: 0.911 Test Loss: 0.683 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.45717358589172363
Epoch: 44, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.647 Vali Acc: 0.911 Test Loss: 0.647 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5046446323394775
Epoch: 45, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.611 Vali Acc: 0.911 Test Loss: 0.611 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5033442974090576
Epoch: 46, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.575 Vali Acc: 0.911 Test Loss: 0.575 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4793257713317871
Epoch: 47, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.541 Vali Acc: 0.911 Test Loss: 0.541 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.4189877510070801
Epoch: 48, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.506 Vali Acc: 0.926 Test Loss: 0.506 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925921).  Saving model ...
Epoch: 49 cost time: 0.42831993103027344
Epoch: 49, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 50 cost time: 0.3836240768432617
Epoch: 50, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.442 Vali Acc: 0.930 Test Loss: 0.442 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 51 cost time: 0.36215734481811523
Epoch: 51, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.413 Vali Acc: 0.926 Test Loss: 0.413 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.565798282623291
Epoch: 52, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.386 Vali Acc: 0.919 Test Loss: 0.386 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.39989233016967773
Epoch: 53, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.481950044631958
Epoch: 54, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.41469550132751465
Epoch: 55, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.4544334411621094
Epoch: 56, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5782644748687744
Epoch: 57, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.5390682220458984
Epoch: 58, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.3979318141937256
Epoch: 59, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.4750199317932129
Epoch: 60, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 115030
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5137674808502197
Epoch: 1, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.962 Vali Acc: 0.030 Test Loss: 1.962 Test Acc: 0.030
Validation loss decreased (inf --> -0.029610).  Saving model ...
Epoch: 2 cost time: 0.43426990509033203
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.941 Vali Acc: 0.041 Test Loss: 1.941 Test Acc: 0.041
Validation loss decreased (-0.029610 --> -0.040721).  Saving model ...
Epoch: 3 cost time: 0.4371144771575928
Epoch: 3, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.927 Vali Acc: 0.052 Test Loss: 1.927 Test Acc: 0.052
Validation loss decreased (-0.040721 --> -0.051833).  Saving model ...
Epoch: 4 cost time: 0.42015576362609863
Epoch: 4, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.916 Vali Acc: 0.056 Test Loss: 1.916 Test Acc: 0.056
Validation loss decreased (-0.051833 --> -0.055536).  Saving model ...
Epoch: 5 cost time: 0.48162317276000977
Epoch: 5, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.902 Vali Acc: 0.056 Test Loss: 1.902 Test Acc: 0.056
Validation loss decreased (-0.055536 --> -0.055537).  Saving model ...
Epoch: 6 cost time: 0.46976709365844727
Epoch: 6, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.886 Vali Acc: 0.063 Test Loss: 1.886 Test Acc: 0.063
Validation loss decreased (-0.055537 --> -0.062944).  Saving model ...
Epoch: 7 cost time: 0.42294955253601074
Epoch: 7, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.867 Vali Acc: 0.067 Test Loss: 1.867 Test Acc: 0.067
Validation loss decreased (-0.062944 --> -0.066648).  Saving model ...
Epoch: 8 cost time: 0.48624682426452637
Epoch: 8, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.847 Vali Acc: 0.100 Test Loss: 1.847 Test Acc: 0.100
Validation loss decreased (-0.066648 --> -0.099982).  Saving model ...
Epoch: 9 cost time: 0.4351179599761963
Epoch: 9, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.825 Vali Acc: 0.115 Test Loss: 1.825 Test Acc: 0.115
Validation loss decreased (-0.099982 --> -0.114797).  Saving model ...
Epoch: 10 cost time: 0.47101926803588867
Epoch: 10, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.802 Vali Acc: 0.144 Test Loss: 1.802 Test Acc: 0.144
Validation loss decreased (-0.114797 --> -0.144426).  Saving model ...
Epoch: 11 cost time: 0.548487663269043
Epoch: 11, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.777 Vali Acc: 0.159 Test Loss: 1.777 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 12 cost time: 0.4360358715057373
Epoch: 12, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.752 Vali Acc: 0.189 Test Loss: 1.752 Test Acc: 0.189
Validation loss decreased (-0.159241 --> -0.188871).  Saving model ...
Epoch: 13 cost time: 0.4483160972595215
Epoch: 13, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.725 Vali Acc: 0.222 Test Loss: 1.725 Test Acc: 0.222
Validation loss decreased (-0.188871 --> -0.222205).  Saving model ...
Epoch: 14 cost time: 0.5232281684875488
Epoch: 14, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.698 Vali Acc: 0.267 Test Loss: 1.698 Test Acc: 0.267
Validation loss decreased (-0.222205 --> -0.266650).  Saving model ...
Epoch: 15 cost time: 0.5379703044891357
Epoch: 15, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.670 Vali Acc: 0.307 Test Loss: 1.670 Test Acc: 0.307
Validation loss decreased (-0.266650 --> -0.307391).  Saving model ...
Epoch: 16 cost time: 0.418215274810791
Epoch: 16, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.640 Vali Acc: 0.344 Test Loss: 1.640 Test Acc: 0.344
Validation loss decreased (-0.307391 --> -0.344428).  Saving model ...
Epoch: 17 cost time: 0.5292861461639404
Epoch: 17, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.610 Vali Acc: 0.363 Test Loss: 1.610 Test Acc: 0.363
Validation loss decreased (-0.344428 --> -0.362947).  Saving model ...
Epoch: 18 cost time: 0.4474952220916748
Epoch: 18, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.579 Vali Acc: 0.393 Test Loss: 1.579 Test Acc: 0.393
Validation loss decreased (-0.362947 --> -0.392577).  Saving model ...
Epoch: 19 cost time: 0.44805121421813965
Epoch: 19, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.546 Vali Acc: 0.444 Test Loss: 1.546 Test Acc: 0.444
Validation loss decreased (-0.392577 --> -0.444429).  Saving model ...
Epoch: 20 cost time: 0.5089452266693115
Epoch: 20, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.513 Vali Acc: 0.496 Test Loss: 1.513 Test Acc: 0.496
Validation loss decreased (-0.444429 --> -0.496281).  Saving model ...
Epoch: 21 cost time: 0.3860487937927246
Epoch: 21, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.479 Vali Acc: 0.548 Test Loss: 1.479 Test Acc: 0.548
Validation loss decreased (-0.496281 --> -0.548133).  Saving model ...
Epoch: 22 cost time: 0.5015439987182617
Epoch: 22, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.443 Vali Acc: 0.567 Test Loss: 1.443 Test Acc: 0.567
Validation loss decreased (-0.548133 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 0.5234253406524658
Epoch: 23, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.406 Vali Acc: 0.596 Test Loss: 1.406 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596282).  Saving model ...
Epoch: 24 cost time: 0.4367551803588867
Epoch: 24, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.368 Vali Acc: 0.622 Test Loss: 1.368 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622209).  Saving model ...
Epoch: 25 cost time: 0.43044495582580566
Epoch: 25, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.329 Vali Acc: 0.637 Test Loss: 1.329 Test Acc: 0.637
Validation loss decreased (-0.622209 --> -0.637024).  Saving model ...
Epoch: 26 cost time: 0.3659348487854004
Epoch: 26, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.288 Vali Acc: 0.678 Test Loss: 1.288 Test Acc: 0.678
Validation loss decreased (-0.637024 --> -0.677765).  Saving model ...
Epoch: 27 cost time: 0.44068050384521484
Epoch: 27, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.246 Vali Acc: 0.711 Test Loss: 1.246 Test Acc: 0.711
Validation loss decreased (-0.677765 --> -0.711099).  Saving model ...
Epoch: 28 cost time: 0.5118353366851807
Epoch: 28, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.201 Vali Acc: 0.722 Test Loss: 1.201 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722210).  Saving model ...
Epoch: 29 cost time: 0.3858175277709961
Epoch: 29, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.154 Vali Acc: 0.737 Test Loss: 1.154 Test Acc: 0.737
Validation loss decreased (-0.722210 --> -0.737025).  Saving model ...
Epoch: 30 cost time: 0.5364806652069092
Epoch: 30, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.105 Vali Acc: 0.763 Test Loss: 1.105 Test Acc: 0.763
Validation loss decreased (-0.737025 --> -0.762952).  Saving model ...
Epoch: 31 cost time: 0.5655443668365479
Epoch: 31, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.054 Vali Acc: 0.789 Test Loss: 1.054 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788878).  Saving model ...
Epoch: 32 cost time: 0.436800479888916
Epoch: 32, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.001 Vali Acc: 0.822 Test Loss: 1.001 Test Acc: 0.822
Validation loss decreased (-0.788878 --> -0.822212).  Saving model ...
Epoch: 33 cost time: 0.3820793628692627
Epoch: 33, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.947 Vali Acc: 0.852 Test Loss: 0.947 Test Acc: 0.852
Validation loss decreased (-0.822212 --> -0.851842).  Saving model ...
Epoch: 34 cost time: 0.5305953025817871
Epoch: 34, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.892 Vali Acc: 0.863 Test Loss: 0.892 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862954).  Saving model ...
Epoch: 35 cost time: 0.41011619567871094
Epoch: 35, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.837 Vali Acc: 0.881 Test Loss: 0.837 Test Acc: 0.881
Validation loss decreased (-0.862954 --> -0.881473).  Saving model ...
Epoch: 36 cost time: 0.563774824142456
Epoch: 36, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.781 Vali Acc: 0.874 Test Loss: 0.781 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.38455796241760254
Epoch: 37, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.727 Vali Acc: 0.874 Test Loss: 0.727 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.44247984886169434
Epoch: 38, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.675 Vali Acc: 0.874 Test Loss: 0.675 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4863004684448242
Epoch: 39, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.627 Vali Acc: 0.878 Test Loss: 0.627 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.457150936126709
Epoch: 40, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.582 Vali Acc: 0.885 Test Loss: 0.582 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885179).  Saving model ...
Epoch: 41 cost time: 0.49025893211364746
Epoch: 41, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.542 Vali Acc: 0.885 Test Loss: 0.542 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 42 cost time: 0.43309855461120605
Epoch: 42, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.505 Vali Acc: 0.885 Test Loss: 0.505 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 43 cost time: 0.5480766296386719
Epoch: 43, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 44 cost time: 0.4203662872314453
Epoch: 44, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.3210179805755615
Epoch: 45, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.416 Vali Acc: 0.900 Test Loss: 0.416 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 46 cost time: 0.4978668689727783
Epoch: 46, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.397 Vali Acc: 0.893 Test Loss: 0.397 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4137282371520996
Epoch: 47, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.378 Vali Acc: 0.896 Test Loss: 0.378 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.37328386306762695
Epoch: 48, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.365 Vali Acc: 0.893 Test Loss: 0.365 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4618723392486572
Epoch: 49, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4911494255065918
Epoch: 50, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.347 Vali Acc: 0.885 Test Loss: 0.347 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5651788711547852
Epoch: 51, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.341 Vali Acc: 0.885 Test Loss: 0.341 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.496767520904541
Epoch: 52, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.340 Vali Acc: 0.885 Test Loss: 0.340 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.43639397621154785
Epoch: 53, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.336 Vali Acc: 0.885 Test Loss: 0.336 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.4821627140045166
Epoch: 54, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.5740575790405273
Epoch: 55, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.335 Vali Acc: 0.878 Test Loss: 0.335 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 113898
model size : 0.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.768705129623413
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.788 Vali Acc: 0.252 Test Loss: 1.788 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.6682922840118408
Epoch: 2, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.770 Vali Acc: 0.274 Test Loss: 1.770 Test Acc: 0.274
Validation loss decreased (-0.251834 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.48209381103515625
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.758 Vali Acc: 0.278 Test Loss: 1.758 Test Acc: 0.278
Validation loss decreased (-0.274056 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.49546384811401367
Epoch: 4, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.748 Vali Acc: 0.289 Test Loss: 1.748 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288871).  Saving model ...
Epoch: 5 cost time: 0.5994014739990234
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.735 Vali Acc: 0.296 Test Loss: 1.735 Test Acc: 0.296
Validation loss decreased (-0.288871 --> -0.296279).  Saving model ...
Epoch: 6 cost time: 0.4972093105316162
Epoch: 6, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.720 Vali Acc: 0.315 Test Loss: 1.720 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 7 cost time: 0.46029162406921387
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.702 Vali Acc: 0.326 Test Loss: 1.702 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 0.5180959701538086
Epoch: 8, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.683 Vali Acc: 0.341 Test Loss: 1.683 Test Acc: 0.341
Validation loss decreased (-0.325909 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.47939157485961914
Epoch: 9, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.661 Vali Acc: 0.356 Test Loss: 1.661 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 10 cost time: 0.42990684509277344
Epoch: 10, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.638 Vali Acc: 0.378 Test Loss: 1.638 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377761).  Saving model ...
Epoch: 11 cost time: 0.5101468563079834
Epoch: 11, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.614 Vali Acc: 0.415 Test Loss: 1.614 Test Acc: 0.415
Validation loss decreased (-0.377761 --> -0.414799).  Saving model ...
Epoch: 12 cost time: 0.6526286602020264
Epoch: 12, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.589 Vali Acc: 0.441 Test Loss: 1.589 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440725).  Saving model ...
Epoch: 13 cost time: 0.48224496841430664
Epoch: 13, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.562 Vali Acc: 0.463 Test Loss: 1.562 Test Acc: 0.463
Validation loss decreased (-0.440725 --> -0.462947).  Saving model ...
Epoch: 14 cost time: 0.43873143196105957
Epoch: 14, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.534 Vali Acc: 0.481 Test Loss: 1.534 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481466).  Saving model ...
Epoch: 15 cost time: 0.4042496681213379
Epoch: 15, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.505 Vali Acc: 0.493 Test Loss: 1.505 Test Acc: 0.493
Validation loss decreased (-0.481466 --> -0.492578).  Saving model ...
Epoch: 16 cost time: 0.48468518257141113
Epoch: 16, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.474 Vali Acc: 0.522 Test Loss: 1.474 Test Acc: 0.522
Validation loss decreased (-0.492578 --> -0.522207).  Saving model ...
Epoch: 17 cost time: 0.551936149597168
Epoch: 17, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.443 Vali Acc: 0.567 Test Loss: 1.443 Test Acc: 0.567
Validation loss decreased (-0.522207 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 0.4192008972167969
Epoch: 18, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.410 Vali Acc: 0.581 Test Loss: 1.410 Test Acc: 0.581
Validation loss decreased (-0.566652 --> -0.581467).  Saving model ...
Epoch: 19 cost time: 0.44496870040893555
Epoch: 19, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.376 Vali Acc: 0.600 Test Loss: 1.376 Test Acc: 0.600
Validation loss decreased (-0.581467 --> -0.599986).  Saving model ...
Epoch: 20 cost time: 0.5184323787689209
Epoch: 20, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.340 Vali Acc: 0.626 Test Loss: 1.340 Test Acc: 0.626
Validation loss decreased (-0.599986 --> -0.625913).  Saving model ...
Epoch: 21 cost time: 0.5209167003631592
Epoch: 21, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.303 Vali Acc: 0.641 Test Loss: 1.303 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640728).  Saving model ...
Epoch: 22 cost time: 0.4980781078338623
Epoch: 22, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.264 Vali Acc: 0.681 Test Loss: 1.264 Test Acc: 0.681
Validation loss decreased (-0.640728 --> -0.681469).  Saving model ...
Epoch: 23 cost time: 0.4477367401123047
Epoch: 23, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.224 Vali Acc: 0.726 Test Loss: 1.224 Test Acc: 0.726
Validation loss decreased (-0.681469 --> -0.725914).  Saving model ...
Epoch: 24 cost time: 0.5579161643981934
Epoch: 24, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.182 Vali Acc: 0.752 Test Loss: 1.182 Test Acc: 0.752
Validation loss decreased (-0.725914 --> -0.751840).  Saving model ...
Epoch: 25 cost time: 0.44376111030578613
Epoch: 25, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.139 Vali Acc: 0.770 Test Loss: 1.139 Test Acc: 0.770
Validation loss decreased (-0.751840 --> -0.770359).  Saving model ...
Epoch: 26 cost time: 0.40417051315307617
Epoch: 26, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.093 Vali Acc: 0.800 Test Loss: 1.093 Test Acc: 0.800
Validation loss decreased (-0.770359 --> -0.799989).  Saving model ...
Epoch: 27 cost time: 0.34531140327453613
Epoch: 27, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.046 Vali Acc: 0.811 Test Loss: 1.046 Test Acc: 0.811
Validation loss decreased (-0.799989 --> -0.811101).  Saving model ...
Epoch: 28 cost time: 0.41678881645202637
Epoch: 28, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.996 Vali Acc: 0.826 Test Loss: 0.996 Test Acc: 0.826
Validation loss decreased (-0.811101 --> -0.825916).  Saving model ...
Epoch: 29 cost time: 0.5356500148773193
Epoch: 29, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.945 Vali Acc: 0.841 Test Loss: 0.945 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 30 cost time: 0.4991774559020996
Epoch: 30, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.894 Vali Acc: 0.852 Test Loss: 0.894 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851843).  Saving model ...
Epoch: 31 cost time: 0.4382345676422119
Epoch: 31, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.841 Vali Acc: 0.848 Test Loss: 0.841 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4428584575653076
Epoch: 32, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.788 Vali Acc: 0.867 Test Loss: 0.788 Test Acc: 0.867
Validation loss decreased (-0.851843 --> -0.866659).  Saving model ...
Epoch: 33 cost time: 0.5069253444671631
Epoch: 33, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.735 Vali Acc: 0.870 Test Loss: 0.735 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 34 cost time: 0.42989349365234375
Epoch: 34, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.685 Vali Acc: 0.867 Test Loss: 0.685 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.530036211013794
Epoch: 35, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.637 Vali Acc: 0.867 Test Loss: 0.637 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5352110862731934
Epoch: 36, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.594 Vali Acc: 0.856 Test Loss: 0.594 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.42821526527404785
Epoch: 37, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.556 Vali Acc: 0.852 Test Loss: 0.556 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4792146682739258
Epoch: 38, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.524 Vali Acc: 0.852 Test Loss: 0.524 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.48828625679016113
Epoch: 39, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.500 Vali Acc: 0.852 Test Loss: 0.500 Test Acc: 0.852
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5002281665802002
Epoch: 40, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.482 Vali Acc: 0.848 Test Loss: 0.482 Test Acc: 0.848
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5490338802337646
Epoch: 41, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.471 Vali Acc: 0.826 Test Loss: 0.471 Test Acc: 0.826
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5262553691864014
Epoch: 42, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.465 Vali Acc: 0.837 Test Loss: 0.465 Test Acc: 0.837
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4350419044494629
Epoch: 43, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.464 Vali Acc: 0.841 Test Loss: 0.464 Test Acc: 0.841
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 112701
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7886548042297363
Epoch: 1, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.819 Vali Acc: 0.089 Test Loss: 1.819 Test Acc: 0.089
Validation loss decreased (inf --> -0.088871).  Saving model ...
Epoch: 2 cost time: 0.5125796794891357
Epoch: 2, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.800 Vali Acc: 0.096 Test Loss: 1.800 Test Acc: 0.096
Validation loss decreased (-0.088871 --> -0.096278).  Saving model ...
Epoch: 3 cost time: 0.41855359077453613
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.786 Vali Acc: 0.100 Test Loss: 1.786 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 4 cost time: 0.5374236106872559
Epoch: 4, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.776 Vali Acc: 0.100 Test Loss: 1.776 Test Acc: 0.100
Validation loss decreased (-0.099982 --> -0.099982).  Saving model ...
Epoch: 5 cost time: 0.5088505744934082
Epoch: 5, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.763 Vali Acc: 0.119 Test Loss: 1.763 Test Acc: 0.119
Validation loss decreased (-0.099982 --> -0.118501).  Saving model ...
Epoch: 6 cost time: 0.4750528335571289
Epoch: 6, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.747 Vali Acc: 0.148 Test Loss: 1.747 Test Acc: 0.148
Validation loss decreased (-0.118501 --> -0.148131).  Saving model ...
Epoch: 7 cost time: 0.47285962104797363
Epoch: 7, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.730 Vali Acc: 0.185 Test Loss: 1.730 Test Acc: 0.185
Validation loss decreased (-0.148131 --> -0.185168).  Saving model ...
Epoch: 8 cost time: 0.4501311779022217
Epoch: 8, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.710 Vali Acc: 0.215 Test Loss: 1.710 Test Acc: 0.215
Validation loss decreased (-0.185168 --> -0.214798).  Saving model ...
Epoch: 9 cost time: 0.49240565299987793
Epoch: 9, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.690 Vali Acc: 0.230 Test Loss: 1.690 Test Acc: 0.230
Validation loss decreased (-0.214798 --> -0.229613).  Saving model ...
Epoch: 10 cost time: 0.5587821006774902
Epoch: 10, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.668 Vali Acc: 0.256 Test Loss: 1.668 Test Acc: 0.256
Validation loss decreased (-0.229613 --> -0.255539).  Saving model ...
Epoch: 11 cost time: 0.47461390495300293
Epoch: 11, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.645 Vali Acc: 0.296 Test Loss: 1.645 Test Acc: 0.296
Validation loss decreased (-0.255539 --> -0.296280).  Saving model ...
Epoch: 12 cost time: 0.5870749950408936
Epoch: 12, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.620 Vali Acc: 0.348 Test Loss: 1.620 Test Acc: 0.348
Validation loss decreased (-0.296280 --> -0.348132).  Saving model ...
Epoch: 13 cost time: 0.5031261444091797
Epoch: 13, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.595 Vali Acc: 0.378 Test Loss: 1.595 Test Acc: 0.378
Validation loss decreased (-0.348132 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.433197021484375
Epoch: 14, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.568 Vali Acc: 0.422 Test Loss: 1.568 Test Acc: 0.422
Validation loss decreased (-0.377762 --> -0.422207).  Saving model ...
Epoch: 15 cost time: 0.46445178985595703
Epoch: 15, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.541 Vali Acc: 0.474 Test Loss: 1.541 Test Acc: 0.474
Validation loss decreased (-0.422207 --> -0.474059).  Saving model ...
Epoch: 16 cost time: 0.5663793087005615
Epoch: 16, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.513 Vali Acc: 0.515 Test Loss: 1.513 Test Acc: 0.515
Validation loss decreased (-0.474059 --> -0.514800).  Saving model ...
Epoch: 17 cost time: 0.39552927017211914
Epoch: 17, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.483 Vali Acc: 0.552 Test Loss: 1.483 Test Acc: 0.552
Validation loss decreased (-0.514800 --> -0.551837).  Saving model ...
Epoch: 18 cost time: 0.48726582527160645
Epoch: 18, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.453 Vali Acc: 0.589 Test Loss: 1.453 Test Acc: 0.589
Validation loss decreased (-0.551837 --> -0.588874).  Saving model ...
Epoch: 19 cost time: 0.45022130012512207
Epoch: 19, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.422 Vali Acc: 0.626 Test Loss: 1.422 Test Acc: 0.626
Validation loss decreased (-0.588874 --> -0.625912).  Saving model ...
Epoch: 20 cost time: 0.419327974319458
Epoch: 20, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.391 Vali Acc: 0.648 Test Loss: 1.391 Test Acc: 0.648
Validation loss decreased (-0.625912 --> -0.648134).  Saving model ...
Epoch: 21 cost time: 0.640347957611084
Epoch: 21, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.357 Vali Acc: 0.678 Test Loss: 1.357 Test Acc: 0.678
Validation loss decreased (-0.648134 --> -0.677764).  Saving model ...
Epoch: 22 cost time: 0.5096383094787598
Epoch: 22, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.323 Vali Acc: 0.707 Test Loss: 1.323 Test Acc: 0.707
Validation loss decreased (-0.677764 --> -0.707394).  Saving model ...
Epoch: 23 cost time: 0.42836451530456543
Epoch: 23, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.288 Vali Acc: 0.722 Test Loss: 1.288 Test Acc: 0.722
Validation loss decreased (-0.707394 --> -0.722209).  Saving model ...
Epoch: 24 cost time: 0.474149227142334
Epoch: 24, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.252 Vali Acc: 0.741 Test Loss: 1.252 Test Acc: 0.741
Validation loss decreased (-0.722209 --> -0.740728).  Saving model ...
Epoch: 25 cost time: 0.5053136348724365
Epoch: 25, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.215 Vali Acc: 0.763 Test Loss: 1.215 Test Acc: 0.763
Validation loss decreased (-0.740728 --> -0.762951).  Saving model ...
Epoch: 26 cost time: 0.4020678997039795
Epoch: 26, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.176 Vali Acc: 0.785 Test Loss: 1.176 Test Acc: 0.785
Validation loss decreased (-0.762951 --> -0.785173).  Saving model ...
Epoch: 27 cost time: 0.5666015148162842
Epoch: 27, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.136 Vali Acc: 0.800 Test Loss: 1.136 Test Acc: 0.800
Validation loss decreased (-0.785173 --> -0.799989).  Saving model ...
Epoch: 28 cost time: 0.47984790802001953
Epoch: 28, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.094 Vali Acc: 0.811 Test Loss: 1.094 Test Acc: 0.811
Validation loss decreased (-0.799989 --> -0.811100).  Saving model ...
Epoch: 29 cost time: 0.40739870071411133
Epoch: 29, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.052 Vali Acc: 0.830 Test Loss: 1.052 Test Acc: 0.830
Validation loss decreased (-0.811100 --> -0.829619).  Saving model ...
Epoch: 30 cost time: 0.4837462902069092
Epoch: 30, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.007 Vali Acc: 0.852 Test Loss: 1.007 Test Acc: 0.852
Validation loss decreased (-0.829619 --> -0.851842).  Saving model ...
Epoch: 31 cost time: 0.44788384437561035
Epoch: 31, Steps: 2 | Train Loss: 0.870 Vali Loss: 0.962 Vali Acc: 0.863 Test Loss: 0.962 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 32 cost time: 0.5083916187286377
Epoch: 32, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.915 Vali Acc: 0.867 Test Loss: 0.915 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866658).  Saving model ...
Epoch: 33 cost time: 0.4498460292816162
Epoch: 33, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.868 Vali Acc: 0.859 Test Loss: 0.868 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4833235740661621
Epoch: 34, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.821 Vali Acc: 0.881 Test Loss: 0.821 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881473).  Saving model ...
Epoch: 35 cost time: 0.4657731056213379
Epoch: 35, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.773 Vali Acc: 0.878 Test Loss: 0.773 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5045030117034912
Epoch: 36, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.725 Vali Acc: 0.878 Test Loss: 0.725 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4479653835296631
Epoch: 37, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.678 Vali Acc: 0.874 Test Loss: 0.678 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5714540481567383
Epoch: 38, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.633 Vali Acc: 0.867 Test Loss: 0.633 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.41773295402526855
Epoch: 39, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.589 Vali Acc: 0.878 Test Loss: 0.589 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5289921760559082
Epoch: 40, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.549 Vali Acc: 0.881 Test Loss: 0.549 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881476).  Saving model ...
Epoch: 41 cost time: 0.46892261505126953
Epoch: 41, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.512 Vali Acc: 0.881 Test Loss: 0.512 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 42 cost time: 0.4317648410797119
Epoch: 42, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.479 Vali Acc: 0.881 Test Loss: 0.479 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 43 cost time: 0.48314571380615234
Epoch: 43, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.450 Vali Acc: 0.881 Test Loss: 0.450 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 44 cost time: 0.5899214744567871
Epoch: 44, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.425 Vali Acc: 0.885 Test Loss: 0.425 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 45 cost time: 0.5384769439697266
Epoch: 45, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
Validation loss decreased (-0.885181 --> -0.896292).  Saving model ...
Epoch: 46 cost time: 0.45388031005859375
Epoch: 46, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 0.5564901828765869
Epoch: 47, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.368 Vali Acc: 0.896 Test Loss: 0.368 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5137214660644531
Epoch: 48, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.355 Vali Acc: 0.896 Test Loss: 0.355 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.49054384231567383
Epoch: 49, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 50 cost time: 0.4652278423309326
Epoch: 50, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.336 Vali Acc: 0.893 Test Loss: 0.336 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.495621919631958
Epoch: 51, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.330 Vali Acc: 0.893 Test Loss: 0.330 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.43409061431884766
Epoch: 52, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.324 Vali Acc: 0.889 Test Loss: 0.324 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.627490758895874
Epoch: 53, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.320 Vali Acc: 0.881 Test Loss: 0.320 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5465085506439209
Epoch: 54, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.316 Vali Acc: 0.878 Test Loss: 0.316 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.5584812164306641
Epoch: 55, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.874 Test Loss: 0.315 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.4458186626434326
Epoch: 56, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.313 Vali Acc: 0.874 Test Loss: 0.313 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6034231185913086
Epoch: 57, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.313 Vali Acc: 0.874 Test Loss: 0.313 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.49314308166503906
Epoch: 58, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.313 Vali Acc: 0.874 Test Loss: 0.313 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.48502326011657715
Epoch: 59, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.314 Vali Acc: 0.874 Test Loss: 0.314 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 112280
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7856106758117676
Epoch: 1, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.629 Vali Acc: 0.330 Test Loss: 1.629 Test Acc: 0.330
Validation loss decreased (inf --> -0.329613).  Saving model ...
Epoch: 2 cost time: 0.39815711975097656
Epoch: 2, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.612 Vali Acc: 0.359 Test Loss: 1.612 Test Acc: 0.359
Validation loss decreased (-0.329613 --> -0.359243).  Saving model ...
Epoch: 3 cost time: 0.575599193572998
Epoch: 3, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.598 Vali Acc: 0.370 Test Loss: 1.598 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 4 cost time: 0.5240294933319092
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.585 Vali Acc: 0.389 Test Loss: 1.585 Test Acc: 0.389
Validation loss decreased (-0.370354 --> -0.388873).  Saving model ...
Epoch: 5 cost time: 0.44066762924194336
Epoch: 5, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.569 Vali Acc: 0.415 Test Loss: 1.569 Test Acc: 0.415
Validation loss decreased (-0.388873 --> -0.414799).  Saving model ...
Epoch: 6 cost time: 0.6080732345581055
Epoch: 6, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.550 Vali Acc: 0.463 Test Loss: 1.550 Test Acc: 0.463
Validation loss decreased (-0.414799 --> -0.462947).  Saving model ...
Epoch: 7 cost time: 0.49377989768981934
Epoch: 7, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.529 Vali Acc: 0.481 Test Loss: 1.529 Test Acc: 0.481
Validation loss decreased (-0.462947 --> -0.481466).  Saving model ...
Epoch: 8 cost time: 0.4500546455383301
Epoch: 8, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.505 Vali Acc: 0.530 Test Loss: 1.505 Test Acc: 0.530
Validation loss decreased (-0.481466 --> -0.529615).  Saving model ...
Epoch: 9 cost time: 0.45855140686035156
Epoch: 9, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.479 Vali Acc: 0.574 Test Loss: 1.479 Test Acc: 0.574
Validation loss decreased (-0.529615 --> -0.574059).  Saving model ...
Epoch: 10 cost time: 0.49009203910827637
Epoch: 10, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.452 Vali Acc: 0.637 Test Loss: 1.452 Test Acc: 0.637
Validation loss decreased (-0.574059 --> -0.637023).  Saving model ...
Epoch: 11 cost time: 0.46298766136169434
Epoch: 11, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.424 Vali Acc: 0.663 Test Loss: 1.424 Test Acc: 0.663
Validation loss decreased (-0.637023 --> -0.662949).  Saving model ...
Epoch: 12 cost time: 0.4227933883666992
Epoch: 12, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.393 Vali Acc: 0.693 Test Loss: 1.393 Test Acc: 0.693
Validation loss decreased (-0.662949 --> -0.692579).  Saving model ...
Epoch: 13 cost time: 0.5148911476135254
Epoch: 13, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.362 Vali Acc: 0.726 Test Loss: 1.362 Test Acc: 0.726
Validation loss decreased (-0.692579 --> -0.725912).  Saving model ...
Epoch: 14 cost time: 0.43709707260131836
Epoch: 14, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.328 Vali Acc: 0.748 Test Loss: 1.328 Test Acc: 0.748
Validation loss decreased (-0.725912 --> -0.748135).  Saving model ...
Epoch: 15 cost time: 0.4773547649383545
Epoch: 15, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.294 Vali Acc: 0.770 Test Loss: 1.294 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770357).  Saving model ...
Epoch: 16 cost time: 0.4810912609100342
Epoch: 16, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.258 Vali Acc: 0.789 Test Loss: 1.258 Test Acc: 0.789
Validation loss decreased (-0.770357 --> -0.788876).  Saving model ...
Epoch: 17 cost time: 0.5211429595947266
Epoch: 17, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.220 Vali Acc: 0.800 Test Loss: 1.220 Test Acc: 0.800
Validation loss decreased (-0.788876 --> -0.799988).  Saving model ...
Epoch: 18 cost time: 0.449962854385376
Epoch: 18, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.181 Vali Acc: 0.811 Test Loss: 1.181 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811099).  Saving model ...
Epoch: 19 cost time: 0.4219248294830322
Epoch: 19, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.140 Vali Acc: 0.826 Test Loss: 1.140 Test Acc: 0.826
Validation loss decreased (-0.811099 --> -0.825915).  Saving model ...
Epoch: 20 cost time: 0.3844609260559082
Epoch: 20, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.098 Vali Acc: 0.837 Test Loss: 1.098 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837026).  Saving model ...
Epoch: 21 cost time: 0.5330336093902588
Epoch: 21, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.054 Vali Acc: 0.848 Test Loss: 1.054 Test Acc: 0.848
Validation loss decreased (-0.837026 --> -0.848138).  Saving model ...
Epoch: 22 cost time: 0.4697730541229248
Epoch: 22, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.009 Vali Acc: 0.844 Test Loss: 1.009 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.3995039463043213
Epoch: 23, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.963 Vali Acc: 0.852 Test Loss: 0.963 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 24 cost time: 0.5656673908233643
Epoch: 24, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.915 Vali Acc: 0.852 Test Loss: 0.915 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 25 cost time: 0.3692512512207031
Epoch: 25, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.865 Vali Acc: 0.859 Test Loss: 0.865 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
Epoch: 26 cost time: 0.4382445812225342
Epoch: 26, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.816 Vali Acc: 0.863 Test Loss: 0.816 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 27 cost time: 0.5323028564453125
Epoch: 27, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.766 Vali Acc: 0.867 Test Loss: 0.766 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 28 cost time: 0.438992977142334
Epoch: 28, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.716 Vali Acc: 0.870 Test Loss: 0.716 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 29 cost time: 0.5181174278259277
Epoch: 29, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.668 Vali Acc: 0.878 Test Loss: 0.668 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 30 cost time: 0.46779513359069824
Epoch: 30, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.621 Vali Acc: 0.885 Test Loss: 0.621 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 31 cost time: 0.4201834201812744
Epoch: 31, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.576 Vali Acc: 0.881 Test Loss: 0.576 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4286990165710449
Epoch: 32, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.536 Vali Acc: 0.881 Test Loss: 0.536 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.3975040912628174
Epoch: 33, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.499 Vali Acc: 0.874 Test Loss: 0.499 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6228311061859131
Epoch: 34, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.464 Vali Acc: 0.881 Test Loss: 0.464 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.4618675708770752
Epoch: 35, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.433 Vali Acc: 0.885 Test Loss: 0.433 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885181).  Saving model ...
Epoch: 36 cost time: 0.4690365791320801
Epoch: 36, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 37 cost time: 0.46962499618530273
Epoch: 37, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.379 Vali Acc: 0.896 Test Loss: 0.379 Test Acc: 0.896
Validation loss decreased (-0.888885 --> -0.896293).  Saving model ...
Epoch: 38 cost time: 0.45302319526672363
Epoch: 38, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.357 Vali Acc: 0.900 Test Loss: 0.357 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899996).  Saving model ...
Epoch: 39 cost time: 0.4661550521850586
Epoch: 39, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.337 Vali Acc: 0.900 Test Loss: 0.337 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 40 cost time: 0.646355390548706
Epoch: 40, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 41 cost time: 0.4723820686340332
Epoch: 41, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.306 Vali Acc: 0.907 Test Loss: 0.306 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 42 cost time: 0.5916926860809326
Epoch: 42, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 43 cost time: 0.47220802307128906
Epoch: 43, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.4997875690460205
Epoch: 44, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4704306125640869
Epoch: 45, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 46 cost time: 0.4413027763366699
Epoch: 46, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 47 cost time: 0.45317697525024414
Epoch: 47, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 48 cost time: 0.3980114459991455
Epoch: 48, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 0.44576263427734375
Epoch: 49, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.493927001953125
Epoch: 50, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.667034387588501
Epoch: 51, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5290782451629639
Epoch: 52, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5169510841369629
Epoch: 53, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.47320079803466797
Epoch: 54, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.485410213470459
Epoch: 55, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.45226216316223145
Epoch: 56, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.249 Vali Acc: 0.919 Test Loss: 0.249 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.4964876174926758
Epoch: 57, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4841744899749756
Epoch: 58, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.3719515800476074
Epoch: 59, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5358610153198242
Epoch: 60, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.919 Test Loss: 0.255 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 112314
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6895487308502197
Epoch: 1, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.814 Vali Acc: 0.178 Test Loss: 1.814 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.5273005962371826
Epoch: 2, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.797 Vali Acc: 0.200 Test Loss: 1.797 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.4801292419433594
Epoch: 3, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.785 Vali Acc: 0.207 Test Loss: 1.785 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.48871707916259766
Epoch: 4, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.775 Vali Acc: 0.226 Test Loss: 1.775 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.4650735855102539
Epoch: 5, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.762 Vali Acc: 0.252 Test Loss: 1.762 Test Acc: 0.252
Validation loss decreased (-0.225908 --> -0.251834).  Saving model ...
Epoch: 6 cost time: 0.46518874168395996
Epoch: 6, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.747 Vali Acc: 0.263 Test Loss: 1.747 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262945).  Saving model ...
Epoch: 7 cost time: 0.43888115882873535
Epoch: 7, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.729 Vali Acc: 0.304 Test Loss: 1.729 Test Acc: 0.304
Validation loss decreased (-0.262945 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 0.49158382415771484
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.710 Vali Acc: 0.333 Test Loss: 1.710 Test Acc: 0.333
Validation loss decreased (-0.303686 --> -0.333316).  Saving model ...
Epoch: 9 cost time: 0.45046019554138184
Epoch: 9, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.689 Vali Acc: 0.356 Test Loss: 1.689 Test Acc: 0.356
Validation loss decreased (-0.333316 --> -0.355539).  Saving model ...
Epoch: 10 cost time: 0.446474552154541
Epoch: 10, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.668 Vali Acc: 0.381 Test Loss: 1.668 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 0.46959996223449707
Epoch: 11, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.645 Vali Acc: 0.400 Test Loss: 1.645 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.4214439392089844
Epoch: 12, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.621 Vali Acc: 0.415 Test Loss: 1.621 Test Acc: 0.415
Validation loss decreased (-0.399984 --> -0.414799).  Saving model ...
Epoch: 13 cost time: 0.31603169441223145
Epoch: 13, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.596 Vali Acc: 0.430 Test Loss: 1.596 Test Acc: 0.430
Validation loss decreased (-0.414799 --> -0.429614).  Saving model ...
Epoch: 14 cost time: 0.3771519660949707
Epoch: 14, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.570 Vali Acc: 0.456 Test Loss: 1.570 Test Acc: 0.456
Validation loss decreased (-0.429614 --> -0.455540).  Saving model ...
Epoch: 15 cost time: 0.3830687999725342
Epoch: 15, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.544 Vali Acc: 0.470 Test Loss: 1.544 Test Acc: 0.470
Validation loss decreased (-0.455540 --> -0.470355).  Saving model ...
Epoch: 16 cost time: 0.40300607681274414
Epoch: 16, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.517 Vali Acc: 0.481 Test Loss: 1.517 Test Acc: 0.481
Validation loss decreased (-0.470355 --> -0.481466).  Saving model ...
Epoch: 17 cost time: 0.4277966022491455
Epoch: 17, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.488 Vali Acc: 0.511 Test Loss: 1.488 Test Acc: 0.511
Validation loss decreased (-0.481466 --> -0.511096).  Saving model ...
Epoch: 18 cost time: 0.4356687068939209
Epoch: 18, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.460 Vali Acc: 0.519 Test Loss: 1.460 Test Acc: 0.519
Validation loss decreased (-0.511096 --> -0.518504).  Saving model ...
Epoch: 19 cost time: 0.5389986038208008
Epoch: 19, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.430 Vali Acc: 0.544 Test Loss: 1.430 Test Acc: 0.544
Validation loss decreased (-0.518504 --> -0.544430).  Saving model ...
Epoch: 20 cost time: 0.46845102310180664
Epoch: 20, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.400 Vali Acc: 0.559 Test Loss: 1.400 Test Acc: 0.559
Validation loss decreased (-0.544430 --> -0.559245).  Saving model ...
Epoch: 21 cost time: 0.38750576972961426
Epoch: 21, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.368 Vali Acc: 0.574 Test Loss: 1.368 Test Acc: 0.574
Validation loss decreased (-0.559245 --> -0.574060).  Saving model ...
Epoch: 22 cost time: 0.443284273147583
Epoch: 22, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.336 Vali Acc: 0.581 Test Loss: 1.336 Test Acc: 0.581
Validation loss decreased (-0.574060 --> -0.581468).  Saving model ...
Epoch: 23 cost time: 0.5749449729919434
Epoch: 23, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.302 Vali Acc: 0.596 Test Loss: 1.302 Test Acc: 0.596
Validation loss decreased (-0.581468 --> -0.596283).  Saving model ...
Epoch: 24 cost time: 0.6999752521514893
Epoch: 24, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.267 Vali Acc: 0.604 Test Loss: 1.267 Test Acc: 0.604
Validation loss decreased (-0.596283 --> -0.603691).  Saving model ...
Epoch: 25 cost time: 0.4841732978820801
Epoch: 25, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.231 Vali Acc: 0.622 Test Loss: 1.231 Test Acc: 0.622
Validation loss decreased (-0.603691 --> -0.622210).  Saving model ...
Epoch: 26 cost time: 0.4455537796020508
Epoch: 26, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.193 Vali Acc: 0.644 Test Loss: 1.193 Test Acc: 0.644
Validation loss decreased (-0.622210 --> -0.644433).  Saving model ...
Epoch: 27 cost time: 0.41877055168151855
Epoch: 27, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.154 Vali Acc: 0.659 Test Loss: 1.154 Test Acc: 0.659
Validation loss decreased (-0.644433 --> -0.659248).  Saving model ...
Epoch: 28 cost time: 0.48300838470458984
Epoch: 28, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.113 Vali Acc: 0.681 Test Loss: 1.113 Test Acc: 0.681
Validation loss decreased (-0.659248 --> -0.681470).  Saving model ...
Epoch: 29 cost time: 0.4526510238647461
Epoch: 29, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.070 Vali Acc: 0.693 Test Loss: 1.070 Test Acc: 0.693
Validation loss decreased (-0.681470 --> -0.692582).  Saving model ...
Epoch: 30 cost time: 0.5213994979858398
Epoch: 30, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.026 Vali Acc: 0.719 Test Loss: 1.026 Test Acc: 0.719
Validation loss decreased (-0.692582 --> -0.718508).  Saving model ...
Epoch: 31 cost time: 0.46172642707824707
Epoch: 31, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.979 Vali Acc: 0.737 Test Loss: 0.979 Test Acc: 0.737
Validation loss decreased (-0.718508 --> -0.737027).  Saving model ...
Epoch: 32 cost time: 0.42022156715393066
Epoch: 32, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.931 Vali Acc: 0.756 Test Loss: 0.931 Test Acc: 0.756
Validation loss decreased (-0.737027 --> -0.755546).  Saving model ...
Epoch: 33 cost time: 0.42672109603881836
Epoch: 33, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.882 Vali Acc: 0.767 Test Loss: 0.882 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 34 cost time: 0.46370601654052734
Epoch: 34, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.831 Vali Acc: 0.770 Test Loss: 0.831 Test Acc: 0.770
Validation loss decreased (-0.766658 --> -0.770362).  Saving model ...
Epoch: 35 cost time: 0.4979686737060547
Epoch: 35, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.781 Vali Acc: 0.807 Test Loss: 0.781 Test Acc: 0.807
Validation loss decreased (-0.770362 --> -0.807400).  Saving model ...
Epoch: 36 cost time: 0.5156865119934082
Epoch: 36, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.807400 --> -0.822215).  Saving model ...
Epoch: 37 cost time: 0.5113942623138428
Epoch: 37, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.684 Vali Acc: 0.830 Test Loss: 0.684 Test Acc: 0.830
Validation loss decreased (-0.822215 --> -0.829623).  Saving model ...
Epoch: 38 cost time: 0.5011937618255615
Epoch: 38, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.638 Vali Acc: 0.841 Test Loss: 0.638 Test Acc: 0.841
Validation loss decreased (-0.829623 --> -0.840734).  Saving model ...
Epoch: 39 cost time: 0.6087210178375244
Epoch: 39, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.596 Vali Acc: 0.841 Test Loss: 0.596 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840735).  Saving model ...
Epoch: 40 cost time: 0.5344648361206055
Epoch: 40, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.560 Vali Acc: 0.852 Test Loss: 0.560 Test Acc: 0.852
Validation loss decreased (-0.840735 --> -0.851846).  Saving model ...
Epoch: 41 cost time: 0.4174158573150635
Epoch: 41, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.530 Vali Acc: 0.848 Test Loss: 0.530 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5679221153259277
Epoch: 42, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.507 Vali Acc: 0.848 Test Loss: 0.507 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.4200918674468994
Epoch: 43, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.490 Vali Acc: 0.848 Test Loss: 0.490 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.40888214111328125
Epoch: 44, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.479 Vali Acc: 0.852 Test Loss: 0.479 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851847).  Saving model ...
Epoch: 45 cost time: 0.5474932193756104
Epoch: 45, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.475 Vali Acc: 0.844 Test Loss: 0.475 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4337000846862793
Epoch: 46, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.475 Vali Acc: 0.841 Test Loss: 0.475 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.45999813079833984
Epoch: 47, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.478 Vali Acc: 0.837 Test Loss: 0.478 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.503687858581543
Epoch: 48, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.483 Vali Acc: 0.837 Test Loss: 0.483 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5511951446533203
Epoch: 49, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.491 Vali Acc: 0.837 Test Loss: 0.491 Test Acc: 0.837
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5817630290985107
Epoch: 50, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.500 Vali Acc: 0.837 Test Loss: 0.500 Test Acc: 0.837
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6548261642456055
Epoch: 51, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.841 Test Loss: 0.509 Test Acc: 0.841
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.40726423263549805
Epoch: 52, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.520 Vali Acc: 0.837 Test Loss: 0.520 Test Acc: 0.837
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.44104433059692383
Epoch: 53, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.529 Vali Acc: 0.837 Test Loss: 0.529 Test Acc: 0.837
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.4498000144958496
Epoch: 54, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.538 Vali Acc: 0.833 Test Loss: 0.538 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 112222
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7319321632385254
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.872 Vali Acc: 0.181 Test Loss: 1.872 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.4524555206298828
Epoch: 2, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.852 Vali Acc: 0.200 Test Loss: 1.852 Test Acc: 0.200
Validation loss decreased (-0.181463 --> -0.199981).  Saving model ...
Epoch: 3 cost time: 0.5214273929595947
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.838 Vali Acc: 0.211 Test Loss: 1.838 Test Acc: 0.211
Validation loss decreased (-0.199981 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.38611292839050293
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.826 Vali Acc: 0.222 Test Loss: 1.826 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 5 cost time: 0.4759352207183838
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.812 Vali Acc: 0.233 Test Loss: 1.812 Test Acc: 0.233
Validation loss decreased (-0.222204 --> -0.233315).  Saving model ...
Epoch: 6 cost time: 0.44658923149108887
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.795 Vali Acc: 0.248 Test Loss: 1.795 Test Acc: 0.248
Validation loss decreased (-0.233315 --> -0.248130).  Saving model ...
Epoch: 7 cost time: 0.53440260887146
Epoch: 7, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.776 Vali Acc: 0.252 Test Loss: 1.776 Test Acc: 0.252
Validation loss decreased (-0.248130 --> -0.251834).  Saving model ...
Epoch: 8 cost time: 0.4897465705871582
Epoch: 8, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.754 Vali Acc: 0.263 Test Loss: 1.754 Test Acc: 0.263
Validation loss decreased (-0.251834 --> -0.262945).  Saving model ...
Epoch: 9 cost time: 0.5169656276702881
Epoch: 9, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.731 Vali Acc: 0.281 Test Loss: 1.731 Test Acc: 0.281
Validation loss decreased (-0.262945 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.5253396034240723
Epoch: 10, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.707 Vali Acc: 0.311 Test Loss: 1.707 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 11 cost time: 0.5049934387207031
Epoch: 11, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.681 Vali Acc: 0.356 Test Loss: 1.681 Test Acc: 0.356
Validation loss decreased (-0.311094 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.5083339214324951
Epoch: 12, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.654 Vali Acc: 0.381 Test Loss: 1.654 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 13 cost time: 0.4605073928833008
Epoch: 13, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.626 Vali Acc: 0.415 Test Loss: 1.626 Test Acc: 0.415
Validation loss decreased (-0.381465 --> -0.414799).  Saving model ...
Epoch: 14 cost time: 0.45416712760925293
Epoch: 14, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.597 Vali Acc: 0.467 Test Loss: 1.597 Test Acc: 0.467
Validation loss decreased (-0.414799 --> -0.466651).  Saving model ...
Epoch: 15 cost time: 0.6295623779296875
Epoch: 15, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.566 Vali Acc: 0.511 Test Loss: 1.566 Test Acc: 0.511
Validation loss decreased (-0.466651 --> -0.511095).  Saving model ...
Epoch: 16 cost time: 0.5561094284057617
Epoch: 16, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.535 Vali Acc: 0.541 Test Loss: 1.535 Test Acc: 0.541
Validation loss decreased (-0.511095 --> -0.540725).  Saving model ...
Epoch: 17 cost time: 0.46828222274780273
Epoch: 17, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.502 Vali Acc: 0.585 Test Loss: 1.502 Test Acc: 0.585
Validation loss decreased (-0.540725 --> -0.585170).  Saving model ...
Epoch: 18 cost time: 0.48451924324035645
Epoch: 18, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.468 Vali Acc: 0.611 Test Loss: 1.468 Test Acc: 0.611
Validation loss decreased (-0.585170 --> -0.611096).  Saving model ...
Epoch: 19 cost time: 0.7055521011352539
Epoch: 19, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.433 Vali Acc: 0.663 Test Loss: 1.433 Test Acc: 0.663
Validation loss decreased (-0.611096 --> -0.662949).  Saving model ...
Epoch: 20 cost time: 0.47232985496520996
Epoch: 20, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.397 Vali Acc: 0.693 Test Loss: 1.397 Test Acc: 0.693
Validation loss decreased (-0.662949 --> -0.692579).  Saving model ...
Epoch: 21 cost time: 0.5460121631622314
Epoch: 21, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.359 Vali Acc: 0.733 Test Loss: 1.359 Test Acc: 0.733
Validation loss decreased (-0.692579 --> -0.733320).  Saving model ...
Epoch: 22 cost time: 0.4741673469543457
Epoch: 22, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.320 Vali Acc: 0.756 Test Loss: 1.320 Test Acc: 0.756
Validation loss decreased (-0.733320 --> -0.755542).  Saving model ...
Epoch: 23 cost time: 0.41879773139953613
Epoch: 23, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.280 Vali Acc: 0.774 Test Loss: 1.280 Test Acc: 0.774
Validation loss decreased (-0.755542 --> -0.774061).  Saving model ...
Epoch: 24 cost time: 0.5092582702636719
Epoch: 24, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.237 Vali Acc: 0.793 Test Loss: 1.237 Test Acc: 0.793
Validation loss decreased (-0.774061 --> -0.792580).  Saving model ...
Epoch: 25 cost time: 0.4866483211517334
Epoch: 25, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.194 Vali Acc: 0.819 Test Loss: 1.194 Test Acc: 0.819
Validation loss decreased (-0.792580 --> -0.818507).  Saving model ...
Epoch: 26 cost time: 0.4853644371032715
Epoch: 26, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.148 Vali Acc: 0.830 Test Loss: 1.148 Test Acc: 0.830
Validation loss decreased (-0.818507 --> -0.829618).  Saving model ...
Epoch: 27 cost time: 0.5341119766235352
Epoch: 27, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.101 Vali Acc: 0.841 Test Loss: 1.101 Test Acc: 0.841
Validation loss decreased (-0.829618 --> -0.840730).  Saving model ...
Epoch: 28 cost time: 0.4341390132904053
Epoch: 28, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.053 Vali Acc: 0.837 Test Loss: 1.053 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5899820327758789
Epoch: 29, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.003 Vali Acc: 0.852 Test Loss: 1.003 Test Acc: 0.852
Validation loss decreased (-0.840730 --> -0.851842).  Saving model ...
Epoch: 30 cost time: 0.521477460861206
Epoch: 30, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.952 Vali Acc: 0.863 Test Loss: 0.952 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 31 cost time: 0.45484423637390137
Epoch: 31, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.900 Vali Acc: 0.874 Test Loss: 0.900 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 32 cost time: 0.4796426296234131
Epoch: 32, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.849 Vali Acc: 0.881 Test Loss: 0.849 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 33 cost time: 0.6289277076721191
Epoch: 33, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.799 Vali Acc: 0.881 Test Loss: 0.799 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 34 cost time: 0.5330014228820801
Epoch: 34, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.750 Vali Acc: 0.885 Test Loss: 0.750 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885178).  Saving model ...
Epoch: 35 cost time: 0.5348587036132812
Epoch: 35, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.701 Vali Acc: 0.889 Test Loss: 0.701 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 36 cost time: 0.5691211223602295
Epoch: 36, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.655 Vali Acc: 0.889 Test Loss: 0.655 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 37 cost time: 0.5485432147979736
Epoch: 37, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.611 Vali Acc: 0.896 Test Loss: 0.611 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 38 cost time: 0.5219807624816895
Epoch: 38, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.570 Vali Acc: 0.896 Test Loss: 0.570 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 39 cost time: 0.4793264865875244
Epoch: 39, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.532 Vali Acc: 0.885 Test Loss: 0.532 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5012912750244141
Epoch: 40, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.496 Vali Acc: 0.889 Test Loss: 0.496 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6295859813690186
Epoch: 41, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5333096981048584
Epoch: 42, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.432 Vali Acc: 0.885 Test Loss: 0.432 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5423741340637207
Epoch: 43, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 44 cost time: 0.41791796684265137
Epoch: 44, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 45 cost time: 0.4379611015319824
Epoch: 45, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.355 Vali Acc: 0.896 Test Loss: 0.355 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.455974817276001
Epoch: 46, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.334 Vali Acc: 0.900 Test Loss: 0.334 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 47 cost time: 0.47446393966674805
Epoch: 47, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.315 Vali Acc: 0.904 Test Loss: 0.315 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 48 cost time: 0.5241372585296631
Epoch: 48, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.501272439956665
Epoch: 49, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 50 cost time: 0.5138683319091797
Epoch: 50, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.270 Vali Acc: 0.904 Test Loss: 0.270 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 51 cost time: 0.5355677604675293
Epoch: 51, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.259 Vali Acc: 0.907 Test Loss: 0.259 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 52 cost time: 0.5634088516235352
Epoch: 52, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.249 Vali Acc: 0.907 Test Loss: 0.249 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 53 cost time: 0.48086118698120117
Epoch: 53, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.242 Vali Acc: 0.907 Test Loss: 0.242 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 54 cost time: 0.5081627368927002
Epoch: 54, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.239 Vali Acc: 0.904 Test Loss: 0.239 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5672686100006104
Epoch: 55, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 56 cost time: 0.5274453163146973
Epoch: 56, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.234 Vali Acc: 0.907 Test Loss: 0.234 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 57 cost time: 0.5174415111541748
Epoch: 57, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.911 Test Loss: 0.232 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 58 cost time: 0.49757981300354004
Epoch: 58, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.231 Vali Acc: 0.907 Test Loss: 0.231 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5162043571472168
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.907 Test Loss: 0.230 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5050218105316162
Epoch: 60, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.907 Test Loss: 0.229 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.6088571548461914
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.907 Test Loss: 0.227 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.4326028823852539
Epoch: 62, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.907 Test Loss: 0.228 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5064330101013184
Epoch: 63, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.226 Vali Acc: 0.907 Test Loss: 0.226 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.42499732971191406
Epoch: 64, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914813).  Saving model ...
Epoch: 65 cost time: 0.39108777046203613
Epoch: 65, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918516).  Saving model ...
Epoch: 66 cost time: 0.4905662536621094
Epoch: 66, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5008845329284668
Epoch: 67, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.45893335342407227
Epoch: 68, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 69 cost time: 0.5281391143798828
Epoch: 69, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 70 cost time: 0.48193788528442383
Epoch: 70, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 71 cost time: 0.5057368278503418
Epoch: 71, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.4840066432952881
Epoch: 72, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.4820847511291504
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.5803539752960205
Epoch: 74, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.5141274929046631
Epoch: 75, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.44461488723754883
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.5055999755859375
Epoch: 77, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.4424581527709961
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.5340173244476318
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 0.5724520683288574
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 112004
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.464453935623169
Epoch: 1, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.610 Vali Acc: 0.322 Test Loss: 1.610 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 0.40987372398376465
Epoch: 2, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.596 Vali Acc: 0.330 Test Loss: 1.596 Test Acc: 0.330
Validation loss decreased (-0.322206 --> -0.329614).  Saving model ...
Epoch: 3 cost time: 0.6056101322174072
Epoch: 3, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.585 Vali Acc: 0.341 Test Loss: 1.585 Test Acc: 0.341
Validation loss decreased (-0.329614 --> -0.340725).  Saving model ...
Epoch: 4 cost time: 0.5464248657226562
Epoch: 4, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.576 Vali Acc: 0.367 Test Loss: 1.576 Test Acc: 0.367
Validation loss decreased (-0.340725 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.6089954376220703
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.565 Vali Acc: 0.378 Test Loss: 1.565 Test Acc: 0.378
Validation loss decreased (-0.366651 --> -0.377762).  Saving model ...
Epoch: 6 cost time: 0.5035276412963867
Epoch: 6, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.551 Vali Acc: 0.404 Test Loss: 1.551 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 7 cost time: 0.4278695583343506
Epoch: 7, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.535 Vali Acc: 0.415 Test Loss: 1.535 Test Acc: 0.415
Validation loss decreased (-0.403688 --> -0.414799).  Saving model ...
Epoch: 8 cost time: 0.34738683700561523
Epoch: 8, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.518 Vali Acc: 0.441 Test Loss: 1.518 Test Acc: 0.441
Validation loss decreased (-0.414799 --> -0.440726).  Saving model ...
Epoch: 9 cost time: 0.4992544651031494
Epoch: 9, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.499 Vali Acc: 0.500 Test Loss: 1.499 Test Acc: 0.500
Validation loss decreased (-0.440726 --> -0.499985).  Saving model ...
Epoch: 10 cost time: 0.4381704330444336
Epoch: 10, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.479 Vali Acc: 0.515 Test Loss: 1.479 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 11 cost time: 0.6119110584259033
Epoch: 11, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.458 Vali Acc: 0.559 Test Loss: 1.458 Test Acc: 0.559
Validation loss decreased (-0.514800 --> -0.559245).  Saving model ...
Epoch: 12 cost time: 0.41036486625671387
Epoch: 12, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 13 cost time: 0.47460126876831055
Epoch: 13, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.412 Vali Acc: 0.622 Test Loss: 1.412 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622208).  Saving model ...
Epoch: 14 cost time: 0.4724111557006836
Epoch: 14, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.388 Vali Acc: 0.644 Test Loss: 1.388 Test Acc: 0.644
Validation loss decreased (-0.622208 --> -0.644431).  Saving model ...
Epoch: 15 cost time: 0.4972560405731201
Epoch: 15, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.363 Vali Acc: 0.670 Test Loss: 1.363 Test Acc: 0.670
Validation loss decreased (-0.644431 --> -0.670357).  Saving model ...
Epoch: 16 cost time: 0.46463704109191895
Epoch: 16, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.337 Vali Acc: 0.674 Test Loss: 1.337 Test Acc: 0.674
Validation loss decreased (-0.670357 --> -0.674061).  Saving model ...
Epoch: 17 cost time: 0.437178373336792
Epoch: 17, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.310 Vali Acc: 0.693 Test Loss: 1.310 Test Acc: 0.693
Validation loss decreased (-0.674061 --> -0.692579).  Saving model ...
Epoch: 18 cost time: 0.513200044631958
Epoch: 18, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.283 Vali Acc: 0.704 Test Loss: 1.283 Test Acc: 0.704
Validation loss decreased (-0.692579 --> -0.703691).  Saving model ...
Epoch: 19 cost time: 0.4921863079071045
Epoch: 19, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.255 Vali Acc: 0.726 Test Loss: 1.255 Test Acc: 0.726
Validation loss decreased (-0.703691 --> -0.725913).  Saving model ...
Epoch: 20 cost time: 0.4580235481262207
Epoch: 20, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.226 Vali Acc: 0.744 Test Loss: 1.226 Test Acc: 0.744
Validation loss decreased (-0.725913 --> -0.744432).  Saving model ...
Epoch: 21 cost time: 0.5084705352783203
Epoch: 21, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.197 Vali Acc: 0.748 Test Loss: 1.197 Test Acc: 0.748
Validation loss decreased (-0.744432 --> -0.748136).  Saving model ...
Epoch: 22 cost time: 0.4934999942779541
Epoch: 22, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.167 Vali Acc: 0.756 Test Loss: 1.167 Test Acc: 0.756
Validation loss decreased (-0.748136 --> -0.755544).  Saving model ...
Epoch: 23 cost time: 0.4635286331176758
Epoch: 23, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.136 Vali Acc: 0.763 Test Loss: 1.136 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 24 cost time: 0.46268272399902344
Epoch: 24, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.104 Vali Acc: 0.767 Test Loss: 1.104 Test Acc: 0.767
Validation loss decreased (-0.762952 --> -0.766656).  Saving model ...
Epoch: 25 cost time: 0.6072299480438232
Epoch: 25, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.071 Vali Acc: 0.770 Test Loss: 1.071 Test Acc: 0.770
Validation loss decreased (-0.766656 --> -0.770360).  Saving model ...
Epoch: 26 cost time: 0.47058939933776855
Epoch: 26, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.037 Vali Acc: 0.756 Test Loss: 1.037 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5794172286987305
Epoch: 27, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.002 Vali Acc: 0.770 Test Loss: 1.002 Test Acc: 0.770
Validation loss decreased (-0.770360 --> -0.770360).  Saving model ...
Epoch: 28 cost time: 0.46062207221984863
Epoch: 28, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.966 Vali Acc: 0.785 Test Loss: 0.966 Test Acc: 0.785
Validation loss decreased (-0.770360 --> -0.785176).  Saving model ...
Epoch: 29 cost time: 0.47014474868774414
Epoch: 29, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.929 Vali Acc: 0.789 Test Loss: 0.929 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 30 cost time: 0.6009070873260498
Epoch: 30, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.891 Vali Acc: 0.793 Test Loss: 0.891 Test Acc: 0.793
Validation loss decreased (-0.788880 --> -0.792584).  Saving model ...
Epoch: 31 cost time: 0.3855106830596924
Epoch: 31, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.852 Vali Acc: 0.800 Test Loss: 0.852 Test Acc: 0.800
Validation loss decreased (-0.792584 --> -0.799991).  Saving model ...
Epoch: 32 cost time: 0.527174711227417
Epoch: 32, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.813 Vali Acc: 0.811 Test Loss: 0.813 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 33 cost time: 0.4492979049682617
Epoch: 33, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.773 Vali Acc: 0.815 Test Loss: 0.773 Test Acc: 0.815
Validation loss decreased (-0.811103 --> -0.814807).  Saving model ...
Epoch: 34 cost time: 0.3562171459197998
Epoch: 34, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.732 Vali Acc: 0.822 Test Loss: 0.732 Test Acc: 0.822
Validation loss decreased (-0.814807 --> -0.822215).  Saving model ...
Epoch: 35 cost time: 0.47887516021728516
Epoch: 35, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833326).  Saving model ...
Epoch: 36 cost time: 0.5712785720825195
Epoch: 36, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.653 Vali Acc: 0.841 Test Loss: 0.653 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840734).  Saving model ...
Epoch: 37 cost time: 0.4331068992614746
Epoch: 37, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.615 Vali Acc: 0.837 Test Loss: 0.615 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4313962459564209
Epoch: 38, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.580 Vali Acc: 0.841 Test Loss: 0.580 Test Acc: 0.841
Validation loss decreased (-0.840734 --> -0.840735).  Saving model ...
Epoch: 39 cost time: 0.41582345962524414
Epoch: 39, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 40 cost time: 0.38559722900390625
Epoch: 40, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.516 Vali Acc: 0.848 Test Loss: 0.516 Test Acc: 0.848
Validation loss decreased (-0.844439 --> -0.848143).  Saving model ...
Epoch: 41 cost time: 0.5500710010528564
Epoch: 41, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.487 Vali Acc: 0.848 Test Loss: 0.487 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 42 cost time: 0.4309232234954834
Epoch: 42, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.461 Vali Acc: 0.856 Test Loss: 0.461 Test Acc: 0.856
Validation loss decreased (-0.848143 --> -0.855551).  Saving model ...
Epoch: 43 cost time: 0.44014668464660645
Epoch: 43, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.435 Vali Acc: 0.863 Test Loss: 0.435 Test Acc: 0.863
Validation loss decreased (-0.855551 --> -0.862959).  Saving model ...
Epoch: 44 cost time: 0.3929479122161865
Epoch: 44, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
Validation loss decreased (-0.862959 --> -0.866663).  Saving model ...
Epoch: 45 cost time: 0.5297160148620605
Epoch: 45, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.394 Vali Acc: 0.878 Test Loss: 0.394 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877774).  Saving model ...
Epoch: 46 cost time: 0.4289431571960449
Epoch: 46, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.378 Vali Acc: 0.881 Test Loss: 0.378 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 47 cost time: 0.5375568866729736
Epoch: 47, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.364 Vali Acc: 0.881 Test Loss: 0.364 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 48 cost time: 0.49286389350891113
Epoch: 48, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.357 Vali Acc: 0.885 Test Loss: 0.357 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 49 cost time: 0.45201611518859863
Epoch: 49, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5019705295562744
Epoch: 50, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.346 Vali Acc: 0.885 Test Loss: 0.346 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 51 cost time: 0.47581934928894043
Epoch: 51, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.342 Vali Acc: 0.889 Test Loss: 0.342 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888885).  Saving model ...
Epoch: 52 cost time: 0.5121669769287109
Epoch: 52, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.339 Vali Acc: 0.889 Test Loss: 0.339 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 53 cost time: 0.5015201568603516
Epoch: 53, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.337 Vali Acc: 0.889 Test Loss: 0.337 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 54 cost time: 0.5006744861602783
Epoch: 54, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.340 Vali Acc: 0.885 Test Loss: 0.340 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5518298149108887
Epoch: 55, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.343 Vali Acc: 0.885 Test Loss: 0.343 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5234167575836182
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.347 Vali Acc: 0.885 Test Loss: 0.347 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.48981380462646484
Epoch: 57, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.354 Vali Acc: 0.881 Test Loss: 0.354 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.4718925952911377
Epoch: 58, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.362 Vali Acc: 0.885 Test Loss: 0.362 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.4472639560699463
Epoch: 59, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.370 Vali Acc: 0.885 Test Loss: 0.370 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.42632102966308594
Epoch: 60, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.377 Vali Acc: 0.885 Test Loss: 0.377 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.3909878730773926
Epoch: 61, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.381 Vali Acc: 0.885 Test Loss: 0.381 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.3851146697998047
Epoch: 62, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.386 Vali Acc: 0.881 Test Loss: 0.386 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.4657297134399414
Epoch: 63, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.390 Vali Acc: 0.885 Test Loss: 0.390 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 111660
model size : 0.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5360519886016846
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.798 Vali Acc: 0.181 Test Loss: 1.798 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.47266507148742676
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.780 Vali Acc: 0.189 Test Loss: 1.780 Test Acc: 0.189
Validation loss decreased (-0.181464 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.48471856117248535
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.768 Vali Acc: 0.189 Test Loss: 1.768 Test Acc: 0.189
Validation loss decreased (-0.188871 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.6606972217559814
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.758 Vali Acc: 0.193 Test Loss: 1.758 Test Acc: 0.193
Validation loss decreased (-0.188871 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.4103667736053467
Epoch: 5, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.744 Vali Acc: 0.200 Test Loss: 1.744 Test Acc: 0.200
Validation loss decreased (-0.192575 --> -0.199983).  Saving model ...
Epoch: 6 cost time: 0.43411850929260254
Epoch: 6, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.728 Vali Acc: 0.204 Test Loss: 1.728 Test Acc: 0.204
Validation loss decreased (-0.199983 --> -0.203686).  Saving model ...
Epoch: 7 cost time: 0.4566364288330078
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.711 Vali Acc: 0.211 Test Loss: 1.711 Test Acc: 0.211
Validation loss decreased (-0.203686 --> -0.211094).  Saving model ...
Epoch: 8 cost time: 0.38967418670654297
Epoch: 8, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.691 Vali Acc: 0.226 Test Loss: 1.691 Test Acc: 0.226
Validation loss decreased (-0.211094 --> -0.225909).  Saving model ...
Epoch: 9 cost time: 0.41271543502807617
Epoch: 9, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.670 Vali Acc: 0.256 Test Loss: 1.670 Test Acc: 0.256
Validation loss decreased (-0.225909 --> -0.255539).  Saving model ...
Epoch: 10 cost time: 0.3965005874633789
Epoch: 10, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.647 Vali Acc: 0.267 Test Loss: 1.647 Test Acc: 0.267
Validation loss decreased (-0.255539 --> -0.266650).  Saving model ...
Epoch: 11 cost time: 0.43613266944885254
Epoch: 11, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.623 Vali Acc: 0.289 Test Loss: 1.623 Test Acc: 0.289
Validation loss decreased (-0.266650 --> -0.288873).  Saving model ...
Epoch: 12 cost time: 0.4595975875854492
Epoch: 12, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.598 Vali Acc: 0.330 Test Loss: 1.598 Test Acc: 0.330
Validation loss decreased (-0.288873 --> -0.329614).  Saving model ...
Epoch: 13 cost time: 0.4460122585296631
Epoch: 13, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.572 Vali Acc: 0.363 Test Loss: 1.572 Test Acc: 0.363
Validation loss decreased (-0.329614 --> -0.362947).  Saving model ...
Epoch: 14 cost time: 0.5015542507171631
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.545 Vali Acc: 0.381 Test Loss: 1.545 Test Acc: 0.381
Validation loss decreased (-0.362947 --> -0.381466).  Saving model ...
Epoch: 15 cost time: 0.44349145889282227
Epoch: 15, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.517 Vali Acc: 0.400 Test Loss: 1.517 Test Acc: 0.400
Validation loss decreased (-0.381466 --> -0.399985).  Saving model ...
Epoch: 16 cost time: 0.5337011814117432
Epoch: 16, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.487 Vali Acc: 0.459 Test Loss: 1.487 Test Acc: 0.459
Validation loss decreased (-0.399985 --> -0.459244).  Saving model ...
Epoch: 17 cost time: 0.46718430519104004
Epoch: 17, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.458 Vali Acc: 0.489 Test Loss: 1.458 Test Acc: 0.489
Validation loss decreased (-0.459244 --> -0.488874).  Saving model ...
Epoch: 18 cost time: 0.41086745262145996
Epoch: 18, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.426 Vali Acc: 0.522 Test Loss: 1.426 Test Acc: 0.522
Validation loss decreased (-0.488874 --> -0.522208).  Saving model ...
Epoch: 19 cost time: 0.5124759674072266
Epoch: 19, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.394 Vali Acc: 0.552 Test Loss: 1.394 Test Acc: 0.552
Validation loss decreased (-0.522208 --> -0.551838).  Saving model ...
Epoch: 20 cost time: 0.5789220333099365
Epoch: 20, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.361 Vali Acc: 0.585 Test Loss: 1.361 Test Acc: 0.585
Validation loss decreased (-0.551838 --> -0.585172).  Saving model ...
Epoch: 21 cost time: 0.3993816375732422
Epoch: 21, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.327 Vali Acc: 0.604 Test Loss: 1.327 Test Acc: 0.604
Validation loss decreased (-0.585172 --> -0.603690).  Saving model ...
Epoch: 22 cost time: 0.4681086540222168
Epoch: 22, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.291 Vali Acc: 0.622 Test Loss: 1.291 Test Acc: 0.622
Validation loss decreased (-0.603690 --> -0.622209).  Saving model ...
Epoch: 23 cost time: 0.5390458106994629
Epoch: 23, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.254 Vali Acc: 0.633 Test Loss: 1.254 Test Acc: 0.633
Validation loss decreased (-0.622209 --> -0.633321).  Saving model ...
Epoch: 24 cost time: 0.42989492416381836
Epoch: 24, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.215 Vali Acc: 0.656 Test Loss: 1.215 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655543).  Saving model ...
Epoch: 25 cost time: 0.4608035087585449
Epoch: 25, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.175 Vali Acc: 0.681 Test Loss: 1.175 Test Acc: 0.681
Validation loss decreased (-0.655543 --> -0.681470).  Saving model ...
Epoch: 26 cost time: 0.4353303909301758
Epoch: 26, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.132 Vali Acc: 0.707 Test Loss: 1.132 Test Acc: 0.707
Validation loss decreased (-0.681470 --> -0.707396).  Saving model ...
Epoch: 27 cost time: 0.497220516204834
Epoch: 27, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.088 Vali Acc: 0.730 Test Loss: 1.088 Test Acc: 0.730
Validation loss decreased (-0.707396 --> -0.729619).  Saving model ...
Epoch: 28 cost time: 0.455446720123291
Epoch: 28, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.042 Vali Acc: 0.770 Test Loss: 1.042 Test Acc: 0.770
Validation loss decreased (-0.729619 --> -0.770360).  Saving model ...
Epoch: 29 cost time: 0.4963796138763428
Epoch: 29, Steps: 2 | Train Loss: 0.950 Vali Loss: 0.995 Vali Acc: 0.793 Test Loss: 0.995 Test Acc: 0.793
Validation loss decreased (-0.770360 --> -0.792583).  Saving model ...
Epoch: 30 cost time: 0.5069172382354736
Epoch: 30, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.945 Vali Acc: 0.807 Test Loss: 0.945 Test Acc: 0.807
Validation loss decreased (-0.792583 --> -0.807398).  Saving model ...
Epoch: 31 cost time: 0.5486249923706055
Epoch: 31, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.807398 --> -0.833324).  Saving model ...
Epoch: 32 cost time: 0.5252838134765625
Epoch: 32, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.840 Vali Acc: 0.848 Test Loss: 0.840 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848140).  Saving model ...
Epoch: 33 cost time: 0.4454383850097656
Epoch: 33, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.787 Vali Acc: 0.856 Test Loss: 0.787 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 34 cost time: 0.6468555927276611
Epoch: 34, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.733 Vali Acc: 0.867 Test Loss: 0.733 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 35 cost time: 0.6069955825805664
Epoch: 35, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.680 Vali Acc: 0.874 Test Loss: 0.680 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 36 cost time: 0.46492862701416016
Epoch: 36, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.627 Vali Acc: 0.881 Test Loss: 0.627 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 37 cost time: 0.5083127021789551
Epoch: 37, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 38 cost time: 0.473968505859375
Epoch: 38, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.528 Vali Acc: 0.881 Test Loss: 0.528 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 39 cost time: 0.4707920551300049
Epoch: 39, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.485 Vali Acc: 0.878 Test Loss: 0.485 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.5550239086151123
Epoch: 40, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.446 Vali Acc: 0.874 Test Loss: 0.446 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5397241115570068
Epoch: 41, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5031688213348389
Epoch: 42, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.385 Vali Acc: 0.881 Test Loss: 0.385 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881478).  Saving model ...
Epoch: 43 cost time: 0.4576094150543213
Epoch: 43, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.362 Vali Acc: 0.885 Test Loss: 0.362 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 44 cost time: 0.5477921962738037
Epoch: 44, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.344 Vali Acc: 0.885 Test Loss: 0.344 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 45 cost time: 0.46700239181518555
Epoch: 45, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.332 Vali Acc: 0.881 Test Loss: 0.332 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5563762187957764
Epoch: 46, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.327 Vali Acc: 0.867 Test Loss: 0.327 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.44200563430786133
Epoch: 47, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.324 Vali Acc: 0.870 Test Loss: 0.324 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5312960147857666
Epoch: 48, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.328 Vali Acc: 0.856 Test Loss: 0.328 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5858933925628662
Epoch: 49, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.332 Vali Acc: 0.852 Test Loss: 0.332 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5204253196716309
Epoch: 50, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.333 Vali Acc: 0.859 Test Loss: 0.333 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5856873989105225
Epoch: 51, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.334 Vali Acc: 0.859 Test Loss: 0.334 Test Acc: 0.859
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5868408679962158
Epoch: 52, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.339 Vali Acc: 0.859 Test Loss: 0.339 Test Acc: 0.859
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.4648897647857666
Epoch: 53, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.342 Vali Acc: 0.859 Test Loss: 0.342 Test Acc: 0.859
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5423200130462646
Epoch: 54, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.345 Vali Acc: 0.859 Test Loss: 0.345 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 111190
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.812696933746338
Epoch: 1, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.887 Vali Acc: 0.115 Test Loss: 1.887 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.4556388854980469
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.868 Vali Acc: 0.133 Test Loss: 1.868 Test Acc: 0.133
Validation loss decreased (-0.114796 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.4673640727996826
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.855 Vali Acc: 0.144 Test Loss: 1.855 Test Acc: 0.144
Validation loss decreased (-0.133315 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.4626162052154541
Epoch: 4, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.845 Vali Acc: 0.163 Test Loss: 1.845 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.4833221435546875
Epoch: 5, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.831 Vali Acc: 0.178 Test Loss: 1.831 Test Acc: 0.178
Validation loss decreased (-0.162945 --> -0.177759).  Saving model ...
Epoch: 6 cost time: 0.48340582847595215
Epoch: 6, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.5287322998046875
Epoch: 7, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.796 Vali Acc: 0.211 Test Loss: 1.796 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 8 cost time: 0.5402681827545166
Epoch: 8, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.776 Vali Acc: 0.219 Test Loss: 1.776 Test Acc: 0.219
Validation loss decreased (-0.211093 --> -0.218501).  Saving model ...
Epoch: 9 cost time: 0.48876404762268066
Epoch: 9, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.755 Vali Acc: 0.241 Test Loss: 1.755 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240723).  Saving model ...
Epoch: 10 cost time: 0.4665067195892334
Epoch: 10, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.732 Vali Acc: 0.263 Test Loss: 1.732 Test Acc: 0.263
Validation loss decreased (-0.240723 --> -0.262946).  Saving model ...
Epoch: 11 cost time: 0.47399163246154785
Epoch: 11, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.707 Vali Acc: 0.293 Test Loss: 1.707 Test Acc: 0.293
Validation loss decreased (-0.262946 --> -0.292576).  Saving model ...
Epoch: 12 cost time: 0.517319917678833
Epoch: 12, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.681 Vali Acc: 0.304 Test Loss: 1.681 Test Acc: 0.304
Validation loss decreased (-0.292576 --> -0.303687).  Saving model ...
Epoch: 13 cost time: 0.4874246120452881
Epoch: 13, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.655 Vali Acc: 0.322 Test Loss: 1.655 Test Acc: 0.322
Validation loss decreased (-0.303687 --> -0.322206).  Saving model ...
Epoch: 14 cost time: 0.41173696517944336
Epoch: 14, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.627 Vali Acc: 0.341 Test Loss: 1.627 Test Acc: 0.341
Validation loss decreased (-0.322206 --> -0.340724).  Saving model ...
Epoch: 15 cost time: 0.5039196014404297
Epoch: 15, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.598 Vali Acc: 0.359 Test Loss: 1.598 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 16 cost time: 0.5236556529998779
Epoch: 16, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.567 Vali Acc: 0.378 Test Loss: 1.567 Test Acc: 0.378
Validation loss decreased (-0.359243 --> -0.377762).  Saving model ...
Epoch: 17 cost time: 0.46207189559936523
Epoch: 17, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.536 Vali Acc: 0.422 Test Loss: 1.536 Test Acc: 0.422
Validation loss decreased (-0.377762 --> -0.422207).  Saving model ...
Epoch: 18 cost time: 0.5353453159332275
Epoch: 18, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.503 Vali Acc: 0.448 Test Loss: 1.503 Test Acc: 0.448
Validation loss decreased (-0.422207 --> -0.448133).  Saving model ...
Epoch: 19 cost time: 0.5252068042755127
Epoch: 19, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.468 Vali Acc: 0.478 Test Loss: 1.468 Test Acc: 0.478
Validation loss decreased (-0.448133 --> -0.477763).  Saving model ...
Epoch: 20 cost time: 0.481154203414917
Epoch: 20, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.432 Vali Acc: 0.504 Test Loss: 1.432 Test Acc: 0.504
Validation loss decreased (-0.477763 --> -0.503689).  Saving model ...
Epoch: 21 cost time: 0.48601651191711426
Epoch: 21, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
Validation loss decreased (-0.503689 --> -0.540727).  Saving model ...
Epoch: 22 cost time: 0.5102148056030273
Epoch: 22, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.355 Vali Acc: 0.567 Test Loss: 1.355 Test Acc: 0.567
Validation loss decreased (-0.540727 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 0.4671304225921631
Epoch: 23, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.314 Vali Acc: 0.604 Test Loss: 1.314 Test Acc: 0.604
Validation loss decreased (-0.566653 --> -0.603691).  Saving model ...
Epoch: 24 cost time: 0.5715975761413574
Epoch: 24, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.270 Vali Acc: 0.622 Test Loss: 1.270 Test Acc: 0.622
Validation loss decreased (-0.603691 --> -0.622210).  Saving model ...
Epoch: 25 cost time: 0.4334530830383301
Epoch: 25, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.224 Vali Acc: 0.667 Test Loss: 1.224 Test Acc: 0.667
Validation loss decreased (-0.622210 --> -0.666654).  Saving model ...
Epoch: 26 cost time: 0.4498145580291748
Epoch: 26, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.176 Vali Acc: 0.678 Test Loss: 1.176 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677766).  Saving model ...
Epoch: 27 cost time: 0.5306863784790039
Epoch: 27, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.126 Vali Acc: 0.707 Test Loss: 1.126 Test Acc: 0.707
Validation loss decreased (-0.677766 --> -0.707396).  Saving model ...
Epoch: 28 cost time: 0.520402193069458
Epoch: 28, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.073 Vali Acc: 0.744 Test Loss: 1.073 Test Acc: 0.744
Validation loss decreased (-0.707396 --> -0.744434).  Saving model ...
Epoch: 29 cost time: 0.5404558181762695
Epoch: 29, Steps: 2 | Train Loss: 0.879 Vali Loss: 1.017 Vali Acc: 0.763 Test Loss: 1.017 Test Acc: 0.763
Validation loss decreased (-0.744434 --> -0.762953).  Saving model ...
Epoch: 30 cost time: 0.5343489646911621
Epoch: 30, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.959 Vali Acc: 0.774 Test Loss: 0.959 Test Acc: 0.774
Validation loss decreased (-0.762953 --> -0.774064).  Saving model ...
Epoch: 31 cost time: 0.5345883369445801
Epoch: 31, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.900 Vali Acc: 0.793 Test Loss: 0.900 Test Acc: 0.793
Validation loss decreased (-0.774064 --> -0.792584).  Saving model ...
Epoch: 32 cost time: 0.49979281425476074
Epoch: 32, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.840 Vali Acc: 0.807 Test Loss: 0.840 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807399).  Saving model ...
Epoch: 33 cost time: 0.4889075756072998
Epoch: 33, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.780 Vali Acc: 0.826 Test Loss: 0.780 Test Acc: 0.826
Validation loss decreased (-0.807399 --> -0.825918).  Saving model ...
Epoch: 34 cost time: 0.5694060325622559
Epoch: 34, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.723 Vali Acc: 0.841 Test Loss: 0.723 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840734).  Saving model ...
Epoch: 35 cost time: 0.5277485847473145
Epoch: 35, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
Validation loss decreased (-0.840734 --> -0.844438).  Saving model ...
Epoch: 36 cost time: 0.761115550994873
Epoch: 36, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.620 Vali Acc: 0.837 Test Loss: 0.620 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.4890897274017334
Epoch: 37, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.576 Vali Acc: 0.833 Test Loss: 0.576 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.41962742805480957
Epoch: 38, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.539 Vali Acc: 0.837 Test Loss: 0.539 Test Acc: 0.837
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.47638535499572754
Epoch: 39, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.507 Vali Acc: 0.837 Test Loss: 0.507 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.4424619674682617
Epoch: 40, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.481 Vali Acc: 0.830 Test Loss: 0.481 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.45879125595092773
Epoch: 41, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.460 Vali Acc: 0.830 Test Loss: 0.460 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.49381136894226074
Epoch: 42, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.446 Vali Acc: 0.833 Test Loss: 0.446 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4313507080078125
Epoch: 43, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.43616223335266113
Epoch: 44, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.425 Vali Acc: 0.833 Test Loss: 0.425 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5160534381866455
Epoch: 45, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.418 Vali Acc: 0.833 Test Loss: 0.418 Test Acc: 0.833
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8444444444444444
model parameter : 110973
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5895376205444336
Epoch: 1, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.794 Vali Acc: 0.219 Test Loss: 1.794 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.5024099349975586
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.775 Vali Acc: 0.256 Test Loss: 1.775 Test Acc: 0.256
Validation loss decreased (-0.218501 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.41814231872558594
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.761 Vali Acc: 0.274 Test Loss: 1.761 Test Acc: 0.274
Validation loss decreased (-0.255538 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.4669075012207031
Epoch: 4, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.749 Vali Acc: 0.285 Test Loss: 1.749 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.551992654800415
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.733 Vali Acc: 0.304 Test Loss: 1.733 Test Acc: 0.304
Validation loss decreased (-0.285168 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 0.47347187995910645
Epoch: 6, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.714 Vali Acc: 0.311 Test Loss: 1.714 Test Acc: 0.311
Validation loss decreased (-0.303686 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.5086562633514404
Epoch: 7, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.692 Vali Acc: 0.341 Test Loss: 1.692 Test Acc: 0.341
Validation loss decreased (-0.311094 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 0.434934139251709
Epoch: 8, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.668 Vali Acc: 0.389 Test Loss: 1.668 Test Acc: 0.389
Validation loss decreased (-0.340724 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 0.4734077453613281
Epoch: 9, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.643 Vali Acc: 0.415 Test Loss: 1.643 Test Acc: 0.415
Validation loss decreased (-0.388872 --> -0.414798).  Saving model ...
Epoch: 10 cost time: 0.4759979248046875
Epoch: 10, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.615 Vali Acc: 0.448 Test Loss: 1.615 Test Acc: 0.448
Validation loss decreased (-0.414798 --> -0.448132).  Saving model ...
Epoch: 11 cost time: 0.4637587070465088
Epoch: 11, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.586 Vali Acc: 0.470 Test Loss: 1.586 Test Acc: 0.470
Validation loss decreased (-0.448132 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.5248429775238037
Epoch: 12, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.555 Vali Acc: 0.493 Test Loss: 1.555 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492577).  Saving model ...
Epoch: 13 cost time: 0.4058365821838379
Epoch: 13, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.522 Vali Acc: 0.526 Test Loss: 1.522 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 14 cost time: 0.5720808506011963
Epoch: 14, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.488 Vali Acc: 0.567 Test Loss: 1.488 Test Acc: 0.567
Validation loss decreased (-0.525911 --> -0.566652).  Saving model ...
Epoch: 15 cost time: 0.49295926094055176
Epoch: 15, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.452 Vali Acc: 0.596 Test Loss: 1.452 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596282).  Saving model ...
Epoch: 16 cost time: 0.4245424270629883
Epoch: 16, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.415 Vali Acc: 0.619 Test Loss: 1.415 Test Acc: 0.619
Validation loss decreased (-0.596282 --> -0.618504).  Saving model ...
Epoch: 17 cost time: 0.4545156955718994
Epoch: 17, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.375 Vali Acc: 0.630 Test Loss: 1.375 Test Acc: 0.630
Validation loss decreased (-0.618504 --> -0.629616).  Saving model ...
Epoch: 18 cost time: 0.3821747303009033
Epoch: 18, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.334 Vali Acc: 0.663 Test Loss: 1.334 Test Acc: 0.663
Validation loss decreased (-0.629616 --> -0.662950).  Saving model ...
Epoch: 19 cost time: 0.41873645782470703
Epoch: 19, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.292 Vali Acc: 0.700 Test Loss: 1.292 Test Acc: 0.700
Validation loss decreased (-0.662950 --> -0.699987).  Saving model ...
Epoch: 20 cost time: 0.47110819816589355
Epoch: 20, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.247 Vali Acc: 0.719 Test Loss: 1.247 Test Acc: 0.719
Validation loss decreased (-0.699987 --> -0.718506).  Saving model ...
Epoch: 21 cost time: 0.5433716773986816
Epoch: 21, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.201 Vali Acc: 0.748 Test Loss: 1.201 Test Acc: 0.748
Validation loss decreased (-0.718506 --> -0.748136).  Saving model ...
Epoch: 22 cost time: 0.4967200756072998
Epoch: 22, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.152 Vali Acc: 0.759 Test Loss: 1.152 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
Epoch: 23 cost time: 0.5131964683532715
Epoch: 23, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.102 Vali Acc: 0.778 Test Loss: 1.102 Test Acc: 0.778
Validation loss decreased (-0.759248 --> -0.777767).  Saving model ...
Epoch: 24 cost time: 0.4944429397583008
Epoch: 24, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.050 Vali Acc: 0.804 Test Loss: 1.050 Test Acc: 0.804
Validation loss decreased (-0.777767 --> -0.803693).  Saving model ...
Epoch: 25 cost time: 0.5792679786682129
Epoch: 25, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.996 Vali Acc: 0.819 Test Loss: 0.996 Test Acc: 0.819
Validation loss decreased (-0.803693 --> -0.818509).  Saving model ...
Epoch: 26 cost time: 0.5860898494720459
Epoch: 26, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.942 Vali Acc: 0.826 Test Loss: 0.942 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 27 cost time: 0.4746100902557373
Epoch: 27, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.886 Vali Acc: 0.833 Test Loss: 0.886 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833324).  Saving model ...
Epoch: 28 cost time: 0.45625948905944824
Epoch: 28, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.829 Vali Acc: 0.837 Test Loss: 0.829 Test Acc: 0.837
Validation loss decreased (-0.833324 --> -0.837029).  Saving model ...
Epoch: 29 cost time: 0.5010888576507568
Epoch: 29, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.772 Vali Acc: 0.830 Test Loss: 0.772 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.44608163833618164
Epoch: 30, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.714 Vali Acc: 0.848 Test Loss: 0.714 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 31 cost time: 0.38698625564575195
Epoch: 31, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.658 Vali Acc: 0.852 Test Loss: 0.658 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 32 cost time: 0.44246411323547363
Epoch: 32, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.605 Vali Acc: 0.859 Test Loss: 0.605 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 33 cost time: 0.41704773902893066
Epoch: 33, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 34 cost time: 0.46002721786499023
Epoch: 34, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.44089174270629883
Epoch: 35, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.482 Vali Acc: 0.870 Test Loss: 0.482 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870366).  Saving model ...
Epoch: 36 cost time: 0.34748291969299316
Epoch: 36, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.455 Vali Acc: 0.870 Test Loss: 0.455 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 37 cost time: 0.4745965003967285
Epoch: 37, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.436 Vali Acc: 0.863 Test Loss: 0.436 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.4804196357727051
Epoch: 38, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.422 Vali Acc: 0.867 Test Loss: 0.422 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.3944101333618164
Epoch: 39, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.413 Vali Acc: 0.867 Test Loss: 0.413 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.550276517868042
Epoch: 40, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.408 Vali Acc: 0.870 Test Loss: 0.408 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 41 cost time: 0.454787015914917
Epoch: 41, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.407 Vali Acc: 0.859 Test Loss: 0.407 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5383057594299316
Epoch: 42, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.408 Vali Acc: 0.859 Test Loss: 0.408 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.49141383171081543
Epoch: 43, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.413 Vali Acc: 0.852 Test Loss: 0.413 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.49695873260498047
Epoch: 44, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.414 Vali Acc: 0.859 Test Loss: 0.414 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.4086589813232422
Epoch: 45, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.415 Vali Acc: 0.859 Test Loss: 0.415 Test Acc: 0.859
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.48966312408447266
Epoch: 46, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.418 Vali Acc: 0.856 Test Loss: 0.418 Test Acc: 0.856
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.511603593826294
Epoch: 47, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.419 Vali Acc: 0.863 Test Loss: 0.419 Test Acc: 0.863
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.4197690486907959
Epoch: 48, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.421 Vali Acc: 0.867 Test Loss: 0.421 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.40924668312072754
Epoch: 49, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.423 Vali Acc: 0.863 Test Loss: 0.423 Test Acc: 0.863
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.4154202938079834
Epoch: 50, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.425 Vali Acc: 0.859 Test Loss: 0.425 Test Acc: 0.859
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm512_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8703703703703703
model parameter : 111168
model size : 0.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8339688777923584
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.782 Vali Acc: 0.281 Test Loss: 1.782 Test Acc: 0.281
Validation loss decreased (inf --> -0.281464).  Saving model ...
Epoch: 2 cost time: 0.5741329193115234
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.765 Vali Acc: 0.293 Test Loss: 1.765 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.515366792678833
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.754 Vali Acc: 0.296 Test Loss: 1.754 Test Acc: 0.296
Validation loss decreased (-0.292575 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.4757347106933594
Epoch: 4, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.745 Vali Acc: 0.304 Test Loss: 1.745 Test Acc: 0.304
Validation loss decreased (-0.296279 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.4208669662475586
Epoch: 5, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.734 Vali Acc: 0.307 Test Loss: 1.734 Test Acc: 0.307
Validation loss decreased (-0.303686 --> -0.307390).  Saving model ...
Epoch: 6 cost time: 0.4785146713256836
Epoch: 6, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.721 Vali Acc: 0.311 Test Loss: 1.721 Test Acc: 0.311
Validation loss decreased (-0.307390 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.47343993186950684
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.706 Vali Acc: 0.326 Test Loss: 1.706 Test Acc: 0.326
Validation loss decreased (-0.311094 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 0.35854506492614746
Epoch: 8, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.689 Vali Acc: 0.333 Test Loss: 1.689 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333316).  Saving model ...
Epoch: 9 cost time: 0.54256272315979
Epoch: 9, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.671 Vali Acc: 0.344 Test Loss: 1.671 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 10 cost time: 0.513303279876709
Epoch: 10, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.652 Vali Acc: 0.356 Test Loss: 1.652 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 0.3867065906524658
Epoch: 11, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.631 Vali Acc: 0.378 Test Loss: 1.631 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377761).  Saving model ...
Epoch: 12 cost time: 0.4975299835205078
Epoch: 12, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.610 Vali Acc: 0.404 Test Loss: 1.610 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403688).  Saving model ...
Epoch: 13 cost time: 0.6526155471801758
Epoch: 13, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.588 Vali Acc: 0.430 Test Loss: 1.588 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429614).  Saving model ...
Epoch: 14 cost time: 0.3792288303375244
Epoch: 14, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.564 Vali Acc: 0.444 Test Loss: 1.564 Test Acc: 0.444
Validation loss decreased (-0.429614 --> -0.444429).  Saving model ...
Epoch: 15 cost time: 0.5811634063720703
Epoch: 15, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.540 Vali Acc: 0.478 Test Loss: 1.540 Test Acc: 0.478
Validation loss decreased (-0.444429 --> -0.477762).  Saving model ...
Epoch: 16 cost time: 0.5665545463562012
Epoch: 16, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.516 Vali Acc: 0.496 Test Loss: 1.516 Test Acc: 0.496
Validation loss decreased (-0.477762 --> -0.496281).  Saving model ...
Epoch: 17 cost time: 0.4762709140777588
Epoch: 17, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.490 Vali Acc: 0.511 Test Loss: 1.490 Test Acc: 0.511
Validation loss decreased (-0.496281 --> -0.511096).  Saving model ...
Epoch: 18 cost time: 0.48699188232421875
Epoch: 18, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.465 Vali Acc: 0.530 Test Loss: 1.465 Test Acc: 0.530
Validation loss decreased (-0.511096 --> -0.529615).  Saving model ...
Epoch: 19 cost time: 0.49120378494262695
Epoch: 19, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.438 Vali Acc: 0.537 Test Loss: 1.438 Test Acc: 0.537
Validation loss decreased (-0.529615 --> -0.537023).  Saving model ...
Epoch: 20 cost time: 0.4339609146118164
Epoch: 20, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.411 Vali Acc: 0.559 Test Loss: 1.411 Test Acc: 0.559
Validation loss decreased (-0.537023 --> -0.559245).  Saving model ...
Epoch: 21 cost time: 0.45969676971435547
Epoch: 21, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.384 Vali Acc: 0.585 Test Loss: 1.384 Test Acc: 0.585
Validation loss decreased (-0.559245 --> -0.585171).  Saving model ...
Epoch: 22 cost time: 0.4594597816467285
Epoch: 22, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.356 Vali Acc: 0.589 Test Loss: 1.356 Test Acc: 0.589
Validation loss decreased (-0.585171 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 0.45397305488586426
Epoch: 23, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.328 Vali Acc: 0.604 Test Loss: 1.328 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603690).  Saving model ...
Epoch: 24 cost time: 0.4250059127807617
Epoch: 24, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.299 Vali Acc: 0.611 Test Loss: 1.299 Test Acc: 0.611
Validation loss decreased (-0.603690 --> -0.611098).  Saving model ...
Epoch: 25 cost time: 0.6191177368164062
Epoch: 25, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.270 Vali Acc: 0.615 Test Loss: 1.270 Test Acc: 0.615
Validation loss decreased (-0.611098 --> -0.614802).  Saving model ...
Epoch: 26 cost time: 0.4795656204223633
Epoch: 26, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.240 Vali Acc: 0.626 Test Loss: 1.240 Test Acc: 0.626
Validation loss decreased (-0.614802 --> -0.625914).  Saving model ...
Epoch: 27 cost time: 0.5088889598846436
Epoch: 27, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.210 Vali Acc: 0.633 Test Loss: 1.210 Test Acc: 0.633
Validation loss decreased (-0.625914 --> -0.633321).  Saving model ...
Epoch: 28 cost time: 0.6558966636657715
Epoch: 28, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.179 Vali Acc: 0.659 Test Loss: 1.179 Test Acc: 0.659
Validation loss decreased (-0.633321 --> -0.659247).  Saving model ...
Epoch: 29 cost time: 0.5300173759460449
Epoch: 29, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.148 Vali Acc: 0.670 Test Loss: 1.148 Test Acc: 0.670
Validation loss decreased (-0.659247 --> -0.670359).  Saving model ...
Epoch: 30 cost time: 0.5499494075775146
Epoch: 30, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.117 Vali Acc: 0.685 Test Loss: 1.117 Test Acc: 0.685
Validation loss decreased (-0.670359 --> -0.685174).  Saving model ...
Epoch: 31 cost time: 0.5225799083709717
Epoch: 31, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.085 Vali Acc: 0.696 Test Loss: 1.085 Test Acc: 0.696
Validation loss decreased (-0.685174 --> -0.696285).  Saving model ...
Epoch: 32 cost time: 0.6319906711578369
Epoch: 32, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.053 Vali Acc: 0.704 Test Loss: 1.053 Test Acc: 0.704
Validation loss decreased (-0.696285 --> -0.703693).  Saving model ...
Epoch: 33 cost time: 0.6235761642456055
Epoch: 33, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.020 Vali Acc: 0.737 Test Loss: 1.020 Test Acc: 0.737
Validation loss decreased (-0.703693 --> -0.737027).  Saving model ...
Epoch: 34 cost time: 0.5559911727905273
Epoch: 34, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.987 Vali Acc: 0.748 Test Loss: 0.987 Test Acc: 0.748
Validation loss decreased (-0.737027 --> -0.748138).  Saving model ...
Epoch: 35 cost time: 0.5976526737213135
Epoch: 35, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.954 Vali Acc: 0.770 Test Loss: 0.954 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 36 cost time: 0.4878413677215576
Epoch: 36, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.921 Vali Acc: 0.774 Test Loss: 0.921 Test Acc: 0.774
Validation loss decreased (-0.770361 --> -0.774065).  Saving model ...
Epoch: 37 cost time: 0.5622117519378662
Epoch: 37, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.887 Vali Acc: 0.774 Test Loss: 0.887 Test Acc: 0.774
Validation loss decreased (-0.774065 --> -0.774065).  Saving model ...
Epoch: 38 cost time: 0.42606544494628906
Epoch: 38, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
Validation loss decreased (-0.774065 --> -0.788880).  Saving model ...
Epoch: 39 cost time: 0.4889712333679199
Epoch: 39, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.819 Vali Acc: 0.789 Test Loss: 0.819 Test Acc: 0.789
Validation loss decreased (-0.788880 --> -0.788881).  Saving model ...
Epoch: 40 cost time: 0.39765357971191406
Epoch: 40, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.786 Vali Acc: 0.793 Test Loss: 0.786 Test Acc: 0.793
Validation loss decreased (-0.788881 --> -0.792585).  Saving model ...
Epoch: 41 cost time: 0.5981135368347168
Epoch: 41, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.752 Vali Acc: 0.804 Test Loss: 0.752 Test Acc: 0.804
Validation loss decreased (-0.792585 --> -0.803696).  Saving model ...
Epoch: 42 cost time: 0.5857706069946289
Epoch: 42, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.719 Vali Acc: 0.800 Test Loss: 0.719 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5406954288482666
Epoch: 43, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.687 Vali Acc: 0.815 Test Loss: 0.687 Test Acc: 0.815
Validation loss decreased (-0.803696 --> -0.814808).  Saving model ...
Epoch: 44 cost time: 0.5300412178039551
Epoch: 44, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814808).  Saving model ...
Epoch: 45 cost time: 0.4970207214355469
Epoch: 45, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
Validation loss decreased (-0.814808 --> -0.814809).  Saving model ...
Epoch: 46 cost time: 0.6379866600036621
Epoch: 46, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.597 Vali Acc: 0.815 Test Loss: 0.597 Test Acc: 0.815
Validation loss decreased (-0.814809 --> -0.814809).  Saving model ...
Epoch: 47 cost time: 0.4534444808959961
Epoch: 47, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.570 Vali Acc: 0.807 Test Loss: 0.570 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6654353141784668
Epoch: 48, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.544 Vali Acc: 0.811 Test Loss: 0.544 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5464155673980713
Epoch: 49, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
Validation loss decreased (-0.814809 --> -0.822217).  Saving model ...
Epoch: 50 cost time: 0.6740634441375732
Epoch: 50, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.499 Vali Acc: 0.819 Test Loss: 0.499 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5436031818389893
Epoch: 51, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.480 Vali Acc: 0.830 Test Loss: 0.480 Test Acc: 0.830
Validation loss decreased (-0.822217 --> -0.829625).  Saving model ...
Epoch: 52 cost time: 0.5924100875854492
Epoch: 52, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.462 Vali Acc: 0.841 Test Loss: 0.462 Test Acc: 0.841
Validation loss decreased (-0.829625 --> -0.840736).  Saving model ...
Epoch: 53 cost time: 0.4961049556732178
Epoch: 53, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.448 Vali Acc: 0.837 Test Loss: 0.448 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.6822795867919922
Epoch: 54, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.435 Vali Acc: 0.830 Test Loss: 0.435 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5300564765930176
Epoch: 55, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.425 Vali Acc: 0.830 Test Loss: 0.425 Test Acc: 0.830
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.523000955581665
Epoch: 56, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.416 Vali Acc: 0.837 Test Loss: 0.416 Test Acc: 0.837
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5858972072601318
Epoch: 57, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.410 Vali Acc: 0.833 Test Loss: 0.410 Test Acc: 0.833
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.4724240303039551
Epoch: 58, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.406 Vali Acc: 0.830 Test Loss: 0.406 Test Acc: 0.830
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.5700483322143555
Epoch: 59, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.405 Vali Acc: 0.826 Test Loss: 0.405 Test Acc: 0.826
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.5161571502685547
Epoch: 60, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.404 Vali Acc: 0.822 Test Loss: 0.404 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.637810230255127
Epoch: 61, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.404 Vali Acc: 0.833 Test Loss: 0.404 Test Acc: 0.833
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.6511094570159912
Epoch: 62, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.403 Vali Acc: 0.841 Test Loss: 0.403 Test Acc: 0.841
Validation loss decreased (-0.840736 --> -0.840737).  Saving model ...
Epoch: 63 cost time: 0.5562229156494141
Epoch: 63, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.404 Vali Acc: 0.841 Test Loss: 0.404 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6161854267120361
Epoch: 64, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.404 Vali Acc: 0.841 Test Loss: 0.404 Test Acc: 0.841
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.5111846923828125
Epoch: 65, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.405 Vali Acc: 0.826 Test Loss: 0.405 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.5987038612365723
Epoch: 66, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.407 Vali Acc: 0.826 Test Loss: 0.407 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.5670557022094727
Epoch: 67, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.413 Vali Acc: 0.830 Test Loss: 0.413 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.5583767890930176
Epoch: 68, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.417 Vali Acc: 0.833 Test Loss: 0.417 Test Acc: 0.833
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6562988758087158
Epoch: 69, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.421 Vali Acc: 0.833 Test Loss: 0.421 Test Acc: 0.833
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5611851215362549
Epoch: 70, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.426 Vali Acc: 0.833 Test Loss: 0.426 Test Acc: 0.833
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.6639933586120605
Epoch: 71, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.428 Vali Acc: 0.830 Test Loss: 0.428 Test Acc: 0.830
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.7419710159301758
Epoch: 72, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.431 Vali Acc: 0.830 Test Loss: 0.431 Test Acc: 0.830
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8407407407407408
model parameter : 37352
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6072123050689697
Epoch: 1, Steps: 2 | Train Loss: 2.013 Vali Loss: 1.954 Vali Acc: 0.215 Test Loss: 1.954 Test Acc: 0.215
Validation loss decreased (inf --> -0.214795).  Saving model ...
Epoch: 2 cost time: 0.46363234519958496
Epoch: 2, Steps: 2 | Train Loss: 1.997 Vali Loss: 1.935 Vali Acc: 0.222 Test Loss: 1.935 Test Acc: 0.222
Validation loss decreased (-0.214795 --> -0.222203).  Saving model ...
Epoch: 3 cost time: 0.4557218551635742
Epoch: 3, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.922 Vali Acc: 0.230 Test Loss: 1.922 Test Acc: 0.230
Validation loss decreased (-0.222203 --> -0.229610).  Saving model ...
Epoch: 4 cost time: 0.49482178688049316
Epoch: 4, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.912 Vali Acc: 0.237 Test Loss: 1.912 Test Acc: 0.237
Validation loss decreased (-0.229610 --> -0.237018).  Saving model ...
Epoch: 5 cost time: 0.42658090591430664
Epoch: 5, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.899 Vali Acc: 0.241 Test Loss: 1.899 Test Acc: 0.241
Validation loss decreased (-0.237018 --> -0.240722).  Saving model ...
Epoch: 6 cost time: 0.33554577827453613
Epoch: 6, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.883 Vali Acc: 0.252 Test Loss: 1.883 Test Acc: 0.252
Validation loss decreased (-0.240722 --> -0.251833).  Saving model ...
Epoch: 7 cost time: 0.437009334564209
Epoch: 7, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.866 Vali Acc: 0.259 Test Loss: 1.866 Test Acc: 0.259
Validation loss decreased (-0.251833 --> -0.259241).  Saving model ...
Epoch: 8 cost time: 0.5240392684936523
Epoch: 8, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.846 Vali Acc: 0.263 Test Loss: 1.846 Test Acc: 0.263
Validation loss decreased (-0.259241 --> -0.262944).  Saving model ...
Epoch: 9 cost time: 0.574307918548584
Epoch: 9, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.826 Vali Acc: 0.278 Test Loss: 1.826 Test Acc: 0.278
Validation loss decreased (-0.262944 --> -0.277760).  Saving model ...
Epoch: 10 cost time: 0.46809840202331543
Epoch: 10, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.805 Vali Acc: 0.285 Test Loss: 1.805 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285167).  Saving model ...
Epoch: 11 cost time: 0.5294914245605469
Epoch: 11, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.782 Vali Acc: 0.300 Test Loss: 1.782 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 12 cost time: 0.5217595100402832
Epoch: 12, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.759 Vali Acc: 0.315 Test Loss: 1.759 Test Acc: 0.315
Validation loss decreased (-0.299982 --> -0.314797).  Saving model ...
Epoch: 13 cost time: 0.5172209739685059
Epoch: 13, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.734 Vali Acc: 0.348 Test Loss: 1.734 Test Acc: 0.348
Validation loss decreased (-0.314797 --> -0.348131).  Saving model ...
Epoch: 14 cost time: 0.4169168472290039
Epoch: 14, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.709 Vali Acc: 0.378 Test Loss: 1.709 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 15 cost time: 0.48621249198913574
Epoch: 15, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.683 Vali Acc: 0.411 Test Loss: 1.683 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411094).  Saving model ...
Epoch: 16 cost time: 0.4851114749908447
Epoch: 16, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.657 Vali Acc: 0.441 Test Loss: 1.657 Test Acc: 0.441
Validation loss decreased (-0.411094 --> -0.440724).  Saving model ...
Epoch: 17 cost time: 0.41685938835144043
Epoch: 17, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.630 Vali Acc: 0.474 Test Loss: 1.630 Test Acc: 0.474
Validation loss decreased (-0.440724 --> -0.474058).  Saving model ...
Epoch: 18 cost time: 0.46456193923950195
Epoch: 18, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.602 Vali Acc: 0.485 Test Loss: 1.602 Test Acc: 0.485
Validation loss decreased (-0.474058 --> -0.485169).  Saving model ...
Epoch: 19 cost time: 0.4445016384124756
Epoch: 19, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.574 Vali Acc: 0.507 Test Loss: 1.574 Test Acc: 0.507
Validation loss decreased (-0.485169 --> -0.507392).  Saving model ...
Epoch: 20 cost time: 0.43100857734680176
Epoch: 20, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.545 Vali Acc: 0.526 Test Loss: 1.545 Test Acc: 0.526
Validation loss decreased (-0.507392 --> -0.525910).  Saving model ...
Epoch: 21 cost time: 0.5922467708587646
Epoch: 21, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.515 Vali Acc: 0.552 Test Loss: 1.515 Test Acc: 0.552
Validation loss decreased (-0.525910 --> -0.551837).  Saving model ...
Epoch: 22 cost time: 0.5414326190948486
Epoch: 22, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.485 Vali Acc: 0.563 Test Loss: 1.485 Test Acc: 0.563
Validation loss decreased (-0.551837 --> -0.562948).  Saving model ...
Epoch: 23 cost time: 0.5715312957763672
Epoch: 23, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.455 Vali Acc: 0.585 Test Loss: 1.455 Test Acc: 0.585
Validation loss decreased (-0.562948 --> -0.585171).  Saving model ...
Epoch: 24 cost time: 0.5355689525604248
Epoch: 24, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.424 Vali Acc: 0.615 Test Loss: 1.424 Test Acc: 0.615
Validation loss decreased (-0.585171 --> -0.614801).  Saving model ...
Epoch: 25 cost time: 0.5400052070617676
Epoch: 25, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.392 Vali Acc: 0.641 Test Loss: 1.392 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640727).  Saving model ...
Epoch: 26 cost time: 0.4789559841156006
Epoch: 26, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.360 Vali Acc: 0.659 Test Loss: 1.360 Test Acc: 0.659
Validation loss decreased (-0.640727 --> -0.659246).  Saving model ...
Epoch: 27 cost time: 0.586451530456543
Epoch: 27, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.328 Vali Acc: 0.670 Test Loss: 1.328 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 28 cost time: 0.6379618644714355
Epoch: 28, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.295 Vali Acc: 0.700 Test Loss: 1.295 Test Acc: 0.700
Validation loss decreased (-0.670357 --> -0.699987).  Saving model ...
Epoch: 29 cost time: 0.462658166885376
Epoch: 29, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.261 Vali Acc: 0.715 Test Loss: 1.261 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 30 cost time: 0.49724531173706055
Epoch: 30, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.226 Vali Acc: 0.741 Test Loss: 1.226 Test Acc: 0.741
Validation loss decreased (-0.714802 --> -0.740728).  Saving model ...
Epoch: 31 cost time: 0.4370560646057129
Epoch: 31, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.191 Vali Acc: 0.756 Test Loss: 1.191 Test Acc: 0.756
Validation loss decreased (-0.740728 --> -0.755544).  Saving model ...
Epoch: 32 cost time: 0.3984794616699219
Epoch: 32, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.155 Vali Acc: 0.785 Test Loss: 1.155 Test Acc: 0.785
Validation loss decreased (-0.755544 --> -0.785174).  Saving model ...
Epoch: 33 cost time: 0.36182403564453125
Epoch: 33, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.119 Vali Acc: 0.796 Test Loss: 1.119 Test Acc: 0.796
Validation loss decreased (-0.785174 --> -0.796285).  Saving model ...
Epoch: 34 cost time: 0.4481546878814697
Epoch: 34, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.081 Vali Acc: 0.804 Test Loss: 1.081 Test Acc: 0.804
Validation loss decreased (-0.796285 --> -0.803693).  Saving model ...
Epoch: 35 cost time: 0.4449045658111572
Epoch: 35, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.044 Vali Acc: 0.807 Test Loss: 1.044 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807397).  Saving model ...
Epoch: 36 cost time: 0.4673936367034912
Epoch: 36, Steps: 2 | Train Loss: 0.931 Vali Loss: 1.005 Vali Acc: 0.815 Test Loss: 1.005 Test Acc: 0.815
Validation loss decreased (-0.807397 --> -0.814805).  Saving model ...
Epoch: 37 cost time: 0.43956637382507324
Epoch: 37, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.967 Vali Acc: 0.822 Test Loss: 0.967 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 38 cost time: 0.5495390892028809
Epoch: 38, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.928 Vali Acc: 0.822 Test Loss: 0.928 Test Acc: 0.822
Validation loss decreased (-0.822213 --> -0.822213).  Saving model ...
Epoch: 39 cost time: 0.37294769287109375
Epoch: 39, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.890 Vali Acc: 0.841 Test Loss: 0.890 Test Acc: 0.841
Validation loss decreased (-0.822213 --> -0.840732).  Saving model ...
Epoch: 40 cost time: 0.5550546646118164
Epoch: 40, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.851 Vali Acc: 0.841 Test Loss: 0.851 Test Acc: 0.841
Validation loss decreased (-0.840732 --> -0.840732).  Saving model ...
Epoch: 41 cost time: 0.5390658378601074
Epoch: 41, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.813 Vali Acc: 0.848 Test Loss: 0.813 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 42 cost time: 0.6180086135864258
Epoch: 42, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.776 Vali Acc: 0.859 Test Loss: 0.776 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859251).  Saving model ...
Epoch: 43 cost time: 0.6278746128082275
Epoch: 43, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.740 Vali Acc: 0.874 Test Loss: 0.740 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874067).  Saving model ...
Epoch: 44 cost time: 0.6508369445800781
Epoch: 44, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.706 Vali Acc: 0.874 Test Loss: 0.706 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 45 cost time: 0.7019987106323242
Epoch: 45, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.674 Vali Acc: 0.874 Test Loss: 0.674 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 46 cost time: 0.5399692058563232
Epoch: 46, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.644 Vali Acc: 0.874 Test Loss: 0.644 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874068).  Saving model ...
Epoch: 47 cost time: 0.7004673480987549
Epoch: 47, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.874 Test Loss: 0.616 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 48 cost time: 0.533686637878418
Epoch: 48, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.590 Vali Acc: 0.874 Test Loss: 0.590 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 49 cost time: 0.5026633739471436
Epoch: 49, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.566 Vali Acc: 0.878 Test Loss: 0.566 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 50 cost time: 0.7128124237060547
Epoch: 50, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.544 Vali Acc: 0.878 Test Loss: 0.544 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 51 cost time: 0.541327714920044
Epoch: 51, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.525 Vali Acc: 0.870 Test Loss: 0.525 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6595625877380371
Epoch: 52, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.508 Vali Acc: 0.870 Test Loss: 0.508 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5298769474029541
Epoch: 53, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6182651519775391
Epoch: 54, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.479 Vali Acc: 0.867 Test Loss: 0.479 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.628781795501709
Epoch: 55, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.5832464694976807
Epoch: 56, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.455 Vali Acc: 0.859 Test Loss: 0.455 Test Acc: 0.859
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.5441465377807617
Epoch: 57, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.444 Vali Acc: 0.867 Test Loss: 0.444 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.5710816383361816
Epoch: 58, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.435 Vali Acc: 0.874 Test Loss: 0.435 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.5478854179382324
Epoch: 59, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.426 Vali Acc: 0.874 Test Loss: 0.426 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.6909115314483643
Epoch: 60, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.418 Vali Acc: 0.878 Test Loss: 0.418 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877774).  Saving model ...
Epoch: 61 cost time: 0.5630531311035156
Epoch: 61, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.410 Vali Acc: 0.881 Test Loss: 0.410 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881477).  Saving model ...
Epoch: 62 cost time: 0.5502901077270508
Epoch: 62, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.403 Vali Acc: 0.881 Test Loss: 0.403 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 63 cost time: 0.6143176555633545
Epoch: 63, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.397 Vali Acc: 0.881 Test Loss: 0.397 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881478).  Saving model ...
Epoch: 64 cost time: 0.601409912109375
Epoch: 64, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.393 Vali Acc: 0.881 Test Loss: 0.393 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 65 cost time: 0.5944910049438477
Epoch: 65, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.389 Vali Acc: 0.878 Test Loss: 0.389 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5509791374206543
Epoch: 66, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5812699794769287
Epoch: 67, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.382 Vali Acc: 0.874 Test Loss: 0.382 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.6074390411376953
Epoch: 68, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.380 Vali Acc: 0.874 Test Loss: 0.380 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.542438268661499
Epoch: 69, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.377 Vali Acc: 0.874 Test Loss: 0.377 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.538825273513794
Epoch: 70, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.376 Vali Acc: 0.878 Test Loss: 0.376 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5410327911376953
Epoch: 71, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.373 Vali Acc: 0.881 Test Loss: 0.373 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 72 cost time: 0.6416094303131104
Epoch: 72, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.371 Vali Acc: 0.878 Test Loss: 0.371 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5348551273345947
Epoch: 73, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.369 Vali Acc: 0.874 Test Loss: 0.369 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.6606791019439697
Epoch: 74, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.368 Vali Acc: 0.874 Test Loss: 0.368 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.657799243927002
Epoch: 75, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.368 Vali Acc: 0.870 Test Loss: 0.368 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.5836222171783447
Epoch: 76, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.367 Vali Acc: 0.870 Test Loss: 0.367 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.5922527313232422
Epoch: 77, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.366 Vali Acc: 0.870 Test Loss: 0.366 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5722067356109619
Epoch: 78, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.365 Vali Acc: 0.874 Test Loss: 0.365 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.6363024711608887
Epoch: 79, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.6342034339904785
Epoch: 80, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.7056682109832764
Epoch: 81, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.364 Vali Acc: 0.878 Test Loss: 0.364 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 35958
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7253167629241943
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.873 Vali Acc: 0.200 Test Loss: 1.873 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 0.5489020347595215
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.854 Vali Acc: 0.211 Test Loss: 1.854 Test Acc: 0.211
Validation loss decreased (-0.199981 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.4813382625579834
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.841 Vali Acc: 0.219 Test Loss: 1.841 Test Acc: 0.219
Validation loss decreased (-0.211093 --> -0.218500).  Saving model ...
Epoch: 4 cost time: 0.4749274253845215
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.832 Vali Acc: 0.219 Test Loss: 1.832 Test Acc: 0.219
Validation loss decreased (-0.218500 --> -0.218500).  Saving model ...
Epoch: 5 cost time: 0.4279205799102783
Epoch: 5, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.820 Vali Acc: 0.230 Test Loss: 1.820 Test Acc: 0.230
Validation loss decreased (-0.218500 --> -0.229611).  Saving model ...
Epoch: 6 cost time: 0.4581887722015381
Epoch: 6, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.806 Vali Acc: 0.230 Test Loss: 1.806 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229612).  Saving model ...
Epoch: 7 cost time: 0.483182430267334
Epoch: 7, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.789 Vali Acc: 0.237 Test Loss: 1.789 Test Acc: 0.237
Validation loss decreased (-0.229612 --> -0.237019).  Saving model ...
Epoch: 8 cost time: 0.46848106384277344
Epoch: 8, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.771 Vali Acc: 0.244 Test Loss: 1.771 Test Acc: 0.244
Validation loss decreased (-0.237019 --> -0.244427).  Saving model ...
Epoch: 9 cost time: 0.49133872985839844
Epoch: 9, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.752 Vali Acc: 0.252 Test Loss: 1.752 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251834).  Saving model ...
Epoch: 10 cost time: 0.39690566062927246
Epoch: 10, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
Validation loss decreased (-0.251834 --> -0.259242).  Saving model ...
Epoch: 11 cost time: 0.42666077613830566
Epoch: 11, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.709 Vali Acc: 0.278 Test Loss: 1.709 Test Acc: 0.278
Validation loss decreased (-0.259242 --> -0.277761).  Saving model ...
Epoch: 12 cost time: 0.49315619468688965
Epoch: 12, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.686 Vali Acc: 0.281 Test Loss: 1.686 Test Acc: 0.281
Validation loss decreased (-0.277761 --> -0.281465).  Saving model ...
Epoch: 13 cost time: 0.4713265895843506
Epoch: 13, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.663 Vali Acc: 0.296 Test Loss: 1.663 Test Acc: 0.296
Validation loss decreased (-0.281465 --> -0.296280).  Saving model ...
Epoch: 14 cost time: 0.5412311553955078
Epoch: 14, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.638 Vali Acc: 0.307 Test Loss: 1.638 Test Acc: 0.307
Validation loss decreased (-0.296280 --> -0.307391).  Saving model ...
Epoch: 15 cost time: 0.51171875
Epoch: 15, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.613 Vali Acc: 0.319 Test Loss: 1.613 Test Acc: 0.319
Validation loss decreased (-0.307391 --> -0.318502).  Saving model ...
Epoch: 16 cost time: 0.5477643013000488
Epoch: 16, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.587 Vali Acc: 0.341 Test Loss: 1.587 Test Acc: 0.341
Validation loss decreased (-0.318502 --> -0.340725).  Saving model ...
Epoch: 17 cost time: 0.48531317710876465
Epoch: 17, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.561 Vali Acc: 0.344 Test Loss: 1.561 Test Acc: 0.344
Validation loss decreased (-0.340725 --> -0.344429).  Saving model ...
Epoch: 18 cost time: 0.43342041969299316
Epoch: 18, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.533 Vali Acc: 0.374 Test Loss: 1.533 Test Acc: 0.374
Validation loss decreased (-0.344429 --> -0.374059).  Saving model ...
Epoch: 19 cost time: 0.48157405853271484
Epoch: 19, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.506 Vali Acc: 0.381 Test Loss: 1.506 Test Acc: 0.381
Validation loss decreased (-0.374059 --> -0.381466).  Saving model ...
Epoch: 20 cost time: 0.4655721187591553
Epoch: 20, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.478 Vali Acc: 0.437 Test Loss: 1.478 Test Acc: 0.437
Validation loss decreased (-0.381466 --> -0.437022).  Saving model ...
Epoch: 21 cost time: 0.4595942497253418
Epoch: 21, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.450 Vali Acc: 0.478 Test Loss: 1.450 Test Acc: 0.478
Validation loss decreased (-0.437022 --> -0.477763).  Saving model ...
Epoch: 22 cost time: 0.39887022972106934
Epoch: 22, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.422 Vali Acc: 0.533 Test Loss: 1.422 Test Acc: 0.533
Validation loss decreased (-0.477763 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.569251537322998
Epoch: 23, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.393 Vali Acc: 0.611 Test Loss: 1.393 Test Acc: 0.611
Validation loss decreased (-0.533319 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.45519590377807617
Epoch: 24, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.363 Vali Acc: 0.652 Test Loss: 1.363 Test Acc: 0.652
Validation loss decreased (-0.611097 --> -0.651838).  Saving model ...
Epoch: 25 cost time: 0.4607882499694824
Epoch: 25, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.334 Vali Acc: 0.667 Test Loss: 1.334 Test Acc: 0.667
Validation loss decreased (-0.651838 --> -0.666653).  Saving model ...
Epoch: 26 cost time: 0.465299129486084
Epoch: 26, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.304 Vali Acc: 0.685 Test Loss: 1.304 Test Acc: 0.685
Validation loss decreased (-0.666653 --> -0.685172).  Saving model ...
Epoch: 27 cost time: 0.45256781578063965
Epoch: 27, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.274 Vali Acc: 0.719 Test Loss: 1.274 Test Acc: 0.719
Validation loss decreased (-0.685172 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.4357304573059082
Epoch: 28, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.244 Vali Acc: 0.726 Test Loss: 1.244 Test Acc: 0.726
Validation loss decreased (-0.718506 --> -0.725913).  Saving model ...
Epoch: 29 cost time: 0.47904253005981445
Epoch: 29, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.214 Vali Acc: 0.748 Test Loss: 1.214 Test Acc: 0.748
Validation loss decreased (-0.725913 --> -0.748136).  Saving model ...
Epoch: 30 cost time: 0.4519965648651123
Epoch: 30, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.184 Vali Acc: 0.756 Test Loss: 1.184 Test Acc: 0.756
Validation loss decreased (-0.748136 --> -0.755544).  Saving model ...
Epoch: 31 cost time: 0.46798038482666016
Epoch: 31, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.154 Vali Acc: 0.770 Test Loss: 1.154 Test Acc: 0.770
Validation loss decreased (-0.755544 --> -0.770359).  Saving model ...
Epoch: 32 cost time: 0.4652736186981201
Epoch: 32, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.123 Vali Acc: 0.785 Test Loss: 1.123 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785174).  Saving model ...
Epoch: 33 cost time: 0.5297455787658691
Epoch: 33, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.092 Vali Acc: 0.804 Test Loss: 1.092 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803693).  Saving model ...
Epoch: 34 cost time: 0.4362447261810303
Epoch: 34, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.062 Vali Acc: 0.815 Test Loss: 1.062 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814804).  Saving model ...
Epoch: 35 cost time: 0.5143811702728271
Epoch: 35, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.031 Vali Acc: 0.822 Test Loss: 1.031 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 36 cost time: 0.46727466583251953
Epoch: 36, Steps: 2 | Train Loss: 0.880 Vali Loss: 1.001 Vali Acc: 0.841 Test Loss: 1.001 Test Acc: 0.841
Validation loss decreased (-0.822212 --> -0.840731).  Saving model ...
Epoch: 37 cost time: 0.4999840259552002
Epoch: 37, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.970 Vali Acc: 0.856 Test Loss: 0.970 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855546).  Saving model ...
Epoch: 38 cost time: 0.5140438079833984
Epoch: 38, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.939 Vali Acc: 0.859 Test Loss: 0.939 Test Acc: 0.859
Validation loss decreased (-0.855546 --> -0.859250).  Saving model ...
Epoch: 39 cost time: 0.6603882312774658
Epoch: 39, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.908 Vali Acc: 0.863 Test Loss: 0.908 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 40 cost time: 0.5043749809265137
Epoch: 40, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.877 Vali Acc: 0.874 Test Loss: 0.877 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874065).  Saving model ...
Epoch: 41 cost time: 0.6022133827209473
Epoch: 41, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.846 Vali Acc: 0.874 Test Loss: 0.846 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874066).  Saving model ...
Epoch: 42 cost time: 0.5732336044311523
Epoch: 42, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.816 Vali Acc: 0.878 Test Loss: 0.816 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 43 cost time: 0.7676856517791748
Epoch: 43, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.786 Vali Acc: 0.870 Test Loss: 0.786 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.46329593658447266
Epoch: 44, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.756 Vali Acc: 0.870 Test Loss: 0.756 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4954369068145752
Epoch: 45, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.726 Vali Acc: 0.867 Test Loss: 0.726 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.6689283847808838
Epoch: 46, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.697 Vali Acc: 0.881 Test Loss: 0.697 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881475).  Saving model ...
Epoch: 47 cost time: 0.7187962532043457
Epoch: 47, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.668 Vali Acc: 0.874 Test Loss: 0.668 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7203125953674316
Epoch: 48, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.640 Vali Acc: 0.881 Test Loss: 0.640 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 49 cost time: 0.49215054512023926
Epoch: 49, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.612 Vali Acc: 0.881 Test Loss: 0.612 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 50 cost time: 0.6197173595428467
Epoch: 50, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.585 Vali Acc: 0.889 Test Loss: 0.585 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 0.586280107498169
Epoch: 51, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 52 cost time: 0.5394637584686279
Epoch: 52, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.533 Vali Acc: 0.889 Test Loss: 0.533 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 53 cost time: 0.6075546741485596
Epoch: 53, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.509 Vali Acc: 0.893 Test Loss: 0.509 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 54 cost time: 0.5426838397979736
Epoch: 54, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.486 Vali Acc: 0.893 Test Loss: 0.486 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 55 cost time: 0.5967943668365479
Epoch: 55, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.465 Vali Acc: 0.893 Test Loss: 0.465 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 56 cost time: 0.5784084796905518
Epoch: 56, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.446 Vali Acc: 0.893 Test Loss: 0.446 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 57 cost time: 0.4683670997619629
Epoch: 57, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5589897632598877
Epoch: 58, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.412 Vali Acc: 0.889 Test Loss: 0.412 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5392153263092041
Epoch: 59, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.399 Vali Acc: 0.893 Test Loss: 0.399 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892589).  Saving model ...
Epoch: 60 cost time: 0.5902955532073975
Epoch: 60, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.387 Vali Acc: 0.893 Test Loss: 0.387 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 61 cost time: 0.5695052146911621
Epoch: 61, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5636029243469238
Epoch: 62, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.369 Vali Acc: 0.893 Test Loss: 0.369 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 63 cost time: 0.5305910110473633
Epoch: 63, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.363 Vali Acc: 0.889 Test Loss: 0.363 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.553269624710083
Epoch: 64, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.358 Vali Acc: 0.893 Test Loss: 0.358 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 65 cost time: 0.5703475475311279
Epoch: 65, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.354 Vali Acc: 0.896 Test Loss: 0.354 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 66 cost time: 0.6566250324249268
Epoch: 66, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.351 Vali Acc: 0.896 Test Loss: 0.351 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 67 cost time: 0.6026325225830078
Epoch: 67, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.349 Vali Acc: 0.896 Test Loss: 0.349 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 68 cost time: 0.6223914623260498
Epoch: 68, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.349 Vali Acc: 0.893 Test Loss: 0.349 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.5349652767181396
Epoch: 69, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.893 Test Loss: 0.348 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6753225326538086
Epoch: 70, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.349 Vali Acc: 0.893 Test Loss: 0.349 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.543328046798706
Epoch: 71, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.6767942905426025
Epoch: 72, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.7053542137145996
Epoch: 73, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.352 Vali Acc: 0.878 Test Loss: 0.352 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.542595386505127
Epoch: 74, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.354 Vali Acc: 0.878 Test Loss: 0.354 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.6261534690856934
Epoch: 75, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.356 Vali Acc: 0.885 Test Loss: 0.356 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.5851607322692871
Epoch: 76, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.358 Vali Acc: 0.885 Test Loss: 0.358 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.6689009666442871
Epoch: 77, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.359 Vali Acc: 0.881 Test Loss: 0.359 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 35466
model size : 0.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6948161125183105
Epoch: 1, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.909 Vali Acc: 0.074 Test Loss: 1.909 Test Acc: 0.074
Validation loss decreased (inf --> -0.074055).  Saving model ...
Epoch: 2 cost time: 0.3968791961669922
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.887 Vali Acc: 0.093 Test Loss: 1.887 Test Acc: 0.093
Validation loss decreased (-0.074055 --> -0.092574).  Saving model ...
Epoch: 3 cost time: 0.45594000816345215
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.873 Vali Acc: 0.096 Test Loss: 1.873 Test Acc: 0.096
Validation loss decreased (-0.092574 --> -0.096278).  Saving model ...
Epoch: 4 cost time: 0.5202126502990723
Epoch: 4, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.863 Vali Acc: 0.104 Test Loss: 1.863 Test Acc: 0.104
Validation loss decreased (-0.096278 --> -0.103685).  Saving model ...
Epoch: 5 cost time: 0.6276822090148926
Epoch: 5, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.850 Vali Acc: 0.111 Test Loss: 1.850 Test Acc: 0.111
Validation loss decreased (-0.103685 --> -0.111093).  Saving model ...
Epoch: 6 cost time: 0.5302226543426514
Epoch: 6, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.834 Vali Acc: 0.119 Test Loss: 1.834 Test Acc: 0.119
Validation loss decreased (-0.111093 --> -0.118500).  Saving model ...
Epoch: 7 cost time: 0.486560583114624
Epoch: 7, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.817 Vali Acc: 0.130 Test Loss: 1.817 Test Acc: 0.130
Validation loss decreased (-0.118500 --> -0.129611).  Saving model ...
Epoch: 8 cost time: 0.46283650398254395
Epoch: 8, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.798 Vali Acc: 0.141 Test Loss: 1.798 Test Acc: 0.141
Validation loss decreased (-0.129611 --> -0.140723).  Saving model ...
Epoch: 9 cost time: 0.6082162857055664
Epoch: 9, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.777 Vali Acc: 0.174 Test Loss: 1.777 Test Acc: 0.174
Validation loss decreased (-0.140723 --> -0.174056).  Saving model ...
Epoch: 10 cost time: 0.47856712341308594
Epoch: 10, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.755 Vali Acc: 0.193 Test Loss: 1.755 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 11 cost time: 0.7058005332946777
Epoch: 11, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.732 Vali Acc: 0.204 Test Loss: 1.732 Test Acc: 0.204
Validation loss decreased (-0.192575 --> -0.203686).  Saving model ...
Epoch: 12 cost time: 0.6364364624023438
Epoch: 12, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.708 Vali Acc: 0.222 Test Loss: 1.708 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 13 cost time: 0.4940946102142334
Epoch: 13, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.684 Vali Acc: 0.259 Test Loss: 1.684 Test Acc: 0.259
Validation loss decreased (-0.222205 --> -0.259242).  Saving model ...
Epoch: 14 cost time: 0.47818732261657715
Epoch: 14, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.658 Vali Acc: 0.304 Test Loss: 1.658 Test Acc: 0.304
Validation loss decreased (-0.259242 --> -0.303687).  Saving model ...
Epoch: 15 cost time: 0.5518834590911865
Epoch: 15, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.632 Vali Acc: 0.352 Test Loss: 1.632 Test Acc: 0.352
Validation loss decreased (-0.303687 --> -0.351836).  Saving model ...
Epoch: 16 cost time: 0.5842244625091553
Epoch: 16, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.605 Vali Acc: 0.378 Test Loss: 1.605 Test Acc: 0.378
Validation loss decreased (-0.351836 --> -0.377762).  Saving model ...
Epoch: 17 cost time: 0.5602254867553711
Epoch: 17, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.577 Vali Acc: 0.422 Test Loss: 1.577 Test Acc: 0.422
Validation loss decreased (-0.377762 --> -0.422206).  Saving model ...
Epoch: 18 cost time: 0.573462963104248
Epoch: 18, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.550 Vali Acc: 0.456 Test Loss: 1.550 Test Acc: 0.456
Validation loss decreased (-0.422206 --> -0.455540).  Saving model ...
Epoch: 19 cost time: 0.5214424133300781
Epoch: 19, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.521 Vali Acc: 0.489 Test Loss: 1.521 Test Acc: 0.489
Validation loss decreased (-0.455540 --> -0.488874).  Saving model ...
Epoch: 20 cost time: 0.5081641674041748
Epoch: 20, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.493 Vali Acc: 0.541 Test Loss: 1.493 Test Acc: 0.541
Validation loss decreased (-0.488874 --> -0.540726).  Saving model ...
Epoch: 21 cost time: 0.45602941513061523
Epoch: 21, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.464 Vali Acc: 0.570 Test Loss: 1.464 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 22 cost time: 0.577481746673584
Epoch: 22, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.434 Vali Acc: 0.593 Test Loss: 1.434 Test Acc: 0.593
Validation loss decreased (-0.570356 --> -0.592578).  Saving model ...
Epoch: 23 cost time: 0.4651670455932617
Epoch: 23, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.404 Vali Acc: 0.611 Test Loss: 1.404 Test Acc: 0.611
Validation loss decreased (-0.592578 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.46904516220092773
Epoch: 24, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.374 Vali Acc: 0.630 Test Loss: 1.374 Test Acc: 0.630
Validation loss decreased (-0.611097 --> -0.629616).  Saving model ...
Epoch: 25 cost time: 0.583587646484375
Epoch: 25, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.344 Vali Acc: 0.681 Test Loss: 1.344 Test Acc: 0.681
Validation loss decreased (-0.629616 --> -0.681468).  Saving model ...
Epoch: 26 cost time: 0.5212016105651855
Epoch: 26, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.313 Vali Acc: 0.730 Test Loss: 1.313 Test Acc: 0.730
Validation loss decreased (-0.681468 --> -0.729616).  Saving model ...
Epoch: 27 cost time: 0.5057897567749023
Epoch: 27, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.283 Vali Acc: 0.741 Test Loss: 1.283 Test Acc: 0.741
Validation loss decreased (-0.729616 --> -0.740728).  Saving model ...
Epoch: 28 cost time: 0.4321269989013672
Epoch: 28, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.252 Vali Acc: 0.770 Test Loss: 1.252 Test Acc: 0.770
Validation loss decreased (-0.740728 --> -0.770358).  Saving model ...
Epoch: 29 cost time: 0.6055316925048828
Epoch: 29, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.221 Vali Acc: 0.793 Test Loss: 1.221 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792580).  Saving model ...
Epoch: 30 cost time: 0.5567681789398193
Epoch: 30, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.190 Vali Acc: 0.804 Test Loss: 1.190 Test Acc: 0.804
Validation loss decreased (-0.792580 --> -0.803692).  Saving model ...
Epoch: 31 cost time: 0.49396800994873047
Epoch: 31, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.159 Vali Acc: 0.811 Test Loss: 1.159 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811100).  Saving model ...
Epoch: 32 cost time: 0.6447045803070068
Epoch: 32, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.127 Vali Acc: 0.822 Test Loss: 1.127 Test Acc: 0.822
Validation loss decreased (-0.811100 --> -0.822211).  Saving model ...
Epoch: 33 cost time: 0.5171856880187988
Epoch: 33, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.096 Vali Acc: 0.841 Test Loss: 1.096 Test Acc: 0.841
Validation loss decreased (-0.822211 --> -0.840730).  Saving model ...
Epoch: 34 cost time: 0.4902174472808838
Epoch: 34, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.064 Vali Acc: 0.844 Test Loss: 1.064 Test Acc: 0.844
Validation loss decreased (-0.840730 --> -0.844434).  Saving model ...
Epoch: 35 cost time: 0.5416238307952881
Epoch: 35, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.033 Vali Acc: 0.859 Test Loss: 1.033 Test Acc: 0.859
Validation loss decreased (-0.844434 --> -0.859249).  Saving model ...
Epoch: 36 cost time: 0.5609099864959717
Epoch: 36, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.001 Vali Acc: 0.870 Test Loss: 1.001 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870360).  Saving model ...
Epoch: 37 cost time: 0.5363352298736572
Epoch: 37, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.969 Vali Acc: 0.870 Test Loss: 0.969 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870361).  Saving model ...
Epoch: 38 cost time: 0.7131481170654297
Epoch: 38, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.938 Vali Acc: 0.878 Test Loss: 0.938 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877768).  Saving model ...
Epoch: 39 cost time: 0.5385539531707764
Epoch: 39, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.907 Vali Acc: 0.878 Test Loss: 0.907 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877769).  Saving model ...
Epoch: 40 cost time: 0.5581352710723877
Epoch: 40, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.875 Vali Acc: 0.881 Test Loss: 0.875 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 41 cost time: 0.5626339912414551
Epoch: 41, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.844 Vali Acc: 0.889 Test Loss: 0.844 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888880).  Saving model ...
Epoch: 42 cost time: 0.5407135486602783
Epoch: 42, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.813 Vali Acc: 0.893 Test Loss: 0.813 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 43 cost time: 0.5557997226715088
Epoch: 43, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.782 Vali Acc: 0.900 Test Loss: 0.782 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 44 cost time: 0.569786548614502
Epoch: 44, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.752 Vali Acc: 0.904 Test Loss: 0.752 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 45 cost time: 0.5582623481750488
Epoch: 45, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.721 Vali Acc: 0.904 Test Loss: 0.721 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 46 cost time: 0.5436611175537109
Epoch: 46, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.691 Vali Acc: 0.907 Test Loss: 0.691 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 47 cost time: 0.5526003837585449
Epoch: 47, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.661 Vali Acc: 0.907 Test Loss: 0.661 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 48 cost time: 0.5061430931091309
Epoch: 48, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 49 cost time: 0.49782323837280273
Epoch: 49, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.602 Vali Acc: 0.915 Test Loss: 0.602 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 50 cost time: 0.5287027359008789
Epoch: 50, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.574 Vali Acc: 0.915 Test Loss: 0.574 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 51 cost time: 0.5580658912658691
Epoch: 51, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.545 Vali Acc: 0.915 Test Loss: 0.545 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 52 cost time: 0.49080467224121094
Epoch: 52, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.517 Vali Acc: 0.915 Test Loss: 0.517 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 53 cost time: 0.641817569732666
Epoch: 53, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.490 Vali Acc: 0.911 Test Loss: 0.490 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4537839889526367
Epoch: 54, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 55 cost time: 0.5578312873840332
Epoch: 55, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.440 Vali Acc: 0.915 Test Loss: 0.440 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 56 cost time: 0.4779171943664551
Epoch: 56, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.416 Vali Acc: 0.915 Test Loss: 0.416 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 57 cost time: 0.48187685012817383
Epoch: 57, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5036547183990479
Epoch: 58, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.5669894218444824
Epoch: 59, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.46743226051330566
Epoch: 60, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.336 Vali Acc: 0.904 Test Loss: 0.336 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.46566224098205566
Epoch: 61, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.320 Vali Acc: 0.904 Test Loss: 0.320 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.4941675662994385
Epoch: 62, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.539435625076294
Epoch: 63, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.295 Vali Acc: 0.904 Test Loss: 0.295 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.5196821689605713
Epoch: 64, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.540839433670044
Epoch: 65, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.275 Vali Acc: 0.904 Test Loss: 0.275 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.6313927173614502
Epoch: 66, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.268 Vali Acc: 0.896 Test Loss: 0.268 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 34781
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5313756465911865
Epoch: 1, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.627 Vali Acc: 0.326 Test Loss: 1.627 Test Acc: 0.326
Validation loss decreased (inf --> -0.325910).  Saving model ...
Epoch: 2 cost time: 0.44290971755981445
Epoch: 2, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.612 Vali Acc: 0.330 Test Loss: 1.612 Test Acc: 0.330
Validation loss decreased (-0.325910 --> -0.329614).  Saving model ...
Epoch: 3 cost time: 0.5371472835540771
Epoch: 3, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.602 Vali Acc: 0.348 Test Loss: 1.602 Test Acc: 0.348
Validation loss decreased (-0.329614 --> -0.348132).  Saving model ...
Epoch: 4 cost time: 0.47665977478027344
Epoch: 4, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.594 Vali Acc: 0.367 Test Loss: 1.594 Test Acc: 0.367
Validation loss decreased (-0.348132 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.45375823974609375
Epoch: 5, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.584 Vali Acc: 0.381 Test Loss: 1.584 Test Acc: 0.381
Validation loss decreased (-0.366651 --> -0.381466).  Saving model ...
Epoch: 6 cost time: 0.48838257789611816
Epoch: 6, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.572 Vali Acc: 0.393 Test Loss: 1.572 Test Acc: 0.393
Validation loss decreased (-0.381466 --> -0.392577).  Saving model ...
Epoch: 7 cost time: 0.6236121654510498
Epoch: 7, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.558 Vali Acc: 0.444 Test Loss: 1.558 Test Acc: 0.444
Validation loss decreased (-0.392577 --> -0.444429).  Saving model ...
Epoch: 8 cost time: 0.5342941284179688
Epoch: 8, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.543 Vali Acc: 0.493 Test Loss: 1.543 Test Acc: 0.493
Validation loss decreased (-0.444429 --> -0.492577).  Saving model ...
Epoch: 9 cost time: 0.45268869400024414
Epoch: 9, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.526 Vali Acc: 0.522 Test Loss: 1.526 Test Acc: 0.522
Validation loss decreased (-0.492577 --> -0.522207).  Saving model ...
Epoch: 10 cost time: 0.39329075813293457
Epoch: 10, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.509 Vali Acc: 0.563 Test Loss: 1.509 Test Acc: 0.563
Validation loss decreased (-0.522207 --> -0.562948).  Saving model ...
Epoch: 11 cost time: 0.5371448993682861
Epoch: 11, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.490 Vali Acc: 0.604 Test Loss: 1.490 Test Acc: 0.604
Validation loss decreased (-0.562948 --> -0.603689).  Saving model ...
Epoch: 12 cost time: 0.5930814743041992
Epoch: 12, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.470 Vali Acc: 0.633 Test Loss: 1.470 Test Acc: 0.633
Validation loss decreased (-0.603689 --> -0.633319).  Saving model ...
Epoch: 13 cost time: 0.5609700679779053
Epoch: 13, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.449 Vali Acc: 0.670 Test Loss: 1.449 Test Acc: 0.670
Validation loss decreased (-0.633319 --> -0.670356).  Saving model ...
Epoch: 14 cost time: 0.5067799091339111
Epoch: 14, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.428 Vali Acc: 0.696 Test Loss: 1.428 Test Acc: 0.696
Validation loss decreased (-0.670356 --> -0.696282).  Saving model ...
Epoch: 15 cost time: 0.4301309585571289
Epoch: 15, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.406 Vali Acc: 0.707 Test Loss: 1.406 Test Acc: 0.707
Validation loss decreased (-0.696282 --> -0.707393).  Saving model ...
Epoch: 16 cost time: 0.46418070793151855
Epoch: 16, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.383 Vali Acc: 0.726 Test Loss: 1.383 Test Acc: 0.726
Validation loss decreased (-0.707393 --> -0.725912).  Saving model ...
Epoch: 17 cost time: 0.5035035610198975
Epoch: 17, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.360 Vali Acc: 0.763 Test Loss: 1.360 Test Acc: 0.763
Validation loss decreased (-0.725912 --> -0.762949).  Saving model ...
Epoch: 18 cost time: 0.5489232540130615
Epoch: 18, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.336 Vali Acc: 0.774 Test Loss: 1.336 Test Acc: 0.774
Validation loss decreased (-0.762949 --> -0.774061).  Saving model ...
Epoch: 19 cost time: 0.5759222507476807
Epoch: 19, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.312 Vali Acc: 0.781 Test Loss: 1.312 Test Acc: 0.781
Validation loss decreased (-0.774061 --> -0.781468).  Saving model ...
Epoch: 20 cost time: 0.513542652130127
Epoch: 20, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.287 Vali Acc: 0.796 Test Loss: 1.287 Test Acc: 0.796
Validation loss decreased (-0.781468 --> -0.796283).  Saving model ...
Epoch: 21 cost time: 0.4832167625427246
Epoch: 21, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.262 Vali Acc: 0.800 Test Loss: 1.262 Test Acc: 0.800
Validation loss decreased (-0.796283 --> -0.799987).  Saving model ...
Epoch: 22 cost time: 0.5633916854858398
Epoch: 22, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.236 Vali Acc: 0.811 Test Loss: 1.236 Test Acc: 0.811
Validation loss decreased (-0.799987 --> -0.811099).  Saving model ...
Epoch: 23 cost time: 0.5083010196685791
Epoch: 23, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.210 Vali Acc: 0.826 Test Loss: 1.210 Test Acc: 0.826
Validation loss decreased (-0.811099 --> -0.825914).  Saving model ...
Epoch: 24 cost time: 0.5892798900604248
Epoch: 24, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.184 Vali Acc: 0.830 Test Loss: 1.184 Test Acc: 0.830
Validation loss decreased (-0.825914 --> -0.829618).  Saving model ...
Epoch: 25 cost time: 0.45315980911254883
Epoch: 25, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.158 Vali Acc: 0.833 Test Loss: 1.158 Test Acc: 0.833
Validation loss decreased (-0.829618 --> -0.833322).  Saving model ...
Epoch: 26 cost time: 0.4822998046875
Epoch: 26, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.131 Vali Acc: 0.841 Test Loss: 1.131 Test Acc: 0.841
Validation loss decreased (-0.833322 --> -0.840729).  Saving model ...
Epoch: 27 cost time: 0.4183018207550049
Epoch: 27, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.104 Vali Acc: 0.852 Test Loss: 1.104 Test Acc: 0.852
Validation loss decreased (-0.840729 --> -0.851841).  Saving model ...
Epoch: 28 cost time: 0.5630407333374023
Epoch: 28, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.077 Vali Acc: 0.852 Test Loss: 1.077 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851841).  Saving model ...
Epoch: 29 cost time: 0.45580101013183594
Epoch: 29, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.050 Vali Acc: 0.852 Test Loss: 1.050 Test Acc: 0.852
Validation loss decreased (-0.851841 --> -0.851841).  Saving model ...
Epoch: 30 cost time: 0.3875246047973633
Epoch: 30, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.024 Vali Acc: 0.867 Test Loss: 1.024 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866656).  Saving model ...
Epoch: 31 cost time: 0.6167941093444824
Epoch: 31, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.998 Vali Acc: 0.863 Test Loss: 0.998 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.4846932888031006
Epoch: 32, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.971 Vali Acc: 0.874 Test Loss: 0.971 Test Acc: 0.874
Validation loss decreased (-0.866656 --> -0.874064).  Saving model ...
Epoch: 33 cost time: 0.4561886787414551
Epoch: 33, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.946 Vali Acc: 0.874 Test Loss: 0.946 Test Acc: 0.874
Validation loss decreased (-0.874064 --> -0.874065).  Saving model ...
Epoch: 34 cost time: 0.5354855060577393
Epoch: 34, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.920 Vali Acc: 0.878 Test Loss: 0.920 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 35 cost time: 0.4145054817199707
Epoch: 35, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.895 Vali Acc: 0.878 Test Loss: 0.895 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877769).  Saving model ...
Epoch: 36 cost time: 0.48714494705200195
Epoch: 36, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.870 Vali Acc: 0.881 Test Loss: 0.870 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 37 cost time: 0.5483927726745605
Epoch: 37, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.845 Vali Acc: 0.889 Test Loss: 0.845 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888880).  Saving model ...
Epoch: 38 cost time: 0.5448651313781738
Epoch: 38, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.821 Vali Acc: 0.893 Test Loss: 0.821 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 39 cost time: 0.45472002029418945
Epoch: 39, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.797 Vali Acc: 0.900 Test Loss: 0.797 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 40 cost time: 0.536400556564331
Epoch: 40, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.774 Vali Acc: 0.904 Test Loss: 0.774 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 41 cost time: 0.4293534755706787
Epoch: 41, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.751 Vali Acc: 0.904 Test Loss: 0.751 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 42 cost time: 0.47751402854919434
Epoch: 42, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.729 Vali Acc: 0.904 Test Loss: 0.729 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 43 cost time: 0.4609212875366211
Epoch: 43, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.707 Vali Acc: 0.904 Test Loss: 0.707 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 44 cost time: 0.46407556533813477
Epoch: 44, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.686 Vali Acc: 0.907 Test Loss: 0.686 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 45 cost time: 0.5152740478515625
Epoch: 45, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.665 Vali Acc: 0.907 Test Loss: 0.665 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 46 cost time: 0.39285898208618164
Epoch: 46, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.644 Vali Acc: 0.911 Test Loss: 0.644 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 47 cost time: 0.48511290550231934
Epoch: 47, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.624 Vali Acc: 0.911 Test Loss: 0.624 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 48 cost time: 0.44677233695983887
Epoch: 48, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.605 Vali Acc: 0.911 Test Loss: 0.605 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 49 cost time: 0.43804454803466797
Epoch: 49, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.586 Vali Acc: 0.915 Test Loss: 0.586 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 50 cost time: 0.5452992916107178
Epoch: 50, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.568 Vali Acc: 0.922 Test Loss: 0.568 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 51 cost time: 0.5691661834716797
Epoch: 51, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.390949010848999
Epoch: 52, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.533 Vali Acc: 0.915 Test Loss: 0.533 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.556572437286377
Epoch: 53, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.517 Vali Acc: 0.922 Test Loss: 0.517 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 54 cost time: 0.4677748680114746
Epoch: 54, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.501 Vali Acc: 0.919 Test Loss: 0.501 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5303075313568115
Epoch: 55, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.485 Vali Acc: 0.919 Test Loss: 0.485 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5264599323272705
Epoch: 56, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 57 cost time: 0.5101766586303711
Epoch: 57, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5960450172424316
Epoch: 58, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.443 Vali Acc: 0.911 Test Loss: 0.443 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.46061253547668457
Epoch: 59, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.4619121551513672
Epoch: 60, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.418 Vali Acc: 0.915 Test Loss: 0.418 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5263879299163818
Epoch: 61, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5940818786621094
Epoch: 62, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.398 Vali Acc: 0.919 Test Loss: 0.398 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.4512608051300049
Epoch: 63, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.389 Vali Acc: 0.919 Test Loss: 0.389 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.5815858840942383
Epoch: 64, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.5080687999725342
Epoch: 65, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.6865975856781006
Epoch: 66, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 34616
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6038706302642822
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.872 Vali Acc: 0.163 Test Loss: 1.872 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.462172269821167
Epoch: 2, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.851 Vali Acc: 0.174 Test Loss: 1.851 Test Acc: 0.174
Validation loss decreased (-0.162944 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.44565606117248535
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.837 Vali Acc: 0.185 Test Loss: 1.837 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.4800071716308594
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.827 Vali Acc: 0.185 Test Loss: 1.827 Test Acc: 0.185
Validation loss decreased (-0.185167 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.4033164978027344
Epoch: 5, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.815 Vali Acc: 0.193 Test Loss: 1.815 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 6 cost time: 0.4274594783782959
Epoch: 6, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.800 Vali Acc: 0.207 Test Loss: 1.800 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 7 cost time: 0.3818645477294922
Epoch: 7, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.783 Vali Acc: 0.222 Test Loss: 1.783 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 8 cost time: 0.4499485492706299
Epoch: 8, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.765 Vali Acc: 0.263 Test Loss: 1.765 Test Acc: 0.263
Validation loss decreased (-0.222204 --> -0.262945).  Saving model ...
Epoch: 9 cost time: 0.4271509647369385
Epoch: 9, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.745 Vali Acc: 0.278 Test Loss: 1.745 Test Acc: 0.278
Validation loss decreased (-0.262945 --> -0.277760).  Saving model ...
Epoch: 10 cost time: 0.47353219985961914
Epoch: 10, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.723 Vali Acc: 0.293 Test Loss: 1.723 Test Acc: 0.293
Validation loss decreased (-0.277760 --> -0.292575).  Saving model ...
Epoch: 11 cost time: 0.5101299285888672
Epoch: 11, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.701 Vali Acc: 0.319 Test Loss: 1.701 Test Acc: 0.319
Validation loss decreased (-0.292575 --> -0.318502).  Saving model ...
Epoch: 12 cost time: 0.3902273178100586
Epoch: 12, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.677 Vali Acc: 0.341 Test Loss: 1.677 Test Acc: 0.341
Validation loss decreased (-0.318502 --> -0.340724).  Saving model ...
Epoch: 13 cost time: 0.5045080184936523
Epoch: 13, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.652 Vali Acc: 0.367 Test Loss: 1.652 Test Acc: 0.367
Validation loss decreased (-0.340724 --> -0.366650).  Saving model ...
Epoch: 14 cost time: 0.5299901962280273
Epoch: 14, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.626 Vali Acc: 0.378 Test Loss: 1.626 Test Acc: 0.378
Validation loss decreased (-0.366650 --> -0.377762).  Saving model ...
Epoch: 15 cost time: 0.43364572525024414
Epoch: 15, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.599 Vali Acc: 0.404 Test Loss: 1.599 Test Acc: 0.404
Validation loss decreased (-0.377762 --> -0.403688).  Saving model ...
Epoch: 16 cost time: 0.48633790016174316
Epoch: 16, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.571 Vali Acc: 0.430 Test Loss: 1.571 Test Acc: 0.430
Validation loss decreased (-0.403688 --> -0.429614).  Saving model ...
Epoch: 17 cost time: 0.4455552101135254
Epoch: 17, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.543 Vali Acc: 0.456 Test Loss: 1.543 Test Acc: 0.456
Validation loss decreased (-0.429614 --> -0.455540).  Saving model ...
Epoch: 18 cost time: 0.6270864009857178
Epoch: 18, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.514 Vali Acc: 0.463 Test Loss: 1.514 Test Acc: 0.463
Validation loss decreased (-0.455540 --> -0.462948).  Saving model ...
Epoch: 19 cost time: 0.476837158203125
Epoch: 19, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.484 Vali Acc: 0.481 Test Loss: 1.484 Test Acc: 0.481
Validation loss decreased (-0.462948 --> -0.481467).  Saving model ...
Epoch: 20 cost time: 0.4531991481781006
Epoch: 20, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.453 Vali Acc: 0.496 Test Loss: 1.453 Test Acc: 0.496
Validation loss decreased (-0.481467 --> -0.496282).  Saving model ...
Epoch: 21 cost time: 0.4397704601287842
Epoch: 21, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.422 Vali Acc: 0.530 Test Loss: 1.422 Test Acc: 0.530
Validation loss decreased (-0.496282 --> -0.529615).  Saving model ...
Epoch: 22 cost time: 0.4999833106994629
Epoch: 22, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.390 Vali Acc: 0.552 Test Loss: 1.390 Test Acc: 0.552
Validation loss decreased (-0.529615 --> -0.551838).  Saving model ...
Epoch: 23 cost time: 0.5930075645446777
Epoch: 23, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.358 Vali Acc: 0.574 Test Loss: 1.358 Test Acc: 0.574
Validation loss decreased (-0.551838 --> -0.574060).  Saving model ...
Epoch: 24 cost time: 0.5066874027252197
Epoch: 24, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.324 Vali Acc: 0.600 Test Loss: 1.324 Test Acc: 0.600
Validation loss decreased (-0.574060 --> -0.599987).  Saving model ...
Epoch: 25 cost time: 0.5560717582702637
Epoch: 25, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.290 Vali Acc: 0.637 Test Loss: 1.290 Test Acc: 0.637
Validation loss decreased (-0.599987 --> -0.637024).  Saving model ...
Epoch: 26 cost time: 0.5111856460571289
Epoch: 26, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.255 Vali Acc: 0.652 Test Loss: 1.255 Test Acc: 0.652
Validation loss decreased (-0.637024 --> -0.651839).  Saving model ...
Epoch: 27 cost time: 0.5326292514801025
Epoch: 27, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.220 Vali Acc: 0.681 Test Loss: 1.220 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681469).  Saving model ...
Epoch: 28 cost time: 0.46489882469177246
Epoch: 28, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.184 Vali Acc: 0.704 Test Loss: 1.184 Test Acc: 0.704
Validation loss decreased (-0.681469 --> -0.703692).  Saving model ...
Epoch: 29 cost time: 0.5712153911590576
Epoch: 29, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
Validation loss decreased (-0.703692 --> -0.722211).  Saving model ...
Epoch: 30 cost time: 0.43189144134521484
Epoch: 30, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.109 Vali Acc: 0.730 Test Loss: 1.109 Test Acc: 0.730
Validation loss decreased (-0.722211 --> -0.729619).  Saving model ...
Epoch: 31 cost time: 0.463148832321167
Epoch: 31, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.070 Vali Acc: 0.748 Test Loss: 1.070 Test Acc: 0.748
Validation loss decreased (-0.729619 --> -0.748137).  Saving model ...
Epoch: 32 cost time: 0.485853910446167
Epoch: 32, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.031 Vali Acc: 0.770 Test Loss: 1.031 Test Acc: 0.770
Validation loss decreased (-0.748137 --> -0.770360).  Saving model ...
Epoch: 33 cost time: 0.5410256385803223
Epoch: 33, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.991 Vali Acc: 0.770 Test Loss: 0.991 Test Acc: 0.770
Validation loss decreased (-0.770360 --> -0.770360).  Saving model ...
Epoch: 34 cost time: 0.5703568458557129
Epoch: 34, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.950 Vali Acc: 0.774 Test Loss: 0.950 Test Acc: 0.774
Validation loss decreased (-0.770360 --> -0.774065).  Saving model ...
Epoch: 35 cost time: 0.46308016777038574
Epoch: 35, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.910 Vali Acc: 0.796 Test Loss: 0.910 Test Acc: 0.796
Validation loss decreased (-0.774065 --> -0.796287).  Saving model ...
Epoch: 36 cost time: 0.4881258010864258
Epoch: 36, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.869 Vali Acc: 0.807 Test Loss: 0.869 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 37 cost time: 0.5040285587310791
Epoch: 37, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.828 Vali Acc: 0.822 Test Loss: 0.828 Test Acc: 0.822
Validation loss decreased (-0.807399 --> -0.822214).  Saving model ...
Epoch: 38 cost time: 0.41996192932128906
Epoch: 38, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.788 Vali Acc: 0.815 Test Loss: 0.788 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5493769645690918
Epoch: 39, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.748 Vali Acc: 0.807 Test Loss: 0.748 Test Acc: 0.807
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.4389793872833252
Epoch: 40, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.709 Vali Acc: 0.822 Test Loss: 0.709 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822215).  Saving model ...
Epoch: 41 cost time: 0.592665433883667
Epoch: 41, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.671 Vali Acc: 0.826 Test Loss: 0.671 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 42 cost time: 0.4418482780456543
Epoch: 42, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.636 Vali Acc: 0.826 Test Loss: 0.636 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825920).  Saving model ...
Epoch: 43 cost time: 0.5371596813201904
Epoch: 43, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.603 Vali Acc: 0.833 Test Loss: 0.603 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833327).  Saving model ...
Epoch: 44 cost time: 0.5376200675964355
Epoch: 44, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.573 Vali Acc: 0.822 Test Loss: 0.573 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.4974386692047119
Epoch: 45, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.546 Vali Acc: 0.811 Test Loss: 0.546 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5878307819366455
Epoch: 46, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.523 Vali Acc: 0.804 Test Loss: 0.523 Test Acc: 0.804
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5222442150115967
Epoch: 47, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.503 Vali Acc: 0.804 Test Loss: 0.503 Test Acc: 0.804
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5023071765899658
Epoch: 48, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.485 Vali Acc: 0.819 Test Loss: 0.485 Test Acc: 0.819
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4762558937072754
Epoch: 49, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.470 Vali Acc: 0.819 Test Loss: 0.470 Test Acc: 0.819
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5034456253051758
Epoch: 50, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.459 Vali Acc: 0.822 Test Loss: 0.459 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5464913845062256
Epoch: 51, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.449 Vali Acc: 0.830 Test Loss: 0.449 Test Acc: 0.830
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.45100998878479004
Epoch: 52, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.442 Vali Acc: 0.837 Test Loss: 0.442 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837033).  Saving model ...
Epoch: 53 cost time: 0.41869473457336426
Epoch: 53, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.437 Vali Acc: 0.833 Test Loss: 0.437 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.574577808380127
Epoch: 54, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.435 Vali Acc: 0.804 Test Loss: 0.435 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5672667026519775
Epoch: 55, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.435 Vali Acc: 0.807 Test Loss: 0.435 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.4943079948425293
Epoch: 56, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.435 Vali Acc: 0.796 Test Loss: 0.435 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5679457187652588
Epoch: 57, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.437 Vali Acc: 0.793 Test Loss: 0.437 Test Acc: 0.793
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5739991664886475
Epoch: 58, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.441 Vali Acc: 0.781 Test Loss: 0.441 Test Acc: 0.781
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.4224977493286133
Epoch: 59, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.439 Vali Acc: 0.800 Test Loss: 0.439 Test Acc: 0.800
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.45944786071777344
Epoch: 60, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.440 Vali Acc: 0.800 Test Loss: 0.440 Test Acc: 0.800
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.5756583213806152
Epoch: 61, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.440 Vali Acc: 0.811 Test Loss: 0.440 Test Acc: 0.811
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.48573756217956543
Epoch: 62, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.442 Vali Acc: 0.815 Test Loss: 0.442 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.837037037037037
model parameter : 34778
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7728004455566406
Epoch: 1, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.887 Vali Acc: 0.096 Test Loss: 1.887 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.4884915351867676
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.870 Vali Acc: 0.115 Test Loss: 1.870 Test Acc: 0.115
Validation loss decreased (-0.096277 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 0.5573837757110596
Epoch: 3, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.859 Vali Acc: 0.119 Test Loss: 1.859 Test Acc: 0.119
Validation loss decreased (-0.114796 --> -0.118500).  Saving model ...
Epoch: 4 cost time: 0.5078377723693848
Epoch: 4, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.850 Vali Acc: 0.126 Test Loss: 1.850 Test Acc: 0.126
Validation loss decreased (-0.118500 --> -0.125907).  Saving model ...
Epoch: 5 cost time: 0.6888289451599121
Epoch: 5, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.839 Vali Acc: 0.137 Test Loss: 1.839 Test Acc: 0.137
Validation loss decreased (-0.125907 --> -0.137019).  Saving model ...
Epoch: 6 cost time: 0.5217533111572266
Epoch: 6, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.826 Vali Acc: 0.152 Test Loss: 1.826 Test Acc: 0.152
Validation loss decreased (-0.137019 --> -0.151834).  Saving model ...
Epoch: 7 cost time: 0.5285875797271729
Epoch: 7, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.811 Vali Acc: 0.178 Test Loss: 1.811 Test Acc: 0.178
Validation loss decreased (-0.151834 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.5101184844970703
Epoch: 8, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.794 Vali Acc: 0.189 Test Loss: 1.794 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 9 cost time: 0.5297322273254395
Epoch: 9, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.776 Vali Acc: 0.233 Test Loss: 1.776 Test Acc: 0.233
Validation loss decreased (-0.188871 --> -0.233316).  Saving model ...
Epoch: 10 cost time: 0.4585888385772705
Epoch: 10, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.758 Vali Acc: 0.256 Test Loss: 1.758 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255538).  Saving model ...
Epoch: 11 cost time: 0.5476846694946289
Epoch: 11, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.738 Vali Acc: 0.296 Test Loss: 1.738 Test Acc: 0.296
Validation loss decreased (-0.255538 --> -0.296279).  Saving model ...
Epoch: 12 cost time: 0.5537114143371582
Epoch: 12, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.717 Vali Acc: 0.326 Test Loss: 1.717 Test Acc: 0.326
Validation loss decreased (-0.296279 --> -0.325909).  Saving model ...
Epoch: 13 cost time: 0.4115180969238281
Epoch: 13, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.695 Vali Acc: 0.356 Test Loss: 1.695 Test Acc: 0.356
Validation loss decreased (-0.325909 --> -0.355539).  Saving model ...
Epoch: 14 cost time: 0.5022618770599365
Epoch: 14, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.673 Vali Acc: 0.381 Test Loss: 1.673 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 15 cost time: 0.5793929100036621
Epoch: 15, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.649 Vali Acc: 0.400 Test Loss: 1.649 Test Acc: 0.400
Validation loss decreased (-0.381465 --> -0.399984).  Saving model ...
Epoch: 16 cost time: 0.4343991279602051
Epoch: 16, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.626 Vali Acc: 0.448 Test Loss: 1.626 Test Acc: 0.448
Validation loss decreased (-0.399984 --> -0.448132).  Saving model ...
Epoch: 17 cost time: 0.4831364154815674
Epoch: 17, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.602 Vali Acc: 0.463 Test Loss: 1.602 Test Acc: 0.463
Validation loss decreased (-0.448132 --> -0.462947).  Saving model ...
Epoch: 18 cost time: 0.47085046768188477
Epoch: 18, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.577 Vali Acc: 0.485 Test Loss: 1.577 Test Acc: 0.485
Validation loss decreased (-0.462947 --> -0.485169).  Saving model ...
Epoch: 19 cost time: 0.42139768600463867
Epoch: 19, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.552 Vali Acc: 0.500 Test Loss: 1.552 Test Acc: 0.500
Validation loss decreased (-0.485169 --> -0.499984).  Saving model ...
Epoch: 20 cost time: 0.4920179843902588
Epoch: 20, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.526 Vali Acc: 0.526 Test Loss: 1.526 Test Acc: 0.526
Validation loss decreased (-0.499984 --> -0.525911).  Saving model ...
Epoch: 21 cost time: 0.4984414577484131
Epoch: 21, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.500 Vali Acc: 0.552 Test Loss: 1.500 Test Acc: 0.552
Validation loss decreased (-0.525911 --> -0.551837).  Saving model ...
Epoch: 22 cost time: 0.489213228225708
Epoch: 22, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.474 Vali Acc: 0.567 Test Loss: 1.474 Test Acc: 0.567
Validation loss decreased (-0.551837 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 0.4337763786315918
Epoch: 23, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.448 Vali Acc: 0.589 Test Loss: 1.448 Test Acc: 0.589
Validation loss decreased (-0.566652 --> -0.588874).  Saving model ...
Epoch: 24 cost time: 0.45068359375
Epoch: 24, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.421 Vali Acc: 0.630 Test Loss: 1.421 Test Acc: 0.630
Validation loss decreased (-0.588874 --> -0.629615).  Saving model ...
Epoch: 25 cost time: 0.5608730316162109
Epoch: 25, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.394 Vali Acc: 0.652 Test Loss: 1.394 Test Acc: 0.652
Validation loss decreased (-0.629615 --> -0.651838).  Saving model ...
Epoch: 26 cost time: 0.5175769329071045
Epoch: 26, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.367 Vali Acc: 0.689 Test Loss: 1.367 Test Acc: 0.689
Validation loss decreased (-0.651838 --> -0.688875).  Saving model ...
Epoch: 27 cost time: 0.5491306781768799
Epoch: 27, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.340 Vali Acc: 0.707 Test Loss: 1.340 Test Acc: 0.707
Validation loss decreased (-0.688875 --> -0.707394).  Saving model ...
Epoch: 28 cost time: 0.4142286777496338
Epoch: 28, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.312 Vali Acc: 0.719 Test Loss: 1.312 Test Acc: 0.719
Validation loss decreased (-0.707394 --> -0.718505).  Saving model ...
Epoch: 29 cost time: 0.4465780258178711
Epoch: 29, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.284 Vali Acc: 0.741 Test Loss: 1.284 Test Acc: 0.741
Validation loss decreased (-0.718505 --> -0.740728).  Saving model ...
Epoch: 30 cost time: 0.6303932666778564
Epoch: 30, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.256 Vali Acc: 0.748 Test Loss: 1.256 Test Acc: 0.748
Validation loss decreased (-0.740728 --> -0.748136).  Saving model ...
Epoch: 31 cost time: 0.5763206481933594
Epoch: 31, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.228 Vali Acc: 0.759 Test Loss: 1.228 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759247).  Saving model ...
Epoch: 32 cost time: 0.4706254005432129
Epoch: 32, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.200 Vali Acc: 0.767 Test Loss: 1.200 Test Acc: 0.767
Validation loss decreased (-0.759247 --> -0.766655).  Saving model ...
Epoch: 33 cost time: 0.537177562713623
Epoch: 33, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.172 Vali Acc: 0.785 Test Loss: 1.172 Test Acc: 0.785
Validation loss decreased (-0.766655 --> -0.785173).  Saving model ...
Epoch: 34 cost time: 0.6763181686401367
Epoch: 34, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.144 Vali Acc: 0.796 Test Loss: 1.144 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796285).  Saving model ...
Epoch: 35 cost time: 0.3921668529510498
Epoch: 35, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.116 Vali Acc: 0.811 Test Loss: 1.116 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811100).  Saving model ...
Epoch: 36 cost time: 0.4639105796813965
Epoch: 36, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.088 Vali Acc: 0.833 Test Loss: 1.088 Test Acc: 0.833
Validation loss decreased (-0.811100 --> -0.833322).  Saving model ...
Epoch: 37 cost time: 0.6582310199737549
Epoch: 37, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.060 Vali Acc: 0.844 Test Loss: 1.060 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844434).  Saving model ...
Epoch: 38 cost time: 0.45612215995788574
Epoch: 38, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.032 Vali Acc: 0.844 Test Loss: 1.032 Test Acc: 0.844
Validation loss decreased (-0.844434 --> -0.844434).  Saving model ...
Epoch: 39 cost time: 0.4898107051849365
Epoch: 39, Steps: 2 | Train Loss: 0.873 Vali Loss: 1.004 Vali Acc: 0.863 Test Loss: 1.004 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 40 cost time: 0.48484325408935547
Epoch: 40, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.977 Vali Acc: 0.867 Test Loss: 0.977 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 41 cost time: 0.5311386585235596
Epoch: 41, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.949 Vali Acc: 0.874 Test Loss: 0.949 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 42 cost time: 0.49384045600891113
Epoch: 42, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.921 Vali Acc: 0.881 Test Loss: 0.921 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881472).  Saving model ...
Epoch: 43 cost time: 0.4308197498321533
Epoch: 43, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.894 Vali Acc: 0.889 Test Loss: 0.894 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 44 cost time: 0.5670926570892334
Epoch: 44, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.867 Vali Acc: 0.893 Test Loss: 0.867 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 45 cost time: 0.39813804626464844
Epoch: 45, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.840 Vali Acc: 0.900 Test Loss: 0.840 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 46 cost time: 0.48644232749938965
Epoch: 46, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.813 Vali Acc: 0.904 Test Loss: 0.813 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 47 cost time: 0.47319698333740234
Epoch: 47, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.786 Vali Acc: 0.904 Test Loss: 0.786 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 48 cost time: 0.4428703784942627
Epoch: 48, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.760 Vali Acc: 0.893 Test Loss: 0.760 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5465109348297119
Epoch: 49, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.735 Vali Acc: 0.889 Test Loss: 0.735 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4549117088317871
Epoch: 50, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.710 Vali Acc: 0.896 Test Loss: 0.710 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4611382484436035
Epoch: 51, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6398918628692627
Epoch: 52, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.660 Vali Acc: 0.904 Test Loss: 0.660 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 53 cost time: 0.5139000415802002
Epoch: 53, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.637 Vali Acc: 0.911 Test Loss: 0.637 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 54 cost time: 0.4994492530822754
Epoch: 54, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.613 Vali Acc: 0.907 Test Loss: 0.613 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.450824499130249
Epoch: 55, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.591 Vali Acc: 0.904 Test Loss: 0.591 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5118298530578613
Epoch: 56, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.570 Vali Acc: 0.904 Test Loss: 0.570 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.5257937908172607
Epoch: 57, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.550 Vali Acc: 0.904 Test Loss: 0.550 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.43627119064331055
Epoch: 58, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.530 Vali Acc: 0.904 Test Loss: 0.530 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5158798694610596
Epoch: 59, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.4542851448059082
Epoch: 60, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.495 Vali Acc: 0.907 Test Loss: 0.495 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.48809003829956055
Epoch: 61, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.479 Vali Acc: 0.907 Test Loss: 0.479 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.4513418674468994
Epoch: 62, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.464 Vali Acc: 0.907 Test Loss: 0.464 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.5191168785095215
Epoch: 63, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.451 Vali Acc: 0.907 Test Loss: 0.451 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 34814
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.599679708480835
Epoch: 1, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.878 Vali Acc: 0.204 Test Loss: 1.878 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.425539493560791
Epoch: 2, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.857 Vali Acc: 0.222 Test Loss: 1.857 Test Acc: 0.222
Validation loss decreased (-0.203685 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.5119471549987793
Epoch: 3, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.842 Vali Acc: 0.230 Test Loss: 1.842 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 0.4330871105194092
Epoch: 4, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.832 Vali Acc: 0.230 Test Loss: 1.832 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 5 cost time: 0.46230626106262207
Epoch: 5, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.819 Vali Acc: 0.237 Test Loss: 1.819 Test Acc: 0.237
Validation loss decreased (-0.229611 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 0.43699026107788086
Epoch: 6, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.804 Vali Acc: 0.256 Test Loss: 1.804 Test Acc: 0.256
Validation loss decreased (-0.237019 --> -0.255538).  Saving model ...
Epoch: 7 cost time: 0.638141393661499
Epoch: 7, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.787 Vali Acc: 0.267 Test Loss: 1.787 Test Acc: 0.267
Validation loss decreased (-0.255538 --> -0.266649).  Saving model ...
Epoch: 8 cost time: 0.5628321170806885
Epoch: 8, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.768 Vali Acc: 0.281 Test Loss: 1.768 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 0.47745656967163086
Epoch: 9, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.748 Vali Acc: 0.281 Test Loss: 1.748 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 10 cost time: 0.35981059074401855
Epoch: 10, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.727 Vali Acc: 0.281 Test Loss: 1.727 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.48450469970703125
Epoch: 11, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.704 Vali Acc: 0.289 Test Loss: 1.704 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.5330262184143066
Epoch: 12, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.681 Vali Acc: 0.296 Test Loss: 1.681 Test Acc: 0.296
Validation loss decreased (-0.288872 --> -0.296279).  Saving model ...
Epoch: 13 cost time: 0.44449830055236816
Epoch: 13, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.656 Vali Acc: 0.296 Test Loss: 1.656 Test Acc: 0.296
Validation loss decreased (-0.296279 --> -0.296280).  Saving model ...
Epoch: 14 cost time: 0.4337937831878662
Epoch: 14, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.631 Vali Acc: 0.315 Test Loss: 1.631 Test Acc: 0.315
Validation loss decreased (-0.296280 --> -0.314799).  Saving model ...
Epoch: 15 cost time: 0.4106709957122803
Epoch: 15, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.605 Vali Acc: 0.337 Test Loss: 1.605 Test Acc: 0.337
Validation loss decreased (-0.314799 --> -0.337021).  Saving model ...
Epoch: 16 cost time: 0.39490294456481934
Epoch: 16, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.578 Vali Acc: 0.352 Test Loss: 1.578 Test Acc: 0.352
Validation loss decreased (-0.337021 --> -0.351836).  Saving model ...
Epoch: 17 cost time: 0.5193262100219727
Epoch: 17, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.551 Vali Acc: 0.367 Test Loss: 1.551 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 18 cost time: 0.4523470401763916
Epoch: 18, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.523 Vali Acc: 0.385 Test Loss: 1.523 Test Acc: 0.385
Validation loss decreased (-0.366651 --> -0.385170).  Saving model ...
Epoch: 19 cost time: 0.40767979621887207
Epoch: 19, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.495 Vali Acc: 0.422 Test Loss: 1.495 Test Acc: 0.422
Validation loss decreased (-0.385170 --> -0.422207).  Saving model ...
Epoch: 20 cost time: 0.5129756927490234
Epoch: 20, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.466 Vali Acc: 0.459 Test Loss: 1.466 Test Acc: 0.459
Validation loss decreased (-0.422207 --> -0.459245).  Saving model ...
Epoch: 21 cost time: 0.4396193027496338
Epoch: 21, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.437 Vali Acc: 0.485 Test Loss: 1.437 Test Acc: 0.485
Validation loss decreased (-0.459245 --> -0.485171).  Saving model ...
Epoch: 22 cost time: 0.4239957332611084
Epoch: 22, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.407 Vali Acc: 0.533 Test Loss: 1.407 Test Acc: 0.533
Validation loss decreased (-0.485171 --> -0.533319).  Saving model ...
Epoch: 23 cost time: 0.4761357307434082
Epoch: 23, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.377 Vali Acc: 0.559 Test Loss: 1.377 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 24 cost time: 0.5172898769378662
Epoch: 24, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.347 Vali Acc: 0.596 Test Loss: 1.347 Test Acc: 0.596
Validation loss decreased (-0.559245 --> -0.596283).  Saving model ...
Epoch: 25 cost time: 0.4939403533935547
Epoch: 25, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.316 Vali Acc: 0.622 Test Loss: 1.316 Test Acc: 0.622
Validation loss decreased (-0.596283 --> -0.622209).  Saving model ...
Epoch: 26 cost time: 0.506847620010376
Epoch: 26, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.285 Vali Acc: 0.681 Test Loss: 1.285 Test Acc: 0.681
Validation loss decreased (-0.622209 --> -0.681469).  Saving model ...
Epoch: 27 cost time: 0.48934340476989746
Epoch: 27, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.254 Vali Acc: 0.707 Test Loss: 1.254 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 28 cost time: 0.45290279388427734
Epoch: 28, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.222 Vali Acc: 0.730 Test Loss: 1.222 Test Acc: 0.730
Validation loss decreased (-0.707395 --> -0.729617).  Saving model ...
Epoch: 29 cost time: 0.5113134384155273
Epoch: 29, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.190 Vali Acc: 0.756 Test Loss: 1.190 Test Acc: 0.756
Validation loss decreased (-0.729617 --> -0.755544).  Saving model ...
Epoch: 30 cost time: 0.5481314659118652
Epoch: 30, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.157 Vali Acc: 0.796 Test Loss: 1.157 Test Acc: 0.796
Validation loss decreased (-0.755544 --> -0.796285).  Saving model ...
Epoch: 31 cost time: 0.4562819004058838
Epoch: 31, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.124 Vali Acc: 0.830 Test Loss: 1.124 Test Acc: 0.830
Validation loss decreased (-0.796285 --> -0.829618).  Saving model ...
Epoch: 32 cost time: 0.4898993968963623
Epoch: 32, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.091 Vali Acc: 0.837 Test Loss: 1.091 Test Acc: 0.837
Validation loss decreased (-0.829618 --> -0.837026).  Saving model ...
Epoch: 33 cost time: 0.5198450088500977
Epoch: 33, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.058 Vali Acc: 0.863 Test Loss: 1.058 Test Acc: 0.863
Validation loss decreased (-0.837026 --> -0.862952).  Saving model ...
Epoch: 34 cost time: 0.5340626239776611
Epoch: 34, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.024 Vali Acc: 0.874 Test Loss: 1.024 Test Acc: 0.874
Validation loss decreased (-0.862952 --> -0.874064).  Saving model ...
Epoch: 35 cost time: 0.4308583736419678
Epoch: 35, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.990 Vali Acc: 0.881 Test Loss: 0.990 Test Acc: 0.881
Validation loss decreased (-0.874064 --> -0.881472).  Saving model ...
Epoch: 36 cost time: 0.5504732131958008
Epoch: 36, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.955 Vali Acc: 0.885 Test Loss: 0.955 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 37 cost time: 0.5220787525177002
Epoch: 37, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.920 Vali Acc: 0.889 Test Loss: 0.920 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 38 cost time: 0.473935604095459
Epoch: 38, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.884 Vali Acc: 0.889 Test Loss: 0.884 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 39 cost time: 0.5580470561981201
Epoch: 39, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.848 Vali Acc: 0.889 Test Loss: 0.848 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 40 cost time: 0.39460015296936035
Epoch: 40, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.812 Vali Acc: 0.896 Test Loss: 0.812 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 41 cost time: 0.5324735641479492
Epoch: 41, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.775 Vali Acc: 0.893 Test Loss: 0.775 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.3972129821777344
Epoch: 42, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.739 Vali Acc: 0.900 Test Loss: 0.739 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899993).  Saving model ...
Epoch: 43 cost time: 0.42917442321777344
Epoch: 43, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.703 Vali Acc: 0.907 Test Loss: 0.703 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907400).  Saving model ...
Epoch: 44 cost time: 0.5726902484893799
Epoch: 44, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.667 Vali Acc: 0.911 Test Loss: 0.667 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 45 cost time: 0.5417187213897705
Epoch: 45, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.41095781326293945
Epoch: 46, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.597 Vali Acc: 0.915 Test Loss: 0.597 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914809).  Saving model ...
Epoch: 47 cost time: 0.43321943283081055
Epoch: 47, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.564 Vali Acc: 0.915 Test Loss: 0.564 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 48 cost time: 0.45829224586486816
Epoch: 48, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.532 Vali Acc: 0.911 Test Loss: 0.532 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.4170408248901367
Epoch: 49, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.502 Vali Acc: 0.907 Test Loss: 0.502 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.4679584503173828
Epoch: 50, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.474 Vali Acc: 0.896 Test Loss: 0.474 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.4885861873626709
Epoch: 51, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6878507137298584
Epoch: 52, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.425 Vali Acc: 0.889 Test Loss: 0.425 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.48226284980773926
Epoch: 53, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.405 Vali Acc: 0.889 Test Loss: 0.405 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.504692554473877
Epoch: 54, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.389 Vali Acc: 0.885 Test Loss: 0.389 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5417444705963135
Epoch: 55, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.46819090843200684
Epoch: 56, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.364 Vali Acc: 0.885 Test Loss: 0.364 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.4817626476287842
Epoch: 57, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.356 Vali Acc: 0.885 Test Loss: 0.356 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 34724
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.766103982925415
Epoch: 1, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.950 Vali Acc: 0.119 Test Loss: 1.950 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.7662672996520996
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.934 Vali Acc: 0.130 Test Loss: 1.934 Test Acc: 0.130
Validation loss decreased (-0.118499 --> -0.129610).  Saving model ...
Epoch: 3 cost time: 0.5631182193756104
Epoch: 3, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.922 Vali Acc: 0.130 Test Loss: 1.922 Test Acc: 0.130
Validation loss decreased (-0.129610 --> -0.129610).  Saving model ...
Epoch: 4 cost time: 0.6922152042388916
Epoch: 4, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.914 Vali Acc: 0.130 Test Loss: 1.914 Test Acc: 0.130
Validation loss decreased (-0.129610 --> -0.129610).  Saving model ...
Epoch: 5 cost time: 0.5501842498779297
Epoch: 5, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.902 Vali Acc: 0.141 Test Loss: 1.902 Test Acc: 0.141
Validation loss decreased (-0.129610 --> -0.140722).  Saving model ...
Epoch: 6 cost time: 0.44705724716186523
Epoch: 6, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.889 Vali Acc: 0.152 Test Loss: 1.889 Test Acc: 0.152
Validation loss decreased (-0.140722 --> -0.151833).  Saving model ...
Epoch: 7 cost time: 0.5716049671173096
Epoch: 7, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.873 Vali Acc: 0.163 Test Loss: 1.873 Test Acc: 0.163
Validation loss decreased (-0.151833 --> -0.162944).  Saving model ...
Epoch: 8 cost time: 0.459867000579834
Epoch: 8, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.856 Vali Acc: 0.178 Test Loss: 1.856 Test Acc: 0.178
Validation loss decreased (-0.162944 --> -0.177759).  Saving model ...
Epoch: 9 cost time: 0.5028946399688721
Epoch: 9, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.838 Vali Acc: 0.204 Test Loss: 1.838 Test Acc: 0.204
Validation loss decreased (-0.177759 --> -0.203685).  Saving model ...
Epoch: 10 cost time: 0.6684398651123047
Epoch: 10, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.818 Vali Acc: 0.215 Test Loss: 1.818 Test Acc: 0.215
Validation loss decreased (-0.203685 --> -0.214797).  Saving model ...
Epoch: 11 cost time: 0.4860801696777344
Epoch: 11, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.797 Vali Acc: 0.226 Test Loss: 1.797 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225908).  Saving model ...
Epoch: 12 cost time: 0.6402840614318848
Epoch: 12, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.776 Vali Acc: 0.248 Test Loss: 1.776 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248130).  Saving model ...
Epoch: 13 cost time: 0.5816426277160645
Epoch: 13, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.753 Vali Acc: 0.274 Test Loss: 1.753 Test Acc: 0.274
Validation loss decreased (-0.248130 --> -0.274057).  Saving model ...
Epoch: 14 cost time: 0.4662938117980957
Epoch: 14, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.730 Vali Acc: 0.307 Test Loss: 1.730 Test Acc: 0.307
Validation loss decreased (-0.274057 --> -0.307390).  Saving model ...
Epoch: 15 cost time: 0.5077707767486572
Epoch: 15, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.706 Vali Acc: 0.344 Test Loss: 1.706 Test Acc: 0.344
Validation loss decreased (-0.307390 --> -0.344427).  Saving model ...
Epoch: 16 cost time: 0.4958474636077881
Epoch: 16, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.681 Vali Acc: 0.378 Test Loss: 1.681 Test Acc: 0.378
Validation loss decreased (-0.344427 --> -0.377761).  Saving model ...
Epoch: 17 cost time: 0.43436121940612793
Epoch: 17, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.656 Vali Acc: 0.441 Test Loss: 1.656 Test Acc: 0.441
Validation loss decreased (-0.377761 --> -0.440724).  Saving model ...
Epoch: 18 cost time: 0.5658872127532959
Epoch: 18, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.630 Vali Acc: 0.489 Test Loss: 1.630 Test Acc: 0.489
Validation loss decreased (-0.440724 --> -0.488873).  Saving model ...
Epoch: 19 cost time: 0.47186923027038574
Epoch: 19, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.603 Vali Acc: 0.530 Test Loss: 1.603 Test Acc: 0.530
Validation loss decreased (-0.488873 --> -0.529614).  Saving model ...
Epoch: 20 cost time: 0.4406588077545166
Epoch: 20, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.576 Vali Acc: 0.552 Test Loss: 1.576 Test Acc: 0.552
Validation loss decreased (-0.529614 --> -0.551836).  Saving model ...
Epoch: 21 cost time: 0.4542379379272461
Epoch: 21, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.548 Vali Acc: 0.581 Test Loss: 1.548 Test Acc: 0.581
Validation loss decreased (-0.551836 --> -0.581466).  Saving model ...
Epoch: 22 cost time: 0.5901494026184082
Epoch: 22, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.520 Vali Acc: 0.604 Test Loss: 1.520 Test Acc: 0.604
Validation loss decreased (-0.581466 --> -0.603689).  Saving model ...
Epoch: 23 cost time: 0.7545433044433594
Epoch: 23, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.491 Vali Acc: 0.619 Test Loss: 1.491 Test Acc: 0.619
Validation loss decreased (-0.603689 --> -0.618504).  Saving model ...
Epoch: 24 cost time: 0.5617871284484863
Epoch: 24, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.462 Vali Acc: 0.630 Test Loss: 1.462 Test Acc: 0.630
Validation loss decreased (-0.618504 --> -0.629615).  Saving model ...
Epoch: 25 cost time: 0.48068857192993164
Epoch: 25, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.432 Vali Acc: 0.641 Test Loss: 1.432 Test Acc: 0.641
Validation loss decreased (-0.629615 --> -0.640726).  Saving model ...
Epoch: 26 cost time: 0.49031782150268555
Epoch: 26, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.402 Vali Acc: 0.644 Test Loss: 1.402 Test Acc: 0.644
Validation loss decreased (-0.640726 --> -0.644430).  Saving model ...
Epoch: 27 cost time: 0.5553007125854492
Epoch: 27, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.372 Vali Acc: 0.659 Test Loss: 1.372 Test Acc: 0.659
Validation loss decreased (-0.644430 --> -0.659246).  Saving model ...
Epoch: 28 cost time: 0.45513033866882324
Epoch: 28, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.341 Vali Acc: 0.670 Test Loss: 1.341 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 29 cost time: 0.5107715129852295
Epoch: 29, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.310 Vali Acc: 0.685 Test Loss: 1.310 Test Acc: 0.685
Validation loss decreased (-0.670357 --> -0.685172).  Saving model ...
Epoch: 30 cost time: 0.5519282817840576
Epoch: 30, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.279 Vali Acc: 0.693 Test Loss: 1.279 Test Acc: 0.693
Validation loss decreased (-0.685172 --> -0.692580).  Saving model ...
Epoch: 31 cost time: 0.4587113857269287
Epoch: 31, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.247 Vali Acc: 0.700 Test Loss: 1.247 Test Acc: 0.700
Validation loss decreased (-0.692580 --> -0.699988).  Saving model ...
Epoch: 32 cost time: 0.5667970180511475
Epoch: 32, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.216 Vali Acc: 0.704 Test Loss: 1.216 Test Acc: 0.704
Validation loss decreased (-0.699988 --> -0.703692).  Saving model ...
Epoch: 33 cost time: 0.5288417339324951
Epoch: 33, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.183 Vali Acc: 0.707 Test Loss: 1.183 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 34 cost time: 0.5788741111755371
Epoch: 34, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.151 Vali Acc: 0.715 Test Loss: 1.151 Test Acc: 0.715
Validation loss decreased (-0.707396 --> -0.714803).  Saving model ...
Epoch: 35 cost time: 0.4994633197784424
Epoch: 35, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.119 Vali Acc: 0.726 Test Loss: 1.119 Test Acc: 0.726
Validation loss decreased (-0.714803 --> -0.725915).  Saving model ...
Epoch: 36 cost time: 0.48113417625427246
Epoch: 36, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.087 Vali Acc: 0.741 Test Loss: 1.087 Test Acc: 0.741
Validation loss decreased (-0.725915 --> -0.740730).  Saving model ...
Epoch: 37 cost time: 0.5151004791259766
Epoch: 37, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.055 Vali Acc: 0.748 Test Loss: 1.055 Test Acc: 0.748
Validation loss decreased (-0.740730 --> -0.748138).  Saving model ...
Epoch: 38 cost time: 0.5996577739715576
Epoch: 38, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.023 Vali Acc: 0.759 Test Loss: 1.023 Test Acc: 0.759
Validation loss decreased (-0.748138 --> -0.759249).  Saving model ...
Epoch: 39 cost time: 0.46294140815734863
Epoch: 39, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.991 Vali Acc: 0.781 Test Loss: 0.991 Test Acc: 0.781
Validation loss decreased (-0.759249 --> -0.781472).  Saving model ...
Epoch: 40 cost time: 0.5182499885559082
Epoch: 40, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.960 Vali Acc: 0.796 Test Loss: 0.960 Test Acc: 0.796
Validation loss decreased (-0.781472 --> -0.796287).  Saving model ...
Epoch: 41 cost time: 0.49657440185546875
Epoch: 41, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.929 Vali Acc: 0.811 Test Loss: 0.929 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 42 cost time: 0.5218117237091064
Epoch: 42, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.899 Vali Acc: 0.815 Test Loss: 0.899 Test Acc: 0.815
Validation loss decreased (-0.811102 --> -0.814806).  Saving model ...
Epoch: 43 cost time: 0.5775265693664551
Epoch: 43, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.868 Vali Acc: 0.826 Test Loss: 0.868 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825917).  Saving model ...
Epoch: 44 cost time: 0.5498743057250977
Epoch: 44, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.839 Vali Acc: 0.844 Test Loss: 0.839 Test Acc: 0.844
Validation loss decreased (-0.825917 --> -0.844436).  Saving model ...
Epoch: 45 cost time: 0.43827223777770996
Epoch: 45, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.810 Vali Acc: 0.848 Test Loss: 0.810 Test Acc: 0.848
Validation loss decreased (-0.844436 --> -0.848140).  Saving model ...
Epoch: 46 cost time: 0.5677716732025146
Epoch: 46, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.782 Vali Acc: 0.870 Test Loss: 0.782 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 47 cost time: 0.7582595348358154
Epoch: 47, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.754 Vali Acc: 0.885 Test Loss: 0.754 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 48 cost time: 0.5229859352111816
Epoch: 48, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.727 Vali Acc: 0.893 Test Loss: 0.727 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892585).  Saving model ...
Epoch: 49 cost time: 0.5353472232818604
Epoch: 49, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.701 Vali Acc: 0.900 Test Loss: 0.701 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 50 cost time: 0.46483683586120605
Epoch: 50, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.676 Vali Acc: 0.900 Test Loss: 0.676 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 51 cost time: 0.46175527572631836
Epoch: 51, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.651 Vali Acc: 0.907 Test Loss: 0.651 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 52 cost time: 0.5106494426727295
Epoch: 52, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.626 Vali Acc: 0.907 Test Loss: 0.626 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 53 cost time: 0.5840308666229248
Epoch: 53, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.603 Vali Acc: 0.915 Test Loss: 0.603 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 54 cost time: 0.5895016193389893
Epoch: 54, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.580 Vali Acc: 0.915 Test Loss: 0.580 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 55 cost time: 0.5303432941436768
Epoch: 55, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.558 Vali Acc: 0.915 Test Loss: 0.558 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 56 cost time: 0.5859172344207764
Epoch: 56, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.537 Vali Acc: 0.922 Test Loss: 0.537 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 57 cost time: 0.5407922267913818
Epoch: 57, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.516 Vali Acc: 0.922 Test Loss: 0.516 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 58 cost time: 0.5336580276489258
Epoch: 58, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.496 Vali Acc: 0.922 Test Loss: 0.496 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 59 cost time: 0.5372941493988037
Epoch: 59, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.478 Vali Acc: 0.926 Test Loss: 0.478 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 60 cost time: 0.46735239028930664
Epoch: 60, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5554194450378418
Epoch: 61, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.6159112453460693
Epoch: 62, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.44919323921203613
Epoch: 63, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.408 Vali Acc: 0.915 Test Loss: 0.408 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6075835227966309
Epoch: 64, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5418272018432617
Epoch: 65, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.379 Vali Acc: 0.919 Test Loss: 0.379 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5815572738647461
Epoch: 66, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.528419017791748
Epoch: 67, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.5257940292358398
Epoch: 68, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.49843645095825195
Epoch: 69, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 34508
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.728729486465454
Epoch: 1, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.770 Vali Acc: 0.293 Test Loss: 1.770 Test Acc: 0.293
Validation loss decreased (inf --> -0.292575).  Saving model ...
Epoch: 2 cost time: 0.5038645267486572
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.753 Vali Acc: 0.322 Test Loss: 1.753 Test Acc: 0.322
Validation loss decreased (-0.292575 --> -0.322205).  Saving model ...
Epoch: 3 cost time: 0.433027982711792
Epoch: 3, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.741 Vali Acc: 0.326 Test Loss: 1.741 Test Acc: 0.326
Validation loss decreased (-0.322205 --> -0.325909).  Saving model ...
Epoch: 4 cost time: 0.4400296211242676
Epoch: 4, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.732 Vali Acc: 0.337 Test Loss: 1.732 Test Acc: 0.337
Validation loss decreased (-0.325909 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.45348525047302246
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.720 Vali Acc: 0.348 Test Loss: 1.720 Test Acc: 0.348
Validation loss decreased (-0.337020 --> -0.348131).  Saving model ...
Epoch: 6 cost time: 0.41634559631347656
Epoch: 6, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.706 Vali Acc: 0.352 Test Loss: 1.706 Test Acc: 0.352
Validation loss decreased (-0.348131 --> -0.351835).  Saving model ...
Epoch: 7 cost time: 0.503760814666748
Epoch: 7, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.690 Vali Acc: 0.359 Test Loss: 1.690 Test Acc: 0.359
Validation loss decreased (-0.351835 --> -0.359242).  Saving model ...
Epoch: 8 cost time: 0.3832211494445801
Epoch: 8, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.673 Vali Acc: 0.370 Test Loss: 1.673 Test Acc: 0.370
Validation loss decreased (-0.359242 --> -0.370354).  Saving model ...
Epoch: 9 cost time: 0.4991190433502197
Epoch: 9, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.654 Vali Acc: 0.385 Test Loss: 1.654 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 10 cost time: 0.47843194007873535
Epoch: 10, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.634 Vali Acc: 0.404 Test Loss: 1.634 Test Acc: 0.404
Validation loss decreased (-0.385169 --> -0.403687).  Saving model ...
Epoch: 11 cost time: 0.56056809425354
Epoch: 11, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.613 Vali Acc: 0.426 Test Loss: 1.613 Test Acc: 0.426
Validation loss decreased (-0.403687 --> -0.425910).  Saving model ...
Epoch: 12 cost time: 0.5534110069274902
Epoch: 12, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.591 Vali Acc: 0.448 Test Loss: 1.591 Test Acc: 0.448
Validation loss decreased (-0.425910 --> -0.448132).  Saving model ...
Epoch: 13 cost time: 0.5692038536071777
Epoch: 13, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.568 Vali Acc: 0.456 Test Loss: 1.568 Test Acc: 0.456
Validation loss decreased (-0.448132 --> -0.455540).  Saving model ...
Epoch: 14 cost time: 0.4914522171020508
Epoch: 14, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.544 Vali Acc: 0.467 Test Loss: 1.544 Test Acc: 0.467
Validation loss decreased (-0.455540 --> -0.466651).  Saving model ...
Epoch: 15 cost time: 0.639808177947998
Epoch: 15, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.519 Vali Acc: 0.478 Test Loss: 1.519 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477763).  Saving model ...
Epoch: 16 cost time: 0.5993766784667969
Epoch: 16, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.494 Vali Acc: 0.500 Test Loss: 1.494 Test Acc: 0.500
Validation loss decreased (-0.477763 --> -0.499985).  Saving model ...
Epoch: 17 cost time: 0.5127530097961426
Epoch: 17, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.468 Vali Acc: 0.519 Test Loss: 1.468 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518504).  Saving model ...
Epoch: 18 cost time: 0.5217494964599609
Epoch: 18, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.441 Vali Acc: 0.541 Test Loss: 1.441 Test Acc: 0.541
Validation loss decreased (-0.518504 --> -0.540726).  Saving model ...
Epoch: 19 cost time: 0.409900426864624
Epoch: 19, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.414 Vali Acc: 0.570 Test Loss: 1.414 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 20 cost time: 0.4921119213104248
Epoch: 20, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.386 Vali Acc: 0.611 Test Loss: 1.386 Test Acc: 0.611
Validation loss decreased (-0.570356 --> -0.611097).  Saving model ...
Epoch: 21 cost time: 0.47350192070007324
Epoch: 21, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.358 Vali Acc: 0.663 Test Loss: 1.358 Test Acc: 0.663
Validation loss decreased (-0.611097 --> -0.662949).  Saving model ...
Epoch: 22 cost time: 0.409254789352417
Epoch: 22, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.330 Vali Acc: 0.726 Test Loss: 1.330 Test Acc: 0.726
Validation loss decreased (-0.662949 --> -0.725913).  Saving model ...
Epoch: 23 cost time: 0.5207479000091553
Epoch: 23, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.300 Vali Acc: 0.759 Test Loss: 1.300 Test Acc: 0.759
Validation loss decreased (-0.725913 --> -0.759246).  Saving model ...
Epoch: 24 cost time: 0.4479639530181885
Epoch: 24, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.271 Vali Acc: 0.789 Test Loss: 1.271 Test Acc: 0.789
Validation loss decreased (-0.759246 --> -0.788876).  Saving model ...
Epoch: 25 cost time: 0.4831395149230957
Epoch: 25, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.241 Vali Acc: 0.800 Test Loss: 1.241 Test Acc: 0.800
Validation loss decreased (-0.788876 --> -0.799988).  Saving model ...
Epoch: 26 cost time: 0.5045104026794434
Epoch: 26, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.210 Vali Acc: 0.830 Test Loss: 1.210 Test Acc: 0.830
Validation loss decreased (-0.799988 --> -0.829618).  Saving model ...
Epoch: 27 cost time: 0.5065441131591797
Epoch: 27, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.180 Vali Acc: 0.852 Test Loss: 1.180 Test Acc: 0.852
Validation loss decreased (-0.829618 --> -0.851840).  Saving model ...
Epoch: 28 cost time: 0.5055215358734131
Epoch: 28, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.148 Vali Acc: 0.856 Test Loss: 1.148 Test Acc: 0.856
Validation loss decreased (-0.851840 --> -0.855544).  Saving model ...
Epoch: 29 cost time: 0.4593009948730469
Epoch: 29, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.117 Vali Acc: 0.867 Test Loss: 1.117 Test Acc: 0.867
Validation loss decreased (-0.855544 --> -0.866655).  Saving model ...
Epoch: 30 cost time: 0.4232940673828125
Epoch: 30, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.085 Vali Acc: 0.874 Test Loss: 1.085 Test Acc: 0.874
Validation loss decreased (-0.866655 --> -0.874063).  Saving model ...
Epoch: 31 cost time: 0.4058265686035156
Epoch: 31, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.052 Vali Acc: 0.889 Test Loss: 1.052 Test Acc: 0.889
Validation loss decreased (-0.874063 --> -0.888878).  Saving model ...
Epoch: 32 cost time: 0.5106120109558105
Epoch: 32, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.019 Vali Acc: 0.889 Test Loss: 1.019 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888879).  Saving model ...
Epoch: 33 cost time: 0.40755176544189453
Epoch: 33, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.986 Vali Acc: 0.900 Test Loss: 0.986 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899990).  Saving model ...
Epoch: 34 cost time: 0.5668473243713379
Epoch: 34, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.952 Vali Acc: 0.900 Test Loss: 0.952 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899990).  Saving model ...
Epoch: 35 cost time: 0.4753232002258301
Epoch: 35, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.918 Vali Acc: 0.904 Test Loss: 0.918 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903695).  Saving model ...
Epoch: 36 cost time: 0.5994892120361328
Epoch: 36, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.884 Vali Acc: 0.900 Test Loss: 0.884 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5209133625030518
Epoch: 37, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.849 Vali Acc: 0.904 Test Loss: 0.849 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903695).  Saving model ...
Epoch: 38 cost time: 0.5194704532623291
Epoch: 38, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.814 Vali Acc: 0.907 Test Loss: 0.814 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 39 cost time: 0.5365004539489746
Epoch: 39, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.779 Vali Acc: 0.911 Test Loss: 0.779 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 40 cost time: 0.5412707328796387
Epoch: 40, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.744 Vali Acc: 0.919 Test Loss: 0.744 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 41 cost time: 0.5126936435699463
Epoch: 41, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.708 Vali Acc: 0.919 Test Loss: 0.708 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 42 cost time: 0.4384276866912842
Epoch: 42, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.673 Vali Acc: 0.926 Test Loss: 0.673 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 43 cost time: 0.6750133037567139
Epoch: 43, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.637 Vali Acc: 0.933 Test Loss: 0.637 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 44 cost time: 0.430098295211792
Epoch: 44, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.602 Vali Acc: 0.933 Test Loss: 0.602 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 45 cost time: 0.47299718856811523
Epoch: 45, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.568 Vali Acc: 0.933 Test Loss: 0.568 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 46 cost time: 0.5452237129211426
Epoch: 46, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.535 Vali Acc: 0.933 Test Loss: 0.535 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 47 cost time: 0.42513322830200195
Epoch: 47, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.503 Vali Acc: 0.937 Test Loss: 0.503 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 48 cost time: 0.5970747470855713
Epoch: 48, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.473 Vali Acc: 0.937 Test Loss: 0.473 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 49 cost time: 0.5490353107452393
Epoch: 49, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.445 Vali Acc: 0.933 Test Loss: 0.445 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.38680386543273926
Epoch: 50, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.418 Vali Acc: 0.930 Test Loss: 0.418 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.4136824607849121
Epoch: 51, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.394 Vali Acc: 0.930 Test Loss: 0.394 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.43594908714294434
Epoch: 52, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.4943726062774658
Epoch: 53, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.501291036605835
Epoch: 54, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.48857569694519043
Epoch: 55, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.505950927734375
Epoch: 56, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.4349253177642822
Epoch: 57, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.36612772941589355
Epoch: 58, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 34166
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4595110416412354
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.864 Vali Acc: 0.189 Test Loss: 1.864 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.48578786849975586
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.845 Vali Acc: 0.196 Test Loss: 1.845 Test Acc: 0.196
Validation loss decreased (-0.188870 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.3533756732940674
Epoch: 3, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.833 Vali Acc: 0.204 Test Loss: 1.833 Test Acc: 0.204
Validation loss decreased (-0.196278 --> -0.203685).  Saving model ...
Epoch: 4 cost time: 0.496614933013916
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.824 Vali Acc: 0.204 Test Loss: 1.824 Test Acc: 0.204
Validation loss decreased (-0.203685 --> -0.203685).  Saving model ...
Epoch: 5 cost time: 0.41829967498779297
Epoch: 5, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.813 Vali Acc: 0.215 Test Loss: 1.813 Test Acc: 0.215
Validation loss decreased (-0.203685 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.45383405685424805
Epoch: 6, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.800 Vali Acc: 0.219 Test Loss: 1.800 Test Acc: 0.219
Validation loss decreased (-0.214797 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.40616750717163086
Epoch: 7, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.784 Vali Acc: 0.219 Test Loss: 1.784 Test Acc: 0.219
Validation loss decreased (-0.218501 --> -0.218501).  Saving model ...
Epoch: 8 cost time: 0.5335772037506104
Epoch: 8, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.767 Vali Acc: 0.226 Test Loss: 1.767 Test Acc: 0.226
Validation loss decreased (-0.218501 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.5191271305084229
Epoch: 9, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.749 Vali Acc: 0.230 Test Loss: 1.749 Test Acc: 0.230
Validation loss decreased (-0.225908 --> -0.229612).  Saving model ...
Epoch: 10 cost time: 0.4996790885925293
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 11 cost time: 0.47623467445373535
Epoch: 11, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.709 Vali Acc: 0.252 Test Loss: 1.709 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 12 cost time: 0.46169519424438477
Epoch: 12, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.688 Vali Acc: 0.263 Test Loss: 1.688 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 13 cost time: 0.4646034240722656
Epoch: 13, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
Validation loss decreased (-0.262946 --> -0.277761).  Saving model ...
Epoch: 14 cost time: 0.44934916496276855
Epoch: 14, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.644 Vali Acc: 0.293 Test Loss: 1.644 Test Acc: 0.293
Validation loss decreased (-0.277761 --> -0.292576).  Saving model ...
Epoch: 15 cost time: 0.4782986640930176
Epoch: 15, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.621 Vali Acc: 0.304 Test Loss: 1.621 Test Acc: 0.304
Validation loss decreased (-0.292576 --> -0.303687).  Saving model ...
Epoch: 16 cost time: 0.3873324394226074
Epoch: 16, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.597 Vali Acc: 0.319 Test Loss: 1.597 Test Acc: 0.319
Validation loss decreased (-0.303687 --> -0.318503).  Saving model ...
Epoch: 17 cost time: 0.4581797122955322
Epoch: 17, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.573 Vali Acc: 0.330 Test Loss: 1.573 Test Acc: 0.330
Validation loss decreased (-0.318503 --> -0.329614).  Saving model ...
Epoch: 18 cost time: 0.37798309326171875
Epoch: 18, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.549 Vali Acc: 0.367 Test Loss: 1.549 Test Acc: 0.367
Validation loss decreased (-0.329614 --> -0.366651).  Saving model ...
Epoch: 19 cost time: 0.5197603702545166
Epoch: 19, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.524 Vali Acc: 0.419 Test Loss: 1.524 Test Acc: 0.419
Validation loss decreased (-0.366651 --> -0.418503).  Saving model ...
Epoch: 20 cost time: 0.47509145736694336
Epoch: 20, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.498 Vali Acc: 0.452 Test Loss: 1.498 Test Acc: 0.452
Validation loss decreased (-0.418503 --> -0.451837).  Saving model ...
Epoch: 21 cost time: 0.32559704780578613
Epoch: 21, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.473 Vali Acc: 0.481 Test Loss: 1.473 Test Acc: 0.481
Validation loss decreased (-0.451837 --> -0.481467).  Saving model ...
Epoch: 22 cost time: 0.5625097751617432
Epoch: 22, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.447 Vali Acc: 0.496 Test Loss: 1.447 Test Acc: 0.496
Validation loss decreased (-0.481467 --> -0.496282).  Saving model ...
Epoch: 23 cost time: 0.3945612907409668
Epoch: 23, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.421 Vali Acc: 0.515 Test Loss: 1.421 Test Acc: 0.515
Validation loss decreased (-0.496282 --> -0.514801).  Saving model ...
Epoch: 24 cost time: 0.3761167526245117
Epoch: 24, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.395 Vali Acc: 0.552 Test Loss: 1.395 Test Acc: 0.552
Validation loss decreased (-0.514801 --> -0.551838).  Saving model ...
Epoch: 25 cost time: 0.4993479251861572
Epoch: 25, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.369 Vali Acc: 0.589 Test Loss: 1.369 Test Acc: 0.589
Validation loss decreased (-0.551838 --> -0.588875).  Saving model ...
Epoch: 26 cost time: 0.43498897552490234
Epoch: 26, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.342 Vali Acc: 0.615 Test Loss: 1.342 Test Acc: 0.615
Validation loss decreased (-0.588875 --> -0.614801).  Saving model ...
Epoch: 27 cost time: 0.4318099021911621
Epoch: 27, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.315 Vali Acc: 0.630 Test Loss: 1.315 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 28 cost time: 0.5022728443145752
Epoch: 28, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.288 Vali Acc: 0.656 Test Loss: 1.288 Test Acc: 0.656
Validation loss decreased (-0.629616 --> -0.655543).  Saving model ...
Epoch: 29 cost time: 0.4212949275970459
Epoch: 29, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.261 Vali Acc: 0.681 Test Loss: 1.261 Test Acc: 0.681
Validation loss decreased (-0.655543 --> -0.681469).  Saving model ...
Epoch: 30 cost time: 0.470869779586792
Epoch: 30, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.233 Vali Acc: 0.707 Test Loss: 1.233 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 31 cost time: 0.7017092704772949
Epoch: 31, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.206 Vali Acc: 0.726 Test Loss: 1.206 Test Acc: 0.726
Validation loss decreased (-0.707395 --> -0.725914).  Saving model ...
Epoch: 32 cost time: 0.4099996089935303
Epoch: 32, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.178 Vali Acc: 0.733 Test Loss: 1.178 Test Acc: 0.733
Validation loss decreased (-0.725914 --> -0.733322).  Saving model ...
Epoch: 33 cost time: 0.5542111396789551
Epoch: 33, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.151 Vali Acc: 0.748 Test Loss: 1.151 Test Acc: 0.748
Validation loss decreased (-0.733322 --> -0.748137).  Saving model ...
Epoch: 34 cost time: 0.5279748439788818
Epoch: 34, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.124 Vali Acc: 0.770 Test Loss: 1.124 Test Acc: 0.770
Validation loss decreased (-0.748137 --> -0.770359).  Saving model ...
Epoch: 35 cost time: 0.5274574756622314
Epoch: 35, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.096 Vali Acc: 0.774 Test Loss: 1.096 Test Acc: 0.774
Validation loss decreased (-0.770359 --> -0.774063).  Saving model ...
Epoch: 36 cost time: 0.519545316696167
Epoch: 36, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.069 Vali Acc: 0.793 Test Loss: 1.069 Test Acc: 0.793
Validation loss decreased (-0.774063 --> -0.792582).  Saving model ...
Epoch: 37 cost time: 0.4841010570526123
Epoch: 37, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.042 Vali Acc: 0.804 Test Loss: 1.042 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803693).  Saving model ...
Epoch: 38 cost time: 0.5909943580627441
Epoch: 38, Steps: 2 | Train Loss: 0.863 Vali Loss: 1.014 Vali Acc: 0.822 Test Loss: 1.014 Test Acc: 0.822
Validation loss decreased (-0.803693 --> -0.822212).  Saving model ...
Epoch: 39 cost time: 0.565277099609375
Epoch: 39, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.987 Vali Acc: 0.826 Test Loss: 0.987 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825916).  Saving model ...
Epoch: 40 cost time: 0.5656297206878662
Epoch: 40, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.960 Vali Acc: 0.822 Test Loss: 0.960 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4724454879760742
Epoch: 41, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.933 Vali Acc: 0.830 Test Loss: 0.933 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829620).  Saving model ...
Epoch: 42 cost time: 0.5301952362060547
Epoch: 42, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.906 Vali Acc: 0.841 Test Loss: 0.906 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840732).  Saving model ...
Epoch: 43 cost time: 0.4095606803894043
Epoch: 43, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.880 Vali Acc: 0.848 Test Loss: 0.880 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848139).  Saving model ...
Epoch: 44 cost time: 0.41234397888183594
Epoch: 44, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.853 Vali Acc: 0.859 Test Loss: 0.853 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 45 cost time: 0.5029213428497314
Epoch: 45, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.826 Vali Acc: 0.863 Test Loss: 0.826 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 46 cost time: 0.41584229469299316
Epoch: 46, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.799 Vali Acc: 0.870 Test Loss: 0.799 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870362).  Saving model ...
Epoch: 47 cost time: 0.4844670295715332
Epoch: 47, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.772 Vali Acc: 0.885 Test Loss: 0.772 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885177).  Saving model ...
Epoch: 48 cost time: 0.41254496574401855
Epoch: 48, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.745 Vali Acc: 0.885 Test Loss: 0.745 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885178).  Saving model ...
Epoch: 49 cost time: 0.4975132942199707
Epoch: 49, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.719 Vali Acc: 0.889 Test Loss: 0.719 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 50 cost time: 0.4761674404144287
Epoch: 50, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.692 Vali Acc: 0.893 Test Loss: 0.692 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 51 cost time: 0.468883752822876
Epoch: 51, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.665 Vali Acc: 0.893 Test Loss: 0.665 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 52 cost time: 0.5349595546722412
Epoch: 52, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.639 Vali Acc: 0.904 Test Loss: 0.639 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903697).  Saving model ...
Epoch: 53 cost time: 0.5236935615539551
Epoch: 53, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.611 Vali Acc: 0.904 Test Loss: 0.611 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 54 cost time: 0.5189423561096191
Epoch: 54, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.584 Vali Acc: 0.911 Test Loss: 0.584 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 55 cost time: 0.4738500118255615
Epoch: 55, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.557 Vali Acc: 0.919 Test Loss: 0.557 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 56 cost time: 0.5176091194152832
Epoch: 56, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.530 Vali Acc: 0.922 Test Loss: 0.530 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 57 cost time: 0.4551105499267578
Epoch: 57, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.504 Vali Acc: 0.926 Test Loss: 0.504 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 58 cost time: 0.45363759994506836
Epoch: 58, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.42217278480529785
Epoch: 59, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.44093751907348633
Epoch: 60, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.428 Vali Acc: 0.922 Test Loss: 0.428 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5058534145355225
Epoch: 61, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.5415303707122803
Epoch: 62, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.383 Vali Acc: 0.926 Test Loss: 0.383 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 63 cost time: 0.3930530548095703
Epoch: 63, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 64 cost time: 0.47061634063720703
Epoch: 64, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.344 Vali Acc: 0.926 Test Loss: 0.344 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 65 cost time: 0.6404075622558594
Epoch: 65, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 66 cost time: 0.4597647190093994
Epoch: 66, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.5700452327728271
Epoch: 67, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.5360686779022217
Epoch: 68, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.5503804683685303
Epoch: 69, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.46678781509399414
Epoch: 70, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.4597172737121582
Epoch: 71, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.5559334754943848
Epoch: 72, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5276181697845459
Epoch: 73, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.263 Vali Acc: 0.915 Test Loss: 0.263 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.4795057773590088
Epoch: 74, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.262 Vali Acc: 0.911 Test Loss: 0.262 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.5893948078155518
Epoch: 75, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 34077
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7117364406585693
Epoch: 1, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.791 Vali Acc: 0.241 Test Loss: 1.791 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.48486876487731934
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.775 Vali Acc: 0.244 Test Loss: 1.775 Test Acc: 0.244
Validation loss decreased (-0.240723 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.49729442596435547
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.763 Vali Acc: 0.267 Test Loss: 1.763 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.4892847537994385
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.754 Vali Acc: 0.270 Test Loss: 1.754 Test Acc: 0.270
Validation loss decreased (-0.266649 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.5004720687866211
Epoch: 5, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.743 Vali Acc: 0.281 Test Loss: 1.743 Test Acc: 0.281
Validation loss decreased (-0.270353 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.48404788970947266
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.5635628700256348
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.715 Vali Acc: 0.296 Test Loss: 1.715 Test Acc: 0.296
Validation loss decreased (-0.281464 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 0.501453161239624
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (-0.296279 --> -0.299983).  Saving model ...
Epoch: 9 cost time: 0.5305554866790771
Epoch: 9, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.680 Vali Acc: 0.315 Test Loss: 1.680 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.49323606491088867
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.661 Vali Acc: 0.326 Test Loss: 1.661 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 11 cost time: 0.46321678161621094
Epoch: 11, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.640 Vali Acc: 0.348 Test Loss: 1.640 Test Acc: 0.348
Validation loss decreased (-0.325909 --> -0.348132).  Saving model ...
Epoch: 12 cost time: 0.5143513679504395
Epoch: 12, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.619 Vali Acc: 0.359 Test Loss: 1.619 Test Acc: 0.359
Validation loss decreased (-0.348132 --> -0.359243).  Saving model ...
Epoch: 13 cost time: 0.5528008937835693
Epoch: 13, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.597 Vali Acc: 0.370 Test Loss: 1.597 Test Acc: 0.370
Validation loss decreased (-0.359243 --> -0.370354).  Saving model ...
Epoch: 14 cost time: 0.41919565200805664
Epoch: 14, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.575 Vali Acc: 0.389 Test Loss: 1.575 Test Acc: 0.389
Validation loss decreased (-0.370354 --> -0.388873).  Saving model ...
Epoch: 15 cost time: 0.5183396339416504
Epoch: 15, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.551 Vali Acc: 0.415 Test Loss: 1.551 Test Acc: 0.415
Validation loss decreased (-0.388873 --> -0.414799).  Saving model ...
Epoch: 16 cost time: 0.5693485736846924
Epoch: 16, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.527 Vali Acc: 0.422 Test Loss: 1.527 Test Acc: 0.422
Validation loss decreased (-0.414799 --> -0.422207).  Saving model ...
Epoch: 17 cost time: 0.42407798767089844
Epoch: 17, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.503 Vali Acc: 0.448 Test Loss: 1.503 Test Acc: 0.448
Validation loss decreased (-0.422207 --> -0.448133).  Saving model ...
Epoch: 18 cost time: 0.6056089401245117
Epoch: 18, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.478 Vali Acc: 0.470 Test Loss: 1.478 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470356).  Saving model ...
Epoch: 19 cost time: 0.505054235458374
Epoch: 19, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.452 Vali Acc: 0.500 Test Loss: 1.452 Test Acc: 0.500
Validation loss decreased (-0.470356 --> -0.499985).  Saving model ...
Epoch: 20 cost time: 0.44597315788269043
Epoch: 20, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.426 Vali Acc: 0.519 Test Loss: 1.426 Test Acc: 0.519
Validation loss decreased (-0.499985 --> -0.518504).  Saving model ...
Epoch: 21 cost time: 0.47753334045410156
Epoch: 21, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.400 Vali Acc: 0.548 Test Loss: 1.400 Test Acc: 0.548
Validation loss decreased (-0.518504 --> -0.548134).  Saving model ...
Epoch: 22 cost time: 0.4489569664001465
Epoch: 22, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.373 Vali Acc: 0.567 Test Loss: 1.373 Test Acc: 0.567
Validation loss decreased (-0.548134 --> -0.566653).  Saving model ...
Epoch: 23 cost time: 0.37807488441467285
Epoch: 23, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.345 Vali Acc: 0.596 Test Loss: 1.345 Test Acc: 0.596
Validation loss decreased (-0.566653 --> -0.596283).  Saving model ...
Epoch: 24 cost time: 0.47923731803894043
Epoch: 24, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.318 Vali Acc: 0.622 Test Loss: 1.318 Test Acc: 0.622
Validation loss decreased (-0.596283 --> -0.622209).  Saving model ...
Epoch: 25 cost time: 0.4456920623779297
Epoch: 25, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.290 Vali Acc: 0.652 Test Loss: 1.290 Test Acc: 0.652
Validation loss decreased (-0.622209 --> -0.651839).  Saving model ...
Epoch: 26 cost time: 0.4089486598968506
Epoch: 26, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.262 Vali Acc: 0.667 Test Loss: 1.262 Test Acc: 0.667
Validation loss decreased (-0.651839 --> -0.666654).  Saving model ...
Epoch: 27 cost time: 0.38419413566589355
Epoch: 27, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.233 Vali Acc: 0.685 Test Loss: 1.233 Test Acc: 0.685
Validation loss decreased (-0.666654 --> -0.685173).  Saving model ...
Epoch: 28 cost time: 0.481034517288208
Epoch: 28, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.204 Vali Acc: 0.704 Test Loss: 1.204 Test Acc: 0.704
Validation loss decreased (-0.685173 --> -0.703692).  Saving model ...
Epoch: 29 cost time: 0.4598832130432129
Epoch: 29, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.175 Vali Acc: 0.730 Test Loss: 1.175 Test Acc: 0.730
Validation loss decreased (-0.703692 --> -0.729618).  Saving model ...
Epoch: 30 cost time: 0.6202883720397949
Epoch: 30, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.146 Vali Acc: 0.756 Test Loss: 1.146 Test Acc: 0.756
Validation loss decreased (-0.729618 --> -0.755544).  Saving model ...
Epoch: 31 cost time: 0.44094276428222656
Epoch: 31, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.117 Vali Acc: 0.770 Test Loss: 1.117 Test Acc: 0.770
Validation loss decreased (-0.755544 --> -0.770359).  Saving model ...
Epoch: 32 cost time: 0.6511318683624268
Epoch: 32, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.087 Vali Acc: 0.793 Test Loss: 1.087 Test Acc: 0.793
Validation loss decreased (-0.770359 --> -0.792582).  Saving model ...
Epoch: 33 cost time: 0.7207753658294678
Epoch: 33, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.057 Vali Acc: 0.811 Test Loss: 1.057 Test Acc: 0.811
Validation loss decreased (-0.792582 --> -0.811101).  Saving model ...
Epoch: 34 cost time: 0.40566086769104004
Epoch: 34, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.026 Vali Acc: 0.815 Test Loss: 1.026 Test Acc: 0.815
Validation loss decreased (-0.811101 --> -0.814805).  Saving model ...
Epoch: 35 cost time: 0.5198357105255127
Epoch: 35, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.996 Vali Acc: 0.830 Test Loss: 0.996 Test Acc: 0.830
Validation loss decreased (-0.814805 --> -0.829620).  Saving model ...
Epoch: 36 cost time: 0.4851398468017578
Epoch: 36, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.965 Vali Acc: 0.844 Test Loss: 0.965 Test Acc: 0.844
Validation loss decreased (-0.829620 --> -0.844435).  Saving model ...
Epoch: 37 cost time: 0.5190074443817139
Epoch: 37, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.934 Vali Acc: 0.859 Test Loss: 0.934 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859250).  Saving model ...
Epoch: 38 cost time: 0.47351789474487305
Epoch: 38, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.903 Vali Acc: 0.870 Test Loss: 0.903 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870361).  Saving model ...
Epoch: 39 cost time: 0.5533599853515625
Epoch: 39, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.871 Vali Acc: 0.874 Test Loss: 0.871 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 40 cost time: 0.5016698837280273
Epoch: 40, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.840 Vali Acc: 0.878 Test Loss: 0.840 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 41 cost time: 0.45844483375549316
Epoch: 41, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.808 Vali Acc: 0.878 Test Loss: 0.808 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 42 cost time: 0.5087547302246094
Epoch: 42, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.776 Vali Acc: 0.885 Test Loss: 0.776 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885177).  Saving model ...
Epoch: 43 cost time: 0.4701199531555176
Epoch: 43, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.744 Vali Acc: 0.885 Test Loss: 0.744 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885178).  Saving model ...
Epoch: 44 cost time: 0.41283106803894043
Epoch: 44, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.712 Vali Acc: 0.885 Test Loss: 0.712 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 45 cost time: 0.4701697826385498
Epoch: 45, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.680 Vali Acc: 0.893 Test Loss: 0.680 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 46 cost time: 0.5217902660369873
Epoch: 46, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.649 Vali Acc: 0.896 Test Loss: 0.649 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 47 cost time: 0.41318559646606445
Epoch: 47, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.617 Vali Acc: 0.893 Test Loss: 0.617 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5011889934539795
Epoch: 48, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.586 Vali Acc: 0.893 Test Loss: 0.586 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6118209362030029
Epoch: 49, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.556 Vali Acc: 0.893 Test Loss: 0.556 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.45528149604797363
Epoch: 50, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.527 Vali Acc: 0.896 Test Loss: 0.527 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 51 cost time: 0.55484938621521
Epoch: 51, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.499 Vali Acc: 0.896 Test Loss: 0.499 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 52 cost time: 0.47016048431396484
Epoch: 52, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.472 Vali Acc: 0.893 Test Loss: 0.472 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5660078525543213
Epoch: 53, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5499756336212158
Epoch: 54, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.425 Vali Acc: 0.889 Test Loss: 0.425 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5314991474151611
Epoch: 55, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.405 Vali Acc: 0.900 Test Loss: 0.405 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 56 cost time: 0.6377954483032227
Epoch: 56, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.386 Vali Acc: 0.904 Test Loss: 0.386 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 57 cost time: 0.4719109535217285
Epoch: 57, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 58 cost time: 0.5369362831115723
Epoch: 58, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.354 Vali Acc: 0.907 Test Loss: 0.354 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 59 cost time: 0.5243749618530273
Epoch: 59, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 60 cost time: 0.5806243419647217
Epoch: 60, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.331 Vali Acc: 0.904 Test Loss: 0.331 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.42522239685058594
Epoch: 61, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.323 Vali Acc: 0.904 Test Loss: 0.323 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5693364143371582
Epoch: 62, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.316 Vali Acc: 0.904 Test Loss: 0.316 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.37056994438171387
Epoch: 63, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.312 Vali Acc: 0.900 Test Loss: 0.312 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.5474975109100342
Epoch: 64, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5702171325683594
Epoch: 65, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.4547994136810303
Epoch: 66, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.44518589973449707
Epoch: 67, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.5390114784240723
Epoch: 68, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.496845006942749
Epoch: 69, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm256_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 34400
model size : 0.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5291056632995605
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.842 Vali Acc: 0.174 Test Loss: 1.842 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.36742329597473145
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.821 Vali Acc: 0.189 Test Loss: 1.821 Test Acc: 0.189
Validation loss decreased (-0.174056 --> -0.188871).  Saving model ...
Epoch: 3 cost time: 0.5126042366027832
Epoch: 3, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.807 Vali Acc: 0.200 Test Loss: 1.807 Test Acc: 0.200
Validation loss decreased (-0.188871 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.4677903652191162
Epoch: 4, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.797 Vali Acc: 0.207 Test Loss: 1.797 Test Acc: 0.207
Validation loss decreased (-0.199982 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 0.468841552734375
Epoch: 5, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.785 Vali Acc: 0.219 Test Loss: 1.785 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.4333841800689697
Epoch: 6, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.770 Vali Acc: 0.241 Test Loss: 1.770 Test Acc: 0.241
Validation loss decreased (-0.218501 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.49501967430114746
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.753 Vali Acc: 0.281 Test Loss: 1.753 Test Acc: 0.281
Validation loss decreased (-0.240723 --> -0.281464).  Saving model ...
Epoch: 8 cost time: 0.5631637573242188
Epoch: 8, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.735 Vali Acc: 0.304 Test Loss: 1.735 Test Acc: 0.304
Validation loss decreased (-0.281464 --> -0.303686).  Saving model ...
Epoch: 9 cost time: 0.4670116901397705
Epoch: 9, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.716 Vali Acc: 0.330 Test Loss: 1.716 Test Acc: 0.330
Validation loss decreased (-0.303686 --> -0.329612).  Saving model ...
Epoch: 10 cost time: 0.47827911376953125
Epoch: 10, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.695 Vali Acc: 0.352 Test Loss: 1.695 Test Acc: 0.352
Validation loss decreased (-0.329612 --> -0.351835).  Saving model ...
Epoch: 11 cost time: 0.5286550521850586
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.673 Vali Acc: 0.374 Test Loss: 1.673 Test Acc: 0.374
Validation loss decreased (-0.351835 --> -0.374057).  Saving model ...
Epoch: 12 cost time: 0.5272808074951172
Epoch: 12, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.650 Vali Acc: 0.407 Test Loss: 1.650 Test Acc: 0.407
Validation loss decreased (-0.374057 --> -0.407391).  Saving model ...
Epoch: 13 cost time: 0.5429818630218506
Epoch: 13, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.627 Vali Acc: 0.452 Test Loss: 1.627 Test Acc: 0.452
Validation loss decreased (-0.407391 --> -0.451836).  Saving model ...
Epoch: 14 cost time: 0.5962448120117188
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.602 Vali Acc: 0.474 Test Loss: 1.602 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474058).  Saving model ...
Epoch: 15 cost time: 0.5140800476074219
Epoch: 15, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.577 Vali Acc: 0.500 Test Loss: 1.577 Test Acc: 0.500
Validation loss decreased (-0.474058 --> -0.499984).  Saving model ...
Epoch: 16 cost time: 0.41039276123046875
Epoch: 16, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.552 Vali Acc: 0.522 Test Loss: 1.552 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522207).  Saving model ...
Epoch: 17 cost time: 0.5442538261413574
Epoch: 17, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.526 Vali Acc: 0.544 Test Loss: 1.526 Test Acc: 0.544
Validation loss decreased (-0.522207 --> -0.544429).  Saving model ...
Epoch: 18 cost time: 0.4772830009460449
Epoch: 18, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.499 Vali Acc: 0.548 Test Loss: 1.499 Test Acc: 0.548
Validation loss decreased (-0.544429 --> -0.548133).  Saving model ...
Epoch: 19 cost time: 0.510200023651123
Epoch: 19, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.472 Vali Acc: 0.563 Test Loss: 1.472 Test Acc: 0.563
Validation loss decreased (-0.548133 --> -0.562948).  Saving model ...
Epoch: 20 cost time: 0.5312581062316895
Epoch: 20, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.445 Vali Acc: 0.596 Test Loss: 1.445 Test Acc: 0.596
Validation loss decreased (-0.562948 --> -0.596282).  Saving model ...
Epoch: 21 cost time: 0.5270442962646484
Epoch: 21, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.417 Vali Acc: 0.619 Test Loss: 1.417 Test Acc: 0.619
Validation loss decreased (-0.596282 --> -0.618504).  Saving model ...
Epoch: 22 cost time: 0.46329402923583984
Epoch: 22, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.389 Vali Acc: 0.637 Test Loss: 1.389 Test Acc: 0.637
Validation loss decreased (-0.618504 --> -0.637023).  Saving model ...
Epoch: 23 cost time: 0.5352723598480225
Epoch: 23, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.362 Vali Acc: 0.648 Test Loss: 1.362 Test Acc: 0.648
Validation loss decreased (-0.637023 --> -0.648135).  Saving model ...
Epoch: 24 cost time: 0.34778261184692383
Epoch: 24, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.334 Vali Acc: 0.667 Test Loss: 1.334 Test Acc: 0.667
Validation loss decreased (-0.648135 --> -0.666653).  Saving model ...
Epoch: 25 cost time: 0.505664587020874
Epoch: 25, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.306 Vali Acc: 0.693 Test Loss: 1.306 Test Acc: 0.693
Validation loss decreased (-0.666653 --> -0.692580).  Saving model ...
Epoch: 26 cost time: 0.48285508155822754
Epoch: 26, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.278 Vali Acc: 0.704 Test Loss: 1.278 Test Acc: 0.704
Validation loss decreased (-0.692580 --> -0.703691).  Saving model ...
Epoch: 27 cost time: 0.3663663864135742
Epoch: 27, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.250 Vali Acc: 0.719 Test Loss: 1.250 Test Acc: 0.719
Validation loss decreased (-0.703691 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.5250606536865234
Epoch: 28, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.222 Vali Acc: 0.726 Test Loss: 1.222 Test Acc: 0.726
Validation loss decreased (-0.718506 --> -0.725914).  Saving model ...
Epoch: 29 cost time: 0.4969809055328369
Epoch: 29, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.194 Vali Acc: 0.733 Test Loss: 1.194 Test Acc: 0.733
Validation loss decreased (-0.725914 --> -0.733321).  Saving model ...
Epoch: 30 cost time: 0.4660639762878418
Epoch: 30, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.167 Vali Acc: 0.737 Test Loss: 1.167 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737025).  Saving model ...
Epoch: 31 cost time: 0.5338482856750488
Epoch: 31, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.139 Vali Acc: 0.752 Test Loss: 1.139 Test Acc: 0.752
Validation loss decreased (-0.737025 --> -0.751840).  Saving model ...
Epoch: 32 cost time: 0.6650145053863525
Epoch: 32, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.112 Vali Acc: 0.759 Test Loss: 1.112 Test Acc: 0.759
Validation loss decreased (-0.751840 --> -0.759248).  Saving model ...
Epoch: 33 cost time: 0.688452959060669
Epoch: 33, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.085 Vali Acc: 0.770 Test Loss: 1.085 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770360).  Saving model ...
Epoch: 34 cost time: 0.7316255569458008
Epoch: 34, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.058 Vali Acc: 0.770 Test Loss: 1.058 Test Acc: 0.770
Validation loss decreased (-0.770360 --> -0.770360).  Saving model ...
Epoch: 35 cost time: 0.6343719959259033
Epoch: 35, Steps: 2 | Train Loss: 0.899 Vali Loss: 1.032 Vali Acc: 0.778 Test Loss: 1.032 Test Acc: 0.778
Validation loss decreased (-0.770360 --> -0.777767).  Saving model ...
Epoch: 36 cost time: 0.6329658031463623
Epoch: 36, Steps: 2 | Train Loss: 0.869 Vali Loss: 1.006 Vali Acc: 0.785 Test Loss: 1.006 Test Acc: 0.785
Validation loss decreased (-0.777767 --> -0.785175).  Saving model ...
Epoch: 37 cost time: 0.5217907428741455
Epoch: 37, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.980 Vali Acc: 0.789 Test Loss: 0.980 Test Acc: 0.789
Validation loss decreased (-0.785175 --> -0.788879).  Saving model ...
Epoch: 38 cost time: 0.5957069396972656
Epoch: 38, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.955 Vali Acc: 0.804 Test Loss: 0.955 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 39 cost time: 0.5208146572113037
Epoch: 39, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.930 Vali Acc: 0.804 Test Loss: 0.930 Test Acc: 0.804
Validation loss decreased (-0.803694 --> -0.803694).  Saving model ...
Epoch: 40 cost time: 0.47149658203125
Epoch: 40, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.906 Vali Acc: 0.807 Test Loss: 0.906 Test Acc: 0.807
Validation loss decreased (-0.803694 --> -0.807398).  Saving model ...
Epoch: 41 cost time: 0.6991267204284668
Epoch: 41, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.882 Vali Acc: 0.819 Test Loss: 0.882 Test Acc: 0.819
Validation loss decreased (-0.807398 --> -0.818510).  Saving model ...
Epoch: 42 cost time: 0.5219590663909912
Epoch: 42, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.859 Vali Acc: 0.833 Test Loss: 0.859 Test Acc: 0.833
Validation loss decreased (-0.818510 --> -0.833325).  Saving model ...
Epoch: 43 cost time: 0.6084120273590088
Epoch: 43, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.836 Vali Acc: 0.837 Test Loss: 0.836 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 44 cost time: 0.5580987930297852
Epoch: 44, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.814 Vali Acc: 0.848 Test Loss: 0.814 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848140).  Saving model ...
Epoch: 45 cost time: 0.5908772945404053
Epoch: 45, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.791 Vali Acc: 0.852 Test Loss: 0.791 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851844).  Saving model ...
Epoch: 46 cost time: 0.7040667533874512
Epoch: 46, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.770 Vali Acc: 0.859 Test Loss: 0.770 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 47 cost time: 0.6201028823852539
Epoch: 47, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.749 Vali Acc: 0.863 Test Loss: 0.749 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862955).  Saving model ...
Epoch: 48 cost time: 0.5640106201171875
Epoch: 48, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.728 Vali Acc: 0.867 Test Loss: 0.728 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 49 cost time: 0.5987939834594727
Epoch: 49, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.708 Vali Acc: 0.867 Test Loss: 0.708 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866660).  Saving model ...
Epoch: 50 cost time: 0.6621658802032471
Epoch: 50, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877771).  Saving model ...
Epoch: 51 cost time: 0.6020998954772949
Epoch: 51, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.670 Vali Acc: 0.889 Test Loss: 0.670 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 52 cost time: 0.6970083713531494
Epoch: 52, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.651 Vali Acc: 0.896 Test Loss: 0.651 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 53 cost time: 0.7225010395050049
Epoch: 53, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.633 Vali Acc: 0.904 Test Loss: 0.633 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903697).  Saving model ...
Epoch: 54 cost time: 0.5819511413574219
Epoch: 54, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.616 Vali Acc: 0.907 Test Loss: 0.616 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 55 cost time: 0.5871410369873047
Epoch: 55, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.600 Vali Acc: 0.907 Test Loss: 0.600 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 56 cost time: 0.538140058517456
Epoch: 56, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.583 Vali Acc: 0.907 Test Loss: 0.583 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 57 cost time: 0.5947332382202148
Epoch: 57, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.568 Vali Acc: 0.907 Test Loss: 0.568 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 58 cost time: 0.532360315322876
Epoch: 58, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.553 Vali Acc: 0.907 Test Loss: 0.553 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 59 cost time: 0.5463392734527588
Epoch: 59, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.538 Vali Acc: 0.907 Test Loss: 0.538 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 60 cost time: 0.4954261779785156
Epoch: 60, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.524 Vali Acc: 0.907 Test Loss: 0.524 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 61 cost time: 0.4820537567138672
Epoch: 61, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.511 Vali Acc: 0.904 Test Loss: 0.511 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6426849365234375
Epoch: 62, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.497 Vali Acc: 0.896 Test Loss: 0.497 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5655441284179688
Epoch: 63, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.485 Vali Acc: 0.893 Test Loss: 0.485 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5621957778930664
Epoch: 64, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.473 Vali Acc: 0.889 Test Loss: 0.473 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5420923233032227
Epoch: 65, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.461 Vali Acc: 0.889 Test Loss: 0.461 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5571577548980713
Epoch: 66, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.5123569965362549
Epoch: 67, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.440 Vali Acc: 0.889 Test Loss: 0.440 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.5301241874694824
Epoch: 68, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.430 Vali Acc: 0.889 Test Loss: 0.430 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.6188259124755859
Epoch: 69, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6291193962097168
Epoch: 70, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 15544
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8230063915252686
Epoch: 1, Steps: 2 | Train Loss: 2.087 Vali Loss: 2.004 Vali Acc: 0.019 Test Loss: 2.004 Test Acc: 0.019
Validation loss decreased (inf --> -0.018498).  Saving model ...
Epoch: 2 cost time: 0.4889202117919922
Epoch: 2, Steps: 2 | Train Loss: 2.058 Vali Loss: 1.979 Vali Acc: 0.030 Test Loss: 1.979 Test Acc: 0.030
Validation loss decreased (-0.018498 --> -0.029610).  Saving model ...
Epoch: 3 cost time: 0.45245838165283203
Epoch: 3, Steps: 2 | Train Loss: 2.028 Vali Loss: 1.962 Vali Acc: 0.037 Test Loss: 1.962 Test Acc: 0.037
Validation loss decreased (-0.029610 --> -0.037017).  Saving model ...
Epoch: 4 cost time: 0.43303894996643066
Epoch: 4, Steps: 2 | Train Loss: 2.015 Vali Loss: 1.952 Vali Acc: 0.041 Test Loss: 1.952 Test Acc: 0.041
Validation loss decreased (-0.037017 --> -0.040721).  Saving model ...
Epoch: 5 cost time: 0.3618166446685791
Epoch: 5, Steps: 2 | Train Loss: 1.997 Vali Loss: 1.938 Vali Acc: 0.041 Test Loss: 1.938 Test Acc: 0.041
Validation loss decreased (-0.040721 --> -0.040721).  Saving model ...
Epoch: 6 cost time: 0.3867614269256592
Epoch: 6, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.922 Vali Acc: 0.041 Test Loss: 1.922 Test Acc: 0.041
Validation loss decreased (-0.040721 --> -0.040722).  Saving model ...
Epoch: 7 cost time: 0.4539806842803955
Epoch: 7, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.903 Vali Acc: 0.044 Test Loss: 1.903 Test Acc: 0.044
Validation loss decreased (-0.040722 --> -0.044425).  Saving model ...
Epoch: 8 cost time: 0.4042344093322754
Epoch: 8, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.884 Vali Acc: 0.059 Test Loss: 1.884 Test Acc: 0.059
Validation loss decreased (-0.044425 --> -0.059240).  Saving model ...
Epoch: 9 cost time: 0.4881856441497803
Epoch: 9, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.862 Vali Acc: 0.085 Test Loss: 1.862 Test Acc: 0.085
Validation loss decreased (-0.059240 --> -0.085167).  Saving model ...
Epoch: 10 cost time: 0.415158748626709
Epoch: 10, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.839 Vali Acc: 0.096 Test Loss: 1.839 Test Acc: 0.096
Validation loss decreased (-0.085167 --> -0.096278).  Saving model ...
Epoch: 11 cost time: 0.42380571365356445
Epoch: 11, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.814 Vali Acc: 0.107 Test Loss: 1.814 Test Acc: 0.107
Validation loss decreased (-0.096278 --> -0.107389).  Saving model ...
Epoch: 12 cost time: 0.4306168556213379
Epoch: 12, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.788 Vali Acc: 0.126 Test Loss: 1.788 Test Acc: 0.126
Validation loss decreased (-0.107389 --> -0.125908).  Saving model ...
Epoch: 13 cost time: 0.43711090087890625
Epoch: 13, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.762 Vali Acc: 0.137 Test Loss: 1.762 Test Acc: 0.137
Validation loss decreased (-0.125908 --> -0.137019).  Saving model ...
Epoch: 14 cost time: 0.47293853759765625
Epoch: 14, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.734 Vali Acc: 0.170 Test Loss: 1.734 Test Acc: 0.170
Validation loss decreased (-0.137019 --> -0.170353).  Saving model ...
Epoch: 15 cost time: 0.44047975540161133
Epoch: 15, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.706 Vali Acc: 0.204 Test Loss: 1.706 Test Acc: 0.204
Validation loss decreased (-0.170353 --> -0.203687).  Saving model ...
Epoch: 16 cost time: 0.5001819133758545
Epoch: 16, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.677 Vali Acc: 0.233 Test Loss: 1.677 Test Acc: 0.233
Validation loss decreased (-0.203687 --> -0.233317).  Saving model ...
Epoch: 17 cost time: 0.4138455390930176
Epoch: 17, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
Validation loss decreased (-0.233317 --> -0.277761).  Saving model ...
Epoch: 18 cost time: 0.5419473648071289
Epoch: 18, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.618 Vali Acc: 0.311 Test Loss: 1.618 Test Acc: 0.311
Validation loss decreased (-0.277761 --> -0.311095).  Saving model ...
Epoch: 19 cost time: 0.4612538814544678
Epoch: 19, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.588 Vali Acc: 0.333 Test Loss: 1.588 Test Acc: 0.333
Validation loss decreased (-0.311095 --> -0.333317).  Saving model ...
Epoch: 20 cost time: 0.4928584098815918
Epoch: 20, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.557 Vali Acc: 0.385 Test Loss: 1.557 Test Acc: 0.385
Validation loss decreased (-0.333317 --> -0.385170).  Saving model ...
Epoch: 21 cost time: 0.48497867584228516
Epoch: 21, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.526 Vali Acc: 0.470 Test Loss: 1.526 Test Acc: 0.470
Validation loss decreased (-0.385170 --> -0.470355).  Saving model ...
Epoch: 22 cost time: 0.4929945468902588
Epoch: 22, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.495 Vali Acc: 0.548 Test Loss: 1.495 Test Acc: 0.548
Validation loss decreased (-0.470355 --> -0.548133).  Saving model ...
Epoch: 23 cost time: 0.5052576065063477
Epoch: 23, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.464 Vali Acc: 0.581 Test Loss: 1.464 Test Acc: 0.581
Validation loss decreased (-0.548133 --> -0.581467).  Saving model ...
Epoch: 24 cost time: 0.4560830593109131
Epoch: 24, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.432 Vali Acc: 0.626 Test Loss: 1.432 Test Acc: 0.626
Validation loss decreased (-0.581467 --> -0.625912).  Saving model ...
Epoch: 25 cost time: 0.6045091152191162
Epoch: 25, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.400 Vali Acc: 0.659 Test Loss: 1.400 Test Acc: 0.659
Validation loss decreased (-0.625912 --> -0.659245).  Saving model ...
Epoch: 26 cost time: 0.5535778999328613
Epoch: 26, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.368 Vali Acc: 0.693 Test Loss: 1.368 Test Acc: 0.693
Validation loss decreased (-0.659245 --> -0.692579).  Saving model ...
Epoch: 27 cost time: 0.5704975128173828
Epoch: 27, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.336 Vali Acc: 0.707 Test Loss: 1.336 Test Acc: 0.707
Validation loss decreased (-0.692579 --> -0.707394).  Saving model ...
Epoch: 28 cost time: 0.7053606510162354
Epoch: 28, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.304 Vali Acc: 0.737 Test Loss: 1.304 Test Acc: 0.737
Validation loss decreased (-0.707394 --> -0.737024).  Saving model ...
Epoch: 29 cost time: 0.5552828311920166
Epoch: 29, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.272 Vali Acc: 0.752 Test Loss: 1.272 Test Acc: 0.752
Validation loss decreased (-0.737024 --> -0.751839).  Saving model ...
Epoch: 30 cost time: 0.4665975570678711
Epoch: 30, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.240 Vali Acc: 0.774 Test Loss: 1.240 Test Acc: 0.774
Validation loss decreased (-0.751839 --> -0.774062).  Saving model ...
Epoch: 31 cost time: 0.4971332550048828
Epoch: 31, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.208 Vali Acc: 0.796 Test Loss: 1.208 Test Acc: 0.796
Validation loss decreased (-0.774062 --> -0.796284).  Saving model ...
Epoch: 32 cost time: 0.4192337989807129
Epoch: 32, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.176 Vali Acc: 0.811 Test Loss: 1.176 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 33 cost time: 0.529996395111084
Epoch: 33, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.145 Vali Acc: 0.815 Test Loss: 1.145 Test Acc: 0.815
Validation loss decreased (-0.811099 --> -0.814803).  Saving model ...
Epoch: 34 cost time: 0.48424267768859863
Epoch: 34, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.114 Vali Acc: 0.819 Test Loss: 1.114 Test Acc: 0.819
Validation loss decreased (-0.814803 --> -0.818507).  Saving model ...
Epoch: 35 cost time: 0.42328667640686035
Epoch: 35, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.083 Vali Acc: 0.822 Test Loss: 1.083 Test Acc: 0.822
Validation loss decreased (-0.818507 --> -0.822211).  Saving model ...
Epoch: 36 cost time: 0.5608339309692383
Epoch: 36, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.053 Vali Acc: 0.841 Test Loss: 1.053 Test Acc: 0.841
Validation loss decreased (-0.822211 --> -0.840730).  Saving model ...
Epoch: 37 cost time: 0.553847074508667
Epoch: 37, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.023 Vali Acc: 0.848 Test Loss: 1.023 Test Acc: 0.848
Validation loss decreased (-0.840730 --> -0.848138).  Saving model ...
Epoch: 38 cost time: 0.5311098098754883
Epoch: 38, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.993 Vali Acc: 0.867 Test Loss: 0.993 Test Acc: 0.867
Validation loss decreased (-0.848138 --> -0.866657).  Saving model ...
Epoch: 39 cost time: 0.47460293769836426
Epoch: 39, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.964 Vali Acc: 0.870 Test Loss: 0.964 Test Acc: 0.870
Validation loss decreased (-0.866657 --> -0.870361).  Saving model ...
Epoch: 40 cost time: 0.49622297286987305
Epoch: 40, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.935 Vali Acc: 0.874 Test Loss: 0.935 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 41 cost time: 0.3555641174316406
Epoch: 41, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.906 Vali Acc: 0.874 Test Loss: 0.906 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874065).  Saving model ...
Epoch: 42 cost time: 0.43714332580566406
Epoch: 42, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.879 Vali Acc: 0.885 Test Loss: 0.879 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885176).  Saving model ...
Epoch: 43 cost time: 0.44847726821899414
Epoch: 43, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.851 Vali Acc: 0.896 Test Loss: 0.851 Test Acc: 0.896
Validation loss decreased (-0.885176 --> -0.896288).  Saving model ...
Epoch: 44 cost time: 0.3537428379058838
Epoch: 44, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.825 Vali Acc: 0.911 Test Loss: 0.825 Test Acc: 0.911
Validation loss decreased (-0.896288 --> -0.911103).  Saving model ...
Epoch: 45 cost time: 0.4494490623474121
Epoch: 45, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.799 Vali Acc: 0.907 Test Loss: 0.799 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4498107433319092
Epoch: 46, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.773 Vali Acc: 0.911 Test Loss: 0.773 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 47 cost time: 0.45360374450683594
Epoch: 47, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.748 Vali Acc: 0.911 Test Loss: 0.748 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 48 cost time: 0.5213108062744141
Epoch: 48, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.724 Vali Acc: 0.919 Test Loss: 0.724 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918511).  Saving model ...
Epoch: 49 cost time: 0.5204236507415771
Epoch: 49, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.700 Vali Acc: 0.915 Test Loss: 0.700 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6398773193359375
Epoch: 50, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.678 Vali Acc: 0.922 Test Loss: 0.678 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 51 cost time: 0.42870187759399414
Epoch: 51, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.656 Vali Acc: 0.922 Test Loss: 0.656 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 52 cost time: 0.4743204116821289
Epoch: 52, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.634 Vali Acc: 0.919 Test Loss: 0.634 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4121367931365967
Epoch: 53, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 54 cost time: 0.6098272800445557
Epoch: 54, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.594 Vali Acc: 0.922 Test Loss: 0.594 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 55 cost time: 0.5218181610107422
Epoch: 55, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.575 Vali Acc: 0.922 Test Loss: 0.575 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 56 cost time: 0.44159507751464844
Epoch: 56, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.556 Vali Acc: 0.919 Test Loss: 0.556 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.43503594398498535
Epoch: 57, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.539 Vali Acc: 0.919 Test Loss: 0.539 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.4964008331298828
Epoch: 58, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.522 Vali Acc: 0.919 Test Loss: 0.522 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5344235897064209
Epoch: 59, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.506 Vali Acc: 0.915 Test Loss: 0.506 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5368027687072754
Epoch: 60, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5688309669494629
Epoch: 61, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.477 Vali Acc: 0.904 Test Loss: 0.477 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.4170966148376465
Epoch: 62, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.464 Vali Acc: 0.904 Test Loss: 0.464 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.4431602954864502
Epoch: 63, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.452 Vali Acc: 0.896 Test Loss: 0.452 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5190649032592773
Epoch: 64, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.440 Vali Acc: 0.896 Test Loss: 0.440 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.4597759246826172
Epoch: 65, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.430 Vali Acc: 0.896 Test Loss: 0.430 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 14854
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.674898624420166
Epoch: 1, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.729 Vali Acc: 0.244 Test Loss: 1.729 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.6400125026702881
Epoch: 2, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.714 Vali Acc: 0.267 Test Loss: 1.714 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 0.4262733459472656
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.703 Vali Acc: 0.278 Test Loss: 1.703 Test Acc: 0.278
Validation loss decreased (-0.266650 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.49315810203552246
Epoch: 4, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.694 Vali Acc: 0.278 Test Loss: 1.694 Test Acc: 0.278
Validation loss decreased (-0.277761 --> -0.277761).  Saving model ...
Epoch: 5 cost time: 0.5553145408630371
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.683 Vali Acc: 0.285 Test Loss: 1.683 Test Acc: 0.285
Validation loss decreased (-0.277761 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.49670910835266113
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.670 Vali Acc: 0.300 Test Loss: 1.670 Test Acc: 0.300
Validation loss decreased (-0.285168 --> -0.299983).  Saving model ...
Epoch: 7 cost time: 0.4963538646697998
Epoch: 7, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.656 Vali Acc: 0.311 Test Loss: 1.656 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.5534672737121582
Epoch: 8, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.640 Vali Acc: 0.337 Test Loss: 1.640 Test Acc: 0.337
Validation loss decreased (-0.311095 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.41304755210876465
Epoch: 9, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.623 Vali Acc: 0.348 Test Loss: 1.623 Test Acc: 0.348
Validation loss decreased (-0.337021 --> -0.348132).  Saving model ...
Epoch: 10 cost time: 0.5234870910644531
Epoch: 10, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.605 Vali Acc: 0.367 Test Loss: 1.605 Test Acc: 0.367
Validation loss decreased (-0.348132 --> -0.366651).  Saving model ...
Epoch: 11 cost time: 0.46118593215942383
Epoch: 11, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.585 Vali Acc: 0.400 Test Loss: 1.585 Test Acc: 0.400
Validation loss decreased (-0.366651 --> -0.399984).  Saving model ...
Epoch: 12 cost time: 0.43727731704711914
Epoch: 12, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.565 Vali Acc: 0.448 Test Loss: 1.565 Test Acc: 0.448
Validation loss decreased (-0.399984 --> -0.448132).  Saving model ...
Epoch: 13 cost time: 0.38883304595947266
Epoch: 13, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.545 Vali Acc: 0.481 Test Loss: 1.545 Test Acc: 0.481
Validation loss decreased (-0.448132 --> -0.481466).  Saving model ...
Epoch: 14 cost time: 0.4733552932739258
Epoch: 14, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.523 Vali Acc: 0.507 Test Loss: 1.523 Test Acc: 0.507
Validation loss decreased (-0.481466 --> -0.507392).  Saving model ...
Epoch: 15 cost time: 0.42172765731811523
Epoch: 15, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.501 Vali Acc: 0.541 Test Loss: 1.501 Test Acc: 0.541
Validation loss decreased (-0.507392 --> -0.540726).  Saving model ...
Epoch: 16 cost time: 0.4872095584869385
Epoch: 16, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.479 Vali Acc: 0.563 Test Loss: 1.479 Test Acc: 0.563
Validation loss decreased (-0.540726 --> -0.562948).  Saving model ...
Epoch: 17 cost time: 0.5444233417510986
Epoch: 17, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.456 Vali Acc: 0.593 Test Loss: 1.456 Test Acc: 0.593
Validation loss decreased (-0.562948 --> -0.592578).  Saving model ...
Epoch: 18 cost time: 0.42740535736083984
Epoch: 18, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.432 Vali Acc: 0.622 Test Loss: 1.432 Test Acc: 0.622
Validation loss decreased (-0.592578 --> -0.622208).  Saving model ...
Epoch: 19 cost time: 0.45525240898132324
Epoch: 19, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.409 Vali Acc: 0.637 Test Loss: 1.409 Test Acc: 0.637
Validation loss decreased (-0.622208 --> -0.637023).  Saving model ...
Epoch: 20 cost time: 0.42846202850341797
Epoch: 20, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.385 Vali Acc: 0.663 Test Loss: 1.385 Test Acc: 0.663
Validation loss decreased (-0.637023 --> -0.662949).  Saving model ...
Epoch: 21 cost time: 0.571021556854248
Epoch: 21, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.360 Vali Acc: 0.689 Test Loss: 1.360 Test Acc: 0.689
Validation loss decreased (-0.662949 --> -0.688875).  Saving model ...
Epoch: 22 cost time: 0.4879641532897949
Epoch: 22, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.336 Vali Acc: 0.704 Test Loss: 1.336 Test Acc: 0.704
Validation loss decreased (-0.688875 --> -0.703690).  Saving model ...
Epoch: 23 cost time: 0.4613935947418213
Epoch: 23, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.311 Vali Acc: 0.730 Test Loss: 1.311 Test Acc: 0.730
Validation loss decreased (-0.703690 --> -0.729617).  Saving model ...
Epoch: 24 cost time: 0.5140225887298584
Epoch: 24, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.286 Vali Acc: 0.756 Test Loss: 1.286 Test Acc: 0.756
Validation loss decreased (-0.729617 --> -0.755543).  Saving model ...
Epoch: 25 cost time: 0.6019375324249268
Epoch: 25, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.261 Vali Acc: 0.774 Test Loss: 1.261 Test Acc: 0.774
Validation loss decreased (-0.755543 --> -0.774061).  Saving model ...
Epoch: 26 cost time: 0.47538089752197266
Epoch: 26, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.237 Vali Acc: 0.774 Test Loss: 1.237 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774062).  Saving model ...
Epoch: 27 cost time: 0.4281582832336426
Epoch: 27, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.212 Vali Acc: 0.785 Test Loss: 1.212 Test Acc: 0.785
Validation loss decreased (-0.774062 --> -0.785173).  Saving model ...
Epoch: 28 cost time: 0.4995086193084717
Epoch: 28, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.187 Vali Acc: 0.807 Test Loss: 1.187 Test Acc: 0.807
Validation loss decreased (-0.785173 --> -0.807396).  Saving model ...
Epoch: 29 cost time: 0.532691240310669
Epoch: 29, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.162 Vali Acc: 0.811 Test Loss: 1.162 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811099).  Saving model ...
Epoch: 30 cost time: 0.584829568862915
Epoch: 30, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.137 Vali Acc: 0.815 Test Loss: 1.137 Test Acc: 0.815
Validation loss decreased (-0.811099 --> -0.814803).  Saving model ...
Epoch: 31 cost time: 0.5249903202056885
Epoch: 31, Steps: 2 | Train Loss: 1.044 Vali Loss: 1.112 Vali Acc: 0.826 Test Loss: 1.112 Test Acc: 0.826
Validation loss decreased (-0.814803 --> -0.825915).  Saving model ...
Epoch: 32 cost time: 0.6260018348693848
Epoch: 32, Steps: 2 | Train Loss: 1.013 Vali Loss: 1.087 Vali Acc: 0.833 Test Loss: 1.087 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833322).  Saving model ...
Epoch: 33 cost time: 0.5345067977905273
Epoch: 33, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.063 Vali Acc: 0.844 Test Loss: 1.063 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844434).  Saving model ...
Epoch: 34 cost time: 0.4322342872619629
Epoch: 34, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.039 Vali Acc: 0.848 Test Loss: 1.039 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848138).  Saving model ...
Epoch: 35 cost time: 0.43692493438720703
Epoch: 35, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.014 Vali Acc: 0.859 Test Loss: 1.014 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859249).  Saving model ...
Epoch: 36 cost time: 0.4774446487426758
Epoch: 36, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.990 Vali Acc: 0.863 Test Loss: 0.990 Test Acc: 0.863
Validation loss decreased (-0.859249 --> -0.862953).  Saving model ...
Epoch: 37 cost time: 0.5850164890289307
Epoch: 37, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.967 Vali Acc: 0.870 Test Loss: 0.967 Test Acc: 0.870
Validation loss decreased (-0.862953 --> -0.870361).  Saving model ...
Epoch: 38 cost time: 0.5008375644683838
Epoch: 38, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.943 Vali Acc: 0.870 Test Loss: 0.943 Test Acc: 0.870
Validation loss decreased (-0.870361 --> -0.870361).  Saving model ...
Epoch: 39 cost time: 0.39905881881713867
Epoch: 39, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.920 Vali Acc: 0.874 Test Loss: 0.920 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 40 cost time: 0.48770761489868164
Epoch: 40, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.897 Vali Acc: 0.878 Test Loss: 0.897 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 41 cost time: 0.4102199077606201
Epoch: 41, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.875 Vali Acc: 0.878 Test Loss: 0.875 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877769).  Saving model ...
Epoch: 42 cost time: 0.621628999710083
Epoch: 42, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.853 Vali Acc: 0.889 Test Loss: 0.853 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888880).  Saving model ...
Epoch: 43 cost time: 0.6082735061645508
Epoch: 43, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.831 Vali Acc: 0.889 Test Loss: 0.831 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888881).  Saving model ...
Epoch: 44 cost time: 0.4996767044067383
Epoch: 44, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.810 Vali Acc: 0.893 Test Loss: 0.810 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892584).  Saving model ...
Epoch: 45 cost time: 0.4702725410461426
Epoch: 45, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.789 Vali Acc: 0.900 Test Loss: 0.789 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 46 cost time: 0.42990541458129883
Epoch: 46, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.769 Vali Acc: 0.907 Test Loss: 0.769 Test Acc: 0.907
Validation loss decreased (-0.899992 --> -0.907400).  Saving model ...
Epoch: 47 cost time: 0.5952277183532715
Epoch: 47, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.749 Vali Acc: 0.907 Test Loss: 0.749 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 48 cost time: 0.5212130546569824
Epoch: 48, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.729 Vali Acc: 0.904 Test Loss: 0.729 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5307743549346924
Epoch: 49, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.711 Vali Acc: 0.911 Test Loss: 0.711 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 50 cost time: 0.5457367897033691
Epoch: 50, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.692 Vali Acc: 0.915 Test Loss: 0.692 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 51 cost time: 0.4248621463775635
Epoch: 51, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.675 Vali Acc: 0.922 Test Loss: 0.675 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922215).  Saving model ...
Epoch: 52 cost time: 0.4610168933868408
Epoch: 52, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.657 Vali Acc: 0.922 Test Loss: 0.657 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 53 cost time: 0.511282205581665
Epoch: 53, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.641 Vali Acc: 0.926 Test Loss: 0.641 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 54 cost time: 0.46866750717163086
Epoch: 54, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.624 Vali Acc: 0.926 Test Loss: 0.624 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 55 cost time: 0.5171055793762207
Epoch: 55, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.609 Vali Acc: 0.926 Test Loss: 0.609 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 56 cost time: 0.5062663555145264
Epoch: 56, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.593 Vali Acc: 0.926 Test Loss: 0.593 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 57 cost time: 0.5324413776397705
Epoch: 57, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.579 Vali Acc: 0.926 Test Loss: 0.579 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 58 cost time: 0.5469396114349365
Epoch: 58, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.564 Vali Acc: 0.926 Test Loss: 0.564 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 59 cost time: 0.4583549499511719
Epoch: 59, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.550 Vali Acc: 0.922 Test Loss: 0.550 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.46467161178588867
Epoch: 60, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.537 Vali Acc: 0.930 Test Loss: 0.537 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 61 cost time: 0.43538331985473633
Epoch: 61, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.524 Vali Acc: 0.926 Test Loss: 0.524 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.44524264335632324
Epoch: 62, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.512 Vali Acc: 0.926 Test Loss: 0.512 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.49697303771972656
Epoch: 63, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.500 Vali Acc: 0.926 Test Loss: 0.500 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.46148180961608887
Epoch: 64, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.489 Vali Acc: 0.926 Test Loss: 0.489 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.42693328857421875
Epoch: 65, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.477 Vali Acc: 0.926 Test Loss: 0.477 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.435488224029541
Epoch: 66, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.467 Vali Acc: 0.930 Test Loss: 0.467 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 67 cost time: 0.5756635665893555
Epoch: 67, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.5407743453979492
Epoch: 68, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.447 Vali Acc: 0.930 Test Loss: 0.447 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.7214272022247314
Epoch: 69, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 70 cost time: 0.5739738941192627
Epoch: 70, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.428 Vali Acc: 0.933 Test Loss: 0.428 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 71 cost time: 0.46429014205932617
Epoch: 71, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 72 cost time: 0.5616788864135742
Epoch: 72, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 73 cost time: 0.48557209968566895
Epoch: 73, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.402 Vali Acc: 0.941 Test Loss: 0.402 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 74 cost time: 0.47278881072998047
Epoch: 74, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.394 Vali Acc: 0.941 Test Loss: 0.394 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 75 cost time: 0.5072164535522461
Epoch: 75, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.386 Vali Acc: 0.941 Test Loss: 0.386 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 76 cost time: 0.49886512756347656
Epoch: 76, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.378 Vali Acc: 0.937 Test Loss: 0.378 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.4883694648742676
Epoch: 77, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6221745014190674
Epoch: 78, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.4411046504974365
Epoch: 79, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.357 Vali Acc: 0.933 Test Loss: 0.357 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.6003668308258057
Epoch: 80, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.48852968215942383
Epoch: 81, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.3845839500427246
Epoch: 82, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.42446422576904297
Epoch: 83, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.47992992401123047
Epoch: 84, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.5242304801940918
Epoch: 85, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 14682
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6348154544830322
Epoch: 1, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.802 Vali Acc: 0.359 Test Loss: 1.802 Test Acc: 0.359
Validation loss decreased (inf --> -0.359241).  Saving model ...
Epoch: 2 cost time: 0.47148704528808594
Epoch: 2, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.782 Vali Acc: 0.359 Test Loss: 1.782 Test Acc: 0.359
Validation loss decreased (-0.359241 --> -0.359241).  Saving model ...
Epoch: 3 cost time: 0.5541548728942871
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.769 Vali Acc: 0.363 Test Loss: 1.769 Test Acc: 0.363
Validation loss decreased (-0.359241 --> -0.362945).  Saving model ...
Epoch: 4 cost time: 0.5527496337890625
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.760 Vali Acc: 0.367 Test Loss: 1.760 Test Acc: 0.367
Validation loss decreased (-0.362945 --> -0.366649).  Saving model ...
Epoch: 5 cost time: 0.4761617183685303
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.748 Vali Acc: 0.367 Test Loss: 1.748 Test Acc: 0.367
Validation loss decreased (-0.366649 --> -0.366649).  Saving model ...
Epoch: 6 cost time: 0.4904780387878418
Epoch: 6, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.734 Vali Acc: 0.370 Test Loss: 1.734 Test Acc: 0.370
Validation loss decreased (-0.366649 --> -0.370353).  Saving model ...
Epoch: 7 cost time: 0.4600350856781006
Epoch: 7, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.718 Vali Acc: 0.381 Test Loss: 1.718 Test Acc: 0.381
Validation loss decreased (-0.370353 --> -0.381464).  Saving model ...
Epoch: 8 cost time: 0.5069894790649414
Epoch: 8, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.700 Vali Acc: 0.389 Test Loss: 1.700 Test Acc: 0.389
Validation loss decreased (-0.381464 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 0.4324009418487549
Epoch: 9, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.682 Vali Acc: 0.389 Test Loss: 1.682 Test Acc: 0.389
Validation loss decreased (-0.388872 --> -0.388872).  Saving model ...
Epoch: 10 cost time: 0.4636538028717041
Epoch: 10, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.662 Vali Acc: 0.389 Test Loss: 1.662 Test Acc: 0.389
Validation loss decreased (-0.388872 --> -0.388872).  Saving model ...
Epoch: 11 cost time: 0.5086543560028076
Epoch: 11, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.641 Vali Acc: 0.393 Test Loss: 1.641 Test Acc: 0.393
Validation loss decreased (-0.388872 --> -0.392576).  Saving model ...
Epoch: 12 cost time: 0.4493224620819092
Epoch: 12, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.619 Vali Acc: 0.404 Test Loss: 1.619 Test Acc: 0.404
Validation loss decreased (-0.392576 --> -0.403688).  Saving model ...
Epoch: 13 cost time: 0.3758692741394043
Epoch: 13, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.596 Vali Acc: 0.419 Test Loss: 1.596 Test Acc: 0.419
Validation loss decreased (-0.403688 --> -0.418503).  Saving model ...
Epoch: 14 cost time: 0.47560644149780273
Epoch: 14, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.572 Vali Acc: 0.426 Test Loss: 1.572 Test Acc: 0.426
Validation loss decreased (-0.418503 --> -0.425910).  Saving model ...
Epoch: 15 cost time: 0.40028905868530273
Epoch: 15, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.548 Vali Acc: 0.448 Test Loss: 1.548 Test Acc: 0.448
Validation loss decreased (-0.425910 --> -0.448133).  Saving model ...
Epoch: 16 cost time: 0.5025160312652588
Epoch: 16, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.524 Vali Acc: 0.470 Test Loss: 1.524 Test Acc: 0.470
Validation loss decreased (-0.448133 --> -0.470355).  Saving model ...
Epoch: 17 cost time: 0.46324896812438965
Epoch: 17, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.499 Vali Acc: 0.478 Test Loss: 1.499 Test Acc: 0.478
Validation loss decreased (-0.470355 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.5171167850494385
Epoch: 18, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.474 Vali Acc: 0.496 Test Loss: 1.474 Test Acc: 0.496
Validation loss decreased (-0.477763 --> -0.496282).  Saving model ...
Epoch: 19 cost time: 0.42602086067199707
Epoch: 19, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.448 Vali Acc: 0.515 Test Loss: 1.448 Test Acc: 0.515
Validation loss decreased (-0.496282 --> -0.514800).  Saving model ...
Epoch: 20 cost time: 0.4705696105957031
Epoch: 20, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.423 Vali Acc: 0.537 Test Loss: 1.423 Test Acc: 0.537
Validation loss decreased (-0.514800 --> -0.537023).  Saving model ...
Epoch: 21 cost time: 0.48911595344543457
Epoch: 21, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.397 Vali Acc: 0.556 Test Loss: 1.397 Test Acc: 0.556
Validation loss decreased (-0.537023 --> -0.555542).  Saving model ...
Epoch: 22 cost time: 0.5243301391601562
Epoch: 22, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.371 Vali Acc: 0.563 Test Loss: 1.371 Test Acc: 0.563
Validation loss decreased (-0.555542 --> -0.562949).  Saving model ...
Epoch: 23 cost time: 0.4661531448364258
Epoch: 23, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.345 Vali Acc: 0.593 Test Loss: 1.345 Test Acc: 0.593
Validation loss decreased (-0.562949 --> -0.592579).  Saving model ...
Epoch: 24 cost time: 0.4916863441467285
Epoch: 24, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.319 Vali Acc: 0.615 Test Loss: 1.319 Test Acc: 0.615
Validation loss decreased (-0.592579 --> -0.614802).  Saving model ...
Epoch: 25 cost time: 0.46810340881347656
Epoch: 25, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.293 Vali Acc: 0.641 Test Loss: 1.293 Test Acc: 0.641
Validation loss decreased (-0.614802 --> -0.640728).  Saving model ...
Epoch: 26 cost time: 0.5086030960083008
Epoch: 26, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.266 Vali Acc: 0.663 Test Loss: 1.266 Test Acc: 0.663
Validation loss decreased (-0.640728 --> -0.662950).  Saving model ...
Epoch: 27 cost time: 0.47902488708496094
Epoch: 27, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.240 Vali Acc: 0.681 Test Loss: 1.240 Test Acc: 0.681
Validation loss decreased (-0.662950 --> -0.681469).  Saving model ...
Epoch: 28 cost time: 0.5334784984588623
Epoch: 28, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.214 Vali Acc: 0.693 Test Loss: 1.214 Test Acc: 0.693
Validation loss decreased (-0.681469 --> -0.692580).  Saving model ...
Epoch: 29 cost time: 0.40375804901123047
Epoch: 29, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.188 Vali Acc: 0.715 Test Loss: 1.188 Test Acc: 0.715
Validation loss decreased (-0.692580 --> -0.714803).  Saving model ...
Epoch: 30 cost time: 0.5005645751953125
Epoch: 30, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.162 Vali Acc: 0.733 Test Loss: 1.162 Test Acc: 0.733
Validation loss decreased (-0.714803 --> -0.733322).  Saving model ...
Epoch: 31 cost time: 0.4760730266571045
Epoch: 31, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.136 Vali Acc: 0.752 Test Loss: 1.136 Test Acc: 0.752
Validation loss decreased (-0.733322 --> -0.751840).  Saving model ...
Epoch: 32 cost time: 0.37412405014038086
Epoch: 32, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.110 Vali Acc: 0.770 Test Loss: 1.110 Test Acc: 0.770
Validation loss decreased (-0.751840 --> -0.770359).  Saving model ...
Epoch: 33 cost time: 0.4361250400543213
Epoch: 33, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.085 Vali Acc: 0.793 Test Loss: 1.085 Test Acc: 0.793
Validation loss decreased (-0.770359 --> -0.792582).  Saving model ...
Epoch: 34 cost time: 0.3927175998687744
Epoch: 34, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.059 Vali Acc: 0.796 Test Loss: 1.059 Test Acc: 0.796
Validation loss decreased (-0.792582 --> -0.796286).  Saving model ...
Epoch: 35 cost time: 0.45983171463012695
Epoch: 35, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.034 Vali Acc: 0.811 Test Loss: 1.034 Test Acc: 0.811
Validation loss decreased (-0.796286 --> -0.811101).  Saving model ...
Epoch: 36 cost time: 0.5140981674194336
Epoch: 36, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.009 Vali Acc: 0.822 Test Loss: 1.009 Test Acc: 0.822
Validation loss decreased (-0.811101 --> -0.822212).  Saving model ...
Epoch: 37 cost time: 0.45230746269226074
Epoch: 37, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.984 Vali Acc: 0.837 Test Loss: 0.984 Test Acc: 0.837
Validation loss decreased (-0.822212 --> -0.837027).  Saving model ...
Epoch: 38 cost time: 0.5135750770568848
Epoch: 38, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.960 Vali Acc: 0.841 Test Loss: 0.960 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 39 cost time: 0.4721405506134033
Epoch: 39, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.936 Vali Acc: 0.852 Test Loss: 0.936 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851842).  Saving model ...
Epoch: 40 cost time: 0.4024629592895508
Epoch: 40, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.912 Vali Acc: 0.852 Test Loss: 0.912 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 41 cost time: 0.45458269119262695
Epoch: 41, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.889 Vali Acc: 0.863 Test Loss: 0.889 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862954).  Saving model ...
Epoch: 42 cost time: 0.47799181938171387
Epoch: 42, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.866 Vali Acc: 0.867 Test Loss: 0.866 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 43 cost time: 0.5081677436828613
Epoch: 43, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.843 Vali Acc: 0.867 Test Loss: 0.843 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 44 cost time: 0.49425768852233887
Epoch: 44, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.821 Vali Acc: 0.867 Test Loss: 0.821 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 45 cost time: 0.45677828788757324
Epoch: 45, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.799 Vali Acc: 0.885 Test Loss: 0.799 Test Acc: 0.885
Validation loss decreased (-0.866658 --> -0.885177).  Saving model ...
Epoch: 46 cost time: 0.46073293685913086
Epoch: 46, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.778 Vali Acc: 0.889 Test Loss: 0.778 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 47 cost time: 0.5242710113525391
Epoch: 47, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.757 Vali Acc: 0.896 Test Loss: 0.757 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 48 cost time: 0.4104747772216797
Epoch: 48, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.737 Vali Acc: 0.904 Test Loss: 0.737 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903696).  Saving model ...
Epoch: 49 cost time: 0.5317385196685791
Epoch: 49, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.717 Vali Acc: 0.904 Test Loss: 0.717 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 50 cost time: 0.5077774524688721
Epoch: 50, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.698 Vali Acc: 0.904 Test Loss: 0.698 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 51 cost time: 0.40311622619628906
Epoch: 51, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.679 Vali Acc: 0.904 Test Loss: 0.679 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 52 cost time: 0.4368865489959717
Epoch: 52, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.661 Vali Acc: 0.915 Test Loss: 0.661 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914808).  Saving model ...
Epoch: 53 cost time: 0.4408257007598877
Epoch: 53, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.643 Vali Acc: 0.919 Test Loss: 0.643 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 54 cost time: 0.5127048492431641
Epoch: 54, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.626 Vali Acc: 0.922 Test Loss: 0.626 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 55 cost time: 0.4646480083465576
Epoch: 55, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.609 Vali Acc: 0.926 Test Loss: 0.609 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 56 cost time: 0.390796422958374
Epoch: 56, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.593 Vali Acc: 0.926 Test Loss: 0.593 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 57 cost time: 0.5044376850128174
Epoch: 57, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.577 Vali Acc: 0.926 Test Loss: 0.577 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 58 cost time: 0.6560428142547607
Epoch: 58, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.562 Vali Acc: 0.926 Test Loss: 0.562 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 59 cost time: 0.5005629062652588
Epoch: 59, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.548 Vali Acc: 0.926 Test Loss: 0.548 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 60 cost time: 0.5465188026428223
Epoch: 60, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.533 Vali Acc: 0.930 Test Loss: 0.533 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 61 cost time: 0.4315831661224365
Epoch: 61, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 62 cost time: 0.43921566009521484
Epoch: 62, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.506 Vali Acc: 0.933 Test Loss: 0.506 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 63 cost time: 0.5128741264343262
Epoch: 63, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.493 Vali Acc: 0.933 Test Loss: 0.493 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 64 cost time: 0.5862655639648438
Epoch: 64, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.481 Vali Acc: 0.941 Test Loss: 0.481 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 65 cost time: 0.43877673149108887
Epoch: 65, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.469 Vali Acc: 0.941 Test Loss: 0.469 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 66 cost time: 0.4420347213745117
Epoch: 66, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.457 Vali Acc: 0.941 Test Loss: 0.457 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 67 cost time: 0.40556955337524414
Epoch: 67, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.446 Vali Acc: 0.941 Test Loss: 0.446 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 68 cost time: 0.46735548973083496
Epoch: 68, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.436 Vali Acc: 0.941 Test Loss: 0.436 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 69 cost time: 0.49248337745666504
Epoch: 69, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.425 Vali Acc: 0.941 Test Loss: 0.425 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 70 cost time: 0.494631290435791
Epoch: 70, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.415 Vali Acc: 0.941 Test Loss: 0.415 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 71 cost time: 0.5133593082427979
Epoch: 71, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.406 Vali Acc: 0.941 Test Loss: 0.406 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 72 cost time: 0.488497257232666
Epoch: 72, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.396 Vali Acc: 0.937 Test Loss: 0.396 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.4231894016265869
Epoch: 73, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.533271312713623
Epoch: 74, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.379 Vali Acc: 0.933 Test Loss: 0.379 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.4260568618774414
Epoch: 75, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.42450833320617676
Epoch: 76, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.362 Vali Acc: 0.933 Test Loss: 0.362 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.40874218940734863
Epoch: 77, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.355 Vali Acc: 0.933 Test Loss: 0.355 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.48508596420288086
Epoch: 78, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5280201435089111
Epoch: 79, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 80 cost time: 0.5759372711181641
Epoch: 80, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 81 cost time: 0.440549373626709
Epoch: 81, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 82 cost time: 0.6737911701202393
Epoch: 82, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.320 Vali Acc: 0.941 Test Loss: 0.320 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 83 cost time: 0.6108825206756592
Epoch: 83, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.314 Vali Acc: 0.941 Test Loss: 0.314 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 84 cost time: 0.4427762031555176
Epoch: 84, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 85 cost time: 0.49610018730163574
Epoch: 85, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.4587695598602295
Epoch: 86, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.3645315170288086
Epoch: 87, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.39367198944091797
Epoch: 88, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.499889612197876
Epoch: 89, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.466508150100708
Epoch: 90, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.41178464889526367
Epoch: 91, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.39157724380493164
Epoch: 92, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.37290382385253906
Epoch: 93, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.6043846607208252
Epoch: 94, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 14253
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.705118179321289
Epoch: 1, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.883 Vali Acc: 0.167 Test Loss: 1.883 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.42130184173583984
Epoch: 2, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.858 Vali Acc: 0.178 Test Loss: 1.858 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.5235145092010498
Epoch: 3, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.842 Vali Acc: 0.181 Test Loss: 1.842 Test Acc: 0.181
Validation loss decreased (-0.177759 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.49711108207702637
Epoch: 4, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.832 Vali Acc: 0.181 Test Loss: 1.832 Test Acc: 0.181
Validation loss decreased (-0.181463 --> -0.181463).  Saving model ...
Epoch: 5 cost time: 0.4643690586090088
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.818 Vali Acc: 0.200 Test Loss: 1.818 Test Acc: 0.200
Validation loss decreased (-0.181463 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.5905554294586182
Epoch: 6, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.802 Vali Acc: 0.211 Test Loss: 1.802 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 7 cost time: 0.5354154109954834
Epoch: 7, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.783 Vali Acc: 0.219 Test Loss: 1.783 Test Acc: 0.219
Validation loss decreased (-0.211093 --> -0.218501).  Saving model ...
Epoch: 8 cost time: 0.5181353092193604
Epoch: 8, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.763 Vali Acc: 0.237 Test Loss: 1.763 Test Acc: 0.237
Validation loss decreased (-0.218501 --> -0.237019).  Saving model ...
Epoch: 9 cost time: 0.5805368423461914
Epoch: 9, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.742 Vali Acc: 0.259 Test Loss: 1.742 Test Acc: 0.259
Validation loss decreased (-0.237019 --> -0.259242).  Saving model ...
Epoch: 10 cost time: 0.5913629531860352
Epoch: 10, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.719 Vali Acc: 0.285 Test Loss: 1.719 Test Acc: 0.285
Validation loss decreased (-0.259242 --> -0.285168).  Saving model ...
Epoch: 11 cost time: 0.5809235572814941
Epoch: 11, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.695 Vali Acc: 0.289 Test Loss: 1.695 Test Acc: 0.289
Validation loss decreased (-0.285168 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 0.517047643661499
Epoch: 12, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.671 Vali Acc: 0.300 Test Loss: 1.671 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 13 cost time: 0.530240535736084
Epoch: 13, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.645 Vali Acc: 0.337 Test Loss: 1.645 Test Acc: 0.337
Validation loss decreased (-0.299983 --> -0.337021).  Saving model ...
Epoch: 14 cost time: 0.6413815021514893
Epoch: 14, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.619 Vali Acc: 0.352 Test Loss: 1.619 Test Acc: 0.352
Validation loss decreased (-0.337021 --> -0.351836).  Saving model ...
Epoch: 15 cost time: 0.5999853610992432
Epoch: 15, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.593 Vali Acc: 0.367 Test Loss: 1.593 Test Acc: 0.367
Validation loss decreased (-0.351836 --> -0.366651).  Saving model ...
Epoch: 16 cost time: 0.5682759284973145
Epoch: 16, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.566 Vali Acc: 0.393 Test Loss: 1.566 Test Acc: 0.393
Validation loss decreased (-0.366651 --> -0.392577).  Saving model ...
Epoch: 17 cost time: 0.5557537078857422
Epoch: 17, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.538 Vali Acc: 0.441 Test Loss: 1.538 Test Acc: 0.441
Validation loss decreased (-0.392577 --> -0.440725).  Saving model ...
Epoch: 18 cost time: 0.5580244064331055
Epoch: 18, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.511 Vali Acc: 0.452 Test Loss: 1.511 Test Acc: 0.452
Validation loss decreased (-0.440725 --> -0.451837).  Saving model ...
Epoch: 19 cost time: 0.587315559387207
Epoch: 19, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.483 Vali Acc: 0.500 Test Loss: 1.483 Test Acc: 0.500
Validation loss decreased (-0.451837 --> -0.499985).  Saving model ...
Epoch: 20 cost time: 0.5566117763519287
Epoch: 20, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.455 Vali Acc: 0.515 Test Loss: 1.455 Test Acc: 0.515
Validation loss decreased (-0.499985 --> -0.514800).  Saving model ...
Epoch: 21 cost time: 0.6124672889709473
Epoch: 21, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.427 Vali Acc: 0.537 Test Loss: 1.427 Test Acc: 0.537
Validation loss decreased (-0.514800 --> -0.537023).  Saving model ...
Epoch: 22 cost time: 0.42938661575317383
Epoch: 22, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.399 Vali Acc: 0.578 Test Loss: 1.399 Test Acc: 0.578
Validation loss decreased (-0.537023 --> -0.577764).  Saving model ...
Epoch: 23 cost time: 0.5057189464569092
Epoch: 23, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.370 Vali Acc: 0.619 Test Loss: 1.370 Test Acc: 0.619
Validation loss decreased (-0.577764 --> -0.618505).  Saving model ...
Epoch: 24 cost time: 0.4399573802947998
Epoch: 24, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.342 Vali Acc: 0.656 Test Loss: 1.342 Test Acc: 0.656
Validation loss decreased (-0.618505 --> -0.655542).  Saving model ...
Epoch: 25 cost time: 0.4212336540222168
Epoch: 25, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.314 Vali Acc: 0.670 Test Loss: 1.314 Test Acc: 0.670
Validation loss decreased (-0.655542 --> -0.670357).  Saving model ...
Epoch: 26 cost time: 0.5946130752563477
Epoch: 26, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.286 Vali Acc: 0.711 Test Loss: 1.286 Test Acc: 0.711
Validation loss decreased (-0.670357 --> -0.711098).  Saving model ...
Epoch: 27 cost time: 0.48161864280700684
Epoch: 27, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.257 Vali Acc: 0.744 Test Loss: 1.257 Test Acc: 0.744
Validation loss decreased (-0.711098 --> -0.744432).  Saving model ...
Epoch: 28 cost time: 0.5257167816162109
Epoch: 28, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.229 Vali Acc: 0.774 Test Loss: 1.229 Test Acc: 0.774
Validation loss decreased (-0.744432 --> -0.774062).  Saving model ...
Epoch: 29 cost time: 0.5056960582733154
Epoch: 29, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.201 Vali Acc: 0.800 Test Loss: 1.201 Test Acc: 0.800
Validation loss decreased (-0.774062 --> -0.799988).  Saving model ...
Epoch: 30 cost time: 0.529355525970459
Epoch: 30, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.173 Vali Acc: 0.833 Test Loss: 1.173 Test Acc: 0.833
Validation loss decreased (-0.799988 --> -0.833322).  Saving model ...
Epoch: 31 cost time: 0.4463796615600586
Epoch: 31, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.145 Vali Acc: 0.859 Test Loss: 1.145 Test Acc: 0.859
Validation loss decreased (-0.833322 --> -0.859248).  Saving model ...
Epoch: 32 cost time: 0.6005547046661377
Epoch: 32, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.117 Vali Acc: 0.867 Test Loss: 1.117 Test Acc: 0.867
Validation loss decreased (-0.859248 --> -0.866655).  Saving model ...
Epoch: 33 cost time: 0.551464319229126
Epoch: 33, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.089 Vali Acc: 0.878 Test Loss: 1.089 Test Acc: 0.878
Validation loss decreased (-0.866655 --> -0.877767).  Saving model ...
Epoch: 34 cost time: 0.4838120937347412
Epoch: 34, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.062 Vali Acc: 0.893 Test Loss: 1.062 Test Acc: 0.893
Validation loss decreased (-0.877767 --> -0.892582).  Saving model ...
Epoch: 35 cost time: 0.5254676342010498
Epoch: 35, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.035 Vali Acc: 0.896 Test Loss: 1.035 Test Acc: 0.896
Validation loss decreased (-0.892582 --> -0.896286).  Saving model ...
Epoch: 36 cost time: 0.47099757194519043
Epoch: 36, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.008 Vali Acc: 0.896 Test Loss: 1.008 Test Acc: 0.896
Validation loss decreased (-0.896286 --> -0.896286).  Saving model ...
Epoch: 37 cost time: 0.45610928535461426
Epoch: 37, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.982 Vali Acc: 0.904 Test Loss: 0.982 Test Acc: 0.904
Validation loss decreased (-0.896286 --> -0.903694).  Saving model ...
Epoch: 38 cost time: 0.556281328201294
Epoch: 38, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.956 Vali Acc: 0.904 Test Loss: 0.956 Test Acc: 0.904
Validation loss decreased (-0.903694 --> -0.903694).  Saving model ...
Epoch: 39 cost time: 0.44004368782043457
Epoch: 39, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.930 Vali Acc: 0.911 Test Loss: 0.930 Test Acc: 0.911
Validation loss decreased (-0.903694 --> -0.911102).  Saving model ...
Epoch: 40 cost time: 0.537886381149292
Epoch: 40, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.904 Vali Acc: 0.907 Test Loss: 0.904 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.46355319023132324
Epoch: 41, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.880 Vali Acc: 0.904 Test Loss: 0.880 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4364278316497803
Epoch: 42, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.855 Vali Acc: 0.907 Test Loss: 0.855 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5764646530151367
Epoch: 43, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.831 Vali Acc: 0.907 Test Loss: 0.831 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.499544620513916
Epoch: 44, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.807 Vali Acc: 0.911 Test Loss: 0.807 Test Acc: 0.911
Validation loss decreased (-0.911102 --> -0.911103).  Saving model ...
Epoch: 45 cost time: 0.4998774528503418
Epoch: 45, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.785 Vali Acc: 0.911 Test Loss: 0.785 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 46 cost time: 0.46077394485473633
Epoch: 46, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.762 Vali Acc: 0.911 Test Loss: 0.762 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 47 cost time: 0.48653745651245117
Epoch: 47, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.740 Vali Acc: 0.919 Test Loss: 0.740 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 48 cost time: 0.4459681510925293
Epoch: 48, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.719 Vali Acc: 0.919 Test Loss: 0.719 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 49 cost time: 0.3737518787384033
Epoch: 49, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.698 Vali Acc: 0.922 Test Loss: 0.698 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 50 cost time: 0.48720526695251465
Epoch: 50, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.678 Vali Acc: 0.930 Test Loss: 0.678 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 51 cost time: 0.5297360420227051
Epoch: 51, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.658 Vali Acc: 0.930 Test Loss: 0.658 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 52 cost time: 0.44817233085632324
Epoch: 52, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.639 Vali Acc: 0.930 Test Loss: 0.639 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 53 cost time: 0.4930295944213867
Epoch: 53, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.621 Vali Acc: 0.930 Test Loss: 0.621 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 54 cost time: 0.4828968048095703
Epoch: 54, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.603 Vali Acc: 0.930 Test Loss: 0.603 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 55 cost time: 0.6845953464508057
Epoch: 55, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.585 Vali Acc: 0.930 Test Loss: 0.585 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 56 cost time: 0.6341841220855713
Epoch: 56, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.569 Vali Acc: 0.930 Test Loss: 0.569 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 57 cost time: 0.45953989028930664
Epoch: 57, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.552 Vali Acc: 0.926 Test Loss: 0.552 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.5585482120513916
Epoch: 58, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.537 Vali Acc: 0.926 Test Loss: 0.537 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.47867870330810547
Epoch: 59, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.521 Vali Acc: 0.926 Test Loss: 0.521 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.4823927879333496
Epoch: 60, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.507 Vali Acc: 0.926 Test Loss: 0.507 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.5721826553344727
Epoch: 61, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.493 Vali Acc: 0.922 Test Loss: 0.493 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.5158233642578125
Epoch: 62, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.479 Vali Acc: 0.922 Test Loss: 0.479 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 0.5629613399505615
Epoch: 63, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.466 Vali Acc: 0.919 Test Loss: 0.466 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.5181162357330322
Epoch: 64, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.453 Vali Acc: 0.922 Test Loss: 0.453 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.49283504486083984
Epoch: 65, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.441 Vali Acc: 0.926 Test Loss: 0.441 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.4881894588470459
Epoch: 66, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.429 Vali Acc: 0.926 Test Loss: 0.429 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 14216
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7171835899353027
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.875 Vali Acc: 0.078 Test Loss: 1.875 Test Acc: 0.078
Validation loss decreased (inf --> -0.077759).  Saving model ...
Epoch: 2 cost time: 0.5854792594909668
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.856 Vali Acc: 0.078 Test Loss: 1.856 Test Acc: 0.078
Validation loss decreased (-0.077759 --> -0.077759).  Saving model ...
Epoch: 3 cost time: 0.44840168952941895
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.843 Vali Acc: 0.089 Test Loss: 1.843 Test Acc: 0.089
Validation loss decreased (-0.077759 --> -0.088870).  Saving model ...
Epoch: 4 cost time: 0.5110692977905273
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.835 Vali Acc: 0.093 Test Loss: 1.835 Test Acc: 0.093
Validation loss decreased (-0.088870 --> -0.092574).  Saving model ...
Epoch: 5 cost time: 0.476224422454834
Epoch: 5, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.823 Vali Acc: 0.093 Test Loss: 1.823 Test Acc: 0.093
Validation loss decreased (-0.092574 --> -0.092574).  Saving model ...
Epoch: 6 cost time: 0.5945529937744141
Epoch: 6, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.810 Vali Acc: 0.100 Test Loss: 1.810 Test Acc: 0.100
Validation loss decreased (-0.092574 --> -0.099982).  Saving model ...
Epoch: 7 cost time: 0.6103534698486328
Epoch: 7, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.794 Vali Acc: 0.104 Test Loss: 1.794 Test Acc: 0.104
Validation loss decreased (-0.099982 --> -0.103686).  Saving model ...
Epoch: 8 cost time: 0.5121269226074219
Epoch: 8, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.777 Vali Acc: 0.119 Test Loss: 1.777 Test Acc: 0.119
Validation loss decreased (-0.103686 --> -0.118501).  Saving model ...
Epoch: 9 cost time: 0.47952985763549805
Epoch: 9, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.758 Vali Acc: 0.133 Test Loss: 1.758 Test Acc: 0.133
Validation loss decreased (-0.118501 --> -0.133316).  Saving model ...
Epoch: 10 cost time: 0.5281310081481934
Epoch: 10, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.738 Vali Acc: 0.144 Test Loss: 1.738 Test Acc: 0.144
Validation loss decreased (-0.133316 --> -0.144427).  Saving model ...
Epoch: 11 cost time: 0.7859787940979004
Epoch: 11, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.717 Vali Acc: 0.181 Test Loss: 1.717 Test Acc: 0.181
Validation loss decreased (-0.144427 --> -0.181464).  Saving model ...
Epoch: 12 cost time: 0.5683200359344482
Epoch: 12, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.695 Vali Acc: 0.211 Test Loss: 1.695 Test Acc: 0.211
Validation loss decreased (-0.181464 --> -0.211094).  Saving model ...
Epoch: 13 cost time: 0.5126616954803467
Epoch: 13, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.672 Vali Acc: 0.241 Test Loss: 1.672 Test Acc: 0.241
Validation loss decreased (-0.211094 --> -0.240724).  Saving model ...
Epoch: 14 cost time: 0.5188486576080322
Epoch: 14, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
Validation loss decreased (-0.240724 --> -0.292576).  Saving model ...
Epoch: 15 cost time: 0.4909355640411377
Epoch: 15, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.623 Vali Acc: 0.322 Test Loss: 1.623 Test Acc: 0.322
Validation loss decreased (-0.292576 --> -0.322206).  Saving model ...
Epoch: 16 cost time: 0.4838218688964844
Epoch: 16, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.598 Vali Acc: 0.356 Test Loss: 1.598 Test Acc: 0.356
Validation loss decreased (-0.322206 --> -0.355540).  Saving model ...
Epoch: 17 cost time: 0.5258758068084717
Epoch: 17, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.572 Vali Acc: 0.404 Test Loss: 1.572 Test Acc: 0.404
Validation loss decreased (-0.355540 --> -0.403688).  Saving model ...
Epoch: 18 cost time: 0.5398643016815186
Epoch: 18, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.546 Vali Acc: 0.437 Test Loss: 1.546 Test Acc: 0.437
Validation loss decreased (-0.403688 --> -0.437022).  Saving model ...
Epoch: 19 cost time: 0.5109870433807373
Epoch: 19, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.520 Vali Acc: 0.478 Test Loss: 1.520 Test Acc: 0.478
Validation loss decreased (-0.437022 --> -0.477763).  Saving model ...
Epoch: 20 cost time: 0.5360403060913086
Epoch: 20, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.493 Vali Acc: 0.515 Test Loss: 1.493 Test Acc: 0.515
Validation loss decreased (-0.477763 --> -0.514800).  Saving model ...
Epoch: 21 cost time: 0.584291934967041
Epoch: 21, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.466 Vali Acc: 0.567 Test Loss: 1.466 Test Acc: 0.567
Validation loss decreased (-0.514800 --> -0.566652).  Saving model ...
Epoch: 22 cost time: 0.558525562286377
Epoch: 22, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.566652 --> -0.599986).  Saving model ...
Epoch: 23 cost time: 0.5526247024536133
Epoch: 23, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.410 Vali Acc: 0.633 Test Loss: 1.410 Test Acc: 0.633
Validation loss decreased (-0.599986 --> -0.633319).  Saving model ...
Epoch: 24 cost time: 0.46814966201782227
Epoch: 24, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.382 Vali Acc: 0.667 Test Loss: 1.382 Test Acc: 0.667
Validation loss decreased (-0.633319 --> -0.666653).  Saving model ...
Epoch: 25 cost time: 0.470599889755249
Epoch: 25, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.353 Vali Acc: 0.693 Test Loss: 1.353 Test Acc: 0.693
Validation loss decreased (-0.666653 --> -0.692579).  Saving model ...
Epoch: 26 cost time: 0.6337194442749023
Epoch: 26, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.325 Vali Acc: 0.722 Test Loss: 1.325 Test Acc: 0.722
Validation loss decreased (-0.692579 --> -0.722209).  Saving model ...
Epoch: 27 cost time: 0.4053812026977539
Epoch: 27, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.297 Vali Acc: 0.748 Test Loss: 1.297 Test Acc: 0.748
Validation loss decreased (-0.722209 --> -0.748135).  Saving model ...
Epoch: 28 cost time: 0.44063520431518555
Epoch: 28, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.268 Vali Acc: 0.770 Test Loss: 1.268 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770358).  Saving model ...
Epoch: 29 cost time: 0.4210352897644043
Epoch: 29, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.239 Vali Acc: 0.785 Test Loss: 1.239 Test Acc: 0.785
Validation loss decreased (-0.770358 --> -0.785173).  Saving model ...
Epoch: 30 cost time: 0.41787195205688477
Epoch: 30, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.211 Vali Acc: 0.796 Test Loss: 1.211 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796284).  Saving model ...
Epoch: 31 cost time: 0.5361671447753906
Epoch: 31, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.182 Vali Acc: 0.800 Test Loss: 1.182 Test Acc: 0.800
Validation loss decreased (-0.796284 --> -0.799988).  Saving model ...
Epoch: 32 cost time: 0.6512539386749268
Epoch: 32, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.154 Vali Acc: 0.811 Test Loss: 1.154 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811100).  Saving model ...
Epoch: 33 cost time: 0.4373018741607666
Epoch: 33, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.125 Vali Acc: 0.830 Test Loss: 1.125 Test Acc: 0.830
Validation loss decreased (-0.811100 --> -0.829618).  Saving model ...
Epoch: 34 cost time: 0.47336506843566895
Epoch: 34, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.097 Vali Acc: 0.833 Test Loss: 1.097 Test Acc: 0.833
Validation loss decreased (-0.829618 --> -0.833322).  Saving model ...
Epoch: 35 cost time: 0.46128010749816895
Epoch: 35, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.069 Vali Acc: 0.837 Test Loss: 1.069 Test Acc: 0.837
Validation loss decreased (-0.833322 --> -0.837026).  Saving model ...
Epoch: 36 cost time: 0.4900522232055664
Epoch: 36, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.042 Vali Acc: 0.844 Test Loss: 1.042 Test Acc: 0.844
Validation loss decreased (-0.837026 --> -0.844434).  Saving model ...
Epoch: 37 cost time: 0.4728524684906006
Epoch: 37, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.015 Vali Acc: 0.848 Test Loss: 1.015 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848138).  Saving model ...
Epoch: 38 cost time: 0.43045568466186523
Epoch: 38, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.988 Vali Acc: 0.859 Test Loss: 0.988 Test Acc: 0.859
Validation loss decreased (-0.848138 --> -0.859249).  Saving model ...
Epoch: 39 cost time: 0.4685211181640625
Epoch: 39, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.961 Vali Acc: 0.867 Test Loss: 0.961 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866657).  Saving model ...
Epoch: 40 cost time: 0.5120449066162109
Epoch: 40, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.935 Vali Acc: 0.881 Test Loss: 0.935 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881472).  Saving model ...
Epoch: 41 cost time: 0.5052363872528076
Epoch: 41, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.910 Vali Acc: 0.889 Test Loss: 0.910 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 42 cost time: 0.5199878215789795
Epoch: 42, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.885 Vali Acc: 0.889 Test Loss: 0.885 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 43 cost time: 0.5313174724578857
Epoch: 43, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.861 Vali Acc: 0.889 Test Loss: 0.861 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 44 cost time: 0.5579006671905518
Epoch: 44, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.837 Vali Acc: 0.889 Test Loss: 0.837 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888881).  Saving model ...
Epoch: 45 cost time: 0.48729848861694336
Epoch: 45, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.814 Vali Acc: 0.889 Test Loss: 0.814 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 46 cost time: 0.4774208068847656
Epoch: 46, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.791 Vali Acc: 0.893 Test Loss: 0.791 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 47 cost time: 0.46556878089904785
Epoch: 47, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.769 Vali Acc: 0.893 Test Loss: 0.769 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 48 cost time: 0.5891625881195068
Epoch: 48, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.748 Vali Acc: 0.893 Test Loss: 0.748 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 49 cost time: 0.40766143798828125
Epoch: 49, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.727 Vali Acc: 0.904 Test Loss: 0.727 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903696).  Saving model ...
Epoch: 50 cost time: 0.5281929969787598
Epoch: 50, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.707 Vali Acc: 0.904 Test Loss: 0.707 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 51 cost time: 0.48273181915283203
Epoch: 51, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.687 Vali Acc: 0.900 Test Loss: 0.687 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.5063903331756592
Epoch: 52, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 53 cost time: 0.45708417892456055
Epoch: 53, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.650 Vali Acc: 0.907 Test Loss: 0.650 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 54 cost time: 0.46297430992126465
Epoch: 54, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.632 Vali Acc: 0.907 Test Loss: 0.632 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 55 cost time: 0.4050445556640625
Epoch: 55, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.615 Vali Acc: 0.907 Test Loss: 0.615 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 56 cost time: 0.43651533126831055
Epoch: 56, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.599 Vali Acc: 0.907 Test Loss: 0.599 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 57 cost time: 0.4815056324005127
Epoch: 57, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.583 Vali Acc: 0.907 Test Loss: 0.583 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 58 cost time: 0.514101505279541
Epoch: 58, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.568 Vali Acc: 0.911 Test Loss: 0.568 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911105).  Saving model ...
Epoch: 59 cost time: 0.640484094619751
Epoch: 59, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.553 Vali Acc: 0.911 Test Loss: 0.553 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 60 cost time: 0.5216538906097412
Epoch: 60, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.539 Vali Acc: 0.911 Test Loss: 0.539 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 61 cost time: 0.6050498485565186
Epoch: 61, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.526 Vali Acc: 0.911 Test Loss: 0.526 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 62 cost time: 0.5816783905029297
Epoch: 62, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 63 cost time: 0.506256103515625
Epoch: 63, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.501 Vali Acc: 0.911 Test Loss: 0.501 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 64 cost time: 0.6364386081695557
Epoch: 64, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.490 Vali Acc: 0.911 Test Loss: 0.490 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 65 cost time: 0.5653891563415527
Epoch: 65, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.478 Vali Acc: 0.911 Test Loss: 0.478 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 66 cost time: 0.4767732620239258
Epoch: 66, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.467 Vali Acc: 0.911 Test Loss: 0.467 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 67 cost time: 0.5315444469451904
Epoch: 67, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.457 Vali Acc: 0.911 Test Loss: 0.457 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 68 cost time: 0.486006498336792
Epoch: 68, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 69 cost time: 0.5342884063720703
Epoch: 69, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 70 cost time: 0.5827136039733887
Epoch: 70, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 71 cost time: 0.46631431579589844
Epoch: 71, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 72 cost time: 0.6255273818969727
Epoch: 72, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 73 cost time: 0.4936220645904541
Epoch: 73, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.402 Vali Acc: 0.911 Test Loss: 0.402 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 74 cost time: 0.45537829399108887
Epoch: 74, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.394 Vali Acc: 0.911 Test Loss: 0.394 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 75 cost time: 0.5360958576202393
Epoch: 75, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 76 cost time: 0.49346327781677246
Epoch: 76, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 77 cost time: 0.4562959671020508
Epoch: 77, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.372 Vali Acc: 0.907 Test Loss: 0.372 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.4761524200439453
Epoch: 78, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.4581775665283203
Epoch: 79, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.47128963470458984
Epoch: 80, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.355 Vali Acc: 0.904 Test Loss: 0.355 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5755369663238525
Epoch: 81, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.39420151710510254
Epoch: 82, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.345 Vali Acc: 0.900 Test Loss: 0.345 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.6962084770202637
Epoch: 83, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.8459732532501221
Epoch: 84, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.6092410087585449
Epoch: 85, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.5025050640106201
Epoch: 86, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.328 Vali Acc: 0.896 Test Loss: 0.328 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 14442
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.5774424076080322
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.780 Vali Acc: 0.259 Test Loss: 1.780 Test Acc: 0.259
Validation loss decreased (inf --> -0.259241).  Saving model ...
Epoch: 2 cost time: 0.46721792221069336
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.764 Vali Acc: 0.293 Test Loss: 1.764 Test Acc: 0.293
Validation loss decreased (-0.259241 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.5474398136138916
Epoch: 3, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.753 Vali Acc: 0.296 Test Loss: 1.753 Test Acc: 0.296
Validation loss decreased (-0.292575 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.46371912956237793
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.744 Vali Acc: 0.307 Test Loss: 1.744 Test Acc: 0.307
Validation loss decreased (-0.296279 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.43183469772338867
Epoch: 5, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.734 Vali Acc: 0.319 Test Loss: 1.734 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318501).  Saving model ...
Epoch: 6 cost time: 0.451202392578125
Epoch: 6, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.721 Vali Acc: 0.326 Test Loss: 1.721 Test Acc: 0.326
Validation loss decreased (-0.318501 --> -0.325909).  Saving model ...
Epoch: 7 cost time: 0.4561014175415039
Epoch: 7, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.707 Vali Acc: 0.333 Test Loss: 1.707 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333316).  Saving model ...
Epoch: 8 cost time: 0.4074850082397461
Epoch: 8, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.691 Vali Acc: 0.344 Test Loss: 1.691 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.4374244213104248
Epoch: 9, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.673 Vali Acc: 0.348 Test Loss: 1.673 Test Acc: 0.348
Validation loss decreased (-0.344428 --> -0.348131).  Saving model ...
Epoch: 10 cost time: 0.38470005989074707
Epoch: 10, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.655 Vali Acc: 0.356 Test Loss: 1.655 Test Acc: 0.356
Validation loss decreased (-0.348131 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 0.5374116897583008
Epoch: 11, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.635 Vali Acc: 0.367 Test Loss: 1.635 Test Acc: 0.367
Validation loss decreased (-0.355539 --> -0.366650).  Saving model ...
Epoch: 12 cost time: 0.5038816928863525
Epoch: 12, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.615 Vali Acc: 0.378 Test Loss: 1.615 Test Acc: 0.378
Validation loss decreased (-0.366650 --> -0.377762).  Saving model ...
Epoch: 13 cost time: 0.4312591552734375
Epoch: 13, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.593 Vali Acc: 0.385 Test Loss: 1.593 Test Acc: 0.385
Validation loss decreased (-0.377762 --> -0.385169).  Saving model ...
Epoch: 14 cost time: 0.42984652519226074
Epoch: 14, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.571 Vali Acc: 0.396 Test Loss: 1.571 Test Acc: 0.396
Validation loss decreased (-0.385169 --> -0.396281).  Saving model ...
Epoch: 15 cost time: 0.4127044677734375
Epoch: 15, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.549 Vali Acc: 0.426 Test Loss: 1.549 Test Acc: 0.426
Validation loss decreased (-0.396281 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.47603607177734375
Epoch: 16, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.526 Vali Acc: 0.437 Test Loss: 1.526 Test Acc: 0.437
Validation loss decreased (-0.425910 --> -0.437022).  Saving model ...
Epoch: 17 cost time: 0.45075178146362305
Epoch: 17, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.502 Vali Acc: 0.459 Test Loss: 1.502 Test Acc: 0.459
Validation loss decreased (-0.437022 --> -0.459244).  Saving model ...
Epoch: 18 cost time: 0.5103335380554199
Epoch: 18, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.478 Vali Acc: 0.474 Test Loss: 1.478 Test Acc: 0.474
Validation loss decreased (-0.459244 --> -0.474059).  Saving model ...
Epoch: 19 cost time: 0.4580039978027344
Epoch: 19, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.454 Vali Acc: 0.493 Test Loss: 1.454 Test Acc: 0.493
Validation loss decreased (-0.474059 --> -0.492578).  Saving model ...
Epoch: 20 cost time: 0.3748133182525635
Epoch: 20, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.429 Vali Acc: 0.515 Test Loss: 1.429 Test Acc: 0.515
Validation loss decreased (-0.492578 --> -0.514801).  Saving model ...
Epoch: 21 cost time: 0.5960729122161865
Epoch: 21, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.404 Vali Acc: 0.533 Test Loss: 1.404 Test Acc: 0.533
Validation loss decreased (-0.514801 --> -0.533319).  Saving model ...
Epoch: 22 cost time: 0.4649050235748291
Epoch: 22, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.379 Vali Acc: 0.556 Test Loss: 1.379 Test Acc: 0.556
Validation loss decreased (-0.533319 --> -0.555542).  Saving model ...
Epoch: 23 cost time: 0.47887301445007324
Epoch: 23, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.354 Vali Acc: 0.578 Test Loss: 1.354 Test Acc: 0.578
Validation loss decreased (-0.555542 --> -0.577764).  Saving model ...
Epoch: 24 cost time: 0.4890141487121582
Epoch: 24, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.328 Vali Acc: 0.593 Test Loss: 1.328 Test Acc: 0.593
Validation loss decreased (-0.577764 --> -0.592579).  Saving model ...
Epoch: 25 cost time: 0.6066062450408936
Epoch: 25, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.302 Vali Acc: 0.619 Test Loss: 1.302 Test Acc: 0.619
Validation loss decreased (-0.592579 --> -0.618505).  Saving model ...
Epoch: 26 cost time: 0.5560610294342041
Epoch: 26, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.277 Vali Acc: 0.644 Test Loss: 1.277 Test Acc: 0.644
Validation loss decreased (-0.618505 --> -0.644432).  Saving model ...
Epoch: 27 cost time: 0.47315335273742676
Epoch: 27, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.251 Vali Acc: 0.659 Test Loss: 1.251 Test Acc: 0.659
Validation loss decreased (-0.644432 --> -0.659247).  Saving model ...
Epoch: 28 cost time: 0.6068758964538574
Epoch: 28, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.225 Vali Acc: 0.670 Test Loss: 1.225 Test Acc: 0.670
Validation loss decreased (-0.659247 --> -0.670358).  Saving model ...
Epoch: 29 cost time: 0.5409984588623047
Epoch: 29, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.199 Vali Acc: 0.700 Test Loss: 1.199 Test Acc: 0.700
Validation loss decreased (-0.670358 --> -0.699988).  Saving model ...
Epoch: 30 cost time: 0.49675774574279785
Epoch: 30, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.173 Vali Acc: 0.719 Test Loss: 1.173 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 31 cost time: 0.44086790084838867
Epoch: 31, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.147 Vali Acc: 0.722 Test Loss: 1.147 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 32 cost time: 0.48842334747314453
Epoch: 32, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.121 Vali Acc: 0.744 Test Loss: 1.121 Test Acc: 0.744
Validation loss decreased (-0.722211 --> -0.744433).  Saving model ...
Epoch: 33 cost time: 0.4883882999420166
Epoch: 33, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.096 Vali Acc: 0.759 Test Loss: 1.096 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 34 cost time: 0.4480257034301758
Epoch: 34, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.070 Vali Acc: 0.778 Test Loss: 1.070 Test Acc: 0.778
Validation loss decreased (-0.759248 --> -0.777767).  Saving model ...
Epoch: 35 cost time: 0.44518208503723145
Epoch: 35, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.045 Vali Acc: 0.785 Test Loss: 1.045 Test Acc: 0.785
Validation loss decreased (-0.777767 --> -0.785175).  Saving model ...
Epoch: 36 cost time: 0.5552589893341064
Epoch: 36, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.020 Vali Acc: 0.804 Test Loss: 1.020 Test Acc: 0.804
Validation loss decreased (-0.785175 --> -0.803694).  Saving model ...
Epoch: 37 cost time: 0.5333449840545654
Epoch: 37, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.995 Vali Acc: 0.811 Test Loss: 0.995 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811101).  Saving model ...
Epoch: 38 cost time: 0.5801451206207275
Epoch: 38, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.970 Vali Acc: 0.833 Test Loss: 0.970 Test Acc: 0.833
Validation loss decreased (-0.811101 --> -0.833324).  Saving model ...
Epoch: 39 cost time: 0.4865386486053467
Epoch: 39, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.946 Vali Acc: 0.841 Test Loss: 0.946 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840731).  Saving model ...
Epoch: 40 cost time: 0.6036992073059082
Epoch: 40, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.922 Vali Acc: 0.859 Test Loss: 0.922 Test Acc: 0.859
Validation loss decreased (-0.840731 --> -0.859250).  Saving model ...
Epoch: 41 cost time: 0.6485159397125244
Epoch: 41, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.898 Vali Acc: 0.863 Test Loss: 0.898 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 42 cost time: 0.7052075862884521
Epoch: 42, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.874 Vali Acc: 0.870 Test Loss: 0.874 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 43 cost time: 0.5835673809051514
Epoch: 43, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.851 Vali Acc: 0.881 Test Loss: 0.851 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881473).  Saving model ...
Epoch: 44 cost time: 0.574678897857666
Epoch: 44, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.829 Vali Acc: 0.893 Test Loss: 0.829 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892584).  Saving model ...
Epoch: 45 cost time: 0.5362122058868408
Epoch: 45, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.806 Vali Acc: 0.904 Test Loss: 0.806 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 46 cost time: 0.5534765720367432
Epoch: 46, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.784 Vali Acc: 0.911 Test Loss: 0.784 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911103).  Saving model ...
Epoch: 47 cost time: 0.5822906494140625
Epoch: 47, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.763 Vali Acc: 0.919 Test Loss: 0.763 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918511).  Saving model ...
Epoch: 48 cost time: 0.49294495582580566
Epoch: 48, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.741 Vali Acc: 0.919 Test Loss: 0.741 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 49 cost time: 0.48953962326049805
Epoch: 49, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.721 Vali Acc: 0.915 Test Loss: 0.721 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5216391086578369
Epoch: 50, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.700 Vali Acc: 0.915 Test Loss: 0.700 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5266318321228027
Epoch: 51, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.680 Vali Acc: 0.922 Test Loss: 0.680 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 52 cost time: 0.5790667533874512
Epoch: 52, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.661 Vali Acc: 0.922 Test Loss: 0.661 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 53 cost time: 0.5039584636688232
Epoch: 53, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.641 Vali Acc: 0.926 Test Loss: 0.641 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 54 cost time: 0.5122811794281006
Epoch: 54, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.623 Vali Acc: 0.926 Test Loss: 0.623 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 55 cost time: 0.4912893772125244
Epoch: 55, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.604 Vali Acc: 0.926 Test Loss: 0.604 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 56 cost time: 0.5361530780792236
Epoch: 56, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.586 Vali Acc: 0.922 Test Loss: 0.586 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6310122013092041
Epoch: 57, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.569 Vali Acc: 0.926 Test Loss: 0.569 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 58 cost time: 0.6112139225006104
Epoch: 58, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.551 Vali Acc: 0.930 Test Loss: 0.551 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 59 cost time: 0.5958139896392822
Epoch: 59, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.535 Vali Acc: 0.930 Test Loss: 0.535 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 60 cost time: 0.4862947463989258
Epoch: 60, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.519 Vali Acc: 0.933 Test Loss: 0.519 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 61 cost time: 0.5117206573486328
Epoch: 61, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.503 Vali Acc: 0.930 Test Loss: 0.503 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6645574569702148
Epoch: 62, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.487 Vali Acc: 0.930 Test Loss: 0.487 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5451803207397461
Epoch: 63, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.472 Vali Acc: 0.926 Test Loss: 0.472 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6049454212188721
Epoch: 64, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.458 Vali Acc: 0.926 Test Loss: 0.458 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5513226985931396
Epoch: 65, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.444 Vali Acc: 0.926 Test Loss: 0.444 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5769469738006592
Epoch: 66, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.431 Vali Acc: 0.926 Test Loss: 0.431 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.5440418720245361
Epoch: 67, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.418 Vali Acc: 0.922 Test Loss: 0.418 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.6214468479156494
Epoch: 68, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.406 Vali Acc: 0.919 Test Loss: 0.406 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.48591160774230957
Epoch: 69, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6412482261657715
Epoch: 70, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 14542
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.7244234085083008
Epoch: 1, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.740 Vali Acc: 0.248 Test Loss: 1.740 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.47449541091918945
Epoch: 2, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.724 Vali Acc: 0.263 Test Loss: 1.724 Test Acc: 0.263
Validation loss decreased (-0.248131 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.4616973400115967
Epoch: 3, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
Validation loss decreased (-0.262946 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.46228837966918945
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.705 Vali Acc: 0.278 Test Loss: 1.705 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 5 cost time: 0.4093194007873535
Epoch: 5, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.695 Vali Acc: 0.293 Test Loss: 1.695 Test Acc: 0.293
Validation loss decreased (-0.277761 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.4627230167388916
Epoch: 6, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.682 Vali Acc: 0.307 Test Loss: 1.682 Test Acc: 0.307
Validation loss decreased (-0.292576 --> -0.307391).  Saving model ...
Epoch: 7 cost time: 0.5044419765472412
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.668 Vali Acc: 0.326 Test Loss: 1.668 Test Acc: 0.326
Validation loss decreased (-0.307391 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 0.3967864513397217
Epoch: 8, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.652 Vali Acc: 0.341 Test Loss: 1.652 Test Acc: 0.341
Validation loss decreased (-0.325909 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.5337998867034912
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.635 Vali Acc: 0.359 Test Loss: 1.635 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 10 cost time: 0.4526855945587158
Epoch: 10, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.617 Vali Acc: 0.374 Test Loss: 1.617 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374058).  Saving model ...
Epoch: 11 cost time: 0.43853187561035156
Epoch: 11, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.599 Vali Acc: 0.385 Test Loss: 1.599 Test Acc: 0.385
Validation loss decreased (-0.374058 --> -0.385169).  Saving model ...
Epoch: 12 cost time: 0.5199875831604004
Epoch: 12, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.579 Vali Acc: 0.415 Test Loss: 1.579 Test Acc: 0.415
Validation loss decreased (-0.385169 --> -0.414799).  Saving model ...
Epoch: 13 cost time: 0.4445512294769287
Epoch: 13, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.558 Vali Acc: 0.422 Test Loss: 1.558 Test Acc: 0.422
Validation loss decreased (-0.414799 --> -0.422207).  Saving model ...
Epoch: 14 cost time: 0.5709187984466553
Epoch: 14, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.537 Vali Acc: 0.463 Test Loss: 1.537 Test Acc: 0.463
Validation loss decreased (-0.422207 --> -0.462948).  Saving model ...
Epoch: 15 cost time: 0.5741293430328369
Epoch: 15, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.515 Vali Acc: 0.478 Test Loss: 1.515 Test Acc: 0.478
Validation loss decreased (-0.462948 --> -0.477763).  Saving model ...
Epoch: 16 cost time: 0.3558471202850342
Epoch: 16, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.492 Vali Acc: 0.504 Test Loss: 1.492 Test Acc: 0.504
Validation loss decreased (-0.477763 --> -0.503689).  Saving model ...
Epoch: 17 cost time: 0.46819186210632324
Epoch: 17, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.469 Vali Acc: 0.541 Test Loss: 1.469 Test Acc: 0.541
Validation loss decreased (-0.503689 --> -0.540726).  Saving model ...
Epoch: 18 cost time: 0.5162007808685303
Epoch: 18, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.446 Vali Acc: 0.567 Test Loss: 1.446 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566652).  Saving model ...
Epoch: 19 cost time: 0.42699408531188965
Epoch: 19, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.422 Vali Acc: 0.581 Test Loss: 1.422 Test Acc: 0.581
Validation loss decreased (-0.566652 --> -0.581467).  Saving model ...
Epoch: 20 cost time: 0.4728577136993408
Epoch: 20, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.398 Vali Acc: 0.615 Test Loss: 1.398 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 21 cost time: 0.4530322551727295
Epoch: 21, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.373 Vali Acc: 0.648 Test Loss: 1.373 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648134).  Saving model ...
Epoch: 22 cost time: 0.4297618865966797
Epoch: 22, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.348 Vali Acc: 0.659 Test Loss: 1.348 Test Acc: 0.659
Validation loss decreased (-0.648134 --> -0.659246).  Saving model ...
Epoch: 23 cost time: 0.4741182327270508
Epoch: 23, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.323 Vali Acc: 0.678 Test Loss: 1.323 Test Acc: 0.678
Validation loss decreased (-0.659246 --> -0.677765).  Saving model ...
Epoch: 24 cost time: 0.49265336990356445
Epoch: 24, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.298 Vali Acc: 0.696 Test Loss: 1.298 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696283).  Saving model ...
Epoch: 25 cost time: 0.584608793258667
Epoch: 25, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.272 Vali Acc: 0.726 Test Loss: 1.272 Test Acc: 0.726
Validation loss decreased (-0.696283 --> -0.725913).  Saving model ...
Epoch: 26 cost time: 0.4477529525756836
Epoch: 26, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.247 Vali Acc: 0.733 Test Loss: 1.247 Test Acc: 0.733
Validation loss decreased (-0.725913 --> -0.733321).  Saving model ...
Epoch: 27 cost time: 0.4731447696685791
Epoch: 27, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.221 Vali Acc: 0.756 Test Loss: 1.221 Test Acc: 0.756
Validation loss decreased (-0.733321 --> -0.755543).  Saving model ...
Epoch: 28 cost time: 0.4792826175689697
Epoch: 28, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.196 Vali Acc: 0.778 Test Loss: 1.196 Test Acc: 0.778
Validation loss decreased (-0.755543 --> -0.777766).  Saving model ...
Epoch: 29 cost time: 0.6092283725738525
Epoch: 29, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.170 Vali Acc: 0.796 Test Loss: 1.170 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 30 cost time: 0.4290635585784912
Epoch: 30, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.144 Vali Acc: 0.811 Test Loss: 1.144 Test Acc: 0.811
Validation loss decreased (-0.796285 --> -0.811100).  Saving model ...
Epoch: 31 cost time: 0.4910702705383301
Epoch: 31, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.118 Vali Acc: 0.819 Test Loss: 1.118 Test Acc: 0.819
Validation loss decreased (-0.811100 --> -0.818507).  Saving model ...
Epoch: 32 cost time: 0.44121718406677246
Epoch: 32, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.093 Vali Acc: 0.826 Test Loss: 1.093 Test Acc: 0.826
Validation loss decreased (-0.818507 --> -0.825915).  Saving model ...
Epoch: 33 cost time: 0.46411728858947754
Epoch: 33, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.067 Vali Acc: 0.837 Test Loss: 1.067 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837026).  Saving model ...
Epoch: 34 cost time: 0.5577785968780518
Epoch: 34, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.042 Vali Acc: 0.844 Test Loss: 1.042 Test Acc: 0.844
Validation loss decreased (-0.837026 --> -0.844434).  Saving model ...
Epoch: 35 cost time: 0.5525190830230713
Epoch: 35, Steps: 2 | Train Loss: 0.878 Vali Loss: 1.017 Vali Acc: 0.852 Test Loss: 1.017 Test Acc: 0.852
Validation loss decreased (-0.844434 --> -0.851842).  Saving model ...
Epoch: 36 cost time: 0.3973512649536133
Epoch: 36, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.992 Vali Acc: 0.859 Test Loss: 0.992 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859249).  Saving model ...
Epoch: 37 cost time: 0.5113921165466309
Epoch: 37, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.967 Vali Acc: 0.863 Test Loss: 0.967 Test Acc: 0.863
Validation loss decreased (-0.859249 --> -0.862953).  Saving model ...
Epoch: 38 cost time: 0.5489952564239502
Epoch: 38, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.943 Vali Acc: 0.863 Test Loss: 0.943 Test Acc: 0.863
Validation loss decreased (-0.862953 --> -0.862954).  Saving model ...
Epoch: 39 cost time: 0.35930299758911133
Epoch: 39, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.918 Vali Acc: 0.874 Test Loss: 0.918 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874065).  Saving model ...
Epoch: 40 cost time: 0.5767858028411865
Epoch: 40, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.894 Vali Acc: 0.874 Test Loss: 0.894 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874065).  Saving model ...
Epoch: 41 cost time: 0.4775257110595703
Epoch: 41, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.871 Vali Acc: 0.878 Test Loss: 0.871 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 42 cost time: 0.4086720943450928
Epoch: 42, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.847 Vali Acc: 0.878 Test Loss: 0.847 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877769).  Saving model ...
Epoch: 43 cost time: 0.5781722068786621
Epoch: 43, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.824 Vali Acc: 0.889 Test Loss: 0.824 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888881).  Saving model ...
Epoch: 44 cost time: 0.4412803649902344
Epoch: 44, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.802 Vali Acc: 0.889 Test Loss: 0.802 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 45 cost time: 0.4644911289215088
Epoch: 45, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.780 Vali Acc: 0.889 Test Loss: 0.780 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 46 cost time: 0.4458448886871338
Epoch: 46, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.758 Vali Acc: 0.893 Test Loss: 0.758 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 47 cost time: 0.42435789108276367
Epoch: 47, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 48 cost time: 0.4882633686065674
Epoch: 48, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.716 Vali Acc: 0.900 Test Loss: 0.716 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 49 cost time: 0.5481750965118408
Epoch: 49, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.695 Vali Acc: 0.904 Test Loss: 0.695 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 50 cost time: 0.41979551315307617
Epoch: 50, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.675 Vali Acc: 0.904 Test Loss: 0.675 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 51 cost time: 0.4811675548553467
Epoch: 51, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.656 Vali Acc: 0.904 Test Loss: 0.656 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 52 cost time: 0.43183326721191406
Epoch: 52, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.637 Vali Acc: 0.904 Test Loss: 0.637 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 53 cost time: 0.39223456382751465
Epoch: 53, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.618 Vali Acc: 0.904 Test Loss: 0.618 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 54 cost time: 0.4218485355377197
Epoch: 54, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.600 Vali Acc: 0.904 Test Loss: 0.600 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 55 cost time: 0.6073219776153564
Epoch: 55, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.582 Vali Acc: 0.911 Test Loss: 0.582 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 56 cost time: 0.42551159858703613
Epoch: 56, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 57 cost time: 0.4595491886138916
Epoch: 57, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.547 Vali Acc: 0.911 Test Loss: 0.547 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 58 cost time: 0.46319031715393066
Epoch: 58, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.531 Vali Acc: 0.911 Test Loss: 0.531 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 59 cost time: 0.4655296802520752
Epoch: 59, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.515 Vali Acc: 0.915 Test Loss: 0.515 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 60 cost time: 0.5483832359313965
Epoch: 60, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.499 Vali Acc: 0.915 Test Loss: 0.499 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 61 cost time: 0.5320208072662354
Epoch: 61, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.483 Vali Acc: 0.907 Test Loss: 0.483 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4227163791656494
Epoch: 62, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.506648063659668
Epoch: 63, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.454 Vali Acc: 0.907 Test Loss: 0.454 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5481348037719727
Epoch: 64, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.440 Vali Acc: 0.915 Test Loss: 0.440 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 65 cost time: 0.38884449005126953
Epoch: 65, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.426 Vali Acc: 0.915 Test Loss: 0.426 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 66 cost time: 0.4564542770385742
Epoch: 66, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 67 cost time: 0.4871792793273926
Epoch: 67, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.400 Vali Acc: 0.915 Test Loss: 0.400 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 68 cost time: 0.46495962142944336
Epoch: 68, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 69 cost time: 0.4348733425140381
Epoch: 69, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.377 Vali Acc: 0.911 Test Loss: 0.377 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4313013553619385
Epoch: 70, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.5108115673065186
Epoch: 71, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5673608779907227
Epoch: 72, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.4778470993041992
Epoch: 73, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 74 cost time: 0.5013425350189209
Epoch: 74, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.5534195899963379
Epoch: 75, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.4351038932800293
Epoch: 76, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.313 Vali Acc: 0.919 Test Loss: 0.313 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 77 cost time: 0.5106499195098877
Epoch: 77, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 78 cost time: 0.4394989013671875
Epoch: 78, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.301 Vali Acc: 0.915 Test Loss: 0.301 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.5050027370452881
Epoch: 79, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5245592594146729
Epoch: 80, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.4347865581512451
Epoch: 81, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.4494662284851074
Epoch: 82, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.286 Vali Acc: 0.907 Test Loss: 0.286 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5121021270751953
Epoch: 83, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.47322535514831543
Epoch: 84, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6749668121337891
Epoch: 85, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.279 Vali Acc: 0.907 Test Loss: 0.279 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.5147933959960938
Epoch: 86, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.521946907043457
Epoch: 87, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 14516
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.838228702545166
Epoch: 1, Steps: 2 | Train Loss: 2.057 Vali Loss: 2.015 Vali Acc: 0.085 Test Loss: 2.015 Test Acc: 0.085
Validation loss decreased (inf --> -0.085165).  Saving model ...
Epoch: 2 cost time: 0.5559747219085693
Epoch: 2, Steps: 2 | Train Loss: 2.035 Vali Loss: 1.992 Vali Acc: 0.089 Test Loss: 1.992 Test Acc: 0.089
Validation loss decreased (-0.085165 --> -0.088869).  Saving model ...
Epoch: 3 cost time: 0.4648621082305908
Epoch: 3, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.977 Vali Acc: 0.096 Test Loss: 1.977 Test Acc: 0.096
Validation loss decreased (-0.088869 --> -0.096277).  Saving model ...
Epoch: 4 cost time: 0.47622251510620117
Epoch: 4, Steps: 2 | Train Loss: 1.990 Vali Loss: 1.967 Vali Acc: 0.104 Test Loss: 1.967 Test Acc: 0.104
Validation loss decreased (-0.096277 --> -0.103684).  Saving model ...
Epoch: 5 cost time: 0.49315977096557617
Epoch: 5, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.954 Vali Acc: 0.122 Test Loss: 1.954 Test Acc: 0.122
Validation loss decreased (-0.103684 --> -0.122203).  Saving model ...
Epoch: 6 cost time: 0.4427342414855957
Epoch: 6, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.939 Vali Acc: 0.141 Test Loss: 1.939 Test Acc: 0.141
Validation loss decreased (-0.122203 --> -0.140721).  Saving model ...
Epoch: 7 cost time: 0.5766716003417969
Epoch: 7, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.921 Vali Acc: 0.159 Test Loss: 1.921 Test Acc: 0.159
Validation loss decreased (-0.140721 --> -0.159240).  Saving model ...
Epoch: 8 cost time: 0.4615631103515625
Epoch: 8, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.903 Vali Acc: 0.163 Test Loss: 1.903 Test Acc: 0.163
Validation loss decreased (-0.159240 --> -0.162944).  Saving model ...
Epoch: 9 cost time: 0.5187549591064453
Epoch: 9, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.882 Vali Acc: 0.181 Test Loss: 1.882 Test Acc: 0.181
Validation loss decreased (-0.162944 --> -0.181463).  Saving model ...
Epoch: 10 cost time: 0.4472978115081787
Epoch: 10, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.861 Vali Acc: 0.207 Test Loss: 1.861 Test Acc: 0.207
Validation loss decreased (-0.181463 --> -0.207389).  Saving model ...
Epoch: 11 cost time: 0.6175181865692139
Epoch: 11, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.838 Vali Acc: 0.226 Test Loss: 1.838 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 12 cost time: 0.5802552700042725
Epoch: 12, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.815 Vali Acc: 0.248 Test Loss: 1.815 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248130).  Saving model ...
Epoch: 13 cost time: 0.46987104415893555
Epoch: 13, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.790 Vali Acc: 0.267 Test Loss: 1.790 Test Acc: 0.267
Validation loss decreased (-0.248130 --> -0.266649).  Saving model ...
Epoch: 14 cost time: 0.4795866012573242
Epoch: 14, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.765 Vali Acc: 0.304 Test Loss: 1.765 Test Acc: 0.304
Validation loss decreased (-0.266649 --> -0.303686).  Saving model ...
Epoch: 15 cost time: 0.5948917865753174
Epoch: 15, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.740 Vali Acc: 0.315 Test Loss: 1.740 Test Acc: 0.315
Validation loss decreased (-0.303686 --> -0.314797).  Saving model ...
Epoch: 16 cost time: 0.5132513046264648
Epoch: 16, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.713 Vali Acc: 0.322 Test Loss: 1.713 Test Acc: 0.322
Validation loss decreased (-0.314797 --> -0.322205).  Saving model ...
Epoch: 17 cost time: 0.530472993850708
Epoch: 17, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.687 Vali Acc: 0.344 Test Loss: 1.687 Test Acc: 0.344
Validation loss decreased (-0.322205 --> -0.344428).  Saving model ...
Epoch: 18 cost time: 0.49762821197509766
Epoch: 18, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.660 Vali Acc: 0.367 Test Loss: 1.660 Test Acc: 0.367
Validation loss decreased (-0.344428 --> -0.366650).  Saving model ...
Epoch: 19 cost time: 0.4361133575439453
Epoch: 19, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.633 Vali Acc: 0.393 Test Loss: 1.633 Test Acc: 0.393
Validation loss decreased (-0.366650 --> -0.392576).  Saving model ...
Epoch: 20 cost time: 0.43055295944213867
Epoch: 20, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.605 Vali Acc: 0.400 Test Loss: 1.605 Test Acc: 0.400
Validation loss decreased (-0.392576 --> -0.399984).  Saving model ...
Epoch: 21 cost time: 0.47789621353149414
Epoch: 21, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.577 Vali Acc: 0.422 Test Loss: 1.577 Test Acc: 0.422
Validation loss decreased (-0.399984 --> -0.422206).  Saving model ...
Epoch: 22 cost time: 0.4965090751647949
Epoch: 22, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.549 Vali Acc: 0.452 Test Loss: 1.549 Test Acc: 0.452
Validation loss decreased (-0.422206 --> -0.451836).  Saving model ...
Epoch: 23 cost time: 0.45122742652893066
Epoch: 23, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.521 Vali Acc: 0.474 Test Loss: 1.521 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474059).  Saving model ...
Epoch: 24 cost time: 0.4768540859222412
Epoch: 24, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.493 Vali Acc: 0.489 Test Loss: 1.493 Test Acc: 0.489
Validation loss decreased (-0.474059 --> -0.488874).  Saving model ...
Epoch: 25 cost time: 0.4720427989959717
Epoch: 25, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.464 Vali Acc: 0.519 Test Loss: 1.464 Test Acc: 0.519
Validation loss decreased (-0.488874 --> -0.518504).  Saving model ...
Epoch: 26 cost time: 0.524090051651001
Epoch: 26, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.436 Vali Acc: 0.533 Test Loss: 1.436 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 27 cost time: 0.475494384765625
Epoch: 27, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.407 Vali Acc: 0.570 Test Loss: 1.407 Test Acc: 0.570
Validation loss decreased (-0.533319 --> -0.570356).  Saving model ...
Epoch: 28 cost time: 0.526207447052002
Epoch: 28, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.379 Vali Acc: 0.604 Test Loss: 1.379 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603690).  Saving model ...
Epoch: 29 cost time: 0.48355770111083984
Epoch: 29, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.350 Vali Acc: 0.622 Test Loss: 1.350 Test Acc: 0.622
Validation loss decreased (-0.603690 --> -0.622209).  Saving model ...
Epoch: 30 cost time: 0.5014870166778564
Epoch: 30, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.321 Vali Acc: 0.644 Test Loss: 1.321 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644431).  Saving model ...
Epoch: 31 cost time: 0.5561380386352539
Epoch: 31, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.293 Vali Acc: 0.670 Test Loss: 1.293 Test Acc: 0.670
Validation loss decreased (-0.644431 --> -0.670357).  Saving model ...
Epoch: 32 cost time: 0.5318279266357422
Epoch: 32, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.264 Vali Acc: 0.704 Test Loss: 1.264 Test Acc: 0.704
Validation loss decreased (-0.670357 --> -0.703691).  Saving model ...
Epoch: 33 cost time: 0.504260778427124
Epoch: 33, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.236 Vali Acc: 0.733 Test Loss: 1.236 Test Acc: 0.733
Validation loss decreased (-0.703691 --> -0.733321).  Saving model ...
Epoch: 34 cost time: 0.5047526359558105
Epoch: 34, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.208 Vali Acc: 0.748 Test Loss: 1.208 Test Acc: 0.748
Validation loss decreased (-0.733321 --> -0.748136).  Saving model ...
Epoch: 35 cost time: 0.4355442523956299
Epoch: 35, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.179 Vali Acc: 0.770 Test Loss: 1.179 Test Acc: 0.770
Validation loss decreased (-0.748136 --> -0.770359).  Saving model ...
Epoch: 36 cost time: 0.6459217071533203
Epoch: 36, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.151 Vali Acc: 0.778 Test Loss: 1.151 Test Acc: 0.778
Validation loss decreased (-0.770359 --> -0.777766).  Saving model ...
Epoch: 37 cost time: 0.6363198757171631
Epoch: 37, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.124 Vali Acc: 0.793 Test Loss: 1.124 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792581).  Saving model ...
Epoch: 38 cost time: 0.49663329124450684
Epoch: 38, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.096 Vali Acc: 0.822 Test Loss: 1.096 Test Acc: 0.822
Validation loss decreased (-0.792581 --> -0.822211).  Saving model ...
Epoch: 39 cost time: 0.565687894821167
Epoch: 39, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.068 Vali Acc: 0.841 Test Loss: 1.068 Test Acc: 0.841
Validation loss decreased (-0.822211 --> -0.840730).  Saving model ...
Epoch: 40 cost time: 0.5994555950164795
Epoch: 40, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.041 Vali Acc: 0.848 Test Loss: 1.041 Test Acc: 0.848
Validation loss decreased (-0.840730 --> -0.848138).  Saving model ...
Epoch: 41 cost time: 0.4680638313293457
Epoch: 41, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.015 Vali Acc: 0.852 Test Loss: 1.015 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 42 cost time: 0.5052776336669922
Epoch: 42, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.988 Vali Acc: 0.863 Test Loss: 0.988 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 43 cost time: 0.6050269603729248
Epoch: 43, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.963 Vali Acc: 0.867 Test Loss: 0.963 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 44 cost time: 0.4997992515563965
Epoch: 44, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.937 Vali Acc: 0.874 Test Loss: 0.937 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 45 cost time: 0.5386431217193604
Epoch: 45, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.912 Vali Acc: 0.874 Test Loss: 0.912 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874065).  Saving model ...
Epoch: 46 cost time: 0.5255122184753418
Epoch: 46, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.888 Vali Acc: 0.885 Test Loss: 0.888 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885176).  Saving model ...
Epoch: 47 cost time: 0.556206464767456
Epoch: 47, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.864 Vali Acc: 0.889 Test Loss: 0.864 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 48 cost time: 0.4844334125518799
Epoch: 48, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.841 Vali Acc: 0.889 Test Loss: 0.841 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 49 cost time: 0.39867544174194336
Epoch: 49, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.818 Vali Acc: 0.893 Test Loss: 0.818 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 50 cost time: 0.4872562885284424
Epoch: 50, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.796 Vali Acc: 0.900 Test Loss: 0.796 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 51 cost time: 0.4699363708496094
Epoch: 51, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.775 Vali Acc: 0.904 Test Loss: 0.775 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 52 cost time: 0.4050865173339844
Epoch: 52, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.754 Vali Acc: 0.907 Test Loss: 0.754 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 53 cost time: 0.5255270004272461
Epoch: 53, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.734 Vali Acc: 0.907 Test Loss: 0.734 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 54 cost time: 0.43308234214782715
Epoch: 54, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.714 Vali Acc: 0.911 Test Loss: 0.714 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 55 cost time: 0.49510908126831055
Epoch: 55, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.695 Vali Acc: 0.911 Test Loss: 0.695 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 56 cost time: 0.547513484954834
Epoch: 56, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.676 Vali Acc: 0.911 Test Loss: 0.676 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 57 cost time: 0.5470566749572754
Epoch: 57, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.658 Vali Acc: 0.911 Test Loss: 0.658 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 58 cost time: 0.4832000732421875
Epoch: 58, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.641 Vali Acc: 0.915 Test Loss: 0.641 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914808).  Saving model ...
Epoch: 59 cost time: 0.4773271083831787
Epoch: 59, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.624 Vali Acc: 0.915 Test Loss: 0.624 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 60 cost time: 0.4432985782623291
Epoch: 60, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.608 Vali Acc: 0.915 Test Loss: 0.608 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 61 cost time: 0.49877429008483887
Epoch: 61, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.592 Vali Acc: 0.919 Test Loss: 0.592 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 62 cost time: 0.443467378616333
Epoch: 62, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.577 Vali Acc: 0.919 Test Loss: 0.577 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 63 cost time: 0.40778493881225586
Epoch: 63, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 64 cost time: 0.4334297180175781
Epoch: 64, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.548 Vali Acc: 0.926 Test Loss: 0.548 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925920).  Saving model ...
Epoch: 65 cost time: 0.4602210521697998
Epoch: 65, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.534 Vali Acc: 0.930 Test Loss: 0.534 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 66 cost time: 0.5051641464233398
Epoch: 66, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.521 Vali Acc: 0.930 Test Loss: 0.521 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 67 cost time: 0.4761223793029785
Epoch: 67, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.508 Vali Acc: 0.930 Test Loss: 0.508 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.4262707233428955
Epoch: 68, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.496 Vali Acc: 0.930 Test Loss: 0.496 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.47613525390625
Epoch: 69, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.484 Vali Acc: 0.930 Test Loss: 0.484 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 70 cost time: 0.5102601051330566
Epoch: 70, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 71 cost time: 0.4813690185546875
Epoch: 71, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.5652754306793213
Epoch: 72, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.4236879348754883
Epoch: 73, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.441 Vali Acc: 0.926 Test Loss: 0.441 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.543297529220581
Epoch: 74, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.430 Vali Acc: 0.930 Test Loss: 0.430 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 75 cost time: 0.5582690238952637
Epoch: 75, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.421 Vali Acc: 0.933 Test Loss: 0.421 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 76 cost time: 0.5125863552093506
Epoch: 76, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.411 Vali Acc: 0.937 Test Loss: 0.411 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 77 cost time: 0.5225505828857422
Epoch: 77, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 78 cost time: 0.4528954029083252
Epoch: 78, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 79 cost time: 0.4133415222167969
Epoch: 79, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.385 Vali Acc: 0.937 Test Loss: 0.385 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 80 cost time: 0.5389397144317627
Epoch: 80, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 81 cost time: 0.5247883796691895
Epoch: 81, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 82 cost time: 0.52144455909729
Epoch: 82, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.362 Vali Acc: 0.937 Test Loss: 0.362 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 83 cost time: 0.5218548774719238
Epoch: 83, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 84 cost time: 0.47887563705444336
Epoch: 84, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 85 cost time: 0.5091323852539062
Epoch: 85, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 86 cost time: 0.5103654861450195
Epoch: 86, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.4216043949127197
Epoch: 87, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.933 Test Loss: 0.328 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.3890872001647949
Epoch: 88, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.4445486068725586
Epoch: 89, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.37721991539001465
Epoch: 90, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 91 cost time: 0.5173828601837158
Epoch: 91, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 92 cost time: 0.4399688243865967
Epoch: 92, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944441).  Saving model ...
Epoch: 93 cost time: 0.48038530349731445
Epoch: 93, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 94 cost time: 0.4985337257385254
Epoch: 94, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 0.4806087017059326
Epoch: 95, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 0.4443628787994385
Epoch: 96, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.535820722579956
Epoch: 97, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.5442101955413818
Epoch: 98, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.6179871559143066
Epoch: 99, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.4482738971710205
Epoch: 100, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 14364
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.583052396774292
Epoch: 1, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.686 Vali Acc: 0.337 Test Loss: 1.686 Test Acc: 0.337
Validation loss decreased (inf --> -0.337020).  Saving model ...
Epoch: 2 cost time: 0.4636685848236084
Epoch: 2, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.667 Vali Acc: 0.344 Test Loss: 1.667 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.5375044345855713
Epoch: 3, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.655 Vali Acc: 0.352 Test Loss: 1.655 Test Acc: 0.352
Validation loss decreased (-0.344428 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.40085911750793457
Epoch: 4, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.646 Vali Acc: 0.352 Test Loss: 1.646 Test Acc: 0.352
Validation loss decreased (-0.351835 --> -0.351835).  Saving model ...
Epoch: 5 cost time: 0.4975435733795166
Epoch: 5, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.635 Vali Acc: 0.363 Test Loss: 1.635 Test Acc: 0.363
Validation loss decreased (-0.351835 --> -0.362947).  Saving model ...
Epoch: 6 cost time: 0.4226498603820801
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.622 Vali Acc: 0.378 Test Loss: 1.622 Test Acc: 0.378
Validation loss decreased (-0.362947 --> -0.377762).  Saving model ...
Epoch: 7 cost time: 0.40503954887390137
Epoch: 7, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.607 Vali Acc: 0.396 Test Loss: 1.607 Test Acc: 0.396
Validation loss decreased (-0.377762 --> -0.396280).  Saving model ...
Epoch: 8 cost time: 0.456939697265625
Epoch: 8, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.590 Vali Acc: 0.411 Test Loss: 1.590 Test Acc: 0.411
Validation loss decreased (-0.396280 --> -0.411095).  Saving model ...
Epoch: 9 cost time: 0.44326090812683105
Epoch: 9, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.573 Vali Acc: 0.430 Test Loss: 1.573 Test Acc: 0.430
Validation loss decreased (-0.411095 --> -0.429614).  Saving model ...
Epoch: 10 cost time: 0.466458797454834
Epoch: 10, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.554 Vali Acc: 0.452 Test Loss: 1.554 Test Acc: 0.452
Validation loss decreased (-0.429614 --> -0.451836).  Saving model ...
Epoch: 11 cost time: 0.4162406921386719
Epoch: 11, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.534 Vali Acc: 0.489 Test Loss: 1.534 Test Acc: 0.489
Validation loss decreased (-0.451836 --> -0.488874).  Saving model ...
Epoch: 12 cost time: 0.4180943965911865
Epoch: 12, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.513 Vali Acc: 0.507 Test Loss: 1.513 Test Acc: 0.507
Validation loss decreased (-0.488874 --> -0.507392).  Saving model ...
Epoch: 13 cost time: 0.5177500247955322
Epoch: 13, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.492 Vali Acc: 0.530 Test Loss: 1.492 Test Acc: 0.530
Validation loss decreased (-0.507392 --> -0.529615).  Saving model ...
Epoch: 14 cost time: 0.480863094329834
Epoch: 14, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.470 Vali Acc: 0.552 Test Loss: 1.470 Test Acc: 0.552
Validation loss decreased (-0.529615 --> -0.551837).  Saving model ...
Epoch: 15 cost time: 0.4526801109313965
Epoch: 15, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.447 Vali Acc: 0.581 Test Loss: 1.447 Test Acc: 0.581
Validation loss decreased (-0.551837 --> -0.581467).  Saving model ...
Epoch: 16 cost time: 0.5566973686218262
Epoch: 16, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.424 Vali Acc: 0.615 Test Loss: 1.424 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 17 cost time: 0.49527502059936523
Epoch: 17, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.400 Vali Acc: 0.656 Test Loss: 1.400 Test Acc: 0.656
Validation loss decreased (-0.614801 --> -0.655542).  Saving model ...
Epoch: 18 cost time: 0.6329498291015625
Epoch: 18, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.376 Vali Acc: 0.674 Test Loss: 1.376 Test Acc: 0.674
Validation loss decreased (-0.655542 --> -0.674060).  Saving model ...
Epoch: 19 cost time: 0.3773472309112549
Epoch: 19, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.351 Vali Acc: 0.696 Test Loss: 1.351 Test Acc: 0.696
Validation loss decreased (-0.674060 --> -0.696283).  Saving model ...
Epoch: 20 cost time: 0.4045248031616211
Epoch: 20, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.326 Vali Acc: 0.711 Test Loss: 1.326 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711098).  Saving model ...
Epoch: 21 cost time: 0.4456367492675781
Epoch: 21, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.301 Vali Acc: 0.737 Test Loss: 1.301 Test Acc: 0.737
Validation loss decreased (-0.711098 --> -0.737024).  Saving model ...
Epoch: 22 cost time: 0.43686866760253906
Epoch: 22, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.276 Vali Acc: 0.756 Test Loss: 1.276 Test Acc: 0.756
Validation loss decreased (-0.737024 --> -0.755543).  Saving model ...
Epoch: 23 cost time: 0.46324753761291504
Epoch: 23, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.250 Vali Acc: 0.767 Test Loss: 1.250 Test Acc: 0.767
Validation loss decreased (-0.755543 --> -0.766654).  Saving model ...
Epoch: 24 cost time: 0.4303905963897705
Epoch: 24, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.224 Vali Acc: 0.767 Test Loss: 1.224 Test Acc: 0.767
Validation loss decreased (-0.766654 --> -0.766654).  Saving model ...
Epoch: 25 cost time: 0.41205835342407227
Epoch: 25, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.199 Vali Acc: 0.774 Test Loss: 1.199 Test Acc: 0.774
Validation loss decreased (-0.766654 --> -0.774062).  Saving model ...
Epoch: 26 cost time: 0.3539571762084961
Epoch: 26, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.173 Vali Acc: 0.778 Test Loss: 1.173 Test Acc: 0.778
Validation loss decreased (-0.774062 --> -0.777766).  Saving model ...
Epoch: 27 cost time: 0.5586674213409424
Epoch: 27, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.147 Vali Acc: 0.781 Test Loss: 1.147 Test Acc: 0.781
Validation loss decreased (-0.777766 --> -0.781470).  Saving model ...
Epoch: 28 cost time: 0.41574549674987793
Epoch: 28, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.122 Vali Acc: 0.781 Test Loss: 1.122 Test Acc: 0.781
Validation loss decreased (-0.781470 --> -0.781470).  Saving model ...
Epoch: 29 cost time: 0.48155713081359863
Epoch: 29, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.096 Vali Acc: 0.785 Test Loss: 1.096 Test Acc: 0.785
Validation loss decreased (-0.781470 --> -0.785174).  Saving model ...
Epoch: 30 cost time: 0.4121663570404053
Epoch: 30, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.071 Vali Acc: 0.804 Test Loss: 1.071 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803693).  Saving model ...
Epoch: 31 cost time: 0.3858366012573242
Epoch: 31, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.046 Vali Acc: 0.815 Test Loss: 1.046 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814804).  Saving model ...
Epoch: 32 cost time: 0.3794894218444824
Epoch: 32, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.021 Vali Acc: 0.826 Test Loss: 1.021 Test Acc: 0.826
Validation loss decreased (-0.814804 --> -0.825916).  Saving model ...
Epoch: 33 cost time: 0.5158376693725586
Epoch: 33, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.997 Vali Acc: 0.844 Test Loss: 0.997 Test Acc: 0.844
Validation loss decreased (-0.825916 --> -0.844434).  Saving model ...
Epoch: 34 cost time: 0.465867280960083
Epoch: 34, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.972 Vali Acc: 0.848 Test Loss: 0.972 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848138).  Saving model ...
Epoch: 35 cost time: 0.5389094352722168
Epoch: 35, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.948 Vali Acc: 0.852 Test Loss: 0.948 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 36 cost time: 0.5056374073028564
Epoch: 36, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.925 Vali Acc: 0.859 Test Loss: 0.925 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859250).  Saving model ...
Epoch: 37 cost time: 0.5202059745788574
Epoch: 37, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.902 Vali Acc: 0.848 Test Loss: 0.902 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.48373937606811523
Epoch: 38, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.879 Vali Acc: 0.856 Test Loss: 0.879 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5347435474395752
Epoch: 39, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.857 Vali Acc: 0.863 Test Loss: 0.857 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862954).  Saving model ...
Epoch: 40 cost time: 0.5054178237915039
Epoch: 40, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.835 Vali Acc: 0.863 Test Loss: 0.835 Test Acc: 0.863
Validation loss decreased (-0.862954 --> -0.862955).  Saving model ...
Epoch: 41 cost time: 0.4929356575012207
Epoch: 41, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.813 Vali Acc: 0.867 Test Loss: 0.813 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 42 cost time: 0.44511890411376953
Epoch: 42, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.792 Vali Acc: 0.867 Test Loss: 0.792 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 43 cost time: 0.4881434440612793
Epoch: 43, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.772 Vali Acc: 0.863 Test Loss: 0.772 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.45641231536865234
Epoch: 44, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.752 Vali Acc: 0.874 Test Loss: 0.752 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 45 cost time: 0.45128703117370605
Epoch: 45, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.733 Vali Acc: 0.874 Test Loss: 0.733 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 46 cost time: 0.4107191562652588
Epoch: 46, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.714 Vali Acc: 0.874 Test Loss: 0.714 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 47 cost time: 0.5547745227813721
Epoch: 47, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.695 Vali Acc: 0.878 Test Loss: 0.695 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 48 cost time: 0.4014301300048828
Epoch: 48, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.677 Vali Acc: 0.881 Test Loss: 0.677 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 49 cost time: 0.42781925201416016
Epoch: 49, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.660 Vali Acc: 0.878 Test Loss: 0.660 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4626893997192383
Epoch: 50, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.643 Vali Acc: 0.881 Test Loss: 0.643 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 51 cost time: 0.5601565837860107
Epoch: 51, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.626 Vali Acc: 0.881 Test Loss: 0.626 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 52 cost time: 0.5228650569915771
Epoch: 52, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.610 Vali Acc: 0.881 Test Loss: 0.610 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 53 cost time: 0.42709898948669434
Epoch: 53, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.594 Vali Acc: 0.881 Test Loss: 0.594 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 54 cost time: 0.5165297985076904
Epoch: 54, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.579 Vali Acc: 0.885 Test Loss: 0.579 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885179).  Saving model ...
Epoch: 55 cost time: 0.49277353286743164
Epoch: 55, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.564 Vali Acc: 0.889 Test Loss: 0.564 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 56 cost time: 0.4869241714477539
Epoch: 56, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.549 Vali Acc: 0.893 Test Loss: 0.549 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 57 cost time: 0.4910140037536621
Epoch: 57, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.535 Vali Acc: 0.893 Test Loss: 0.535 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 58 cost time: 0.4719820022583008
Epoch: 58, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.522 Vali Acc: 0.896 Test Loss: 0.522 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 59 cost time: 0.4584941864013672
Epoch: 59, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.509 Vali Acc: 0.896 Test Loss: 0.509 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 60 cost time: 0.5160365104675293
Epoch: 60, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.496 Vali Acc: 0.900 Test Loss: 0.496 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 61 cost time: 0.42020368576049805
Epoch: 61, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.484 Vali Acc: 0.896 Test Loss: 0.484 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.3767669200897217
Epoch: 62, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.472 Vali Acc: 0.896 Test Loss: 0.472 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.4109156131744385
Epoch: 63, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.461 Vali Acc: 0.896 Test Loss: 0.461 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.48293256759643555
Epoch: 64, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.450 Vali Acc: 0.900 Test Loss: 0.450 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 65 cost time: 0.5202000141143799
Epoch: 65, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.531975507736206
Epoch: 66, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.430 Vali Acc: 0.896 Test Loss: 0.430 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.4742245674133301
Epoch: 67, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.421 Vali Acc: 0.896 Test Loss: 0.421 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.4968585968017578
Epoch: 68, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.413 Vali Acc: 0.896 Test Loss: 0.413 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.4506187438964844
Epoch: 69, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.405 Vali Acc: 0.896 Test Loss: 0.405 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.4631669521331787
Epoch: 70, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.397 Vali Acc: 0.896 Test Loss: 0.397 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.4569535255432129
Epoch: 71, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.48414015769958496
Epoch: 72, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.383 Vali Acc: 0.896 Test Loss: 0.383 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.5093340873718262
Epoch: 73, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.377 Vali Acc: 0.896 Test Loss: 0.377 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.49788951873779297
Epoch: 74, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.372 Vali Acc: 0.896 Test Loss: 0.372 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.4522676467895508
Epoch: 75, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.366 Vali Acc: 0.896 Test Loss: 0.366 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 14086
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6393256187438965
Epoch: 1, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.915 Vali Acc: 0.115 Test Loss: 1.915 Test Acc: 0.115
Validation loss decreased (inf --> -0.114796).  Saving model ...
Epoch: 2 cost time: 0.5457108020782471
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.893 Vali Acc: 0.141 Test Loss: 1.893 Test Acc: 0.141
Validation loss decreased (-0.114796 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.4760727882385254
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.879 Vali Acc: 0.141 Test Loss: 1.879 Test Acc: 0.141
Validation loss decreased (-0.140722 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 0.4330017566680908
Epoch: 4, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.869 Vali Acc: 0.141 Test Loss: 1.869 Test Acc: 0.141
Validation loss decreased (-0.140722 --> -0.140722).  Saving model ...
Epoch: 5 cost time: 0.41986775398254395
Epoch: 5, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.857 Vali Acc: 0.144 Test Loss: 1.857 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 6 cost time: 0.48715806007385254
Epoch: 6, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.843 Vali Acc: 0.159 Test Loss: 1.843 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 7 cost time: 0.47162461280822754
Epoch: 7, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.826 Vali Acc: 0.167 Test Loss: 1.826 Test Acc: 0.167
Validation loss decreased (-0.159241 --> -0.166648).  Saving model ...
Epoch: 8 cost time: 0.5077672004699707
Epoch: 8, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.808 Vali Acc: 0.181 Test Loss: 1.808 Test Acc: 0.181
Validation loss decreased (-0.166648 --> -0.181463).  Saving model ...
Epoch: 9 cost time: 0.5413410663604736
Epoch: 9, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.789 Vali Acc: 0.189 Test Loss: 1.789 Test Acc: 0.189
Validation loss decreased (-0.181463 --> -0.188871).  Saving model ...
Epoch: 10 cost time: 0.5436384677886963
Epoch: 10, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.768 Vali Acc: 0.204 Test Loss: 1.768 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 11 cost time: 0.4665496349334717
Epoch: 11, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.746 Vali Acc: 0.207 Test Loss: 1.746 Test Acc: 0.207
Validation loss decreased (-0.203686 --> -0.207390).  Saving model ...
Epoch: 12 cost time: 0.6687698364257812
Epoch: 12, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.723 Vali Acc: 0.230 Test Loss: 1.723 Test Acc: 0.230
Validation loss decreased (-0.207390 --> -0.229612).  Saving model ...
Epoch: 13 cost time: 0.47790026664733887
Epoch: 13, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.699 Vali Acc: 0.241 Test Loss: 1.699 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240724).  Saving model ...
Epoch: 14 cost time: 0.5578129291534424
Epoch: 14, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.674 Vali Acc: 0.267 Test Loss: 1.674 Test Acc: 0.267
Validation loss decreased (-0.240724 --> -0.266650).  Saving model ...
Epoch: 15 cost time: 0.541964054107666
Epoch: 15, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.649 Vali Acc: 0.296 Test Loss: 1.649 Test Acc: 0.296
Validation loss decreased (-0.266650 --> -0.296280).  Saving model ...
Epoch: 16 cost time: 0.433704137802124
Epoch: 16, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.622 Vali Acc: 0.326 Test Loss: 1.622 Test Acc: 0.326
Validation loss decreased (-0.296280 --> -0.325910).  Saving model ...
Epoch: 17 cost time: 0.6151161193847656
Epoch: 17, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.596 Vali Acc: 0.389 Test Loss: 1.596 Test Acc: 0.389
Validation loss decreased (-0.325910 --> -0.388873).  Saving model ...
Epoch: 18 cost time: 0.46134018898010254
Epoch: 18, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.568 Vali Acc: 0.481 Test Loss: 1.568 Test Acc: 0.481
Validation loss decreased (-0.388873 --> -0.481466).  Saving model ...
Epoch: 19 cost time: 0.4467318058013916
Epoch: 19, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.540 Vali Acc: 0.515 Test Loss: 1.540 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514799).  Saving model ...
Epoch: 20 cost time: 0.5364291667938232
Epoch: 20, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.512 Vali Acc: 0.544 Test Loss: 1.512 Test Acc: 0.544
Validation loss decreased (-0.514799 --> -0.544429).  Saving model ...
Epoch: 21 cost time: 0.5200684070587158
Epoch: 21, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.483 Vali Acc: 0.570 Test Loss: 1.483 Test Acc: 0.570
Validation loss decreased (-0.544429 --> -0.570356).  Saving model ...
Epoch: 22 cost time: 0.548452615737915
Epoch: 22, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.454 Vali Acc: 0.596 Test Loss: 1.454 Test Acc: 0.596
Validation loss decreased (-0.570356 --> -0.596282).  Saving model ...
Epoch: 23 cost time: 0.5463924407958984
Epoch: 23, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.425 Vali Acc: 0.611 Test Loss: 1.425 Test Acc: 0.611
Validation loss decreased (-0.596282 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.5004637241363525
Epoch: 24, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.396 Vali Acc: 0.641 Test Loss: 1.396 Test Acc: 0.641
Validation loss decreased (-0.611097 --> -0.640727).  Saving model ...
Epoch: 25 cost time: 0.49019789695739746
Epoch: 25, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.366 Vali Acc: 0.644 Test Loss: 1.366 Test Acc: 0.644
Validation loss decreased (-0.640727 --> -0.644431).  Saving model ...
Epoch: 26 cost time: 0.5122616291046143
Epoch: 26, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.336 Vali Acc: 0.663 Test Loss: 1.336 Test Acc: 0.663
Validation loss decreased (-0.644431 --> -0.662950).  Saving model ...
Epoch: 27 cost time: 0.5469470024108887
Epoch: 27, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.307 Vali Acc: 0.667 Test Loss: 1.307 Test Acc: 0.667
Validation loss decreased (-0.662950 --> -0.666654).  Saving model ...
Epoch: 28 cost time: 0.5306453704833984
Epoch: 28, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.277 Vali Acc: 0.678 Test Loss: 1.277 Test Acc: 0.678
Validation loss decreased (-0.666654 --> -0.677765).  Saving model ...
Epoch: 29 cost time: 0.49901914596557617
Epoch: 29, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.248 Vali Acc: 0.700 Test Loss: 1.248 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 30 cost time: 0.5749502182006836
Epoch: 30, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.218 Vali Acc: 0.711 Test Loss: 1.218 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 31 cost time: 0.4882211685180664
Epoch: 31, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.189 Vali Acc: 0.722 Test Loss: 1.189 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722210).  Saving model ...
Epoch: 32 cost time: 0.6570453643798828
Epoch: 32, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.160 Vali Acc: 0.733 Test Loss: 1.160 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733322).  Saving model ...
Epoch: 33 cost time: 0.5569682121276855
Epoch: 33, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.132 Vali Acc: 0.744 Test Loss: 1.132 Test Acc: 0.744
Validation loss decreased (-0.733322 --> -0.744433).  Saving model ...
Epoch: 34 cost time: 0.62009596824646
Epoch: 34, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.103 Vali Acc: 0.748 Test Loss: 1.103 Test Acc: 0.748
Validation loss decreased (-0.744433 --> -0.748137).  Saving model ...
Epoch: 35 cost time: 0.6129815578460693
Epoch: 35, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.075 Vali Acc: 0.763 Test Loss: 1.075 Test Acc: 0.763
Validation loss decreased (-0.748137 --> -0.762952).  Saving model ...
Epoch: 36 cost time: 0.5697643756866455
Epoch: 36, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.048 Vali Acc: 0.774 Test Loss: 1.048 Test Acc: 0.774
Validation loss decreased (-0.762952 --> -0.774064).  Saving model ...
Epoch: 37 cost time: 0.5877254009246826
Epoch: 37, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.021 Vali Acc: 0.778 Test Loss: 1.021 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 38 cost time: 0.5296785831451416
Epoch: 38, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.994 Vali Acc: 0.789 Test Loss: 0.994 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788879).  Saving model ...
Epoch: 39 cost time: 0.547156810760498
Epoch: 39, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.968 Vali Acc: 0.789 Test Loss: 0.968 Test Acc: 0.789
Validation loss decreased (-0.788879 --> -0.788879).  Saving model ...
Epoch: 40 cost time: 0.6409056186676025
Epoch: 40, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.942 Vali Acc: 0.793 Test Loss: 0.942 Test Acc: 0.793
Validation loss decreased (-0.788879 --> -0.792583).  Saving model ...
Epoch: 41 cost time: 0.6281330585479736
Epoch: 41, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.917 Vali Acc: 0.804 Test Loss: 0.917 Test Acc: 0.804
Validation loss decreased (-0.792583 --> -0.803695).  Saving model ...
Epoch: 42 cost time: 0.5750093460083008
Epoch: 42, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.893 Vali Acc: 0.811 Test Loss: 0.893 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811102).  Saving model ...
Epoch: 43 cost time: 0.618638277053833
Epoch: 43, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.869 Vali Acc: 0.819 Test Loss: 0.869 Test Acc: 0.819
Validation loss decreased (-0.811102 --> -0.818510).  Saving model ...
Epoch: 44 cost time: 0.6165323257446289
Epoch: 44, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.845 Vali Acc: 0.826 Test Loss: 0.845 Test Acc: 0.826
Validation loss decreased (-0.818510 --> -0.825917).  Saving model ...
Epoch: 45 cost time: 0.6512899398803711
Epoch: 45, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.823 Vali Acc: 0.830 Test Loss: 0.823 Test Acc: 0.830
Validation loss decreased (-0.825917 --> -0.829621).  Saving model ...
Epoch: 46 cost time: 0.5268239974975586
Epoch: 46, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.801 Vali Acc: 0.833 Test Loss: 0.801 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 47 cost time: 0.522902250289917
Epoch: 47, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.780 Vali Acc: 0.833 Test Loss: 0.780 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 48 cost time: 0.6265947818756104
Epoch: 48, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.759 Vali Acc: 0.841 Test Loss: 0.759 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840733).  Saving model ...
Epoch: 49 cost time: 0.6383373737335205
Epoch: 49, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.739 Vali Acc: 0.841 Test Loss: 0.739 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840733).  Saving model ...
Epoch: 50 cost time: 0.6457417011260986
Epoch: 50, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.719 Vali Acc: 0.844 Test Loss: 0.719 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 51 cost time: 0.5855057239532471
Epoch: 51, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.701 Vali Acc: 0.844 Test Loss: 0.701 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 52 cost time: 0.5894432067871094
Epoch: 52, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.683 Vali Acc: 0.848 Test Loss: 0.683 Test Acc: 0.848
Validation loss decreased (-0.844437 --> -0.848141).  Saving model ...
Epoch: 53 cost time: 0.6223852634429932
Epoch: 53, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.665 Vali Acc: 0.848 Test Loss: 0.665 Test Acc: 0.848
Validation loss decreased (-0.848141 --> -0.848141).  Saving model ...
Epoch: 54 cost time: 0.6128542423248291
Epoch: 54, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.648 Vali Acc: 0.859 Test Loss: 0.648 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859253).  Saving model ...
Epoch: 55 cost time: 0.5966193675994873
Epoch: 55, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.632 Vali Acc: 0.867 Test Loss: 0.632 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866660).  Saving model ...
Epoch: 56 cost time: 0.598628044128418
Epoch: 56, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.616 Vali Acc: 0.881 Test Loss: 0.616 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881475).  Saving model ...
Epoch: 57 cost time: 0.5591409206390381
Epoch: 57, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.600 Vali Acc: 0.881 Test Loss: 0.600 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 58 cost time: 0.5652496814727783
Epoch: 58, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.585 Vali Acc: 0.881 Test Loss: 0.585 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 59 cost time: 0.5082192420959473
Epoch: 59, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.571 Vali Acc: 0.885 Test Loss: 0.571 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885179).  Saving model ...
Epoch: 60 cost time: 0.5398504734039307
Epoch: 60, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.557 Vali Acc: 0.889 Test Loss: 0.557 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 61 cost time: 0.5359094142913818
Epoch: 61, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 62 cost time: 0.6663553714752197
Epoch: 62, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.530 Vali Acc: 0.889 Test Loss: 0.530 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 0.621267557144165
Epoch: 63, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.517 Vali Acc: 0.893 Test Loss: 0.517 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892587).  Saving model ...
Epoch: 64 cost time: 0.6336932182312012
Epoch: 64, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.505 Vali Acc: 0.893 Test Loss: 0.505 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 65 cost time: 0.733163595199585
Epoch: 65, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.493 Vali Acc: 0.893 Test Loss: 0.493 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 66 cost time: 0.5299725532531738
Epoch: 66, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.481 Vali Acc: 0.900 Test Loss: 0.481 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899995).  Saving model ...
Epoch: 67 cost time: 0.5769221782684326
Epoch: 67, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.470 Vali Acc: 0.900 Test Loss: 0.470 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 68 cost time: 0.5318758487701416
Epoch: 68, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 69 cost time: 0.7117717266082764
Epoch: 69, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.449 Vali Acc: 0.911 Test Loss: 0.449 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 70 cost time: 0.6525094509124756
Epoch: 70, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 71 cost time: 0.671328067779541
Epoch: 71, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 72 cost time: 0.5424110889434814
Epoch: 72, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.419 Vali Acc: 0.919 Test Loss: 0.419 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 73 cost time: 0.5246269702911377
Epoch: 73, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 74 cost time: 0.5418031215667725
Epoch: 74, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.5965876579284668
Epoch: 75, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.4632565975189209
Epoch: 76, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 77 cost time: 0.565805196762085
Epoch: 77, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 78 cost time: 0.56607985496521
Epoch: 78, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 79 cost time: 0.6051204204559326
Epoch: 79, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.5616638660430908
Epoch: 80, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6239361763000488
Epoch: 81, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.5762042999267578
Epoch: 82, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 83 cost time: 0.5949838161468506
Epoch: 83, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 84 cost time: 0.5993530750274658
Epoch: 84, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 85 cost time: 0.6117684841156006
Epoch: 85, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 86 cost time: 0.5935966968536377
Epoch: 86, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 87 cost time: 0.6078479290008545
Epoch: 87, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 88 cost time: 0.6271617412567139
Epoch: 88, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 89 cost time: 0.7037298679351807
Epoch: 89, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 90 cost time: 0.6910009384155273
Epoch: 90, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6255207061767578
Epoch: 91, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.6849219799041748
Epoch: 92, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.6654503345489502
Epoch: 93, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.6976730823516846
Epoch: 94, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.7167999744415283
Epoch: 95, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 96 cost time: 0.6496198177337646
Epoch: 96, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 97 cost time: 0.5521211624145508
Epoch: 97, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 98 cost time: 0.6409626007080078
Epoch: 98, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 99 cost time: 0.6803205013275146
Epoch: 99, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 14061
model size : 0.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.533576488494873
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.739 Vali Acc: 0.300 Test Loss: 1.739 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.38861560821533203
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.723 Vali Acc: 0.311 Test Loss: 1.723 Test Acc: 0.311
Validation loss decreased (-0.299983 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.3431360721588135
Epoch: 3, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.711 Vali Acc: 0.322 Test Loss: 1.711 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.4040107727050781
Epoch: 4, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.703 Vali Acc: 0.330 Test Loss: 1.703 Test Acc: 0.330
Validation loss decreased (-0.322205 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.5242691040039062
Epoch: 5, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.692 Vali Acc: 0.344 Test Loss: 1.692 Test Acc: 0.344
Validation loss decreased (-0.329613 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.6057426929473877
Epoch: 6, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.680 Vali Acc: 0.359 Test Loss: 1.680 Test Acc: 0.359
Validation loss decreased (-0.344428 --> -0.359242).  Saving model ...
Epoch: 7 cost time: 0.342573881149292
Epoch: 7, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.666 Vali Acc: 0.374 Test Loss: 1.666 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 8 cost time: 0.4229001998901367
Epoch: 8, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.650 Vali Acc: 0.385 Test Loss: 1.650 Test Acc: 0.385
Validation loss decreased (-0.374057 --> -0.385169).  Saving model ...
Epoch: 9 cost time: 0.5243375301361084
Epoch: 9, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.633 Vali Acc: 0.400 Test Loss: 1.633 Test Acc: 0.400
Validation loss decreased (-0.385169 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.3634145259857178
Epoch: 10, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.614 Vali Acc: 0.430 Test Loss: 1.614 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429613).  Saving model ...
Epoch: 11 cost time: 0.39124083518981934
Epoch: 11, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.595 Vali Acc: 0.441 Test Loss: 1.595 Test Acc: 0.441
Validation loss decreased (-0.429613 --> -0.440725).  Saving model ...
Epoch: 12 cost time: 0.39367198944091797
Epoch: 12, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.575 Vali Acc: 0.459 Test Loss: 1.575 Test Acc: 0.459
Validation loss decreased (-0.440725 --> -0.459244).  Saving model ...
Epoch: 13 cost time: 0.517798900604248
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.554 Vali Acc: 0.478 Test Loss: 1.554 Test Acc: 0.478
Validation loss decreased (-0.459244 --> -0.477762).  Saving model ...
Epoch: 14 cost time: 0.4921588897705078
Epoch: 14, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.532 Vali Acc: 0.500 Test Loss: 1.532 Test Acc: 0.500
Validation loss decreased (-0.477762 --> -0.499985).  Saving model ...
Epoch: 15 cost time: 0.4360501766204834
Epoch: 15, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.510 Vali Acc: 0.533 Test Loss: 1.510 Test Acc: 0.533
Validation loss decreased (-0.499985 --> -0.533318).  Saving model ...
Epoch: 16 cost time: 0.6284961700439453
Epoch: 16, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.487 Vali Acc: 0.541 Test Loss: 1.487 Test Acc: 0.541
Validation loss decreased (-0.533318 --> -0.540726).  Saving model ...
Epoch: 17 cost time: 0.43347835540771484
Epoch: 17, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.463 Vali Acc: 0.581 Test Loss: 1.463 Test Acc: 0.581
Validation loss decreased (-0.540726 --> -0.581467).  Saving model ...
Epoch: 18 cost time: 0.40189051628112793
Epoch: 18, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.439 Vali Acc: 0.585 Test Loss: 1.439 Test Acc: 0.585
Validation loss decreased (-0.581467 --> -0.585171).  Saving model ...
Epoch: 19 cost time: 0.4748799800872803
Epoch: 19, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.415 Vali Acc: 0.611 Test Loss: 1.415 Test Acc: 0.611
Validation loss decreased (-0.585171 --> -0.611097).  Saving model ...
Epoch: 20 cost time: 0.4939267635345459
Epoch: 20, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.391 Vali Acc: 0.630 Test Loss: 1.391 Test Acc: 0.630
Validation loss decreased (-0.611097 --> -0.629616).  Saving model ...
Epoch: 21 cost time: 0.37732863426208496
Epoch: 21, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.366 Vali Acc: 0.644 Test Loss: 1.366 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 22 cost time: 0.41071486473083496
Epoch: 22, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.341 Vali Acc: 0.644 Test Loss: 1.341 Test Acc: 0.644
Validation loss decreased (-0.644431 --> -0.644431).  Saving model ...
Epoch: 23 cost time: 0.5950615406036377
Epoch: 23, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.316 Vali Acc: 0.659 Test Loss: 1.316 Test Acc: 0.659
Validation loss decreased (-0.644431 --> -0.659246).  Saving model ...
Epoch: 24 cost time: 0.4153115749359131
Epoch: 24, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.291 Vali Acc: 0.670 Test Loss: 1.291 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 25 cost time: 0.47676801681518555
Epoch: 25, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.265 Vali Acc: 0.678 Test Loss: 1.265 Test Acc: 0.678
Validation loss decreased (-0.670357 --> -0.677765).  Saving model ...
Epoch: 26 cost time: 0.4109764099121094
Epoch: 26, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.239 Vali Acc: 0.696 Test Loss: 1.239 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696284).  Saving model ...
Epoch: 27 cost time: 0.39006519317626953
Epoch: 27, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.213 Vali Acc: 0.719 Test Loss: 1.213 Test Acc: 0.719
Validation loss decreased (-0.696284 --> -0.718506).  Saving model ...
Epoch: 28 cost time: 0.4583091735839844
Epoch: 28, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.187 Vali Acc: 0.730 Test Loss: 1.187 Test Acc: 0.730
Validation loss decreased (-0.718506 --> -0.729618).  Saving model ...
Epoch: 29 cost time: 0.5676324367523193
Epoch: 29, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.161 Vali Acc: 0.748 Test Loss: 1.161 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 30 cost time: 0.3885655403137207
Epoch: 30, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.134 Vali Acc: 0.756 Test Loss: 1.134 Test Acc: 0.756
Validation loss decreased (-0.748137 --> -0.755544).  Saving model ...
Epoch: 31 cost time: 0.4840221405029297
Epoch: 31, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.108 Vali Acc: 0.763 Test Loss: 1.108 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 32 cost time: 0.48757505416870117
Epoch: 32, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.082 Vali Acc: 0.778 Test Loss: 1.082 Test Acc: 0.778
Validation loss decreased (-0.762952 --> -0.777767).  Saving model ...
Epoch: 33 cost time: 0.3683452606201172
Epoch: 33, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.055 Vali Acc: 0.793 Test Loss: 1.055 Test Acc: 0.793
Validation loss decreased (-0.777767 --> -0.792582).  Saving model ...
Epoch: 34 cost time: 0.44375085830688477
Epoch: 34, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.029 Vali Acc: 0.804 Test Loss: 1.029 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803693).  Saving model ...
Epoch: 35 cost time: 0.501819372177124
Epoch: 35, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.003 Vali Acc: 0.815 Test Loss: 1.003 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814805).  Saving model ...
Epoch: 36 cost time: 0.4628417491912842
Epoch: 36, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.977 Vali Acc: 0.815 Test Loss: 0.977 Test Acc: 0.815
Validation loss decreased (-0.814805 --> -0.814805).  Saving model ...
Epoch: 37 cost time: 0.5109512805938721
Epoch: 37, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.952 Vali Acc: 0.815 Test Loss: 0.952 Test Acc: 0.815
Validation loss decreased (-0.814805 --> -0.814805).  Saving model ...
Epoch: 38 cost time: 0.640512228012085
Epoch: 38, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.926 Vali Acc: 0.826 Test Loss: 0.926 Test Acc: 0.826
Validation loss decreased (-0.814805 --> -0.825917).  Saving model ...
Epoch: 39 cost time: 0.5446946620941162
Epoch: 39, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.900 Vali Acc: 0.830 Test Loss: 0.900 Test Acc: 0.830
Validation loss decreased (-0.825917 --> -0.829621).  Saving model ...
Epoch: 40 cost time: 0.6385586261749268
Epoch: 40, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.875 Vali Acc: 0.830 Test Loss: 0.875 Test Acc: 0.830
Validation loss decreased (-0.829621 --> -0.829621).  Saving model ...
Epoch: 41 cost time: 0.5352551937103271
Epoch: 41, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.850 Vali Acc: 0.833 Test Loss: 0.850 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 42 cost time: 0.44664931297302246
Epoch: 42, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.826 Vali Acc: 0.833 Test Loss: 0.826 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 43 cost time: 0.5828673839569092
Epoch: 43, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.801 Vali Acc: 0.844 Test Loss: 0.801 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844436).  Saving model ...
Epoch: 44 cost time: 0.4606802463531494
Epoch: 44, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.777 Vali Acc: 0.856 Test Loss: 0.777 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855548).  Saving model ...
Epoch: 45 cost time: 0.4455225467681885
Epoch: 45, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.753 Vali Acc: 0.863 Test Loss: 0.753 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862955).  Saving model ...
Epoch: 46 cost time: 0.5459122657775879
Epoch: 46, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.730 Vali Acc: 0.867 Test Loss: 0.730 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 47 cost time: 0.47821831703186035
Epoch: 47, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.706 Vali Acc: 0.870 Test Loss: 0.706 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 48 cost time: 0.4740769863128662
Epoch: 48, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.684 Vali Acc: 0.874 Test Loss: 0.684 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 49 cost time: 0.449779748916626
Epoch: 49, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.661 Vali Acc: 0.878 Test Loss: 0.661 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 50 cost time: 0.44820213317871094
Epoch: 50, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 51 cost time: 0.4556734561920166
Epoch: 51, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.617 Vali Acc: 0.881 Test Loss: 0.617 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 52 cost time: 0.4816262722015381
Epoch: 52, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.4700734615325928
Epoch: 53, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.576 Vali Acc: 0.881 Test Loss: 0.576 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 54 cost time: 0.44511842727661133
Epoch: 54, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 55 cost time: 0.4383718967437744
Epoch: 55, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.537 Vali Acc: 0.885 Test Loss: 0.537 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 56 cost time: 0.46068525314331055
Epoch: 56, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 57 cost time: 0.4798438549041748
Epoch: 57, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.501 Vali Acc: 0.885 Test Loss: 0.501 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.48698973655700684
Epoch: 58, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.485 Vali Acc: 0.885 Test Loss: 0.485 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.485262393951416
Epoch: 59, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.469 Vali Acc: 0.885 Test Loss: 0.469 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.5584597587585449
Epoch: 60, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.454 Vali Acc: 0.889 Test Loss: 0.454 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 0.5089640617370605
Epoch: 61, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.441 Vali Acc: 0.885 Test Loss: 0.441 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5671777725219727
Epoch: 62, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.428 Vali Acc: 0.881 Test Loss: 0.428 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.5204267501831055
Epoch: 63, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.4794647693634033
Epoch: 64, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.405 Vali Acc: 0.878 Test Loss: 0.405 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.47807884216308594
Epoch: 65, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.395 Vali Acc: 0.878 Test Loss: 0.395 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.46489667892456055
Epoch: 66, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.386 Vali Acc: 0.878 Test Loss: 0.386 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6267390251159668
Epoch: 67, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.45995044708251953
Epoch: 68, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.372 Vali Acc: 0.878 Test Loss: 0.372 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.5493698120117188
Epoch: 69, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.367 Vali Acc: 0.878 Test Loss: 0.367 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.47165870666503906
Epoch: 70, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.363 Vali Acc: 0.881 Test Loss: 0.363 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm128_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8888888888888888
model parameter : 14448
model size : 0.07MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.6699912548065186
Epoch: 1, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.723 Vali Acc: 0.293 Test Loss: 1.723 Test Acc: 0.293
Validation loss decreased (inf --> -0.292575).  Saving model ...
Epoch: 2 cost time: 0.5238559246063232
Epoch: 2, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.708 Vali Acc: 0.307 Test Loss: 1.708 Test Acc: 0.307
Validation loss decreased (-0.292575 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.46765971183776855
Epoch: 3, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.698 Vali Acc: 0.315 Test Loss: 1.698 Test Acc: 0.315
Validation loss decreased (-0.307390 --> -0.314798).  Saving model ...
Epoch: 4 cost time: 0.4828190803527832
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.691 Vali Acc: 0.326 Test Loss: 1.691 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.6490468978881836
Epoch: 5, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.681 Vali Acc: 0.333 Test Loss: 1.681 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333317).  Saving model ...
Epoch: 6 cost time: 0.5784437656402588
Epoch: 6, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.669 Vali Acc: 0.344 Test Loss: 1.669 Test Acc: 0.344
Validation loss decreased (-0.333317 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.4991428852081299
Epoch: 7, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.656 Vali Acc: 0.374 Test Loss: 1.656 Test Acc: 0.374
Validation loss decreased (-0.344428 --> -0.374058).  Saving model ...
Epoch: 8 cost time: 0.45406031608581543
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.641 Vali Acc: 0.411 Test Loss: 1.641 Test Acc: 0.411
Validation loss decreased (-0.374058 --> -0.411095).  Saving model ...
Epoch: 9 cost time: 0.4768989086151123
Epoch: 9, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.625 Vali Acc: 0.437 Test Loss: 1.625 Test Acc: 0.437
Validation loss decreased (-0.411095 --> -0.437021).  Saving model ...
Epoch: 10 cost time: 0.44359445571899414
Epoch: 10, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.609 Vali Acc: 0.467 Test Loss: 1.609 Test Acc: 0.467
Validation loss decreased (-0.437021 --> -0.466651).  Saving model ...
Epoch: 11 cost time: 0.4703640937805176
Epoch: 11, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.591 Vali Acc: 0.504 Test Loss: 1.591 Test Acc: 0.504
Validation loss decreased (-0.466651 --> -0.503688).  Saving model ...
Epoch: 12 cost time: 0.5313677787780762
Epoch: 12, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.572 Vali Acc: 0.530 Test Loss: 1.572 Test Acc: 0.530
Validation loss decreased (-0.503688 --> -0.529614).  Saving model ...
Epoch: 13 cost time: 0.5808103084564209
Epoch: 13, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.552 Vali Acc: 0.556 Test Loss: 1.552 Test Acc: 0.556
Validation loss decreased (-0.529614 --> -0.555540).  Saving model ...
Epoch: 14 cost time: 0.5722362995147705
Epoch: 14, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.532 Vali Acc: 0.596 Test Loss: 1.532 Test Acc: 0.596
Validation loss decreased (-0.555540 --> -0.596281).  Saving model ...
Epoch: 15 cost time: 0.4995121955871582
Epoch: 15, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.511 Vali Acc: 0.611 Test Loss: 1.511 Test Acc: 0.611
Validation loss decreased (-0.596281 --> -0.611096).  Saving model ...
Epoch: 16 cost time: 0.4968116283416748
Epoch: 16, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.489 Vali Acc: 0.626 Test Loss: 1.489 Test Acc: 0.626
Validation loss decreased (-0.611096 --> -0.625911).  Saving model ...
Epoch: 17 cost time: 0.5050137042999268
Epoch: 17, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.467 Vali Acc: 0.644 Test Loss: 1.467 Test Acc: 0.644
Validation loss decreased (-0.625911 --> -0.644430).  Saving model ...
Epoch: 18 cost time: 0.49454617500305176
Epoch: 18, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.444 Vali Acc: 0.656 Test Loss: 1.444 Test Acc: 0.656
Validation loss decreased (-0.644430 --> -0.655541).  Saving model ...
Epoch: 19 cost time: 0.5266733169555664
Epoch: 19, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.421 Vali Acc: 0.674 Test Loss: 1.421 Test Acc: 0.674
Validation loss decreased (-0.655541 --> -0.674060).  Saving model ...
Epoch: 20 cost time: 0.4890434741973877
Epoch: 20, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.398 Vali Acc: 0.681 Test Loss: 1.398 Test Acc: 0.681
Validation loss decreased (-0.674060 --> -0.681468).  Saving model ...
Epoch: 21 cost time: 0.6145079135894775
Epoch: 21, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.374 Vali Acc: 0.693 Test Loss: 1.374 Test Acc: 0.693
Validation loss decreased (-0.681468 --> -0.692579).  Saving model ...
Epoch: 22 cost time: 0.4470195770263672
Epoch: 22, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.350 Vali Acc: 0.689 Test Loss: 1.350 Test Acc: 0.689
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5502374172210693
Epoch: 23, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.326 Vali Acc: 0.700 Test Loss: 1.326 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699987).  Saving model ...
Epoch: 24 cost time: 0.45308661460876465
Epoch: 24, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.302 Vali Acc: 0.711 Test Loss: 1.302 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711098).  Saving model ...
Epoch: 25 cost time: 0.5149269104003906
Epoch: 25, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.277 Vali Acc: 0.722 Test Loss: 1.277 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722209).  Saving model ...
Epoch: 26 cost time: 0.5302224159240723
Epoch: 26, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.252 Vali Acc: 0.730 Test Loss: 1.252 Test Acc: 0.730
Validation loss decreased (-0.722209 --> -0.729617).  Saving model ...
Epoch: 27 cost time: 0.5124890804290771
Epoch: 27, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.228 Vali Acc: 0.733 Test Loss: 1.228 Test Acc: 0.733
Validation loss decreased (-0.729617 --> -0.733321).  Saving model ...
Epoch: 28 cost time: 0.4816553592681885
Epoch: 28, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.203 Vali Acc: 0.741 Test Loss: 1.203 Test Acc: 0.741
Validation loss decreased (-0.733321 --> -0.740729).  Saving model ...
Epoch: 29 cost time: 0.5080807209014893
Epoch: 29, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.178 Vali Acc: 0.752 Test Loss: 1.178 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 30 cost time: 0.4714357852935791
Epoch: 30, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.154 Vali Acc: 0.759 Test Loss: 1.154 Test Acc: 0.759
Validation loss decreased (-0.751840 --> -0.759248).  Saving model ...
Epoch: 31 cost time: 0.6177480220794678
Epoch: 31, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.129 Vali Acc: 0.767 Test Loss: 1.129 Test Acc: 0.767
Validation loss decreased (-0.759248 --> -0.766655).  Saving model ...
Epoch: 32 cost time: 0.43524694442749023
Epoch: 32, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.104 Vali Acc: 0.785 Test Loss: 1.104 Test Acc: 0.785
Validation loss decreased (-0.766655 --> -0.785174).  Saving model ...
Epoch: 33 cost time: 0.5203356742858887
Epoch: 33, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.080 Vali Acc: 0.789 Test Loss: 1.080 Test Acc: 0.789
Validation loss decreased (-0.785174 --> -0.788878).  Saving model ...
Epoch: 34 cost time: 0.40890049934387207
Epoch: 34, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.055 Vali Acc: 0.800 Test Loss: 1.055 Test Acc: 0.800
Validation loss decreased (-0.788878 --> -0.799989).  Saving model ...
Epoch: 35 cost time: 0.5190715789794922
Epoch: 35, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.031 Vali Acc: 0.804 Test Loss: 1.031 Test Acc: 0.804
Validation loss decreased (-0.799989 --> -0.803693).  Saving model ...
Epoch: 36 cost time: 0.5431387424468994
Epoch: 36, Steps: 2 | Train Loss: 0.914 Vali Loss: 1.007 Vali Acc: 0.807 Test Loss: 1.007 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807397).  Saving model ...
Epoch: 37 cost time: 0.6923792362213135
Epoch: 37, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.984 Vali Acc: 0.815 Test Loss: 0.984 Test Acc: 0.815
Validation loss decreased (-0.807397 --> -0.814805).  Saving model ...
Epoch: 38 cost time: 0.565732479095459
Epoch: 38, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.961 Vali Acc: 0.822 Test Loss: 0.961 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 39 cost time: 0.5405187606811523
Epoch: 39, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.938 Vali Acc: 0.826 Test Loss: 0.938 Test Acc: 0.826
Validation loss decreased (-0.822213 --> -0.825917).  Saving model ...
Epoch: 40 cost time: 0.3615381717681885
Epoch: 40, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.915 Vali Acc: 0.833 Test Loss: 0.915 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833324).  Saving model ...
Epoch: 41 cost time: 0.44615650177001953
Epoch: 41, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833324).  Saving model ...
Epoch: 42 cost time: 0.43281102180480957
Epoch: 42, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.871 Vali Acc: 0.833 Test Loss: 0.871 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 43 cost time: 0.5824398994445801
Epoch: 43, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.850 Vali Acc: 0.848 Test Loss: 0.850 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 44 cost time: 0.4467356204986572
Epoch: 44, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.829 Vali Acc: 0.859 Test Loss: 0.829 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859251).  Saving model ...
Epoch: 45 cost time: 0.44088292121887207
Epoch: 45, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.809 Vali Acc: 0.874 Test Loss: 0.809 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 46 cost time: 0.4830179214477539
Epoch: 46, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.789 Vali Acc: 0.881 Test Loss: 0.789 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 47 cost time: 0.49642252922058105
Epoch: 47, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.769 Vali Acc: 0.889 Test Loss: 0.769 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888881).  Saving model ...
Epoch: 48 cost time: 0.4655489921569824
Epoch: 48, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.751 Vali Acc: 0.893 Test Loss: 0.751 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 49 cost time: 0.48821282386779785
Epoch: 49, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.732 Vali Acc: 0.904 Test Loss: 0.732 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903696).  Saving model ...
Epoch: 50 cost time: 0.5311012268066406
Epoch: 50, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.714 Vali Acc: 0.911 Test Loss: 0.714 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 51 cost time: 0.43540167808532715
Epoch: 51, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.697 Vali Acc: 0.915 Test Loss: 0.697 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 52 cost time: 0.42334508895874023
Epoch: 52, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.680 Vali Acc: 0.915 Test Loss: 0.680 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 53 cost time: 0.5442860126495361
Epoch: 53, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.663 Vali Acc: 0.919 Test Loss: 0.663 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 54 cost time: 0.5057048797607422
Epoch: 54, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.647 Vali Acc: 0.919 Test Loss: 0.647 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 55 cost time: 0.5221371650695801
Epoch: 55, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.632 Vali Acc: 0.919 Test Loss: 0.632 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 56 cost time: 0.41486382484436035
Epoch: 56, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.617 Vali Acc: 0.926 Test Loss: 0.617 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 57 cost time: 0.6824493408203125
Epoch: 57, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.603 Vali Acc: 0.930 Test Loss: 0.603 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 58 cost time: 0.5714550018310547
Epoch: 58, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.589 Vali Acc: 0.941 Test Loss: 0.589 Test Acc: 0.941
Validation loss decreased (-0.929624 --> -0.940735).  Saving model ...
Epoch: 59 cost time: 0.43306779861450195
Epoch: 59, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.575 Vali Acc: 0.941 Test Loss: 0.575 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 60 cost time: 0.48056697845458984
Epoch: 60, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.562 Vali Acc: 0.944 Test Loss: 0.562 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 61 cost time: 0.4797074794769287
Epoch: 61, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.550 Vali Acc: 0.941 Test Loss: 0.550 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6040294170379639
Epoch: 62, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.538 Vali Acc: 0.941 Test Loss: 0.538 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.546424388885498
Epoch: 63, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.526 Vali Acc: 0.937 Test Loss: 0.526 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.43988919258117676
Epoch: 64, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.515 Vali Acc: 0.941 Test Loss: 0.515 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.45259833335876465
Epoch: 65, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.504 Vali Acc: 0.941 Test Loss: 0.504 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.5457313060760498
Epoch: 66, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.494 Vali Acc: 0.941 Test Loss: 0.494 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.4814438819885254
Epoch: 67, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.483 Vali Acc: 0.937 Test Loss: 0.483 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.4751720428466797
Epoch: 68, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.48354387283325195
Epoch: 69, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.464 Vali Acc: 0.930 Test Loss: 0.464 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.43267011642456055
Epoch: 70, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.455 Vali Acc: 0.922 Test Loss: 0.455 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 9248
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.572136640548706
Epoch: 1, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.873 Vali Acc: 0.130 Test Loss: 1.873 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.4846229553222656
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.855 Vali Acc: 0.167 Test Loss: 1.855 Test Acc: 0.167
Validation loss decreased (-0.129611 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.4330019950866699
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.842 Vali Acc: 0.196 Test Loss: 1.842 Test Acc: 0.196
Validation loss decreased (-0.166648 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.5249571800231934
Epoch: 4, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.833 Vali Acc: 0.200 Test Loss: 1.833 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.4597337245941162
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.822 Vali Acc: 0.215 Test Loss: 1.822 Test Acc: 0.215
Validation loss decreased (-0.199982 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.4867246150970459
Epoch: 6, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.809 Vali Acc: 0.237 Test Loss: 1.809 Test Acc: 0.237
Validation loss decreased (-0.214797 --> -0.237019).  Saving model ...
Epoch: 7 cost time: 0.47696924209594727
Epoch: 7, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.794 Vali Acc: 0.256 Test Loss: 1.794 Test Acc: 0.256
Validation loss decreased (-0.237019 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.43709301948547363
Epoch: 8, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.778 Vali Acc: 0.289 Test Loss: 1.778 Test Acc: 0.289
Validation loss decreased (-0.255538 --> -0.288871).  Saving model ...
Epoch: 9 cost time: 0.42330336570739746
Epoch: 9, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.760 Vali Acc: 0.307 Test Loss: 1.760 Test Acc: 0.307
Validation loss decreased (-0.288871 --> -0.307390).  Saving model ...
Epoch: 10 cost time: 0.43003106117248535
Epoch: 10, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.741 Vali Acc: 0.330 Test Loss: 1.741 Test Acc: 0.330
Validation loss decreased (-0.307390 --> -0.329612).  Saving model ...
Epoch: 11 cost time: 0.5108635425567627
Epoch: 11, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.721 Vali Acc: 0.348 Test Loss: 1.721 Test Acc: 0.348
Validation loss decreased (-0.329612 --> -0.348131).  Saving model ...
Epoch: 12 cost time: 0.42331671714782715
Epoch: 12, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.700 Vali Acc: 0.367 Test Loss: 1.700 Test Acc: 0.367
Validation loss decreased (-0.348131 --> -0.366650).  Saving model ...
Epoch: 13 cost time: 0.5271072387695312
Epoch: 13, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.678 Vali Acc: 0.385 Test Loss: 1.678 Test Acc: 0.385
Validation loss decreased (-0.366650 --> -0.385168).  Saving model ...
Epoch: 14 cost time: 0.487293004989624
Epoch: 14, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.656 Vali Acc: 0.400 Test Loss: 1.656 Test Acc: 0.400
Validation loss decreased (-0.385168 --> -0.399983).  Saving model ...
Epoch: 15 cost time: 0.4115593433380127
Epoch: 15, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.633 Vali Acc: 0.433 Test Loss: 1.633 Test Acc: 0.433
Validation loss decreased (-0.399983 --> -0.433317).  Saving model ...
Epoch: 16 cost time: 0.4835047721862793
Epoch: 16, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.609 Vali Acc: 0.463 Test Loss: 1.609 Test Acc: 0.463
Validation loss decreased (-0.433317 --> -0.462947).  Saving model ...
Epoch: 17 cost time: 0.52667236328125
Epoch: 17, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.585 Vali Acc: 0.485 Test Loss: 1.585 Test Acc: 0.485
Validation loss decreased (-0.462947 --> -0.485169).  Saving model ...
Epoch: 18 cost time: 0.4554264545440674
Epoch: 18, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.561 Vali Acc: 0.507 Test Loss: 1.561 Test Acc: 0.507
Validation loss decreased (-0.485169 --> -0.507392).  Saving model ...
Epoch: 19 cost time: 0.5742402076721191
Epoch: 19, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.536 Vali Acc: 0.533 Test Loss: 1.536 Test Acc: 0.533
Validation loss decreased (-0.507392 --> -0.533318).  Saving model ...
Epoch: 20 cost time: 0.42651820182800293
Epoch: 20, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.511 Vali Acc: 0.556 Test Loss: 1.511 Test Acc: 0.556
Validation loss decreased (-0.533318 --> -0.555540).  Saving model ...
Epoch: 21 cost time: 0.604503870010376
Epoch: 21, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.485 Vali Acc: 0.574 Test Loss: 1.485 Test Acc: 0.574
Validation loss decreased (-0.555540 --> -0.574059).  Saving model ...
Epoch: 22 cost time: 0.4628891944885254
Epoch: 22, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.460 Vali Acc: 0.593 Test Loss: 1.460 Test Acc: 0.593
Validation loss decreased (-0.574059 --> -0.592578).  Saving model ...
Epoch: 23 cost time: 0.4697446823120117
Epoch: 23, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.434 Vali Acc: 0.615 Test Loss: 1.434 Test Acc: 0.615
Validation loss decreased (-0.592578 --> -0.614800).  Saving model ...
Epoch: 24 cost time: 0.6192760467529297
Epoch: 24, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.408 Vali Acc: 0.637 Test Loss: 1.408 Test Acc: 0.637
Validation loss decreased (-0.614800 --> -0.637023).  Saving model ...
Epoch: 25 cost time: 0.4428260326385498
Epoch: 25, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.381 Vali Acc: 0.648 Test Loss: 1.381 Test Acc: 0.648
Validation loss decreased (-0.637023 --> -0.648134).  Saving model ...
Epoch: 26 cost time: 0.427593469619751
Epoch: 26, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.355 Vali Acc: 0.652 Test Loss: 1.355 Test Acc: 0.652
Validation loss decreased (-0.648134 --> -0.651838).  Saving model ...
Epoch: 27 cost time: 0.5368599891662598
Epoch: 27, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.329 Vali Acc: 0.674 Test Loss: 1.329 Test Acc: 0.674
Validation loss decreased (-0.651838 --> -0.674061).  Saving model ...
Epoch: 28 cost time: 0.5278632640838623
Epoch: 28, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.302 Vali Acc: 0.696 Test Loss: 1.302 Test Acc: 0.696
Validation loss decreased (-0.674061 --> -0.696283).  Saving model ...
Epoch: 29 cost time: 0.44902801513671875
Epoch: 29, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.275 Vali Acc: 0.719 Test Loss: 1.275 Test Acc: 0.719
Validation loss decreased (-0.696283 --> -0.718506).  Saving model ...
Epoch: 30 cost time: 0.5471935272216797
Epoch: 30, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.248 Vali Acc: 0.726 Test Loss: 1.248 Test Acc: 0.726
Validation loss decreased (-0.718506 --> -0.725913).  Saving model ...
Epoch: 31 cost time: 0.4638829231262207
Epoch: 31, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.222 Vali Acc: 0.737 Test Loss: 1.222 Test Acc: 0.737
Validation loss decreased (-0.725913 --> -0.737025).  Saving model ...
Epoch: 32 cost time: 0.4092724323272705
Epoch: 32, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.195 Vali Acc: 0.759 Test Loss: 1.195 Test Acc: 0.759
Validation loss decreased (-0.737025 --> -0.759247).  Saving model ...
Epoch: 33 cost time: 0.41105222702026367
Epoch: 33, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
Validation loss decreased (-0.759247 --> -0.777766).  Saving model ...
Epoch: 34 cost time: 0.5516278743743896
Epoch: 34, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.142 Vali Acc: 0.804 Test Loss: 1.142 Test Acc: 0.804
Validation loss decreased (-0.777766 --> -0.803692).  Saving model ...
Epoch: 35 cost time: 0.4354848861694336
Epoch: 35, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.116 Vali Acc: 0.804 Test Loss: 1.116 Test Acc: 0.804
Validation loss decreased (-0.803692 --> -0.803693).  Saving model ...
Epoch: 36 cost time: 0.5303857326507568
Epoch: 36, Steps: 2 | Train Loss: 0.993 Vali Loss: 1.089 Vali Acc: 0.800 Test Loss: 1.089 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.34976911544799805
Epoch: 37, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.064 Vali Acc: 0.800 Test Loss: 1.064 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.4989910125732422
Epoch: 38, Steps: 2 | Train Loss: 0.935 Vali Loss: 1.038 Vali Acc: 0.804 Test Loss: 1.038 Test Acc: 0.804
Validation loss decreased (-0.803693 --> -0.803693).  Saving model ...
Epoch: 39 cost time: 0.3944873809814453
Epoch: 39, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.013 Vali Acc: 0.819 Test Loss: 1.013 Test Acc: 0.819
Validation loss decreased (-0.803693 --> -0.818508).  Saving model ...
Epoch: 40 cost time: 0.4591786861419678
Epoch: 40, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.988 Vali Acc: 0.826 Test Loss: 0.988 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825916).  Saving model ...
Epoch: 41 cost time: 0.3847506046295166
Epoch: 41, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.963 Vali Acc: 0.833 Test Loss: 0.963 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833324).  Saving model ...
Epoch: 42 cost time: 0.4406554698944092
Epoch: 42, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.939 Vali Acc: 0.841 Test Loss: 0.939 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840731).  Saving model ...
Epoch: 43 cost time: 0.39240574836730957
Epoch: 43, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.916 Vali Acc: 0.844 Test Loss: 0.916 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 44 cost time: 0.5235157012939453
Epoch: 44, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.893 Vali Acc: 0.856 Test Loss: 0.893 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855547).  Saving model ...
Epoch: 45 cost time: 0.5546796321868896
Epoch: 45, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.870 Vali Acc: 0.863 Test Loss: 0.870 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862954).  Saving model ...
Epoch: 46 cost time: 0.43628358840942383
Epoch: 46, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.848 Vali Acc: 0.870 Test Loss: 0.848 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 47 cost time: 0.4682750701904297
Epoch: 47, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.826 Vali Acc: 0.878 Test Loss: 0.826 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877770).  Saving model ...
Epoch: 48 cost time: 0.46729111671447754
Epoch: 48, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.805 Vali Acc: 0.881 Test Loss: 0.805 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881473).  Saving model ...
Epoch: 49 cost time: 0.42640161514282227
Epoch: 49, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.785 Vali Acc: 0.889 Test Loss: 0.785 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 50 cost time: 0.5192515850067139
Epoch: 50, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.765 Vali Acc: 0.885 Test Loss: 0.765 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.47535204887390137
Epoch: 51, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 52 cost time: 0.3937227725982666
Epoch: 52, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 53 cost time: 0.5607426166534424
Epoch: 53, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.709 Vali Acc: 0.893 Test Loss: 0.709 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 54 cost time: 0.4970419406890869
Epoch: 54, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.692 Vali Acc: 0.896 Test Loss: 0.692 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896289).  Saving model ...
Epoch: 55 cost time: 0.47421908378601074
Epoch: 55, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 56 cost time: 0.46988821029663086
Epoch: 56, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.658 Vali Acc: 0.904 Test Loss: 0.658 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 57 cost time: 0.483217716217041
Epoch: 57, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.643 Vali Acc: 0.904 Test Loss: 0.643 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 58 cost time: 0.5354034900665283
Epoch: 58, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.628 Vali Acc: 0.907 Test Loss: 0.628 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 59 cost time: 0.5813543796539307
Epoch: 59, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.613 Vali Acc: 0.907 Test Loss: 0.613 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 60 cost time: 0.5181488990783691
Epoch: 60, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.599 Vali Acc: 0.911 Test Loss: 0.599 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 61 cost time: 0.3894355297088623
Epoch: 61, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.585 Vali Acc: 0.907 Test Loss: 0.585 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.4118821620941162
Epoch: 62, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.572 Vali Acc: 0.907 Test Loss: 0.572 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6215856075286865
Epoch: 63, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.560 Vali Acc: 0.907 Test Loss: 0.560 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.47327494621276855
Epoch: 64, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.547 Vali Acc: 0.907 Test Loss: 0.547 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5186543464660645
Epoch: 65, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.536 Vali Acc: 0.911 Test Loss: 0.536 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 66 cost time: 0.4786040782928467
Epoch: 66, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.525 Vali Acc: 0.915 Test Loss: 0.525 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 67 cost time: 0.46559786796569824
Epoch: 67, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.514 Vali Acc: 0.915 Test Loss: 0.514 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 68 cost time: 0.4488942623138428
Epoch: 68, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.503 Vali Acc: 0.915 Test Loss: 0.503 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 69 cost time: 0.4507176876068115
Epoch: 69, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 70 cost time: 0.457247257232666
Epoch: 70, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.484 Vali Acc: 0.919 Test Loss: 0.484 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 71 cost time: 0.48868417739868164
Epoch: 71, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.474 Vali Acc: 0.919 Test Loss: 0.474 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 72 cost time: 0.47604918479919434
Epoch: 72, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 73 cost time: 0.41489362716674805
Epoch: 73, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.457 Vali Acc: 0.919 Test Loss: 0.457 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 74 cost time: 0.4856986999511719
Epoch: 74, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 75 cost time: 0.4655001163482666
Epoch: 75, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.440 Vali Acc: 0.922 Test Loss: 0.440 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 76 cost time: 0.404144287109375
Epoch: 76, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.432 Vali Acc: 0.926 Test Loss: 0.432 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 77 cost time: 0.40337562561035156
Epoch: 77, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.425 Vali Acc: 0.926 Test Loss: 0.425 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 78 cost time: 0.4058868885040283
Epoch: 78, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 79 cost time: 0.4708278179168701
Epoch: 79, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.411 Vali Acc: 0.926 Test Loss: 0.411 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 80 cost time: 0.4892001152038574
Epoch: 80, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 81 cost time: 0.45558810234069824
Epoch: 81, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 82 cost time: 0.5579953193664551
Epoch: 82, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.392 Vali Acc: 0.926 Test Loss: 0.392 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 83 cost time: 0.4839620590209961
Epoch: 83, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.386 Vali Acc: 0.926 Test Loss: 0.386 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 84 cost time: 0.4108703136444092
Epoch: 84, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.380 Vali Acc: 0.926 Test Loss: 0.380 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 85 cost time: 0.4722328186035156
Epoch: 85, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 86 cost time: 0.5579452514648438
Epoch: 86, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.369 Vali Acc: 0.922 Test Loss: 0.369 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.44422388076782227
Epoch: 87, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.5800187587738037
Epoch: 88, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.42632555961608887
Epoch: 89, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.522773027420044
Epoch: 90, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.49184322357177734
Epoch: 91, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.3946263790130615
Epoch: 92, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.45334577560424805
Epoch: 93, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.47377443313598633
Epoch: 94, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.5107851028442383
Epoch: 95, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 8910
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.4864509105682373
Epoch: 1, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.755 Vali Acc: 0.341 Test Loss: 1.755 Test Acc: 0.341
Validation loss decreased (inf --> -0.340723).  Saving model ...
Epoch: 2 cost time: 0.4853482246398926
Epoch: 2, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.739 Vali Acc: 0.356 Test Loss: 1.739 Test Acc: 0.356
Validation loss decreased (-0.340723 --> -0.355538).  Saving model ...
Epoch: 3 cost time: 0.4778766632080078
Epoch: 3, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.728 Vali Acc: 0.363 Test Loss: 1.728 Test Acc: 0.363
Validation loss decreased (-0.355538 --> -0.362946).  Saving model ...
Epoch: 4 cost time: 0.5422916412353516
Epoch: 4, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.720 Vali Acc: 0.367 Test Loss: 1.720 Test Acc: 0.367
Validation loss decreased (-0.362946 --> -0.366649).  Saving model ...
Epoch: 5 cost time: 0.4969899654388428
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.709 Vali Acc: 0.378 Test Loss: 1.709 Test Acc: 0.378
Validation loss decreased (-0.366649 --> -0.377761).  Saving model ...
Epoch: 6 cost time: 0.4474208354949951
Epoch: 6, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.697 Vali Acc: 0.378 Test Loss: 1.697 Test Acc: 0.378
Validation loss decreased (-0.377761 --> -0.377761).  Saving model ...
Epoch: 7 cost time: 0.5323128700256348
Epoch: 7, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.683 Vali Acc: 0.393 Test Loss: 1.683 Test Acc: 0.393
Validation loss decreased (-0.377761 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 0.513134241104126
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.668 Vali Acc: 0.415 Test Loss: 1.668 Test Acc: 0.415
Validation loss decreased (-0.392576 --> -0.414798).  Saving model ...
Epoch: 9 cost time: 0.4088151454925537
Epoch: 9, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.651 Vali Acc: 0.422 Test Loss: 1.651 Test Acc: 0.422
Validation loss decreased (-0.414798 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 0.4965169429779053
Epoch: 10, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.634 Vali Acc: 0.422 Test Loss: 1.634 Test Acc: 0.422
Validation loss decreased (-0.422206 --> -0.422206).  Saving model ...
Epoch: 11 cost time: 0.45328307151794434
Epoch: 11, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.615 Vali Acc: 0.437 Test Loss: 1.615 Test Acc: 0.437
Validation loss decreased (-0.422206 --> -0.437021).  Saving model ...
Epoch: 12 cost time: 0.42052578926086426
Epoch: 12, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.595 Vali Acc: 0.459 Test Loss: 1.595 Test Acc: 0.459
Validation loss decreased (-0.437021 --> -0.459243).  Saving model ...
Epoch: 13 cost time: 0.48508143424987793
Epoch: 13, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.575 Vali Acc: 0.470 Test Loss: 1.575 Test Acc: 0.470
Validation loss decreased (-0.459243 --> -0.470355).  Saving model ...
Epoch: 14 cost time: 0.5383303165435791
Epoch: 14, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.554 Vali Acc: 0.485 Test Loss: 1.554 Test Acc: 0.485
Validation loss decreased (-0.470355 --> -0.485170).  Saving model ...
Epoch: 15 cost time: 0.4899427890777588
Epoch: 15, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.533 Vali Acc: 0.500 Test Loss: 1.533 Test Acc: 0.500
Validation loss decreased (-0.485170 --> -0.499985).  Saving model ...
Epoch: 16 cost time: 0.3988521099090576
Epoch: 16, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.511 Vali Acc: 0.511 Test Loss: 1.511 Test Acc: 0.511
Validation loss decreased (-0.499985 --> -0.511096).  Saving model ...
Epoch: 17 cost time: 0.540595293045044
Epoch: 17, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.488 Vali Acc: 0.519 Test Loss: 1.488 Test Acc: 0.519
Validation loss decreased (-0.511096 --> -0.518504).  Saving model ...
Epoch: 18 cost time: 0.5060467720031738
Epoch: 18, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.465 Vali Acc: 0.522 Test Loss: 1.465 Test Acc: 0.522
Validation loss decreased (-0.518504 --> -0.522208).  Saving model ...
Epoch: 19 cost time: 0.5508198738098145
Epoch: 19, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.442 Vali Acc: 0.541 Test Loss: 1.442 Test Acc: 0.541
Validation loss decreased (-0.522208 --> -0.540726).  Saving model ...
Epoch: 20 cost time: 0.4630095958709717
Epoch: 20, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.419 Vali Acc: 0.552 Test Loss: 1.419 Test Acc: 0.552
Validation loss decreased (-0.540726 --> -0.551838).  Saving model ...
Epoch: 21 cost time: 0.45024728775024414
Epoch: 21, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.395 Vali Acc: 0.574 Test Loss: 1.395 Test Acc: 0.574
Validation loss decreased (-0.551838 --> -0.574060).  Saving model ...
Epoch: 22 cost time: 0.505673885345459
Epoch: 22, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.371 Vali Acc: 0.626 Test Loss: 1.371 Test Acc: 0.626
Validation loss decreased (-0.574060 --> -0.625912).  Saving model ...
Epoch: 23 cost time: 0.480579137802124
Epoch: 23, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.347 Vali Acc: 0.648 Test Loss: 1.347 Test Acc: 0.648
Validation loss decreased (-0.625912 --> -0.648135).  Saving model ...
Epoch: 24 cost time: 0.4962906837463379
Epoch: 24, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.323 Vali Acc: 0.659 Test Loss: 1.323 Test Acc: 0.659
Validation loss decreased (-0.648135 --> -0.659246).  Saving model ...
Epoch: 25 cost time: 0.47695446014404297
Epoch: 25, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.299 Vali Acc: 0.670 Test Loss: 1.299 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 26 cost time: 0.47074437141418457
Epoch: 26, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.275 Vali Acc: 0.678 Test Loss: 1.275 Test Acc: 0.678
Validation loss decreased (-0.670357 --> -0.677765).  Saving model ...
Epoch: 27 cost time: 0.5178790092468262
Epoch: 27, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.250 Vali Acc: 0.685 Test Loss: 1.250 Test Acc: 0.685
Validation loss decreased (-0.677765 --> -0.685173).  Saving model ...
Epoch: 28 cost time: 0.4294710159301758
Epoch: 28, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.226 Vali Acc: 0.700 Test Loss: 1.226 Test Acc: 0.700
Validation loss decreased (-0.685173 --> -0.699988).  Saving model ...
Epoch: 29 cost time: 0.4603302478790283
Epoch: 29, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.202 Vali Acc: 0.726 Test Loss: 1.202 Test Acc: 0.726
Validation loss decreased (-0.699988 --> -0.725914).  Saving model ...
Epoch: 30 cost time: 0.39111876487731934
Epoch: 30, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.177 Vali Acc: 0.726 Test Loss: 1.177 Test Acc: 0.726
Validation loss decreased (-0.725914 --> -0.725914).  Saving model ...
Epoch: 31 cost time: 0.5601394176483154
Epoch: 31, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.153 Vali Acc: 0.733 Test Loss: 1.153 Test Acc: 0.733
Validation loss decreased (-0.725914 --> -0.733322).  Saving model ...
Epoch: 32 cost time: 0.5730092525482178
Epoch: 32, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.129 Vali Acc: 0.741 Test Loss: 1.129 Test Acc: 0.741
Validation loss decreased (-0.733322 --> -0.740729).  Saving model ...
Epoch: 33 cost time: 0.45055508613586426
Epoch: 33, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.105 Vali Acc: 0.752 Test Loss: 1.105 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751841).  Saving model ...
Epoch: 34 cost time: 0.5710690021514893
Epoch: 34, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.081 Vali Acc: 0.763 Test Loss: 1.081 Test Acc: 0.763
Validation loss decreased (-0.751841 --> -0.762952).  Saving model ...
Epoch: 35 cost time: 0.44609975814819336
Epoch: 35, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.057 Vali Acc: 0.770 Test Loss: 1.057 Test Acc: 0.770
Validation loss decreased (-0.762952 --> -0.770360).  Saving model ...
Epoch: 36 cost time: 0.48575496673583984
Epoch: 36, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.034 Vali Acc: 0.785 Test Loss: 1.034 Test Acc: 0.785
Validation loss decreased (-0.770360 --> -0.785175).  Saving model ...
Epoch: 37 cost time: 0.4572634696960449
Epoch: 37, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.011 Vali Acc: 0.800 Test Loss: 1.011 Test Acc: 0.800
Validation loss decreased (-0.785175 --> -0.799990).  Saving model ...
Epoch: 38 cost time: 0.4281432628631592
Epoch: 38, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.988 Vali Acc: 0.807 Test Loss: 0.988 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 39 cost time: 0.4611697196960449
Epoch: 39, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.807398 --> -0.818509).  Saving model ...
Epoch: 40 cost time: 0.4590635299682617
Epoch: 40, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.943 Vali Acc: 0.830 Test Loss: 0.943 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829620).  Saving model ...
Epoch: 41 cost time: 0.4866673946380615
Epoch: 41, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.921 Vali Acc: 0.830 Test Loss: 0.921 Test Acc: 0.830
Validation loss decreased (-0.829620 --> -0.829620).  Saving model ...
Epoch: 42 cost time: 0.5496013164520264
Epoch: 42, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.899 Vali Acc: 0.841 Test Loss: 0.899 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840732).  Saving model ...
Epoch: 43 cost time: 0.49319911003112793
Epoch: 43, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.878 Vali Acc: 0.844 Test Loss: 0.878 Test Acc: 0.844
Validation loss decreased (-0.840732 --> -0.844436).  Saving model ...
Epoch: 44 cost time: 0.5265331268310547
Epoch: 44, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.857 Vali Acc: 0.844 Test Loss: 0.857 Test Acc: 0.844
Validation loss decreased (-0.844436 --> -0.844436).  Saving model ...
Epoch: 45 cost time: 0.5068511962890625
Epoch: 45, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.837 Vali Acc: 0.856 Test Loss: 0.837 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 46 cost time: 0.726543664932251
Epoch: 46, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.817 Vali Acc: 0.859 Test Loss: 0.817 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 47 cost time: 0.5500879287719727
Epoch: 47, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.798 Vali Acc: 0.867 Test Loss: 0.798 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 48 cost time: 0.5255107879638672
Epoch: 48, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.779 Vali Acc: 0.874 Test Loss: 0.779 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874066).  Saving model ...
Epoch: 49 cost time: 0.747591495513916
Epoch: 49, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.760 Vali Acc: 0.878 Test Loss: 0.760 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 50 cost time: 0.6058475971221924
Epoch: 50, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.743 Vali Acc: 0.881 Test Loss: 0.743 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 51 cost time: 0.585383415222168
Epoch: 51, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.725 Vali Acc: 0.885 Test Loss: 0.725 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 52 cost time: 0.4868199825286865
Epoch: 52, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.708 Vali Acc: 0.889 Test Loss: 0.708 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 53 cost time: 0.546736478805542
Epoch: 53, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.692 Vali Acc: 0.893 Test Loss: 0.692 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 54 cost time: 0.660045862197876
Epoch: 54, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.676 Vali Acc: 0.896 Test Loss: 0.676 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 55 cost time: 0.7159948348999023
Epoch: 55, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.661 Vali Acc: 0.896 Test Loss: 0.661 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 56 cost time: 0.5601019859313965
Epoch: 56, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 57 cost time: 0.5369949340820312
Epoch: 57, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.632 Vali Acc: 0.900 Test Loss: 0.632 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 58 cost time: 0.5702061653137207
Epoch: 58, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.618 Vali Acc: 0.904 Test Loss: 0.618 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 59 cost time: 0.6080019474029541
Epoch: 59, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.604 Vali Acc: 0.907 Test Loss: 0.604 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907401).  Saving model ...
Epoch: 60 cost time: 0.6195125579833984
Epoch: 60, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.591 Vali Acc: 0.907 Test Loss: 0.591 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 61 cost time: 0.6194844245910645
Epoch: 61, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.579 Vali Acc: 0.907 Test Loss: 0.579 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 62 cost time: 0.5817215442657471
Epoch: 62, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.567 Vali Acc: 0.907 Test Loss: 0.567 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 63 cost time: 0.6514694690704346
Epoch: 63, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.555 Vali Acc: 0.911 Test Loss: 0.555 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 64 cost time: 0.5123133659362793
Epoch: 64, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.544 Vali Acc: 0.911 Test Loss: 0.544 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 65 cost time: 0.7661843299865723
Epoch: 65, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.533 Vali Acc: 0.915 Test Loss: 0.533 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914809).  Saving model ...
Epoch: 66 cost time: 0.7749214172363281
Epoch: 66, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.522 Vali Acc: 0.919 Test Loss: 0.522 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 67 cost time: 0.5377860069274902
Epoch: 67, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.512 Vali Acc: 0.919 Test Loss: 0.512 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 68 cost time: 0.6737773418426514
Epoch: 68, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 69 cost time: 0.6042571067810059
Epoch: 69, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.493 Vali Acc: 0.919 Test Loss: 0.493 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6071505546569824
Epoch: 70, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.484 Vali Acc: 0.919 Test Loss: 0.484 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6600668430328369
Epoch: 71, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6814260482788086
Epoch: 72, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6912002563476562
Epoch: 73, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.6796560287475586
Epoch: 74, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 75 cost time: 0.5040767192840576
Epoch: 75, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.443 Vali Acc: 0.922 Test Loss: 0.443 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 76 cost time: 0.6787340641021729
Epoch: 76, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.436 Vali Acc: 0.922 Test Loss: 0.436 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 77 cost time: 0.5688927173614502
Epoch: 77, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 78 cost time: 0.5957627296447754
Epoch: 78, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.423 Vali Acc: 0.922 Test Loss: 0.423 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 79 cost time: 0.6148276329040527
Epoch: 79, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 80 cost time: 0.6142423152923584
Epoch: 80, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 81 cost time: 0.5156571865081787
Epoch: 81, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 82 cost time: 0.5616271495819092
Epoch: 82, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 83 cost time: 0.6666660308837891
Epoch: 83, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.393 Vali Acc: 0.922 Test Loss: 0.393 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 84 cost time: 0.8130104541778564
Epoch: 84, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 85 cost time: 0.78993821144104
Epoch: 85, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.6815907955169678
Epoch: 86, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.791558027267456
Epoch: 87, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.372 Vali Acc: 0.915 Test Loss: 0.372 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 88 cost time: 0.7425539493560791
Epoch: 88, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.368 Vali Acc: 0.915 Test Loss: 0.368 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 89 cost time: 0.4773099422454834
Epoch: 89, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 90 cost time: 0.5904927253723145
Epoch: 90, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 91 cost time: 0.5037360191345215
Epoch: 91, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 92 cost time: 0.5753047466278076
Epoch: 92, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 93 cost time: 0.6370866298675537
Epoch: 93, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 94 cost time: 0.5411989688873291
Epoch: 94, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 8898
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9764139652252197
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.884 Vali Acc: 0.070 Test Loss: 1.884 Test Acc: 0.070
Validation loss decreased (inf --> -0.070352).  Saving model ...
Epoch: 2 cost time: 0.6127235889434814
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.867 Vali Acc: 0.085 Test Loss: 1.867 Test Acc: 0.085
Validation loss decreased (-0.070352 --> -0.085167).  Saving model ...
Epoch: 3 cost time: 0.6598925590515137
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.855 Vali Acc: 0.089 Test Loss: 1.855 Test Acc: 0.089
Validation loss decreased (-0.085167 --> -0.088870).  Saving model ...
Epoch: 4 cost time: 0.6801149845123291
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.846 Vali Acc: 0.104 Test Loss: 1.846 Test Acc: 0.104
Validation loss decreased (-0.088870 --> -0.103685).  Saving model ...
Epoch: 5 cost time: 0.7259840965270996
Epoch: 5, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.835 Vali Acc: 0.111 Test Loss: 1.835 Test Acc: 0.111
Validation loss decreased (-0.103685 --> -0.111093).  Saving model ...
Epoch: 6 cost time: 0.6751987934112549
Epoch: 6, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.822 Vali Acc: 0.122 Test Loss: 1.822 Test Acc: 0.122
Validation loss decreased (-0.111093 --> -0.122204).  Saving model ...
Epoch: 7 cost time: 0.7897810935974121
Epoch: 7, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.807 Vali Acc: 0.148 Test Loss: 1.807 Test Acc: 0.148
Validation loss decreased (-0.122204 --> -0.148130).  Saving model ...
Epoch: 8 cost time: 0.8615739345550537
Epoch: 8, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.790 Vali Acc: 0.170 Test Loss: 1.790 Test Acc: 0.170
Validation loss decreased (-0.148130 --> -0.170352).  Saving model ...
Epoch: 9 cost time: 0.7657351493835449
Epoch: 9, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.772 Vali Acc: 0.181 Test Loss: 1.772 Test Acc: 0.181
Validation loss decreased (-0.170352 --> -0.181464).  Saving model ...
Epoch: 10 cost time: 0.6963696479797363
Epoch: 10, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.752 Vali Acc: 0.189 Test Loss: 1.752 Test Acc: 0.189
Validation loss decreased (-0.181464 --> -0.188871).  Saving model ...
Epoch: 11 cost time: 0.7587072849273682
Epoch: 11, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.732 Vali Acc: 0.207 Test Loss: 1.732 Test Acc: 0.207
Validation loss decreased (-0.188871 --> -0.207390).  Saving model ...
Epoch: 12 cost time: 0.6173667907714844
Epoch: 12, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.711 Vali Acc: 0.237 Test Loss: 1.711 Test Acc: 0.237
Validation loss decreased (-0.207390 --> -0.237020).  Saving model ...
Epoch: 13 cost time: 0.5963492393493652
Epoch: 13, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.689 Vali Acc: 0.263 Test Loss: 1.689 Test Acc: 0.263
Validation loss decreased (-0.237020 --> -0.262946).  Saving model ...
Epoch: 14 cost time: 0.6118474006652832
Epoch: 14, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.666 Vali Acc: 0.285 Test Loss: 1.666 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285169).  Saving model ...
Epoch: 15 cost time: 0.7400119304656982
Epoch: 15, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.642 Vali Acc: 0.315 Test Loss: 1.642 Test Acc: 0.315
Validation loss decreased (-0.285169 --> -0.314798).  Saving model ...
Epoch: 16 cost time: 0.6775197982788086
Epoch: 16, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.618 Vali Acc: 0.344 Test Loss: 1.618 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344428).  Saving model ...
Epoch: 17 cost time: 0.6275477409362793
Epoch: 17, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.593 Vali Acc: 0.363 Test Loss: 1.593 Test Acc: 0.363
Validation loss decreased (-0.344428 --> -0.362947).  Saving model ...
Epoch: 18 cost time: 0.6193251609802246
Epoch: 18, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.568 Vali Acc: 0.389 Test Loss: 1.568 Test Acc: 0.389
Validation loss decreased (-0.362947 --> -0.388873).  Saving model ...
Epoch: 19 cost time: 0.6076252460479736
Epoch: 19, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.543 Vali Acc: 0.411 Test Loss: 1.543 Test Acc: 0.411
Validation loss decreased (-0.388873 --> -0.411096).  Saving model ...
Epoch: 20 cost time: 0.56146240234375
Epoch: 20, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.517 Vali Acc: 0.441 Test Loss: 1.517 Test Acc: 0.441
Validation loss decreased (-0.411096 --> -0.440726).  Saving model ...
Epoch: 21 cost time: 0.6550681591033936
Epoch: 21, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.491 Vali Acc: 0.463 Test Loss: 1.491 Test Acc: 0.463
Validation loss decreased (-0.440726 --> -0.462948).  Saving model ...
Epoch: 22 cost time: 0.807530403137207
Epoch: 22, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.464 Vali Acc: 0.493 Test Loss: 1.464 Test Acc: 0.493
Validation loss decreased (-0.462948 --> -0.492578).  Saving model ...
Epoch: 23 cost time: 0.6609642505645752
Epoch: 23, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.438 Vali Acc: 0.522 Test Loss: 1.438 Test Acc: 0.522
Validation loss decreased (-0.492578 --> -0.522208).  Saving model ...
Epoch: 24 cost time: 0.692143440246582
Epoch: 24, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.411 Vali Acc: 0.541 Test Loss: 1.411 Test Acc: 0.541
Validation loss decreased (-0.522208 --> -0.540727).  Saving model ...
Epoch: 25 cost time: 0.7168827056884766
Epoch: 25, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.384 Vali Acc: 0.563 Test Loss: 1.384 Test Acc: 0.563
Validation loss decreased (-0.540727 --> -0.562949).  Saving model ...
Epoch: 26 cost time: 0.7811200618743896
Epoch: 26, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.357 Vali Acc: 0.581 Test Loss: 1.357 Test Acc: 0.581
Validation loss decreased (-0.562949 --> -0.581468).  Saving model ...
Epoch: 27 cost time: 0.9262890815734863
Epoch: 27, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.330 Vali Acc: 0.604 Test Loss: 1.330 Test Acc: 0.604
Validation loss decreased (-0.581468 --> -0.603690).  Saving model ...
Epoch: 28 cost time: 0.8931488990783691
Epoch: 28, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.303 Vali Acc: 0.633 Test Loss: 1.303 Test Acc: 0.633
Validation loss decreased (-0.603690 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.669126033782959
Epoch: 29, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.276 Vali Acc: 0.659 Test Loss: 1.276 Test Acc: 0.659
Validation loss decreased (-0.633320 --> -0.659247).  Saving model ...
Epoch: 30 cost time: 0.5107541084289551
Epoch: 30, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.249 Vali Acc: 0.693 Test Loss: 1.249 Test Acc: 0.693
Validation loss decreased (-0.659247 --> -0.692580).  Saving model ...
Epoch: 31 cost time: 0.7303252220153809
Epoch: 31, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
Validation loss decreased (-0.692580 --> -0.699988).  Saving model ...
Epoch: 32 cost time: 0.9527738094329834
Epoch: 32, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.195 Vali Acc: 0.719 Test Loss: 1.195 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 33 cost time: 0.9311518669128418
Epoch: 33, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.168 Vali Acc: 0.722 Test Loss: 1.168 Test Acc: 0.722
Validation loss decreased (-0.718507 --> -0.722211).  Saving model ...
Epoch: 34 cost time: 1.0430850982666016
Epoch: 34, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.142 Vali Acc: 0.748 Test Loss: 1.142 Test Acc: 0.748
Validation loss decreased (-0.722211 --> -0.748137).  Saving model ...
Epoch: 35 cost time: 0.825979471206665
Epoch: 35, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.115 Vali Acc: 0.770 Test Loss: 1.115 Test Acc: 0.770
Validation loss decreased (-0.748137 --> -0.770359).  Saving model ...
Epoch: 36 cost time: 0.8493368625640869
Epoch: 36, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.089 Vali Acc: 0.785 Test Loss: 1.089 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785174).  Saving model ...
Epoch: 37 cost time: 0.5610761642456055
Epoch: 37, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.063 Vali Acc: 0.800 Test Loss: 1.063 Test Acc: 0.800
Validation loss decreased (-0.785174 --> -0.799989).  Saving model ...
Epoch: 38 cost time: 0.7994294166564941
Epoch: 38, Steps: 2 | Train Loss: 0.912 Vali Loss: 1.038 Vali Acc: 0.800 Test Loss: 1.038 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799990).  Saving model ...
Epoch: 39 cost time: 0.6657717227935791
Epoch: 39, Steps: 2 | Train Loss: 0.877 Vali Loss: 1.013 Vali Acc: 0.811 Test Loss: 1.013 Test Acc: 0.811
Validation loss decreased (-0.799990 --> -0.811101).  Saving model ...
Epoch: 40 cost time: 0.7162644863128662
Epoch: 40, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.988 Vali Acc: 0.811 Test Loss: 0.988 Test Acc: 0.811
Validation loss decreased (-0.811101 --> -0.811101).  Saving model ...
Epoch: 41 cost time: 0.7314207553863525
Epoch: 41, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.963 Vali Acc: 0.830 Test Loss: 0.963 Test Acc: 0.830
Validation loss decreased (-0.811101 --> -0.829620).  Saving model ...
Epoch: 42 cost time: 0.5825963020324707
Epoch: 42, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.939 Vali Acc: 0.830 Test Loss: 0.939 Test Acc: 0.830
Validation loss decreased (-0.829620 --> -0.829620).  Saving model ...
Epoch: 43 cost time: 0.5256028175354004
Epoch: 43, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.916 Vali Acc: 0.837 Test Loss: 0.916 Test Acc: 0.837
Validation loss decreased (-0.829620 --> -0.837028).  Saving model ...
Epoch: 44 cost time: 0.6296346187591553
Epoch: 44, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.893 Vali Acc: 0.848 Test Loss: 0.893 Test Acc: 0.848
Validation loss decreased (-0.837028 --> -0.848139).  Saving model ...
Epoch: 45 cost time: 0.5367186069488525
Epoch: 45, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.870 Vali Acc: 0.852 Test Loss: 0.870 Test Acc: 0.852
Validation loss decreased (-0.848139 --> -0.851843).  Saving model ...
Epoch: 46 cost time: 0.6579713821411133
Epoch: 46, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.848 Vali Acc: 0.856 Test Loss: 0.848 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 47 cost time: 0.6709644794464111
Epoch: 47, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.827 Vali Acc: 0.856 Test Loss: 0.827 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 48 cost time: 0.7623202800750732
Epoch: 48, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.806 Vali Acc: 0.856 Test Loss: 0.806 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 49 cost time: 0.6430902481079102
Epoch: 49, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.786 Vali Acc: 0.856 Test Loss: 0.786 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855548).  Saving model ...
Epoch: 50 cost time: 0.5883092880249023
Epoch: 50, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.766 Vali Acc: 0.859 Test Loss: 0.766 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 51 cost time: 0.7486450672149658
Epoch: 51, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.746 Vali Acc: 0.863 Test Loss: 0.746 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862955).  Saving model ...
Epoch: 52 cost time: 0.5647790431976318
Epoch: 52, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.728 Vali Acc: 0.863 Test Loss: 0.728 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 53 cost time: 0.5722675323486328
Epoch: 53, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 54 cost time: 0.7747557163238525
Epoch: 54, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.692 Vali Acc: 0.867 Test Loss: 0.692 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 55 cost time: 0.5904269218444824
Epoch: 55, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 56 cost time: 0.7598748207092285
Epoch: 56, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.659 Vali Acc: 0.863 Test Loss: 0.659 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7254140377044678
Epoch: 57, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.643 Vali Acc: 0.863 Test Loss: 0.643 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.7734854221343994
Epoch: 58, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.627 Vali Acc: 0.870 Test Loss: 0.627 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 59 cost time: 0.5768630504608154
Epoch: 59, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.612 Vali Acc: 0.878 Test Loss: 0.612 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 60 cost time: 0.6023433208465576
Epoch: 60, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 61 cost time: 0.6260895729064941
Epoch: 61, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.584 Vali Acc: 0.893 Test Loss: 0.584 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 62 cost time: 0.6636276245117188
Epoch: 62, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.571 Vali Acc: 0.896 Test Loss: 0.571 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 63 cost time: 0.7464034557342529
Epoch: 63, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.558 Vali Acc: 0.900 Test Loss: 0.558 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899994).  Saving model ...
Epoch: 64 cost time: 0.7287440299987793
Epoch: 64, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.545 Vali Acc: 0.900 Test Loss: 0.545 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 65 cost time: 0.943927526473999
Epoch: 65, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.533 Vali Acc: 0.907 Test Loss: 0.533 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907402).  Saving model ...
Epoch: 66 cost time: 0.652280330657959
Epoch: 66, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.521 Vali Acc: 0.915 Test Loss: 0.521 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 67 cost time: 0.7897071838378906
Epoch: 67, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.510 Vali Acc: 0.915 Test Loss: 0.510 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 68 cost time: 0.8420336246490479
Epoch: 68, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.500 Vali Acc: 0.911 Test Loss: 0.500 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8635742664337158
Epoch: 69, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.489 Vali Acc: 0.915 Test Loss: 0.489 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 70 cost time: 0.5607485771179199
Epoch: 70, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.479 Vali Acc: 0.922 Test Loss: 0.479 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922217).  Saving model ...
Epoch: 71 cost time: 0.5942466259002686
Epoch: 71, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.469 Vali Acc: 0.926 Test Loss: 0.469 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 72 cost time: 0.9394340515136719
Epoch: 72, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.460 Vali Acc: 0.926 Test Loss: 0.460 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 73 cost time: 0.9016463756561279
Epoch: 73, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 74 cost time: 0.8244163990020752
Epoch: 74, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.443 Vali Acc: 0.926 Test Loss: 0.443 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 75 cost time: 0.6775965690612793
Epoch: 75, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.435 Vali Acc: 0.930 Test Loss: 0.435 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 76 cost time: 0.6560165882110596
Epoch: 76, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.427 Vali Acc: 0.930 Test Loss: 0.427 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 77 cost time: 0.5336625576019287
Epoch: 77, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.419 Vali Acc: 0.930 Test Loss: 0.419 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 78 cost time: 0.7140545845031738
Epoch: 78, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.412 Vali Acc: 0.926 Test Loss: 0.412 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.8411352634429932
Epoch: 79, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.405 Vali Acc: 0.926 Test Loss: 0.405 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.7777531147003174
Epoch: 80, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.9242691993713379
Epoch: 81, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.392 Vali Acc: 0.926 Test Loss: 0.392 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.9650108814239502
Epoch: 82, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.386 Vali Acc: 0.926 Test Loss: 0.386 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6614036560058594
Epoch: 83, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.380 Vali Acc: 0.926 Test Loss: 0.380 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.6284594535827637
Epoch: 84, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 85 cost time: 0.7557933330535889
Epoch: 85, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 86 cost time: 0.657783031463623
Epoch: 86, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.362 Vali Acc: 0.926 Test Loss: 0.362 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6752026081085205
Epoch: 87, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.8601109981536865
Epoch: 88, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.8132171630859375
Epoch: 89, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.6324954032897949
Epoch: 90, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.342 Vali Acc: 0.926 Test Loss: 0.342 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.7380537986755371
Epoch: 91, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.6198043823242188
Epoch: 92, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.5513381958007812
Epoch: 93, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.6996774673461914
Epoch: 94, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.6801023483276367
Epoch: 95, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 8597
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5988380908966064
Epoch: 1, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.586 Vali Acc: 0.478 Test Loss: 1.586 Test Acc: 0.478
Validation loss decreased (inf --> -0.477762).  Saving model ...
Epoch: 2 cost time: 0.8598134517669678
Epoch: 2, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.572 Vali Acc: 0.481 Test Loss: 1.572 Test Acc: 0.481
Validation loss decreased (-0.477762 --> -0.481466).  Saving model ...
Epoch: 3 cost time: 0.7962026596069336
Epoch: 3, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.563 Vali Acc: 0.481 Test Loss: 1.563 Test Acc: 0.481
Validation loss decreased (-0.481466 --> -0.481466).  Saving model ...
Epoch: 4 cost time: 0.7208261489868164
Epoch: 4, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.556 Vali Acc: 0.489 Test Loss: 1.556 Test Acc: 0.489
Validation loss decreased (-0.481466 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.7911896705627441
Epoch: 5, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.546 Vali Acc: 0.496 Test Loss: 1.546 Test Acc: 0.496
Validation loss decreased (-0.488873 --> -0.496281).  Saving model ...
Epoch: 6 cost time: 0.7404375076293945
Epoch: 6, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.535 Vali Acc: 0.496 Test Loss: 1.535 Test Acc: 0.496
Validation loss decreased (-0.496281 --> -0.496281).  Saving model ...
Epoch: 7 cost time: 0.6950581073760986
Epoch: 7, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.522 Vali Acc: 0.511 Test Loss: 1.522 Test Acc: 0.511
Validation loss decreased (-0.496281 --> -0.511096).  Saving model ...
Epoch: 8 cost time: 0.6390585899353027
Epoch: 8, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.508 Vali Acc: 0.511 Test Loss: 1.508 Test Acc: 0.511
Validation loss decreased (-0.511096 --> -0.511096).  Saving model ...
Epoch: 9 cost time: 0.6707959175109863
Epoch: 9, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.493 Vali Acc: 0.533 Test Loss: 1.493 Test Acc: 0.533
Validation loss decreased (-0.511096 --> -0.533318).  Saving model ...
Epoch: 10 cost time: 0.6469204425811768
Epoch: 10, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.477 Vali Acc: 0.548 Test Loss: 1.477 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548133).  Saving model ...
Epoch: 11 cost time: 0.6748077869415283
Epoch: 11, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.460 Vali Acc: 0.567 Test Loss: 1.460 Test Acc: 0.567
Validation loss decreased (-0.548133 --> -0.566652).  Saving model ...
Epoch: 12 cost time: 0.9028339385986328
Epoch: 12, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.442 Vali Acc: 0.578 Test Loss: 1.442 Test Acc: 0.578
Validation loss decreased (-0.566652 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 0.8067967891693115
Epoch: 13, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.423 Vali Acc: 0.581 Test Loss: 1.423 Test Acc: 0.581
Validation loss decreased (-0.577763 --> -0.581467).  Saving model ...
Epoch: 14 cost time: 0.5840976238250732
Epoch: 14, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.404 Vali Acc: 0.596 Test Loss: 1.404 Test Acc: 0.596
Validation loss decreased (-0.581467 --> -0.596282).  Saving model ...
Epoch: 15 cost time: 0.835925817489624
Epoch: 15, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.384 Vali Acc: 0.600 Test Loss: 1.384 Test Acc: 0.600
Validation loss decreased (-0.596282 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.7899315357208252
Epoch: 16, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.364 Vali Acc: 0.611 Test Loss: 1.364 Test Acc: 0.611
Validation loss decreased (-0.599986 --> -0.611097).  Saving model ...
Epoch: 17 cost time: 0.6818568706512451
Epoch: 17, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.344 Vali Acc: 0.615 Test Loss: 1.344 Test Acc: 0.615
Validation loss decreased (-0.611097 --> -0.614801).  Saving model ...
Epoch: 18 cost time: 0.8189699649810791
Epoch: 18, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.322 Vali Acc: 0.641 Test Loss: 1.322 Test Acc: 0.641
Validation loss decreased (-0.614801 --> -0.640728).  Saving model ...
Epoch: 19 cost time: 0.7129802703857422
Epoch: 19, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.301 Vali Acc: 0.648 Test Loss: 1.301 Test Acc: 0.648
Validation loss decreased (-0.640728 --> -0.648135).  Saving model ...
Epoch: 20 cost time: 0.769730806350708
Epoch: 20, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.279 Vali Acc: 0.663 Test Loss: 1.279 Test Acc: 0.663
Validation loss decreased (-0.648135 --> -0.662950).  Saving model ...
Epoch: 21 cost time: 0.7077763080596924
Epoch: 21, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.257 Vali Acc: 0.674 Test Loss: 1.257 Test Acc: 0.674
Validation loss decreased (-0.662950 --> -0.674062).  Saving model ...
Epoch: 22 cost time: 0.8717999458312988
Epoch: 22, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.234 Vali Acc: 0.696 Test Loss: 1.234 Test Acc: 0.696
Validation loss decreased (-0.674062 --> -0.696284).  Saving model ...
Epoch: 23 cost time: 0.8399074077606201
Epoch: 23, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.212 Vali Acc: 0.700 Test Loss: 1.212 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.6355464458465576
Epoch: 24, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.189 Vali Acc: 0.711 Test Loss: 1.189 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 25 cost time: 0.5800073146820068
Epoch: 25, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.167 Vali Acc: 0.715 Test Loss: 1.167 Test Acc: 0.715
Validation loss decreased (-0.711099 --> -0.714803).  Saving model ...
Epoch: 26 cost time: 0.6227412223815918
Epoch: 26, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.144 Vali Acc: 0.737 Test Loss: 1.144 Test Acc: 0.737
Validation loss decreased (-0.714803 --> -0.737026).  Saving model ...
Epoch: 27 cost time: 0.8946020603179932
Epoch: 27, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.121 Vali Acc: 0.744 Test Loss: 1.121 Test Acc: 0.744
Validation loss decreased (-0.737026 --> -0.744433).  Saving model ...
Epoch: 28 cost time: 0.6150972843170166
Epoch: 28, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.098 Vali Acc: 0.759 Test Loss: 1.098 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759248).  Saving model ...
Epoch: 29 cost time: 0.559481143951416
Epoch: 29, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.076 Vali Acc: 0.774 Test Loss: 1.076 Test Acc: 0.774
Validation loss decreased (-0.759248 --> -0.774063).  Saving model ...
Epoch: 30 cost time: 0.5870921611785889
Epoch: 30, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.053 Vali Acc: 0.781 Test Loss: 1.053 Test Acc: 0.781
Validation loss decreased (-0.774063 --> -0.781471).  Saving model ...
Epoch: 31 cost time: 0.7347116470336914
Epoch: 31, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.031 Vali Acc: 0.807 Test Loss: 1.031 Test Acc: 0.807
Validation loss decreased (-0.781471 --> -0.807397).  Saving model ...
Epoch: 32 cost time: 0.6788175106048584
Epoch: 32, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.008 Vali Acc: 0.819 Test Loss: 1.008 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818508).  Saving model ...
Epoch: 33 cost time: 0.6424734592437744
Epoch: 33, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.986 Vali Acc: 0.826 Test Loss: 0.986 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825916).  Saving model ...
Epoch: 34 cost time: 0.6143331527709961
Epoch: 34, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.964 Vali Acc: 0.830 Test Loss: 0.964 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829620).  Saving model ...
Epoch: 35 cost time: 0.6212539672851562
Epoch: 35, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.943 Vali Acc: 0.833 Test Loss: 0.943 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 36 cost time: 0.9753856658935547
Epoch: 36, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844435).  Saving model ...
Epoch: 37 cost time: 0.9207255840301514
Epoch: 37, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.900 Vali Acc: 0.848 Test Loss: 0.900 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848139).  Saving model ...
Epoch: 38 cost time: 0.7656712532043457
Epoch: 38, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.880 Vali Acc: 0.859 Test Loss: 0.880 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859250).  Saving model ...
Epoch: 39 cost time: 0.6462187767028809
Epoch: 39, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.859 Vali Acc: 0.870 Test Loss: 0.859 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 40 cost time: 0.6138472557067871
Epoch: 40, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.840 Vali Acc: 0.881 Test Loss: 0.840 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881473).  Saving model ...
Epoch: 41 cost time: 0.7783715724945068
Epoch: 41, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.820 Vali Acc: 0.881 Test Loss: 0.820 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 42 cost time: 0.7484583854675293
Epoch: 42, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.801 Vali Acc: 0.885 Test Loss: 0.801 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885177).  Saving model ...
Epoch: 43 cost time: 0.729297399520874
Epoch: 43, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.782 Vali Acc: 0.893 Test Loss: 0.782 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 44 cost time: 0.7095439434051514
Epoch: 44, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.764 Vali Acc: 0.893 Test Loss: 0.764 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 45 cost time: 0.782893180847168
Epoch: 45, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.746 Vali Acc: 0.896 Test Loss: 0.746 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 46 cost time: 0.7740733623504639
Epoch: 46, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.729 Vali Acc: 0.904 Test Loss: 0.729 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903696).  Saving model ...
Epoch: 47 cost time: 0.8211162090301514
Epoch: 47, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.712 Vali Acc: 0.904 Test Loss: 0.712 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 48 cost time: 0.6328651905059814
Epoch: 48, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.695 Vali Acc: 0.907 Test Loss: 0.695 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907400).  Saving model ...
Epoch: 49 cost time: 0.8781957626342773
Epoch: 49, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.679 Vali Acc: 0.904 Test Loss: 0.679 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6837382316589355
Epoch: 50, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.664 Vali Acc: 0.907 Test Loss: 0.664 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 51 cost time: 0.598717212677002
Epoch: 51, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.649 Vali Acc: 0.907 Test Loss: 0.649 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 52 cost time: 0.61376953125
Epoch: 52, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.634 Vali Acc: 0.907 Test Loss: 0.634 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 53 cost time: 0.5783462524414062
Epoch: 53, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.620 Vali Acc: 0.911 Test Loss: 0.620 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 54 cost time: 0.638909101486206
Epoch: 54, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.606 Vali Acc: 0.915 Test Loss: 0.606 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 55 cost time: 0.8372635841369629
Epoch: 55, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.593 Vali Acc: 0.915 Test Loss: 0.593 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 56 cost time: 0.8105294704437256
Epoch: 56, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.580 Vali Acc: 0.915 Test Loss: 0.580 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 57 cost time: 0.9730052947998047
Epoch: 57, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.568 Vali Acc: 0.915 Test Loss: 0.568 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 58 cost time: 0.8007309436798096
Epoch: 58, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.556 Vali Acc: 0.915 Test Loss: 0.556 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 59 cost time: 0.9131522178649902
Epoch: 59, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.544 Vali Acc: 0.915 Test Loss: 0.544 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 60 cost time: 0.5777957439422607
Epoch: 60, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.533 Vali Acc: 0.922 Test Loss: 0.533 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 61 cost time: 0.7269165515899658
Epoch: 61, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.522 Vali Acc: 0.922 Test Loss: 0.522 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 62 cost time: 0.6823248863220215
Epoch: 62, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.512 Vali Acc: 0.922 Test Loss: 0.512 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 63 cost time: 0.6284849643707275
Epoch: 63, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.502 Vali Acc: 0.922 Test Loss: 0.502 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 64 cost time: 0.7932231426239014
Epoch: 64, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.492 Vali Acc: 0.922 Test Loss: 0.492 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 65 cost time: 0.6284115314483643
Epoch: 65, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 66 cost time: 0.6800632476806641
Epoch: 66, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.473 Vali Acc: 0.922 Test Loss: 0.473 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 67 cost time: 0.6658828258514404
Epoch: 67, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.464 Vali Acc: 0.919 Test Loss: 0.464 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6413121223449707
Epoch: 68, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5949528217315674
Epoch: 69, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.448 Vali Acc: 0.915 Test Loss: 0.448 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6742281913757324
Epoch: 70, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.439 Vali Acc: 0.915 Test Loss: 0.439 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.8096530437469482
Epoch: 71, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.432 Vali Acc: 0.915 Test Loss: 0.432 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.7384428977966309
Epoch: 72, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7673158645629883
Epoch: 73, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.417 Vali Acc: 0.915 Test Loss: 0.417 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5851209163665771
Epoch: 74, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.410 Vali Acc: 0.915 Test Loss: 0.410 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.5985562801361084
Epoch: 75, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6622271537780762
Epoch: 76, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 8624
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8735237121582031
Epoch: 1, Steps: 2 | Train Loss: 2.033 Vali Loss: 2.022 Vali Acc: 0.011 Test Loss: 2.022 Test Acc: 0.011
Validation loss decreased (inf --> -0.011091).  Saving model ...
Epoch: 2 cost time: 0.5999510288238525
Epoch: 2, Steps: 2 | Train Loss: 2.009 Vali Loss: 2.001 Vali Acc: 0.015 Test Loss: 2.001 Test Acc: 0.015
Validation loss decreased (-0.011091 --> -0.014795).  Saving model ...
Epoch: 3 cost time: 0.7905149459838867
Epoch: 3, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.987 Vali Acc: 0.019 Test Loss: 1.987 Test Acc: 0.019
Validation loss decreased (-0.014795 --> -0.018499).  Saving model ...
Epoch: 4 cost time: 0.525752067565918
Epoch: 4, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.977 Vali Acc: 0.026 Test Loss: 1.977 Test Acc: 0.026
Validation loss decreased (-0.018499 --> -0.025906).  Saving model ...
Epoch: 5 cost time: 0.9464626312255859
Epoch: 5, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.965 Vali Acc: 0.026 Test Loss: 1.965 Test Acc: 0.026
Validation loss decreased (-0.025906 --> -0.025906).  Saving model ...
Epoch: 6 cost time: 0.6272852420806885
Epoch: 6, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.951 Vali Acc: 0.041 Test Loss: 1.951 Test Acc: 0.041
Validation loss decreased (-0.025906 --> -0.040721).  Saving model ...
Epoch: 7 cost time: 0.6314404010772705
Epoch: 7, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.935 Vali Acc: 0.052 Test Loss: 1.935 Test Acc: 0.052
Validation loss decreased (-0.040721 --> -0.051832).  Saving model ...
Epoch: 8 cost time: 0.6402580738067627
Epoch: 8, Steps: 2 | Train Loss: 1.908 Vali Loss: 1.918 Vali Acc: 0.067 Test Loss: 1.918 Test Acc: 0.067
Validation loss decreased (-0.051832 --> -0.066647).  Saving model ...
Epoch: 9 cost time: 0.5568876266479492
Epoch: 9, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.899 Vali Acc: 0.104 Test Loss: 1.899 Test Acc: 0.104
Validation loss decreased (-0.066647 --> -0.103685).  Saving model ...
Epoch: 10 cost time: 0.6221075057983398
Epoch: 10, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.878 Vali Acc: 0.126 Test Loss: 1.878 Test Acc: 0.126
Validation loss decreased (-0.103685 --> -0.125907).  Saving model ...
Epoch: 11 cost time: 0.59873366355896
Epoch: 11, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.857 Vali Acc: 0.148 Test Loss: 1.857 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 12 cost time: 0.6850810050964355
Epoch: 12, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.835 Vali Acc: 0.178 Test Loss: 1.835 Test Acc: 0.178
Validation loss decreased (-0.148130 --> -0.177759).  Saving model ...
Epoch: 13 cost time: 0.67574143409729
Epoch: 13, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.812 Vali Acc: 0.211 Test Loss: 1.812 Test Acc: 0.211
Validation loss decreased (-0.177759 --> -0.211093).  Saving model ...
Epoch: 14 cost time: 0.9311137199401855
Epoch: 14, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.788 Vali Acc: 0.244 Test Loss: 1.788 Test Acc: 0.244
Validation loss decreased (-0.211093 --> -0.244427).  Saving model ...
Epoch: 15 cost time: 0.7077271938323975
Epoch: 15, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.764 Vali Acc: 0.270 Test Loss: 1.764 Test Acc: 0.270
Validation loss decreased (-0.244427 --> -0.270353).  Saving model ...
Epoch: 16 cost time: 0.7155301570892334
Epoch: 16, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.739 Vali Acc: 0.307 Test Loss: 1.739 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 17 cost time: 0.7063169479370117
Epoch: 17, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.714 Vali Acc: 0.359 Test Loss: 1.714 Test Acc: 0.359
Validation loss decreased (-0.307390 --> -0.359242).  Saving model ...
Epoch: 18 cost time: 0.593897819519043
Epoch: 18, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.688 Vali Acc: 0.393 Test Loss: 1.688 Test Acc: 0.393
Validation loss decreased (-0.359242 --> -0.392576).  Saving model ...
Epoch: 19 cost time: 0.6524415016174316
Epoch: 19, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.662 Vali Acc: 0.419 Test Loss: 1.662 Test Acc: 0.419
Validation loss decreased (-0.392576 --> -0.418502).  Saving model ...
Epoch: 20 cost time: 0.5879590511322021
Epoch: 20, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.635 Vali Acc: 0.444 Test Loss: 1.635 Test Acc: 0.444
Validation loss decreased (-0.418502 --> -0.444428).  Saving model ...
Epoch: 21 cost time: 0.48746657371520996
Epoch: 21, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.609 Vali Acc: 0.463 Test Loss: 1.609 Test Acc: 0.463
Validation loss decreased (-0.444428 --> -0.462947).  Saving model ...
Epoch: 22 cost time: 0.6360297203063965
Epoch: 22, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.582 Vali Acc: 0.474 Test Loss: 1.582 Test Acc: 0.474
Validation loss decreased (-0.462947 --> -0.474058).  Saving model ...
Epoch: 23 cost time: 0.6875853538513184
Epoch: 23, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.555 Vali Acc: 0.478 Test Loss: 1.555 Test Acc: 0.478
Validation loss decreased (-0.474058 --> -0.477762).  Saving model ...
Epoch: 24 cost time: 0.6376943588256836
Epoch: 24, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.528 Vali Acc: 0.493 Test Loss: 1.528 Test Acc: 0.493
Validation loss decreased (-0.477762 --> -0.492577).  Saving model ...
Epoch: 25 cost time: 0.7092783451080322
Epoch: 25, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.500 Vali Acc: 0.515 Test Loss: 1.500 Test Acc: 0.515
Validation loss decreased (-0.492577 --> -0.514800).  Saving model ...
Epoch: 26 cost time: 0.5328667163848877
Epoch: 26, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.473 Vali Acc: 0.530 Test Loss: 1.473 Test Acc: 0.530
Validation loss decreased (-0.514800 --> -0.529615).  Saving model ...
Epoch: 27 cost time: 0.6640350818634033
Epoch: 27, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.446 Vali Acc: 0.556 Test Loss: 1.446 Test Acc: 0.556
Validation loss decreased (-0.529615 --> -0.555541).  Saving model ...
Epoch: 28 cost time: 0.7383489608764648
Epoch: 28, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.419 Vali Acc: 0.570 Test Loss: 1.419 Test Acc: 0.570
Validation loss decreased (-0.555541 --> -0.570356).  Saving model ...
Epoch: 29 cost time: 0.7008380889892578
Epoch: 29, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.391 Vali Acc: 0.604 Test Loss: 1.391 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603690).  Saving model ...
Epoch: 30 cost time: 0.5725688934326172
Epoch: 30, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.364 Vali Acc: 0.626 Test Loss: 1.364 Test Acc: 0.626
Validation loss decreased (-0.603690 --> -0.625912).  Saving model ...
Epoch: 31 cost time: 0.7127680778503418
Epoch: 31, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.337 Vali Acc: 0.637 Test Loss: 1.337 Test Acc: 0.637
Validation loss decreased (-0.625912 --> -0.637024).  Saving model ...
Epoch: 32 cost time: 0.7534501552581787
Epoch: 32, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.309 Vali Acc: 0.641 Test Loss: 1.309 Test Acc: 0.641
Validation loss decreased (-0.637024 --> -0.640728).  Saving model ...
Epoch: 33 cost time: 0.8030586242675781
Epoch: 33, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.282 Vali Acc: 0.641 Test Loss: 1.282 Test Acc: 0.641
Validation loss decreased (-0.640728 --> -0.640728).  Saving model ...
Epoch: 34 cost time: 0.8342080116271973
Epoch: 34, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.255 Vali Acc: 0.667 Test Loss: 1.255 Test Acc: 0.667
Validation loss decreased (-0.640728 --> -0.666654).  Saving model ...
Epoch: 35 cost time: 0.7716107368469238
Epoch: 35, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.228 Vali Acc: 0.700 Test Loss: 1.228 Test Acc: 0.700
Validation loss decreased (-0.666654 --> -0.699988).  Saving model ...
Epoch: 36 cost time: 0.605950117111206
Epoch: 36, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.201 Vali Acc: 0.711 Test Loss: 1.201 Test Acc: 0.711
Validation loss decreased (-0.699988 --> -0.711099).  Saving model ...
Epoch: 37 cost time: 0.7503852844238281
Epoch: 37, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.175 Vali Acc: 0.722 Test Loss: 1.175 Test Acc: 0.722
Validation loss decreased (-0.711099 --> -0.722210).  Saving model ...
Epoch: 38 cost time: 0.7952165603637695
Epoch: 38, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.148 Vali Acc: 0.733 Test Loss: 1.148 Test Acc: 0.733
Validation loss decreased (-0.722210 --> -0.733322).  Saving model ...
Epoch: 39 cost time: 0.871788501739502
Epoch: 39, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.122 Vali Acc: 0.748 Test Loss: 1.122 Test Acc: 0.748
Validation loss decreased (-0.733322 --> -0.748137).  Saving model ...
Epoch: 40 cost time: 0.8883323669433594
Epoch: 40, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.096 Vali Acc: 0.748 Test Loss: 1.096 Test Acc: 0.748
Validation loss decreased (-0.748137 --> -0.748137).  Saving model ...
Epoch: 41 cost time: 0.6169476509094238
Epoch: 41, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.070 Vali Acc: 0.752 Test Loss: 1.070 Test Acc: 0.752
Validation loss decreased (-0.748137 --> -0.751841).  Saving model ...
Epoch: 42 cost time: 0.7274312973022461
Epoch: 42, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.045 Vali Acc: 0.770 Test Loss: 1.045 Test Acc: 0.770
Validation loss decreased (-0.751841 --> -0.770360).  Saving model ...
Epoch: 43 cost time: 0.8972268104553223
Epoch: 43, Steps: 2 | Train Loss: 0.882 Vali Loss: 1.020 Vali Acc: 0.781 Test Loss: 1.020 Test Acc: 0.781
Validation loss decreased (-0.770360 --> -0.781471).  Saving model ...
Epoch: 44 cost time: 0.7005581855773926
Epoch: 44, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.995 Vali Acc: 0.796 Test Loss: 0.995 Test Acc: 0.796
Validation loss decreased (-0.781471 --> -0.796286).  Saving model ...
Epoch: 45 cost time: 0.5948364734649658
Epoch: 45, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.971 Vali Acc: 0.804 Test Loss: 0.971 Test Acc: 0.804
Validation loss decreased (-0.796286 --> -0.803694).  Saving model ...
Epoch: 46 cost time: 0.7748105525970459
Epoch: 46, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.947 Vali Acc: 0.811 Test Loss: 0.947 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811102).  Saving model ...
Epoch: 47 cost time: 0.6712372303009033
Epoch: 47, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.924 Vali Acc: 0.819 Test Loss: 0.924 Test Acc: 0.819
Validation loss decreased (-0.811102 --> -0.818509).  Saving model ...
Epoch: 48 cost time: 0.6302101612091064
Epoch: 48, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.901 Vali Acc: 0.819 Test Loss: 0.901 Test Acc: 0.819
Validation loss decreased (-0.818509 --> -0.818510).  Saving model ...
Epoch: 49 cost time: 1.0555293560028076
Epoch: 49, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.879 Vali Acc: 0.830 Test Loss: 0.879 Test Acc: 0.830
Validation loss decreased (-0.818510 --> -0.829621).  Saving model ...
Epoch: 50 cost time: 0.7305798530578613
Epoch: 50, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.858 Vali Acc: 0.830 Test Loss: 0.858 Test Acc: 0.830
Validation loss decreased (-0.829621 --> -0.829621).  Saving model ...
Epoch: 51 cost time: 0.821251630783081
Epoch: 51, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.836 Vali Acc: 0.844 Test Loss: 0.836 Test Acc: 0.844
Validation loss decreased (-0.829621 --> -0.844436).  Saving model ...
Epoch: 52 cost time: 0.4934401512145996
Epoch: 52, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 53 cost time: 0.6880977153778076
Epoch: 53, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.795 Vali Acc: 0.859 Test Loss: 0.795 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 54 cost time: 1.0744869709014893
Epoch: 54, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.776 Vali Acc: 0.863 Test Loss: 0.776 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 55 cost time: 0.5348539352416992
Epoch: 55, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.757 Vali Acc: 0.863 Test Loss: 0.757 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862955).  Saving model ...
Epoch: 56 cost time: 0.7591428756713867
Epoch: 56, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.739 Vali Acc: 0.863 Test Loss: 0.739 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 57 cost time: 0.7590296268463135
Epoch: 57, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.721 Vali Acc: 0.870 Test Loss: 0.721 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870363).  Saving model ...
Epoch: 58 cost time: 0.7740306854248047
Epoch: 58, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.703 Vali Acc: 0.870 Test Loss: 0.703 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
Epoch: 59 cost time: 0.6984665393829346
Epoch: 59, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.686 Vali Acc: 0.870 Test Loss: 0.686 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870364).  Saving model ...
Epoch: 60 cost time: 0.7497880458831787
Epoch: 60, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.670 Vali Acc: 0.874 Test Loss: 0.670 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874067).  Saving model ...
Epoch: 61 cost time: 0.8220012187957764
Epoch: 61, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.655 Vali Acc: 0.878 Test Loss: 0.655 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 62 cost time: 0.6827378273010254
Epoch: 62, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.640 Vali Acc: 0.878 Test Loss: 0.640 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 63 cost time: 0.6813826560974121
Epoch: 63, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.625 Vali Acc: 0.878 Test Loss: 0.625 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 64 cost time: 0.7033810615539551
Epoch: 64, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.611 Vali Acc: 0.878 Test Loss: 0.611 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 65 cost time: 0.5419478416442871
Epoch: 65, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.597 Vali Acc: 0.885 Test Loss: 0.597 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885179).  Saving model ...
Epoch: 66 cost time: 0.7719631195068359
Epoch: 66, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.584 Vali Acc: 0.885 Test Loss: 0.584 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 67 cost time: 0.6433727741241455
Epoch: 67, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.572 Vali Acc: 0.885 Test Loss: 0.572 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 68 cost time: 0.5753059387207031
Epoch: 68, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 69 cost time: 0.619959831237793
Epoch: 69, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.548 Vali Acc: 0.889 Test Loss: 0.548 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 70 cost time: 0.6595525741577148
Epoch: 70, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.536 Vali Acc: 0.889 Test Loss: 0.536 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 71 cost time: 0.6271746158599854
Epoch: 71, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 72 cost time: 0.6589481830596924
Epoch: 72, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 73 cost time: 0.6980879306793213
Epoch: 73, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.505 Vali Acc: 0.893 Test Loss: 0.505 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 74 cost time: 0.7218289375305176
Epoch: 74, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.495 Vali Acc: 0.893 Test Loss: 0.495 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 75 cost time: 0.6884431838989258
Epoch: 75, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.486 Vali Acc: 0.893 Test Loss: 0.486 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 76 cost time: 0.7388749122619629
Epoch: 76, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.477 Vali Acc: 0.893 Test Loss: 0.477 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 77 cost time: 0.7102463245391846
Epoch: 77, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.468 Vali Acc: 0.893 Test Loss: 0.468 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 78 cost time: 0.8084568977355957
Epoch: 78, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7310636043548584
Epoch: 79, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.452 Vali Acc: 0.885 Test Loss: 0.452 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.5116941928863525
Epoch: 80, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.445 Vali Acc: 0.885 Test Loss: 0.445 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.7410943508148193
Epoch: 81, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.437 Vali Acc: 0.885 Test Loss: 0.437 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.6920299530029297
Epoch: 82, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.430 Vali Acc: 0.885 Test Loss: 0.430 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7630894184112549
Epoch: 83, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.424 Vali Acc: 0.885 Test Loss: 0.424 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.8768041133880615
Epoch: 84, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.417 Vali Acc: 0.885 Test Loss: 0.417 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6088175773620605
Epoch: 85, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.411 Vali Acc: 0.885 Test Loss: 0.411 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.6859719753265381
Epoch: 86, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.405 Vali Acc: 0.885 Test Loss: 0.405 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6414949893951416
Epoch: 87, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.400 Vali Acc: 0.885 Test Loss: 0.400 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 8882
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2483441829681396
Epoch: 1, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.877 Vali Acc: 0.044 Test Loss: 1.877 Test Acc: 0.044
Validation loss decreased (inf --> -0.044426).  Saving model ...
Epoch: 2 cost time: 0.5845131874084473
Epoch: 2, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.859 Vali Acc: 0.056 Test Loss: 1.859 Test Acc: 0.056
Validation loss decreased (-0.044426 --> -0.055537).  Saving model ...
Epoch: 3 cost time: 0.6710152626037598
Epoch: 3, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.847 Vali Acc: 0.059 Test Loss: 1.847 Test Acc: 0.059
Validation loss decreased (-0.055537 --> -0.059241).  Saving model ...
Epoch: 4 cost time: 0.7458398342132568
Epoch: 4, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.838 Vali Acc: 0.063 Test Loss: 1.838 Test Acc: 0.063
Validation loss decreased (-0.059241 --> -0.062945).  Saving model ...
Epoch: 5 cost time: 0.6673927307128906
Epoch: 5, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.827 Vali Acc: 0.078 Test Loss: 1.827 Test Acc: 0.078
Validation loss decreased (-0.062945 --> -0.077760).  Saving model ...
Epoch: 6 cost time: 0.8499212265014648
Epoch: 6, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.815 Vali Acc: 0.089 Test Loss: 1.815 Test Acc: 0.089
Validation loss decreased (-0.077760 --> -0.088871).  Saving model ...
Epoch: 7 cost time: 0.6702384948730469
Epoch: 7, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.801 Vali Acc: 0.089 Test Loss: 1.801 Test Acc: 0.089
Validation loss decreased (-0.088871 --> -0.088871).  Saving model ...
Epoch: 8 cost time: 0.7015175819396973
Epoch: 8, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.785 Vali Acc: 0.107 Test Loss: 1.785 Test Acc: 0.107
Validation loss decreased (-0.088871 --> -0.107390).  Saving model ...
Epoch: 9 cost time: 0.7845723628997803
Epoch: 9, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.768 Vali Acc: 0.133 Test Loss: 1.768 Test Acc: 0.133
Validation loss decreased (-0.107390 --> -0.133316).  Saving model ...
Epoch: 10 cost time: 0.6560132503509521
Epoch: 10, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.750 Vali Acc: 0.167 Test Loss: 1.750 Test Acc: 0.167
Validation loss decreased (-0.133316 --> -0.166649).  Saving model ...
Epoch: 11 cost time: 0.7507636547088623
Epoch: 11, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.730 Vali Acc: 0.185 Test Loss: 1.730 Test Acc: 0.185
Validation loss decreased (-0.166649 --> -0.185168).  Saving model ...
Epoch: 12 cost time: 0.6844377517700195
Epoch: 12, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.710 Vali Acc: 0.215 Test Loss: 1.710 Test Acc: 0.215
Validation loss decreased (-0.185168 --> -0.214798).  Saving model ...
Epoch: 13 cost time: 0.6096572875976562
Epoch: 13, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.689 Vali Acc: 0.241 Test Loss: 1.689 Test Acc: 0.241
Validation loss decreased (-0.214798 --> -0.240724).  Saving model ...
Epoch: 14 cost time: 0.5173592567443848
Epoch: 14, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.667 Vali Acc: 0.270 Test Loss: 1.667 Test Acc: 0.270
Validation loss decreased (-0.240724 --> -0.270354).  Saving model ...
Epoch: 15 cost time: 0.8038952350616455
Epoch: 15, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.645 Vali Acc: 0.304 Test Loss: 1.645 Test Acc: 0.304
Validation loss decreased (-0.270354 --> -0.303687).  Saving model ...
Epoch: 16 cost time: 0.6079103946685791
Epoch: 16, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.621 Vali Acc: 0.348 Test Loss: 1.621 Test Acc: 0.348
Validation loss decreased (-0.303687 --> -0.348132).  Saving model ...
Epoch: 17 cost time: 0.7548506259918213
Epoch: 17, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.597 Vali Acc: 0.389 Test Loss: 1.597 Test Acc: 0.389
Validation loss decreased (-0.348132 --> -0.388873).  Saving model ...
Epoch: 18 cost time: 0.6689591407775879
Epoch: 18, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.573 Vali Acc: 0.419 Test Loss: 1.573 Test Acc: 0.419
Validation loss decreased (-0.388873 --> -0.418503).  Saving model ...
Epoch: 19 cost time: 0.6558828353881836
Epoch: 19, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.549 Vali Acc: 0.448 Test Loss: 1.549 Test Acc: 0.448
Validation loss decreased (-0.418503 --> -0.448133).  Saving model ...
Epoch: 20 cost time: 0.6346099376678467
Epoch: 20, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.524 Vali Acc: 0.485 Test Loss: 1.524 Test Acc: 0.485
Validation loss decreased (-0.448133 --> -0.485170).  Saving model ...
Epoch: 21 cost time: 0.929511308670044
Epoch: 21, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.498 Vali Acc: 0.507 Test Loss: 1.498 Test Acc: 0.507
Validation loss decreased (-0.485170 --> -0.507392).  Saving model ...
Epoch: 22 cost time: 0.7237441539764404
Epoch: 22, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.473 Vali Acc: 0.537 Test Loss: 1.473 Test Acc: 0.537
Validation loss decreased (-0.507392 --> -0.537022).  Saving model ...
Epoch: 23 cost time: 0.7853107452392578
Epoch: 23, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.447 Vali Acc: 0.567 Test Loss: 1.447 Test Acc: 0.567
Validation loss decreased (-0.537022 --> -0.566652).  Saving model ...
Epoch: 24 cost time: 0.6732518672943115
Epoch: 24, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.421 Vali Acc: 0.581 Test Loss: 1.421 Test Acc: 0.581
Validation loss decreased (-0.566652 --> -0.581467).  Saving model ...
Epoch: 25 cost time: 0.7716920375823975
Epoch: 25, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.395 Vali Acc: 0.615 Test Loss: 1.395 Test Acc: 0.615
Validation loss decreased (-0.581467 --> -0.614801).  Saving model ...
Epoch: 26 cost time: 0.6794230937957764
Epoch: 26, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.368 Vali Acc: 0.652 Test Loss: 1.368 Test Acc: 0.652
Validation loss decreased (-0.614801 --> -0.651838).  Saving model ...
Epoch: 27 cost time: 0.6086914539337158
Epoch: 27, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.341 Vali Acc: 0.663 Test Loss: 1.341 Test Acc: 0.663
Validation loss decreased (-0.651838 --> -0.662950).  Saving model ...
Epoch: 28 cost time: 0.9421021938323975
Epoch: 28, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.315 Vali Acc: 0.696 Test Loss: 1.315 Test Acc: 0.696
Validation loss decreased (-0.662950 --> -0.696283).  Saving model ...
Epoch: 29 cost time: 0.7001705169677734
Epoch: 29, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.288 Vali Acc: 0.704 Test Loss: 1.288 Test Acc: 0.704
Validation loss decreased (-0.696283 --> -0.703691).  Saving model ...
Epoch: 30 cost time: 0.8248472213745117
Epoch: 30, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.262 Vali Acc: 0.719 Test Loss: 1.262 Test Acc: 0.719
Validation loss decreased (-0.703691 --> -0.718506).  Saving model ...
Epoch: 31 cost time: 0.6618053913116455
Epoch: 31, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.235 Vali Acc: 0.737 Test Loss: 1.235 Test Acc: 0.737
Validation loss decreased (-0.718506 --> -0.737025).  Saving model ...
Epoch: 32 cost time: 0.5789430141448975
Epoch: 32, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.209 Vali Acc: 0.763 Test Loss: 1.209 Test Acc: 0.763
Validation loss decreased (-0.737025 --> -0.762951).  Saving model ...
Epoch: 33 cost time: 0.6581859588623047
Epoch: 33, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.182 Vali Acc: 0.767 Test Loss: 1.182 Test Acc: 0.767
Validation loss decreased (-0.762951 --> -0.766655).  Saving model ...
Epoch: 34 cost time: 0.6647541522979736
Epoch: 34, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.156 Vali Acc: 0.781 Test Loss: 1.156 Test Acc: 0.781
Validation loss decreased (-0.766655 --> -0.781470).  Saving model ...
Epoch: 35 cost time: 0.7012677192687988
Epoch: 35, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.130 Vali Acc: 0.785 Test Loss: 1.130 Test Acc: 0.785
Validation loss decreased (-0.781470 --> -0.785174).  Saving model ...
Epoch: 36 cost time: 0.8686494827270508
Epoch: 36, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.104 Vali Acc: 0.796 Test Loss: 1.104 Test Acc: 0.796
Validation loss decreased (-0.785174 --> -0.796285).  Saving model ...
Epoch: 37 cost time: 0.7640104293823242
Epoch: 37, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.078 Vali Acc: 0.819 Test Loss: 1.078 Test Acc: 0.819
Validation loss decreased (-0.796285 --> -0.818508).  Saving model ...
Epoch: 38 cost time: 0.7267441749572754
Epoch: 38, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.053 Vali Acc: 0.826 Test Loss: 1.053 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825915).  Saving model ...
Epoch: 39 cost time: 0.6329174041748047
Epoch: 39, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.028 Vali Acc: 0.830 Test Loss: 1.028 Test Acc: 0.830
Validation loss decreased (-0.825915 --> -0.829619).  Saving model ...
Epoch: 40 cost time: 0.6818990707397461
Epoch: 40, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.003 Vali Acc: 0.841 Test Loss: 1.003 Test Acc: 0.841
Validation loss decreased (-0.829619 --> -0.840731).  Saving model ...
Epoch: 41 cost time: 0.7457270622253418
Epoch: 41, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.979 Vali Acc: 0.844 Test Loss: 0.979 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 42 cost time: 0.6884574890136719
Epoch: 42, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.955 Vali Acc: 0.844 Test Loss: 0.955 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844435).  Saving model ...
Epoch: 43 cost time: 0.6981801986694336
Epoch: 43, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.931 Vali Acc: 0.856 Test Loss: 0.931 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855546).  Saving model ...
Epoch: 44 cost time: 0.7376680374145508
Epoch: 44, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.908 Vali Acc: 0.859 Test Loss: 0.908 Test Acc: 0.859
Validation loss decreased (-0.855546 --> -0.859250).  Saving model ...
Epoch: 45 cost time: 0.8242335319519043
Epoch: 45, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.885 Vali Acc: 0.859 Test Loss: 0.885 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859250).  Saving model ...
Epoch: 46 cost time: 0.6581876277923584
Epoch: 46, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7376561164855957
Epoch: 47, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.841 Vali Acc: 0.859 Test Loss: 0.841 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859251).  Saving model ...
Epoch: 48 cost time: 0.5813734531402588
Epoch: 48, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.820 Vali Acc: 0.863 Test Loss: 0.820 Test Acc: 0.863
Validation loss decreased (-0.859251 --> -0.862955).  Saving model ...
Epoch: 49 cost time: 0.5876257419586182
Epoch: 49, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.799 Vali Acc: 0.870 Test Loss: 0.799 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870362).  Saving model ...
Epoch: 50 cost time: 0.6083405017852783
Epoch: 50, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.779 Vali Acc: 0.870 Test Loss: 0.779 Test Acc: 0.870
Validation loss decreased (-0.870362 --> -0.870363).  Saving model ...
Epoch: 51 cost time: 0.5436570644378662
Epoch: 51, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.760 Vali Acc: 0.870 Test Loss: 0.760 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
Epoch: 52 cost time: 0.6348116397857666
Epoch: 52, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.741 Vali Acc: 0.878 Test Loss: 0.741 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877770).  Saving model ...
Epoch: 53 cost time: 0.6764087677001953
Epoch: 53, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.723 Vali Acc: 0.881 Test Loss: 0.723 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 54 cost time: 0.5554695129394531
Epoch: 54, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.704 Vali Acc: 0.881 Test Loss: 0.704 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881474).  Saving model ...
Epoch: 55 cost time: 0.7554895877838135
Epoch: 55, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.687 Vali Acc: 0.893 Test Loss: 0.687 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 56 cost time: 0.6269130706787109
Epoch: 56, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.670 Vali Acc: 0.893 Test Loss: 0.670 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 57 cost time: 0.7767093181610107
Epoch: 57, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.654 Vali Acc: 0.896 Test Loss: 0.654 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 58 cost time: 0.7869110107421875
Epoch: 58, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.638 Vali Acc: 0.896 Test Loss: 0.638 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 59 cost time: 0.8744051456451416
Epoch: 59, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.623 Vali Acc: 0.896 Test Loss: 0.623 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 60 cost time: 0.6049423217773438
Epoch: 60, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.609 Vali Acc: 0.896 Test Loss: 0.609 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 61 cost time: 0.669518232345581
Epoch: 61, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.594 Vali Acc: 0.896 Test Loss: 0.594 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 62 cost time: 0.643064022064209
Epoch: 62, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.581 Vali Acc: 0.896 Test Loss: 0.581 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 63 cost time: 0.7818107604980469
Epoch: 63, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.567 Vali Acc: 0.904 Test Loss: 0.567 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 64 cost time: 0.7442336082458496
Epoch: 64, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.555 Vali Acc: 0.904 Test Loss: 0.555 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 65 cost time: 0.6496822834014893
Epoch: 65, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.543 Vali Acc: 0.904 Test Loss: 0.543 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 66 cost time: 0.8170335292816162
Epoch: 66, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.870659351348877
Epoch: 67, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6016013622283936
Epoch: 68, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.564253568649292
Epoch: 69, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.499 Vali Acc: 0.900 Test Loss: 0.499 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.6901094913482666
Epoch: 70, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.6788294315338135
Epoch: 71, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.479 Vali Acc: 0.904 Test Loss: 0.479 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 72 cost time: 0.7884259223937988
Epoch: 72, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.469 Vali Acc: 0.904 Test Loss: 0.469 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 73 cost time: 0.5409491062164307
Epoch: 73, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.460 Vali Acc: 0.907 Test Loss: 0.460 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 74 cost time: 0.7251200675964355
Epoch: 74, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 75 cost time: 0.6235191822052002
Epoch: 75, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.444 Vali Acc: 0.907 Test Loss: 0.444 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 76 cost time: 0.5603089332580566
Epoch: 76, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.436 Vali Acc: 0.907 Test Loss: 0.436 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 77 cost time: 0.6512773036956787
Epoch: 77, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6092734336853027
Epoch: 78, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6560516357421875
Epoch: 79, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.496931791305542
Epoch: 80, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.406 Vali Acc: 0.904 Test Loss: 0.406 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.5780515670776367
Epoch: 81, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.400 Vali Acc: 0.904 Test Loss: 0.400 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 82 cost time: 0.5635471343994141
Epoch: 82, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.393 Vali Acc: 0.904 Test Loss: 0.393 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 83 cost time: 0.5308077335357666
Epoch: 83, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 84 cost time: 0.5146865844726562
Epoch: 84, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.381 Vali Acc: 0.904 Test Loss: 0.381 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 85 cost time: 0.6475160121917725
Epoch: 85, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.375 Vali Acc: 0.904 Test Loss: 0.375 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 86 cost time: 0.5630125999450684
Epoch: 86, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 9014
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1183717250823975
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.805 Vali Acc: 0.196 Test Loss: 1.805 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.8163590431213379
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.790 Vali Acc: 0.211 Test Loss: 1.790 Test Acc: 0.211
Validation loss decreased (-0.196278 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.5691094398498535
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.780 Vali Acc: 0.222 Test Loss: 1.780 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.78729248046875
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.772 Vali Acc: 0.233 Test Loss: 1.772 Test Acc: 0.233
Validation loss decreased (-0.222204 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 0.9362280368804932
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.762 Vali Acc: 0.237 Test Loss: 1.762 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237019).  Saving model ...
Epoch: 6 cost time: 0.8157460689544678
Epoch: 6, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.751 Vali Acc: 0.248 Test Loss: 1.751 Test Acc: 0.248
Validation loss decreased (-0.237019 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 0.9010930061340332
Epoch: 7, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.737 Vali Acc: 0.256 Test Loss: 1.737 Test Acc: 0.256
Validation loss decreased (-0.248131 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.748058557510376
Epoch: 8, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.723 Vali Acc: 0.270 Test Loss: 1.723 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 9 cost time: 0.6521599292755127
Epoch: 9, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.707 Vali Acc: 0.278 Test Loss: 1.707 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277761).  Saving model ...
Epoch: 10 cost time: 0.8926761150360107
Epoch: 10, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.689 Vali Acc: 0.289 Test Loss: 1.689 Test Acc: 0.289
Validation loss decreased (-0.277761 --> -0.288872).  Saving model ...
Epoch: 11 cost time: 1.072481393814087
Epoch: 11, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.671 Vali Acc: 0.311 Test Loss: 1.671 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.9070553779602051
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.652 Vali Acc: 0.322 Test Loss: 1.652 Test Acc: 0.322
Validation loss decreased (-0.311094 --> -0.322206).  Saving model ...
Epoch: 13 cost time: 1.0291588306427002
Epoch: 13, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.633 Vali Acc: 0.333 Test Loss: 1.633 Test Acc: 0.333
Validation loss decreased (-0.322206 --> -0.333317).  Saving model ...
Epoch: 14 cost time: 0.7272591590881348
Epoch: 14, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.612 Vali Acc: 0.337 Test Loss: 1.612 Test Acc: 0.337
Validation loss decreased (-0.333317 --> -0.337021).  Saving model ...
Epoch: 15 cost time: 0.7246203422546387
Epoch: 15, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.591 Vali Acc: 0.344 Test Loss: 1.591 Test Acc: 0.344
Validation loss decreased (-0.337021 --> -0.344429).  Saving model ...
Epoch: 16 cost time: 0.8954057693481445
Epoch: 16, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.570 Vali Acc: 0.352 Test Loss: 1.570 Test Acc: 0.352
Validation loss decreased (-0.344429 --> -0.351836).  Saving model ...
Epoch: 17 cost time: 0.7512521743774414
Epoch: 17, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.547 Vali Acc: 0.363 Test Loss: 1.547 Test Acc: 0.363
Validation loss decreased (-0.351836 --> -0.362947).  Saving model ...
Epoch: 18 cost time: 0.7140660285949707
Epoch: 18, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.525 Vali Acc: 0.389 Test Loss: 1.525 Test Acc: 0.389
Validation loss decreased (-0.362947 --> -0.388874).  Saving model ...
Epoch: 19 cost time: 0.7564661502838135
Epoch: 19, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.502 Vali Acc: 0.404 Test Loss: 1.502 Test Acc: 0.404
Validation loss decreased (-0.388874 --> -0.403689).  Saving model ...
Epoch: 20 cost time: 0.6743261814117432
Epoch: 20, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.479 Vali Acc: 0.415 Test Loss: 1.479 Test Acc: 0.415
Validation loss decreased (-0.403689 --> -0.414800).  Saving model ...
Epoch: 21 cost time: 0.5746603012084961
Epoch: 21, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.455 Vali Acc: 0.456 Test Loss: 1.455 Test Acc: 0.456
Validation loss decreased (-0.414800 --> -0.455541).  Saving model ...
Epoch: 22 cost time: 0.8204052448272705
Epoch: 22, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.432 Vali Acc: 0.470 Test Loss: 1.432 Test Acc: 0.470
Validation loss decreased (-0.455541 --> -0.470356).  Saving model ...
Epoch: 23 cost time: 0.8990786075592041
Epoch: 23, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.408 Vali Acc: 0.493 Test Loss: 1.408 Test Acc: 0.493
Validation loss decreased (-0.470356 --> -0.492579).  Saving model ...
Epoch: 24 cost time: 0.5878143310546875
Epoch: 24, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.384 Vali Acc: 0.519 Test Loss: 1.384 Test Acc: 0.519
Validation loss decreased (-0.492579 --> -0.518505).  Saving model ...
Epoch: 25 cost time: 0.5589327812194824
Epoch: 25, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.360 Vali Acc: 0.544 Test Loss: 1.360 Test Acc: 0.544
Validation loss decreased (-0.518505 --> -0.544431).  Saving model ...
Epoch: 26 cost time: 0.6136386394500732
Epoch: 26, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.336 Vali Acc: 0.570 Test Loss: 1.336 Test Acc: 0.570
Validation loss decreased (-0.544431 --> -0.570357).  Saving model ...
Epoch: 27 cost time: 0.5839908123016357
Epoch: 27, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.312 Vali Acc: 0.600 Test Loss: 1.312 Test Acc: 0.600
Validation loss decreased (-0.570357 --> -0.599987).  Saving model ...
Epoch: 28 cost time: 0.7637805938720703
Epoch: 28, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.288 Vali Acc: 0.615 Test Loss: 1.288 Test Acc: 0.615
Validation loss decreased (-0.599987 --> -0.614802).  Saving model ...
Epoch: 29 cost time: 0.6529808044433594
Epoch: 29, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.263 Vali Acc: 0.641 Test Loss: 1.263 Test Acc: 0.641
Validation loss decreased (-0.614802 --> -0.640728).  Saving model ...
Epoch: 30 cost time: 0.7164716720581055
Epoch: 30, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.239 Vali Acc: 0.667 Test Loss: 1.239 Test Acc: 0.667
Validation loss decreased (-0.640728 --> -0.666654).  Saving model ...
Epoch: 31 cost time: 0.7993569374084473
Epoch: 31, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.215 Vali Acc: 0.693 Test Loss: 1.215 Test Acc: 0.693
Validation loss decreased (-0.666654 --> -0.692580).  Saving model ...
Epoch: 32 cost time: 0.7066447734832764
Epoch: 32, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.191 Vali Acc: 0.726 Test Loss: 1.191 Test Acc: 0.726
Validation loss decreased (-0.692580 --> -0.725914).  Saving model ...
Epoch: 33 cost time: 0.6886987686157227
Epoch: 33, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.167 Vali Acc: 0.733 Test Loss: 1.167 Test Acc: 0.733
Validation loss decreased (-0.725914 --> -0.733322).  Saving model ...
Epoch: 34 cost time: 0.8841004371643066
Epoch: 34, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.143 Vali Acc: 0.741 Test Loss: 1.143 Test Acc: 0.741
Validation loss decreased (-0.733322 --> -0.740729).  Saving model ...
Epoch: 35 cost time: 0.7399094104766846
Epoch: 35, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.119 Vali Acc: 0.763 Test Loss: 1.119 Test Acc: 0.763
Validation loss decreased (-0.740729 --> -0.762952).  Saving model ...
Epoch: 36 cost time: 0.7288179397583008
Epoch: 36, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.096 Vali Acc: 0.778 Test Loss: 1.096 Test Acc: 0.778
Validation loss decreased (-0.762952 --> -0.777767).  Saving model ...
Epoch: 37 cost time: 0.7848842144012451
Epoch: 37, Steps: 2 | Train Loss: 0.916 Vali Loss: 1.073 Vali Acc: 0.778 Test Loss: 1.073 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777767).  Saving model ...
Epoch: 38 cost time: 0.7869009971618652
Epoch: 38, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.050 Vali Acc: 0.781 Test Loss: 1.050 Test Acc: 0.781
Validation loss decreased (-0.777767 --> -0.781471).  Saving model ...
Epoch: 39 cost time: 0.7160201072692871
Epoch: 39, Steps: 2 | Train Loss: 0.865 Vali Loss: 1.027 Vali Acc: 0.793 Test Loss: 1.027 Test Acc: 0.793
Validation loss decreased (-0.781471 --> -0.792582).  Saving model ...
Epoch: 40 cost time: 0.7246761322021484
Epoch: 40, Steps: 2 | Train Loss: 0.837 Vali Loss: 1.004 Vali Acc: 0.800 Test Loss: 1.004 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799990).  Saving model ...
Epoch: 41 cost time: 0.6929328441619873
Epoch: 41, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.982 Vali Acc: 0.800 Test Loss: 0.982 Test Acc: 0.800
Validation loss decreased (-0.799990 --> -0.799990).  Saving model ...
Epoch: 42 cost time: 1.0325322151184082
Epoch: 42, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.960 Vali Acc: 0.807 Test Loss: 0.960 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807398).  Saving model ...
Epoch: 43 cost time: 0.6887760162353516
Epoch: 43, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.939 Vali Acc: 0.815 Test Loss: 0.939 Test Acc: 0.815
Validation loss decreased (-0.807398 --> -0.814805).  Saving model ...
Epoch: 44 cost time: 0.7704756259918213
Epoch: 44, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.917 Vali Acc: 0.833 Test Loss: 0.917 Test Acc: 0.833
Validation loss decreased (-0.814805 --> -0.833324).  Saving model ...
Epoch: 45 cost time: 1.1437551975250244
Epoch: 45, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.897 Vali Acc: 0.837 Test Loss: 0.897 Test Acc: 0.837
Validation loss decreased (-0.833324 --> -0.837028).  Saving model ...
Epoch: 46 cost time: 0.9505143165588379
Epoch: 46, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.877 Vali Acc: 0.844 Test Loss: 0.877 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844436).  Saving model ...
Epoch: 47 cost time: 0.7416715621948242
Epoch: 47, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.857 Vali Acc: 0.844 Test Loss: 0.857 Test Acc: 0.844
Validation loss decreased (-0.844436 --> -0.844436).  Saving model ...
Epoch: 48 cost time: 0.8369181156158447
Epoch: 48, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.837 Vali Acc: 0.848 Test Loss: 0.837 Test Acc: 0.848
Validation loss decreased (-0.844436 --> -0.848140).  Saving model ...
Epoch: 49 cost time: 0.6117792129516602
Epoch: 49, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.818 Vali Acc: 0.852 Test Loss: 0.818 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851844).  Saving model ...
Epoch: 50 cost time: 0.6705937385559082
Epoch: 50, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.800 Vali Acc: 0.859 Test Loss: 0.800 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859251).  Saving model ...
Epoch: 51 cost time: 0.7312159538269043
Epoch: 51, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.781 Vali Acc: 0.867 Test Loss: 0.781 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 52 cost time: 0.8222024440765381
Epoch: 52, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.764 Vali Acc: 0.867 Test Loss: 0.764 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 53 cost time: 0.5929279327392578
Epoch: 53, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.747 Vali Acc: 0.867 Test Loss: 0.747 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 54 cost time: 0.6670958995819092
Epoch: 54, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.730 Vali Acc: 0.867 Test Loss: 0.730 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 55 cost time: 0.6550886631011963
Epoch: 55, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.714 Vali Acc: 0.870 Test Loss: 0.714 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 56 cost time: 0.6842696666717529
Epoch: 56, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.698 Vali Acc: 0.870 Test Loss: 0.698 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
Epoch: 57 cost time: 0.9501433372497559
Epoch: 57, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.683 Vali Acc: 0.870 Test Loss: 0.683 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870364).  Saving model ...
Epoch: 58 cost time: 0.7344870567321777
Epoch: 58, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.668 Vali Acc: 0.870 Test Loss: 0.668 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 59 cost time: 0.7312414646148682
Epoch: 59, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.654 Vali Acc: 0.874 Test Loss: 0.654 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 60 cost time: 0.6021533012390137
Epoch: 60, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.640 Vali Acc: 0.874 Test Loss: 0.640 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 61 cost time: 0.8191468715667725
Epoch: 61, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.626 Vali Acc: 0.878 Test Loss: 0.626 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 62 cost time: 0.6501278877258301
Epoch: 62, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.613 Vali Acc: 0.878 Test Loss: 0.613 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 63 cost time: 0.7828781604766846
Epoch: 63, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 64 cost time: 0.8493001461029053
Epoch: 64, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.588 Vali Acc: 0.878 Test Loss: 0.588 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 65 cost time: 0.6734480857849121
Epoch: 65, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.576 Vali Acc: 0.878 Test Loss: 0.576 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 66 cost time: 0.7850956916809082
Epoch: 66, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 67 cost time: 0.8974769115447998
Epoch: 67, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.553 Vali Acc: 0.881 Test Loss: 0.553 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 68 cost time: 0.8009610176086426
Epoch: 68, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9474296569824219
Epoch: 69, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.532 Vali Acc: 0.881 Test Loss: 0.532 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 70 cost time: 0.9076986312866211
Epoch: 70, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.522 Vali Acc: 0.881 Test Loss: 0.522 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 71 cost time: 0.9830760955810547
Epoch: 71, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 72 cost time: 0.7881004810333252
Epoch: 72, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 73 cost time: 0.6544442176818848
Epoch: 73, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.494 Vali Acc: 0.889 Test Loss: 0.494 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 74 cost time: 0.8985381126403809
Epoch: 74, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.485 Vali Acc: 0.889 Test Loss: 0.485 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 75 cost time: 0.8750956058502197
Epoch: 75, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.477 Vali Acc: 0.896 Test Loss: 0.477 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 76 cost time: 0.9409840106964111
Epoch: 76, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.468 Vali Acc: 0.896 Test Loss: 0.468 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 77 cost time: 1.0470454692840576
Epoch: 77, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.460 Vali Acc: 0.900 Test Loss: 0.460 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899995).  Saving model ...
Epoch: 78 cost time: 0.779940128326416
Epoch: 78, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 79 cost time: 0.636671781539917
Epoch: 79, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.445 Vali Acc: 0.900 Test Loss: 0.445 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 80 cost time: 0.9623076915740967
Epoch: 80, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 81 cost time: 1.1827189922332764
Epoch: 81, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 82 cost time: 1.0278277397155762
Epoch: 82, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.423 Vali Acc: 0.900 Test Loss: 0.423 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 83 cost time: 1.3299272060394287
Epoch: 83, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.417 Vali Acc: 0.904 Test Loss: 0.417 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 84 cost time: 0.7824397087097168
Epoch: 84, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 85 cost time: 0.734851598739624
Epoch: 85, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.404 Vali Acc: 0.907 Test Loss: 0.404 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907403).  Saving model ...
Epoch: 86 cost time: 0.6709821224212646
Epoch: 86, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 87 cost time: 0.5980396270751953
Epoch: 87, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.392 Vali Acc: 0.911 Test Loss: 0.392 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 88 cost time: 0.6195981502532959
Epoch: 88, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 89 cost time: 0.798762321472168
Epoch: 89, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 90 cost time: 1.021676778793335
Epoch: 90, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 91 cost time: 0.7688074111938477
Epoch: 91, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.370 Vali Acc: 0.911 Test Loss: 0.370 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 92 cost time: 0.8551425933837891
Epoch: 92, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 93 cost time: 0.8113574981689453
Epoch: 93, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 94 cost time: 0.7166824340820312
Epoch: 94, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 95 cost time: 0.7117459774017334
Epoch: 95, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 96 cost time: 0.7933828830718994
Epoch: 96, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 97 cost time: 0.7489633560180664
Epoch: 97, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.341 Vali Acc: 0.911 Test Loss: 0.341 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 98 cost time: 1.0394306182861328
Epoch: 98, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 99 cost time: 0.8840110301971436
Epoch: 99, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 100 cost time: 0.7124261856079102
Epoch: 100, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.328 Vali Acc: 0.915 Test Loss: 0.328 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 9020
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3865625858306885
Epoch: 1, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.813 Vali Acc: 0.193 Test Loss: 1.813 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.7358353137969971
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.796 Vali Acc: 0.211 Test Loss: 1.796 Test Acc: 0.211
Validation loss decreased (-0.192574 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.6968479156494141
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.785 Vali Acc: 0.222 Test Loss: 1.785 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.668677806854248
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.777 Vali Acc: 0.226 Test Loss: 1.777 Test Acc: 0.226
Validation loss decreased (-0.222204 --> -0.225908).  Saving model ...
Epoch: 5 cost time: 0.5981488227844238
Epoch: 5, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.767 Vali Acc: 0.244 Test Loss: 1.767 Test Acc: 0.244
Validation loss decreased (-0.225908 --> -0.244427).  Saving model ...
Epoch: 6 cost time: 0.6393072605133057
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.754 Vali Acc: 0.259 Test Loss: 1.754 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 7 cost time: 0.5772881507873535
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.740 Vali Acc: 0.274 Test Loss: 1.740 Test Acc: 0.274
Validation loss decreased (-0.259242 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.8713598251342773
Epoch: 8, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.725 Vali Acc: 0.289 Test Loss: 1.725 Test Acc: 0.289
Validation loss decreased (-0.274057 --> -0.288872).  Saving model ...
Epoch: 9 cost time: 0.5971887111663818
Epoch: 9, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.708 Vali Acc: 0.300 Test Loss: 1.708 Test Acc: 0.300
Validation loss decreased (-0.288872 --> -0.299983).  Saving model ...
Epoch: 10 cost time: 0.5628139972686768
Epoch: 10, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.691 Vali Acc: 0.300 Test Loss: 1.691 Test Acc: 0.300
Validation loss decreased (-0.299983 --> -0.299983).  Saving model ...
Epoch: 11 cost time: 0.6391258239746094
Epoch: 11, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.672 Vali Acc: 0.304 Test Loss: 1.672 Test Acc: 0.304
Validation loss decreased (-0.299983 --> -0.303687).  Saving model ...
Epoch: 12 cost time: 0.7567343711853027
Epoch: 12, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.652 Vali Acc: 0.322 Test Loss: 1.652 Test Acc: 0.322
Validation loss decreased (-0.303687 --> -0.322206).  Saving model ...
Epoch: 13 cost time: 0.8593509197235107
Epoch: 13, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.632 Vali Acc: 0.333 Test Loss: 1.632 Test Acc: 0.333
Validation loss decreased (-0.322206 --> -0.333317).  Saving model ...
Epoch: 14 cost time: 0.4812326431274414
Epoch: 14, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.610 Vali Acc: 0.359 Test Loss: 1.610 Test Acc: 0.359
Validation loss decreased (-0.333317 --> -0.359243).  Saving model ...
Epoch: 15 cost time: 0.7159678936004639
Epoch: 15, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.589 Vali Acc: 0.374 Test Loss: 1.589 Test Acc: 0.374
Validation loss decreased (-0.359243 --> -0.374058).  Saving model ...
Epoch: 16 cost time: 0.6375510692596436
Epoch: 16, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.566 Vali Acc: 0.396 Test Loss: 1.566 Test Acc: 0.396
Validation loss decreased (-0.374058 --> -0.396281).  Saving model ...
Epoch: 17 cost time: 0.6584124565124512
Epoch: 17, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.543 Vali Acc: 0.422 Test Loss: 1.543 Test Acc: 0.422
Validation loss decreased (-0.396281 --> -0.422207).  Saving model ...
Epoch: 18 cost time: 0.5959646701812744
Epoch: 18, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.520 Vali Acc: 0.437 Test Loss: 1.520 Test Acc: 0.437
Validation loss decreased (-0.422207 --> -0.437022).  Saving model ...
Epoch: 19 cost time: 0.6949496269226074
Epoch: 19, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.496 Vali Acc: 0.448 Test Loss: 1.496 Test Acc: 0.448
Validation loss decreased (-0.437022 --> -0.448133).  Saving model ...
Epoch: 20 cost time: 0.6471357345581055
Epoch: 20, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.471 Vali Acc: 0.467 Test Loss: 1.471 Test Acc: 0.467
Validation loss decreased (-0.448133 --> -0.466652).  Saving model ...
Epoch: 21 cost time: 0.7621102333068848
Epoch: 21, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.447 Vali Acc: 0.485 Test Loss: 1.447 Test Acc: 0.485
Validation loss decreased (-0.466652 --> -0.485171).  Saving model ...
Epoch: 22 cost time: 0.5223302841186523
Epoch: 22, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.422 Vali Acc: 0.526 Test Loss: 1.422 Test Acc: 0.526
Validation loss decreased (-0.485171 --> -0.525912).  Saving model ...
Epoch: 23 cost time: 0.606581449508667
Epoch: 23, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.397 Vali Acc: 0.548 Test Loss: 1.397 Test Acc: 0.548
Validation loss decreased (-0.525912 --> -0.548134).  Saving model ...
Epoch: 24 cost time: 0.5504715442657471
Epoch: 24, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.371 Vali Acc: 0.563 Test Loss: 1.371 Test Acc: 0.563
Validation loss decreased (-0.548134 --> -0.562949).  Saving model ...
Epoch: 25 cost time: 0.748945951461792
Epoch: 25, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.346 Vali Acc: 0.607 Test Loss: 1.346 Test Acc: 0.607
Validation loss decreased (-0.562949 --> -0.607394).  Saving model ...
Epoch: 26 cost time: 0.650888204574585
Epoch: 26, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.320 Vali Acc: 0.663 Test Loss: 1.320 Test Acc: 0.663
Validation loss decreased (-0.607394 --> -0.662950).  Saving model ...
Epoch: 27 cost time: 0.6079268455505371
Epoch: 27, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.294 Vali Acc: 0.715 Test Loss: 1.294 Test Acc: 0.715
Validation loss decreased (-0.662950 --> -0.714802).  Saving model ...
Epoch: 28 cost time: 0.6641085147857666
Epoch: 28, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.267 Vali Acc: 0.744 Test Loss: 1.267 Test Acc: 0.744
Validation loss decreased (-0.714802 --> -0.744432).  Saving model ...
Epoch: 29 cost time: 0.7257626056671143
Epoch: 29, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.240 Vali Acc: 0.763 Test Loss: 1.240 Test Acc: 0.763
Validation loss decreased (-0.744432 --> -0.762951).  Saving model ...
Epoch: 30 cost time: 0.5787076950073242
Epoch: 30, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.214 Vali Acc: 0.811 Test Loss: 1.214 Test Acc: 0.811
Validation loss decreased (-0.762951 --> -0.811099).  Saving model ...
Epoch: 31 cost time: 0.7650191783905029
Epoch: 31, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.188 Vali Acc: 0.844 Test Loss: 1.188 Test Acc: 0.844
Validation loss decreased (-0.811099 --> -0.844433).  Saving model ...
Epoch: 32 cost time: 0.6532955169677734
Epoch: 32, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.161 Vali Acc: 0.856 Test Loss: 1.161 Test Acc: 0.856
Validation loss decreased (-0.844433 --> -0.855544).  Saving model ...
Epoch: 33 cost time: 0.7678494453430176
Epoch: 33, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.134 Vali Acc: 0.859 Test Loss: 1.134 Test Acc: 0.859
Validation loss decreased (-0.855544 --> -0.859248).  Saving model ...
Epoch: 34 cost time: 0.7243053913116455
Epoch: 34, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.108 Vali Acc: 0.867 Test Loss: 1.108 Test Acc: 0.867
Validation loss decreased (-0.859248 --> -0.866656).  Saving model ...
Epoch: 35 cost time: 0.8505704402923584
Epoch: 35, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.082 Vali Acc: 0.870 Test Loss: 1.082 Test Acc: 0.870
Validation loss decreased (-0.866656 --> -0.870360).  Saving model ...
Epoch: 36 cost time: 0.6373839378356934
Epoch: 36, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.056 Vali Acc: 0.870 Test Loss: 1.056 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870360).  Saving model ...
Epoch: 37 cost time: 0.7049460411071777
Epoch: 37, Steps: 2 | Train Loss: 0.920 Vali Loss: 1.030 Vali Acc: 0.870 Test Loss: 1.030 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870360).  Saving model ...
Epoch: 38 cost time: 0.7302265167236328
Epoch: 38, Steps: 2 | Train Loss: 0.893 Vali Loss: 1.004 Vali Acc: 0.874 Test Loss: 1.004 Test Acc: 0.874
Validation loss decreased (-0.870360 --> -0.874064).  Saving model ...
Epoch: 39 cost time: 0.6599400043487549
Epoch: 39, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.979 Vali Acc: 0.878 Test Loss: 0.979 Test Acc: 0.878
Validation loss decreased (-0.874064 --> -0.877768).  Saving model ...
Epoch: 40 cost time: 0.6554255485534668
Epoch: 40, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.954 Vali Acc: 0.885 Test Loss: 0.954 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
Epoch: 41 cost time: 0.8519670963287354
Epoch: 41, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.930 Vali Acc: 0.885 Test Loss: 0.930 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885176).  Saving model ...
Epoch: 42 cost time: 0.67942214012146
Epoch: 42, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.906 Vali Acc: 0.881 Test Loss: 0.906 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6134777069091797
Epoch: 43, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.883 Vali Acc: 0.885 Test Loss: 0.883 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885176).  Saving model ...
Epoch: 44 cost time: 0.624781608581543
Epoch: 44, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 45 cost time: 0.6353261470794678
Epoch: 45, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.838 Vali Acc: 0.893 Test Loss: 0.838 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892584).  Saving model ...
Epoch: 46 cost time: 0.547919511795044
Epoch: 46, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.816 Vali Acc: 0.900 Test Loss: 0.816 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 47 cost time: 0.7447137832641602
Epoch: 47, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.795 Vali Acc: 0.900 Test Loss: 0.795 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 48 cost time: 0.7203454971313477
Epoch: 48, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.774 Vali Acc: 0.900 Test Loss: 0.774 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 49 cost time: 0.6952121257781982
Epoch: 49, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.754 Vali Acc: 0.900 Test Loss: 0.754 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 50 cost time: 0.8211352825164795
Epoch: 50, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.735 Vali Acc: 0.904 Test Loss: 0.735 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 51 cost time: 0.603571891784668
Epoch: 51, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.716 Vali Acc: 0.904 Test Loss: 0.716 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 52 cost time: 0.8200304508209229
Epoch: 52, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.697 Vali Acc: 0.907 Test Loss: 0.697 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907400).  Saving model ...
Epoch: 53 cost time: 0.5967154502868652
Epoch: 53, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.680 Vali Acc: 0.911 Test Loss: 0.680 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 54 cost time: 0.6328220367431641
Epoch: 54, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.663 Vali Acc: 0.907 Test Loss: 0.663 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6523528099060059
Epoch: 55, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.646 Vali Acc: 0.904 Test Loss: 0.646 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7397019863128662
Epoch: 56, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.630 Vali Acc: 0.911 Test Loss: 0.630 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 57 cost time: 0.6616637706756592
Epoch: 57, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.615 Vali Acc: 0.915 Test Loss: 0.615 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 58 cost time: 0.6490428447723389
Epoch: 58, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.600 Vali Acc: 0.915 Test Loss: 0.600 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 59 cost time: 0.8530795574188232
Epoch: 59, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.586 Vali Acc: 0.915 Test Loss: 0.586 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 60 cost time: 0.7878367900848389
Epoch: 60, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.573 Vali Acc: 0.915 Test Loss: 0.573 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 61 cost time: 0.5782129764556885
Epoch: 61, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.560 Vali Acc: 0.919 Test Loss: 0.560 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 62 cost time: 0.7603752613067627
Epoch: 62, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.547 Vali Acc: 0.919 Test Loss: 0.547 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 63 cost time: 0.6919956207275391
Epoch: 63, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.535 Vali Acc: 0.919 Test Loss: 0.535 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 64 cost time: 0.7487092018127441
Epoch: 64, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.523 Vali Acc: 0.919 Test Loss: 0.523 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 65 cost time: 0.6227970123291016
Epoch: 65, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.512 Vali Acc: 0.922 Test Loss: 0.512 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 66 cost time: 0.7377974987030029
Epoch: 66, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.501 Vali Acc: 0.922 Test Loss: 0.501 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 67 cost time: 0.8907375335693359
Epoch: 67, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.491 Vali Acc: 0.922 Test Loss: 0.491 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 68 cost time: 0.6583850383758545
Epoch: 68, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 69 cost time: 0.5909125804901123
Epoch: 69, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 70 cost time: 0.8595552444458008
Epoch: 70, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 71 cost time: 0.8237721920013428
Epoch: 71, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.454 Vali Acc: 0.926 Test Loss: 0.454 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 72 cost time: 0.8215076923370361
Epoch: 72, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.445 Vali Acc: 0.926 Test Loss: 0.445 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 73 cost time: 0.7666196823120117
Epoch: 73, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.437 Vali Acc: 0.926 Test Loss: 0.437 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 74 cost time: 0.7348055839538574
Epoch: 74, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.430 Vali Acc: 0.926 Test Loss: 0.430 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 75 cost time: 0.7297704219818115
Epoch: 75, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7431738376617432
Epoch: 76, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.415 Vali Acc: 0.926 Test Loss: 0.415 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 77 cost time: 1.0344672203063965
Epoch: 77, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.408 Vali Acc: 0.926 Test Loss: 0.408 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 78 cost time: 0.9726378917694092
Epoch: 78, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.402 Vali Acc: 0.926 Test Loss: 0.402 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 79 cost time: 0.6035563945770264
Epoch: 79, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.395 Vali Acc: 0.922 Test Loss: 0.395 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8219068050384521
Epoch: 80, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6462891101837158
Epoch: 81, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.383 Vali Acc: 0.919 Test Loss: 0.383 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.8984959125518799
Epoch: 82, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.378 Vali Acc: 0.915 Test Loss: 0.378 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7361750602722168
Epoch: 83, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.372 Vali Acc: 0.919 Test Loss: 0.372 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.7800180912017822
Epoch: 84, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 0.8356633186340332
Epoch: 85, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.7256879806518555
Epoch: 86, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.357 Vali Acc: 0.919 Test Loss: 0.357 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.6426594257354736
Epoch: 87, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.6712512969970703
Epoch: 88, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 8900
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2730367183685303
Epoch: 1, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.955 Vali Acc: 0.063 Test Loss: 1.955 Test Acc: 0.063
Validation loss decreased (inf --> -0.062943).  Saving model ...
Epoch: 2 cost time: 0.6449739933013916
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.936 Vali Acc: 0.085 Test Loss: 1.936 Test Acc: 0.085
Validation loss decreased (-0.062943 --> -0.085166).  Saving model ...
Epoch: 3 cost time: 0.5953285694122314
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.924 Vali Acc: 0.096 Test Loss: 1.924 Test Acc: 0.096
Validation loss decreased (-0.085166 --> -0.096277).  Saving model ...
Epoch: 4 cost time: 0.5538797378540039
Epoch: 4, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.915 Vali Acc: 0.111 Test Loss: 1.915 Test Acc: 0.111
Validation loss decreased (-0.096277 --> -0.111092).  Saving model ...
Epoch: 5 cost time: 0.5430302619934082
Epoch: 5, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.903 Vali Acc: 0.115 Test Loss: 1.903 Test Acc: 0.115
Validation loss decreased (-0.111092 --> -0.114796).  Saving model ...
Epoch: 6 cost time: 0.7164490222930908
Epoch: 6, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.890 Vali Acc: 0.122 Test Loss: 1.890 Test Acc: 0.122
Validation loss decreased (-0.114796 --> -0.122203).  Saving model ...
Epoch: 7 cost time: 0.6070058345794678
Epoch: 7, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.875 Vali Acc: 0.141 Test Loss: 1.875 Test Acc: 0.141
Validation loss decreased (-0.122203 --> -0.140722).  Saving model ...
Epoch: 8 cost time: 0.5726115703582764
Epoch: 8, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.858 Vali Acc: 0.174 Test Loss: 1.858 Test Acc: 0.174
Validation loss decreased (-0.140722 --> -0.174055).  Saving model ...
Epoch: 9 cost time: 0.7343206405639648
Epoch: 9, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.840 Vali Acc: 0.211 Test Loss: 1.840 Test Acc: 0.211
Validation loss decreased (-0.174055 --> -0.211093).  Saving model ...
Epoch: 10 cost time: 0.5650029182434082
Epoch: 10, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.821 Vali Acc: 0.256 Test Loss: 1.821 Test Acc: 0.256
Validation loss decreased (-0.211093 --> -0.255537).  Saving model ...
Epoch: 11 cost time: 0.5605337619781494
Epoch: 11, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.800 Vali Acc: 0.278 Test Loss: 1.800 Test Acc: 0.278
Validation loss decreased (-0.255537 --> -0.277760).  Saving model ...
Epoch: 12 cost time: 0.821453332901001
Epoch: 12, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.779 Vali Acc: 0.296 Test Loss: 1.779 Test Acc: 0.296
Validation loss decreased (-0.277760 --> -0.296279).  Saving model ...
Epoch: 13 cost time: 0.7013816833496094
Epoch: 13, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.757 Vali Acc: 0.304 Test Loss: 1.757 Test Acc: 0.304
Validation loss decreased (-0.296279 --> -0.303686).  Saving model ...
Epoch: 14 cost time: 0.6473581790924072
Epoch: 14, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.735 Vali Acc: 0.333 Test Loss: 1.735 Test Acc: 0.333
Validation loss decreased (-0.303686 --> -0.333316).  Saving model ...
Epoch: 15 cost time: 0.5946195125579834
Epoch: 15, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.712 Vali Acc: 0.341 Test Loss: 1.712 Test Acc: 0.341
Validation loss decreased (-0.333316 --> -0.340724).  Saving model ...
Epoch: 16 cost time: 0.7931501865386963
Epoch: 16, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.688 Vali Acc: 0.367 Test Loss: 1.688 Test Acc: 0.367
Validation loss decreased (-0.340724 --> -0.366650).  Saving model ...
Epoch: 17 cost time: 0.9224710464477539
Epoch: 17, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.664 Vali Acc: 0.389 Test Loss: 1.664 Test Acc: 0.389
Validation loss decreased (-0.366650 --> -0.388872).  Saving model ...
Epoch: 18 cost time: 0.7734179496765137
Epoch: 18, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.639 Vali Acc: 0.419 Test Loss: 1.639 Test Acc: 0.419
Validation loss decreased (-0.388872 --> -0.418502).  Saving model ...
Epoch: 19 cost time: 0.610506534576416
Epoch: 19, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.614 Vali Acc: 0.437 Test Loss: 1.614 Test Acc: 0.437
Validation loss decreased (-0.418502 --> -0.437021).  Saving model ...
Epoch: 20 cost time: 0.7205798625946045
Epoch: 20, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.589 Vali Acc: 0.456 Test Loss: 1.589 Test Acc: 0.456
Validation loss decreased (-0.437021 --> -0.455540).  Saving model ...
Epoch: 21 cost time: 0.5219786167144775
Epoch: 21, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.563 Vali Acc: 0.459 Test Loss: 1.563 Test Acc: 0.459
Validation loss decreased (-0.455540 --> -0.459244).  Saving model ...
Epoch: 22 cost time: 0.5959715843200684
Epoch: 22, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.538 Vali Acc: 0.474 Test Loss: 1.538 Test Acc: 0.474
Validation loss decreased (-0.459244 --> -0.474059).  Saving model ...
Epoch: 23 cost time: 0.6972775459289551
Epoch: 23, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.512 Vali Acc: 0.493 Test Loss: 1.512 Test Acc: 0.493
Validation loss decreased (-0.474059 --> -0.492577).  Saving model ...
Epoch: 24 cost time: 0.5658121109008789
Epoch: 24, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.486 Vali Acc: 0.519 Test Loss: 1.486 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518504).  Saving model ...
Epoch: 25 cost time: 0.884507417678833
Epoch: 25, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.460 Vali Acc: 0.533 Test Loss: 1.460 Test Acc: 0.533
Validation loss decreased (-0.518504 --> -0.533319).  Saving model ...
Epoch: 26 cost time: 0.8562226295471191
Epoch: 26, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.433 Vali Acc: 0.559 Test Loss: 1.433 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 27 cost time: 0.7184853553771973
Epoch: 27, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.407 Vali Acc: 0.563 Test Loss: 1.407 Test Acc: 0.563
Validation loss decreased (-0.559245 --> -0.562949).  Saving model ...
Epoch: 28 cost time: 0.6657586097717285
Epoch: 28, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.381 Vali Acc: 0.581 Test Loss: 1.381 Test Acc: 0.581
Validation loss decreased (-0.562949 --> -0.581468).  Saving model ...
Epoch: 29 cost time: 0.6394925117492676
Epoch: 29, Steps: 2 | Train Loss: 1.251 Vali Loss: 1.354 Vali Acc: 0.600 Test Loss: 1.354 Test Acc: 0.600
Validation loss decreased (-0.581468 --> -0.599986).  Saving model ...
Epoch: 30 cost time: 0.6082818508148193
Epoch: 30, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.328 Vali Acc: 0.622 Test Loss: 1.328 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622209).  Saving model ...
Epoch: 31 cost time: 0.6722540855407715
Epoch: 31, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.302 Vali Acc: 0.652 Test Loss: 1.302 Test Acc: 0.652
Validation loss decreased (-0.622209 --> -0.651839).  Saving model ...
Epoch: 32 cost time: 0.650054931640625
Epoch: 32, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.275 Vali Acc: 0.689 Test Loss: 1.275 Test Acc: 0.689
Validation loss decreased (-0.651839 --> -0.688876).  Saving model ...
Epoch: 33 cost time: 0.7125988006591797
Epoch: 33, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.249 Vali Acc: 0.700 Test Loss: 1.249 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699988).  Saving model ...
Epoch: 34 cost time: 0.5304734706878662
Epoch: 34, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.223 Vali Acc: 0.715 Test Loss: 1.223 Test Acc: 0.715
Validation loss decreased (-0.699988 --> -0.714803).  Saving model ...
Epoch: 35 cost time: 0.7325694561004639
Epoch: 35, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.196 Vali Acc: 0.730 Test Loss: 1.196 Test Acc: 0.730
Validation loss decreased (-0.714803 --> -0.729618).  Saving model ...
Epoch: 36 cost time: 0.6331140995025635
Epoch: 36, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.170 Vali Acc: 0.748 Test Loss: 1.170 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748136).  Saving model ...
Epoch: 37 cost time: 0.5653109550476074
Epoch: 37, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.144 Vali Acc: 0.759 Test Loss: 1.144 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759248).  Saving model ...
Epoch: 38 cost time: 0.7429728507995605
Epoch: 38, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.119 Vali Acc: 0.770 Test Loss: 1.119 Test Acc: 0.770
Validation loss decreased (-0.759248 --> -0.770359).  Saving model ...
Epoch: 39 cost time: 0.6326594352722168
Epoch: 39, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.093 Vali Acc: 0.781 Test Loss: 1.093 Test Acc: 0.781
Validation loss decreased (-0.770359 --> -0.781471).  Saving model ...
Epoch: 40 cost time: 0.6559579372406006
Epoch: 40, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.068 Vali Acc: 0.793 Test Loss: 1.068 Test Acc: 0.793
Validation loss decreased (-0.781471 --> -0.792582).  Saving model ...
Epoch: 41 cost time: 0.6217446327209473
Epoch: 41, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.043 Vali Acc: 0.807 Test Loss: 1.043 Test Acc: 0.807
Validation loss decreased (-0.792582 --> -0.807397).  Saving model ...
Epoch: 42 cost time: 0.6550109386444092
Epoch: 42, Steps: 2 | Train Loss: 0.881 Vali Loss: 1.018 Vali Acc: 0.826 Test Loss: 1.018 Test Acc: 0.826
Validation loss decreased (-0.807397 --> -0.825916).  Saving model ...
Epoch: 43 cost time: 0.8510808944702148
Epoch: 43, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.994 Vali Acc: 0.833 Test Loss: 0.994 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833323).  Saving model ...
Epoch: 44 cost time: 0.7719793319702148
Epoch: 44, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.970 Vali Acc: 0.833 Test Loss: 0.970 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833324).  Saving model ...
Epoch: 45 cost time: 0.8387608528137207
Epoch: 45, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.947 Vali Acc: 0.830 Test Loss: 0.947 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6214978694915771
Epoch: 46, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.924 Vali Acc: 0.848 Test Loss: 0.924 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848139).  Saving model ...
Epoch: 47 cost time: 0.6465075016021729
Epoch: 47, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.901 Vali Acc: 0.859 Test Loss: 0.901 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859250).  Saving model ...
Epoch: 48 cost time: 0.7355639934539795
Epoch: 48, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.879 Vali Acc: 0.867 Test Loss: 0.879 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 49 cost time: 0.7565343379974365
Epoch: 49, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.857 Vali Acc: 0.870 Test Loss: 0.857 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 50 cost time: 0.5875029563903809
Epoch: 50, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.836 Vali Acc: 0.878 Test Loss: 0.836 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877769).  Saving model ...
Epoch: 51 cost time: 0.5795469284057617
Epoch: 51, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.815 Vali Acc: 0.878 Test Loss: 0.815 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 52 cost time: 0.5434958934783936
Epoch: 52, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.795 Vali Acc: 0.878 Test Loss: 0.795 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 53 cost time: 0.6213974952697754
Epoch: 53, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.775 Vali Acc: 0.878 Test Loss: 0.775 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 54 cost time: 0.7750599384307861
Epoch: 54, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.756 Vali Acc: 0.881 Test Loss: 0.756 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 55 cost time: 0.754084587097168
Epoch: 55, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.738 Vali Acc: 0.889 Test Loss: 0.738 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 56 cost time: 0.7811651229858398
Epoch: 56, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.720 Vali Acc: 0.896 Test Loss: 0.720 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896289).  Saving model ...
Epoch: 57 cost time: 0.7715628147125244
Epoch: 57, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.702 Vali Acc: 0.900 Test Loss: 0.702 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 58 cost time: 0.673576831817627
Epoch: 58, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.685 Vali Acc: 0.900 Test Loss: 0.685 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 59 cost time: 0.6073927879333496
Epoch: 59, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 60 cost time: 0.716367244720459
Epoch: 60, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.653 Vali Acc: 0.900 Test Loss: 0.653 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 61 cost time: 0.779376745223999
Epoch: 61, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.637 Vali Acc: 0.900 Test Loss: 0.637 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 62 cost time: 0.7479352951049805
Epoch: 62, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 63 cost time: 0.87599778175354
Epoch: 63, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.608 Vali Acc: 0.900 Test Loss: 0.608 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 64 cost time: 0.8840973377227783
Epoch: 64, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.594 Vali Acc: 0.904 Test Loss: 0.594 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 65 cost time: 0.6198337078094482
Epoch: 65, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.581 Vali Acc: 0.907 Test Loss: 0.581 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 66 cost time: 1.0102648735046387
Epoch: 66, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.568 Vali Acc: 0.907 Test Loss: 0.568 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 67 cost time: 0.7521328926086426
Epoch: 67, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.556 Vali Acc: 0.904 Test Loss: 0.556 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8807682991027832
Epoch: 68, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.544 Vali Acc: 0.904 Test Loss: 0.544 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7651567459106445
Epoch: 69, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.533 Vali Acc: 0.904 Test Loss: 0.533 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6177709102630615
Epoch: 70, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.521 Vali Acc: 0.904 Test Loss: 0.521 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7306499481201172
Epoch: 71, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.511 Vali Acc: 0.904 Test Loss: 0.511 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6108646392822266
Epoch: 72, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.500 Vali Acc: 0.907 Test Loss: 0.500 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 73 cost time: 0.7413768768310547
Epoch: 73, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.490 Vali Acc: 0.907 Test Loss: 0.490 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 74 cost time: 0.8206014633178711
Epoch: 74, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.480 Vali Acc: 0.907 Test Loss: 0.480 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 75 cost time: 0.7152261734008789
Epoch: 75, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.471 Vali Acc: 0.907 Test Loss: 0.471 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 76 cost time: 0.5392534732818604
Epoch: 76, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.462 Vali Acc: 0.907 Test Loss: 0.462 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 77 cost time: 0.5658473968505859
Epoch: 77, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.453 Vali Acc: 0.907 Test Loss: 0.453 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 78 cost time: 0.732079029083252
Epoch: 78, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 79 cost time: 0.9242758750915527
Epoch: 79, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.437 Vali Acc: 0.907 Test Loss: 0.437 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 80 cost time: 0.7757773399353027
Epoch: 80, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.429 Vali Acc: 0.904 Test Loss: 0.429 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8510744571685791
Epoch: 81, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 82 cost time: 0.7241747379302979
Epoch: 82, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 83 cost time: 0.6296613216400146
Epoch: 83, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 84 cost time: 0.660125732421875
Epoch: 84, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.400 Vali Acc: 0.915 Test Loss: 0.400 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 85 cost time: 0.7109510898590088
Epoch: 85, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.394 Vali Acc: 0.915 Test Loss: 0.394 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 86 cost time: 0.6087615489959717
Epoch: 86, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 87 cost time: 0.6627304553985596
Epoch: 87, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 88 cost time: 0.9223780632019043
Epoch: 88, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.376 Vali Acc: 0.915 Test Loss: 0.376 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 89 cost time: 0.5668716430664062
Epoch: 89, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 90 cost time: 0.760162353515625
Epoch: 90, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.365 Vali Acc: 0.915 Test Loss: 0.365 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 91 cost time: 0.8869554996490479
Epoch: 91, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 92 cost time: 0.8610453605651855
Epoch: 92, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 93 cost time: 0.7130701541900635
Epoch: 93, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 94 cost time: 0.6278953552246094
Epoch: 94, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.345 Vali Acc: 0.915 Test Loss: 0.345 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 95 cost time: 0.5767967700958252
Epoch: 95, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 96 cost time: 0.4770236015319824
Epoch: 96, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 97 cost time: 0.6598660945892334
Epoch: 97, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 98 cost time: 0.7434403896331787
Epoch: 98, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.327 Vali Acc: 0.915 Test Loss: 0.327 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 99 cost time: 0.799030065536499
Epoch: 99, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 100 cost time: 0.7393887042999268
Epoch: 100, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.915 Test Loss: 0.319 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 8654
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3275814056396484
Epoch: 1, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.742 Vali Acc: 0.141 Test Loss: 1.742 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 0.6009714603424072
Epoch: 2, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.724 Vali Acc: 0.156 Test Loss: 1.724 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 3 cost time: 0.6025834083557129
Epoch: 3, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.712 Vali Acc: 0.163 Test Loss: 1.712 Test Acc: 0.163
Validation loss decreased (-0.155538 --> -0.162946).  Saving model ...
Epoch: 4 cost time: 0.8050253391265869
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.704 Vali Acc: 0.170 Test Loss: 1.704 Test Acc: 0.170
Validation loss decreased (-0.162946 --> -0.170353).  Saving model ...
Epoch: 5 cost time: 0.7041981220245361
Epoch: 5, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.693 Vali Acc: 0.178 Test Loss: 1.693 Test Acc: 0.178
Validation loss decreased (-0.170353 --> -0.177761).  Saving model ...
Epoch: 6 cost time: 0.6297173500061035
Epoch: 6, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.680 Vali Acc: 0.185 Test Loss: 1.680 Test Acc: 0.185
Validation loss decreased (-0.177761 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.678612232208252
Epoch: 7, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.665 Vali Acc: 0.222 Test Loss: 1.665 Test Acc: 0.222
Validation loss decreased (-0.185168 --> -0.222206).  Saving model ...
Epoch: 8 cost time: 0.6017496585845947
Epoch: 8, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.648 Vali Acc: 0.270 Test Loss: 1.648 Test Acc: 0.270
Validation loss decreased (-0.222206 --> -0.270354).  Saving model ...
Epoch: 9 cost time: 0.48889851570129395
Epoch: 9, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.631 Vali Acc: 0.315 Test Loss: 1.631 Test Acc: 0.315
Validation loss decreased (-0.270354 --> -0.314799).  Saving model ...
Epoch: 10 cost time: 0.5886781215667725
Epoch: 10, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.612 Vali Acc: 0.363 Test Loss: 1.612 Test Acc: 0.363
Validation loss decreased (-0.314799 --> -0.362947).  Saving model ...
Epoch: 11 cost time: 0.6189765930175781
Epoch: 11, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.592 Vali Acc: 0.407 Test Loss: 1.592 Test Acc: 0.407
Validation loss decreased (-0.362947 --> -0.407391).  Saving model ...
Epoch: 12 cost time: 0.5607457160949707
Epoch: 12, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.571 Vali Acc: 0.426 Test Loss: 1.571 Test Acc: 0.426
Validation loss decreased (-0.407391 --> -0.425910).  Saving model ...
Epoch: 13 cost time: 0.5546829700469971
Epoch: 13, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.550 Vali Acc: 0.437 Test Loss: 1.550 Test Acc: 0.437
Validation loss decreased (-0.425910 --> -0.437022).  Saving model ...
Epoch: 14 cost time: 0.5913920402526855
Epoch: 14, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.528 Vali Acc: 0.489 Test Loss: 1.528 Test Acc: 0.489
Validation loss decreased (-0.437022 --> -0.488874).  Saving model ...
Epoch: 15 cost time: 0.6480700969696045
Epoch: 15, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.505 Vali Acc: 0.522 Test Loss: 1.505 Test Acc: 0.522
Validation loss decreased (-0.488874 --> -0.522207).  Saving model ...
Epoch: 16 cost time: 0.6251242160797119
Epoch: 16, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.482 Vali Acc: 0.559 Test Loss: 1.482 Test Acc: 0.559
Validation loss decreased (-0.522207 --> -0.559244).  Saving model ...
Epoch: 17 cost time: 0.6798303127288818
Epoch: 17, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.458 Vali Acc: 0.596 Test Loss: 1.458 Test Acc: 0.596
Validation loss decreased (-0.559244 --> -0.596282).  Saving model ...
Epoch: 18 cost time: 0.5750117301940918
Epoch: 18, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.434 Vali Acc: 0.630 Test Loss: 1.434 Test Acc: 0.630
Validation loss decreased (-0.596282 --> -0.629615).  Saving model ...
Epoch: 19 cost time: 0.5150284767150879
Epoch: 19, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.409 Vali Acc: 0.648 Test Loss: 1.409 Test Acc: 0.648
Validation loss decreased (-0.629615 --> -0.648134).  Saving model ...
Epoch: 20 cost time: 0.6332283020019531
Epoch: 20, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.384 Vali Acc: 0.674 Test Loss: 1.384 Test Acc: 0.674
Validation loss decreased (-0.648134 --> -0.674060).  Saving model ...
Epoch: 21 cost time: 0.5687460899353027
Epoch: 21, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.359 Vali Acc: 0.700 Test Loss: 1.359 Test Acc: 0.700
Validation loss decreased (-0.674060 --> -0.699986).  Saving model ...
Epoch: 22 cost time: 0.7096652984619141
Epoch: 22, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.333 Vali Acc: 0.726 Test Loss: 1.333 Test Acc: 0.726
Validation loss decreased (-0.699986 --> -0.725913).  Saving model ...
Epoch: 23 cost time: 0.6787052154541016
Epoch: 23, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.308 Vali Acc: 0.748 Test Loss: 1.308 Test Acc: 0.748
Validation loss decreased (-0.725913 --> -0.748135).  Saving model ...
Epoch: 24 cost time: 0.5661129951477051
Epoch: 24, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.282 Vali Acc: 0.767 Test Loss: 1.282 Test Acc: 0.767
Validation loss decreased (-0.748135 --> -0.766654).  Saving model ...
Epoch: 25 cost time: 0.5839693546295166
Epoch: 25, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.256 Vali Acc: 0.774 Test Loss: 1.256 Test Acc: 0.774
Validation loss decreased (-0.766654 --> -0.774062).  Saving model ...
Epoch: 26 cost time: 0.7072861194610596
Epoch: 26, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.230 Vali Acc: 0.793 Test Loss: 1.230 Test Acc: 0.793
Validation loss decreased (-0.774062 --> -0.792580).  Saving model ...
Epoch: 27 cost time: 0.5216810703277588
Epoch: 27, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.204 Vali Acc: 0.804 Test Loss: 1.204 Test Acc: 0.804
Validation loss decreased (-0.792580 --> -0.803692).  Saving model ...
Epoch: 28 cost time: 0.5944445133209229
Epoch: 28, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.178 Vali Acc: 0.807 Test Loss: 1.178 Test Acc: 0.807
Validation loss decreased (-0.803692 --> -0.807396).  Saving model ...
Epoch: 29 cost time: 0.591869592666626
Epoch: 29, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.152 Vali Acc: 0.819 Test Loss: 1.152 Test Acc: 0.819
Validation loss decreased (-0.807396 --> -0.818507).  Saving model ...
Epoch: 30 cost time: 0.5778636932373047
Epoch: 30, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.126 Vali Acc: 0.822 Test Loss: 1.126 Test Acc: 0.822
Validation loss decreased (-0.818507 --> -0.822211).  Saving model ...
Epoch: 31 cost time: 0.6374313831329346
Epoch: 31, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.100 Vali Acc: 0.833 Test Loss: 1.100 Test Acc: 0.833
Validation loss decreased (-0.822211 --> -0.833322).  Saving model ...
Epoch: 32 cost time: 0.6092853546142578
Epoch: 32, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.075 Vali Acc: 0.833 Test Loss: 1.075 Test Acc: 0.833
Validation loss decreased (-0.833322 --> -0.833323).  Saving model ...
Epoch: 33 cost time: 0.6243371963500977
Epoch: 33, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.049 Vali Acc: 0.837 Test Loss: 1.049 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 34 cost time: 0.7241668701171875
Epoch: 34, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.024 Vali Acc: 0.841 Test Loss: 1.024 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 35 cost time: 0.5322151184082031
Epoch: 35, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.999 Vali Acc: 0.844 Test Loss: 0.999 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844434).  Saving model ...
Epoch: 36 cost time: 0.9596736431121826
Epoch: 36, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.974 Vali Acc: 0.859 Test Loss: 0.974 Test Acc: 0.859
Validation loss decreased (-0.844434 --> -0.859250).  Saving model ...
Epoch: 37 cost time: 0.8551580905914307
Epoch: 37, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.949 Vali Acc: 0.863 Test Loss: 0.949 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862953).  Saving model ...
Epoch: 38 cost time: 0.8590619564056396
Epoch: 38, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.925 Vali Acc: 0.863 Test Loss: 0.925 Test Acc: 0.863
Validation loss decreased (-0.862953 --> -0.862954).  Saving model ...
Epoch: 39 cost time: 1.0447719097137451
Epoch: 39, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.901 Vali Acc: 0.867 Test Loss: 0.901 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 40 cost time: 0.7020938396453857
Epoch: 40, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.878 Vali Acc: 0.867 Test Loss: 0.878 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866658).  Saving model ...
Epoch: 41 cost time: 0.791548490524292
Epoch: 41, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.855 Vali Acc: 0.870 Test Loss: 0.855 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 42 cost time: 0.8492531776428223
Epoch: 42, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.833 Vali Acc: 0.874 Test Loss: 0.833 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874066).  Saving model ...
Epoch: 43 cost time: 0.8273155689239502
Epoch: 43, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.811 Vali Acc: 0.878 Test Loss: 0.811 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 44 cost time: 0.722531795501709
Epoch: 44, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888881).  Saving model ...
Epoch: 45 cost time: 0.8687834739685059
Epoch: 45, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.768 Vali Acc: 0.896 Test Loss: 0.768 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 46 cost time: 0.8711938858032227
Epoch: 46, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.748 Vali Acc: 0.896 Test Loss: 0.748 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 47 cost time: 0.7061712741851807
Epoch: 47, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.728 Vali Acc: 0.896 Test Loss: 0.728 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 48 cost time: 0.8907115459442139
Epoch: 48, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.708 Vali Acc: 0.904 Test Loss: 0.708 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903697).  Saving model ...
Epoch: 49 cost time: 0.582099199295044
Epoch: 49, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.689 Vali Acc: 0.904 Test Loss: 0.689 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 50 cost time: 0.707056999206543
Epoch: 50, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.671 Vali Acc: 0.907 Test Loss: 0.671 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 51 cost time: 0.6719212532043457
Epoch: 51, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.653 Vali Acc: 0.907 Test Loss: 0.653 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 52 cost time: 0.7641150951385498
Epoch: 52, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.636 Vali Acc: 0.907 Test Loss: 0.636 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 53 cost time: 0.8467762470245361
Epoch: 53, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 54 cost time: 0.7234349250793457
Epoch: 54, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.603 Vali Acc: 0.915 Test Loss: 0.603 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 55 cost time: 0.9358611106872559
Epoch: 55, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.587 Vali Acc: 0.915 Test Loss: 0.587 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 56 cost time: 0.8120546340942383
Epoch: 56, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.572 Vali Acc: 0.915 Test Loss: 0.572 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 57 cost time: 0.8710567951202393
Epoch: 57, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.557 Vali Acc: 0.915 Test Loss: 0.557 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 58 cost time: 0.7030978202819824
Epoch: 58, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.543 Vali Acc: 0.915 Test Loss: 0.543 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 59 cost time: 0.7032039165496826
Epoch: 59, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.529 Vali Acc: 0.915 Test Loss: 0.529 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 60 cost time: 0.9639716148376465
Epoch: 60, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.516 Vali Acc: 0.915 Test Loss: 0.516 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 61 cost time: 0.6377451419830322
Epoch: 61, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.503 Vali Acc: 0.907 Test Loss: 0.503 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8335323333740234
Epoch: 62, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.491 Vali Acc: 0.911 Test Loss: 0.491 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7068185806274414
Epoch: 63, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.594883918762207
Epoch: 64, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.468 Vali Acc: 0.911 Test Loss: 0.468 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6972148418426514
Epoch: 65, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.457 Vali Acc: 0.911 Test Loss: 0.457 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.7130105495452881
Epoch: 66, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.446 Vali Acc: 0.907 Test Loss: 0.446 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.6515755653381348
Epoch: 67, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.436 Vali Acc: 0.907 Test Loss: 0.436 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.778632402420044
Epoch: 68, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.6487092971801758
Epoch: 69, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.417 Vali Acc: 0.907 Test Loss: 0.417 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.8501203060150146
Epoch: 70, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.408 Vali Acc: 0.911 Test Loss: 0.408 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 8661
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8402044773101807
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.970 Vali Acc: 0.081 Test Loss: 1.970 Test Acc: 0.081
Validation loss decreased (inf --> -0.081462).  Saving model ...
Epoch: 2 cost time: 0.7972979545593262
Epoch: 2, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.949 Vali Acc: 0.100 Test Loss: 1.949 Test Acc: 0.100
Validation loss decreased (-0.081462 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.6718521118164062
Epoch: 3, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.936 Vali Acc: 0.115 Test Loss: 1.936 Test Acc: 0.115
Validation loss decreased (-0.099981 --> -0.114795).  Saving model ...
Epoch: 4 cost time: 0.7970263957977295
Epoch: 4, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.926 Vali Acc: 0.137 Test Loss: 1.926 Test Acc: 0.137
Validation loss decreased (-0.114795 --> -0.137018).  Saving model ...
Epoch: 5 cost time: 0.7299344539642334
Epoch: 5, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.914 Vali Acc: 0.163 Test Loss: 1.914 Test Acc: 0.163
Validation loss decreased (-0.137018 --> -0.162944).  Saving model ...
Epoch: 6 cost time: 0.6152987480163574
Epoch: 6, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.900 Vali Acc: 0.185 Test Loss: 1.900 Test Acc: 0.185
Validation loss decreased (-0.162944 --> -0.185166).  Saving model ...
Epoch: 7 cost time: 0.5777637958526611
Epoch: 7, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.884 Vali Acc: 0.215 Test Loss: 1.884 Test Acc: 0.215
Validation loss decreased (-0.185166 --> -0.214796).  Saving model ...
Epoch: 8 cost time: 0.5378947257995605
Epoch: 8, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.867 Vali Acc: 0.215 Test Loss: 1.867 Test Acc: 0.215
Validation loss decreased (-0.214796 --> -0.214796).  Saving model ...
Epoch: 9 cost time: 0.6411612033843994
Epoch: 9, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.848 Vali Acc: 0.244 Test Loss: 1.848 Test Acc: 0.244
Validation loss decreased (-0.214796 --> -0.244426).  Saving model ...
Epoch: 10 cost time: 0.5357851982116699
Epoch: 10, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.828 Vali Acc: 0.263 Test Loss: 1.828 Test Acc: 0.263
Validation loss decreased (-0.244426 --> -0.262945).  Saving model ...
Epoch: 11 cost time: 0.6184642314910889
Epoch: 11, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.806 Vali Acc: 0.281 Test Loss: 1.806 Test Acc: 0.281
Validation loss decreased (-0.262945 --> -0.281463).  Saving model ...
Epoch: 12 cost time: 0.5663330554962158
Epoch: 12, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.784 Vali Acc: 0.311 Test Loss: 1.784 Test Acc: 0.311
Validation loss decreased (-0.281463 --> -0.311093).  Saving model ...
Epoch: 13 cost time: 0.6836757659912109
Epoch: 13, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.761 Vali Acc: 0.315 Test Loss: 1.761 Test Acc: 0.315
Validation loss decreased (-0.311093 --> -0.314797).  Saving model ...
Epoch: 14 cost time: 0.5202984809875488
Epoch: 14, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.737 Vali Acc: 0.333 Test Loss: 1.737 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333316).  Saving model ...
Epoch: 15 cost time: 0.5552051067352295
Epoch: 15, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.712 Vali Acc: 0.352 Test Loss: 1.712 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 16 cost time: 0.6803426742553711
Epoch: 16, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.687 Vali Acc: 0.367 Test Loss: 1.687 Test Acc: 0.367
Validation loss decreased (-0.351835 --> -0.366650).  Saving model ...
Epoch: 17 cost time: 0.5191187858581543
Epoch: 17, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.661 Vali Acc: 0.396 Test Loss: 1.661 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396280).  Saving model ...
Epoch: 18 cost time: 0.608100414276123
Epoch: 18, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.635 Vali Acc: 0.426 Test Loss: 1.635 Test Acc: 0.426
Validation loss decreased (-0.396280 --> -0.425910).  Saving model ...
Epoch: 19 cost time: 0.6789770126342773
Epoch: 19, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.609 Vali Acc: 0.433 Test Loss: 1.609 Test Acc: 0.433
Validation loss decreased (-0.425910 --> -0.433317).  Saving model ...
Epoch: 20 cost time: 0.6538989543914795
Epoch: 20, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.582 Vali Acc: 0.444 Test Loss: 1.582 Test Acc: 0.444
Validation loss decreased (-0.433317 --> -0.444429).  Saving model ...
Epoch: 21 cost time: 0.8057646751403809
Epoch: 21, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.555 Vali Acc: 0.474 Test Loss: 1.555 Test Acc: 0.474
Validation loss decreased (-0.444429 --> -0.474059).  Saving model ...
Epoch: 22 cost time: 0.8145294189453125
Epoch: 22, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.528 Vali Acc: 0.496 Test Loss: 1.528 Test Acc: 0.496
Validation loss decreased (-0.474059 --> -0.496281).  Saving model ...
Epoch: 23 cost time: 0.6860473155975342
Epoch: 23, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.501 Vali Acc: 0.530 Test Loss: 1.501 Test Acc: 0.530
Validation loss decreased (-0.496281 --> -0.529615).  Saving model ...
Epoch: 24 cost time: 0.7781014442443848
Epoch: 24, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.473 Vali Acc: 0.544 Test Loss: 1.473 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544430).  Saving model ...
Epoch: 25 cost time: 0.6739740371704102
Epoch: 25, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.445 Vali Acc: 0.559 Test Loss: 1.445 Test Acc: 0.559
Validation loss decreased (-0.544430 --> -0.559245).  Saving model ...
Epoch: 26 cost time: 0.6032412052154541
Epoch: 26, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.417 Vali Acc: 0.593 Test Loss: 1.417 Test Acc: 0.593
Validation loss decreased (-0.559245 --> -0.592578).  Saving model ...
Epoch: 27 cost time: 0.6090812683105469
Epoch: 27, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.389 Vali Acc: 0.607 Test Loss: 1.389 Test Acc: 0.607
Validation loss decreased (-0.592578 --> -0.607394).  Saving model ...
Epoch: 28 cost time: 0.5356688499450684
Epoch: 28, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.361 Vali Acc: 0.622 Test Loss: 1.361 Test Acc: 0.622
Validation loss decreased (-0.607394 --> -0.622209).  Saving model ...
Epoch: 29 cost time: 0.7600929737091064
Epoch: 29, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.334 Vali Acc: 0.626 Test Loss: 1.334 Test Acc: 0.626
Validation loss decreased (-0.622209 --> -0.625913).  Saving model ...
Epoch: 30 cost time: 0.7164525985717773
Epoch: 30, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.306 Vali Acc: 0.630 Test Loss: 1.306 Test Acc: 0.630
Validation loss decreased (-0.625913 --> -0.629617).  Saving model ...
Epoch: 31 cost time: 0.7893259525299072
Epoch: 31, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.278 Vali Acc: 0.633 Test Loss: 1.278 Test Acc: 0.633
Validation loss decreased (-0.629617 --> -0.633321).  Saving model ...
Epoch: 32 cost time: 0.680842399597168
Epoch: 32, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
Validation loss decreased (-0.633321 --> -0.644432).  Saving model ...
Epoch: 33 cost time: 0.7656607627868652
Epoch: 33, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.222 Vali Acc: 0.648 Test Loss: 1.222 Test Acc: 0.648
Validation loss decreased (-0.644432 --> -0.648136).  Saving model ...
Epoch: 34 cost time: 0.6689345836639404
Epoch: 34, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.195 Vali Acc: 0.674 Test Loss: 1.195 Test Acc: 0.674
Validation loss decreased (-0.648136 --> -0.674062).  Saving model ...
Epoch: 35 cost time: 0.6929757595062256
Epoch: 35, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.167 Vali Acc: 0.696 Test Loss: 1.167 Test Acc: 0.696
Validation loss decreased (-0.674062 --> -0.696285).  Saving model ...
Epoch: 36 cost time: 0.6629350185394287
Epoch: 36, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.140 Vali Acc: 0.711 Test Loss: 1.140 Test Acc: 0.711
Validation loss decreased (-0.696285 --> -0.711100).  Saving model ...
Epoch: 37 cost time: 0.6481442451477051
Epoch: 37, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.113 Vali Acc: 0.726 Test Loss: 1.113 Test Acc: 0.726
Validation loss decreased (-0.711100 --> -0.725915).  Saving model ...
Epoch: 38 cost time: 0.8654341697692871
Epoch: 38, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.087 Vali Acc: 0.737 Test Loss: 1.087 Test Acc: 0.737
Validation loss decreased (-0.725915 --> -0.737026).  Saving model ...
Epoch: 39 cost time: 0.6964888572692871
Epoch: 39, Steps: 2 | Train Loss: 0.924 Vali Loss: 1.060 Vali Acc: 0.759 Test Loss: 1.060 Test Acc: 0.759
Validation loss decreased (-0.737026 --> -0.759249).  Saving model ...
Epoch: 40 cost time: 0.5815517902374268
Epoch: 40, Steps: 2 | Train Loss: 0.889 Vali Loss: 1.034 Vali Acc: 0.778 Test Loss: 1.034 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777767).  Saving model ...
Epoch: 41 cost time: 0.6604454517364502
Epoch: 41, Steps: 2 | Train Loss: 0.871 Vali Loss: 1.009 Vali Acc: 0.804 Test Loss: 1.009 Test Acc: 0.804
Validation loss decreased (-0.777767 --> -0.803694).  Saving model ...
Epoch: 42 cost time: 0.7273540496826172
Epoch: 42, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.983 Vali Acc: 0.815 Test Loss: 0.983 Test Acc: 0.815
Validation loss decreased (-0.803694 --> -0.814805).  Saving model ...
Epoch: 43 cost time: 0.5252461433410645
Epoch: 43, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.958 Vali Acc: 0.822 Test Loss: 0.958 Test Acc: 0.822
Validation loss decreased (-0.814805 --> -0.822213).  Saving model ...
Epoch: 44 cost time: 0.5166444778442383
Epoch: 44, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.934 Vali Acc: 0.830 Test Loss: 0.934 Test Acc: 0.830
Validation loss decreased (-0.822213 --> -0.829620).  Saving model ...
Epoch: 45 cost time: 0.6625223159790039
Epoch: 45, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.910 Vali Acc: 0.833 Test Loss: 0.910 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 46 cost time: 0.5839641094207764
Epoch: 46, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.886 Vali Acc: 0.848 Test Loss: 0.886 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848139).  Saving model ...
Epoch: 47 cost time: 0.7004175186157227
Epoch: 47, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.863 Vali Acc: 0.856 Test Loss: 0.863 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 48 cost time: 0.629227876663208
Epoch: 48, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.840 Vali Acc: 0.856 Test Loss: 0.840 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 49 cost time: 0.5652203559875488
Epoch: 49, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.818 Vali Acc: 0.867 Test Loss: 0.818 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866658).  Saving model ...
Epoch: 50 cost time: 0.6279675960540771
Epoch: 50, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.797 Vali Acc: 0.874 Test Loss: 0.797 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 51 cost time: 0.6194424629211426
Epoch: 51, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.776 Vali Acc: 0.874 Test Loss: 0.776 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874066).  Saving model ...
Epoch: 52 cost time: 0.6142585277557373
Epoch: 52, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.755 Vali Acc: 0.878 Test Loss: 0.755 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 53 cost time: 0.7109224796295166
Epoch: 53, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.736 Vali Acc: 0.889 Test Loss: 0.736 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888882).  Saving model ...
Epoch: 54 cost time: 0.5491034984588623
Epoch: 54, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.716 Vali Acc: 0.893 Test Loss: 0.716 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892585).  Saving model ...
Epoch: 55 cost time: 0.5395386219024658
Epoch: 55, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.697 Vali Acc: 0.893 Test Loss: 0.697 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892586).  Saving model ...
Epoch: 56 cost time: 0.6125452518463135
Epoch: 56, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.679 Vali Acc: 0.893 Test Loss: 0.679 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 57 cost time: 0.7404906749725342
Epoch: 57, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.662 Vali Acc: 0.896 Test Loss: 0.662 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 58 cost time: 0.6324331760406494
Epoch: 58, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.644 Vali Acc: 0.896 Test Loss: 0.644 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 59 cost time: 0.6065812110900879
Epoch: 59, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.628 Vali Acc: 0.900 Test Loss: 0.628 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 60 cost time: 0.6897058486938477
Epoch: 60, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 61 cost time: 0.7569539546966553
Epoch: 61, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.596 Vali Acc: 0.904 Test Loss: 0.596 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 62 cost time: 0.7096781730651855
Epoch: 62, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.581 Vali Acc: 0.904 Test Loss: 0.581 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 63 cost time: 0.694324254989624
Epoch: 63, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.567 Vali Acc: 0.907 Test Loss: 0.567 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 64 cost time: 0.7344799041748047
Epoch: 64, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.553 Vali Acc: 0.904 Test Loss: 0.553 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6404240131378174
Epoch: 65, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.539 Vali Acc: 0.904 Test Loss: 0.539 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8679189682006836
Epoch: 66, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.526 Vali Acc: 0.904 Test Loss: 0.526 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5677657127380371
Epoch: 67, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.514 Vali Acc: 0.904 Test Loss: 0.514 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.8170957565307617
Epoch: 68, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.502 Vali Acc: 0.904 Test Loss: 0.502 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.7964293956756592
Epoch: 69, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.490 Vali Acc: 0.907 Test Loss: 0.490 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 70 cost time: 0.6488525867462158
Epoch: 70, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.479 Vali Acc: 0.907 Test Loss: 0.479 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 71 cost time: 0.9248242378234863
Epoch: 71, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 72 cost time: 0.6195070743560791
Epoch: 72, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.457 Vali Acc: 0.907 Test Loss: 0.457 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 73 cost time: 0.5791995525360107
Epoch: 73, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 74 cost time: 0.6842184066772461
Epoch: 74, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 75 cost time: 0.5999197959899902
Epoch: 75, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 76 cost time: 0.846794605255127
Epoch: 76, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.420 Vali Acc: 0.911 Test Loss: 0.420 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 77 cost time: 0.6106789112091064
Epoch: 77, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 78 cost time: 0.8527669906616211
Epoch: 78, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 79 cost time: 0.6202797889709473
Epoch: 79, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.395 Vali Acc: 0.911 Test Loss: 0.395 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 80 cost time: 0.5720369815826416
Epoch: 80, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.387 Vali Acc: 0.915 Test Loss: 0.387 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 81 cost time: 0.8629565238952637
Epoch: 81, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.380 Vali Acc: 0.915 Test Loss: 0.380 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 82 cost time: 0.7692916393280029
Epoch: 82, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.374 Vali Acc: 0.915 Test Loss: 0.374 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 83 cost time: 0.7488536834716797
Epoch: 83, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.367 Vali Acc: 0.915 Test Loss: 0.367 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 84 cost time: 0.7071413993835449
Epoch: 84, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.361 Vali Acc: 0.915 Test Loss: 0.361 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 85 cost time: 0.6573560237884521
Epoch: 85, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 86 cost time: 0.7804853916168213
Epoch: 86, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 87 cost time: 0.7422091960906982
Epoch: 87, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 88 cost time: 0.6623184680938721
Epoch: 88, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.338 Vali Acc: 0.915 Test Loss: 0.338 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 89 cost time: 0.7985155582427979
Epoch: 89, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7586820125579834
Epoch: 90, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.329 Vali Acc: 0.911 Test Loss: 0.329 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.7171592712402344
Epoch: 91, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.7621822357177734
Epoch: 92, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.6235921382904053
Epoch: 93, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.541961669921875
Epoch: 94, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.313 Vali Acc: 0.915 Test Loss: 0.313 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 95 cost time: 0.6275849342346191
Epoch: 95, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 96 cost time: 0.7019708156585693
Epoch: 96, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.306 Vali Acc: 0.919 Test Loss: 0.306 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 97 cost time: 0.9644591808319092
Epoch: 97, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 98 cost time: 1.0301613807678223
Epoch: 98, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.0138909816741943
Epoch: 99, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 100 cost time: 0.909022331237793
Epoch: 100, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm64_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 9080
model size : 0.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs33_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.143528461456299
Epoch: 1, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.701 Vali Acc: 0.400 Test Loss: 1.701 Test Acc: 0.400
Validation loss decreased (inf --> -0.399983).  Saving model ...
Epoch: 2 cost time: 0.658923864364624
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.686 Vali Acc: 0.407 Test Loss: 1.686 Test Acc: 0.407
Validation loss decreased (-0.399983 --> -0.407391).  Saving model ...
Epoch: 3 cost time: 0.5742225646972656
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.676 Vali Acc: 0.411 Test Loss: 1.676 Test Acc: 0.411
Validation loss decreased (-0.407391 --> -0.411094).  Saving model ...
Epoch: 4 cost time: 0.687251091003418
Epoch: 4, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.668 Vali Acc: 0.415 Test Loss: 1.668 Test Acc: 0.415
Validation loss decreased (-0.411094 --> -0.414798).  Saving model ...
Epoch: 5 cost time: 0.732086181640625
Epoch: 5, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.658 Vali Acc: 0.426 Test Loss: 1.658 Test Acc: 0.426
Validation loss decreased (-0.414798 --> -0.425909).  Saving model ...
Epoch: 6 cost time: 0.8580913543701172
Epoch: 6, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.647 Vali Acc: 0.430 Test Loss: 1.647 Test Acc: 0.430
Validation loss decreased (-0.425909 --> -0.429613).  Saving model ...
Epoch: 7 cost time: 0.7095005512237549
Epoch: 7, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.633 Vali Acc: 0.433 Test Loss: 1.633 Test Acc: 0.433
Validation loss decreased (-0.429613 --> -0.433317).  Saving model ...
Epoch: 8 cost time: 0.5895404815673828
Epoch: 8, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.618 Vali Acc: 0.452 Test Loss: 1.618 Test Acc: 0.452
Validation loss decreased (-0.433317 --> -0.451836).  Saving model ...
Epoch: 9 cost time: 0.6467540264129639
Epoch: 9, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.602 Vali Acc: 0.456 Test Loss: 1.602 Test Acc: 0.456
Validation loss decreased (-0.451836 --> -0.455540).  Saving model ...
Epoch: 10 cost time: 0.6244323253631592
Epoch: 10, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.585 Vali Acc: 0.474 Test Loss: 1.585 Test Acc: 0.474
Validation loss decreased (-0.455540 --> -0.474058).  Saving model ...
Epoch: 11 cost time: 0.8179152011871338
Epoch: 11, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.566 Vali Acc: 0.504 Test Loss: 1.566 Test Acc: 0.504
Validation loss decreased (-0.474058 --> -0.503688).  Saving model ...
Epoch: 12 cost time: 0.9471185207366943
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.547 Vali Acc: 0.522 Test Loss: 1.547 Test Acc: 0.522
Validation loss decreased (-0.503688 --> -0.522207).  Saving model ...
Epoch: 13 cost time: 0.7871510982513428
Epoch: 13, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.527 Vali Acc: 0.544 Test Loss: 1.527 Test Acc: 0.544
Validation loss decreased (-0.522207 --> -0.544429).  Saving model ...
Epoch: 14 cost time: 0.6279139518737793
Epoch: 14, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.506 Vali Acc: 0.570 Test Loss: 1.506 Test Acc: 0.570
Validation loss decreased (-0.544429 --> -0.570355).  Saving model ...
Epoch: 15 cost time: 0.6912796497344971
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.485 Vali Acc: 0.581 Test Loss: 1.485 Test Acc: 0.581
Validation loss decreased (-0.570355 --> -0.581467).  Saving model ...
Epoch: 16 cost time: 0.6253800392150879
Epoch: 16, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.463 Vali Acc: 0.593 Test Loss: 1.463 Test Acc: 0.593
Validation loss decreased (-0.581467 --> -0.592578).  Saving model ...
Epoch: 17 cost time: 0.7166986465454102
Epoch: 17, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.441 Vali Acc: 0.611 Test Loss: 1.441 Test Acc: 0.611
Validation loss decreased (-0.592578 --> -0.611097).  Saving model ...
Epoch: 18 cost time: 0.6069390773773193
Epoch: 18, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.418 Vali Acc: 0.619 Test Loss: 1.418 Test Acc: 0.619
Validation loss decreased (-0.611097 --> -0.618504).  Saving model ...
Epoch: 19 cost time: 0.7180063724517822
Epoch: 19, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.395 Vali Acc: 0.630 Test Loss: 1.395 Test Acc: 0.630
Validation loss decreased (-0.618504 --> -0.629616).  Saving model ...
Epoch: 20 cost time: 0.7558653354644775
Epoch: 20, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.371 Vali Acc: 0.630 Test Loss: 1.371 Test Acc: 0.630
Validation loss decreased (-0.629616 --> -0.629616).  Saving model ...
Epoch: 21 cost time: 0.7797446250915527
Epoch: 21, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.347 Vali Acc: 0.637 Test Loss: 1.347 Test Acc: 0.637
Validation loss decreased (-0.629616 --> -0.637024).  Saving model ...
Epoch: 22 cost time: 0.9146945476531982
Epoch: 22, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.323 Vali Acc: 0.644 Test Loss: 1.323 Test Acc: 0.644
Validation loss decreased (-0.637024 --> -0.644431).  Saving model ...
Epoch: 23 cost time: 0.6557209491729736
Epoch: 23, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.298 Vali Acc: 0.648 Test Loss: 1.298 Test Acc: 0.648
Validation loss decreased (-0.644431 --> -0.648135).  Saving model ...
Epoch: 24 cost time: 0.5689387321472168
Epoch: 24, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.274 Vali Acc: 0.652 Test Loss: 1.274 Test Acc: 0.652
Validation loss decreased (-0.648135 --> -0.651839).  Saving model ...
Epoch: 25 cost time: 0.7591710090637207
Epoch: 25, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.249 Vali Acc: 0.656 Test Loss: 1.249 Test Acc: 0.656
Validation loss decreased (-0.651839 --> -0.655543).  Saving model ...
Epoch: 26 cost time: 0.6795952320098877
Epoch: 26, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.225 Vali Acc: 0.656 Test Loss: 1.225 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655543).  Saving model ...
Epoch: 27 cost time: 0.6392052173614502
Epoch: 27, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.200 Vali Acc: 0.656 Test Loss: 1.200 Test Acc: 0.656
Validation loss decreased (-0.655543 --> -0.655544).  Saving model ...
Epoch: 28 cost time: 0.7299220561981201
Epoch: 28, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.175 Vali Acc: 0.663 Test Loss: 1.175 Test Acc: 0.663
Validation loss decreased (-0.655544 --> -0.662951).  Saving model ...
Epoch: 29 cost time: 0.7321734428405762
Epoch: 29, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.150 Vali Acc: 0.670 Test Loss: 1.150 Test Acc: 0.670
Validation loss decreased (-0.662951 --> -0.670359).  Saving model ...
Epoch: 30 cost time: 0.7588450908660889
Epoch: 30, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.125 Vali Acc: 0.674 Test Loss: 1.125 Test Acc: 0.674
Validation loss decreased (-0.670359 --> -0.674063).  Saving model ...
Epoch: 31 cost time: 0.8979747295379639
Epoch: 31, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.101 Vali Acc: 0.685 Test Loss: 1.101 Test Acc: 0.685
Validation loss decreased (-0.674063 --> -0.685174).  Saving model ...
Epoch: 32 cost time: 0.6977565288543701
Epoch: 32, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.076 Vali Acc: 0.700 Test Loss: 1.076 Test Acc: 0.700
Validation loss decreased (-0.685174 --> -0.699989).  Saving model ...
Epoch: 33 cost time: 0.5019702911376953
Epoch: 33, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.052 Vali Acc: 0.704 Test Loss: 1.052 Test Acc: 0.704
Validation loss decreased (-0.699989 --> -0.703693).  Saving model ...
Epoch: 34 cost time: 0.6542139053344727
Epoch: 34, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.028 Vali Acc: 0.711 Test Loss: 1.028 Test Acc: 0.711
Validation loss decreased (-0.703693 --> -0.711101).  Saving model ...
Epoch: 35 cost time: 0.5602436065673828
Epoch: 35, Steps: 2 | Train Loss: 0.946 Vali Loss: 1.004 Vali Acc: 0.719 Test Loss: 1.004 Test Acc: 0.719
Validation loss decreased (-0.711101 --> -0.718508).  Saving model ...
Epoch: 36 cost time: 0.7284634113311768
Epoch: 36, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.981 Vali Acc: 0.733 Test Loss: 0.981 Test Acc: 0.733
Validation loss decreased (-0.718508 --> -0.733324).  Saving model ...
Epoch: 37 cost time: 0.8713123798370361
Epoch: 37, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.958 Vali Acc: 0.752 Test Loss: 0.958 Test Acc: 0.752
Validation loss decreased (-0.733324 --> -0.751842).  Saving model ...
Epoch: 38 cost time: 0.7194836139678955
Epoch: 38, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.935 Vali Acc: 0.778 Test Loss: 0.935 Test Acc: 0.778
Validation loss decreased (-0.751842 --> -0.777768).  Saving model ...
Epoch: 39 cost time: 0.8466978073120117
Epoch: 39, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.913 Vali Acc: 0.778 Test Loss: 0.913 Test Acc: 0.778
Validation loss decreased (-0.777768 --> -0.777769).  Saving model ...
Epoch: 40 cost time: 0.7651610374450684
Epoch: 40, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.891 Vali Acc: 0.781 Test Loss: 0.891 Test Acc: 0.781
Validation loss decreased (-0.777769 --> -0.781473).  Saving model ...
Epoch: 41 cost time: 0.7137501239776611
Epoch: 41, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.870 Vali Acc: 0.793 Test Loss: 0.870 Test Acc: 0.793
Validation loss decreased (-0.781473 --> -0.792584).  Saving model ...
Epoch: 42 cost time: 0.586294412612915
Epoch: 42, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.849 Vali Acc: 0.800 Test Loss: 0.849 Test Acc: 0.800
Validation loss decreased (-0.792584 --> -0.799992).  Saving model ...
Epoch: 43 cost time: 0.5617303848266602
Epoch: 43, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.828 Vali Acc: 0.807 Test Loss: 0.828 Test Acc: 0.807
Validation loss decreased (-0.799992 --> -0.807399).  Saving model ...
Epoch: 44 cost time: 0.7577946186065674
Epoch: 44, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.809 Vali Acc: 0.830 Test Loss: 0.809 Test Acc: 0.830
Validation loss decreased (-0.807399 --> -0.829622).  Saving model ...
Epoch: 45 cost time: 0.831862211227417
Epoch: 45, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.789 Vali Acc: 0.841 Test Loss: 0.789 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840733).  Saving model ...
Epoch: 46 cost time: 0.9664881229400635
Epoch: 46, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.770 Vali Acc: 0.856 Test Loss: 0.770 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 47 cost time: 0.8355724811553955
Epoch: 47, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.752 Vali Acc: 0.863 Test Loss: 0.752 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862955).  Saving model ...
Epoch: 48 cost time: 0.5958278179168701
Epoch: 48, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.734 Vali Acc: 0.863 Test Loss: 0.734 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 49 cost time: 0.6716434955596924
Epoch: 49, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.717 Vali Acc: 0.859 Test Loss: 0.717 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7878503799438477
Epoch: 50, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.701 Vali Acc: 0.863 Test Loss: 0.701 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 51 cost time: 0.6137592792510986
Epoch: 51, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.684 Vali Acc: 0.867 Test Loss: 0.684 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 52 cost time: 0.7150368690490723
Epoch: 52, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.669 Vali Acc: 0.874 Test Loss: 0.669 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874067).  Saving model ...
Epoch: 53 cost time: 0.7247161865234375
Epoch: 53, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.654 Vali Acc: 0.878 Test Loss: 0.654 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 54 cost time: 1.0211539268493652
Epoch: 54, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.639 Vali Acc: 0.878 Test Loss: 0.639 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877771).  Saving model ...
Epoch: 55 cost time: 0.6290645599365234
Epoch: 55, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.625 Vali Acc: 0.881 Test Loss: 0.625 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 56 cost time: 0.7072644233703613
Epoch: 56, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.611 Vali Acc: 0.881 Test Loss: 0.611 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 57 cost time: 0.7030107975006104
Epoch: 57, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.598 Vali Acc: 0.881 Test Loss: 0.598 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 58 cost time: 0.7734224796295166
Epoch: 58, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.585 Vali Acc: 0.881 Test Loss: 0.585 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 59 cost time: 0.7128241062164307
Epoch: 59, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.573 Vali Acc: 0.885 Test Loss: 0.573 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885179).  Saving model ...
Epoch: 60 cost time: 0.8349978923797607
Epoch: 60, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.561 Vali Acc: 0.885 Test Loss: 0.561 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 61 cost time: 0.6726856231689453
Epoch: 61, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888883).  Saving model ...
Epoch: 62 cost time: 0.7987220287322998
Epoch: 62, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 0.5910677909851074
Epoch: 63, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.528 Vali Acc: 0.885 Test Loss: 0.528 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5855906009674072
Epoch: 64, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.518 Vali Acc: 0.885 Test Loss: 0.518 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.680732011795044
Epoch: 65, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 66 cost time: 0.5952086448669434
Epoch: 66, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.498 Vali Acc: 0.889 Test Loss: 0.498 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 0.7796382904052734
Epoch: 67, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.489 Vali Acc: 0.893 Test Loss: 0.489 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 68 cost time: 0.8148682117462158
Epoch: 68, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.480 Vali Acc: 0.893 Test Loss: 0.480 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 69 cost time: 0.6670043468475342
Epoch: 69, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899995).  Saving model ...
Epoch: 70 cost time: 0.5575094223022461
Epoch: 70, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.463 Vali Acc: 0.900 Test Loss: 0.463 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 71 cost time: 0.5644450187683105
Epoch: 71, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.455 Vali Acc: 0.900 Test Loss: 0.455 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 72 cost time: 0.6506409645080566
Epoch: 72, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 73 cost time: 0.7215187549591064
Epoch: 73, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 74 cost time: 0.5399210453033447
Epoch: 74, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.433 Vali Acc: 0.904 Test Loss: 0.433 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903699).  Saving model ...
Epoch: 75 cost time: 0.7571899890899658
Epoch: 75, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 76 cost time: 0.5654714107513428
Epoch: 76, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.419 Vali Acc: 0.904 Test Loss: 0.419 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 77 cost time: 0.5552191734313965
Epoch: 77, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.413 Vali Acc: 0.904 Test Loss: 0.413 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 78 cost time: 0.5869894027709961
Epoch: 78, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.407 Vali Acc: 0.907 Test Loss: 0.407 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907403).  Saving model ...
Epoch: 79 cost time: 0.5864059925079346
Epoch: 79, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 80 cost time: 0.5962896347045898
Epoch: 80, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.395 Vali Acc: 0.907 Test Loss: 0.395 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 81 cost time: 0.6093242168426514
Epoch: 81, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.389 Vali Acc: 0.907 Test Loss: 0.389 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 82 cost time: 0.5899081230163574
Epoch: 82, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 83 cost time: 0.7451672554016113
Epoch: 83, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 84 cost time: 0.6778724193572998
Epoch: 84, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.374 Vali Acc: 0.907 Test Loss: 0.374 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 85 cost time: 0.9013369083404541
Epoch: 85, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 86 cost time: 0.6592395305633545
Epoch: 86, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.364 Vali Acc: 0.907 Test Loss: 0.364 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 87 cost time: 0.7175216674804688
Epoch: 87, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.360 Vali Acc: 0.907 Test Loss: 0.360 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 88 cost time: 0.6438033580780029
Epoch: 88, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 89 cost time: 0.8008370399475098
Epoch: 89, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.351 Vali Acc: 0.907 Test Loss: 0.351 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 90 cost time: 1.0442442893981934
Epoch: 90, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.348 Vali Acc: 0.907 Test Loss: 0.348 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 91 cost time: 0.7801549434661865
Epoch: 91, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.344 Vali Acc: 0.907 Test Loss: 0.344 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 92 cost time: 0.7698400020599365
Epoch: 92, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.340 Vali Acc: 0.907 Test Loss: 0.340 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 93 cost time: 0.8378541469573975
Epoch: 93, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 94 cost time: 0.6696121692657471
Epoch: 94, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 95 cost time: 0.7610597610473633
Epoch: 95, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.330 Vali Acc: 0.907 Test Loss: 0.330 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 96 cost time: 0.7413034439086914
Epoch: 96, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.326 Vali Acc: 0.907 Test Loss: 0.326 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 97 cost time: 0.689957857131958
Epoch: 97, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.323 Vali Acc: 0.907 Test Loss: 0.323 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 98 cost time: 0.7534205913543701
Epoch: 98, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 99 cost time: 0.9043500423431396
Epoch: 99, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.316 Vali Acc: 0.907 Test Loss: 0.316 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 100 cost time: 0.6322948932647705
Epoch: 100, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs33_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 7252
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs22_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.656172752380371
Epoch: 1, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.937 Vali Acc: 0.119 Test Loss: 1.937 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.6090927124023438
Epoch: 2, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.914 Vali Acc: 0.122 Test Loss: 1.914 Test Acc: 0.122
Validation loss decreased (-0.118499 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.895270586013794
Epoch: 3, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.900 Vali Acc: 0.122 Test Loss: 1.900 Test Acc: 0.122
Validation loss decreased (-0.122203 --> -0.122203).  Saving model ...
Epoch: 4 cost time: 0.6327571868896484
Epoch: 4, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.890 Vali Acc: 0.130 Test Loss: 1.890 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129611).  Saving model ...
Epoch: 5 cost time: 0.6958975791931152
Epoch: 5, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.877 Vali Acc: 0.133 Test Loss: 1.877 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133315).  Saving model ...
Epoch: 6 cost time: 0.7503252029418945
Epoch: 6, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.862 Vali Acc: 0.137 Test Loss: 1.862 Test Acc: 0.137
Validation loss decreased (-0.133315 --> -0.137018).  Saving model ...
Epoch: 7 cost time: 0.822242021560669
Epoch: 7, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.845 Vali Acc: 0.137 Test Loss: 1.845 Test Acc: 0.137
Validation loss decreased (-0.137018 --> -0.137019).  Saving model ...
Epoch: 8 cost time: 0.715811014175415
Epoch: 8, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.827 Vali Acc: 0.144 Test Loss: 1.827 Test Acc: 0.144
Validation loss decreased (-0.137019 --> -0.144426).  Saving model ...
Epoch: 9 cost time: 0.7038223743438721
Epoch: 9, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.807 Vali Acc: 0.152 Test Loss: 1.807 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151834).  Saving model ...
Epoch: 10 cost time: 0.5845658779144287
Epoch: 10, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.786 Vali Acc: 0.163 Test Loss: 1.786 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 11 cost time: 0.6783478260040283
Epoch: 11, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.763 Vali Acc: 0.185 Test Loss: 1.763 Test Acc: 0.185
Validation loss decreased (-0.162945 --> -0.185168).  Saving model ...
Epoch: 12 cost time: 0.6600332260131836
Epoch: 12, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.740 Vali Acc: 0.193 Test Loss: 1.740 Test Acc: 0.193
Validation loss decreased (-0.185168 --> -0.192575).  Saving model ...
Epoch: 13 cost time: 0.6891529560089111
Epoch: 13, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.716 Vali Acc: 0.207 Test Loss: 1.716 Test Acc: 0.207
Validation loss decreased (-0.192575 --> -0.207390).  Saving model ...
Epoch: 14 cost time: 0.6806905269622803
Epoch: 14, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.690 Vali Acc: 0.237 Test Loss: 1.690 Test Acc: 0.237
Validation loss decreased (-0.207390 --> -0.237020).  Saving model ...
Epoch: 15 cost time: 0.873692512512207
Epoch: 15, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.665 Vali Acc: 0.259 Test Loss: 1.665 Test Acc: 0.259
Validation loss decreased (-0.237020 --> -0.259243).  Saving model ...
Epoch: 16 cost time: 0.6505951881408691
Epoch: 16, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.638 Vali Acc: 0.278 Test Loss: 1.638 Test Acc: 0.278
Validation loss decreased (-0.259243 --> -0.277761).  Saving model ...
Epoch: 17 cost time: 0.7175087928771973
Epoch: 17, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.611 Vali Acc: 0.330 Test Loss: 1.611 Test Acc: 0.330
Validation loss decreased (-0.277761 --> -0.329614).  Saving model ...
Epoch: 18 cost time: 0.5992591381072998
Epoch: 18, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.584 Vali Acc: 0.389 Test Loss: 1.584 Test Acc: 0.389
Validation loss decreased (-0.329614 --> -0.388873).  Saving model ...
Epoch: 19 cost time: 0.5677037239074707
Epoch: 19, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.556 Vali Acc: 0.430 Test Loss: 1.556 Test Acc: 0.430
Validation loss decreased (-0.388873 --> -0.429614).  Saving model ...
Epoch: 20 cost time: 0.6352477073669434
Epoch: 20, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.529 Vali Acc: 0.452 Test Loss: 1.529 Test Acc: 0.452
Validation loss decreased (-0.429614 --> -0.451837).  Saving model ...
Epoch: 21 cost time: 0.6432437896728516
Epoch: 21, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.500 Vali Acc: 0.493 Test Loss: 1.500 Test Acc: 0.493
Validation loss decreased (-0.451837 --> -0.492578).  Saving model ...
Epoch: 22 cost time: 0.5850327014923096
Epoch: 22, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.472 Vali Acc: 0.507 Test Loss: 1.472 Test Acc: 0.507
Validation loss decreased (-0.492578 --> -0.507393).  Saving model ...
Epoch: 23 cost time: 0.9207375049591064
Epoch: 23, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.444 Vali Acc: 0.548 Test Loss: 1.444 Test Acc: 0.548
Validation loss decreased (-0.507393 --> -0.548134).  Saving model ...
Epoch: 24 cost time: 0.718843936920166
Epoch: 24, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.415 Vali Acc: 0.570 Test Loss: 1.415 Test Acc: 0.570
Validation loss decreased (-0.548134 --> -0.570356).  Saving model ...
Epoch: 25 cost time: 0.7556054592132568
Epoch: 25, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.386 Vali Acc: 0.589 Test Loss: 1.386 Test Acc: 0.589
Validation loss decreased (-0.570356 --> -0.588875).  Saving model ...
Epoch: 26 cost time: 0.7231650352478027
Epoch: 26, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.358 Vali Acc: 0.607 Test Loss: 1.358 Test Acc: 0.607
Validation loss decreased (-0.588875 --> -0.607394).  Saving model ...
Epoch: 27 cost time: 0.6520788669586182
Epoch: 27, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.329 Vali Acc: 0.630 Test Loss: 1.329 Test Acc: 0.630
Validation loss decreased (-0.607394 --> -0.629616).  Saving model ...
Epoch: 28 cost time: 0.6174960136413574
Epoch: 28, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.301 Vali Acc: 0.663 Test Loss: 1.301 Test Acc: 0.663
Validation loss decreased (-0.629616 --> -0.662950).  Saving model ...
Epoch: 29 cost time: 0.5586974620819092
Epoch: 29, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.272 Vali Acc: 0.685 Test Loss: 1.272 Test Acc: 0.685
Validation loss decreased (-0.662950 --> -0.685172).  Saving model ...
Epoch: 30 cost time: 0.6169717311859131
Epoch: 30, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.244 Vali Acc: 0.700 Test Loss: 1.244 Test Acc: 0.700
Validation loss decreased (-0.685172 --> -0.699988).  Saving model ...
Epoch: 31 cost time: 0.7825398445129395
Epoch: 31, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.216 Vali Acc: 0.730 Test Loss: 1.216 Test Acc: 0.730
Validation loss decreased (-0.699988 --> -0.729617).  Saving model ...
Epoch: 32 cost time: 0.7237429618835449
Epoch: 32, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.188 Vali Acc: 0.737 Test Loss: 1.188 Test Acc: 0.737
Validation loss decreased (-0.729617 --> -0.737025).  Saving model ...
Epoch: 33 cost time: 0.6369378566741943
Epoch: 33, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.160 Vali Acc: 0.748 Test Loss: 1.160 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748137).  Saving model ...
Epoch: 34 cost time: 0.5968444347381592
Epoch: 34, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.132 Vali Acc: 0.759 Test Loss: 1.132 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759248).  Saving model ...
Epoch: 35 cost time: 0.6319394111633301
Epoch: 35, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.105 Vali Acc: 0.778 Test Loss: 1.105 Test Acc: 0.778
Validation loss decreased (-0.759248 --> -0.777767).  Saving model ...
Epoch: 36 cost time: 0.5748043060302734
Epoch: 36, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.079 Vali Acc: 0.796 Test Loss: 1.079 Test Acc: 0.796
Validation loss decreased (-0.777767 --> -0.796286).  Saving model ...
Epoch: 37 cost time: 0.9499330520629883
Epoch: 37, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.052 Vali Acc: 0.804 Test Loss: 1.052 Test Acc: 0.804
Validation loss decreased (-0.796286 --> -0.803693).  Saving model ...
Epoch: 38 cost time: 0.6738336086273193
Epoch: 38, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.027 Vali Acc: 0.815 Test Loss: 1.027 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814805).  Saving model ...
Epoch: 39 cost time: 0.7472002506256104
Epoch: 39, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.001 Vali Acc: 0.819 Test Loss: 1.001 Test Acc: 0.819
Validation loss decreased (-0.814805 --> -0.818509).  Saving model ...
Epoch: 40 cost time: 0.7676136493682861
Epoch: 40, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.976 Vali Acc: 0.826 Test Loss: 0.976 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825916).  Saving model ...
Epoch: 41 cost time: 0.6826918125152588
Epoch: 41, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.952 Vali Acc: 0.837 Test Loss: 0.952 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837028).  Saving model ...
Epoch: 42 cost time: 0.6964962482452393
Epoch: 42, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.928 Vali Acc: 0.841 Test Loss: 0.928 Test Acc: 0.841
Validation loss decreased (-0.837028 --> -0.840731).  Saving model ...
Epoch: 43 cost time: 0.5921239852905273
Epoch: 43, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.905 Vali Acc: 0.841 Test Loss: 0.905 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840732).  Saving model ...
Epoch: 44 cost time: 0.7668132781982422
Epoch: 44, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.882 Vali Acc: 0.856 Test Loss: 0.882 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855547).  Saving model ...
Epoch: 45 cost time: 0.7350492477416992
Epoch: 45, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.860 Vali Acc: 0.863 Test Loss: 0.860 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862954).  Saving model ...
Epoch: 46 cost time: 0.8061003684997559
Epoch: 46, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.838 Vali Acc: 0.863 Test Loss: 0.838 Test Acc: 0.863
Validation loss decreased (-0.862954 --> -0.862955).  Saving model ...
Epoch: 47 cost time: 0.8204972743988037
Epoch: 47, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.817 Vali Acc: 0.874 Test Loss: 0.817 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 48 cost time: 0.7658364772796631
Epoch: 48, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.797 Vali Acc: 0.874 Test Loss: 0.797 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874066).  Saving model ...
Epoch: 49 cost time: 0.7804641723632812
Epoch: 49, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.777 Vali Acc: 0.881 Test Loss: 0.777 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 50 cost time: 0.5592350959777832
Epoch: 50, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.757 Vali Acc: 0.885 Test Loss: 0.757 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 51 cost time: 0.6767327785491943
Epoch: 51, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.738 Vali Acc: 0.889 Test Loss: 0.738 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 52 cost time: 0.5493924617767334
Epoch: 52, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.720 Vali Acc: 0.889 Test Loss: 0.720 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 53 cost time: 0.8159492015838623
Epoch: 53, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.702 Vali Acc: 0.893 Test Loss: 0.702 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 54 cost time: 0.715888500213623
Epoch: 54, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.685 Vali Acc: 0.893 Test Loss: 0.685 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 55 cost time: 1.0066030025482178
Epoch: 55, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.669 Vali Acc: 0.907 Test Loss: 0.669 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907401).  Saving model ...
Epoch: 56 cost time: 0.761969804763794
Epoch: 56, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.653 Vali Acc: 0.904 Test Loss: 0.653 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8147602081298828
Epoch: 57, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.637 Vali Acc: 0.907 Test Loss: 0.637 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 58 cost time: 0.85634446144104
Epoch: 58, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.622 Vali Acc: 0.915 Test Loss: 0.622 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 59 cost time: 0.5048213005065918
Epoch: 59, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.608 Vali Acc: 0.915 Test Loss: 0.608 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 60 cost time: 0.5281376838684082
Epoch: 60, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.594 Vali Acc: 0.919 Test Loss: 0.594 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 61 cost time: 0.7369904518127441
Epoch: 61, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.581 Vali Acc: 0.919 Test Loss: 0.581 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 62 cost time: 1.046417236328125
Epoch: 62, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.568 Vali Acc: 0.919 Test Loss: 0.568 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 63 cost time: 0.754624605178833
Epoch: 63, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.555 Vali Acc: 0.922 Test Loss: 0.555 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 64 cost time: 0.6598992347717285
Epoch: 64, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.543 Vali Acc: 0.926 Test Loss: 0.543 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925920).  Saving model ...
Epoch: 65 cost time: 0.6752300262451172
Epoch: 65, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.531 Vali Acc: 0.930 Test Loss: 0.531 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 66 cost time: 0.5765957832336426
Epoch: 66, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.519 Vali Acc: 0.930 Test Loss: 0.519 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 67 cost time: 0.6324615478515625
Epoch: 67, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.508 Vali Acc: 0.933 Test Loss: 0.508 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 68 cost time: 0.6588671207427979
Epoch: 68, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.498 Vali Acc: 0.933 Test Loss: 0.498 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 69 cost time: 0.6169540882110596
Epoch: 69, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.488 Vali Acc: 0.933 Test Loss: 0.488 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 70 cost time: 0.8287146091461182
Epoch: 70, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.478 Vali Acc: 0.933 Test Loss: 0.478 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 71 cost time: 0.7025766372680664
Epoch: 71, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.469 Vali Acc: 0.933 Test Loss: 0.469 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 72 cost time: 0.7025973796844482
Epoch: 72, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.459 Vali Acc: 0.933 Test Loss: 0.459 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 73 cost time: 0.6127994060516357
Epoch: 73, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.451 Vali Acc: 0.933 Test Loss: 0.451 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 74 cost time: 0.7516589164733887
Epoch: 74, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.442 Vali Acc: 0.933 Test Loss: 0.442 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 75 cost time: 0.6302835941314697
Epoch: 75, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.434 Vali Acc: 0.933 Test Loss: 0.434 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 76 cost time: 0.6937623023986816
Epoch: 76, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.427 Vali Acc: 0.937 Test Loss: 0.427 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 77 cost time: 0.6657919883728027
Epoch: 77, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 78 cost time: 0.6111283302307129
Epoch: 78, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.412 Vali Acc: 0.937 Test Loss: 0.412 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 79 cost time: 0.6420552730560303
Epoch: 79, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.405 Vali Acc: 0.937 Test Loss: 0.405 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 80 cost time: 0.7437474727630615
Epoch: 80, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.399 Vali Acc: 0.937 Test Loss: 0.399 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 81 cost time: 0.6434717178344727
Epoch: 81, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 82 cost time: 0.817192792892456
Epoch: 82, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 83 cost time: 0.6073498725891113
Epoch: 83, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 84 cost time: 0.6383295059204102
Epoch: 84, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.374 Vali Acc: 0.937 Test Loss: 0.374 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 85 cost time: 0.8221769332885742
Epoch: 85, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 86 cost time: 0.6524004936218262
Epoch: 86, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 87 cost time: 0.6520469188690186
Epoch: 87, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 88 cost time: 0.8635401725769043
Epoch: 88, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 89 cost time: 0.6320269107818604
Epoch: 89, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 90 cost time: 0.7082886695861816
Epoch: 90, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 91 cost time: 0.7777783870697021
Epoch: 91, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 92 cost time: 0.6278009414672852
Epoch: 92, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.334 Vali Acc: 0.937 Test Loss: 0.334 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 93 cost time: 0.6649861335754395
Epoch: 93, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.330 Vali Acc: 0.937 Test Loss: 0.330 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 94 cost time: 0.7938079833984375
Epoch: 94, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 95 cost time: 0.5807576179504395
Epoch: 95, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.937 Test Loss: 0.322 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 96 cost time: 0.9245240688323975
Epoch: 96, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 97 cost time: 0.5576543807983398
Epoch: 97, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 98 cost time: 0.6728518009185791
Epoch: 98, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 99 cost time: 0.5996189117431641
Epoch: 99, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 100 cost time: 0.5354914665222168
Epoch: 100, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs22_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 7090
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.523258686065674
Epoch: 1, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.787 Vali Acc: 0.196 Test Loss: 1.787 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.8120338916778564
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.770 Vali Acc: 0.196 Test Loss: 1.770 Test Acc: 0.196
Validation loss decreased (-0.196278 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.6346170902252197
Epoch: 3, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.757 Vali Acc: 0.200 Test Loss: 1.757 Test Acc: 0.200
Validation loss decreased (-0.196279 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.6934103965759277
Epoch: 4, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.749 Vali Acc: 0.200 Test Loss: 1.749 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 0.6650545597076416
Epoch: 5, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.739 Vali Acc: 0.207 Test Loss: 1.739 Test Acc: 0.207
Validation loss decreased (-0.199983 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 0.825145959854126
Epoch: 6, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.726 Vali Acc: 0.215 Test Loss: 1.726 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214798).  Saving model ...
Epoch: 7 cost time: 0.701596736907959
Epoch: 7, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.711 Vali Acc: 0.222 Test Loss: 1.711 Test Acc: 0.222
Validation loss decreased (-0.214798 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.6029641628265381
Epoch: 8, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.695 Vali Acc: 0.237 Test Loss: 1.695 Test Acc: 0.237
Validation loss decreased (-0.222205 --> -0.237020).  Saving model ...
Epoch: 9 cost time: 0.887622594833374
Epoch: 9, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.678 Vali Acc: 0.248 Test Loss: 1.678 Test Acc: 0.248
Validation loss decreased (-0.237020 --> -0.248131).  Saving model ...
Epoch: 10 cost time: 0.6171400547027588
Epoch: 10, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.659 Vali Acc: 0.267 Test Loss: 1.659 Test Acc: 0.267
Validation loss decreased (-0.248131 --> -0.266650).  Saving model ...
Epoch: 11 cost time: 0.5355126857757568
Epoch: 11, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.640 Vali Acc: 0.300 Test Loss: 1.640 Test Acc: 0.300
Validation loss decreased (-0.266650 --> -0.299984).  Saving model ...
Epoch: 12 cost time: 0.6410355567932129
Epoch: 12, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.619 Vali Acc: 0.348 Test Loss: 1.619 Test Acc: 0.348
Validation loss decreased (-0.299984 --> -0.348132).  Saving model ...
Epoch: 13 cost time: 0.602158784866333
Epoch: 13, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.598 Vali Acc: 0.378 Test Loss: 1.598 Test Acc: 0.378
Validation loss decreased (-0.348132 --> -0.377762).  Saving model ...
Epoch: 14 cost time: 0.5709583759307861
Epoch: 14, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.576 Vali Acc: 0.426 Test Loss: 1.576 Test Acc: 0.426
Validation loss decreased (-0.377762 --> -0.425910).  Saving model ...
Epoch: 15 cost time: 0.8178129196166992
Epoch: 15, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.554 Vali Acc: 0.456 Test Loss: 1.554 Test Acc: 0.456
Validation loss decreased (-0.425910 --> -0.455540).  Saving model ...
Epoch: 16 cost time: 0.953819751739502
Epoch: 16, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.531 Vali Acc: 0.481 Test Loss: 1.531 Test Acc: 0.481
Validation loss decreased (-0.455540 --> -0.481466).  Saving model ...
Epoch: 17 cost time: 0.7130188941955566
Epoch: 17, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.507 Vali Acc: 0.515 Test Loss: 1.507 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514800).  Saving model ...
Epoch: 18 cost time: 0.8527307510375977
Epoch: 18, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.483 Vali Acc: 0.541 Test Loss: 1.483 Test Acc: 0.541
Validation loss decreased (-0.514800 --> -0.540726).  Saving model ...
Epoch: 19 cost time: 0.9661524295806885
Epoch: 19, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.459 Vali Acc: 0.574 Test Loss: 1.459 Test Acc: 0.574
Validation loss decreased (-0.540726 --> -0.574059).  Saving model ...
Epoch: 20 cost time: 0.8320586681365967
Epoch: 20, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.435 Vali Acc: 0.600 Test Loss: 1.435 Test Acc: 0.600
Validation loss decreased (-0.574059 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.8204548358917236
Epoch: 21, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.410 Vali Acc: 0.615 Test Loss: 1.410 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 22 cost time: 0.8740344047546387
Epoch: 22, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.386 Vali Acc: 0.619 Test Loss: 1.386 Test Acc: 0.619
Validation loss decreased (-0.614801 --> -0.618505).  Saving model ...
Epoch: 23 cost time: 0.6956708431243896
Epoch: 23, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.360 Vali Acc: 0.648 Test Loss: 1.360 Test Acc: 0.648
Validation loss decreased (-0.618505 --> -0.648135).  Saving model ...
Epoch: 24 cost time: 0.7315030097961426
Epoch: 24, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.335 Vali Acc: 0.652 Test Loss: 1.335 Test Acc: 0.652
Validation loss decreased (-0.648135 --> -0.651839).  Saving model ...
Epoch: 25 cost time: 0.6670503616333008
Epoch: 25, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.310 Vali Acc: 0.663 Test Loss: 1.310 Test Acc: 0.663
Validation loss decreased (-0.651839 --> -0.662950).  Saving model ...
Epoch: 26 cost time: 0.673865556716919
Epoch: 26, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.284 Vali Acc: 0.670 Test Loss: 1.284 Test Acc: 0.670
Validation loss decreased (-0.662950 --> -0.670358).  Saving model ...
Epoch: 27 cost time: 0.5596599578857422
Epoch: 27, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.258 Vali Acc: 0.670 Test Loss: 1.258 Test Acc: 0.670
Validation loss decreased (-0.670358 --> -0.670358).  Saving model ...
Epoch: 28 cost time: 0.5466575622558594
Epoch: 28, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.233 Vali Acc: 0.689 Test Loss: 1.233 Test Acc: 0.689
Validation loss decreased (-0.670358 --> -0.688877).  Saving model ...
Epoch: 29 cost time: 0.6137080192565918
Epoch: 29, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.207 Vali Acc: 0.704 Test Loss: 1.207 Test Acc: 0.704
Validation loss decreased (-0.688877 --> -0.703692).  Saving model ...
Epoch: 30 cost time: 0.7301368713378906
Epoch: 30, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.182 Vali Acc: 0.707 Test Loss: 1.182 Test Acc: 0.707
Validation loss decreased (-0.703692 --> -0.707396).  Saving model ...
Epoch: 31 cost time: 0.5429961681365967
Epoch: 31, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.157 Vali Acc: 0.726 Test Loss: 1.157 Test Acc: 0.726
Validation loss decreased (-0.707396 --> -0.725914).  Saving model ...
Epoch: 32 cost time: 0.7252049446105957
Epoch: 32, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.131 Vali Acc: 0.748 Test Loss: 1.131 Test Acc: 0.748
Validation loss decreased (-0.725914 --> -0.748137).  Saving model ...
Epoch: 33 cost time: 0.8386449813842773
Epoch: 33, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.106 Vali Acc: 0.759 Test Loss: 1.106 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759248).  Saving model ...
Epoch: 34 cost time: 0.7118921279907227
Epoch: 34, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.081 Vali Acc: 0.778 Test Loss: 1.081 Test Acc: 0.778
Validation loss decreased (-0.759248 --> -0.777767).  Saving model ...
Epoch: 35 cost time: 0.7865595817565918
Epoch: 35, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.057 Vali Acc: 0.793 Test Loss: 1.057 Test Acc: 0.793
Validation loss decreased (-0.777767 --> -0.792582).  Saving model ...
Epoch: 36 cost time: 0.6735794544219971
Epoch: 36, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.032 Vali Acc: 0.796 Test Loss: 1.032 Test Acc: 0.796
Validation loss decreased (-0.792582 --> -0.796286).  Saving model ...
Epoch: 37 cost time: 0.7436082363128662
Epoch: 37, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.008 Vali Acc: 0.811 Test Loss: 1.008 Test Acc: 0.811
Validation loss decreased (-0.796286 --> -0.811101).  Saving model ...
Epoch: 38 cost time: 1.025987148284912
Epoch: 38, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.984 Vali Acc: 0.819 Test Loss: 0.984 Test Acc: 0.819
Validation loss decreased (-0.811101 --> -0.818509).  Saving model ...
Epoch: 39 cost time: 0.8094134330749512
Epoch: 39, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.961 Vali Acc: 0.819 Test Loss: 0.961 Test Acc: 0.819
Validation loss decreased (-0.818509 --> -0.818509).  Saving model ...
Epoch: 40 cost time: 0.6912908554077148
Epoch: 40, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.938 Vali Acc: 0.844 Test Loss: 0.938 Test Acc: 0.844
Validation loss decreased (-0.818509 --> -0.844435).  Saving model ...
Epoch: 41 cost time: 0.5982613563537598
Epoch: 41, Steps: 2 | Train Loss: 0.802 Vali Loss: 0.915 Vali Acc: 0.856 Test Loss: 0.915 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855546).  Saving model ...
Epoch: 42 cost time: 0.8531746864318848
Epoch: 42, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.893 Vali Acc: 0.863 Test Loss: 0.893 Test Acc: 0.863
Validation loss decreased (-0.855546 --> -0.862954).  Saving model ...
Epoch: 43 cost time: 0.7748110294342041
Epoch: 43, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.871 Vali Acc: 0.870 Test Loss: 0.871 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 44 cost time: 0.7798142433166504
Epoch: 44, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.850 Vali Acc: 0.870 Test Loss: 0.850 Test Acc: 0.870
Validation loss decreased (-0.870362 --> -0.870362).  Saving model ...
Epoch: 45 cost time: 0.6731734275817871
Epoch: 45, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.829 Vali Acc: 0.870 Test Loss: 0.829 Test Acc: 0.870
Validation loss decreased (-0.870362 --> -0.870362).  Saving model ...
Epoch: 46 cost time: 0.6777698993682861
Epoch: 46, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.808 Vali Acc: 0.878 Test Loss: 0.808 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877770).  Saving model ...
Epoch: 47 cost time: 0.7366914749145508
Epoch: 47, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.788 Vali Acc: 0.881 Test Loss: 0.788 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 48 cost time: 0.8126099109649658
Epoch: 48, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.769 Vali Acc: 0.885 Test Loss: 0.769 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885177).  Saving model ...
Epoch: 49 cost time: 0.6109161376953125
Epoch: 49, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.750 Vali Acc: 0.885 Test Loss: 0.750 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885178).  Saving model ...
Epoch: 50 cost time: 0.7015533447265625
Epoch: 50, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.731 Vali Acc: 0.896 Test Loss: 0.731 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896289).  Saving model ...
Epoch: 51 cost time: 0.6504964828491211
Epoch: 51, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.713 Vali Acc: 0.907 Test Loss: 0.713 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907400).  Saving model ...
Epoch: 52 cost time: 0.608259916305542
Epoch: 52, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.696 Vali Acc: 0.907 Test Loss: 0.696 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 53 cost time: 0.5743081569671631
Epoch: 53, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.679 Vali Acc: 0.907 Test Loss: 0.679 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 54 cost time: 0.7942476272583008
Epoch: 54, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.662 Vali Acc: 0.915 Test Loss: 0.662 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914808).  Saving model ...
Epoch: 55 cost time: 0.6713502407073975
Epoch: 55, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.646 Vali Acc: 0.919 Test Loss: 0.646 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 56 cost time: 0.7858965396881104
Epoch: 56, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.631 Vali Acc: 0.922 Test Loss: 0.631 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 57 cost time: 0.9070689678192139
Epoch: 57, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.615 Vali Acc: 0.922 Test Loss: 0.615 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 58 cost time: 0.6362020969390869
Epoch: 58, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.601 Vali Acc: 0.919 Test Loss: 0.601 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.607384204864502
Epoch: 59, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.587 Vali Acc: 0.922 Test Loss: 0.587 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 60 cost time: 0.7198095321655273
Epoch: 60, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.573 Vali Acc: 0.926 Test Loss: 0.573 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 61 cost time: 0.7627816200256348
Epoch: 61, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.560 Vali Acc: 0.926 Test Loss: 0.560 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 62 cost time: 0.6002459526062012
Epoch: 62, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.547 Vali Acc: 0.926 Test Loss: 0.547 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 63 cost time: 0.7797906398773193
Epoch: 63, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.535 Vali Acc: 0.926 Test Loss: 0.535 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 64 cost time: 0.7090895175933838
Epoch: 64, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.524 Vali Acc: 0.926 Test Loss: 0.524 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 65 cost time: 0.716888427734375
Epoch: 65, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 66 cost time: 0.7578845024108887
Epoch: 66, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.501 Vali Acc: 0.930 Test Loss: 0.501 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 67 cost time: 0.6559557914733887
Epoch: 67, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.6854732036590576
Epoch: 68, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.481 Vali Acc: 0.930 Test Loss: 0.481 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.6393129825592041
Epoch: 69, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.471 Vali Acc: 0.937 Test Loss: 0.471 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937032).  Saving model ...
Epoch: 70 cost time: 0.7392299175262451
Epoch: 70, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.461 Vali Acc: 0.937 Test Loss: 0.461 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 71 cost time: 0.7049753665924072
Epoch: 71, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.452 Vali Acc: 0.937 Test Loss: 0.452 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 72 cost time: 0.639596700668335
Epoch: 72, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.444 Vali Acc: 0.941 Test Loss: 0.444 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940736).  Saving model ...
Epoch: 73 cost time: 0.6814603805541992
Epoch: 73, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.435 Vali Acc: 0.941 Test Loss: 0.435 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 74 cost time: 0.7990078926086426
Epoch: 74, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.427 Vali Acc: 0.941 Test Loss: 0.427 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 75 cost time: 0.6849935054779053
Epoch: 75, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.419 Vali Acc: 0.941 Test Loss: 0.419 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 76 cost time: 0.7793879508972168
Epoch: 76, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.412 Vali Acc: 0.941 Test Loss: 0.412 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 77 cost time: 1.0548322200775146
Epoch: 77, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.405 Vali Acc: 0.941 Test Loss: 0.405 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 78 cost time: 1.0123450756072998
Epoch: 78, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.398 Vali Acc: 0.941 Test Loss: 0.398 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 79 cost time: 0.6767773628234863
Epoch: 79, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.391 Vali Acc: 0.941 Test Loss: 0.391 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 80 cost time: 0.6908903121948242
Epoch: 80, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 81 cost time: 1.240828275680542
Epoch: 81, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.379 Vali Acc: 0.941 Test Loss: 0.379 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 82 cost time: 0.7594225406646729
Epoch: 82, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.373 Vali Acc: 0.941 Test Loss: 0.373 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 83 cost time: 0.8782222270965576
Epoch: 83, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 84 cost time: 1.08353853225708
Epoch: 84, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.361 Vali Acc: 0.941 Test Loss: 0.361 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 85 cost time: 0.845421552658081
Epoch: 85, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.356 Vali Acc: 0.941 Test Loss: 0.356 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 86 cost time: 1.0805258750915527
Epoch: 86, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 87 cost time: 0.809420108795166
Epoch: 87, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 88 cost time: 1.0875537395477295
Epoch: 88, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 89 cost time: 1.0674872398376465
Epoch: 89, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 90 cost time: 1.040848970413208
Epoch: 90, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 91 cost time: 0.8814971446990967
Epoch: 91, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 92 cost time: 1.0089457035064697
Epoch: 92, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 93 cost time: 1.027205228805542
Epoch: 93, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 1.2040362358093262
Epoch: 94, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.961071252822876
Epoch: 95, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 1.2049872875213623
Epoch: 96, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.308 Vali Acc: 0.937 Test Loss: 0.308 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 1.1865277290344238
Epoch: 97, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.9981873035430908
Epoch: 98, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.8464148044586182
Epoch: 99, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.6041350364685059
Epoch: 100, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 7158
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0356404781341553
Epoch: 1, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.865 Vali Acc: 0.252 Test Loss: 1.865 Test Acc: 0.252
Validation loss decreased (inf --> -0.251833).  Saving model ...
Epoch: 2 cost time: 0.8083851337432861
Epoch: 2, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.848 Vali Acc: 0.267 Test Loss: 1.848 Test Acc: 0.267
Validation loss decreased (-0.251833 --> -0.266648).  Saving model ...
Epoch: 3 cost time: 0.734260082244873
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.837 Vali Acc: 0.270 Test Loss: 1.837 Test Acc: 0.270
Validation loss decreased (-0.266648 --> -0.270352).  Saving model ...
Epoch: 4 cost time: 1.0241823196411133
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.829 Vali Acc: 0.281 Test Loss: 1.829 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281463).  Saving model ...
Epoch: 5 cost time: 0.8878800868988037
Epoch: 5, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.818 Vali Acc: 0.281 Test Loss: 1.818 Test Acc: 0.281
Validation loss decreased (-0.281463 --> -0.281463).  Saving model ...
Epoch: 6 cost time: 1.1893470287322998
Epoch: 6, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.806 Vali Acc: 0.296 Test Loss: 1.806 Test Acc: 0.296
Validation loss decreased (-0.281463 --> -0.296278).  Saving model ...
Epoch: 7 cost time: 1.0103754997253418
Epoch: 7, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.792 Vali Acc: 0.304 Test Loss: 1.792 Test Acc: 0.304
Validation loss decreased (-0.296278 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 1.0083818435668945
Epoch: 8, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.776 Vali Acc: 0.311 Test Loss: 1.776 Test Acc: 0.311
Validation loss decreased (-0.303686 --> -0.311093).  Saving model ...
Epoch: 9 cost time: 1.0023632049560547
Epoch: 9, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.760 Vali Acc: 0.330 Test Loss: 1.760 Test Acc: 0.330
Validation loss decreased (-0.311093 --> -0.329612).  Saving model ...
Epoch: 10 cost time: 0.9156434535980225
Epoch: 10, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.742 Vali Acc: 0.344 Test Loss: 1.742 Test Acc: 0.344
Validation loss decreased (-0.329612 --> -0.344427).  Saving model ...
Epoch: 11 cost time: 0.9551141262054443
Epoch: 11, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.723 Vali Acc: 0.348 Test Loss: 1.723 Test Acc: 0.348
Validation loss decreased (-0.344427 --> -0.348131).  Saving model ...
Epoch: 12 cost time: 0.84824538230896
Epoch: 12, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.703 Vali Acc: 0.378 Test Loss: 1.703 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 13 cost time: 0.7088227272033691
Epoch: 13, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.683 Vali Acc: 0.404 Test Loss: 1.683 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 14 cost time: 0.9025490283966064
Epoch: 14, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.662 Vali Acc: 0.415 Test Loss: 1.662 Test Acc: 0.415
Validation loss decreased (-0.403687 --> -0.414798).  Saving model ...
Epoch: 15 cost time: 0.745079517364502
Epoch: 15, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.640 Vali Acc: 0.422 Test Loss: 1.640 Test Acc: 0.422
Validation loss decreased (-0.414798 --> -0.422206).  Saving model ...
Epoch: 16 cost time: 1.1156513690948486
Epoch: 16, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.617 Vali Acc: 0.433 Test Loss: 1.617 Test Acc: 0.433
Validation loss decreased (-0.422206 --> -0.433317).  Saving model ...
Epoch: 17 cost time: 0.7651369571685791
Epoch: 17, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.594 Vali Acc: 0.441 Test Loss: 1.594 Test Acc: 0.441
Validation loss decreased (-0.433317 --> -0.440725).  Saving model ...
Epoch: 18 cost time: 0.8689963817596436
Epoch: 18, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.571 Vali Acc: 0.452 Test Loss: 1.571 Test Acc: 0.452
Validation loss decreased (-0.440725 --> -0.451836).  Saving model ...
Epoch: 19 cost time: 0.9437236785888672
Epoch: 19, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.546 Vali Acc: 0.459 Test Loss: 1.546 Test Acc: 0.459
Validation loss decreased (-0.451836 --> -0.459244).  Saving model ...
Epoch: 20 cost time: 1.043285846710205
Epoch: 20, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.522 Vali Acc: 0.467 Test Loss: 1.522 Test Acc: 0.467
Validation loss decreased (-0.459244 --> -0.466651).  Saving model ...
Epoch: 21 cost time: 0.7849581241607666
Epoch: 21, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.497 Vali Acc: 0.478 Test Loss: 1.497 Test Acc: 0.478
Validation loss decreased (-0.466651 --> -0.477763).  Saving model ...
Epoch: 22 cost time: 1.05989670753479
Epoch: 22, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.471 Vali Acc: 0.489 Test Loss: 1.471 Test Acc: 0.489
Validation loss decreased (-0.477763 --> -0.488874).  Saving model ...
Epoch: 23 cost time: 0.9778764247894287
Epoch: 23, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.446 Vali Acc: 0.522 Test Loss: 1.446 Test Acc: 0.522
Validation loss decreased (-0.488874 --> -0.522208).  Saving model ...
Epoch: 24 cost time: 0.8258750438690186
Epoch: 24, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.420 Vali Acc: 0.533 Test Loss: 1.420 Test Acc: 0.533
Validation loss decreased (-0.522208 --> -0.533319).  Saving model ...
Epoch: 25 cost time: 1.1155285835266113
Epoch: 25, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.393 Vali Acc: 0.570 Test Loss: 1.393 Test Acc: 0.570
Validation loss decreased (-0.533319 --> -0.570356).  Saving model ...
Epoch: 26 cost time: 0.7528767585754395
Epoch: 26, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.367 Vali Acc: 0.593 Test Loss: 1.367 Test Acc: 0.593
Validation loss decreased (-0.570356 --> -0.592579).  Saving model ...
Epoch: 27 cost time: 1.0721125602722168
Epoch: 27, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.340 Vali Acc: 0.626 Test Loss: 1.340 Test Acc: 0.626
Validation loss decreased (-0.592579 --> -0.625913).  Saving model ...
Epoch: 28 cost time: 1.1264164447784424
Epoch: 28, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.314 Vali Acc: 0.633 Test Loss: 1.314 Test Acc: 0.633
Validation loss decreased (-0.625913 --> -0.633320).  Saving model ...
Epoch: 29 cost time: 0.9079842567443848
Epoch: 29, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.287 Vali Acc: 0.685 Test Loss: 1.287 Test Acc: 0.685
Validation loss decreased (-0.633320 --> -0.685172).  Saving model ...
Epoch: 30 cost time: 0.8181955814361572
Epoch: 30, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.260 Vali Acc: 0.715 Test Loss: 1.260 Test Acc: 0.715
Validation loss decreased (-0.685172 --> -0.714802).  Saving model ...
Epoch: 31 cost time: 0.6595771312713623
Epoch: 31, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.233 Vali Acc: 0.752 Test Loss: 1.233 Test Acc: 0.752
Validation loss decreased (-0.714802 --> -0.751840).  Saving model ...
Epoch: 32 cost time: 0.8561365604400635
Epoch: 32, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.206 Vali Acc: 0.793 Test Loss: 1.206 Test Acc: 0.793
Validation loss decreased (-0.751840 --> -0.792581).  Saving model ...
Epoch: 33 cost time: 0.8338973522186279
Epoch: 33, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.179 Vali Acc: 0.807 Test Loss: 1.179 Test Acc: 0.807
Validation loss decreased (-0.792581 --> -0.807396).  Saving model ...
Epoch: 34 cost time: 1.1201083660125732
Epoch: 34, Steps: 2 | Train Loss: 1.033 Vali Loss: 1.152 Vali Acc: 0.811 Test Loss: 1.152 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811100).  Saving model ...
Epoch: 35 cost time: 0.8764283657073975
Epoch: 35, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.126 Vali Acc: 0.815 Test Loss: 1.126 Test Acc: 0.815
Validation loss decreased (-0.811100 --> -0.814804).  Saving model ...
Epoch: 36 cost time: 1.1070165634155273
Epoch: 36, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.099 Vali Acc: 0.830 Test Loss: 1.099 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829619).  Saving model ...
Epoch: 37 cost time: 0.7088949680328369
Epoch: 37, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.073 Vali Acc: 0.837 Test Loss: 1.073 Test Acc: 0.837
Validation loss decreased (-0.829619 --> -0.837026).  Saving model ...
Epoch: 38 cost time: 0.8109142780303955
Epoch: 38, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.047 Vali Acc: 0.848 Test Loss: 1.047 Test Acc: 0.848
Validation loss decreased (-0.837026 --> -0.848138).  Saving model ...
Epoch: 39 cost time: 1.1459314823150635
Epoch: 39, Steps: 2 | Train Loss: 0.903 Vali Loss: 1.021 Vali Acc: 0.852 Test Loss: 1.021 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 40 cost time: 0.7924273014068604
Epoch: 40, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.996 Vali Acc: 0.852 Test Loss: 0.996 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851842).  Saving model ...
Epoch: 41 cost time: 0.626370906829834
Epoch: 41, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.972 Vali Acc: 0.856 Test Loss: 0.972 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855546).  Saving model ...
Epoch: 42 cost time: 0.6319208145141602
Epoch: 42, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.947 Vali Acc: 0.870 Test Loss: 0.947 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870361).  Saving model ...
Epoch: 43 cost time: 0.8560192584991455
Epoch: 43, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.923 Vali Acc: 0.874 Test Loss: 0.923 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 44 cost time: 0.9297833442687988
Epoch: 44, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.899 Vali Acc: 0.874 Test Loss: 0.899 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874065).  Saving model ...
Epoch: 45 cost time: 0.9423539638519287
Epoch: 45, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.876 Vali Acc: 0.874 Test Loss: 0.876 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874065).  Saving model ...
Epoch: 46 cost time: 0.7127232551574707
Epoch: 46, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.854 Vali Acc: 0.878 Test Loss: 0.854 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 47 cost time: 0.691481351852417
Epoch: 47, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.832 Vali Acc: 0.881 Test Loss: 0.832 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 48 cost time: 1.1245663166046143
Epoch: 48, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.811 Vali Acc: 0.881 Test Loss: 0.811 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 49 cost time: 1.012817144393921
Epoch: 49, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.790 Vali Acc: 0.893 Test Loss: 0.790 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 50 cost time: 1.2460343837738037
Epoch: 50, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.770 Vali Acc: 0.893 Test Loss: 0.770 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 51 cost time: 0.841925859451294
Epoch: 51, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.750 Vali Acc: 0.896 Test Loss: 0.750 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 52 cost time: 0.9662504196166992
Epoch: 52, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.731 Vali Acc: 0.904 Test Loss: 0.731 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903696).  Saving model ...
Epoch: 53 cost time: 0.9927206039428711
Epoch: 53, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.713 Vali Acc: 0.904 Test Loss: 0.713 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 54 cost time: 0.9442250728607178
Epoch: 54, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.695 Vali Acc: 0.900 Test Loss: 0.695 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6287648677825928
Epoch: 55, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.678 Vali Acc: 0.900 Test Loss: 0.678 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1454310417175293
Epoch: 56, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.661 Vali Acc: 0.904 Test Loss: 0.661 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 57 cost time: 0.8790135383605957
Epoch: 57, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9344778060913086
Epoch: 58, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.629 Vali Acc: 0.907 Test Loss: 0.629 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 59 cost time: 0.94187331199646
Epoch: 59, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.614 Vali Acc: 0.907 Test Loss: 0.614 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 60 cost time: 1.1252729892730713
Epoch: 60, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.600 Vali Acc: 0.907 Test Loss: 0.600 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 61 cost time: 0.8425827026367188
Epoch: 61, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 62 cost time: 0.6894996166229248
Epoch: 62, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.572 Vali Acc: 0.915 Test Loss: 0.572 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 63 cost time: 0.8751540184020996
Epoch: 63, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.559 Vali Acc: 0.915 Test Loss: 0.559 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 64 cost time: 0.8199667930603027
Epoch: 64, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.547 Vali Acc: 0.915 Test Loss: 0.547 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 65 cost time: 0.8854925632476807
Epoch: 65, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.535 Vali Acc: 0.922 Test Loss: 0.535 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 66 cost time: 1.277557611465454
Epoch: 66, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.524 Vali Acc: 0.919 Test Loss: 0.524 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.188633680343628
Epoch: 67, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.512 Vali Acc: 0.919 Test Loss: 0.512 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.9534156322479248
Epoch: 68, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.502 Vali Acc: 0.915 Test Loss: 0.502 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9965834617614746
Epoch: 69, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.492 Vali Acc: 0.915 Test Loss: 0.492 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.787468671798706
Epoch: 70, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8069672584533691
Epoch: 71, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.472 Vali Acc: 0.915 Test Loss: 0.472 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8723945617675781
Epoch: 72, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.8343675136566162
Epoch: 73, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.454 Vali Acc: 0.911 Test Loss: 0.454 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.029207468032837
Epoch: 74, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.1131489276885986
Epoch: 75, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 6921
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0321264266967773
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.781 Vali Acc: 0.211 Test Loss: 1.781 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.832205057144165
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.764 Vali Acc: 0.233 Test Loss: 1.764 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.9696023464202881
Epoch: 3, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.752 Vali Acc: 0.237 Test Loss: 1.752 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.8819680213928223
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.744 Vali Acc: 0.241 Test Loss: 1.744 Test Acc: 0.241
Validation loss decreased (-0.237020 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.9371984004974365
Epoch: 5, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.734 Vali Acc: 0.252 Test Loss: 1.734 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 6 cost time: 0.7915477752685547
Epoch: 6, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.722 Vali Acc: 0.263 Test Loss: 1.722 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 7 cost time: 1.01873779296875
Epoch: 7, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.709 Vali Acc: 0.281 Test Loss: 1.709 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281464).  Saving model ...
Epoch: 8 cost time: 1.025937795639038
Epoch: 8, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.694 Vali Acc: 0.315 Test Loss: 1.694 Test Acc: 0.315
Validation loss decreased (-0.281464 --> -0.314798).  Saving model ...
Epoch: 9 cost time: 0.7579443454742432
Epoch: 9, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.678 Vali Acc: 0.322 Test Loss: 1.678 Test Acc: 0.322
Validation loss decreased (-0.314798 --> -0.322205).  Saving model ...
Epoch: 10 cost time: 0.7869551181793213
Epoch: 10, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.660 Vali Acc: 0.348 Test Loss: 1.660 Test Acc: 0.348
Validation loss decreased (-0.322205 --> -0.348132).  Saving model ...
Epoch: 11 cost time: 1.046008586883545
Epoch: 11, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.642 Vali Acc: 0.356 Test Loss: 1.642 Test Acc: 0.356
Validation loss decreased (-0.348132 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.7269392013549805
Epoch: 12, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.622 Vali Acc: 0.370 Test Loss: 1.622 Test Acc: 0.370
Validation loss decreased (-0.355539 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 0.8757092952728271
Epoch: 13, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.602 Vali Acc: 0.385 Test Loss: 1.602 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 14 cost time: 0.7371904850006104
Epoch: 14, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.581 Vali Acc: 0.404 Test Loss: 1.581 Test Acc: 0.404
Validation loss decreased (-0.385169 --> -0.403688).  Saving model ...
Epoch: 15 cost time: 0.7052602767944336
Epoch: 15, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.559 Vali Acc: 0.407 Test Loss: 1.559 Test Acc: 0.407
Validation loss decreased (-0.403688 --> -0.407392).  Saving model ...
Epoch: 16 cost time: 0.6753616333007812
Epoch: 16, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.537 Vali Acc: 0.426 Test Loss: 1.537 Test Acc: 0.426
Validation loss decreased (-0.407392 --> -0.425911).  Saving model ...
Epoch: 17 cost time: 0.9461474418640137
Epoch: 17, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.514 Vali Acc: 0.448 Test Loss: 1.514 Test Acc: 0.448
Validation loss decreased (-0.425911 --> -0.448133).  Saving model ...
Epoch: 18 cost time: 0.8124432563781738
Epoch: 18, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.490 Vali Acc: 0.481 Test Loss: 1.490 Test Acc: 0.481
Validation loss decreased (-0.448133 --> -0.481467).  Saving model ...
Epoch: 19 cost time: 0.8168721199035645
Epoch: 19, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.467 Vali Acc: 0.500 Test Loss: 1.467 Test Acc: 0.500
Validation loss decreased (-0.481467 --> -0.499985).  Saving model ...
Epoch: 20 cost time: 0.9729743003845215
Epoch: 20, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.442 Vali Acc: 0.537 Test Loss: 1.442 Test Acc: 0.537
Validation loss decreased (-0.499985 --> -0.537023).  Saving model ...
Epoch: 21 cost time: 0.7899832725524902
Epoch: 21, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.418 Vali Acc: 0.593 Test Loss: 1.418 Test Acc: 0.593
Validation loss decreased (-0.537023 --> -0.592578).  Saving model ...
Epoch: 22 cost time: 0.7359015941619873
Epoch: 22, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.393 Vali Acc: 0.633 Test Loss: 1.393 Test Acc: 0.633
Validation loss decreased (-0.592578 --> -0.633319).  Saving model ...
Epoch: 23 cost time: 0.8087787628173828
Epoch: 23, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.368 Vali Acc: 0.663 Test Loss: 1.368 Test Acc: 0.663
Validation loss decreased (-0.633319 --> -0.662949).  Saving model ...
Epoch: 24 cost time: 0.993199348449707
Epoch: 24, Steps: 2 | Train Loss: 1.337 Vali Loss: 1.343 Vali Acc: 0.685 Test Loss: 1.343 Test Acc: 0.685
Validation loss decreased (-0.662949 --> -0.685172).  Saving model ...
Epoch: 25 cost time: 0.6574935913085938
Epoch: 25, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.317 Vali Acc: 0.719 Test Loss: 1.317 Test Acc: 0.719
Validation loss decreased (-0.685172 --> -0.718505).  Saving model ...
Epoch: 26 cost time: 0.9662327766418457
Epoch: 26, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.292 Vali Acc: 0.733 Test Loss: 1.292 Test Acc: 0.733
Validation loss decreased (-0.718505 --> -0.733320).  Saving model ...
Epoch: 27 cost time: 1.0621497631072998
Epoch: 27, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.266 Vali Acc: 0.733 Test Loss: 1.266 Test Acc: 0.733
Validation loss decreased (-0.733320 --> -0.733321).  Saving model ...
Epoch: 28 cost time: 0.7541453838348389
Epoch: 28, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.241 Vali Acc: 0.737 Test Loss: 1.241 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737025).  Saving model ...
Epoch: 29 cost time: 0.8167078495025635
Epoch: 29, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.215 Vali Acc: 0.748 Test Loss: 1.215 Test Acc: 0.748
Validation loss decreased (-0.737025 --> -0.748136).  Saving model ...
Epoch: 30 cost time: 0.7746725082397461
Epoch: 30, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.189 Vali Acc: 0.759 Test Loss: 1.189 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759247).  Saving model ...
Epoch: 31 cost time: 0.8996837139129639
Epoch: 31, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.164 Vali Acc: 0.763 Test Loss: 1.164 Test Acc: 0.763
Validation loss decreased (-0.759247 --> -0.762951).  Saving model ...
Epoch: 32 cost time: 0.9193868637084961
Epoch: 32, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.138 Vali Acc: 0.774 Test Loss: 1.138 Test Acc: 0.774
Validation loss decreased (-0.762951 --> -0.774063).  Saving model ...
Epoch: 33 cost time: 0.7101995944976807
Epoch: 33, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.113 Vali Acc: 0.774 Test Loss: 1.113 Test Acc: 0.774
Validation loss decreased (-0.774063 --> -0.774063).  Saving model ...
Epoch: 34 cost time: 0.552248477935791
Epoch: 34, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.087 Vali Acc: 0.793 Test Loss: 1.087 Test Acc: 0.793
Validation loss decreased (-0.774063 --> -0.792582).  Saving model ...
Epoch: 35 cost time: 0.9667870998382568
Epoch: 35, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.062 Vali Acc: 0.804 Test Loss: 1.062 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803693).  Saving model ...
Epoch: 36 cost time: 0.8621039390563965
Epoch: 36, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.037 Vali Acc: 0.811 Test Loss: 1.037 Test Acc: 0.811
Validation loss decreased (-0.803693 --> -0.811101).  Saving model ...
Epoch: 37 cost time: 1.0231118202209473
Epoch: 37, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.013 Vali Acc: 0.822 Test Loss: 1.013 Test Acc: 0.822
Validation loss decreased (-0.811101 --> -0.822212).  Saving model ...
Epoch: 38 cost time: 0.8108136653900146
Epoch: 38, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.989 Vali Acc: 0.826 Test Loss: 0.989 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825916).  Saving model ...
Epoch: 39 cost time: 0.6658585071563721
Epoch: 39, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.965 Vali Acc: 0.833 Test Loss: 0.965 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833324).  Saving model ...
Epoch: 40 cost time: 0.798469066619873
Epoch: 40, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.941 Vali Acc: 0.844 Test Loss: 0.941 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844435).  Saving model ...
Epoch: 41 cost time: 0.6156487464904785
Epoch: 41, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.918 Vali Acc: 0.852 Test Loss: 0.918 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 42 cost time: 0.9508621692657471
Epoch: 42, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.895 Vali Acc: 0.856 Test Loss: 0.895 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 43 cost time: 1.2222635746002197
Epoch: 43, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.873 Vali Acc: 0.863 Test Loss: 0.873 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862954).  Saving model ...
Epoch: 44 cost time: 0.6375937461853027
Epoch: 44, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.851 Vali Acc: 0.867 Test Loss: 0.851 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 45 cost time: 0.998605489730835
Epoch: 45, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.830 Vali Acc: 0.874 Test Loss: 0.830 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 46 cost time: 0.7298269271850586
Epoch: 46, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.809 Vali Acc: 0.881 Test Loss: 0.809 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881473).  Saving model ...
Epoch: 47 cost time: 0.7607583999633789
Epoch: 47, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.789 Vali Acc: 0.881 Test Loss: 0.789 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 48 cost time: 0.5949249267578125
Epoch: 48, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.769 Vali Acc: 0.885 Test Loss: 0.769 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885177).  Saving model ...
Epoch: 49 cost time: 0.7177886962890625
Epoch: 49, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.750 Vali Acc: 0.893 Test Loss: 0.750 Test Acc: 0.893
Validation loss decreased (-0.885177 --> -0.892585).  Saving model ...
Epoch: 50 cost time: 0.8097755908966064
Epoch: 50, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.731 Vali Acc: 0.896 Test Loss: 0.731 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 51 cost time: 0.8976359367370605
Epoch: 51, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.713 Vali Acc: 0.900 Test Loss: 0.713 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 52 cost time: 0.7295386791229248
Epoch: 52, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.696 Vali Acc: 0.904 Test Loss: 0.696 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 53 cost time: 0.6593966484069824
Epoch: 53, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.679 Vali Acc: 0.904 Test Loss: 0.679 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 54 cost time: 0.7269163131713867
Epoch: 54, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.662 Vali Acc: 0.907 Test Loss: 0.662 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907401).  Saving model ...
Epoch: 55 cost time: 0.8553764820098877
Epoch: 55, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.646 Vali Acc: 0.907 Test Loss: 0.646 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 56 cost time: 0.587273359298706
Epoch: 56, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.631 Vali Acc: 0.907 Test Loss: 0.631 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 57 cost time: 0.6554064750671387
Epoch: 57, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.616 Vali Acc: 0.907 Test Loss: 0.616 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 58 cost time: 0.6732206344604492
Epoch: 58, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.602 Vali Acc: 0.907 Test Loss: 0.602 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 59 cost time: 0.8715419769287109
Epoch: 59, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.588 Vali Acc: 0.907 Test Loss: 0.588 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 60 cost time: 0.7570390701293945
Epoch: 60, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.575 Vali Acc: 0.904 Test Loss: 0.575 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8323066234588623
Epoch: 61, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.563 Vali Acc: 0.907 Test Loss: 0.563 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 62 cost time: 1.004687786102295
Epoch: 62, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.550 Vali Acc: 0.907 Test Loss: 0.550 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 63 cost time: 0.5755109786987305
Epoch: 63, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.539 Vali Acc: 0.911 Test Loss: 0.539 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 64 cost time: 0.7237739562988281
Epoch: 64, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.527 Vali Acc: 0.911 Test Loss: 0.527 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 65 cost time: 0.6097266674041748
Epoch: 65, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.517 Vali Acc: 0.919 Test Loss: 0.517 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918513).  Saving model ...
Epoch: 66 cost time: 0.68300461769104
Epoch: 66, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 67 cost time: 0.7893126010894775
Epoch: 67, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.496 Vali Acc: 0.915 Test Loss: 0.496 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8951032161712646
Epoch: 68, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6914968490600586
Epoch: 69, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.477 Vali Acc: 0.919 Test Loss: 0.477 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 70 cost time: 0.9383189678192139
Epoch: 70, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.468 Vali Acc: 0.919 Test Loss: 0.468 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 71 cost time: 0.7212352752685547
Epoch: 71, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.460 Vali Acc: 0.919 Test Loss: 0.460 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 72 cost time: 0.8079423904418945
Epoch: 72, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 73 cost time: 0.7343363761901855
Epoch: 73, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.443 Vali Acc: 0.919 Test Loss: 0.443 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 74 cost time: 1.0727884769439697
Epoch: 74, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.435 Vali Acc: 0.919 Test Loss: 0.435 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 75 cost time: 0.8330163955688477
Epoch: 75, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.428 Vali Acc: 0.919 Test Loss: 0.428 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 76 cost time: 0.7796289920806885
Epoch: 76, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.421 Vali Acc: 0.919 Test Loss: 0.421 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 77 cost time: 0.9039561748504639
Epoch: 77, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.415 Vali Acc: 0.915 Test Loss: 0.415 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.9174706935882568
Epoch: 78, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.408 Vali Acc: 0.915 Test Loss: 0.408 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.7559044361114502
Epoch: 79, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8170228004455566
Epoch: 80, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.396 Vali Acc: 0.915 Test Loss: 0.396 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 81 cost time: 0.8571836948394775
Epoch: 81, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.390 Vali Acc: 0.919 Test Loss: 0.390 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 82 cost time: 0.7408733367919922
Epoch: 82, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.384 Vali Acc: 0.915 Test Loss: 0.384 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.8425247669219971
Epoch: 83, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.8471715450286865
Epoch: 84, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.374 Vali Acc: 0.915 Test Loss: 0.374 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8980121612548828
Epoch: 85, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.6637382507324219
Epoch: 86, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.364 Vali Acc: 0.915 Test Loss: 0.364 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.6724386215209961
Epoch: 87, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.7103657722473145
Epoch: 88, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 1.059788703918457
Epoch: 89, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.8424625396728516
Epoch: 90, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.6531269550323486
Epoch: 91, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 6980
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.304708957672119
Epoch: 1, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.785 Vali Acc: 0.274 Test Loss: 1.785 Test Acc: 0.274
Validation loss decreased (inf --> -0.274056).  Saving model ...
Epoch: 2 cost time: 1.0946388244628906
Epoch: 2, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.770 Vali Acc: 0.289 Test Loss: 1.770 Test Acc: 0.289
Validation loss decreased (-0.274056 --> -0.288871).  Saving model ...
Epoch: 3 cost time: 0.9017796516418457
Epoch: 3, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.760 Vali Acc: 0.315 Test Loss: 1.760 Test Acc: 0.315
Validation loss decreased (-0.288871 --> -0.314797).  Saving model ...
Epoch: 4 cost time: 0.6968085765838623
Epoch: 4, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.752 Vali Acc: 0.322 Test Loss: 1.752 Test Acc: 0.322
Validation loss decreased (-0.314797 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.7165372371673584
Epoch: 5, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.743 Vali Acc: 0.333 Test Loss: 1.743 Test Acc: 0.333
Validation loss decreased (-0.322205 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.8662388324737549
Epoch: 6, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.731 Vali Acc: 0.344 Test Loss: 1.731 Test Acc: 0.344
Validation loss decreased (-0.333316 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 0.7248234748840332
Epoch: 7, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.718 Vali Acc: 0.348 Test Loss: 1.718 Test Acc: 0.348
Validation loss decreased (-0.344427 --> -0.348131).  Saving model ...
Epoch: 8 cost time: 0.7035462856292725
Epoch: 8, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.704 Vali Acc: 0.352 Test Loss: 1.704 Test Acc: 0.352
Validation loss decreased (-0.348131 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.6696412563323975
Epoch: 9, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.688 Vali Acc: 0.356 Test Loss: 1.688 Test Acc: 0.356
Validation loss decreased (-0.351835 --> -0.355539).  Saving model ...
Epoch: 10 cost time: 0.8606417179107666
Epoch: 10, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.671 Vali Acc: 0.367 Test Loss: 1.671 Test Acc: 0.367
Validation loss decreased (-0.355539 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 0.8015551567077637
Epoch: 11, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.654 Vali Acc: 0.367 Test Loss: 1.654 Test Acc: 0.367
Validation loss decreased (-0.366650 --> -0.366650).  Saving model ...
Epoch: 12 cost time: 0.9174211025238037
Epoch: 12, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.635 Vali Acc: 0.378 Test Loss: 1.635 Test Acc: 0.378
Validation loss decreased (-0.366650 --> -0.377761).  Saving model ...
Epoch: 13 cost time: 0.8594915866851807
Epoch: 13, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.616 Vali Acc: 0.385 Test Loss: 1.616 Test Acc: 0.385
Validation loss decreased (-0.377761 --> -0.385169).  Saving model ...
Epoch: 14 cost time: 1.0177421569824219
Epoch: 14, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.595 Vali Acc: 0.396 Test Loss: 1.595 Test Acc: 0.396
Validation loss decreased (-0.385169 --> -0.396280).  Saving model ...
Epoch: 15 cost time: 0.635890007019043
Epoch: 15, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.575 Vali Acc: 0.400 Test Loss: 1.575 Test Acc: 0.400
Validation loss decreased (-0.396280 --> -0.399984).  Saving model ...
Epoch: 16 cost time: 1.106835126876831
Epoch: 16, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.553 Vali Acc: 0.411 Test Loss: 1.553 Test Acc: 0.411
Validation loss decreased (-0.399984 --> -0.411096).  Saving model ...
Epoch: 17 cost time: 0.8744142055511475
Epoch: 17, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.531 Vali Acc: 0.422 Test Loss: 1.531 Test Acc: 0.422
Validation loss decreased (-0.411096 --> -0.422207).  Saving model ...
Epoch: 18 cost time: 0.7717981338500977
Epoch: 18, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.509 Vali Acc: 0.444 Test Loss: 1.509 Test Acc: 0.444
Validation loss decreased (-0.422207 --> -0.444429).  Saving model ...
Epoch: 19 cost time: 0.9675018787384033
Epoch: 19, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.486 Vali Acc: 0.456 Test Loss: 1.486 Test Acc: 0.456
Validation loss decreased (-0.444429 --> -0.455541).  Saving model ...
Epoch: 20 cost time: 0.9044821262359619
Epoch: 20, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.463 Vali Acc: 0.463 Test Loss: 1.463 Test Acc: 0.463
Validation loss decreased (-0.455541 --> -0.462948).  Saving model ...
Epoch: 21 cost time: 0.9396505355834961
Epoch: 21, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.439 Vali Acc: 0.500 Test Loss: 1.439 Test Acc: 0.500
Validation loss decreased (-0.462948 --> -0.499986).  Saving model ...
Epoch: 22 cost time: 0.8524875640869141
Epoch: 22, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.415 Vali Acc: 0.511 Test Loss: 1.415 Test Acc: 0.511
Validation loss decreased (-0.499986 --> -0.511097).  Saving model ...
Epoch: 23 cost time: 0.7392542362213135
Epoch: 23, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.391 Vali Acc: 0.530 Test Loss: 1.391 Test Acc: 0.530
Validation loss decreased (-0.511097 --> -0.529616).  Saving model ...
Epoch: 24 cost time: 0.8326911926269531
Epoch: 24, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.367 Vali Acc: 0.559 Test Loss: 1.367 Test Acc: 0.559
Validation loss decreased (-0.529616 --> -0.559246).  Saving model ...
Epoch: 25 cost time: 0.7447183132171631
Epoch: 25, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
Validation loss decreased (-0.559246 --> -0.581468).  Saving model ...
Epoch: 26 cost time: 0.7715482711791992
Epoch: 26, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.319 Vali Acc: 0.604 Test Loss: 1.319 Test Acc: 0.604
Validation loss decreased (-0.581468 --> -0.603691).  Saving model ...
Epoch: 27 cost time: 0.6994333267211914
Epoch: 27, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.294 Vali Acc: 0.637 Test Loss: 1.294 Test Acc: 0.637
Validation loss decreased (-0.603691 --> -0.637024).  Saving model ...
Epoch: 28 cost time: 0.8278529644012451
Epoch: 28, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.270 Vali Acc: 0.678 Test Loss: 1.270 Test Acc: 0.678
Validation loss decreased (-0.637024 --> -0.677765).  Saving model ...
Epoch: 29 cost time: 1.1734585762023926
Epoch: 29, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.245 Vali Acc: 0.696 Test Loss: 1.245 Test Acc: 0.696
Validation loss decreased (-0.677765 --> -0.696284).  Saving model ...
Epoch: 30 cost time: 1.173840045928955
Epoch: 30, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.220 Vali Acc: 0.719 Test Loss: 1.220 Test Acc: 0.719
Validation loss decreased (-0.696284 --> -0.718506).  Saving model ...
Epoch: 31 cost time: 0.9991888999938965
Epoch: 31, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.195 Vali Acc: 0.730 Test Loss: 1.195 Test Acc: 0.730
Validation loss decreased (-0.718506 --> -0.729618).  Saving model ...
Epoch: 32 cost time: 0.8485355377197266
Epoch: 32, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.171 Vali Acc: 0.763 Test Loss: 1.171 Test Acc: 0.763
Validation loss decreased (-0.729618 --> -0.762951).  Saving model ...
Epoch: 33 cost time: 0.9876585006713867
Epoch: 33, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.146 Vali Acc: 0.793 Test Loss: 1.146 Test Acc: 0.793
Validation loss decreased (-0.762951 --> -0.792581).  Saving model ...
Epoch: 34 cost time: 0.7937068939208984
Epoch: 34, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.121 Vali Acc: 0.819 Test Loss: 1.121 Test Acc: 0.819
Validation loss decreased (-0.792581 --> -0.818507).  Saving model ...
Epoch: 35 cost time: 1.0520424842834473
Epoch: 35, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.097 Vali Acc: 0.841 Test Loss: 1.097 Test Acc: 0.841
Validation loss decreased (-0.818507 --> -0.840730).  Saving model ...
Epoch: 36 cost time: 0.9100148677825928
Epoch: 36, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.073 Vali Acc: 0.848 Test Loss: 1.073 Test Acc: 0.848
Validation loss decreased (-0.840730 --> -0.848137).  Saving model ...
Epoch: 37 cost time: 0.796539306640625
Epoch: 37, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.049 Vali Acc: 0.863 Test Loss: 1.049 Test Acc: 0.863
Validation loss decreased (-0.848137 --> -0.862952).  Saving model ...
Epoch: 38 cost time: 0.8677208423614502
Epoch: 38, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.025 Vali Acc: 0.863 Test Loss: 1.025 Test Acc: 0.863
Validation loss decreased (-0.862952 --> -0.862953).  Saving model ...
Epoch: 39 cost time: 0.9728765487670898
Epoch: 39, Steps: 2 | Train Loss: 0.867 Vali Loss: 1.001 Vali Acc: 0.867 Test Loss: 1.001 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 40 cost time: 0.7722053527832031
Epoch: 40, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.978 Vali Acc: 0.867 Test Loss: 0.978 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 41 cost time: 1.1204471588134766
Epoch: 41, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.955 Vali Acc: 0.863 Test Loss: 0.955 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1092965602874756
Epoch: 42, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.933 Vali Acc: 0.867 Test Loss: 0.933 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 43 cost time: 0.9359490871429443
Epoch: 43, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.911 Vali Acc: 0.867 Test Loss: 0.911 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866658).  Saving model ...
Epoch: 44 cost time: 0.7190899848937988
Epoch: 44, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.889 Vali Acc: 0.878 Test Loss: 0.889 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877769).  Saving model ...
Epoch: 45 cost time: 0.7379860877990723
Epoch: 45, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.868 Vali Acc: 0.878 Test Loss: 0.868 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877769).  Saving model ...
Epoch: 46 cost time: 0.793795108795166
Epoch: 46, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.847 Vali Acc: 0.881 Test Loss: 0.847 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881473).  Saving model ...
Epoch: 47 cost time: 1.011240005493164
Epoch: 47, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.826 Vali Acc: 0.900 Test Loss: 0.826 Test Acc: 0.900
Validation loss decreased (-0.881473 --> -0.899992).  Saving model ...
Epoch: 48 cost time: 0.812849760055542
Epoch: 48, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.806 Vali Acc: 0.911 Test Loss: 0.806 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911103).  Saving model ...
Epoch: 49 cost time: 0.8068525791168213
Epoch: 49, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.786 Vali Acc: 0.907 Test Loss: 0.786 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7704215049743652
Epoch: 50, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.767 Vali Acc: 0.907 Test Loss: 0.767 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0078186988830566
Epoch: 51, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.748 Vali Acc: 0.907 Test Loss: 0.748 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8990862369537354
Epoch: 52, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.730 Vali Acc: 0.915 Test Loss: 0.730 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914808).  Saving model ...
Epoch: 53 cost time: 0.8684260845184326
Epoch: 53, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.712 Vali Acc: 0.915 Test Loss: 0.712 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 54 cost time: 1.007631778717041
Epoch: 54, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.694 Vali Acc: 0.915 Test Loss: 0.694 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 55 cost time: 0.9985370635986328
Epoch: 55, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.677 Vali Acc: 0.911 Test Loss: 0.677 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9539010524749756
Epoch: 56, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.661 Vali Acc: 0.919 Test Loss: 0.661 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 57 cost time: 0.8531091213226318
Epoch: 57, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.645 Vali Acc: 0.919 Test Loss: 0.645 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 58 cost time: 0.8297839164733887
Epoch: 58, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.629 Vali Acc: 0.922 Test Loss: 0.629 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 59 cost time: 0.7046616077423096
Epoch: 59, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 60 cost time: 0.6884045600891113
Epoch: 60, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.600 Vali Acc: 0.922 Test Loss: 0.600 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 61 cost time: 0.8409054279327393
Epoch: 61, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.586 Vali Acc: 0.926 Test Loss: 0.586 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 62 cost time: 0.7174005508422852
Epoch: 62, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.572 Vali Acc: 0.930 Test Loss: 0.572 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 63 cost time: 0.821997880935669
Epoch: 63, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.559 Vali Acc: 0.930 Test Loss: 0.559 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 64 cost time: 1.2741541862487793
Epoch: 64, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.547 Vali Acc: 0.933 Test Loss: 0.547 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 65 cost time: 0.9838111400604248
Epoch: 65, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 66 cost time: 0.9361958503723145
Epoch: 66, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.523 Vali Acc: 0.933 Test Loss: 0.523 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 67 cost time: 0.9433698654174805
Epoch: 67, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.511 Vali Acc: 0.933 Test Loss: 0.511 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 68 cost time: 1.2550647258758545
Epoch: 68, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.500 Vali Acc: 0.930 Test Loss: 0.500 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7656314373016357
Epoch: 69, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.490 Vali Acc: 0.930 Test Loss: 0.490 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.10795259475708
Epoch: 70, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.480 Vali Acc: 0.926 Test Loss: 0.480 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 1.1061322689056396
Epoch: 71, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.470 Vali Acc: 0.926 Test Loss: 0.470 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9874863624572754
Epoch: 72, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.460 Vali Acc: 0.926 Test Loss: 0.460 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.188382625579834
Epoch: 73, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.0078363418579102
Epoch: 74, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.442 Vali Acc: 0.926 Test Loss: 0.442 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7972917556762695
Epoch: 75, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.433 Vali Acc: 0.926 Test Loss: 0.433 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 1.0962934494018555
Epoch: 76, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 77 cost time: 1.2399158477783203
Epoch: 77, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.417 Vali Acc: 0.933 Test Loss: 0.417 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 78 cost time: 1.012439250946045
Epoch: 78, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 79 cost time: 0.8063280582427979
Epoch: 79, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.402 Vali Acc: 0.933 Test Loss: 0.402 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 80 cost time: 1.185417652130127
Epoch: 80, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 81 cost time: 0.7383565902709961
Epoch: 81, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 82 cost time: 0.8261020183563232
Epoch: 82, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 83 cost time: 0.7856013774871826
Epoch: 83, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.376 Vali Acc: 0.933 Test Loss: 0.376 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8733031749725342
Epoch: 84, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7765991687774658
Epoch: 85, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.9150948524475098
Epoch: 86, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.359 Vali Acc: 0.933 Test Loss: 0.359 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.792855978012085
Epoch: 87, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.8386886119842529
Epoch: 88, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.9571373462677002
Epoch: 89, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.6954696178436279
Epoch: 90, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.339 Vali Acc: 0.930 Test Loss: 0.339 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.952552318572998
Epoch: 91, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.7331690788269043
Epoch: 92, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 7254
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6034414768218994
Epoch: 1, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.918 Vali Acc: 0.056 Test Loss: 1.918 Test Acc: 0.056
Validation loss decreased (inf --> -0.055536).  Saving model ...
Epoch: 2 cost time: 0.7991271018981934
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.901 Vali Acc: 0.056 Test Loss: 1.901 Test Acc: 0.056
Validation loss decreased (-0.055536 --> -0.055537).  Saving model ...
Epoch: 3 cost time: 1.0645363330841064
Epoch: 3, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.889 Vali Acc: 0.059 Test Loss: 1.889 Test Acc: 0.059
Validation loss decreased (-0.055537 --> -0.059240).  Saving model ...
Epoch: 4 cost time: 0.8156747817993164
Epoch: 4, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.880 Vali Acc: 0.063 Test Loss: 1.880 Test Acc: 0.063
Validation loss decreased (-0.059240 --> -0.062944).  Saving model ...
Epoch: 5 cost time: 1.0021982192993164
Epoch: 5, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.870 Vali Acc: 0.063 Test Loss: 1.870 Test Acc: 0.063
Validation loss decreased (-0.062944 --> -0.062944).  Saving model ...
Epoch: 6 cost time: 1.0733129978179932
Epoch: 6, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.857 Vali Acc: 0.081 Test Loss: 1.857 Test Acc: 0.081
Validation loss decreased (-0.062944 --> -0.081463).  Saving model ...
Epoch: 7 cost time: 0.7613098621368408
Epoch: 7, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.843 Vali Acc: 0.081 Test Loss: 1.843 Test Acc: 0.081
Validation loss decreased (-0.081463 --> -0.081463).  Saving model ...
Epoch: 8 cost time: 0.5920171737670898
Epoch: 8, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.827 Vali Acc: 0.089 Test Loss: 1.827 Test Acc: 0.089
Validation loss decreased (-0.081463 --> -0.088871).  Saving model ...
Epoch: 9 cost time: 0.79494309425354
Epoch: 9, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.810 Vali Acc: 0.100 Test Loss: 1.810 Test Acc: 0.100
Validation loss decreased (-0.088871 --> -0.099982).  Saving model ...
Epoch: 10 cost time: 0.7506189346313477
Epoch: 10, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.792 Vali Acc: 0.104 Test Loss: 1.792 Test Acc: 0.104
Validation loss decreased (-0.099982 --> -0.103686).  Saving model ...
Epoch: 11 cost time: 0.911468505859375
Epoch: 11, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.773 Vali Acc: 0.122 Test Loss: 1.773 Test Acc: 0.122
Validation loss decreased (-0.103686 --> -0.122204).  Saving model ...
Epoch: 12 cost time: 1.0323567390441895
Epoch: 12, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.753 Vali Acc: 0.141 Test Loss: 1.753 Test Acc: 0.141
Validation loss decreased (-0.122204 --> -0.140723).  Saving model ...
Epoch: 13 cost time: 0.8239669799804688
Epoch: 13, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.732 Vali Acc: 0.170 Test Loss: 1.732 Test Acc: 0.170
Validation loss decreased (-0.140723 --> -0.170353).  Saving model ...
Epoch: 14 cost time: 0.8935644626617432
Epoch: 14, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.710 Vali Acc: 0.193 Test Loss: 1.710 Test Acc: 0.193
Validation loss decreased (-0.170353 --> -0.192575).  Saving model ...
Epoch: 15 cost time: 0.745943546295166
Epoch: 15, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.688 Vali Acc: 0.211 Test Loss: 1.688 Test Acc: 0.211
Validation loss decreased (-0.192575 --> -0.211094).  Saving model ...
Epoch: 16 cost time: 0.7325186729431152
Epoch: 16, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.665 Vali Acc: 0.241 Test Loss: 1.665 Test Acc: 0.241
Validation loss decreased (-0.211094 --> -0.240724).  Saving model ...
Epoch: 17 cost time: 0.6809070110321045
Epoch: 17, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.642 Vali Acc: 0.259 Test Loss: 1.642 Test Acc: 0.259
Validation loss decreased (-0.240724 --> -0.259243).  Saving model ...
Epoch: 18 cost time: 0.7863662242889404
Epoch: 18, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.618 Vali Acc: 0.289 Test Loss: 1.618 Test Acc: 0.289
Validation loss decreased (-0.259243 --> -0.288873).  Saving model ...
Epoch: 19 cost time: 0.7096142768859863
Epoch: 19, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.593 Vali Acc: 0.344 Test Loss: 1.593 Test Acc: 0.344
Validation loss decreased (-0.288873 --> -0.344429).  Saving model ...
Epoch: 20 cost time: 0.8016793727874756
Epoch: 20, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.569 Vali Acc: 0.404 Test Loss: 1.569 Test Acc: 0.404
Validation loss decreased (-0.344429 --> -0.403688).  Saving model ...
Epoch: 21 cost time: 0.7012810707092285
Epoch: 21, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.543 Vali Acc: 0.448 Test Loss: 1.543 Test Acc: 0.448
Validation loss decreased (-0.403688 --> -0.448133).  Saving model ...
Epoch: 22 cost time: 0.5916826725006104
Epoch: 22, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.518 Vali Acc: 0.489 Test Loss: 1.518 Test Acc: 0.489
Validation loss decreased (-0.448133 --> -0.488874).  Saving model ...
Epoch: 23 cost time: 1.0126490592956543
Epoch: 23, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.492 Vali Acc: 0.522 Test Loss: 1.492 Test Acc: 0.522
Validation loss decreased (-0.488874 --> -0.522207).  Saving model ...
Epoch: 24 cost time: 0.6291813850402832
Epoch: 24, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.467 Vali Acc: 0.552 Test Loss: 1.467 Test Acc: 0.552
Validation loss decreased (-0.522207 --> -0.551837).  Saving model ...
Epoch: 25 cost time: 0.8097507953643799
Epoch: 25, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.440 Vali Acc: 0.570 Test Loss: 1.440 Test Acc: 0.570
Validation loss decreased (-0.551837 --> -0.570356).  Saving model ...
Epoch: 26 cost time: 0.9000101089477539
Epoch: 26, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.414 Vali Acc: 0.607 Test Loss: 1.414 Test Acc: 0.607
Validation loss decreased (-0.570356 --> -0.607393).  Saving model ...
Epoch: 27 cost time: 0.8004415035247803
Epoch: 27, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.388 Vali Acc: 0.615 Test Loss: 1.388 Test Acc: 0.615
Validation loss decreased (-0.607393 --> -0.614801).  Saving model ...
Epoch: 28 cost time: 1.0312376022338867
Epoch: 28, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.362 Vali Acc: 0.659 Test Loss: 1.362 Test Acc: 0.659
Validation loss decreased (-0.614801 --> -0.659246).  Saving model ...
Epoch: 29 cost time: 0.841787576675415
Epoch: 29, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.335 Vali Acc: 0.689 Test Loss: 1.335 Test Acc: 0.689
Validation loss decreased (-0.659246 --> -0.688876).  Saving model ...
Epoch: 30 cost time: 1.0431883335113525
Epoch: 30, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.309 Vali Acc: 0.700 Test Loss: 1.309 Test Acc: 0.700
Validation loss decreased (-0.688876 --> -0.699987).  Saving model ...
Epoch: 31 cost time: 0.7599813938140869
Epoch: 31, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.282 Vali Acc: 0.715 Test Loss: 1.282 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 32 cost time: 0.6276960372924805
Epoch: 32, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.256 Vali Acc: 0.726 Test Loss: 1.256 Test Acc: 0.726
Validation loss decreased (-0.714802 --> -0.725913).  Saving model ...
Epoch: 33 cost time: 0.5817651748657227
Epoch: 33, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.229 Vali Acc: 0.741 Test Loss: 1.229 Test Acc: 0.741
Validation loss decreased (-0.725913 --> -0.740728).  Saving model ...
Epoch: 34 cost time: 0.8226070404052734
Epoch: 34, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.203 Vali Acc: 0.748 Test Loss: 1.203 Test Acc: 0.748
Validation loss decreased (-0.740728 --> -0.748136).  Saving model ...
Epoch: 35 cost time: 0.7762284278869629
Epoch: 35, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.176 Vali Acc: 0.763 Test Loss: 1.176 Test Acc: 0.763
Validation loss decreased (-0.748136 --> -0.762951).  Saving model ...
Epoch: 36 cost time: 0.7152786254882812
Epoch: 36, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.150 Vali Acc: 0.778 Test Loss: 1.150 Test Acc: 0.778
Validation loss decreased (-0.762951 --> -0.777766).  Saving model ...
Epoch: 37 cost time: 0.9106206893920898
Epoch: 37, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.124 Vali Acc: 0.789 Test Loss: 1.124 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 38 cost time: 0.7751824855804443
Epoch: 38, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.098 Vali Acc: 0.800 Test Loss: 1.098 Test Acc: 0.800
Validation loss decreased (-0.788878 --> -0.799989).  Saving model ...
Epoch: 39 cost time: 0.7806789875030518
Epoch: 39, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.073 Vali Acc: 0.811 Test Loss: 1.073 Test Acc: 0.811
Validation loss decreased (-0.799989 --> -0.811100).  Saving model ...
Epoch: 40 cost time: 0.8298935890197754
Epoch: 40, Steps: 2 | Train Loss: 0.945 Vali Loss: 1.048 Vali Acc: 0.807 Test Loss: 1.048 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7139296531677246
Epoch: 41, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.023 Vali Acc: 0.826 Test Loss: 1.023 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825916).  Saving model ...
Epoch: 42 cost time: 0.8297324180603027
Epoch: 42, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.998 Vali Acc: 0.837 Test Loss: 0.998 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837027).  Saving model ...
Epoch: 43 cost time: 0.832493782043457
Epoch: 43, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.974 Vali Acc: 0.841 Test Loss: 0.974 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 44 cost time: 0.7925894260406494
Epoch: 44, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.950 Vali Acc: 0.841 Test Loss: 0.950 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840731).  Saving model ...
Epoch: 45 cost time: 0.7398266792297363
Epoch: 45, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.927 Vali Acc: 0.848 Test Loss: 0.927 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 46 cost time: 0.8361058235168457
Epoch: 46, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.904 Vali Acc: 0.852 Test Loss: 0.904 Test Acc: 0.852
Validation loss decreased (-0.848139 --> -0.851843).  Saving model ...
Epoch: 47 cost time: 0.9765236377716064
Epoch: 47, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.881 Vali Acc: 0.856 Test Loss: 0.881 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 48 cost time: 1.1191866397857666
Epoch: 48, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.859 Vali Acc: 0.856 Test Loss: 0.859 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 49 cost time: 0.7777059078216553
Epoch: 49, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.837 Vali Acc: 0.859 Test Loss: 0.837 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 50 cost time: 0.8212680816650391
Epoch: 50, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.816 Vali Acc: 0.859 Test Loss: 0.816 Test Acc: 0.859
Validation loss decreased (-0.859251 --> -0.859251).  Saving model ...
Epoch: 51 cost time: 0.7027509212493896
Epoch: 51, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.796 Vali Acc: 0.867 Test Loss: 0.796 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 52 cost time: 0.8559093475341797
Epoch: 52, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.776 Vali Acc: 0.870 Test Loss: 0.776 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 53 cost time: 0.8594002723693848
Epoch: 53, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.756 Vali Acc: 0.870 Test Loss: 0.756 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
Epoch: 54 cost time: 0.866680383682251
Epoch: 54, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.737 Vali Acc: 0.874 Test Loss: 0.737 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 55 cost time: 0.9993569850921631
Epoch: 55, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.719 Vali Acc: 0.874 Test Loss: 0.719 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 56 cost time: 1.0293219089508057
Epoch: 56, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.701 Vali Acc: 0.885 Test Loss: 0.701 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885178).  Saving model ...
Epoch: 57 cost time: 0.7684488296508789
Epoch: 57, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.684 Vali Acc: 0.893 Test Loss: 0.684 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 58 cost time: 0.9414248466491699
Epoch: 58, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.667 Vali Acc: 0.896 Test Loss: 0.667 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 59 cost time: 0.6843481063842773
Epoch: 59, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.651 Vali Acc: 0.893 Test Loss: 0.651 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8494365215301514
Epoch: 60, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.635 Vali Acc: 0.900 Test Loss: 0.635 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 61 cost time: 0.9644994735717773
Epoch: 61, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.620 Vali Acc: 0.904 Test Loss: 0.620 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 62 cost time: 0.7760837078094482
Epoch: 62, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.605 Vali Acc: 0.904 Test Loss: 0.605 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 63 cost time: 0.7807083129882812
Epoch: 63, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.591 Vali Acc: 0.904 Test Loss: 0.591 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 64 cost time: 0.7697722911834717
Epoch: 64, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.577 Vali Acc: 0.904 Test Loss: 0.577 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 65 cost time: 0.7283449172973633
Epoch: 65, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.049971103668213
Epoch: 66, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.552 Vali Acc: 0.911 Test Loss: 0.552 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 67 cost time: 1.0249438285827637
Epoch: 67, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.540 Vali Acc: 0.915 Test Loss: 0.540 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914809).  Saving model ...
Epoch: 68 cost time: 0.8271286487579346
Epoch: 68, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.529 Vali Acc: 0.915 Test Loss: 0.529 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 69 cost time: 1.2395298480987549
Epoch: 69, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.517 Vali Acc: 0.919 Test Loss: 0.517 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918513).  Saving model ...
Epoch: 70 cost time: 1.0991528034210205
Epoch: 70, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.507 Vali Acc: 0.915 Test Loss: 0.507 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9242520332336426
Epoch: 71, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.496 Vali Acc: 0.915 Test Loss: 0.496 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9185628890991211
Epoch: 72, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.861884593963623
Epoch: 73, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.477 Vali Acc: 0.911 Test Loss: 0.477 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7145226001739502
Epoch: 74, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7251334190368652
Epoch: 75, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.8670716285705566
Epoch: 76, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.450 Vali Acc: 0.907 Test Loss: 0.450 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.8837795257568359
Epoch: 77, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.442 Vali Acc: 0.911 Test Loss: 0.442 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.944969654083252
Epoch: 78, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 79 cost time: 0.6756842136383057
Epoch: 79, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.427 Vali Acc: 0.919 Test Loss: 0.427 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 80 cost time: 0.7665982246398926
Epoch: 80, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 81 cost time: 0.8288311958312988
Epoch: 81, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.413 Vali Acc: 0.919 Test Loss: 0.413 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 82 cost time: 0.7827963829040527
Epoch: 82, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.406 Vali Acc: 0.919 Test Loss: 0.406 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 83 cost time: 0.5836822986602783
Epoch: 83, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.400 Vali Acc: 0.919 Test Loss: 0.400 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 84 cost time: 0.6328210830688477
Epoch: 84, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 85 cost time: 0.8519394397735596
Epoch: 85, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.388 Vali Acc: 0.922 Test Loss: 0.388 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 86 cost time: 0.7986428737640381
Epoch: 86, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6297416687011719
Epoch: 87, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.377 Vali Acc: 0.919 Test Loss: 0.377 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.687514066696167
Epoch: 88, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.6917319297790527
Epoch: 89, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.6026053428649902
Epoch: 90, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 91 cost time: 0.7267394065856934
Epoch: 91, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 92 cost time: 1.0554046630859375
Epoch: 92, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 93 cost time: 0.7496724128723145
Epoch: 93, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 94 cost time: 0.9486453533172607
Epoch: 94, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.343 Vali Acc: 0.926 Test Loss: 0.343 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 95 cost time: 0.7916231155395508
Epoch: 95, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.339 Vali Acc: 0.926 Test Loss: 0.339 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 96 cost time: 0.7317512035369873
Epoch: 96, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 97 cost time: 0.8766729831695557
Epoch: 97, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 98 cost time: 0.8603298664093018
Epoch: 98, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 99 cost time: 0.7676475048065186
Epoch: 99, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 100 cost time: 0.7512445449829102
Epoch: 100, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 7402
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs8_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7604997158050537
Epoch: 1, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.785 Vali Acc: 0.337 Test Loss: 1.785 Test Acc: 0.337
Validation loss decreased (inf --> -0.337019).  Saving model ...
Epoch: 2 cost time: 0.7602488994598389
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.770 Vali Acc: 0.348 Test Loss: 1.770 Test Acc: 0.348
Validation loss decreased (-0.337019 --> -0.348130).  Saving model ...
Epoch: 3 cost time: 0.7890713214874268
Epoch: 3, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.760 Vali Acc: 0.348 Test Loss: 1.760 Test Acc: 0.348
Validation loss decreased (-0.348130 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.8367965221405029
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.753 Vali Acc: 0.356 Test Loss: 1.753 Test Acc: 0.356
Validation loss decreased (-0.348131 --> -0.355538).  Saving model ...
Epoch: 5 cost time: 0.7491881847381592
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.743 Vali Acc: 0.356 Test Loss: 1.743 Test Acc: 0.356
Validation loss decreased (-0.355538 --> -0.355538).  Saving model ...
Epoch: 6 cost time: 0.8164074420928955
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.731 Vali Acc: 0.356 Test Loss: 1.731 Test Acc: 0.356
Validation loss decreased (-0.355538 --> -0.355538).  Saving model ...
Epoch: 7 cost time: 0.7641761302947998
Epoch: 7, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.718 Vali Acc: 0.359 Test Loss: 1.718 Test Acc: 0.359
Validation loss decreased (-0.355538 --> -0.359242).  Saving model ...
Epoch: 8 cost time: 0.9007155895233154
Epoch: 8, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.703 Vali Acc: 0.363 Test Loss: 1.703 Test Acc: 0.363
Validation loss decreased (-0.359242 --> -0.362946).  Saving model ...
Epoch: 9 cost time: 0.7654690742492676
Epoch: 9, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.687 Vali Acc: 0.374 Test Loss: 1.687 Test Acc: 0.374
Validation loss decreased (-0.362946 --> -0.374057).  Saving model ...
Epoch: 10 cost time: 0.637869119644165
Epoch: 10, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.670 Vali Acc: 0.389 Test Loss: 1.670 Test Acc: 0.389
Validation loss decreased (-0.374057 --> -0.388872).  Saving model ...
Epoch: 11 cost time: 0.8520276546478271
Epoch: 11, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.652 Vali Acc: 0.393 Test Loss: 1.652 Test Acc: 0.393
Validation loss decreased (-0.388872 --> -0.392576).  Saving model ...
Epoch: 12 cost time: 0.8203527927398682
Epoch: 12, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.633 Vali Acc: 0.400 Test Loss: 1.633 Test Acc: 0.400
Validation loss decreased (-0.392576 --> -0.399984).  Saving model ...
Epoch: 13 cost time: 0.8726761341094971
Epoch: 13, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.613 Vali Acc: 0.404 Test Loss: 1.613 Test Acc: 0.404
Validation loss decreased (-0.399984 --> -0.403688).  Saving model ...
Epoch: 14 cost time: 0.8132269382476807
Epoch: 14, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.592 Vali Acc: 0.407 Test Loss: 1.592 Test Acc: 0.407
Validation loss decreased (-0.403688 --> -0.407391).  Saving model ...
Epoch: 15 cost time: 0.5651042461395264
Epoch: 15, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.571 Vali Acc: 0.426 Test Loss: 1.571 Test Acc: 0.426
Validation loss decreased (-0.407391 --> -0.425910).  Saving model ...
Epoch: 16 cost time: 0.617560625076294
Epoch: 16, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.550 Vali Acc: 0.441 Test Loss: 1.550 Test Acc: 0.441
Validation loss decreased (-0.425910 --> -0.440725).  Saving model ...
Epoch: 17 cost time: 0.9172248840332031
Epoch: 17, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.528 Vali Acc: 0.478 Test Loss: 1.528 Test Acc: 0.478
Validation loss decreased (-0.440725 --> -0.477763).  Saving model ...
Epoch: 18 cost time: 0.8482437133789062
Epoch: 18, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.505 Vali Acc: 0.493 Test Loss: 1.505 Test Acc: 0.493
Validation loss decreased (-0.477763 --> -0.492578).  Saving model ...
Epoch: 19 cost time: 0.6927816867828369
Epoch: 19, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.482 Vali Acc: 0.507 Test Loss: 1.482 Test Acc: 0.507
Validation loss decreased (-0.492578 --> -0.507393).  Saving model ...
Epoch: 20 cost time: 0.9487314224243164
Epoch: 20, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.459 Vali Acc: 0.526 Test Loss: 1.459 Test Acc: 0.526
Validation loss decreased (-0.507393 --> -0.525911).  Saving model ...
Epoch: 21 cost time: 0.8402085304260254
Epoch: 21, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.435 Vali Acc: 0.544 Test Loss: 1.435 Test Acc: 0.544
Validation loss decreased (-0.525911 --> -0.544430).  Saving model ...
Epoch: 22 cost time: 0.6979143619537354
Epoch: 22, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.411 Vali Acc: 0.559 Test Loss: 1.411 Test Acc: 0.559
Validation loss decreased (-0.544430 --> -0.559245).  Saving model ...
Epoch: 23 cost time: 0.8067378997802734
Epoch: 23, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.387 Vali Acc: 0.585 Test Loss: 1.387 Test Acc: 0.585
Validation loss decreased (-0.559245 --> -0.585171).  Saving model ...
Epoch: 24 cost time: 0.7639341354370117
Epoch: 24, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.363 Vali Acc: 0.615 Test Loss: 1.363 Test Acc: 0.615
Validation loss decreased (-0.585171 --> -0.614801).  Saving model ...
Epoch: 25 cost time: 0.8090875148773193
Epoch: 25, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.338 Vali Acc: 0.630 Test Loss: 1.338 Test Acc: 0.630
Validation loss decreased (-0.614801 --> -0.629616).  Saving model ...
Epoch: 26 cost time: 0.8507521152496338
Epoch: 26, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.313 Vali Acc: 0.659 Test Loss: 1.313 Test Acc: 0.659
Validation loss decreased (-0.629616 --> -0.659246).  Saving model ...
Epoch: 27 cost time: 0.8477106094360352
Epoch: 27, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.288 Vali Acc: 0.670 Test Loss: 1.288 Test Acc: 0.670
Validation loss decreased (-0.659246 --> -0.670357).  Saving model ...
Epoch: 28 cost time: 0.7929868698120117
Epoch: 28, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.264 Vali Acc: 0.674 Test Loss: 1.264 Test Acc: 0.674
Validation loss decreased (-0.670357 --> -0.674061).  Saving model ...
Epoch: 29 cost time: 0.6594982147216797
Epoch: 29, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.239 Vali Acc: 0.693 Test Loss: 1.239 Test Acc: 0.693
Validation loss decreased (-0.674061 --> -0.692580).  Saving model ...
Epoch: 30 cost time: 0.6989996433258057
Epoch: 30, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.213 Vali Acc: 0.711 Test Loss: 1.213 Test Acc: 0.711
Validation loss decreased (-0.692580 --> -0.711099).  Saving model ...
Epoch: 31 cost time: 0.9756186008453369
Epoch: 31, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.188 Vali Acc: 0.726 Test Loss: 1.188 Test Acc: 0.726
Validation loss decreased (-0.711099 --> -0.725914).  Saving model ...
Epoch: 32 cost time: 0.7768599987030029
Epoch: 32, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.163 Vali Acc: 0.737 Test Loss: 1.163 Test Acc: 0.737
Validation loss decreased (-0.725914 --> -0.737025).  Saving model ...
Epoch: 33 cost time: 0.9423182010650635
Epoch: 33, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.138 Vali Acc: 0.756 Test Loss: 1.138 Test Acc: 0.756
Validation loss decreased (-0.737025 --> -0.755544).  Saving model ...
Epoch: 34 cost time: 0.6607134342193604
Epoch: 34, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.113 Vali Acc: 0.763 Test Loss: 1.113 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 35 cost time: 0.8598227500915527
Epoch: 35, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.088 Vali Acc: 0.778 Test Loss: 1.088 Test Acc: 0.778
Validation loss decreased (-0.762952 --> -0.777767).  Saving model ...
Epoch: 36 cost time: 0.8713304996490479
Epoch: 36, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.063 Vali Acc: 0.793 Test Loss: 1.063 Test Acc: 0.793
Validation loss decreased (-0.777767 --> -0.792582).  Saving model ...
Epoch: 37 cost time: 0.6082546710968018
Epoch: 37, Steps: 2 | Train Loss: 0.915 Vali Loss: 1.039 Vali Acc: 0.800 Test Loss: 1.039 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799990).  Saving model ...
Epoch: 38 cost time: 0.7948684692382812
Epoch: 38, Steps: 2 | Train Loss: 0.888 Vali Loss: 1.014 Vali Acc: 0.807 Test Loss: 1.014 Test Acc: 0.807
Validation loss decreased (-0.799990 --> -0.807397).  Saving model ...
Epoch: 39 cost time: 0.6628108024597168
Epoch: 39, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.990 Vali Acc: 0.822 Test Loss: 0.990 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822212).  Saving model ...
Epoch: 40 cost time: 0.8752989768981934
Epoch: 40, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.967 Vali Acc: 0.833 Test Loss: 0.967 Test Acc: 0.833
Validation loss decreased (-0.822212 --> -0.833324).  Saving model ...
Epoch: 41 cost time: 0.9748506546020508
Epoch: 41, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.944 Vali Acc: 0.852 Test Loss: 0.944 Test Acc: 0.852
Validation loss decreased (-0.833324 --> -0.851842).  Saving model ...
Epoch: 42 cost time: 0.7394506931304932
Epoch: 42, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.921 Vali Acc: 0.852 Test Loss: 0.921 Test Acc: 0.852
Validation loss decreased (-0.851842 --> -0.851843).  Saving model ...
Epoch: 43 cost time: 1.067610263824463
Epoch: 43, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.898 Vali Acc: 0.863 Test Loss: 0.898 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862954).  Saving model ...
Epoch: 44 cost time: 0.9113311767578125
Epoch: 44, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.876 Vali Acc: 0.867 Test Loss: 0.876 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 45 cost time: 1.0248842239379883
Epoch: 45, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.855 Vali Acc: 0.870 Test Loss: 0.855 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 46 cost time: 0.7951972484588623
Epoch: 46, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.834 Vali Acc: 0.881 Test Loss: 0.834 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881473).  Saving model ...
Epoch: 47 cost time: 0.9859299659729004
Epoch: 47, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.813 Vali Acc: 0.885 Test Loss: 0.813 Test Acc: 0.885
Validation loss decreased (-0.881473 --> -0.885177).  Saving model ...
Epoch: 48 cost time: 0.8430845737457275
Epoch: 48, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.793 Vali Acc: 0.885 Test Loss: 0.793 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885177).  Saving model ...
Epoch: 49 cost time: 0.8509495258331299
Epoch: 49, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.774 Vali Acc: 0.889 Test Loss: 0.774 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 50 cost time: 0.8696057796478271
Epoch: 50, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.755 Vali Acc: 0.893 Test Loss: 0.755 Test Acc: 0.893
Validation loss decreased (-0.888881 --> -0.892585).  Saving model ...
Epoch: 51 cost time: 0.7218494415283203
Epoch: 51, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.736 Vali Acc: 0.900 Test Loss: 0.736 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 52 cost time: 0.9154355525970459
Epoch: 52, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 53 cost time: 0.8117783069610596
Epoch: 53, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.701 Vali Acc: 0.907 Test Loss: 0.701 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907400).  Saving model ...
Epoch: 54 cost time: 0.9062099456787109
Epoch: 54, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.684 Vali Acc: 0.907 Test Loss: 0.684 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 55 cost time: 0.761589765548706
Epoch: 55, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9223713874816895
Epoch: 56, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.652 Vali Acc: 0.907 Test Loss: 0.652 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 57 cost time: 0.9109158515930176
Epoch: 57, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.637 Vali Acc: 0.907 Test Loss: 0.637 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 58 cost time: 0.7605605125427246
Epoch: 58, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.622 Vali Acc: 0.904 Test Loss: 0.622 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.8956222534179688
Epoch: 59, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.8663814067840576
Epoch: 60, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.594 Vali Acc: 0.904 Test Loss: 0.594 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.866288423538208
Epoch: 61, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.581 Vali Acc: 0.904 Test Loss: 0.581 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.851555585861206
Epoch: 62, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.569 Vali Acc: 0.904 Test Loss: 0.569 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8833963871002197
Epoch: 63, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.556 Vali Acc: 0.904 Test Loss: 0.556 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8475203514099121
Epoch: 64, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.544 Vali Acc: 0.904 Test Loss: 0.544 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7577381134033203
Epoch: 65, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.533 Vali Acc: 0.904 Test Loss: 0.533 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8103430271148682
Epoch: 66, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.522 Vali Acc: 0.904 Test Loss: 0.522 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.8911325931549072
Epoch: 67, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs8_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 7424
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs7_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.014847755432129
Epoch: 1, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.781 Vali Acc: 0.059 Test Loss: 1.781 Test Acc: 0.059
Validation loss decreased (inf --> -0.059241).  Saving model ...
Epoch: 2 cost time: 0.8616104125976562
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.765 Vali Acc: 0.074 Test Loss: 1.765 Test Acc: 0.074
Validation loss decreased (-0.059241 --> -0.074056).  Saving model ...
Epoch: 3 cost time: 0.8360185623168945
Epoch: 3, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.755 Vali Acc: 0.074 Test Loss: 1.755 Test Acc: 0.074
Validation loss decreased (-0.074056 --> -0.074057).  Saving model ...
Epoch: 4 cost time: 0.8149716854095459
Epoch: 4, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.747 Vali Acc: 0.078 Test Loss: 1.747 Test Acc: 0.078
Validation loss decreased (-0.074057 --> -0.077760).  Saving model ...
Epoch: 5 cost time: 0.9120426177978516
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.737 Vali Acc: 0.081 Test Loss: 1.737 Test Acc: 0.081
Validation loss decreased (-0.077760 --> -0.081464).  Saving model ...
Epoch: 6 cost time: 0.9199972152709961
Epoch: 6, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.725 Vali Acc: 0.089 Test Loss: 1.725 Test Acc: 0.089
Validation loss decreased (-0.081464 --> -0.088872).  Saving model ...
Epoch: 7 cost time: 0.8120958805084229
Epoch: 7, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.711 Vali Acc: 0.093 Test Loss: 1.711 Test Acc: 0.093
Validation loss decreased (-0.088872 --> -0.092575).  Saving model ...
Epoch: 8 cost time: 0.8158068656921387
Epoch: 8, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.697 Vali Acc: 0.100 Test Loss: 1.697 Test Acc: 0.100
Validation loss decreased (-0.092575 --> -0.099983).  Saving model ...
Epoch: 9 cost time: 0.894169807434082
Epoch: 9, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.680 Vali Acc: 0.141 Test Loss: 1.680 Test Acc: 0.141
Validation loss decreased (-0.099983 --> -0.140724).  Saving model ...
Epoch: 10 cost time: 0.8306601047515869
Epoch: 10, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.663 Vali Acc: 0.159 Test Loss: 1.663 Test Acc: 0.159
Validation loss decreased (-0.140724 --> -0.159243).  Saving model ...
Epoch: 11 cost time: 0.5913388729095459
Epoch: 11, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.644 Vali Acc: 0.196 Test Loss: 1.644 Test Acc: 0.196
Validation loss decreased (-0.159243 --> -0.196280).  Saving model ...
Epoch: 12 cost time: 0.9913392066955566
Epoch: 12, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.625 Vali Acc: 0.237 Test Loss: 1.625 Test Acc: 0.237
Validation loss decreased (-0.196280 --> -0.237021).  Saving model ...
Epoch: 13 cost time: 1.039846420288086
Epoch: 13, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.605 Vali Acc: 0.307 Test Loss: 1.605 Test Acc: 0.307
Validation loss decreased (-0.237021 --> -0.307391).  Saving model ...
Epoch: 14 cost time: 0.7052402496337891
Epoch: 14, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.584 Vali Acc: 0.359 Test Loss: 1.584 Test Acc: 0.359
Validation loss decreased (-0.307391 --> -0.359243).  Saving model ...
Epoch: 15 cost time: 0.8303513526916504
Epoch: 15, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.562 Vali Acc: 0.415 Test Loss: 1.562 Test Acc: 0.415
Validation loss decreased (-0.359243 --> -0.414799).  Saving model ...
Epoch: 16 cost time: 0.8243045806884766
Epoch: 16, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.540 Vali Acc: 0.456 Test Loss: 1.540 Test Acc: 0.456
Validation loss decreased (-0.414799 --> -0.455540).  Saving model ...
Epoch: 17 cost time: 0.7299759387969971
Epoch: 17, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.517 Vali Acc: 0.493 Test Loss: 1.517 Test Acc: 0.493
Validation loss decreased (-0.455540 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 1.080892562866211
Epoch: 18, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.494 Vali Acc: 0.526 Test Loss: 1.494 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 19 cost time: 0.8405942916870117
Epoch: 19, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.470 Vali Acc: 0.552 Test Loss: 1.470 Test Acc: 0.552
Validation loss decreased (-0.525911 --> -0.551837).  Saving model ...
Epoch: 20 cost time: 0.6492724418640137
Epoch: 20, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.446 Vali Acc: 0.570 Test Loss: 1.446 Test Acc: 0.570
Validation loss decreased (-0.551837 --> -0.570356).  Saving model ...
Epoch: 21 cost time: 1.0287542343139648
Epoch: 21, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.421 Vali Acc: 0.604 Test Loss: 1.421 Test Acc: 0.604
Validation loss decreased (-0.570356 --> -0.603689).  Saving model ...
Epoch: 22 cost time: 0.899040699005127
Epoch: 22, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.396 Vali Acc: 0.622 Test Loss: 1.396 Test Acc: 0.622
Validation loss decreased (-0.603689 --> -0.622208).  Saving model ...
Epoch: 23 cost time: 0.623887300491333
Epoch: 23, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.371 Vali Acc: 0.644 Test Loss: 1.371 Test Acc: 0.644
Validation loss decreased (-0.622208 --> -0.644431).  Saving model ...
Epoch: 24 cost time: 0.8080894947052002
Epoch: 24, Steps: 2 | Train Loss: 1.313 Vali Loss: 1.346 Vali Acc: 0.685 Test Loss: 1.346 Test Acc: 0.685
Validation loss decreased (-0.644431 --> -0.685172).  Saving model ...
Epoch: 25 cost time: 0.926905632019043
Epoch: 25, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.320 Vali Acc: 0.715 Test Loss: 1.320 Test Acc: 0.715
Validation loss decreased (-0.685172 --> -0.714802).  Saving model ...
Epoch: 26 cost time: 0.6680669784545898
Epoch: 26, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.295 Vali Acc: 0.741 Test Loss: 1.295 Test Acc: 0.741
Validation loss decreased (-0.714802 --> -0.740728).  Saving model ...
Epoch: 27 cost time: 0.6830399036407471
Epoch: 27, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.269 Vali Acc: 0.752 Test Loss: 1.269 Test Acc: 0.752
Validation loss decreased (-0.740728 --> -0.751839).  Saving model ...
Epoch: 28 cost time: 0.6190292835235596
Epoch: 28, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.243 Vali Acc: 0.759 Test Loss: 1.243 Test Acc: 0.759
Validation loss decreased (-0.751839 --> -0.759247).  Saving model ...
Epoch: 29 cost time: 0.7717173099517822
Epoch: 29, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.217 Vali Acc: 0.778 Test Loss: 1.217 Test Acc: 0.778
Validation loss decreased (-0.759247 --> -0.777766).  Saving model ...
Epoch: 30 cost time: 0.8780965805053711
Epoch: 30, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.192 Vali Acc: 0.793 Test Loss: 1.192 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792581).  Saving model ...
Epoch: 31 cost time: 0.7398185729980469
Epoch: 31, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.166 Vali Acc: 0.811 Test Loss: 1.166 Test Acc: 0.811
Validation loss decreased (-0.792581 --> -0.811099).  Saving model ...
Epoch: 32 cost time: 0.8789224624633789
Epoch: 32, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.140 Vali Acc: 0.815 Test Loss: 1.140 Test Acc: 0.815
Validation loss decreased (-0.811099 --> -0.814803).  Saving model ...
Epoch: 33 cost time: 0.7781188488006592
Epoch: 33, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.115 Vali Acc: 0.826 Test Loss: 1.115 Test Acc: 0.826
Validation loss decreased (-0.814803 --> -0.825915).  Saving model ...
Epoch: 34 cost time: 0.7922964096069336
Epoch: 34, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.090 Vali Acc: 0.844 Test Loss: 1.090 Test Acc: 0.844
Validation loss decreased (-0.825915 --> -0.844434).  Saving model ...
Epoch: 35 cost time: 0.9833543300628662
Epoch: 35, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.065 Vali Acc: 0.852 Test Loss: 1.065 Test Acc: 0.852
Validation loss decreased (-0.844434 --> -0.851841).  Saving model ...
Epoch: 36 cost time: 0.9980108737945557
Epoch: 36, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.040 Vali Acc: 0.856 Test Loss: 1.040 Test Acc: 0.856
Validation loss decreased (-0.851841 --> -0.855545).  Saving model ...
Epoch: 37 cost time: 0.7704684734344482
Epoch: 37, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.016 Vali Acc: 0.863 Test Loss: 1.016 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
Epoch: 38 cost time: 0.7695226669311523
Epoch: 38, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.991 Vali Acc: 0.874 Test Loss: 0.991 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874064).  Saving model ...
Epoch: 39 cost time: 0.7085199356079102
Epoch: 39, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.968 Vali Acc: 0.878 Test Loss: 0.968 Test Acc: 0.878
Validation loss decreased (-0.874064 --> -0.877768).  Saving model ...
Epoch: 40 cost time: 1.0275368690490723
Epoch: 40, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.944 Vali Acc: 0.881 Test Loss: 0.944 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 41 cost time: 0.7903645038604736
Epoch: 41, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.921 Vali Acc: 0.885 Test Loss: 0.921 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 42 cost time: 0.9776880741119385
Epoch: 42, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.899 Vali Acc: 0.885 Test Loss: 0.899 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885176).  Saving model ...
Epoch: 43 cost time: 0.8627400398254395
Epoch: 43, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.877 Vali Acc: 0.885 Test Loss: 0.877 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885176).  Saving model ...
Epoch: 44 cost time: 0.6380157470703125
Epoch: 44, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.855 Vali Acc: 0.889 Test Loss: 0.855 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 45 cost time: 0.8315880298614502
Epoch: 45, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.834 Vali Acc: 0.889 Test Loss: 0.834 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888881).  Saving model ...
Epoch: 46 cost time: 0.64426589012146
Epoch: 46, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.813 Vali Acc: 0.900 Test Loss: 0.813 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899992).  Saving model ...
Epoch: 47 cost time: 0.7118511199951172
Epoch: 47, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.793 Vali Acc: 0.904 Test Loss: 0.793 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 48 cost time: 0.8369507789611816
Epoch: 48, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.773 Vali Acc: 0.911 Test Loss: 0.773 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911103).  Saving model ...
Epoch: 49 cost time: 0.5794785022735596
Epoch: 49, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.754 Vali Acc: 0.911 Test Loss: 0.754 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 50 cost time: 0.7757852077484131
Epoch: 50, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.736 Vali Acc: 0.911 Test Loss: 0.736 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 51 cost time: 0.6904172897338867
Epoch: 51, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.718 Vali Acc: 0.915 Test Loss: 0.718 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 52 cost time: 0.7972619533538818
Epoch: 52, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.700 Vali Acc: 0.911 Test Loss: 0.700 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.825129508972168
Epoch: 53, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.683 Vali Acc: 0.911 Test Loss: 0.683 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6470627784729004
Epoch: 54, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.667 Vali Acc: 0.911 Test Loss: 0.667 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6873805522918701
Epoch: 55, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.651 Vali Acc: 0.911 Test Loss: 0.651 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.684816837310791
Epoch: 56, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.635 Vali Acc: 0.911 Test Loss: 0.635 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7797307968139648
Epoch: 57, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.620 Vali Acc: 0.911 Test Loss: 0.620 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9208862781524658
Epoch: 58, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.606 Vali Acc: 0.911 Test Loss: 0.606 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.0130722522735596
Epoch: 59, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.592 Vali Acc: 0.915 Test Loss: 0.592 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 60 cost time: 0.8050553798675537
Epoch: 60, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.578 Vali Acc: 0.919 Test Loss: 0.578 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 61 cost time: 0.7913784980773926
Epoch: 61, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.565 Vali Acc: 0.919 Test Loss: 0.565 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 62 cost time: 0.668015718460083
Epoch: 62, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.553 Vali Acc: 0.919 Test Loss: 0.553 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 63 cost time: 0.9064085483551025
Epoch: 63, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.541 Vali Acc: 0.922 Test Loss: 0.541 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 64 cost time: 0.6299822330474854
Epoch: 64, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.529 Vali Acc: 0.922 Test Loss: 0.529 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 65 cost time: 0.7819607257843018
Epoch: 65, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.518 Vali Acc: 0.926 Test Loss: 0.518 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 66 cost time: 0.8360445499420166
Epoch: 66, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.507 Vali Acc: 0.926 Test Loss: 0.507 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 67 cost time: 0.8742890357971191
Epoch: 67, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.496 Vali Acc: 0.930 Test Loss: 0.496 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.9158096313476562
Epoch: 68, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.486 Vali Acc: 0.933 Test Loss: 0.486 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933328).  Saving model ...
Epoch: 69 cost time: 1.03818678855896
Epoch: 69, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.477 Vali Acc: 0.933 Test Loss: 0.477 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 70 cost time: 0.6561217308044434
Epoch: 70, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.467 Vali Acc: 0.933 Test Loss: 0.467 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 71 cost time: 0.5793023109436035
Epoch: 71, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.458 Vali Acc: 0.933 Test Loss: 0.458 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 72 cost time: 0.6012248992919922
Epoch: 72, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.450 Vali Acc: 0.937 Test Loss: 0.450 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 73 cost time: 0.6616928577423096
Epoch: 73, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.441 Vali Acc: 0.937 Test Loss: 0.441 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 74 cost time: 0.9134154319763184
Epoch: 74, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.433 Vali Acc: 0.941 Test Loss: 0.433 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940736).  Saving model ...
Epoch: 75 cost time: 0.8777074813842773
Epoch: 75, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.425 Vali Acc: 0.941 Test Loss: 0.425 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 76 cost time: 0.8008856773376465
Epoch: 76, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 77 cost time: 0.6268997192382812
Epoch: 77, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.411 Vali Acc: 0.941 Test Loss: 0.411 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 78 cost time: 0.6109204292297363
Epoch: 78, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.404 Vali Acc: 0.937 Test Loss: 0.404 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6448986530303955
Epoch: 79, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.397 Vali Acc: 0.937 Test Loss: 0.397 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6584510803222656
Epoch: 80, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6723191738128662
Epoch: 81, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.384 Vali Acc: 0.937 Test Loss: 0.384 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.8274226188659668
Epoch: 82, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.378 Vali Acc: 0.937 Test Loss: 0.378 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.7126705646514893
Epoch: 83, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.373 Vali Acc: 0.941 Test Loss: 0.373 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 84 cost time: 0.6764543056488037
Epoch: 84, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 85 cost time: 0.7202599048614502
Epoch: 85, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.362 Vali Acc: 0.941 Test Loss: 0.362 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 86 cost time: 0.6307759284973145
Epoch: 86, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.356 Vali Acc: 0.937 Test Loss: 0.356 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6165211200714111
Epoch: 87, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.7597031593322754
Epoch: 88, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.583876371383667
Epoch: 89, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.342 Vali Acc: 0.937 Test Loss: 0.342 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.7942771911621094
Epoch: 90, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.8931372165679932
Epoch: 91, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.9698877334594727
Epoch: 92, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.6112346649169922
Epoch: 93, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.82916259765625
Epoch: 94, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.8165075778961182
Epoch: 95, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.317 Vali Acc: 0.933 Test Loss: 0.317 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs7_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 7320
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs6_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.585052728652954
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.938 Vali Acc: 0.119 Test Loss: 1.938 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.8519868850708008
Epoch: 2, Steps: 2 | Train Loss: 1.936 Vali Loss: 1.915 Vali Acc: 0.122 Test Loss: 1.915 Test Acc: 0.122
Validation loss decreased (-0.118499 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.5389704704284668
Epoch: 3, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.901 Vali Acc: 0.130 Test Loss: 1.901 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.6599109172821045
Epoch: 4, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.891 Vali Acc: 0.133 Test Loss: 1.891 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133314).  Saving model ...
Epoch: 5 cost time: 0.7786111831665039
Epoch: 5, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.878 Vali Acc: 0.133 Test Loss: 1.878 Test Acc: 0.133
Validation loss decreased (-0.133314 --> -0.133315).  Saving model ...
Epoch: 6 cost time: 0.9702122211456299
Epoch: 6, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.863 Vali Acc: 0.141 Test Loss: 1.863 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140722).  Saving model ...
Epoch: 7 cost time: 0.8073544502258301
Epoch: 7, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.846 Vali Acc: 0.144 Test Loss: 1.846 Test Acc: 0.144
Validation loss decreased (-0.140722 --> -0.144426).  Saving model ...
Epoch: 8 cost time: 1.1402158737182617
Epoch: 8, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.827 Vali Acc: 0.148 Test Loss: 1.827 Test Acc: 0.148
Validation loss decreased (-0.144426 --> -0.148130).  Saving model ...
Epoch: 9 cost time: 0.7699756622314453
Epoch: 9, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.807 Vali Acc: 0.156 Test Loss: 1.807 Test Acc: 0.156
Validation loss decreased (-0.148130 --> -0.155537).  Saving model ...
Epoch: 10 cost time: 0.8141534328460693
Epoch: 10, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.786 Vali Acc: 0.174 Test Loss: 1.786 Test Acc: 0.174
Validation loss decreased (-0.155537 --> -0.174056).  Saving model ...
Epoch: 11 cost time: 0.7400109767913818
Epoch: 11, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.764 Vali Acc: 0.185 Test Loss: 1.764 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185168).  Saving model ...
Epoch: 12 cost time: 0.687091588973999
Epoch: 12, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.740 Vali Acc: 0.196 Test Loss: 1.740 Test Acc: 0.196
Validation loss decreased (-0.185168 --> -0.196279).  Saving model ...
Epoch: 13 cost time: 0.8497531414031982
Epoch: 13, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.716 Vali Acc: 0.215 Test Loss: 1.716 Test Acc: 0.215
Validation loss decreased (-0.196279 --> -0.214798).  Saving model ...
Epoch: 14 cost time: 0.674069881439209
Epoch: 14, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.691 Vali Acc: 0.233 Test Loss: 1.691 Test Acc: 0.233
Validation loss decreased (-0.214798 --> -0.233316).  Saving model ...
Epoch: 15 cost time: 0.85927414894104
Epoch: 15, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.665 Vali Acc: 0.256 Test Loss: 1.665 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255539).  Saving model ...
Epoch: 16 cost time: 0.8878593444824219
Epoch: 16, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.638 Vali Acc: 0.274 Test Loss: 1.638 Test Acc: 0.274
Validation loss decreased (-0.255539 --> -0.274058).  Saving model ...
Epoch: 17 cost time: 0.70098876953125
Epoch: 17, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.611 Vali Acc: 0.322 Test Loss: 1.611 Test Acc: 0.322
Validation loss decreased (-0.274058 --> -0.322206).  Saving model ...
Epoch: 18 cost time: 0.6789019107818604
Epoch: 18, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.584 Vali Acc: 0.381 Test Loss: 1.584 Test Acc: 0.381
Validation loss decreased (-0.322206 --> -0.381466).  Saving model ...
Epoch: 19 cost time: 0.7977659702301025
Epoch: 19, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.557 Vali Acc: 0.430 Test Loss: 1.557 Test Acc: 0.430
Validation loss decreased (-0.381466 --> -0.429614).  Saving model ...
Epoch: 20 cost time: 0.8960402011871338
Epoch: 20, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.529 Vali Acc: 0.452 Test Loss: 1.529 Test Acc: 0.452
Validation loss decreased (-0.429614 --> -0.451837).  Saving model ...
Epoch: 21 cost time: 0.7376058101654053
Epoch: 21, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.501 Vali Acc: 0.504 Test Loss: 1.501 Test Acc: 0.504
Validation loss decreased (-0.451837 --> -0.503689).  Saving model ...
Epoch: 22 cost time: 0.8639881610870361
Epoch: 22, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.472 Vali Acc: 0.511 Test Loss: 1.472 Test Acc: 0.511
Validation loss decreased (-0.503689 --> -0.511096).  Saving model ...
Epoch: 23 cost time: 1.1270883083343506
Epoch: 23, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.444 Vali Acc: 0.544 Test Loss: 1.444 Test Acc: 0.544
Validation loss decreased (-0.511096 --> -0.544430).  Saving model ...
Epoch: 24 cost time: 0.9544322490692139
Epoch: 24, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.415 Vali Acc: 0.578 Test Loss: 1.415 Test Acc: 0.578
Validation loss decreased (-0.544430 --> -0.577764).  Saving model ...
Epoch: 25 cost time: 0.8144080638885498
Epoch: 25, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.386 Vali Acc: 0.596 Test Loss: 1.386 Test Acc: 0.596
Validation loss decreased (-0.577764 --> -0.596282).  Saving model ...
Epoch: 26 cost time: 0.6115410327911377
Epoch: 26, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.358 Vali Acc: 0.615 Test Loss: 1.358 Test Acc: 0.615
Validation loss decreased (-0.596282 --> -0.614801).  Saving model ...
Epoch: 27 cost time: 0.7896847724914551
Epoch: 27, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.329 Vali Acc: 0.637 Test Loss: 1.329 Test Acc: 0.637
Validation loss decreased (-0.614801 --> -0.637024).  Saving model ...
Epoch: 28 cost time: 0.8279149532318115
Epoch: 28, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.301 Vali Acc: 0.667 Test Loss: 1.301 Test Acc: 0.667
Validation loss decreased (-0.637024 --> -0.666654).  Saving model ...
Epoch: 29 cost time: 0.99810791015625
Epoch: 29, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.272 Vali Acc: 0.685 Test Loss: 1.272 Test Acc: 0.685
Validation loss decreased (-0.666654 --> -0.685172).  Saving model ...
Epoch: 30 cost time: 0.7694253921508789
Epoch: 30, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.244 Vali Acc: 0.704 Test Loss: 1.244 Test Acc: 0.704
Validation loss decreased (-0.685172 --> -0.703691).  Saving model ...
Epoch: 31 cost time: 0.7361660003662109
Epoch: 31, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.215 Vali Acc: 0.730 Test Loss: 1.215 Test Acc: 0.730
Validation loss decreased (-0.703691 --> -0.729617).  Saving model ...
Epoch: 32 cost time: 0.7774019241333008
Epoch: 32, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.187 Vali Acc: 0.741 Test Loss: 1.187 Test Acc: 0.741
Validation loss decreased (-0.729617 --> -0.740729).  Saving model ...
Epoch: 33 cost time: 0.75299072265625
Epoch: 33, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.160 Vali Acc: 0.752 Test Loss: 1.160 Test Acc: 0.752
Validation loss decreased (-0.740729 --> -0.751840).  Saving model ...
Epoch: 34 cost time: 0.8556208610534668
Epoch: 34, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.132 Vali Acc: 0.763 Test Loss: 1.132 Test Acc: 0.763
Validation loss decreased (-0.751840 --> -0.762952).  Saving model ...
Epoch: 35 cost time: 0.6161859035491943
Epoch: 35, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.105 Vali Acc: 0.781 Test Loss: 1.105 Test Acc: 0.781
Validation loss decreased (-0.762952 --> -0.781470).  Saving model ...
Epoch: 36 cost time: 0.7316188812255859
Epoch: 36, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.078 Vali Acc: 0.800 Test Loss: 1.078 Test Acc: 0.800
Validation loss decreased (-0.781470 --> -0.799989).  Saving model ...
Epoch: 37 cost time: 0.6317520141601562
Epoch: 37, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.052 Vali Acc: 0.804 Test Loss: 1.052 Test Acc: 0.804
Validation loss decreased (-0.799989 --> -0.803693).  Saving model ...
Epoch: 38 cost time: 0.7829604148864746
Epoch: 38, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.026 Vali Acc: 0.811 Test Loss: 1.026 Test Acc: 0.811
Validation loss decreased (-0.803693 --> -0.811101).  Saving model ...
Epoch: 39 cost time: 0.5738515853881836
Epoch: 39, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.000 Vali Acc: 0.815 Test Loss: 1.000 Test Acc: 0.815
Validation loss decreased (-0.811101 --> -0.814805).  Saving model ...
Epoch: 40 cost time: 0.7677664756774902
Epoch: 40, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.975 Vali Acc: 0.826 Test Loss: 0.975 Test Acc: 0.826
Validation loss decreased (-0.814805 --> -0.825916).  Saving model ...
Epoch: 41 cost time: 0.9147782325744629
Epoch: 41, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.951 Vali Acc: 0.841 Test Loss: 0.951 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 42 cost time: 0.6756997108459473
Epoch: 42, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.927 Vali Acc: 0.841 Test Loss: 0.927 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840731).  Saving model ...
Epoch: 43 cost time: 0.7153284549713135
Epoch: 43, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.903 Vali Acc: 0.841 Test Loss: 0.903 Test Acc: 0.841
Validation loss decreased (-0.840731 --> -0.840732).  Saving model ...
Epoch: 44 cost time: 0.7853653430938721
Epoch: 44, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.880 Vali Acc: 0.856 Test Loss: 0.880 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855547).  Saving model ...
Epoch: 45 cost time: 0.6969506740570068
Epoch: 45, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.858 Vali Acc: 0.863 Test Loss: 0.858 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862954).  Saving model ...
Epoch: 46 cost time: 0.9065577983856201
Epoch: 46, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.836 Vali Acc: 0.867 Test Loss: 0.836 Test Acc: 0.867
Validation loss decreased (-0.862954 --> -0.866658).  Saving model ...
Epoch: 47 cost time: 0.7783770561218262
Epoch: 47, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.815 Vali Acc: 0.874 Test Loss: 0.815 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 48 cost time: 0.6944293975830078
Epoch: 48, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.794 Vali Acc: 0.878 Test Loss: 0.794 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 49 cost time: 0.6370887756347656
Epoch: 49, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.774 Vali Acc: 0.878 Test Loss: 0.774 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 50 cost time: 0.7641892433166504
Epoch: 50, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.754 Vali Acc: 0.881 Test Loss: 0.754 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 51 cost time: 0.6798593997955322
Epoch: 51, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.735 Vali Acc: 0.885 Test Loss: 0.735 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 52 cost time: 0.9088752269744873
Epoch: 52, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.717 Vali Acc: 0.889 Test Loss: 0.717 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 53 cost time: 0.597771406173706
Epoch: 53, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.699 Vali Acc: 0.893 Test Loss: 0.699 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 54 cost time: 0.8070173263549805
Epoch: 54, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.682 Vali Acc: 0.889 Test Loss: 0.682 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7156713008880615
Epoch: 55, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899993).  Saving model ...
Epoch: 56 cost time: 0.762425422668457
Epoch: 56, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.649 Vali Acc: 0.900 Test Loss: 0.649 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 57 cost time: 0.8059840202331543
Epoch: 57, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.633 Vali Acc: 0.907 Test Loss: 0.633 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907401).  Saving model ...
Epoch: 58 cost time: 0.7110099792480469
Epoch: 58, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.618 Vali Acc: 0.922 Test Loss: 0.618 Test Acc: 0.922
Validation loss decreased (-0.907401 --> -0.922216).  Saving model ...
Epoch: 59 cost time: 0.862229585647583
Epoch: 59, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.604 Vali Acc: 0.922 Test Loss: 0.604 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 60 cost time: 0.6651482582092285
Epoch: 60, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.590 Vali Acc: 0.922 Test Loss: 0.590 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 61 cost time: 0.7290384769439697
Epoch: 61, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.576 Vali Acc: 0.926 Test Loss: 0.576 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 62 cost time: 0.7530035972595215
Epoch: 62, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.563 Vali Acc: 0.926 Test Loss: 0.563 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 63 cost time: 0.7334034442901611
Epoch: 63, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.550 Vali Acc: 0.926 Test Loss: 0.550 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925920).  Saving model ...
Epoch: 64 cost time: 1.0482501983642578
Epoch: 64, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.538 Vali Acc: 0.926 Test Loss: 0.538 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 65 cost time: 0.8314645290374756
Epoch: 65, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.526 Vali Acc: 0.930 Test Loss: 0.526 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929624).  Saving model ...
Epoch: 66 cost time: 0.9796860218048096
Epoch: 66, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.515 Vali Acc: 0.930 Test Loss: 0.515 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 67 cost time: 0.7256045341491699
Epoch: 67, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.504 Vali Acc: 0.930 Test Loss: 0.504 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 68 cost time: 0.7468154430389404
Epoch: 68, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.493 Vali Acc: 0.930 Test Loss: 0.493 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 69 cost time: 0.8146524429321289
Epoch: 69, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 70 cost time: 0.6999869346618652
Epoch: 70, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 71 cost time: 1.0270469188690186
Epoch: 71, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.464 Vali Acc: 0.933 Test Loss: 0.464 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 72 cost time: 0.6844298839569092
Epoch: 72, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937032).  Saving model ...
Epoch: 73 cost time: 0.676964282989502
Epoch: 73, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.446 Vali Acc: 0.937 Test Loss: 0.446 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 74 cost time: 0.6784763336181641
Epoch: 74, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.438 Vali Acc: 0.937 Test Loss: 0.438 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 75 cost time: 0.9364371299743652
Epoch: 75, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.429 Vali Acc: 0.937 Test Loss: 0.429 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 76 cost time: 0.7261216640472412
Epoch: 76, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.422 Vali Acc: 0.937 Test Loss: 0.422 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 77 cost time: 0.6335208415985107
Epoch: 77, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.414 Vali Acc: 0.937 Test Loss: 0.414 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 78 cost time: 0.6949615478515625
Epoch: 78, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.407 Vali Acc: 0.937 Test Loss: 0.407 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 79 cost time: 0.5729866027832031
Epoch: 79, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.400 Vali Acc: 0.937 Test Loss: 0.400 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 80 cost time: 0.7302734851837158
Epoch: 80, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 81 cost time: 0.77986741065979
Epoch: 81, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.387 Vali Acc: 0.937 Test Loss: 0.387 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 82 cost time: 0.6345813274383545
Epoch: 82, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.381 Vali Acc: 0.937 Test Loss: 0.381 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 83 cost time: 0.733830451965332
Epoch: 83, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.375 Vali Acc: 0.937 Test Loss: 0.375 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 84 cost time: 0.6085021495819092
Epoch: 84, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 85 cost time: 0.700225830078125
Epoch: 85, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 86 cost time: 0.7094786167144775
Epoch: 86, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 87 cost time: 0.7991602420806885
Epoch: 87, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 88 cost time: 0.5689747333526611
Epoch: 88, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 89 cost time: 0.7310912609100342
Epoch: 89, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 90 cost time: 0.8234152793884277
Epoch: 90, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 91 cost time: 0.9727258682250977
Epoch: 91, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 92 cost time: 0.7317302227020264
Epoch: 92, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 93 cost time: 0.7380654811859131
Epoch: 93, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 94 cost time: 0.5530922412872314
Epoch: 94, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 95 cost time: 0.8626136779785156
Epoch: 95, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.316 Vali Acc: 0.937 Test Loss: 0.316 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 96 cost time: 0.7626857757568359
Epoch: 96, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.6905722618103027
Epoch: 97, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.8075954914093018
Epoch: 98, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.9538805484771729
Epoch: 99, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.6855077743530273
Epoch: 100, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs6_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 7090
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs5_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.13149094581604
Epoch: 1, Steps: 2 | Train Loss: 2.081 Vali Loss: 2.057 Vali Acc: 0.104 Test Loss: 2.057 Test Acc: 0.104
Validation loss decreased (inf --> -0.103683).  Saving model ...
Epoch: 2 cost time: 0.7949342727661133
Epoch: 2, Steps: 2 | Train Loss: 2.065 Vali Loss: 2.039 Vali Acc: 0.104 Test Loss: 2.039 Test Acc: 0.104
Validation loss decreased (-0.103683 --> -0.103683).  Saving model ...
Epoch: 3 cost time: 0.7318000793457031
Epoch: 3, Steps: 2 | Train Loss: 2.045 Vali Loss: 2.027 Vali Acc: 0.111 Test Loss: 2.027 Test Acc: 0.111
Validation loss decreased (-0.103683 --> -0.111091).  Saving model ...
Epoch: 4 cost time: 0.6370682716369629
Epoch: 4, Steps: 2 | Train Loss: 2.032 Vali Loss: 2.018 Vali Acc: 0.111 Test Loss: 2.018 Test Acc: 0.111
Validation loss decreased (-0.111091 --> -0.111091).  Saving model ...
Epoch: 5 cost time: 0.7067370414733887
Epoch: 5, Steps: 2 | Train Loss: 2.019 Vali Loss: 2.007 Vali Acc: 0.130 Test Loss: 2.007 Test Acc: 0.130
Validation loss decreased (-0.111091 --> -0.129610).  Saving model ...
Epoch: 6 cost time: 0.6216356754302979
Epoch: 6, Steps: 2 | Train Loss: 2.015 Vali Loss: 1.994 Vali Acc: 0.133 Test Loss: 1.994 Test Acc: 0.133
Validation loss decreased (-0.129610 --> -0.133313).  Saving model ...
Epoch: 7 cost time: 0.9164276123046875
Epoch: 7, Steps: 2 | Train Loss: 1.999 Vali Loss: 1.979 Vali Acc: 0.141 Test Loss: 1.979 Test Acc: 0.141
Validation loss decreased (-0.133313 --> -0.140721).  Saving model ...
Epoch: 8 cost time: 0.7673165798187256
Epoch: 8, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.963 Vali Acc: 0.148 Test Loss: 1.963 Test Acc: 0.148
Validation loss decreased (-0.140721 --> -0.148129).  Saving model ...
Epoch: 9 cost time: 0.816683292388916
Epoch: 9, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.945 Vali Acc: 0.159 Test Loss: 1.945 Test Acc: 0.159
Validation loss decreased (-0.148129 --> -0.159240).  Saving model ...
Epoch: 10 cost time: 0.8880035877227783
Epoch: 10, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.926 Vali Acc: 0.167 Test Loss: 1.926 Test Acc: 0.167
Validation loss decreased (-0.159240 --> -0.166647).  Saving model ...
Epoch: 11 cost time: 0.9860734939575195
Epoch: 11, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.906 Vali Acc: 0.174 Test Loss: 1.906 Test Acc: 0.174
Validation loss decreased (-0.166647 --> -0.174055).  Saving model ...
Epoch: 12 cost time: 0.8214538097381592
Epoch: 12, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.885 Vali Acc: 0.181 Test Loss: 1.885 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181463).  Saving model ...
Epoch: 13 cost time: 0.9515523910522461
Epoch: 13, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.863 Vali Acc: 0.189 Test Loss: 1.863 Test Acc: 0.189
Validation loss decreased (-0.181463 --> -0.188870).  Saving model ...
Epoch: 14 cost time: 0.6394946575164795
Epoch: 14, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.840 Vali Acc: 0.204 Test Loss: 1.840 Test Acc: 0.204
Validation loss decreased (-0.188870 --> -0.203685).  Saving model ...
Epoch: 15 cost time: 0.9331951141357422
Epoch: 15, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.817 Vali Acc: 0.211 Test Loss: 1.817 Test Acc: 0.211
Validation loss decreased (-0.203685 --> -0.211093).  Saving model ...
Epoch: 16 cost time: 0.852297306060791
Epoch: 16, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.793 Vali Acc: 0.222 Test Loss: 1.793 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222204).  Saving model ...
Epoch: 17 cost time: 0.7296817302703857
Epoch: 17, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.769 Vali Acc: 0.244 Test Loss: 1.769 Test Acc: 0.244
Validation loss decreased (-0.222204 --> -0.244427).  Saving model ...
Epoch: 18 cost time: 0.8841102123260498
Epoch: 18, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.744 Vali Acc: 0.259 Test Loss: 1.744 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 19 cost time: 1.021376371383667
Epoch: 19, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.719 Vali Acc: 0.274 Test Loss: 1.719 Test Acc: 0.274
Validation loss decreased (-0.259242 --> -0.274057).  Saving model ...
Epoch: 20 cost time: 0.918715238571167
Epoch: 20, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.693 Vali Acc: 0.293 Test Loss: 1.693 Test Acc: 0.293
Validation loss decreased (-0.274057 --> -0.292576).  Saving model ...
Epoch: 21 cost time: 0.93227219581604
Epoch: 21, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.666 Vali Acc: 0.326 Test Loss: 1.666 Test Acc: 0.326
Validation loss decreased (-0.292576 --> -0.325909).  Saving model ...
Epoch: 22 cost time: 0.9670891761779785
Epoch: 22, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.640 Vali Acc: 0.352 Test Loss: 1.640 Test Acc: 0.352
Validation loss decreased (-0.325909 --> -0.351835).  Saving model ...
Epoch: 23 cost time: 0.9155337810516357
Epoch: 23, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.612 Vali Acc: 0.389 Test Loss: 1.612 Test Acc: 0.389
Validation loss decreased (-0.351835 --> -0.388873).  Saving model ...
Epoch: 24 cost time: 1.0184550285339355
Epoch: 24, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.585 Vali Acc: 0.422 Test Loss: 1.585 Test Acc: 0.422
Validation loss decreased (-0.388873 --> -0.422206).  Saving model ...
Epoch: 25 cost time: 0.6226274967193604
Epoch: 25, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.557 Vali Acc: 0.459 Test Loss: 1.557 Test Acc: 0.459
Validation loss decreased (-0.422206 --> -0.459244).  Saving model ...
Epoch: 26 cost time: 0.7204365730285645
Epoch: 26, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.530 Vali Acc: 0.496 Test Loss: 1.530 Test Acc: 0.496
Validation loss decreased (-0.459244 --> -0.496281).  Saving model ...
Epoch: 27 cost time: 0.6739106178283691
Epoch: 27, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.502 Vali Acc: 0.537 Test Loss: 1.502 Test Acc: 0.537
Validation loss decreased (-0.496281 --> -0.537022).  Saving model ...
Epoch: 28 cost time: 0.7001996040344238
Epoch: 28, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.473 Vali Acc: 0.585 Test Loss: 1.473 Test Acc: 0.585
Validation loss decreased (-0.537022 --> -0.585170).  Saving model ...
Epoch: 29 cost time: 0.6218781471252441
Epoch: 29, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.445 Vali Acc: 0.615 Test Loss: 1.445 Test Acc: 0.615
Validation loss decreased (-0.585170 --> -0.614800).  Saving model ...
Epoch: 30 cost time: 1.0144948959350586
Epoch: 30, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.416 Vali Acc: 0.667 Test Loss: 1.416 Test Acc: 0.667
Validation loss decreased (-0.614800 --> -0.666653).  Saving model ...
Epoch: 31 cost time: 1.140763759613037
Epoch: 31, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.387 Vali Acc: 0.685 Test Loss: 1.387 Test Acc: 0.685
Validation loss decreased (-0.666653 --> -0.685171).  Saving model ...
Epoch: 32 cost time: 0.904010534286499
Epoch: 32, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.359 Vali Acc: 0.704 Test Loss: 1.359 Test Acc: 0.704
Validation loss decreased (-0.685171 --> -0.703690).  Saving model ...
Epoch: 33 cost time: 0.7848005294799805
Epoch: 33, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.330 Vali Acc: 0.730 Test Loss: 1.330 Test Acc: 0.730
Validation loss decreased (-0.703690 --> -0.729616).  Saving model ...
Epoch: 34 cost time: 0.9129161834716797
Epoch: 34, Steps: 2 | Train Loss: 1.223 Vali Loss: 1.301 Vali Acc: 0.748 Test Loss: 1.301 Test Acc: 0.748
Validation loss decreased (-0.729616 --> -0.748135).  Saving model ...
Epoch: 35 cost time: 0.9179089069366455
Epoch: 35, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.272 Vali Acc: 0.770 Test Loss: 1.272 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770358).  Saving model ...
Epoch: 36 cost time: 0.9149265289306641
Epoch: 36, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.243 Vali Acc: 0.793 Test Loss: 1.243 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792580).  Saving model ...
Epoch: 37 cost time: 0.8602797985076904
Epoch: 37, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.214 Vali Acc: 0.796 Test Loss: 1.214 Test Acc: 0.796
Validation loss decreased (-0.792580 --> -0.796284).  Saving model ...
Epoch: 38 cost time: 0.7778112888336182
Epoch: 38, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.185 Vali Acc: 0.807 Test Loss: 1.185 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807396).  Saving model ...
Epoch: 39 cost time: 0.9081909656524658
Epoch: 39, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.157 Vali Acc: 0.822 Test Loss: 1.157 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 40 cost time: 0.8577234745025635
Epoch: 40, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.128 Vali Acc: 0.830 Test Loss: 1.128 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829618).  Saving model ...
Epoch: 41 cost time: 0.8916544914245605
Epoch: 41, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.100 Vali Acc: 0.837 Test Loss: 1.100 Test Acc: 0.837
Validation loss decreased (-0.829618 --> -0.837026).  Saving model ...
Epoch: 42 cost time: 0.71163010597229
Epoch: 42, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.073 Vali Acc: 0.852 Test Loss: 1.073 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851841).  Saving model ...
Epoch: 43 cost time: 0.5964219570159912
Epoch: 43, Steps: 2 | Train Loss: 0.928 Vali Loss: 1.045 Vali Acc: 0.859 Test Loss: 1.045 Test Acc: 0.859
Validation loss decreased (-0.851841 --> -0.859249).  Saving model ...
Epoch: 44 cost time: 1.0611755847930908
Epoch: 44, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.018 Vali Acc: 0.867 Test Loss: 1.018 Test Acc: 0.867
Validation loss decreased (-0.859249 --> -0.866656).  Saving model ...
Epoch: 45 cost time: 0.9244580268859863
Epoch: 45, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.992 Vali Acc: 0.878 Test Loss: 0.992 Test Acc: 0.878
Validation loss decreased (-0.866656 --> -0.877768).  Saving model ...
Epoch: 46 cost time: 0.7916123867034912
Epoch: 46, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.966 Vali Acc: 0.881 Test Loss: 0.966 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 47 cost time: 0.6849415302276611
Epoch: 47, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.940 Vali Acc: 0.885 Test Loss: 0.940 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 48 cost time: 0.7775945663452148
Epoch: 48, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.915 Vali Acc: 0.885 Test Loss: 0.915 Test Acc: 0.885
Validation loss decreased (-0.885176 --> -0.885176).  Saving model ...
Epoch: 49 cost time: 0.714393138885498
Epoch: 49, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.891 Vali Acc: 0.896 Test Loss: 0.891 Test Acc: 0.896
Validation loss decreased (-0.885176 --> -0.896287).  Saving model ...
Epoch: 50 cost time: 1.032872200012207
Epoch: 50, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.867 Vali Acc: 0.900 Test Loss: 0.867 Test Acc: 0.900
Validation loss decreased (-0.896287 --> -0.899991).  Saving model ...
Epoch: 51 cost time: 0.8544971942901611
Epoch: 51, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.844 Vali Acc: 0.904 Test Loss: 0.844 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 52 cost time: 0.76987624168396
Epoch: 52, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.822 Vali Acc: 0.907 Test Loss: 0.822 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 53 cost time: 0.875943660736084
Epoch: 53, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.800 Vali Acc: 0.911 Test Loss: 0.800 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 54 cost time: 0.7946064472198486
Epoch: 54, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.779 Vali Acc: 0.915 Test Loss: 0.779 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 55 cost time: 0.857572078704834
Epoch: 55, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.758 Vali Acc: 0.919 Test Loss: 0.758 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 56 cost time: 0.718726634979248
Epoch: 56, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.739 Vali Acc: 0.919 Test Loss: 0.739 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 57 cost time: 0.8043398857116699
Epoch: 57, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.720 Vali Acc: 0.919 Test Loss: 0.720 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 58 cost time: 0.8524069786071777
Epoch: 58, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.702 Vali Acc: 0.919 Test Loss: 0.702 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 59 cost time: 0.6842637062072754
Epoch: 59, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.684 Vali Acc: 0.919 Test Loss: 0.684 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 60 cost time: 0.8534054756164551
Epoch: 60, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.667 Vali Acc: 0.919 Test Loss: 0.667 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 61 cost time: 0.8514425754547119
Epoch: 61, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.650 Vali Acc: 0.915 Test Loss: 0.650 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6519088745117188
Epoch: 62, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.635 Vali Acc: 0.919 Test Loss: 0.635 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 63 cost time: 0.799872636795044
Epoch: 63, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.620 Vali Acc: 0.922 Test Loss: 0.620 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 64 cost time: 0.8585062026977539
Epoch: 64, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.605 Vali Acc: 0.926 Test Loss: 0.605 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 65 cost time: 0.6265571117401123
Epoch: 65, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.591 Vali Acc: 0.922 Test Loss: 0.591 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9659700393676758
Epoch: 66, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.577 Vali Acc: 0.922 Test Loss: 0.577 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.7799484729766846
Epoch: 67, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8333113193511963
Epoch: 68, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.552 Vali Acc: 0.930 Test Loss: 0.552 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 69 cost time: 0.9045217037200928
Epoch: 69, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.540 Vali Acc: 0.930 Test Loss: 0.540 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 70 cost time: 0.9513936042785645
Epoch: 70, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.529 Vali Acc: 0.930 Test Loss: 0.529 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 71 cost time: 0.928375244140625
Epoch: 71, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.518 Vali Acc: 0.926 Test Loss: 0.518 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8059277534484863
Epoch: 72, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.508 Vali Acc: 0.926 Test Loss: 0.508 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.5717997550964355
Epoch: 73, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.498 Vali Acc: 0.926 Test Loss: 0.498 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.7207448482513428
Epoch: 74, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.488 Vali Acc: 0.926 Test Loss: 0.488 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.0177650451660156
Epoch: 75, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.479 Vali Acc: 0.930 Test Loss: 0.479 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 76 cost time: 0.6932480335235596
Epoch: 76, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.470 Vali Acc: 0.930 Test Loss: 0.470 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 77 cost time: 0.7213518619537354
Epoch: 77, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.462 Vali Acc: 0.930 Test Loss: 0.462 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 78 cost time: 0.7278690338134766
Epoch: 78, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.454 Vali Acc: 0.930 Test Loss: 0.454 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 79 cost time: 0.6638572216033936
Epoch: 79, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.446 Vali Acc: 0.930 Test Loss: 0.446 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 80 cost time: 0.8358845710754395
Epoch: 80, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 81 cost time: 0.7388467788696289
Epoch: 81, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.431 Vali Acc: 0.930 Test Loss: 0.431 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 82 cost time: 0.8006303310394287
Epoch: 82, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 83 cost time: 0.7381081581115723
Epoch: 83, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.418 Vali Acc: 0.930 Test Loss: 0.418 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 84 cost time: 0.6560041904449463
Epoch: 84, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.412 Vali Acc: 0.930 Test Loss: 0.412 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 85 cost time: 0.7563042640686035
Epoch: 85, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 86 cost time: 0.871302604675293
Epoch: 86, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.400 Vali Acc: 0.930 Test Loss: 0.400 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 87 cost time: 0.877023458480835
Epoch: 87, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.394 Vali Acc: 0.930 Test Loss: 0.394 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 88 cost time: 1.043475866317749
Epoch: 88, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.389 Vali Acc: 0.930 Test Loss: 0.389 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 89 cost time: 0.8235299587249756
Epoch: 89, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.383 Vali Acc: 0.930 Test Loss: 0.383 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 90 cost time: 0.7454574108123779
Epoch: 90, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.378 Vali Acc: 0.930 Test Loss: 0.378 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 91 cost time: 0.5829005241394043
Epoch: 91, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 92 cost time: 0.6119341850280762
Epoch: 92, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.369 Vali Acc: 0.930 Test Loss: 0.369 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 93 cost time: 0.7245378494262695
Epoch: 93, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 94 cost time: 0.832355260848999
Epoch: 94, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 95 cost time: 0.6733241081237793
Epoch: 95, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 96 cost time: 0.7648289203643799
Epoch: 96, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.351 Vali Acc: 0.933 Test Loss: 0.351 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 97 cost time: 0.7768194675445557
Epoch: 97, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 98 cost time: 1.0671062469482422
Epoch: 98, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 99 cost time: 0.8586835861206055
Epoch: 99, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 100 cost time: 0.6955764293670654
Epoch: 100, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs5_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 7113
model size : 0.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.391040563583374
Epoch: 1, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.916 Vali Acc: 0.093 Test Loss: 1.916 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 0.6148440837860107
Epoch: 2, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.899 Vali Acc: 0.100 Test Loss: 1.899 Test Acc: 0.100
Validation loss decreased (-0.092573 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.8600959777832031
Epoch: 3, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.888 Vali Acc: 0.111 Test Loss: 1.888 Test Acc: 0.111
Validation loss decreased (-0.099981 --> -0.111092).  Saving model ...
Epoch: 4 cost time: 1.0922760963439941
Epoch: 4, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.879 Vali Acc: 0.122 Test Loss: 1.879 Test Acc: 0.122
Validation loss decreased (-0.111092 --> -0.122203).  Saving model ...
Epoch: 5 cost time: 0.8679773807525635
Epoch: 5, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.868 Vali Acc: 0.122 Test Loss: 1.868 Test Acc: 0.122
Validation loss decreased (-0.122203 --> -0.122204).  Saving model ...
Epoch: 6 cost time: 0.5746049880981445
Epoch: 6, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.855 Vali Acc: 0.126 Test Loss: 1.855 Test Acc: 0.126
Validation loss decreased (-0.122204 --> -0.125907).  Saving model ...
Epoch: 7 cost time: 0.6944167613983154
Epoch: 7, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.840 Vali Acc: 0.141 Test Loss: 1.840 Test Acc: 0.141
Validation loss decreased (-0.125907 --> -0.140722).  Saving model ...
Epoch: 8 cost time: 0.7368228435516357
Epoch: 8, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.824 Vali Acc: 0.148 Test Loss: 1.824 Test Acc: 0.148
Validation loss decreased (-0.140722 --> -0.148130).  Saving model ...
Epoch: 9 cost time: 0.894456148147583
Epoch: 9, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.806 Vali Acc: 0.159 Test Loss: 1.806 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 10 cost time: 0.8033764362335205
Epoch: 10, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.788 Vali Acc: 0.170 Test Loss: 1.788 Test Acc: 0.170
Validation loss decreased (-0.159241 --> -0.170352).  Saving model ...
Epoch: 11 cost time: 0.7517738342285156
Epoch: 11, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.768 Vali Acc: 0.196 Test Loss: 1.768 Test Acc: 0.196
Validation loss decreased (-0.170352 --> -0.196279).  Saving model ...
Epoch: 12 cost time: 0.9294412136077881
Epoch: 12, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.747 Vali Acc: 0.215 Test Loss: 1.747 Test Acc: 0.215
Validation loss decreased (-0.196279 --> -0.214797).  Saving model ...
Epoch: 13 cost time: 0.9167063236236572
Epoch: 13, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.726 Vali Acc: 0.226 Test Loss: 1.726 Test Acc: 0.226
Validation loss decreased (-0.214797 --> -0.225909).  Saving model ...
Epoch: 14 cost time: 0.616091251373291
Epoch: 14, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.704 Vali Acc: 0.244 Test Loss: 1.704 Test Acc: 0.244
Validation loss decreased (-0.225909 --> -0.244427).  Saving model ...
Epoch: 15 cost time: 0.706364631652832
Epoch: 15, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.682 Vali Acc: 0.263 Test Loss: 1.682 Test Acc: 0.263
Validation loss decreased (-0.244427 --> -0.262946).  Saving model ...
Epoch: 16 cost time: 0.6222817897796631
Epoch: 16, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.659 Vali Acc: 0.281 Test Loss: 1.659 Test Acc: 0.281
Validation loss decreased (-0.262946 --> -0.281465).  Saving model ...
Epoch: 17 cost time: 0.8452227115631104
Epoch: 17, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.636 Vali Acc: 0.300 Test Loss: 1.636 Test Acc: 0.300
Validation loss decreased (-0.281465 --> -0.299984).  Saving model ...
Epoch: 18 cost time: 0.7341678142547607
Epoch: 18, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.612 Vali Acc: 0.333 Test Loss: 1.612 Test Acc: 0.333
Validation loss decreased (-0.299984 --> -0.333317).  Saving model ...
Epoch: 19 cost time: 0.8762626647949219
Epoch: 19, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.588 Vali Acc: 0.352 Test Loss: 1.588 Test Acc: 0.352
Validation loss decreased (-0.333317 --> -0.351836).  Saving model ...
Epoch: 20 cost time: 0.6432845592498779
Epoch: 20, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.563 Vali Acc: 0.370 Test Loss: 1.563 Test Acc: 0.370
Validation loss decreased (-0.351836 --> -0.370355).  Saving model ...
Epoch: 21 cost time: 0.6199915409088135
Epoch: 21, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.538 Vali Acc: 0.400 Test Loss: 1.538 Test Acc: 0.400
Validation loss decreased (-0.370355 --> -0.399985).  Saving model ...
Epoch: 22 cost time: 1.1131103038787842
Epoch: 22, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.513 Vali Acc: 0.419 Test Loss: 1.513 Test Acc: 0.419
Validation loss decreased (-0.399985 --> -0.418503).  Saving model ...
Epoch: 23 cost time: 1.0168380737304688
Epoch: 23, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.488 Vali Acc: 0.456 Test Loss: 1.488 Test Acc: 0.456
Validation loss decreased (-0.418503 --> -0.455541).  Saving model ...
Epoch: 24 cost time: 0.5932250022888184
Epoch: 24, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.462 Vali Acc: 0.511 Test Loss: 1.462 Test Acc: 0.511
Validation loss decreased (-0.455541 --> -0.511096).  Saving model ...
Epoch: 25 cost time: 0.7411766052246094
Epoch: 25, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.436 Vali Acc: 0.596 Test Loss: 1.436 Test Acc: 0.596
Validation loss decreased (-0.511096 --> -0.596282).  Saving model ...
Epoch: 26 cost time: 0.7399959564208984
Epoch: 26, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.410 Vali Acc: 0.656 Test Loss: 1.410 Test Acc: 0.656
Validation loss decreased (-0.596282 --> -0.655541).  Saving model ...
Epoch: 27 cost time: 0.7644650936126709
Epoch: 27, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.384 Vali Acc: 0.707 Test Loss: 1.384 Test Acc: 0.707
Validation loss decreased (-0.655541 --> -0.707394).  Saving model ...
Epoch: 28 cost time: 0.8026003837585449
Epoch: 28, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.357 Vali Acc: 0.730 Test Loss: 1.357 Test Acc: 0.730
Validation loss decreased (-0.707394 --> -0.729616).  Saving model ...
Epoch: 29 cost time: 0.6299967765808105
Epoch: 29, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.331 Vali Acc: 0.756 Test Loss: 1.331 Test Acc: 0.756
Validation loss decreased (-0.729616 --> -0.755542).  Saving model ...
Epoch: 30 cost time: 0.7250175476074219
Epoch: 30, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.305 Vali Acc: 0.763 Test Loss: 1.305 Test Acc: 0.763
Validation loss decreased (-0.755542 --> -0.762950).  Saving model ...
Epoch: 31 cost time: 0.8308548927307129
Epoch: 31, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.278 Vali Acc: 0.781 Test Loss: 1.278 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 32 cost time: 0.8821830749511719
Epoch: 32, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.252 Vali Acc: 0.785 Test Loss: 1.252 Test Acc: 0.785
Validation loss decreased (-0.781469 --> -0.785173).  Saving model ...
Epoch: 33 cost time: 0.7867624759674072
Epoch: 33, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.225 Vali Acc: 0.804 Test Loss: 1.225 Test Acc: 0.804
Validation loss decreased (-0.785173 --> -0.803691).  Saving model ...
Epoch: 34 cost time: 0.5715858936309814
Epoch: 34, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.198 Vali Acc: 0.811 Test Loss: 1.198 Test Acc: 0.811
Validation loss decreased (-0.803691 --> -0.811099).  Saving model ...
Epoch: 35 cost time: 0.9055948257446289
Epoch: 35, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.172 Vali Acc: 0.819 Test Loss: 1.172 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 36 cost time: 0.7913930416107178
Epoch: 36, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.145 Vali Acc: 0.841 Test Loss: 1.145 Test Acc: 0.841
Validation loss decreased (-0.818507 --> -0.840729).  Saving model ...
Epoch: 37 cost time: 0.7513728141784668
Epoch: 37, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.119 Vali Acc: 0.856 Test Loss: 1.119 Test Acc: 0.856
Validation loss decreased (-0.840729 --> -0.855544).  Saving model ...
Epoch: 38 cost time: 0.803896427154541
Epoch: 38, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.093 Vali Acc: 0.867 Test Loss: 1.093 Test Acc: 0.867
Validation loss decreased (-0.855544 --> -0.866656).  Saving model ...
Epoch: 39 cost time: 0.5789611339569092
Epoch: 39, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.066 Vali Acc: 0.870 Test Loss: 1.066 Test Acc: 0.870
Validation loss decreased (-0.866656 --> -0.870360).  Saving model ...
Epoch: 40 cost time: 0.5922188758850098
Epoch: 40, Steps: 2 | Train Loss: 0.919 Vali Loss: 1.040 Vali Acc: 0.870 Test Loss: 1.040 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870360).  Saving model ...
Epoch: 41 cost time: 0.7143397331237793
Epoch: 41, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.015 Vali Acc: 0.870 Test Loss: 1.015 Test Acc: 0.870
Validation loss decreased (-0.870360 --> -0.870360).  Saving model ...
Epoch: 42 cost time: 0.7087748050689697
Epoch: 42, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.989 Vali Acc: 0.878 Test Loss: 0.989 Test Acc: 0.878
Validation loss decreased (-0.870360 --> -0.877768).  Saving model ...
Epoch: 43 cost time: 1.0013654232025146
Epoch: 43, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.964 Vali Acc: 0.889 Test Loss: 0.964 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888879).  Saving model ...
Epoch: 44 cost time: 1.0957295894622803
Epoch: 44, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.940 Vali Acc: 0.889 Test Loss: 0.940 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 45 cost time: 0.8439457416534424
Epoch: 45, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.915 Vali Acc: 0.896 Test Loss: 0.915 Test Acc: 0.896
Validation loss decreased (-0.888879 --> -0.896287).  Saving model ...
Epoch: 46 cost time: 0.8509597778320312
Epoch: 46, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.892 Vali Acc: 0.900 Test Loss: 0.892 Test Acc: 0.900
Validation loss decreased (-0.896287 --> -0.899991).  Saving model ...
Epoch: 47 cost time: 0.8925323486328125
Epoch: 47, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.868 Vali Acc: 0.900 Test Loss: 0.868 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899991).  Saving model ...
Epoch: 48 cost time: 0.8129327297210693
Epoch: 48, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.846 Vali Acc: 0.896 Test Loss: 0.846 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.797297477722168
Epoch: 49, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.823 Vali Acc: 0.900 Test Loss: 0.823 Test Acc: 0.900
Validation loss decreased (-0.899991 --> -0.899992).  Saving model ...
Epoch: 50 cost time: 0.8151540756225586
Epoch: 50, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.802 Vali Acc: 0.904 Test Loss: 0.802 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 51 cost time: 0.8056502342224121
Epoch: 51, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.781 Vali Acc: 0.904 Test Loss: 0.781 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903696).  Saving model ...
Epoch: 52 cost time: 0.6794633865356445
Epoch: 52, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.760 Vali Acc: 0.907 Test Loss: 0.760 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 53 cost time: 0.8002274036407471
Epoch: 53, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.740 Vali Acc: 0.904 Test Loss: 0.740 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.697756290435791
Epoch: 54, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.721 Vali Acc: 0.907 Test Loss: 0.721 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 55 cost time: 0.653662919998169
Epoch: 55, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.703 Vali Acc: 0.907 Test Loss: 0.703 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 56 cost time: 0.5789024829864502
Epoch: 56, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.685 Vali Acc: 0.904 Test Loss: 0.685 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8009293079376221
Epoch: 57, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.667 Vali Acc: 0.904 Test Loss: 0.667 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.704322338104248
Epoch: 58, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.650 Vali Acc: 0.904 Test Loss: 0.650 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.1912927627563477
Epoch: 59, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.634 Vali Acc: 0.904 Test Loss: 0.634 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.8138754367828369
Epoch: 60, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.618 Vali Acc: 0.904 Test Loss: 0.618 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6378300189971924
Epoch: 61, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.603 Vali Acc: 0.907 Test Loss: 0.603 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 62 cost time: 0.7350220680236816
Epoch: 62, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.589 Vali Acc: 0.911 Test Loss: 0.589 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 63 cost time: 1.035820722579956
Epoch: 63, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.574 Vali Acc: 0.911 Test Loss: 0.574 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 64 cost time: 0.5617337226867676
Epoch: 64, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.561 Vali Acc: 0.915 Test Loss: 0.561 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 65 cost time: 0.7930939197540283
Epoch: 65, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.548 Vali Acc: 0.915 Test Loss: 0.548 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 66 cost time: 0.7060585021972656
Epoch: 66, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.535 Vali Acc: 0.915 Test Loss: 0.535 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 67 cost time: 0.8592789173126221
Epoch: 67, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.524 Vali Acc: 0.915 Test Loss: 0.524 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 68 cost time: 0.8899929523468018
Epoch: 68, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.512 Vali Acc: 0.915 Test Loss: 0.512 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 69 cost time: 0.8868889808654785
Epoch: 69, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.501 Vali Acc: 0.915 Test Loss: 0.501 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 70 cost time: 0.8730015754699707
Epoch: 70, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.490 Vali Acc: 0.915 Test Loss: 0.490 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 71 cost time: 0.6638834476470947
Epoch: 71, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.480 Vali Acc: 0.915 Test Loss: 0.480 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 72 cost time: 0.6097209453582764
Epoch: 72, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.471 Vali Acc: 0.911 Test Loss: 0.471 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.6686351299285889
Epoch: 73, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.461 Vali Acc: 0.915 Test Loss: 0.461 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 74 cost time: 0.4946606159210205
Epoch: 74, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 75 cost time: 0.6782586574554443
Epoch: 75, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7751424312591553
Epoch: 76, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.435 Vali Acc: 0.911 Test Loss: 0.435 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.9373044967651367
Epoch: 77, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.8439445495605469
Epoch: 78, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.420 Vali Acc: 0.907 Test Loss: 0.420 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.6097240447998047
Epoch: 79, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.412 Vali Acc: 0.907 Test Loss: 0.412 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.6175482273101807
Epoch: 80, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.6490998268127441
Epoch: 81, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.398 Vali Acc: 0.907 Test Loss: 0.398 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.6674728393554688
Epoch: 82, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.392 Vali Acc: 0.907 Test Loss: 0.392 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.5526697635650635
Epoch: 83, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.385 Vali Acc: 0.907 Test Loss: 0.385 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 84 cost time: 0.9274067878723145
Epoch: 84, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_LightTS_UEA_ftM_sl65_ll0_pl0_dm32_cs4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 7548
model size : 0.04MB
