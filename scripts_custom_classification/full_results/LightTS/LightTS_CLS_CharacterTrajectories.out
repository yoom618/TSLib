Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.608461380004883
Epoch: 1, Steps: 89 | Train Loss: 2.419 Vali Loss: 1.322 Vali Acc: 0.769 Test Loss: 1.322 Test Acc: 0.769
Validation loss decreased (inf --> -0.768789).  Saving model ...
Epoch: 2 cost time: 1.3222625255584717
Epoch: 2, Steps: 89 | Train Loss: 0.620 Vali Loss: 0.460 Vali Acc: 0.868 Test Loss: 0.460 Test Acc: 0.868
Validation loss decreased (-0.768789 --> -0.868380).  Saving model ...
Epoch: 3 cost time: 1.4387259483337402
Epoch: 3, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.268 Vali Acc: 0.927 Test Loss: 0.268 Test Acc: 0.927
Validation loss decreased (-0.868380 --> -0.926878).  Saving model ...
Epoch: 4 cost time: 1.3752779960632324
Epoch: 4, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.224 Vali Acc: 0.939 Test Loss: 0.224 Test Acc: 0.939
Validation loss decreased (-0.926878 --> -0.938716).  Saving model ...
Epoch: 5 cost time: 1.3454945087432861
Epoch: 5, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
Validation loss decreased (-0.938716 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 1.4022748470306396
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.955430 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 1.4624745845794678
Epoch: 7, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4373366832733154
Epoch: 8, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.214 Vali Acc: 0.958 Test Loss: 0.214 Test Acc: 0.958
Validation loss decreased (-0.956823 --> -0.958215).  Saving model ...
Epoch: 9 cost time: 1.368037462234497
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.958215 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 1.1917610168457031
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3286826610565186
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2390224933624268
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.193 Vali Acc: 0.966 Test Loss: 0.193 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.25003981590271
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.491 Vali Acc: 0.915 Test Loss: 0.491 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3589863777160645
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 15 cost time: 1.2744574546813965
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5303304195404053
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.153 Vali Acc: 0.966 Test Loss: 0.153 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4270877838134766
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.972840 --> -0.980501).  Saving model ...
Epoch: 18 cost time: 1.3806052207946777
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5635929107666016
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4351484775543213
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5122885704040527
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8235979080200195
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.973 Test Loss: 0.164 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7874577045440674
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7446248531341553
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9287033081054688
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9710259437561035
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.11372447013855
Epoch: 27, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.201 Vali Acc: 0.958 Test Loss: 0.201 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 178602
model size : 0.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.286165952682495
Epoch: 1, Steps: 89 | Train Loss: 2.368 Vali Loss: 1.469 Vali Acc: 0.707 Test Loss: 1.469 Test Acc: 0.707
Validation loss decreased (inf --> -0.706810).  Saving model ...
Epoch: 2 cost time: 1.827089786529541
Epoch: 2, Steps: 89 | Train Loss: 0.808 Vali Loss: 0.441 Vali Acc: 0.875 Test Loss: 0.441 Test Acc: 0.875
Validation loss decreased (-0.706810 --> -0.874647).  Saving model ...
Epoch: 3 cost time: 1.7162375450134277
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.264 Vali Acc: 0.924 Test Loss: 0.264 Test Acc: 0.924
Validation loss decreased (-0.874647 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 1.6964256763458252
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.924092 --> -0.940806).  Saving model ...
Epoch: 5 cost time: 1.7568812370300293
Epoch: 5, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.940806 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 1.721660852432251
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 1.8671875
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.157 Vali Acc: 0.970 Test Loss: 0.157 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8089191913604736
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.097877025604248
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 2.133427143096924
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.215 Vali Acc: 0.939 Test Loss: 0.215 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7890591621398926
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 1.758737325668335
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 1.754279613494873
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.944882869720459
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.101 Vali Acc: 0.983 Test Loss: 0.101 Test Acc: 0.983
Validation loss decreased (-0.979108 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 1.9192521572113037
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9955227375030518
Epoch: 16, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7216298580169678
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9431648254394531
Epoch: 18, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8091661930084229
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9748313426971436
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.977 Test Loss: 0.128 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0498619079589844
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.972 Test Loss: 0.196 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0287022590637207
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7943787574768066
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.8249080181121826
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 171118
model size : 0.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.644223928451538
Epoch: 1, Steps: 89 | Train Loss: 2.486 Vali Loss: 1.589 Vali Acc: 0.713 Test Loss: 1.589 Test Acc: 0.713
Validation loss decreased (inf --> -0.713076).  Saving model ...
Epoch: 2 cost time: 2.1203930377960205
Epoch: 2, Steps: 89 | Train Loss: 0.837 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
Validation loss decreased (-0.713076 --> -0.888575).  Saving model ...
Epoch: 3 cost time: 2.2652835845947266
Epoch: 3, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.316 Vali Acc: 0.921 Test Loss: 0.316 Test Acc: 0.921
Validation loss decreased (-0.888575 --> -0.920610).  Saving model ...
Epoch: 4 cost time: 2.1263656616210938
Epoch: 4, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
Validation loss decreased (-0.920610 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 1.7570934295654297
Epoch: 5, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 1.758481740951538
Epoch: 6, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.147 Vali Acc: 0.957 Test Loss: 0.147 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.694941759109497
Epoch: 7, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.141 Vali Acc: 0.958 Test Loss: 0.141 Test Acc: 0.958
Validation loss decreased (-0.958216 --> -0.958216).  Saving model ...
Epoch: 8 cost time: 2.0644521713256836
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.119 Vali Acc: 0.962 Test Loss: 0.119 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962394).  Saving model ...
Epoch: 9 cost time: 2.0691986083984375
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.110 Vali Acc: 0.972 Test Loss: 0.110 Test Acc: 0.972
Validation loss decreased (-0.962394 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 2.119739055633545
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.149 Vali Acc: 0.952 Test Loss: 0.149 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8145806789398193
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
Validation loss decreased (-0.972144 --> -0.981893).  Saving model ...
Epoch: 12 cost time: 2.3519322872161865
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8901009559631348
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.094 Vali Acc: 0.974 Test Loss: 0.094 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.905721664428711
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7985544204711914
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.083 Vali Acc: 0.980 Test Loss: 0.083 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.954698085784912
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.137 Vali Acc: 0.966 Test Loss: 0.137 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7741236686706543
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8225936889648438
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7670936584472656
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8349840641021729
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.101 Vali Acc: 0.975 Test Loss: 0.101 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8158059120178223
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 167478
model size : 0.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2679903507232666
Epoch: 1, Steps: 89 | Train Loss: 2.506 Vali Loss: 1.494 Vali Acc: 0.696 Test Loss: 1.494 Test Acc: 0.696
Validation loss decreased (inf --> -0.696364).  Saving model ...
Epoch: 2 cost time: 2.2028181552886963
Epoch: 2, Steps: 89 | Train Loss: 0.687 Vali Loss: 0.484 Vali Acc: 0.843 Test Loss: 0.484 Test Acc: 0.843
Validation loss decreased (-0.696364 --> -0.843310).  Saving model ...
Epoch: 3 cost time: 1.7149100303649902
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.843310 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 2.1349337100982666
Epoch: 4, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.937324 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 1.6714880466461182
Epoch: 5, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.210 Vali Acc: 0.943 Test Loss: 0.210 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8068203926086426
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
Validation loss decreased (-0.943591 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 1.8646926879882812
Epoch: 7, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.104 Vali Acc: 0.971 Test Loss: 0.104 Test Acc: 0.971
Validation loss decreased (-0.959608 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 2.090306520462036
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.943418025970459
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 1.9796607494354248
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 2.1199965476989746
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.083859920501709
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1121010780334473
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8015780448913574
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.166 Vali Acc: 0.967 Test Loss: 0.166 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9307448863983154
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 1.682011365890503
Epoch: 16, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8564369678497314
Epoch: 17, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 1.8179359436035156
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.311 Vali Acc: 0.951 Test Loss: 0.311 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8517005443572998
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
Validation loss decreased (-0.978411 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 1.7347400188446045
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6911323070526123
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8314321041107178
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.259 Vali Acc: 0.960 Test Loss: 0.259 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.845451831817627
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9289238452911377
Epoch: 24, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.414 Vali Acc: 0.920 Test Loss: 0.414 Test Acc: 0.920
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.636695146560669
Epoch: 25, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9860024452209473
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.135 Vali Acc: 0.978 Test Loss: 0.135 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9365737438201904
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.124 Vali Acc: 0.984 Test Loss: 0.124 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 28 cost time: 2.0710315704345703
Epoch: 28, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.192 Vali Acc: 0.969 Test Loss: 0.192 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9345571994781494
Epoch: 29, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.0390312671661377
Epoch: 30, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.982177495956421
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.1588692665100098
Epoch: 32, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.982 Test Loss: 0.112 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.1600728034973145
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 34 cost time: 2.015868663787842
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.984 Test Loss: 0.117 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 35 cost time: 1.771862506866455
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.985 Test Loss: 0.118 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 36 cost time: 1.86578369140625
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.985 Test Loss: 0.118 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.828991174697876
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985375).  Saving model ...
Epoch: 38 cost time: 1.9368572235107422
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.88399338722229
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9451355934143066
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8286972045898438
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9225983619689941
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.986 Test Loss: 0.122 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 43 cost time: 1.8497192859649658
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.986 Test Loss: 0.123 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.1296658515930176
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.986 Test Loss: 0.123 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.0025839805603027
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.986 Test Loss: 0.124 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.996401071548462
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.986 Test Loss: 0.125 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.901285171508789
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.986 Test Loss: 0.126 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.7412242889404297
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.986 Test Loss: 0.127 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.2081220149993896
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.986 Test Loss: 0.127 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.124258041381836
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.986 Test Loss: 0.128 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.8565528392791748
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986768).  Saving model ...
Epoch: 52 cost time: 1.853820562362671
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.9419176578521729
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.987 Test Loss: 0.130 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 2.0406994819641113
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.987 Test Loss: 0.131 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 2.2052125930786133
Epoch: 55, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.987 Test Loss: 0.131 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.8373069763183594
Epoch: 56, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.987 Test Loss: 0.132 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.8035595417022705
Epoch: 57, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.987 Test Loss: 0.133 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.9371309280395508
Epoch: 58, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.987 Test Loss: 0.133 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 1.9402024745941162
Epoch: 59, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.134 Vali Acc: 0.987 Test Loss: 0.134 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.904942512512207
Epoch: 60, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.987 Test Loss: 0.135 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.9725925922393799
Epoch: 61, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.987 Test Loss: 0.135 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 165378
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1291425228118896
Epoch: 1, Steps: 89 | Train Loss: 2.361 Vali Loss: 1.253 Vali Acc: 0.717 Test Loss: 1.253 Test Acc: 0.717
Validation loss decreased (inf --> -0.717258).  Saving model ...
Epoch: 2 cost time: 1.853522777557373
Epoch: 2, Steps: 89 | Train Loss: 0.628 Vali Loss: 0.373 Vali Acc: 0.883 Test Loss: 0.373 Test Acc: 0.883
Validation loss decreased (-0.717258 --> -0.883005).  Saving model ...
Epoch: 3 cost time: 1.8634154796600342
Epoch: 3, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.246 Vali Acc: 0.929 Test Loss: 0.246 Test Acc: 0.929
Validation loss decreased (-0.883005 --> -0.928967).  Saving model ...
Epoch: 4 cost time: 1.7982923984527588
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (-0.928967 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 1.7585139274597168
Epoch: 5, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 1.8105213642120361
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 1.7533597946166992
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8489301204681396
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 9 cost time: 1.8338074684143066
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8033156394958496
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7414007186889648
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 12 cost time: 1.8475680351257324
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.187 Vali Acc: 0.960 Test Loss: 0.187 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7344391345977783
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.768026351928711
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 1.7196004390716553
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982589).  Saving model ...
Epoch: 16 cost time: 1.7291820049285889
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.474 Vali Acc: 0.898 Test Loss: 0.474 Test Acc: 0.898
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8478903770446777
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.128 Vali Acc: 0.985 Test Loss: 0.128 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.984678).  Saving model ...
Epoch: 18 cost time: 1.7616779804229736
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.986553430557251
Epoch: 19, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9569873809814453
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.246 Vali Acc: 0.960 Test Loss: 0.246 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9421370029449463
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.198 Vali Acc: 0.962 Test Loss: 0.198 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0117266178131104
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.183 Vali Acc: 0.963 Test Loss: 0.183 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.964475154876709
Epoch: 23, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.208 Vali Acc: 0.965 Test Loss: 0.208 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8227450847625732
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6949763298034668
Epoch: 25, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.964 Test Loss: 0.190 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6385657787322998
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5845623016357422
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 164050
model size : 0.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0970067977905273
Epoch: 1, Steps: 89 | Train Loss: 2.415 Vali Loss: 1.481 Vali Acc: 0.677 Test Loss: 1.481 Test Acc: 0.677
Validation loss decreased (inf --> -0.676865).  Saving model ...
Epoch: 2 cost time: 2.0733354091644287
Epoch: 2, Steps: 89 | Train Loss: 0.720 Vali Loss: 0.390 Vali Acc: 0.909 Test Loss: 0.390 Test Acc: 0.909
Validation loss decreased (-0.676865 --> -0.909467).  Saving model ...
Epoch: 3 cost time: 1.8467490673065186
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.241 Vali Acc: 0.943 Test Loss: 0.241 Test Acc: 0.943
Validation loss decreased (-0.909467 --> -0.942895).  Saving model ...
Epoch: 4 cost time: 1.572089433670044
Epoch: 4, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
Validation loss decreased (-0.942895 --> -0.965179).  Saving model ...
Epoch: 5 cost time: 1.757751226425171
Epoch: 5, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
Validation loss decreased (-0.965179 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 1.799915075302124
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.157 Vali Acc: 0.966 Test Loss: 0.157 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7548019886016846
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.816643476486206
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9160988330841064
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 1.995894193649292
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8710005283355713
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.183 Vali Acc: 0.966 Test Loss: 0.183 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9658198356628418
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.943 Test Loss: 0.236 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.880053997039795
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0321857929229736
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.132296562194824
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.981196).  Saving model ...
Epoch: 16 cost time: 2.0449206829071045
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.150 Vali Acc: 0.963 Test Loss: 0.150 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8375308513641357
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.972 Test Loss: 0.134 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8796851634979248
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8145158290863037
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.5681750774383545
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.951 Test Loss: 0.233 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9085733890533447
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.1595993041992188
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8686718940734863
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.953 Test Loss: 0.237 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9782609939575195
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.977 Test Loss: 0.131 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8152995109558105
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.091 Vali Acc: 0.985 Test Loss: 0.091 Test Acc: 0.985
Validation loss decreased (-0.981196 --> -0.984679).  Saving model ...
Epoch: 26 cost time: 1.7218575477600098
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.141 Vali Acc: 0.981 Test Loss: 0.141 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.8234648704528809
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.7456235885620117
Epoch: 28, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8599112033843994
Epoch: 29, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6362037658691406
Epoch: 30, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5688583850860596
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.978 Test Loss: 0.165 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6905114650726318
Epoch: 32, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.962 Test Loss: 0.228 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.6232457160949707
Epoch: 33, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.698704481124878
Epoch: 34, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.971 Test Loss: 0.219 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.630305290222168
Epoch: 35, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.985 Test Loss: 0.123 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 162072
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8905513286590576
Epoch: 1, Steps: 89 | Train Loss: 2.384 Vali Loss: 1.392 Vali Acc: 0.720 Test Loss: 1.392 Test Acc: 0.720
Validation loss decreased (inf --> -0.720042).  Saving model ...
Epoch: 2 cost time: 2.029217004776001
Epoch: 2, Steps: 89 | Train Loss: 0.663 Vali Loss: 0.331 Vali Acc: 0.912 Test Loss: 0.331 Test Acc: 0.912
Validation loss decreased (-0.720042 --> -0.912253).  Saving model ...
Epoch: 3 cost time: 1.9073188304901123
Epoch: 3, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.912253 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 1.8138446807861328
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.947770 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 1.8143937587738037
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 1.932081699371338
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 1.7428815364837646
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.149 Vali Acc: 0.955 Test Loss: 0.149 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6756963729858398
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8567471504211426
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.087 Vali Acc: 0.976 Test Loss: 0.087 Test Acc: 0.976
Validation loss decreased (-0.966572 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 1.7695329189300537
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.095 Vali Acc: 0.982 Test Loss: 0.095 Test Acc: 0.982
Validation loss decreased (-0.976322 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 1.7660791873931885
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9751152992248535
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.969 Test Loss: 0.111 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2610769271850586
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9292261600494385
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8702843189239502
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.0267059803009033
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7358603477478027
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.7489714622497559
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 2.027594804763794
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 20 cost time: 1.8163373470306396
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.0820674896240234
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9029335975646973
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.968 Test Loss: 0.122 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.229820728302002
Epoch: 23, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8889706134796143
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.00138521194458
Epoch: 25, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.215 Vali Acc: 0.949 Test Loss: 0.215 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.863724708557129
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7664873600006104
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9169988632202148
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8402342796325684
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 161702
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.371950626373291
Epoch: 1, Steps: 89 | Train Loss: 2.382 Vali Loss: 1.418 Vali Acc: 0.698 Test Loss: 1.418 Test Acc: 0.698
Validation loss decreased (inf --> -0.698454).  Saving model ...
Epoch: 2 cost time: 2.2448527812957764
Epoch: 2, Steps: 89 | Train Loss: 0.728 Vali Loss: 0.420 Vali Acc: 0.888 Test Loss: 0.420 Test Acc: 0.888
Validation loss decreased (-0.698454 --> -0.887879).  Saving model ...
Epoch: 3 cost time: 2.148507595062256
Epoch: 3, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.261 Vali Acc: 0.924 Test Loss: 0.261 Test Acc: 0.924
Validation loss decreased (-0.887879 --> -0.924092).  Saving model ...
Epoch: 4 cost time: 2.2678399085998535
Epoch: 4, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.235 Vali Acc: 0.936 Test Loss: 0.235 Test Acc: 0.936
Validation loss decreased (-0.924092 --> -0.935931).  Saving model ...
Epoch: 5 cost time: 2.000830888748169
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.935931 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 2.1285159587860107
Epoch: 6, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.948466 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 2.2477359771728516
Epoch: 7, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 1.9752850532531738
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.164 Vali Acc: 0.970 Test Loss: 0.164 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 1.8286521434783936
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8091988563537598
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 1.8344614505767822
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.854557991027832
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.966 Test Loss: 0.214 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9038441181182861
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.228 Vali Acc: 0.958 Test Loss: 0.228 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9305150508880615
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2264373302459717
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.154 Vali Acc: 0.975 Test Loss: 0.154 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 2.1041934490203857
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.965 Test Loss: 0.222 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.067805528640747
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.176666021347046
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.960 Test Loss: 0.195 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0083611011505127
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.9655733108520508
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.030223846435547
Epoch: 21, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.152 Vali Acc: 0.966 Test Loss: 0.152 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3054418563842773
Epoch: 22, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2504160404205322
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.968 Test Loss: 0.201 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5485403537750244
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0421531200408936
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.978 Test Loss: 0.142 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 26 cost time: 1.7819929122924805
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.982 Test Loss: 0.150 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 27 cost time: 1.9200754165649414
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.152 Vali Acc: 0.980 Test Loss: 0.152 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7382547855377197
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.985 Test Loss: 0.144 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984678).  Saving model ...
Epoch: 29 cost time: 1.7886512279510498
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.982 Test Loss: 0.168 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7534637451171875
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.155 Vali Acc: 0.981 Test Loss: 0.155 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.9255955219268799
Epoch: 31, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.324 Vali Acc: 0.953 Test Loss: 0.324 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8752646446228027
Epoch: 32, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.312 Vali Acc: 0.946 Test Loss: 0.312 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.100550889968872
Epoch: 33, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.252 Vali Acc: 0.963 Test Loss: 0.252 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.6581270694732666
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8114652633666992
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.613067865371704
Epoch: 36, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.964 Test Loss: 0.233 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6997711658477783
Epoch: 37, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8292436599731445
Epoch: 38, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 162138
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.869380474090576
Epoch: 1, Steps: 89 | Train Loss: 2.537 Vali Loss: 1.572 Vali Acc: 0.722 Test Loss: 1.572 Test Acc: 0.722
Validation loss decreased (inf --> -0.722129).  Saving model ...
Epoch: 2 cost time: 1.8216071128845215
Epoch: 2, Steps: 89 | Train Loss: 0.777 Vali Loss: 0.467 Vali Acc: 0.882 Test Loss: 0.467 Test Acc: 0.882
Validation loss decreased (-0.722129 --> -0.881611).  Saving model ...
Epoch: 3 cost time: 1.9319605827331543
Epoch: 3, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.239 Vali Acc: 0.935 Test Loss: 0.239 Test Acc: 0.935
Validation loss decreased (-0.881611 --> -0.935234).  Saving model ...
Epoch: 4 cost time: 1.858304738998413
Epoch: 4, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
Validation loss decreased (-0.935234 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 1.8015782833099365
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.200 Vali Acc: 0.953 Test Loss: 0.200 Test Acc: 0.953
Validation loss decreased (-0.952644 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 1.7991058826446533
Epoch: 6, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.952644 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 1.747610092163086
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 1.6821062564849854
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.187 Vali Acc: 0.959 Test Loss: 0.187 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.811838150024414
Epoch: 9, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.896286964416504
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 1.7179780006408691
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.665571928024292
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 1.6555871963500977
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6799366474151611
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.983286).  Saving model ...
Epoch: 15 cost time: 2.023568868637085
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8484840393066406
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.78080415725708
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.121 Vali Acc: 0.982 Test Loss: 0.121 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7728700637817383
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1016087532043457
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7159366607666016
Epoch: 20, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.197 Vali Acc: 0.965 Test Loss: 0.197 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9277307987213135
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.8208332061767578
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.7838499546051025
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.979 Test Loss: 0.132 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6808419227600098
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 161850
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.943594217300415
Epoch: 1, Steps: 89 | Train Loss: 2.435 Vali Loss: 1.359 Vali Acc: 0.696 Test Loss: 1.359 Test Acc: 0.696
Validation loss decreased (inf --> -0.696365).  Saving model ...
Epoch: 2 cost time: 1.9693951606750488
Epoch: 2, Steps: 89 | Train Loss: 0.681 Vali Loss: 0.376 Vali Acc: 0.887 Test Loss: 0.376 Test Acc: 0.887
Validation loss decreased (-0.696365 --> -0.887183).  Saving model ...
Epoch: 3 cost time: 1.5929133892059326
Epoch: 3, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.254 Vali Acc: 0.939 Test Loss: 0.254 Test Acc: 0.939
Validation loss decreased (-0.887183 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 1.561933994293213
Epoch: 4, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
Validation loss decreased (-0.938716 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 1.8898310661315918
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.247809410095215
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
Validation loss decreased (-0.952644 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 1.8795790672302246
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.168 Vali Acc: 0.954 Test Loss: 0.168 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9368648529052734
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8350152969360352
Epoch: 9, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.113 Vali Acc: 0.972 Test Loss: 0.113 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1546926498413086
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.857933521270752
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 1.8009793758392334
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 1.8144235610961914
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8096632957458496
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7297492027282715
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7770495414733887
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9142987728118896
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6832213401794434
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.946406602859497
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977019).  Saving model ...
Epoch: 20 cost time: 1.8140220642089844
Epoch: 20, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9754252433776855
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.100407838821411
Epoch: 22, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.982589).  Saving model ...
Epoch: 23 cost time: 1.6406118869781494
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.765533685684204
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7584419250488281
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7333431243896484
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5593655109405518
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.153940200805664
Epoch: 28, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8464770317077637
Epoch: 29, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8678722381591797
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7138419151306152
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 32 cost time: 1.8177437782287598
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2387044429779053
Epoch: 33, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.981 Test Loss: 0.114 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8791742324829102
Epoch: 34, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.066833257675171
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.950364351272583
Epoch: 36, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9182958602905273
Epoch: 37, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8206837177276611
Epoch: 38, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8983094692230225
Epoch: 39, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.270 Vali Acc: 0.964 Test Loss: 0.270 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.9120030403137207
Epoch: 40, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.796158790588379
Epoch: 41, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 160838
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2789924144744873
Epoch: 1, Steps: 89 | Train Loss: 2.416 Vali Loss: 1.581 Vali Acc: 0.688 Test Loss: 1.581 Test Acc: 0.688
Validation loss decreased (inf --> -0.688006).  Saving model ...
Epoch: 2 cost time: 1.8398237228393555
Epoch: 2, Steps: 89 | Train Loss: 0.822 Vali Loss: 0.392 Vali Acc: 0.898 Test Loss: 0.392 Test Acc: 0.898
Validation loss decreased (-0.688006 --> -0.897628).  Saving model ...
Epoch: 3 cost time: 1.9718670845031738
Epoch: 3, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.225 Vali Acc: 0.942 Test Loss: 0.225 Test Acc: 0.942
Validation loss decreased (-0.897628 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 1.875342845916748
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.941502 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 1.751981258392334
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
Validation loss decreased (-0.946377 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 1.7252321243286133
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6966519355773926
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 1.9526443481445312
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 1.9308979511260986
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.897674560546875
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7086827754974365
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.955 Test Loss: 0.214 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.731598138809204
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
Validation loss decreased (-0.973536 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 1.797121524810791
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9679803848266602
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.135 Vali Acc: 0.980 Test Loss: 0.135 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8402388095855713
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.928412675857544
Epoch: 16, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.138 Vali Acc: 0.972 Test Loss: 0.138 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.688427448272705
Epoch: 17, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.960 Test Loss: 0.178 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7830066680908203
Epoch: 18, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.700486183166504
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.982 Test Loss: 0.098 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 1.9618275165557861
Epoch: 20, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6789307594299316
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.174 Vali Acc: 0.963 Test Loss: 0.174 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7814161777496338
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8875219821929932
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.088 Vali Acc: 0.982 Test Loss: 0.088 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 24 cost time: 1.824660062789917
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.882737636566162
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 26 cost time: 1.6621522903442383
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9772443771362305
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.101118803024292
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9339494705200195
Epoch: 29, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.825423002243042
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.014913558959961
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.917003870010376
Epoch: 32, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.968 Test Loss: 0.187 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.7155044078826904
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.966024398803711
Epoch: 34, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.0460386276245117
Epoch: 35, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 161542
model size : 0.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.359779119491577
Epoch: 1, Steps: 89 | Train Loss: 2.453 Vali Loss: 1.598 Vali Acc: 0.663 Test Loss: 1.598 Test Acc: 0.663
Validation loss decreased (inf --> -0.662937).  Saving model ...
Epoch: 2 cost time: 1.8911807537078857
Epoch: 2, Steps: 89 | Train Loss: 0.828 Vali Loss: 0.443 Vali Acc: 0.887 Test Loss: 0.443 Test Acc: 0.887
Validation loss decreased (-0.662937 --> -0.887182).  Saving model ...
Epoch: 3 cost time: 1.9524614810943604
Epoch: 3, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.887182 --> -0.951251).  Saving model ...
Epoch: 4 cost time: 1.6940851211547852
Epoch: 4, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.190 Vali Acc: 0.946 Test Loss: 0.190 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7061564922332764
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.951251 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 1.717266321182251
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.025172233581543
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7861785888671875
Epoch: 8, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9400787353515625
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.8044557571411133
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.088 Vali Acc: 0.977 Test Loss: 0.088 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977019).  Saving model ...
Epoch: 11 cost time: 2.0155043601989746
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.952178716659546
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.977019 --> -0.982589).  Saving model ...
Epoch: 13 cost time: 1.8506968021392822
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8790867328643799
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9745278358459473
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.851562738418579
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8523695468902588
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7304844856262207
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6212842464447021
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.194 Vali Acc: 0.964 Test Loss: 0.194 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.64088773727417
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.658735990524292
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.929704189300537
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 159264
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9681341648101807
Epoch: 1, Steps: 89 | Train Loss: 2.366 Vali Loss: 1.400 Vali Acc: 0.689 Test Loss: 1.400 Test Acc: 0.689
Validation loss decreased (inf --> -0.689401).  Saving model ...
Epoch: 2 cost time: 1.6797432899475098
Epoch: 2, Steps: 89 | Train Loss: 0.722 Vali Loss: 0.425 Vali Acc: 0.866 Test Loss: 0.425 Test Acc: 0.866
Validation loss decreased (-0.689401 --> -0.866291).  Saving model ...
Epoch: 3 cost time: 1.9751031398773193
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.304 Vali Acc: 0.912 Test Loss: 0.304 Test Acc: 0.912
Validation loss decreased (-0.866291 --> -0.912253).  Saving model ...
Epoch: 4 cost time: 1.7202749252319336
Epoch: 4, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
Validation loss decreased (-0.912253 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 1.8045854568481445
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7761871814727783
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
Validation loss decreased (-0.954037 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 1.5859591960906982
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.106 Vali Acc: 0.972 Test Loss: 0.106 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8527052402496338
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.078 Vali Acc: 0.974 Test Loss: 0.078 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7998936176300049
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 1.7699506282806396
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.112 Vali Acc: 0.970 Test Loss: 0.112 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6176841259002686
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7107295989990234
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7378487586975098
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981197).  Saving model ...
Epoch: 14 cost time: 1.574056625366211
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.078 Vali Acc: 0.981 Test Loss: 0.078 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 2.0167765617370605
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7318189144134521
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.103 Vali Acc: 0.973 Test Loss: 0.103 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8180897235870361
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.673051357269287
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7077322006225586
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.098 Vali Acc: 0.975 Test Loss: 0.098 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9099273681640625
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.092 Vali Acc: 0.978 Test Loss: 0.092 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7283060550689697
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.172 Vali Acc: 0.960 Test Loss: 0.172 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.902618408203125
Epoch: 22, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9902191162109375
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.083 Vali Acc: 0.984 Test Loss: 0.083 Test Acc: 0.984
Validation loss decreased (-0.981197 --> -0.983982).  Saving model ...
Epoch: 24 cost time: 1.8716795444488525
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.056 Vali Acc: 0.985 Test Loss: 0.056 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 25 cost time: 1.7502546310424805
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.987465).  Saving model ...
Epoch: 26 cost time: 1.6690120697021484
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.057 Vali Acc: 0.987 Test Loss: 0.057 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5280652046203613
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.058 Vali Acc: 0.989 Test Loss: 0.058 Test Acc: 0.989
Validation loss decreased (-0.987465 --> -0.988857).  Saving model ...
Epoch: 28 cost time: 1.7453973293304443
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.059 Vali Acc: 0.988 Test Loss: 0.059 Test Acc: 0.988
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7179911136627197
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.989 Test Loss: 0.060 Test Acc: 0.989
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6729941368103027
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.989 Test Loss: 0.060 Test Acc: 0.989
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.729741096496582
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.060 Vali Acc: 0.988 Test Loss: 0.060 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8828527927398682
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.061 Vali Acc: 0.988 Test Loss: 0.061 Test Acc: 0.988
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7704784870147705
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.989 Test Loss: 0.062 Test Acc: 0.989
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.1628475189208984
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.062 Vali Acc: 0.987 Test Loss: 0.062 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9697380065917969
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.989 Test Loss: 0.063 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.9605278968811035
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.063 Vali Acc: 0.990 Test Loss: 0.063 Test Acc: 0.990
Validation loss decreased (-0.988857 --> -0.989554).  Saving model ...
Epoch: 37 cost time: 2.0224480628967285
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.064 Vali Acc: 0.989 Test Loss: 0.064 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.1889147758483887
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.987 Test Loss: 0.065 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8915989398956299
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.065 Vali Acc: 0.988 Test Loss: 0.065 Test Acc: 0.988
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9802780151367188
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.861943006515503
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.066 Vali Acc: 0.987 Test Loss: 0.066 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6316430568695068
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.988 Test Loss: 0.067 Test Acc: 0.988
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.8256936073303223
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.067 Vali Acc: 0.989 Test Loss: 0.067 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.9329872131347656
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.8158020973205566
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.068 Vali Acc: 0.987 Test Loss: 0.068 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.949185848236084
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9895543175487466
model parameter : 159066
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6551311016082764
Epoch: 1, Steps: 89 | Train Loss: 2.485 Vali Loss: 1.562 Vali Acc: 0.703 Test Loss: 1.562 Test Acc: 0.703
Validation loss decreased (inf --> -0.702631).  Saving model ...
Epoch: 2 cost time: 1.9392280578613281
Epoch: 2, Steps: 89 | Train Loss: 0.792 Vali Loss: 0.392 Vali Acc: 0.903 Test Loss: 0.392 Test Acc: 0.903
Validation loss decreased (-0.702631 --> -0.903199).  Saving model ...
Epoch: 3 cost time: 1.8223552703857422
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.287 Vali Acc: 0.903 Test Loss: 0.287 Test Acc: 0.903
Validation loss decreased (-0.903199 --> -0.903200).  Saving model ...
Epoch: 4 cost time: 1.8354377746582031
Epoch: 4, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.903200 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 1.831871509552002
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.186 Vali Acc: 0.938 Test Loss: 0.186 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.934044361114502
Epoch: 6, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.120 Vali Acc: 0.967 Test Loss: 0.120 Test Acc: 0.967
Validation loss decreased (-0.961698 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 2.046077013015747
Epoch: 7, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.113 Vali Acc: 0.969 Test Loss: 0.113 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 2.021606206893921
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
Validation loss decreased (-0.968662 --> -0.980500).  Saving model ...
Epoch: 9 cost time: 2.1325528621673584
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.917121171951294
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.958 Test Loss: 0.189 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7549059391021729
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.096 Vali Acc: 0.973 Test Loss: 0.096 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6344435214996338
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.020007610321045
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.925550937652588
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8618545532226562
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.970 Test Loss: 0.106 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0319323539733887
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.091 Vali Acc: 0.979 Test Loss: 0.091 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9457471370697021
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 18 cost time: 1.8082034587860107
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0680415630340576
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7833068370819092
Epoch: 20, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.943427324295044
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8458776473999023
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.797959804534912
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.100 Vali Acc: 0.983 Test Loss: 0.100 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 24 cost time: 1.9725325107574463
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9516150951385498
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.969355821609497
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.093 Vali Acc: 0.984 Test Loss: 0.093 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 27 cost time: 2.001986265182495
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.8973631858825684
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.091 Vali Acc: 0.984 Test Loss: 0.091 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 29 cost time: 1.7811965942382812
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.084 Vali Acc: 0.984 Test Loss: 0.084 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 30 cost time: 1.9798848628997803
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8542006015777588
Epoch: 31, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.8784136772155762
Epoch: 32, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9140572547912598
Epoch: 33, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.824150800704956
Epoch: 34, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.853405475616455
Epoch: 35, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9488675594329834
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 37 cost time: 1.6524739265441895
Epoch: 37, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.969 Test Loss: 0.177 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.7288975715637207
Epoch: 38, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.138 Vali Acc: 0.977 Test Loss: 0.138 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.6495063304901123
Epoch: 39, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.061249256134033
Epoch: 40, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.1032326221466064
Epoch: 41, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.985 Test Loss: 0.110 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9089677333831787
Epoch: 42, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.983 Test Loss: 0.085 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.180591106414795
Epoch: 43, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.0109448432922363
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.7649190425872803
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7052748203277588
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.985 Test Loss: 0.084 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 160758
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1986169815063477
Epoch: 1, Steps: 89 | Train Loss: 2.498 Vali Loss: 1.496 Vali Acc: 0.724 Test Loss: 1.496 Test Acc: 0.724
Validation loss decreased (inf --> -0.724219).  Saving model ...
Epoch: 2 cost time: 1.8594646453857422
Epoch: 2, Steps: 89 | Train Loss: 0.787 Vali Loss: 0.426 Vali Acc: 0.876 Test Loss: 0.426 Test Acc: 0.876
Validation loss decreased (-0.724219 --> -0.876040).  Saving model ...
Epoch: 3 cost time: 1.7210211753845215
Epoch: 3, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.265 Vali Acc: 0.925 Test Loss: 0.265 Test Acc: 0.925
Validation loss decreased (-0.876040 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 1.7296466827392578
Epoch: 4, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.161 Vali Acc: 0.955 Test Loss: 0.161 Test Acc: 0.955
Validation loss decreased (-0.924788 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 1.746694803237915
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.259 Vali Acc: 0.928 Test Loss: 0.259 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.104182243347168
Epoch: 6, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.968726634979248
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1178011894226074
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 1.7609367370605469
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.957519 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 1.8078937530517578
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.071 Vali Acc: 0.985 Test Loss: 0.071 Test Acc: 0.985
Validation loss decreased (-0.978411 --> -0.985375).  Saving model ...
Epoch: 11 cost time: 1.7499258518218994
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.659128189086914
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8216710090637207
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0052571296691895
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0161702632904053
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.8620545864105225
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0248847007751465
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.198657274246216
Epoch: 18, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.0419023036956787
Epoch: 19, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8784186840057373
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 159662
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.260950803756714
Epoch: 1, Steps: 89 | Train Loss: 2.392 Vali Loss: 1.432 Vali Acc: 0.659 Test Loss: 1.432 Test Acc: 0.659
Validation loss decreased (inf --> -0.659456).  Saving model ...
Epoch: 2 cost time: 2.1337153911590576
Epoch: 2, Steps: 89 | Train Loss: 0.696 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
Validation loss decreased (-0.659456 --> -0.899718).  Saving model ...
Epoch: 3 cost time: 2.0736734867095947
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.328 Vali Acc: 0.913 Test Loss: 0.328 Test Acc: 0.913
Validation loss decreased (-0.899718 --> -0.912949).  Saving model ...
Epoch: 4 cost time: 1.7344908714294434
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.199 Vali Acc: 0.947 Test Loss: 0.199 Test Acc: 0.947
Validation loss decreased (-0.912949 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 1.9761254787445068
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.162 Vali Acc: 0.967 Test Loss: 0.162 Test Acc: 0.967
Validation loss decreased (-0.947073 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 2.1182327270507812
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9556853771209717
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.160 Vali Acc: 0.958 Test Loss: 0.160 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.771498680114746
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 1.7504611015319824
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8340275287628174
Epoch: 10, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 2.1100268363952637
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 1.9304463863372803
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.605785608291626
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9815897941589355
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6958537101745605
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.188 Vali Acc: 0.950 Test Loss: 0.188 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8638319969177246
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.758434772491455
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5788805484771729
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 2.1243093013763428
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9426231384277344
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9681718349456787
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6581671237945557
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.047821283340454
Epoch: 23, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.9396989345550537
Epoch: 24, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.794646978378296
Epoch: 25, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6996257305145264
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9653937816619873
Epoch: 27, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6823160648345947
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 160104
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3506245613098145
Epoch: 1, Steps: 89 | Train Loss: 2.495 Vali Loss: 1.534 Vali Acc: 0.659 Test Loss: 1.534 Test Acc: 0.659
Validation loss decreased (inf --> -0.659455).  Saving model ...
Epoch: 2 cost time: 1.6347157955169678
Epoch: 2, Steps: 89 | Train Loss: 0.814 Vali Loss: 0.456 Vali Acc: 0.883 Test Loss: 0.456 Test Acc: 0.883
Validation loss decreased (-0.659455 --> -0.883004).  Saving model ...
Epoch: 3 cost time: 1.7224586009979248
Epoch: 3, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
Validation loss decreased (-0.883004 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 1.6489107608795166
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.193 Vali Acc: 0.947 Test Loss: 0.193 Test Acc: 0.947
Validation loss decreased (-0.941502 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 1.7753241062164307
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.947073 --> -0.963787).  Saving model ...
Epoch: 6 cost time: 1.8871793746948242
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 1.9779117107391357
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 1.7162208557128906
Epoch: 8, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 1.682013988494873
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6171915531158447
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 1.510432243347168
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.137 Vali Acc: 0.968 Test Loss: 0.137 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7543761730194092
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 1.618828535079956
Epoch: 13, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6901991367340088
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8397166728973389
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 1.8524444103240967
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8752968311309814
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5811805725097656
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8715016841888428
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 1.9106855392456055
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.960 Test Loss: 0.231 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8930225372314453
Epoch: 21, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.210 Vali Acc: 0.960 Test Loss: 0.210 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.855992317199707
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.016913414001465
Epoch: 23, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7637486457824707
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7084670066833496
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.712937593460083
Epoch: 26, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.935556411743164
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8590304851531982
Epoch: 28, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
Validation loss decreased (-0.982589 --> -0.987464).  Saving model ...
Epoch: 29 cost time: 1.8777332305908203
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8982582092285156
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.975 Test Loss: 0.176 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.8338828086853027
Epoch: 31, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.252 Vali Acc: 0.962 Test Loss: 0.252 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.8088860511779785
Epoch: 32, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.194 Vali Acc: 0.965 Test Loss: 0.194 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.9869353771209717
Epoch: 33, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.139 Vali Acc: 0.981 Test Loss: 0.139 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.1412792205810547
Epoch: 34, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0755653381347656
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.984 Test Loss: 0.138 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.0069282054901123
Epoch: 36, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.109 Vali Acc: 0.985 Test Loss: 0.109 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0269784927368164
Epoch: 37, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8436996936798096
Epoch: 38, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.980 Test Loss: 0.151 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm512_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 159834
model size : 0.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.14941143989563
Epoch: 1, Steps: 89 | Train Loss: 2.505 Vali Loss: 1.731 Vali Acc: 0.661 Test Loss: 1.731 Test Acc: 0.661
Validation loss decreased (inf --> -0.660846).  Saving model ...
Epoch: 2 cost time: 1.9637799263000488
Epoch: 2, Steps: 89 | Train Loss: 1.086 Vali Loss: 0.652 Vali Acc: 0.853 Test Loss: 0.652 Test Acc: 0.853
Validation loss decreased (-0.660846 --> -0.853058).  Saving model ...
Epoch: 3 cost time: 1.7914097309112549
Epoch: 3, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.396 Vali Acc: 0.862 Test Loss: 0.396 Test Acc: 0.862
Validation loss decreased (-0.853058 --> -0.862113).  Saving model ...
Epoch: 4 cost time: 1.7612123489379883
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.217 Vali Acc: 0.943 Test Loss: 0.217 Test Acc: 0.943
Validation loss decreased (-0.862113 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 1.9416520595550537
Epoch: 5, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.942895 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 1.6951072216033936
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
Validation loss decreased (-0.947073 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 1.8731067180633545
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8041882514953613
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9007658958435059
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7458438873291016
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
Validation loss decreased (-0.966572 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 2.116532325744629
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2088327407836914
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8645238876342773
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.688939094543457
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2593889236450195
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.145 Vali Acc: 0.973 Test Loss: 0.145 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.954559326171875
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.978 Test Loss: 0.144 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9947054386138916
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.980 Test Loss: 0.139 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.8498528003692627
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7998454570770264
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.0000808238983154
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.965 Test Loss: 0.199 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 86954
model size : 0.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.1948485374450684
Epoch: 1, Steps: 89 | Train Loss: 2.545 Vali Loss: 1.744 Vali Acc: 0.695 Test Loss: 1.744 Test Acc: 0.695
Validation loss decreased (inf --> -0.694969).  Saving model ...
Epoch: 2 cost time: 1.866206169128418
Epoch: 2, Steps: 89 | Train Loss: 1.068 Vali Loss: 0.617 Vali Acc: 0.860 Test Loss: 0.617 Test Acc: 0.860
Validation loss decreased (-0.694969 --> -0.860022).  Saving model ...
Epoch: 3 cost time: 1.9984757900238037
Epoch: 3, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.349 Vali Acc: 0.903 Test Loss: 0.349 Test Acc: 0.903
Validation loss decreased (-0.860022 --> -0.902503).  Saving model ...
Epoch: 4 cost time: 1.7246301174163818
Epoch: 4, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.902503 --> -0.922003).  Saving model ...
Epoch: 5 cost time: 1.5753238201141357
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.922003 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 1.5881032943725586
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 1.6633358001708984
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 2.0109684467315674
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8519186973571777
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.914586067199707
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.76080322265625
Epoch: 11, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.0558900833129883
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7168264389038086
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 1.7545139789581299
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9040043354034424
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 16 cost time: 1.9336299896240234
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.947923183441162
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7732737064361572
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9149830341339111
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7540185451507568
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6835272312164307
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9704031944274902
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8285841941833496
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.021005630493164
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.980 Test Loss: 0.141 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979804).  Saving model ...
Epoch: 25 cost time: 1.8100612163543701
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.186 Vali Acc: 0.962 Test Loss: 0.186 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5068371295928955
Epoch: 26, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5917668342590332
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0880839824676514
Epoch: 28, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6576097011566162
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6486055850982666
Epoch: 30, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 31 cost time: 1.7119672298431396
Epoch: 31, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.971 Test Loss: 0.184 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3238227367401123
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.151 Vali Acc: 0.978 Test Loss: 0.151 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.276249885559082
Epoch: 33, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.123 Vali Acc: 0.982 Test Loss: 0.123 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 34 cost time: 2.191662549972534
Epoch: 34, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9627618789672852
Epoch: 35, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.531024217605591
Epoch: 36, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.158 Vali Acc: 0.978 Test Loss: 0.158 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.9987850189208984
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.974 Test Loss: 0.195 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.9429035186767578
Epoch: 38, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.154 Vali Acc: 0.980 Test Loss: 0.154 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8816938400268555
Epoch: 39, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.084827423095703
Epoch: 40, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.140 Vali Acc: 0.983 Test Loss: 0.140 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 41 cost time: 1.886188268661499
Epoch: 41, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.971 Test Loss: 0.220 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.8765690326690674
Epoch: 42, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.981 Test Loss: 0.175 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.059860944747925
Epoch: 43, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.22631573677063
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.980 Test Loss: 0.168 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.8538494110107422
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.153 Vali Acc: 0.985 Test Loss: 0.153 Test Acc: 0.985
Validation loss decreased (-0.983286 --> -0.984678).  Saving model ...
Epoch: 46 cost time: 1.9471590518951416
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.984 Test Loss: 0.154 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.046581506729126
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.9643826484680176
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.983 Test Loss: 0.154 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.144632339477539
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.041487455368042
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7719964981079102
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.7182972431182861
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.983 Test Loss: 0.155 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.7731122970581055
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.9906220436096191
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.1088507175445557
Epoch: 55, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.983 Test Loss: 0.156 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 83310
model size : 0.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.337712287902832
Epoch: 1, Steps: 89 | Train Loss: 2.494 Vali Loss: 1.693 Vali Acc: 0.664 Test Loss: 1.693 Test Acc: 0.664
Validation loss decreased (inf --> -0.664328).  Saving model ...
Epoch: 2 cost time: 1.7859256267547607
Epoch: 2, Steps: 89 | Train Loss: 1.004 Vali Loss: 0.626 Vali Acc: 0.811 Test Loss: 0.626 Test Acc: 0.811
Validation loss decreased (-0.664328 --> -0.811275).  Saving model ...
Epoch: 3 cost time: 1.8438191413879395
Epoch: 3, Steps: 89 | Train Loss: 0.428 Vali Loss: 0.323 Vali Acc: 0.903 Test Loss: 0.323 Test Acc: 0.903
Validation loss decreased (-0.811275 --> -0.903200).  Saving model ...
Epoch: 4 cost time: 1.6944410800933838
Epoch: 4, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.903200 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 1.8427879810333252
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
Validation loss decreased (-0.936627 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 1.7309868335723877
Epoch: 6, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.954037 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 1.604369878768921
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.146 Vali Acc: 0.963 Test Loss: 0.146 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 1.6355888843536377
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.130 Vali Acc: 0.966 Test Loss: 0.130 Test Acc: 0.966
Validation loss decreased (-0.963090 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 1.5534098148345947
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 1.8861451148986816
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6008186340332031
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.974 Test Loss: 0.104 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 1.7952213287353516
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.968 Test Loss: 0.110 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8139333724975586
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7090392112731934
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 1.855180025100708
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6956493854522705
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8211779594421387
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.102 Vali Acc: 0.977 Test Loss: 0.102 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 1.8349967002868652
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.925137996673584
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8099210262298584
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.963 Test Loss: 0.142 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7894244194030762
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 2.237977981567383
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.1473755836486816
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6237285137176514
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 25 cost time: 1.9364888668060303
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.970 Test Loss: 0.125 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7478399276733398
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.983 Test Loss: 0.099 Test Acc: 0.983
Validation loss decreased (-0.977715 --> -0.982590).  Saving model ...
Epoch: 27 cost time: 1.7003724575042725
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6291227340698242
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6574063301086426
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7489404678344727
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9383163452148438
Epoch: 31, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.7910726070404053
Epoch: 32, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.146531343460083
Epoch: 33, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.866006851196289
Epoch: 34, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.415 Vali Acc: 0.950 Test Loss: 0.415 Test Acc: 0.950
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9180757999420166
Epoch: 35, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.981 Test Loss: 0.118 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.0878818035125732
Epoch: 36, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 81590
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.973210096359253
Epoch: 1, Steps: 89 | Train Loss: 2.467 Vali Loss: 1.671 Vali Acc: 0.730 Test Loss: 1.671 Test Acc: 0.730
Validation loss decreased (inf --> -0.729788).  Saving model ...
Epoch: 2 cost time: 1.778428554534912
Epoch: 2, Steps: 89 | Train Loss: 1.013 Vali Loss: 0.613 Vali Acc: 0.866 Test Loss: 0.613 Test Acc: 0.866
Validation loss decreased (-0.729788 --> -0.866289).  Saving model ...
Epoch: 3 cost time: 1.8394904136657715
Epoch: 3, Steps: 89 | Train Loss: 0.422 Vali Loss: 0.291 Vali Acc: 0.925 Test Loss: 0.291 Test Acc: 0.925
Validation loss decreased (-0.866289 --> -0.924788).  Saving model ...
Epoch: 4 cost time: 1.7893898487091064
Epoch: 4, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.172 Vali Acc: 0.951 Test Loss: 0.172 Test Acc: 0.951
Validation loss decreased (-0.924788 --> -0.950555).  Saving model ...
Epoch: 5 cost time: 1.9007830619812012
Epoch: 5, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.950555 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 1.7478384971618652
Epoch: 6, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 1.8418803215026855
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.093 Vali Acc: 0.979 Test Loss: 0.093 Test Acc: 0.979
Validation loss decreased (-0.971447 --> -0.979108).  Saving model ...
Epoch: 8 cost time: 1.8016340732574463
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.80305814743042
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 10 cost time: 2.062873601913452
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.846588134765625
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1716039180755615
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7860438823699951
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.880018949508667
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.8554561138153076
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7325479984283447
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9534854888916016
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.965160608291626
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.8666164875030518
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 80642
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.228942632675171
Epoch: 1, Steps: 89 | Train Loss: 2.411 Vali Loss: 1.662 Vali Acc: 0.689 Test Loss: 1.662 Test Acc: 0.689
Validation loss decreased (inf --> -0.689398).  Saving model ...
Epoch: 2 cost time: 1.8370771408081055
Epoch: 2, Steps: 89 | Train Loss: 1.021 Vali Loss: 0.566 Vali Acc: 0.861 Test Loss: 0.566 Test Acc: 0.861
Validation loss decreased (-0.689398 --> -0.860719).  Saving model ...
Epoch: 3 cost time: 1.8911616802215576
Epoch: 3, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
Validation loss decreased (-0.860719 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 2.0081851482391357
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.195 Vali Acc: 0.945 Test Loss: 0.195 Test Acc: 0.945
Validation loss decreased (-0.929663 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 1.9944465160369873
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
Validation loss decreased (-0.944984 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 1.810990810394287
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.132 Vali Acc: 0.962 Test Loss: 0.132 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 1.9839451313018799
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 2.077744722366333
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.969358 --> -0.977019).  Saving model ...
Epoch: 9 cost time: 2.3467535972595215
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 10 cost time: 1.9789440631866455
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.088 Vali Acc: 0.979 Test Loss: 0.088 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 1.8104515075683594
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7927491664886475
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1080338954925537
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8827447891235352
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8930368423461914
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9036126136779785
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8662188053131104
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.041599988937378
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 19 cost time: 1.7413699626922607
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7608058452606201
Epoch: 20, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.135 Vali Acc: 0.977 Test Loss: 0.135 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6018121242523193
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 22 cost time: 1.6929223537445068
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8659961223602295
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8263659477233887
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9242744445800781
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.008979558944702
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7592036724090576
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8394241333007812
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.985 Test Loss: 0.101 Test Acc: 0.985
Validation loss decreased (-0.982589 --> -0.984679).  Saving model ...
Epoch: 29 cost time: 1.879089117050171
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.082425117492676
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.984 Test Loss: 0.100 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1377060413360596
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.986 Test Loss: 0.101 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986071).  Saving model ...
Epoch: 32 cost time: 1.881805419921875
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0535640716552734
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.985 Test Loss: 0.102 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.064476251602173
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7453022003173828
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.973855972290039
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7673380374908447
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.160552978515625
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.985 Test Loss: 0.105 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7144770622253418
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.985 Test Loss: 0.106 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6707186698913574
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.5169079303741455
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.985 Test Loss: 0.107 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 80082
model size : 0.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.108999252319336
Epoch: 1, Steps: 89 | Train Loss: 2.501 Vali Loss: 1.694 Vali Acc: 0.678 Test Loss: 1.694 Test Acc: 0.678
Validation loss decreased (inf --> -0.677560).  Saving model ...
Epoch: 2 cost time: 2.0194146633148193
Epoch: 2, Steps: 89 | Train Loss: 1.003 Vali Loss: 0.567 Vali Acc: 0.864 Test Loss: 0.567 Test Acc: 0.864
Validation loss decreased (-0.677560 --> -0.863504).  Saving model ...
Epoch: 3 cost time: 1.8481807708740234
Epoch: 3, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.211 Vali Acc: 0.951 Test Loss: 0.211 Test Acc: 0.951
Validation loss decreased (-0.863504 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 1.7797365188598633
Epoch: 4, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.950555 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 1.6416304111480713
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.135 Vali Acc: 0.960 Test Loss: 0.135 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.718775749206543
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.963787 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 1.8569269180297852
Epoch: 7, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 8 cost time: 1.9545726776123047
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0055439472198486
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.969 Test Loss: 0.114 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9153013229370117
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.900240182876587
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8677771091461182
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0729217529296875
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 1.8592915534973145
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.954 Test Loss: 0.186 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8749618530273438
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7174062728881836
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.082 Vali Acc: 0.982 Test Loss: 0.082 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 2.0660765171051025
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.961 Test Loss: 0.160 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9989924430847168
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.103 Vali Acc: 0.979 Test Loss: 0.103 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9292242527008057
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.981893 --> -0.983982).  Saving model ...
Epoch: 20 cost time: 1.9776902198791504
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1157450675964355
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9647817611694336
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.725057601928711
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8332610130310059
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7312018871307373
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.179 Vali Acc: 0.965 Test Loss: 0.179 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.896972417831421
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.098 Vali Acc: 0.984 Test Loss: 0.098 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9275240898132324
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6799516677856445
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6706945896148682
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.983983286908078
model parameter : 78744
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.087543487548828
Epoch: 1, Steps: 89 | Train Loss: 2.473 Vali Loss: 1.642 Vali Acc: 0.689 Test Loss: 1.642 Test Acc: 0.689
Validation loss decreased (inf --> -0.689399).  Saving model ...
Epoch: 2 cost time: 1.9418323040008545
Epoch: 2, Steps: 89 | Train Loss: 0.971 Vali Loss: 0.628 Vali Acc: 0.817 Test Loss: 0.628 Test Acc: 0.817
Validation loss decreased (-0.689399 --> -0.816846).  Saving model ...
Epoch: 3 cost time: 2.034950017929077
Epoch: 3, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.388 Vali Acc: 0.891 Test Loss: 0.388 Test Acc: 0.891
Validation loss decreased (-0.816846 --> -0.890665).  Saving model ...
Epoch: 4 cost time: 1.9587223529815674
Epoch: 4, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.217 Vali Acc: 0.945 Test Loss: 0.217 Test Acc: 0.945
Validation loss decreased (-0.890665 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 1.7834854125976562
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.944984 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 1.8981554508209229
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6393229961395264
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 8 cost time: 1.6651196479797363
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 1.6205427646636963
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.102 Vali Acc: 0.971 Test Loss: 0.102 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5940463542938232
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 1.5952930450439453
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0108935832977295
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8246383666992188
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.098 Vali Acc: 0.974 Test Loss: 0.098 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9098474979400635
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.651890516281128
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.976 Test Loss: 0.091 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 1.610335111618042
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5598845481872559
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9416818618774414
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 19 cost time: 1.8318350315093994
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.942432165145874
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6786081790924072
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.772839069366455
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.10980224609375
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7940821647644043
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.966 Test Loss: 0.160 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6990952491760254
Epoch: 25, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5930652618408203
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.292283058166504
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.962965726852417
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 29 cost time: 1.5274462699890137
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 30 cost time: 2.15946888923645
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 31 cost time: 1.7947485446929932
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 32 cost time: 1.7350168228149414
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 33 cost time: 1.7413737773895264
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8386847972869873
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 35 cost time: 1.7569003105163574
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.985 Test Loss: 0.097 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 36 cost time: 1.6675183773040771
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.806447982788086
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.8040666580200195
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.098 Vali Acc: 0.985 Test Loss: 0.098 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8132121562957764
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7884762287139893
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.984 Test Loss: 0.099 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6551611423492432
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.985 Test Loss: 0.099 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.7361395359039307
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.985 Test Loss: 0.100 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5263893604278564
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.987 Test Loss: 0.100 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 44 cost time: 1.9766581058502197
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.987 Test Loss: 0.101 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7057573795318604
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.987 Test Loss: 0.101 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.7769527435302734
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.007408380508423
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.986 Test Loss: 0.102 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.838216781616211
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.0846807956695557
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.986 Test Loss: 0.103 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.0358426570892334
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.987 Test Loss: 0.103 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.920123815536499
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.000303268432617
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.986 Test Loss: 0.104 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.9543795585632324
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.986 Test Loss: 0.105 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 78758
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.8692708015441895
Epoch: 1, Steps: 89 | Train Loss: 2.469 Vali Loss: 1.620 Vali Acc: 0.699 Test Loss: 1.620 Test Acc: 0.699
Validation loss decreased (inf --> -0.699148).  Saving model ...
Epoch: 2 cost time: 1.9697234630584717
Epoch: 2, Steps: 89 | Train Loss: 0.979 Vali Loss: 0.609 Vali Acc: 0.837 Test Loss: 0.609 Test Acc: 0.837
Validation loss decreased (-0.699148 --> -0.837041).  Saving model ...
Epoch: 3 cost time: 1.7828319072723389
Epoch: 3, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.837041 --> -0.910860).  Saving model ...
Epoch: 4 cost time: 1.8820617198944092
Epoch: 4, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.910860 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 1.9862446784973145
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
Validation loss decreased (-0.943591 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 1.8136672973632812
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9784152507781982
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.179 Vali Acc: 0.957 Test Loss: 0.179 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7754642963409424
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 1.7285139560699463
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9789316654205322
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975625).  Saving model ...
Epoch: 11 cost time: 1.9010274410247803
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6847915649414062
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.947 Test Loss: 0.226 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0038766860961914
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.142 Vali Acc: 0.972 Test Loss: 0.142 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7626335620880127
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977715).  Saving model ...
Epoch: 15 cost time: 1.5951991081237793
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 1.7370834350585938
Epoch: 16, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9559674263000488
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7648155689239502
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7356255054473877
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7672057151794434
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7072277069091797
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.159 Vali Acc: 0.971 Test Loss: 0.159 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8547022342681885
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8769152164459229
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.7965621948242188
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.8261828422546387
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.979 Test Loss: 0.137 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 79450
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0242035388946533
Epoch: 1, Steps: 89 | Train Loss: 2.498 Vali Loss: 1.675 Vali Acc: 0.695 Test Loss: 1.675 Test Acc: 0.695
Validation loss decreased (inf --> -0.694969).  Saving model ...
Epoch: 2 cost time: 1.7862441539764404
Epoch: 2, Steps: 89 | Train Loss: 0.967 Vali Loss: 0.505 Vali Acc: 0.861 Test Loss: 0.505 Test Acc: 0.861
Validation loss decreased (-0.694969 --> -0.860719).  Saving model ...
Epoch: 3 cost time: 1.8474147319793701
Epoch: 3, Steps: 89 | Train Loss: 0.374 Vali Loss: 0.301 Vali Acc: 0.918 Test Loss: 0.301 Test Acc: 0.918
Validation loss decreased (-0.860719 --> -0.917824).  Saving model ...
Epoch: 4 cost time: 1.726381778717041
Epoch: 4, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.917824 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 1.9194750785827637
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6224579811096191
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.138 Vali Acc: 0.962 Test Loss: 0.138 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 1.836838960647583
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 1.737311601638794
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.102 Vali Acc: 0.975 Test Loss: 0.102 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 1.8015868663787842
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.739142656326294
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7322227954864502
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 12 cost time: 2.146669626235962
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8831512928009033
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 1.687293529510498
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.12310528755188
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.778996229171753
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9067230224609375
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7421038150787354
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.212336301803589
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8902735710144043
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8340249061584473
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5624802112579346
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5977740287780762
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 79418
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.0104734897613525
Epoch: 1, Steps: 89 | Train Loss: 2.457 Vali Loss: 1.659 Vali Acc: 0.725 Test Loss: 1.659 Test Acc: 0.725
Validation loss decreased (inf --> -0.724914).  Saving model ...
Epoch: 2 cost time: 1.661794662475586
Epoch: 2, Steps: 89 | Train Loss: 0.966 Vali Loss: 0.506 Vali Acc: 0.875 Test Loss: 0.506 Test Acc: 0.875
Validation loss decreased (-0.724914 --> -0.874647).  Saving model ...
Epoch: 3 cost time: 1.6756043434143066
Epoch: 3, Steps: 89 | Train Loss: 0.322 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.874647 --> -0.940805).  Saving model ...
Epoch: 4 cost time: 1.7059619426727295
Epoch: 4, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.185 Vali Acc: 0.954 Test Loss: 0.185 Test Acc: 0.954
Validation loss decreased (-0.940805 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 1.8785982131958008
Epoch: 5, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.145 Vali Acc: 0.966 Test Loss: 0.145 Test Acc: 0.966
Validation loss decreased (-0.954037 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 1.8116090297698975
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7941956520080566
Epoch: 7, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.098 Vali Acc: 0.973 Test Loss: 0.098 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 1.7714059352874756
Epoch: 8, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 9 cost time: 1.904421091079712
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.889538049697876
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8138647079467773
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.087 Vali Acc: 0.979 Test Loss: 0.087 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 12 cost time: 1.5814189910888672
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.103 Vali Acc: 0.969 Test Loss: 0.103 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6396191120147705
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.961 Test Loss: 0.145 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7326900959014893
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8749229907989502
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9265978336334229
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 1.7748239040374756
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7357730865478516
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7593586444854736
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 1.9906179904937744
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9090609550476074
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 22 cost time: 1.808910846710205
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.183 Vali Acc: 0.965 Test Loss: 0.183 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8187799453735352
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9209301471710205
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.955 Test Loss: 0.208 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.65283203125
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8504056930541992
Epoch: 26, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9262645244598389
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9400484561920166
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.987 Test Loss: 0.074 Test Acc: 0.987
Validation loss decreased (-0.981197 --> -0.987464).  Saving model ...
Epoch: 29 cost time: 1.7571403980255127
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.829345703125
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.074 Vali Acc: 0.986 Test Loss: 0.074 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.766347885131836
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.714627742767334
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.8339447975158691
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.985 Test Loss: 0.078 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7526633739471436
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7620458602905273
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.985 Test Loss: 0.080 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.8355095386505127
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.684514045715332
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.6442384719848633
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 78662
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9157612323760986
Epoch: 1, Steps: 89 | Train Loss: 2.547 Vali Loss: 1.742 Vali Acc: 0.669 Test Loss: 1.742 Test Acc: 0.669
Validation loss decreased (inf --> -0.669203).  Saving model ...
Epoch: 2 cost time: 1.6963191032409668
Epoch: 2, Steps: 89 | Train Loss: 1.043 Vali Loss: 0.597 Vali Acc: 0.858 Test Loss: 0.597 Test Acc: 0.858
Validation loss decreased (-0.669203 --> -0.857933).  Saving model ...
Epoch: 3 cost time: 1.7753410339355469
Epoch: 3, Steps: 89 | Train Loss: 0.404 Vali Loss: 0.321 Vali Acc: 0.923 Test Loss: 0.321 Test Acc: 0.923
Validation loss decreased (-0.857933 --> -0.923395).  Saving model ...
Epoch: 4 cost time: 2.093691110610962
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.222 Vali Acc: 0.946 Test Loss: 0.222 Test Acc: 0.946
Validation loss decreased (-0.923395 --> -0.946377).  Saving model ...
Epoch: 5 cost time: 1.7184174060821533
Epoch: 5, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.946377 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 1.7811408042907715
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
Validation loss decreased (-0.959608 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 1.9208965301513672
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 1.8836877346038818
Epoch: 8, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7579634189605713
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 1.7524521350860596
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.957491397857666
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6379821300506592
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6725850105285645
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.964 Test Loss: 0.201 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7609081268310547
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979107).  Saving model ...
Epoch: 15 cost time: 1.756751298904419
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.78128981590271
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 1.8528363704681396
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 1.6713793277740479
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.976 Test Loss: 0.135 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6324405670166016
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.979567527770996
Epoch: 20, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8272812366485596
Epoch: 21, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.960 Test Loss: 0.240 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.813424825668335
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.155 Vali Acc: 0.974 Test Loss: 0.155 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8473615646362305
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.979 Test Loss: 0.142 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.69559907913208
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.135 Vali Acc: 0.979 Test Loss: 0.135 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7129147052764893
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
Validation loss decreased (-0.980500 --> -0.985375).  Saving model ...
Epoch: 26 cost time: 1.6377501487731934
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0687756538391113
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.985 Test Loss: 0.128 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.193510055541992
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.985 Test Loss: 0.129 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7520244121551514
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.985 Test Loss: 0.132 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0692460536956787
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.133 Vali Acc: 0.986 Test Loss: 0.133 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986071).  Saving model ...
Epoch: 31 cost time: 2.0155391693115234
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9054112434387207
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.986 Test Loss: 0.135 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.8380100727081299
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.136 Vali Acc: 0.986 Test Loss: 0.136 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.9380276203155518
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.138 Vali Acc: 0.986 Test Loss: 0.138 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.148482084274292
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.141 Vali Acc: 0.986 Test Loss: 0.141 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.256711006164551
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.140 Vali Acc: 0.987 Test Loss: 0.140 Test Acc: 0.987
Validation loss decreased (-0.986071 --> -0.986767).  Saving model ...
Epoch: 37 cost time: 2.0512773990631104
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.986 Test Loss: 0.144 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.0837247371673584
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.144 Vali Acc: 0.987 Test Loss: 0.144 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.373448371887207
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.145 Vali Acc: 0.987 Test Loss: 0.145 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.9873197078704834
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.986 Test Loss: 0.147 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.0146899223327637
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.147 Vali Acc: 0.987 Test Loss: 0.147 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.2174570560455322
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.148 Vali Acc: 0.987 Test Loss: 0.148 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.6789798736572266
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.149 Vali Acc: 0.987 Test Loss: 0.149 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.149061441421509
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.151 Vali Acc: 0.987 Test Loss: 0.151 Test Acc: 0.987
Validation loss decreased (-0.986767 --> -0.987464).  Saving model ...
Epoch: 45 cost time: 2.0568907260894775
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.152 Vali Acc: 0.987 Test Loss: 0.152 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.678746223449707
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.154 Vali Acc: 0.986 Test Loss: 0.154 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.07289719581604
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.156 Vali Acc: 0.987 Test Loss: 0.156 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.2109382152557373
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.155 Vali Acc: 0.987 Test Loss: 0.155 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.4314115047454834
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.157 Vali Acc: 0.986 Test Loss: 0.157 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.1606085300445557
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.158 Vali Acc: 0.986 Test Loss: 0.158 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.110262155532837
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.986 Test Loss: 0.159 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.483973979949951
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.986 Test Loss: 0.161 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.9859819412231445
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.986 Test Loss: 0.161 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.203986644744873
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.162 Vali Acc: 0.986 Test Loss: 0.162 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 79494
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.22904896736145
Epoch: 1, Steps: 89 | Train Loss: 2.461 Vali Loss: 1.657 Vali Acc: 0.651 Test Loss: 1.657 Test Acc: 0.651
Validation loss decreased (inf --> -0.651098).  Saving model ...
Epoch: 2 cost time: 1.8246948719024658
Epoch: 2, Steps: 89 | Train Loss: 0.962 Vali Loss: 0.540 Vali Acc: 0.850 Test Loss: 0.540 Test Acc: 0.850
Validation loss decreased (-0.651098 --> -0.849577).  Saving model ...
Epoch: 3 cost time: 2.2186636924743652
Epoch: 3, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
Validation loss decreased (-0.849577 --> -0.915038).  Saving model ...
Epoch: 4 cost time: 1.7561988830566406
Epoch: 4, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
Validation loss decreased (-0.915038 --> -0.938717).  Saving model ...
Epoch: 5 cost time: 1.9650073051452637
Epoch: 5, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.938717 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 1.7398240566253662
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 1.6040654182434082
Epoch: 7, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.726020097732544
Epoch: 8, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.114 Vali Acc: 0.972 Test Loss: 0.114 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 1.870600700378418
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.972144 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 1.8195455074310303
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 1.7772083282470703
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9774081707000732
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.81276535987854
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7685961723327637
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8984243869781494
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 1.9908931255340576
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8445026874542236
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8051133155822754
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.955 Test Loss: 0.223 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.886469841003418
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.955 Test Loss: 0.225 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.742274284362793
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 21 cost time: 1.6562261581420898
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.987 Test Loss: 0.099 Test Acc: 0.987
Validation loss decreased (-0.982590 --> -0.986768).  Saving model ...
Epoch: 22 cost time: 1.770752191543579
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.985 Test Loss: 0.103 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.755875825881958
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.091 Vali Acc: 0.987 Test Loss: 0.091 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 24 cost time: 1.6421570777893066
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
Validation loss decreased (-0.987464 --> -0.987464).  Saving model ...
Epoch: 25 cost time: 1.8973557949066162
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7717623710632324
Epoch: 26, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7522449493408203
Epoch: 27, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8054068088531494
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8976800441741943
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.140 Vali Acc: 0.980 Test Loss: 0.140 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.174017906188965
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.136 Vali Acc: 0.985 Test Loss: 0.136 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8583827018737793
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.130 Vali Acc: 0.982 Test Loss: 0.130 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.000941276550293
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.984 Test Loss: 0.125 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.159961700439453
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.061187744140625
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.984 Test Loss: 0.127 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9874651810584958
model parameter : 77472
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.004347085952759
Epoch: 1, Steps: 89 | Train Loss: 2.478 Vali Loss: 1.679 Vali Acc: 0.718 Test Loss: 1.679 Test Acc: 0.718
Validation loss decreased (inf --> -0.717950).  Saving model ...
Epoch: 2 cost time: 1.6701607704162598
Epoch: 2, Steps: 89 | Train Loss: 0.958 Vali Loss: 0.557 Vali Acc: 0.852 Test Loss: 0.557 Test Acc: 0.852
Validation loss decreased (-0.717950 --> -0.851666).  Saving model ...
Epoch: 3 cost time: 1.645472526550293
Epoch: 3, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.324 Vali Acc: 0.905 Test Loss: 0.324 Test Acc: 0.905
Validation loss decreased (-0.851666 --> -0.905289).  Saving model ...
Epoch: 4 cost time: 1.813478946685791
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.180 Vali Acc: 0.953 Test Loss: 0.180 Test Acc: 0.953
Validation loss decreased (-0.905289 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 1.6876487731933594
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.147 Vali Acc: 0.966 Test Loss: 0.147 Test Acc: 0.966
Validation loss decreased (-0.952644 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 1.4863803386688232
Epoch: 6, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7177488803863525
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.965876 --> -0.977018).  Saving model ...
Epoch: 8 cost time: 1.5109503269195557
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6865496635437012
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9368479251861572
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7816264629364014
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5774633884429932
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7870135307312012
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6759705543518066
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 1.6430554389953613
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6000089645385742
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 1.569326639175415
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8435688018798828
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.188 Vali Acc: 0.966 Test Loss: 0.188 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7469792366027832
Epoch: 19, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7293968200683594
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5299057960510254
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6348254680633545
Epoch: 22, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.5649094581604004
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.967 Test Loss: 0.172 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.902658462524414
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.188258647918701
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.182 Vali Acc: 0.966 Test Loss: 0.182 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.169461965560913
Epoch: 26, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 77402
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.695539951324463
Epoch: 1, Steps: 89 | Train Loss: 2.584 Vali Loss: 1.787 Vali Acc: 0.663 Test Loss: 1.787 Test Acc: 0.663
Validation loss decreased (inf --> -0.662935).  Saving model ...
Epoch: 2 cost time: 2.2685189247131348
Epoch: 2, Steps: 89 | Train Loss: 1.104 Vali Loss: 0.626 Vali Acc: 0.847 Test Loss: 0.626 Test Acc: 0.847
Validation loss decreased (-0.662935 --> -0.847487).  Saving model ...
Epoch: 3 cost time: 2.190565824508667
Epoch: 3, Steps: 89 | Train Loss: 0.387 Vali Loss: 0.329 Vali Acc: 0.903 Test Loss: 0.329 Test Acc: 0.903
Validation loss decreased (-0.847487 --> -0.903200).  Saving model ...
Epoch: 4 cost time: 2.632188320159912
Epoch: 4, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.216 Vali Acc: 0.943 Test Loss: 0.216 Test Acc: 0.943
Validation loss decreased (-0.903200 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 2.0751266479492188
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
Validation loss decreased (-0.942895 --> -0.954734).  Saving model ...
Epoch: 6 cost time: 2.295764923095703
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.157 Vali Acc: 0.959 Test Loss: 0.157 Test Acc: 0.959
Validation loss decreased (-0.954734 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 2.209343910217285
Epoch: 7, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.958912 --> -0.970054).  Saving model ...
Epoch: 8 cost time: 2.329244375228882
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.152 Vali Acc: 0.965 Test Loss: 0.152 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3405070304870605
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2818121910095215
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4098689556121826
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.958 Test Loss: 0.198 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.136120557785034
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.970054 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 1.9976296424865723
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 14 cost time: 2.018815517425537
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.281369686126709
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1981148719787598
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 2.299377679824829
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.175 Vali Acc: 0.963 Test Loss: 0.175 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5008888244628906
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.502856969833374
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.598583221435547
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 21 cost time: 2.6404781341552734
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.7464911937713623
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.499497890472412
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.448737144470215
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.984 Test Loss: 0.108 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 25 cost time: 2.6594948768615723
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9639129638671875
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.7170021533966064
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.961 Test Loss: 0.199 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.1462206840515137
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.0977444648742676
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.583479642868042
Epoch: 30, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.170 Vali Acc: 0.965 Test Loss: 0.170 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.589670419692993
Epoch: 31, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.9048047065734863
Epoch: 32, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.097 Vali Acc: 0.983 Test Loss: 0.097 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.4811887741088867
Epoch: 33, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.9681055545806885
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.087 Vali Acc: 0.984 Test Loss: 0.087 Test Acc: 0.984
Validation loss decreased (-0.983982 --> -0.983982).  Saving model ...
Epoch: 35 cost time: 2.9736437797546387
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.087 Vali Acc: 0.985 Test Loss: 0.087 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 36 cost time: 2.474123477935791
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.8571155071258545
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.114908456802368
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.985 Test Loss: 0.088 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.8750500679016113
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.778324604034424
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.8178303241729736
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 2.7173919677734375
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.985 Test Loss: 0.089 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.7274649143218994
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
Validation loss decreased (-0.984679 --> -0.985375).  Saving model ...
Epoch: 44 cost time: 2.8996920585632324
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.985 Test Loss: 0.090 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.5872507095336914
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 46 cost time: 2.5798511505126953
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.091 Vali Acc: 0.986 Test Loss: 0.091 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.7612626552581787
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.83247447013855
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.5097031593322754
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.986 Test Loss: 0.092 Test Acc: 0.986
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.561868906021118
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.3382887840270996
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 3.0408449172973633
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.986 Test Loss: 0.093 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.405674934387207
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.986 Test Loss: 0.094 Test Acc: 0.986
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 3.4821484088897705
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.986 Test Loss: 0.094 Test Acc: 0.986
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 2.738358736038208
Epoch: 55, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.986 Test Loss: 0.095 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 79222
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.987657308578491
Epoch: 1, Steps: 89 | Train Loss: 2.527 Vali Loss: 1.709 Vali Acc: 0.754 Test Loss: 1.709 Test Acc: 0.754
Validation loss decreased (inf --> -0.754161).  Saving model ...
Epoch: 2 cost time: 2.8323748111724854
Epoch: 2, Steps: 89 | Train Loss: 0.933 Vali Loss: 0.463 Vali Acc: 0.866 Test Loss: 0.463 Test Acc: 0.866
Validation loss decreased (-0.754161 --> -0.865594).  Saving model ...
Epoch: 3 cost time: 2.2733659744262695
Epoch: 3, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.255 Vali Acc: 0.939 Test Loss: 0.255 Test Acc: 0.939
Validation loss decreased (-0.865594 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 2.5140857696533203
Epoch: 4, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5549027919769287
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
Validation loss decreased (-0.938716 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 2.393080949783325
Epoch: 6, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
Validation loss decreased (-0.961698 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.344252586364746
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9137797355651855
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.488525629043579
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.149 Vali Acc: 0.967 Test Loss: 0.149 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.42830228805542
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975625).  Saving model ...
Epoch: 11 cost time: 2.5441389083862305
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.188936948776245
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.972 Test Loss: 0.143 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4271605014801025
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.161 Vali Acc: 0.965 Test Loss: 0.161 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5308263301849365
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2126622200012207
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.100 Vali Acc: 0.982 Test Loss: 0.100 Test Acc: 0.982
Validation loss decreased (-0.975625 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 2.577529191970825
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.174 Vali Acc: 0.965 Test Loss: 0.174 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2121520042419434
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.975 Test Loss: 0.163 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.133668899536133
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.236314535140991
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.31494140625
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.125 Vali Acc: 0.980 Test Loss: 0.125 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.3105733394622803
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8057687282562256
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.3068974018096924
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5047032833099365
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.981 Test Loss: 0.124 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.9329817295074463
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.974 Test Loss: 0.201 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 78254
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.366162061691284
Epoch: 1, Steps: 89 | Train Loss: 2.450 Vali Loss: 1.640 Vali Acc: 0.691 Test Loss: 1.640 Test Acc: 0.691
Validation loss decreased (inf --> -0.690791).  Saving model ...
Epoch: 2 cost time: 2.457345485687256
Epoch: 2, Steps: 89 | Train Loss: 0.971 Vali Loss: 0.564 Vali Acc: 0.848 Test Loss: 0.564 Test Acc: 0.848
Validation loss decreased (-0.690791 --> -0.848184).  Saving model ...
Epoch: 3 cost time: 2.3154842853546143
Epoch: 3, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.333 Vali Acc: 0.902 Test Loss: 0.333 Test Acc: 0.902
Validation loss decreased (-0.848184 --> -0.901807).  Saving model ...
Epoch: 4 cost time: 2.5547282695770264
Epoch: 4, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.227 Vali Acc: 0.938 Test Loss: 0.227 Test Acc: 0.938
Validation loss decreased (-0.901807 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 2.3204469680786133
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
Validation loss decreased (-0.938020 --> -0.953341).  Saving model ...
Epoch: 6 cost time: 2.3632922172546387
Epoch: 6, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.154 Vali Acc: 0.962 Test Loss: 0.154 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 2.8135428428649902
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9058501720428467
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.961698 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 2.654999256134033
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.854179620742798
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 11 cost time: 2.8108484745025635
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1510143280029297
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7495923042297363
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.982 Test Loss: 0.101 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 14 cost time: 2.5615358352661133
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.616866111755371
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.929428815841675
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4881908893585205
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.297877550125122
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7816548347473145
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.636129379272461
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.636868476867676
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7058944702148438
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.44913911819458
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 78824
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.461270809173584
Epoch: 1, Steps: 89 | Train Loss: 2.454 Vali Loss: 1.620 Vali Acc: 0.717 Test Loss: 1.620 Test Acc: 0.717
Validation loss decreased (inf --> -0.716558).  Saving model ...
Epoch: 2 cost time: 2.459580659866333
Epoch: 2, Steps: 89 | Train Loss: 0.933 Vali Loss: 0.533 Vali Acc: 0.843 Test Loss: 0.533 Test Acc: 0.843
Validation loss decreased (-0.716558 --> -0.843309).  Saving model ...
Epoch: 3 cost time: 2.7548840045928955
Epoch: 3, Steps: 89 | Train Loss: 0.392 Vali Loss: 0.362 Vali Acc: 0.896 Test Loss: 0.362 Test Acc: 0.896
Validation loss decreased (-0.843309 --> -0.896236).  Saving model ...
Epoch: 4 cost time: 2.7990336418151855
Epoch: 4, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.896236 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 2.4948291778564453
Epoch: 5, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
Validation loss decreased (-0.943591 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 3.0683987140655518
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.189 Vali Acc: 0.957 Test Loss: 0.189 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.017592668533325
Epoch: 7, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 2.385181427001953
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 2.357283115386963
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 2.6231822967529297
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5130772590637207
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.74505877494812
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
Validation loss decreased (-0.973536 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 2.7633814811706543
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.1092581748962402
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.086071491241455
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.316235065460205
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.200695276260376
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.139 Vali Acc: 0.979 Test Loss: 0.139 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.535548210144043
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3777079582214355
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.108 Vali Acc: 0.985 Test Loss: 0.108 Test Acc: 0.985
Validation loss decreased (-0.979108 --> -0.984679).  Saving model ...
Epoch: 20 cost time: 2.320150136947632
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.321413278579712
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.931419610977173
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.754755735397339
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.118 Vali Acc: 0.984 Test Loss: 0.118 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.558093309402466
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.152 Vali Acc: 0.979 Test Loss: 0.152 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.8091468811035156
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.978 Test Loss: 0.141 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4861948490142822
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.9517500400543213
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.982 Test Loss: 0.129 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.782221555709839
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.382681131362915
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.129 Vali Acc: 0.983 Test Loss: 0.129 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm256_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 78682
model size : 0.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.941911220550537
Epoch: 1, Steps: 89 | Train Loss: 2.499 Vali Loss: 1.739 Vali Acc: 0.641 Test Loss: 1.739 Test Acc: 0.641
Validation loss decreased (inf --> -0.641348).  Saving model ...
Epoch: 2 cost time: 2.863873243331909
Epoch: 2, Steps: 89 | Train Loss: 1.128 Vali Loss: 0.743 Vali Acc: 0.808 Test Loss: 0.743 Test Acc: 0.808
Validation loss decreased (-0.641348 --> -0.808488).  Saving model ...
Epoch: 3 cost time: 2.6481151580810547
Epoch: 3, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.440 Vali Acc: 0.902 Test Loss: 0.440 Test Acc: 0.902
Validation loss decreased (-0.808488 --> -0.901806).  Saving model ...
Epoch: 4 cost time: 2.960771322250366
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.901806 --> -0.922002).  Saving model ...
Epoch: 5 cost time: 2.851874828338623
Epoch: 5, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.221 Vali Acc: 0.958 Test Loss: 0.221 Test Acc: 0.958
Validation loss decreased (-0.922002 --> -0.957519).  Saving model ...
Epoch: 6 cost time: 2.67789363861084
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.193 Vali Acc: 0.953 Test Loss: 0.193 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.343599319458008
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6213903427124023
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.957519 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 3.2178707122802734
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 2.919745683670044
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.576859712600708
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3556246757507324
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.975626 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 2.7955071926116943
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7138853073120117
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.980649948120117
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.533982276916504
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.6556665897369385
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0377109050750732
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.141197919845581
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.208693742752075
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.992033004760742
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.50520920753479
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 59562
model size : 0.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7154335975646973
Epoch: 1, Steps: 89 | Train Loss: 2.457 Vali Loss: 1.660 Vali Acc: 0.732 Test Loss: 1.660 Test Acc: 0.732
Validation loss decreased (inf --> -0.731878).  Saving model ...
Epoch: 2 cost time: 2.914625406265259
Epoch: 2, Steps: 89 | Train Loss: 0.978 Vali Loss: 0.524 Vali Acc: 0.884 Test Loss: 0.524 Test Acc: 0.884
Validation loss decreased (-0.731878 --> -0.884396).  Saving model ...
Epoch: 3 cost time: 3.1870625019073486
Epoch: 3, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.260 Vali Acc: 0.938 Test Loss: 0.260 Test Acc: 0.938
Validation loss decreased (-0.884396 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 3.035738468170166
Epoch: 4, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.938020 --> -0.948466).  Saving model ...
Epoch: 5 cost time: 2.667510986328125
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.152 Vali Acc: 0.963 Test Loss: 0.152 Test Acc: 0.963
Validation loss decreased (-0.948466 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 2.945127010345459
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.514763832092285
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.133 Vali Acc: 0.960 Test Loss: 0.133 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8230953216552734
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 2.864628553390503
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4107890129089355
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9822652339935303
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2503762245178223
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 2.3843250274658203
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.22157621383667
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.577568531036377
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5799381732940674
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 2.5615665912628174
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6120686531066895
Epoch: 18, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2853519916534424
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.149 Vali Acc: 0.970 Test Loss: 0.149 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7684478759765625
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.154 Vali Acc: 0.973 Test Loss: 0.154 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5291595458984375
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.432326555252075
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9695115089416504
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7222418785095215
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3981847763061523
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.7691829204559326
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 57838
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9876160621643066
Epoch: 1, Steps: 89 | Train Loss: 2.444 Vali Loss: 1.686 Vali Acc: 0.685 Test Loss: 1.686 Test Acc: 0.685
Validation loss decreased (inf --> -0.684524).  Saving model ...
Epoch: 2 cost time: 2.288496255874634
Epoch: 2, Steps: 89 | Train Loss: 1.094 Vali Loss: 0.707 Vali Acc: 0.847 Test Loss: 0.707 Test Acc: 0.847
Validation loss decreased (-0.684524 --> -0.847486).  Saving model ...
Epoch: 3 cost time: 2.5702781677246094
Epoch: 3, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.437 Vali Acc: 0.879 Test Loss: 0.437 Test Acc: 0.879
Validation loss decreased (-0.847486 --> -0.878826).  Saving model ...
Epoch: 4 cost time: 2.6841492652893066
Epoch: 4, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.270 Vali Acc: 0.935 Test Loss: 0.270 Test Acc: 0.935
Validation loss decreased (-0.878826 --> -0.935234).  Saving model ...
Epoch: 5 cost time: 2.3598785400390625
Epoch: 5, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.221 Vali Acc: 0.939 Test Loss: 0.221 Test Acc: 0.939
Validation loss decreased (-0.935234 --> -0.939413).  Saving model ...
Epoch: 6 cost time: 2.9799516201019287
Epoch: 6, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
Validation loss decreased (-0.939413 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 2.398777484893799
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 2.463681697845459
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.5887904167175293
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5849688053131104
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 2.3195183277130127
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7310032844543457
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 2.8565855026245117
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3270277976989746
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 2.7915947437286377
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 2.831162691116333
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.762465476989746
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.132 Vali Acc: 0.977 Test Loss: 0.132 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.637159585952759
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.5509274005889893
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5929081439971924
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.320162534713745
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4102420806884766
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 23 cost time: 2.476938009262085
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982589).  Saving model ...
Epoch: 24 cost time: 2.633286476135254
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4951565265655518
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.490648031234741
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.5998613834381104
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.6455907821655273
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.2901437282562256
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.0233511924743652
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.979 Test Loss: 0.122 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.9421136379241943
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.3127148151397705
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.979 Test Loss: 0.127 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.8860206604003906
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 57078
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.113344192504883
Epoch: 1, Steps: 89 | Train Loss: 2.444 Vali Loss: 1.662 Vali Acc: 0.731 Test Loss: 1.662 Test Acc: 0.731
Validation loss decreased (inf --> -0.731181).  Saving model ...
Epoch: 2 cost time: 2.1884706020355225
Epoch: 2, Steps: 89 | Train Loss: 1.047 Vali Loss: 0.675 Vali Acc: 0.861 Test Loss: 0.675 Test Acc: 0.861
Validation loss decreased (-0.731181 --> -0.861414).  Saving model ...
Epoch: 3 cost time: 2.3214359283447266
Epoch: 3, Steps: 89 | Train Loss: 0.486 Vali Loss: 0.400 Vali Acc: 0.903 Test Loss: 0.400 Test Acc: 0.903
Validation loss decreased (-0.861414 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 2.284970760345459
Epoch: 4, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.254 Vali Acc: 0.942 Test Loss: 0.254 Test Acc: 0.942
Validation loss decreased (-0.903199 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 2.382256031036377
Epoch: 5, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.192 Vali Acc: 0.957 Test Loss: 0.192 Test Acc: 0.957
Validation loss decreased (-0.941502 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 2.3039848804473877
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3781049251556396
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 2.294489622116089
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.458972454071045
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.111 Vali Acc: 0.972 Test Loss: 0.111 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 2.5964372158050537
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.583174228668213
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.419740915298462
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.175874948501587
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3846144676208496
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6839191913604736
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6467318534851074
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.563946008682251
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.142 Vali Acc: 0.973 Test Loss: 0.142 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.551344394683838
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979107).  Saving model ...
Epoch: 19 cost time: 2.603827714920044
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5032618045806885
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.323838710784912
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.4239001274108887
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3709654808044434
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.2149291038513184
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5327250957489014
Epoch: 25, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.3947041034698486
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.184 Vali Acc: 0.964 Test Loss: 0.184 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7847254276275635
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.606853485107422
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 56706
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9012339115142822
Epoch: 1, Steps: 89 | Train Loss: 2.487 Vali Loss: 1.714 Vali Acc: 0.719 Test Loss: 1.714 Test Acc: 0.719
Validation loss decreased (inf --> -0.719342).  Saving model ...
Epoch: 2 cost time: 2.4547457695007324
Epoch: 2, Steps: 89 | Train Loss: 1.086 Vali Loss: 0.668 Vali Acc: 0.872 Test Loss: 0.668 Test Acc: 0.872
Validation loss decreased (-0.719342 --> -0.871860).  Saving model ...
Epoch: 3 cost time: 2.353198289871216
Epoch: 3, Steps: 89 | Train Loss: 0.463 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.871860 --> -0.903896).  Saving model ...
Epoch: 4 cost time: 2.2928757667541504
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.257 Vali Acc: 0.928 Test Loss: 0.257 Test Acc: 0.928
Validation loss decreased (-0.903896 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.4140141010284424
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
Validation loss decreased (-0.928270 --> -0.953340).  Saving model ...
Epoch: 6 cost time: 2.4807939529418945
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.953340 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 2.3439488410949707
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6370067596435547
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.183 Vali Acc: 0.953 Test Loss: 0.183 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.586254596710205
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 2.507550001144409
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
Validation loss decreased (-0.971447 --> -0.980500).  Saving model ...
Epoch: 11 cost time: 2.971125602722168
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7638981342315674
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.434934616088867
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.740407705307007
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 15 cost time: 2.3477232456207275
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3332595825195312
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4869837760925293
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.214570999145508
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.2398123741149902
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.3025918006896973
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2272112369537354
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.402369260787964
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5559191703796387
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.138 Vali Acc: 0.983 Test Loss: 0.138 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982589).  Saving model ...
Epoch: 24 cost time: 2.151609420776367
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.133 Vali Acc: 0.977 Test Loss: 0.133 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5396828651428223
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.982589).  Saving model ...
Epoch: 26 cost time: 2.9063851833343506
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.807054042816162
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.982 Test Loss: 0.117 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5360031127929688
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1436471939086914
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.982 Test Loss: 0.118 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.515235662460327
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9175999164581299
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.983 Test Loss: 0.119 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3940773010253906
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.938314914703369
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.983 Test Loss: 0.122 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983286).  Saving model ...
Epoch: 34 cost time: 2.9831414222717285
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.599742889404297
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.983 Test Loss: 0.123 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.8758766651153564
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.6598613262176514
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.982 Test Loss: 0.127 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.5483646392822266
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.982 Test Loss: 0.124 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.594817638397217
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.983 Test Loss: 0.126 Test Acc: 0.983
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.354987144470215
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.982 Test Loss: 0.128 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.646149158477783
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.983 Test Loss: 0.129 Test Acc: 0.983
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.142010450363159
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.2994236946105957
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.132 Vali Acc: 0.982 Test Loss: 0.132 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 56530
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.826842784881592
Epoch: 1, Steps: 89 | Train Loss: 2.490 Vali Loss: 1.709 Vali Acc: 0.670 Test Loss: 1.709 Test Acc: 0.670
Validation loss decreased (inf --> -0.669899).  Saving model ...
Epoch: 2 cost time: 2.8114423751831055
Epoch: 2, Steps: 89 | Train Loss: 1.088 Vali Loss: 0.675 Vali Acc: 0.849 Test Loss: 0.675 Test Acc: 0.849
Validation loss decreased (-0.669899 --> -0.848879).  Saving model ...
Epoch: 3 cost time: 2.4397921562194824
Epoch: 3, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.348 Vali Acc: 0.916 Test Loss: 0.348 Test Acc: 0.916
Validation loss decreased (-0.848879 --> -0.915735).  Saving model ...
Epoch: 4 cost time: 2.6364808082580566
Epoch: 4, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.915735 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 2.322258234024048
Epoch: 5, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.169 Vali Acc: 0.961 Test Loss: 0.169 Test Acc: 0.961
Validation loss decreased (-0.956126 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 2.4627509117126465
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.7049522399902344
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975625).  Saving model ...
Epoch: 8 cost time: 3.4841651916503906
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.653273582458496
Epoch: 9, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 3.2349300384521484
Epoch: 10, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3838298320770264
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6420340538024902
Epoch: 12, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 13 cost time: 2.489680767059326
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.64343523979187
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 2.8592967987060547
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.31718373298645
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 3.28491473197937
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.715665817260742
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.2533552646636963
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7685458660125732
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7862846851348877
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9329309463500977
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3853704929351807
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.204763412475586
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9449875354766846
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.205770254135132
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 27 cost time: 2.4905714988708496
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.975 Test Loss: 0.156 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.955820322036743
Epoch: 28, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.2990798950195312
Epoch: 29, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.152362585067749
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.0293891429901123
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.977 Test Loss: 0.122 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.127377271652222
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0111896991729736
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.5191478729248047
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.5564255714416504
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.326566219329834
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 55512
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.714451551437378
Epoch: 1, Steps: 89 | Train Loss: 2.504 Vali Loss: 1.717 Vali Acc: 0.703 Test Loss: 1.717 Test Acc: 0.703
Validation loss decreased (inf --> -0.703325).  Saving model ...
Epoch: 2 cost time: 2.5047693252563477
Epoch: 2, Steps: 89 | Train Loss: 1.117 Vali Loss: 0.728 Vali Acc: 0.860 Test Loss: 0.728 Test Acc: 0.860
Validation loss decreased (-0.703325 --> -0.860021).  Saving model ...
Epoch: 3 cost time: 2.4265496730804443
Epoch: 3, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.417 Vali Acc: 0.906 Test Loss: 0.417 Test Acc: 0.906
Validation loss decreased (-0.860021 --> -0.905985).  Saving model ...
Epoch: 4 cost time: 3.3494250774383545
Epoch: 4, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.236 Vali Acc: 0.947 Test Loss: 0.236 Test Acc: 0.947
Validation loss decreased (-0.905985 --> -0.947073).  Saving model ...
Epoch: 5 cost time: 2.7059504985809326
Epoch: 5, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.154 Vali Acc: 0.967 Test Loss: 0.154 Test Acc: 0.967
Validation loss decreased (-0.947073 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 2.6407089233398438
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.967269 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 2.5668864250183105
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977018).  Saving model ...
Epoch: 8 cost time: 2.381168842315674
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3880910873413086
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.093 Vali Acc: 0.978 Test Loss: 0.093 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 10 cost time: 3.1401660442352295
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.090 Vali Acc: 0.974 Test Loss: 0.090 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1245779991149902
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.087 Vali Acc: 0.974 Test Loss: 0.087 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5539438724517822
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 2.886216640472412
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.103 Vali Acc: 0.971 Test Loss: 0.103 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2218453884124756
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.75948166847229
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.984679).  Saving model ...
Epoch: 16 cost time: 2.5781455039978027
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.772414445877075
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.084 Vali Acc: 0.978 Test Loss: 0.084 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.0967156887054443
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.357579469680786
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.774771213531494
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.848008871078491
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.4686055183410645
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.090 Vali Acc: 0.979 Test Loss: 0.090 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5292022228240967
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.731731653213501
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.3768975734710693
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 55718
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.0822319984436035
Epoch: 1, Steps: 89 | Train Loss: 2.525 Vali Loss: 1.733 Vali Acc: 0.718 Test Loss: 1.733 Test Acc: 0.718
Validation loss decreased (inf --> -0.717949).  Saving model ...
Epoch: 2 cost time: 2.873272180557251
Epoch: 2, Steps: 89 | Train Loss: 1.112 Vali Loss: 0.715 Vali Acc: 0.851 Test Loss: 0.715 Test Acc: 0.851
Validation loss decreased (-0.717949 --> -0.850968).  Saving model ...
Epoch: 3 cost time: 3.018692970275879
Epoch: 3, Steps: 89 | Train Loss: 0.509 Vali Loss: 0.401 Vali Acc: 0.896 Test Loss: 0.401 Test Acc: 0.896
Validation loss decreased (-0.850968 --> -0.895539).  Saving model ...
Epoch: 4 cost time: 3.1964993476867676
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.243 Vali Acc: 0.946 Test Loss: 0.243 Test Acc: 0.946
Validation loss decreased (-0.895539 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 2.349006414413452
Epoch: 5, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
Validation loss decreased (-0.945680 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 3.2872681617736816
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.959609).  Saving model ...
Epoch: 7 cost time: 3.053424119949341
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1590583324432373
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
Validation loss decreased (-0.959609 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 2.978508234024048
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3739771842956543
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.8926310539245605
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0273044109344482
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
Validation loss decreased (-0.975626 --> -0.981197).  Saving model ...
Epoch: 13 cost time: 3.0865700244903564
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7748866081237793
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.3555314540863037
Epoch: 15, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8769917488098145
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 17 cost time: 2.7832837104797363
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982590).  Saving model ...
Epoch: 18 cost time: 2.728175163269043
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.056427001953125
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3846776485443115
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.495037794113159
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.187446117401123
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0439417362213135
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.147 Vali Acc: 0.976 Test Loss: 0.147 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.314915180206299
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.981 Test Loss: 0.094 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8248050212860107
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.663433074951172
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.954798936843872
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 56538
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.183917999267578
Epoch: 1, Steps: 89 | Train Loss: 2.573 Vali Loss: 1.777 Vali Acc: 0.637 Test Loss: 1.777 Test Acc: 0.637
Validation loss decreased (inf --> -0.637169).  Saving model ...
Epoch: 2 cost time: 2.734825372695923
Epoch: 2, Steps: 89 | Train Loss: 1.135 Vali Loss: 0.719 Vali Acc: 0.842 Test Loss: 0.719 Test Acc: 0.842
Validation loss decreased (-0.637169 --> -0.841915).  Saving model ...
Epoch: 3 cost time: 2.8346643447875977
Epoch: 3, Steps: 89 | Train Loss: 0.521 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.841915 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 2.994206428527832
Epoch: 4, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.900414 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 2.624987840652466
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.205 Vali Acc: 0.946 Test Loss: 0.205 Test Acc: 0.946
Validation loss decreased (-0.940805 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.5184571743011475
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
Validation loss decreased (-0.945680 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 2.8073956966400146
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8700718879699707
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.969358 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 2.431962013244629
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.110 Vali Acc: 0.980 Test Loss: 0.110 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 10 cost time: 2.548537254333496
Epoch: 10, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5771772861480713
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 2.686889886856079
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7051942348480225
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7441256046295166
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.979804 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 2.472686290740967
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.017678737640381
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0337865352630615
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.980 Test Loss: 0.096 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.0474112033843994
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 19 cost time: 3.0910468101501465
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7928948402404785
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.979 Test Loss: 0.097 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.3184690475463867
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.255228281021118
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.9550514221191406
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.208892822265625
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.4486825466156006
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.041305065155029
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.3473715782165527
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.829380750656128
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 56634
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.7283923625946045
Epoch: 1, Steps: 89 | Train Loss: 2.447 Vali Loss: 1.706 Vali Acc: 0.669 Test Loss: 1.706 Test Acc: 0.669
Validation loss decreased (inf --> -0.669203).  Saving model ...
Epoch: 2 cost time: 2.984802007675171
Epoch: 2, Steps: 89 | Train Loss: 1.097 Vali Loss: 0.693 Vali Acc: 0.845 Test Loss: 0.693 Test Acc: 0.845
Validation loss decreased (-0.669203 --> -0.845397).  Saving model ...
Epoch: 3 cost time: 2.7845473289489746
Epoch: 3, Steps: 89 | Train Loss: 0.479 Vali Loss: 0.351 Vali Acc: 0.916 Test Loss: 0.351 Test Acc: 0.916
Validation loss decreased (-0.845397 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 2.6457865238189697
Epoch: 4, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.916431 --> -0.930360).  Saving model ...
Epoch: 5 cost time: 3.522270679473877
Epoch: 5, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.930360 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 3.9723222255706787
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 3.0690670013427734
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.510572910308838
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 3.5053677558898926
Epoch: 9, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 3.150355815887451
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.862844467163086
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.154 Vali Acc: 0.957 Test Loss: 0.154 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.602856159210205
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.720296859741211
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 14 cost time: 3.1895833015441895
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.763869285583496
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.064283609390259
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 3.1783463954925537
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 3.5397775173187256
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8263163566589355
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3572423458099365
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.442673921585083
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.091 Vali Acc: 0.982 Test Loss: 0.091 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 22 cost time: 3.621764659881592
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9536988735198975
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.672097682952881
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.107274293899536
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.7840003967285156
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 27 cost time: 3.2842373847961426
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.9004857540130615
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.718395233154297
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.9852521419525146
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.558357000350952
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.475402593612671
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.755706787109375
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.272223949432373
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.982 Test Loss: 0.113 Test Acc: 0.982
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.2466044425964355
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.11118483543396
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 56006
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.385365009307861
Epoch: 1, Steps: 89 | Train Loss: 2.410 Vali Loss: 1.673 Vali Acc: 0.728 Test Loss: 1.673 Test Acc: 0.728
Validation loss decreased (inf --> -0.728396).  Saving model ...
Epoch: 2 cost time: 3.4638988971710205
Epoch: 2, Steps: 89 | Train Loss: 1.087 Vali Loss: 0.720 Vali Acc: 0.856 Test Loss: 0.720 Test Acc: 0.856
Validation loss decreased (-0.728396 --> -0.855842).  Saving model ...
Epoch: 3 cost time: 3.2404966354370117
Epoch: 3, Steps: 89 | Train Loss: 0.529 Vali Loss: 0.426 Vali Acc: 0.903 Test Loss: 0.426 Test Acc: 0.903
Validation loss decreased (-0.855842 --> -0.903199).  Saving model ...
Epoch: 4 cost time: 3.705716848373413
Epoch: 4, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.275 Vali Acc: 0.940 Test Loss: 0.275 Test Acc: 0.940
Validation loss decreased (-0.903199 --> -0.940109).  Saving model ...
Epoch: 5 cost time: 2.753617286682129
Epoch: 5, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.213 Vali Acc: 0.951 Test Loss: 0.213 Test Acc: 0.951
Validation loss decreased (-0.940109 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 3.10982608795166
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.180 Vali Acc: 0.961 Test Loss: 0.180 Test Acc: 0.961
Validation loss decreased (-0.950555 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.9313156604766846
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.154 Vali Acc: 0.970 Test Loss: 0.154 Test Acc: 0.970
Validation loss decreased (-0.961001 --> -0.970054).  Saving model ...
Epoch: 8 cost time: 3.0277981758117676
Epoch: 8, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.061556339263916
Epoch: 9, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 3.3086183071136475
Epoch: 10, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.133 Vali Acc: 0.965 Test Loss: 0.133 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3114352226257324
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.167 Vali Acc: 0.951 Test Loss: 0.167 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.464796543121338
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 2.962338447570801
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 3.55745792388916
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.855839252471924
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1671602725982666
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9881961345672607
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 3.5670669078826904
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.938349962234497
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.499626636505127
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9624364376068115
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.474074363708496
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.395718812942505
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 24 cost time: 2.7762451171875
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6012165546417236
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.978987455368042
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.965782880783081
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.4697749614715576
Epoch: 28, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.170 Vali Acc: 0.969 Test Loss: 0.170 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.1380889415740967
Epoch: 29, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.3280093669891357
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 31 cost time: 3.332176923751831
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.113 Vali Acc: 0.983 Test Loss: 0.113 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.982589).  Saving model ...
Epoch: 32 cost time: 2.805403470993042
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.984 Test Loss: 0.109 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 33 cost time: 3.00268816947937
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.984 Test Loss: 0.109 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.4881577491760254
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.985 Test Loss: 0.112 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 35 cost time: 3.1649627685546875
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.984 Test Loss: 0.116 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.6844136714935303
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.983 Test Loss: 0.117 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5030720233917236
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.195085287094116
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.1940367221832275
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.3850653171539307
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.985 Test Loss: 0.125 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.71887469291687
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.6201045513153076
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.984 Test Loss: 0.129 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.6660239696502686
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.983 Test Loss: 0.131 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.897343158721924
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.131 Vali Acc: 0.985 Test Loss: 0.131 Test Acc: 0.985
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 56902
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.887380361557007
Epoch: 1, Steps: 89 | Train Loss: 2.442 Vali Loss: 1.680 Vali Acc: 0.690 Test Loss: 1.680 Test Acc: 0.690
Validation loss decreased (inf --> -0.690095).  Saving model ...
Epoch: 2 cost time: 3.446516275405884
Epoch: 2, Steps: 89 | Train Loss: 1.094 Vali Loss: 0.717 Vali Acc: 0.845 Test Loss: 0.717 Test Acc: 0.845
Validation loss decreased (-0.690095 --> -0.844700).  Saving model ...
Epoch: 3 cost time: 3.51342511177063
Epoch: 3, Steps: 89 | Train Loss: 0.521 Vali Loss: 0.411 Vali Acc: 0.908 Test Loss: 0.411 Test Acc: 0.908
Validation loss decreased (-0.844700 --> -0.908074).  Saving model ...
Epoch: 4 cost time: 3.474212408065796
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.230 Vali Acc: 0.942 Test Loss: 0.230 Test Acc: 0.942
Validation loss decreased (-0.908074 --> -0.941502).  Saving model ...
Epoch: 5 cost time: 2.9926414489746094
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.186 Vali Acc: 0.951 Test Loss: 0.186 Test Acc: 0.951
Validation loss decreased (-0.941502 --> -0.951252).  Saving model ...
Epoch: 6 cost time: 3.2031757831573486
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.144 Vali Acc: 0.967 Test Loss: 0.144 Test Acc: 0.967
Validation loss decreased (-0.951252 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 3.861891984939575
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 3.31126070022583
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.966572 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 3.3288722038269043
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0530197620391846
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 2.9214253425598145
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1987385749816895
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 3.3447563648223877
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 3.3125970363616943
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.557161569595337
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.939298391342163
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7455267906188965
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.925955057144165
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.966 Test Loss: 0.150 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0855488777160645
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 20 cost time: 2.81363582611084
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.907222270965576
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 3.233396291732788
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.095 Vali Acc: 0.980 Test Loss: 0.095 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 23 cost time: 3.1295738220214844
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.090 Vali Acc: 0.984 Test Loss: 0.090 Test Acc: 0.984
Validation loss decreased (-0.979804 --> -0.983982).  Saving model ...
Epoch: 24 cost time: 3.592977285385132
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.982 Test Loss: 0.111 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.239165782928467
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.097 Vali Acc: 0.984 Test Loss: 0.097 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.035266160964966
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.1318986415863037
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.985 Test Loss: 0.104 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.985375).  Saving model ...
Epoch: 28 cost time: 2.7235138416290283
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.00976300239563
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.772508144378662
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.985 Test Loss: 0.111 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.576340675354004
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.028681516647339
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.96443772315979
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.153 Vali Acc: 0.968 Test Loss: 0.153 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.0844223499298096
Epoch: 34, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.131486415863037
Epoch: 35, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.238750696182251
Epoch: 36, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.505431890487671
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 55008
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.716825485229492
Epoch: 1, Steps: 89 | Train Loss: 2.444 Vali Loss: 1.677 Vali Acc: 0.712 Test Loss: 1.677 Test Acc: 0.712
Validation loss decreased (inf --> -0.712379).  Saving model ...
Epoch: 2 cost time: 2.9945783615112305
Epoch: 2, Steps: 89 | Train Loss: 1.090 Vali Loss: 0.706 Vali Acc: 0.844 Test Loss: 0.706 Test Acc: 0.844
Validation loss decreased (-0.712379 --> -0.844004).  Saving model ...
Epoch: 3 cost time: 3.3972814083099365
Epoch: 3, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.401 Vali Acc: 0.898 Test Loss: 0.401 Test Acc: 0.898
Validation loss decreased (-0.844004 --> -0.897628).  Saving model ...
Epoch: 4 cost time: 3.129781484603882
Epoch: 4, Steps: 89 | Train Loss: 0.296 Vali Loss: 0.268 Vali Acc: 0.936 Test Loss: 0.268 Test Acc: 0.936
Validation loss decreased (-0.897628 --> -0.935930).  Saving model ...
Epoch: 5 cost time: 3.15869402885437
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.190 Vali Acc: 0.957 Test Loss: 0.190 Test Acc: 0.957
Validation loss decreased (-0.935930 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 3.1304540634155273
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.956823 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 3.1578869819641113
Epoch: 7, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.164 Vali Acc: 0.957 Test Loss: 0.164 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.250974416732788
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 3.494631290435791
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 3.4277119636535645
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 3.212158203125
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 3.637824058532715
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2930169105529785
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 2.8352081775665283
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.109 Vali Acc: 0.982 Test Loss: 0.109 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 15 cost time: 3.4230406284332275
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 3.9223618507385254
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4214677810668945
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.90657639503479
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.893213987350464
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.983 Test Loss: 0.109 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 20 cost time: 3.2735981941223145
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.122 Vali Acc: 0.980 Test Loss: 0.122 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.5228118896484375
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.113 Vali Acc: 0.984 Test Loss: 0.113 Test Acc: 0.984
Validation loss decreased (-0.982589 --> -0.983982).  Saving model ...
Epoch: 22 cost time: 3.2727303504943848
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.114 Vali Acc: 0.983 Test Loss: 0.114 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.507148504257202
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.2274410724639893
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9348795413970947
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.142 Vali Acc: 0.985 Test Loss: 0.142 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984678).  Saving model ...
Epoch: 26 cost time: 3.179382562637329
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.147 Vali Acc: 0.981 Test Loss: 0.147 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5247440338134766
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.163390636444092
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.180 Vali Acc: 0.970 Test Loss: 0.180 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7744696140289307
Epoch: 29, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.206 Vali Acc: 0.955 Test Loss: 0.206 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6509296894073486
Epoch: 30, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.163 Vali Acc: 0.969 Test Loss: 0.163 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.660249710083008
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.138 Vali Acc: 0.982 Test Loss: 0.138 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.032700300216675
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.163 Vali Acc: 0.974 Test Loss: 0.163 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.134866952896118
Epoch: 33, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.119 Vali Acc: 0.984 Test Loss: 0.119 Test Acc: 0.984
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.0788183212280273
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.984 Test Loss: 0.124 Test Acc: 0.984
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.246736764907837
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.984678).  Saving model ...
Epoch: 36 cost time: 2.7365691661834717
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.985 Test Loss: 0.122 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.2330987453460693
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.985 Test Loss: 0.121 Test Acc: 0.985
Validation loss decreased (-0.984678 --> -0.985375).  Saving model ...
Epoch: 38 cost time: 3.528956651687622
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.122 Vali Acc: 0.987 Test Loss: 0.122 Test Acc: 0.987
Validation loss decreased (-0.985375 --> -0.986768).  Saving model ...
Epoch: 39 cost time: 2.853518009185791
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.987 Test Loss: 0.123 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.324676752090454
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.987 Test Loss: 0.124 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.407088041305542
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.986 Test Loss: 0.124 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.3291988372802734
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.987 Test Loss: 0.125 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.8222293853759766
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.987 Test Loss: 0.126 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 3.387235641479492
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.987 Test Loss: 0.127 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.759603261947632
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.987 Test Loss: 0.127 Test Acc: 0.987
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 3.502314329147339
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.987 Test Loss: 0.128 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.71372652053833
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.129 Vali Acc: 0.987 Test Loss: 0.129 Test Acc: 0.987
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.4749321937561035
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.987 Test Loss: 0.130 Test Acc: 0.987
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 55002
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.8899827003479
Epoch: 1, Steps: 89 | Train Loss: 2.505 Vali Loss: 1.713 Vali Acc: 0.682 Test Loss: 1.713 Test Acc: 0.682
Validation loss decreased (inf --> -0.681738).  Saving model ...
Epoch: 2 cost time: 3.1286699771881104
Epoch: 2, Steps: 89 | Train Loss: 1.058 Vali Loss: 0.650 Vali Acc: 0.843 Test Loss: 0.650 Test Acc: 0.843
Validation loss decreased (-0.681738 --> -0.842612).  Saving model ...
Epoch: 3 cost time: 2.67276668548584
Epoch: 3, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.352 Vali Acc: 0.916 Test Loss: 0.352 Test Acc: 0.916
Validation loss decreased (-0.842612 --> -0.916431).  Saving model ...
Epoch: 4 cost time: 3.2097413539886475
Epoch: 4, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.244 Vali Acc: 0.939 Test Loss: 0.244 Test Acc: 0.939
Validation loss decreased (-0.916431 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 2.59079647064209
Epoch: 5, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
Validation loss decreased (-0.939413 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 2.681922197341919
Epoch: 6, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.167 Vali Acc: 0.961 Test Loss: 0.167 Test Acc: 0.961
Validation loss decreased (-0.959608 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 3.1291346549987793
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 3.260307550430298
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 2.943485975265503
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 3.302492380142212
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6724233627319336
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.093 Vali Acc: 0.977 Test Loss: 0.093 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 12 cost time: 3.2210726737976074
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7051055431365967
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.135 Vali Acc: 0.955 Test Loss: 0.135 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.054924249649048
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6747376918792725
Epoch: 15, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8289809226989746
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.984344482421875
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.092 Vali Acc: 0.974 Test Loss: 0.092 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.946653127670288
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.3484036922454834
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 3.084674119949341
Epoch: 20, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.807025194168091
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.552417278289795
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.112575054168701
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.569019317626953
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 25 cost time: 3.2215182781219482
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.1683242321014404
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.823251724243164
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.2991061210632324
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.5300099849700928
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.0138885974884033
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.1124465465545654
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.8266024589538574
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.0018625259399414
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.9974758625030518
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.103 Vali Acc: 0.982 Test Loss: 0.103 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 56886
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.735730886459351
Epoch: 1, Steps: 89 | Train Loss: 2.525 Vali Loss: 1.729 Vali Acc: 0.713 Test Loss: 1.729 Test Acc: 0.713
Validation loss decreased (inf --> -0.713075).  Saving model ...
Epoch: 2 cost time: 2.682973861694336
Epoch: 2, Steps: 89 | Train Loss: 1.092 Vali Loss: 0.670 Vali Acc: 0.845 Test Loss: 0.670 Test Acc: 0.845
Validation loss decreased (-0.713075 --> -0.844701).  Saving model ...
Epoch: 3 cost time: 2.580325126647949
Epoch: 3, Steps: 89 | Train Loss: 0.472 Vali Loss: 0.365 Vali Acc: 0.914 Test Loss: 0.365 Test Acc: 0.914
Validation loss decreased (-0.844701 --> -0.914342).  Saving model ...
Epoch: 4 cost time: 3.013185501098633
Epoch: 4, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.261 Vali Acc: 0.927 Test Loss: 0.261 Test Acc: 0.927
Validation loss decreased (-0.914342 --> -0.926878).  Saving model ...
Epoch: 5 cost time: 2.849616050720215
Epoch: 5, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.926878 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 2.5985515117645264
Epoch: 6, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.149 Vali Acc: 0.968 Test Loss: 0.149 Test Acc: 0.968
Validation loss decreased (-0.958912 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 3.52250599861145
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 2.480369806289673
Epoch: 8, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 3.2643015384674072
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8924176692962646
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8989064693450928
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
Validation loss decreased (-0.976322 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 3.2590787410736084
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0180928707122803
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.4059276580810547
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.984679).  Saving model ...
Epoch: 15 cost time: 3.5055696964263916
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7503154277801514
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6497373580932617
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.8744726181030273
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.981 Test Loss: 0.102 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.064438819885254
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.973 Test Loss: 0.108 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.699815273284912
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.474555253982544
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.9216606616973877
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.090 Vali Acc: 0.981 Test Loss: 0.090 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.937258005142212
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.092 Vali Acc: 0.983 Test Loss: 0.092 Test Acc: 0.983
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.916227340698242
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.089 Vali Acc: 0.983 Test Loss: 0.089 Test Acc: 0.983
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 55982
model size : 0.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.562853097915649
Epoch: 1, Steps: 89 | Train Loss: 2.515 Vali Loss: 1.735 Vali Acc: 0.677 Test Loss: 1.735 Test Acc: 0.677
Validation loss decreased (inf --> -0.676863).  Saving model ...
Epoch: 2 cost time: 2.4471020698547363
Epoch: 2, Steps: 89 | Train Loss: 1.101 Vali Loss: 0.686 Vali Acc: 0.861 Test Loss: 0.686 Test Acc: 0.861
Validation loss decreased (-0.676863 --> -0.860717).  Saving model ...
Epoch: 3 cost time: 2.711456060409546
Epoch: 3, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.363 Vali Acc: 0.912 Test Loss: 0.363 Test Acc: 0.912
Validation loss decreased (-0.860717 --> -0.911556).  Saving model ...
Epoch: 4 cost time: 2.9526705741882324
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
Validation loss decreased (-0.911556 --> -0.936627).  Saving model ...
Epoch: 5 cost time: 2.8850302696228027
Epoch: 5, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.936627 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 3.246453046798706
Epoch: 6, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
Validation loss decreased (-0.954037 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.8823814392089844
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.765953779220581
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.796207904815674
Epoch: 9, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.108 Vali Acc: 0.971 Test Loss: 0.108 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 3.3174240589141846
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.099 Vali Acc: 0.976 Test Loss: 0.099 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 2.7813382148742676
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.087 Vali Acc: 0.978 Test Loss: 0.087 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 3.2968876361846924
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.083 Vali Acc: 0.982 Test Loss: 0.083 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 2.7354180812835693
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 3.218963384628296
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.071 Vali Acc: 0.981 Test Loss: 0.071 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.003990888595581
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.240187406539917
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.090 Vali Acc: 0.982 Test Loss: 0.090 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0052363872528076
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.079 Vali Acc: 0.984 Test Loss: 0.079 Test Acc: 0.984
Validation loss decreased (-0.982590 --> -0.983982).  Saving model ...
Epoch: 18 cost time: 3.0411534309387207
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.067 Vali Acc: 0.987 Test Loss: 0.067 Test Acc: 0.987
Validation loss decreased (-0.983982 --> -0.986768).  Saving model ...
Epoch: 19 cost time: 2.6909947395324707
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.067 Vali Acc: 0.986 Test Loss: 0.067 Test Acc: 0.986
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.738960027694702
Epoch: 20, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.069 Vali Acc: 0.987 Test Loss: 0.069 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.445301055908203
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.999818801879883
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.094 Vali Acc: 0.978 Test Loss: 0.094 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.814728260040283
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.0565574169158936
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7260141372680664
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.041531562805176
Epoch: 26, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.072033405303955
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.176574945449829
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9867688022284122
model parameter : 56616
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.288709402084351
Epoch: 1, Steps: 89 | Train Loss: 2.512 Vali Loss: 1.706 Vali Acc: 0.717 Test Loss: 1.706 Test Acc: 0.717
Validation loss decreased (inf --> -0.716557).  Saving model ...
Epoch: 2 cost time: 2.9829792976379395
Epoch: 2, Steps: 89 | Train Loss: 1.061 Vali Loss: 0.636 Vali Acc: 0.860 Test Loss: 0.636 Test Acc: 0.860
Validation loss decreased (-0.716557 --> -0.860021).  Saving model ...
Epoch: 3 cost time: 2.886197328567505
Epoch: 3, Steps: 89 | Train Loss: 0.455 Vali Loss: 0.352 Vali Acc: 0.904 Test Loss: 0.352 Test Acc: 0.904
Validation loss decreased (-0.860021 --> -0.903896).  Saving model ...
Epoch: 4 cost time: 2.816378355026245
Epoch: 4, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.903896 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 2.997093677520752
Epoch: 5, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.947770 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 3.0615596771240234
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
Validation loss decreased (-0.956127 --> -0.970751).  Saving model ...
Epoch: 7 cost time: 2.864711284637451
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.192 Vali Acc: 0.940 Test Loss: 0.192 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5312817096710205
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3288931846618652
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1099419593811035
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.970751 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 3.2053675651550293
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 12 cost time: 2.986132860183716
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7086732387542725
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.954253673553467
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6629393100738525
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 16 cost time: 3.3519527912139893
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 2.760493516921997
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.083 Vali Acc: 0.985 Test Loss: 0.083 Test Acc: 0.985
Validation loss decreased (-0.981893 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 2.7993834018707275
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.02890944480896
Epoch: 19, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.128948450088501
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.000558376312256
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.090 Vali Acc: 0.983 Test Loss: 0.090 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.195030450820923
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.9247000217437744
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.530367374420166
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.984 Test Loss: 0.095 Test Acc: 0.984
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.050882577896118
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.097 Vali Acc: 0.981 Test Loss: 0.097 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6902213096618652
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.937501907348633
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm128_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9853760445682451
model parameter : 56538
model size : 0.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.0818257331848145
Epoch: 1, Steps: 89 | Train Loss: 2.457 Vali Loss: 1.684 Vali Acc: 0.669 Test Loss: 1.684 Test Acc: 0.669
Validation loss decreased (inf --> -0.668507).  Saving model ...
Epoch: 2 cost time: 2.5209920406341553
Epoch: 2, Steps: 89 | Train Loss: 1.097 Vali Loss: 0.725 Vali Acc: 0.839 Test Loss: 0.725 Test Acc: 0.839
Validation loss decreased (-0.668507 --> -0.839129).  Saving model ...
Epoch: 3 cost time: 2.832706928253174
Epoch: 3, Steps: 89 | Train Loss: 0.539 Vali Loss: 0.433 Vali Acc: 0.909 Test Loss: 0.433 Test Acc: 0.909
Validation loss decreased (-0.839129 --> -0.908770).  Saving model ...
Epoch: 4 cost time: 2.530194044113159
Epoch: 4, Steps: 89 | Train Loss: 0.332 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.908770 --> -0.929663).  Saving model ...
Epoch: 5 cost time: 2.450568675994873
Epoch: 5, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.231 Vali Acc: 0.946 Test Loss: 0.231 Test Acc: 0.946
Validation loss decreased (-0.929663 --> -0.946377).  Saving model ...
Epoch: 6 cost time: 2.883788824081421
Epoch: 6, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.181 Vali Acc: 0.962 Test Loss: 0.181 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.961697).  Saving model ...
Epoch: 7 cost time: 2.705962657928467
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
Validation loss decreased (-0.961697 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 2.417280435562134
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 9 cost time: 2.7892439365386963
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 2.085686683654785
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 2.465315818786621
Epoch: 11, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.840805768966675
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7977354526519775
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.668492078781128
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.2086150646209717
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6584630012512207
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5942423343658447
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 18 cost time: 2.725862503051758
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 2.1067676544189453
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.435162305831909
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4254987239837646
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.6567623615264893
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6015114784240723
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.5751023292541504
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.2983367443084717
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.137 Vali Acc: 0.975 Test Loss: 0.137 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5573737621307373
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.155 Vali Acc: 0.970 Test Loss: 0.155 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.699528455734253
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.5071704387664795
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 50474
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.158605575561523
Epoch: 1, Steps: 89 | Train Loss: 2.497 Vali Loss: 1.714 Vali Acc: 0.689 Test Loss: 1.714 Test Acc: 0.689
Validation loss decreased (inf --> -0.689398).  Saving model ...
Epoch: 2 cost time: 2.8402862548828125
Epoch: 2, Steps: 89 | Train Loss: 1.122 Vali Loss: 0.727 Vali Acc: 0.836 Test Loss: 0.727 Test Acc: 0.836
Validation loss decreased (-0.689398 --> -0.835647).  Saving model ...
Epoch: 3 cost time: 2.2734620571136475
Epoch: 3, Steps: 89 | Train Loss: 0.538 Vali Loss: 0.446 Vali Acc: 0.896 Test Loss: 0.446 Test Acc: 0.896
Validation loss decreased (-0.835647 --> -0.895539).  Saving model ...
Epoch: 4 cost time: 2.2586348056793213
Epoch: 4, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.895539 --> -0.940805).  Saving model ...
Epoch: 5 cost time: 2.510389566421509
Epoch: 5, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.219 Vali Acc: 0.954 Test Loss: 0.219 Test Acc: 0.954
Validation loss decreased (-0.940805 --> -0.954037).  Saving model ...
Epoch: 6 cost time: 2.663062810897827
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.183 Vali Acc: 0.964 Test Loss: 0.183 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963786).  Saving model ...
Epoch: 7 cost time: 2.4814774990081787
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
Validation loss decreased (-0.963786 --> -0.972143).  Saving model ...
Epoch: 8 cost time: 2.3276097774505615
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 3.0555763244628906
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4257476329803467
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.794586658477783
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5111958980560303
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.74763822555542
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975625).  Saving model ...
Epoch: 14 cost time: 2.6849846839904785
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8122711181640625
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 2.147653102874756
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7178738117218018
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.977 Test Loss: 0.155 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 2.650367259979248
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979107).  Saving model ...
Epoch: 19 cost time: 2.6167285442352295
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.137 Vali Acc: 0.978 Test Loss: 0.137 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5620815753936768
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.973 Test Loss: 0.173 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.3616113662719727
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.978 Test Loss: 0.150 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.496137857437134
Epoch: 22, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.3401877880096436
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.980 Test Loss: 0.156 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979803).  Saving model ...
Epoch: 24 cost time: 2.425720691680908
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.3883306980133057
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.979 Test Loss: 0.157 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.4521121978759766
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7255961894989014
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.976 Test Loss: 0.172 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2451705932617188
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.980500).  Saving model ...
Epoch: 29 cost time: 2.381669521331787
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.980 Test Loss: 0.171 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.56669282913208
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.980 Test Loss: 0.173 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.4491190910339355
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.979 Test Loss: 0.175 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.6790058612823486
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.335228443145752
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.476395845413208
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.980 Test Loss: 0.178 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.244823455810547
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.980 Test Loss: 0.182 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.8312201499938965
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.980 Test Loss: 0.183 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.1448800563812256
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.979 Test Loss: 0.184 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.3773353099823
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.981 Test Loss: 0.189 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 49710
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.391567230224609
Epoch: 1, Steps: 89 | Train Loss: 2.493 Vali Loss: 1.715 Vali Acc: 0.700 Test Loss: 1.715 Test Acc: 0.700
Validation loss decreased (inf --> -0.699844).  Saving model ...
Epoch: 2 cost time: 3.53254771232605
Epoch: 2, Steps: 89 | Train Loss: 1.100 Vali Loss: 0.713 Vali Acc: 0.857 Test Loss: 0.713 Test Acc: 0.857
Validation loss decreased (-0.699844 --> -0.857235).  Saving model ...
Epoch: 3 cost time: 2.5457606315612793
Epoch: 3, Steps: 89 | Train Loss: 0.524 Vali Loss: 0.436 Vali Acc: 0.897 Test Loss: 0.436 Test Acc: 0.897
Validation loss decreased (-0.857235 --> -0.896932).  Saving model ...
Epoch: 4 cost time: 2.6555912494659424
Epoch: 4, Steps: 89 | Train Loss: 0.311 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.896932 --> -0.944287).  Saving model ...
Epoch: 5 cost time: 3.0200254917144775
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.194 Vali Acc: 0.955 Test Loss: 0.194 Test Acc: 0.955
Validation loss decreased (-0.944287 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 2.254929780960083
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
Validation loss decreased (-0.955430 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 2.2820630073547363
Epoch: 7, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 2.2111384868621826
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.113 Vali Acc: 0.977 Test Loss: 0.113 Test Acc: 0.977
Validation loss decreased (-0.970751 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 2.182880401611328
Epoch: 9, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.219611167907715
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 2.473759889602661
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4230868816375732
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7621681690216064
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6565101146698
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.109 Vali Acc: 0.972 Test Loss: 0.109 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4597575664520264
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.624303102493286
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4903147220611572
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 18 cost time: 2.643174886703491
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.092 Vali Acc: 0.980 Test Loss: 0.092 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 2.8967530727386475
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.854585886001587
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.525236129760742
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 22 cost time: 2.3845300674438477
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4928269386291504
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.827728033065796
Epoch: 24, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.977 Test Loss: 0.105 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.0517725944519043
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2913427352905273
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.980 Test Loss: 0.106 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.5459237098693848
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.4084906578063965
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.48089599609375
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.6821272373199463
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.5671565532684326
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 49430
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.231868267059326
Epoch: 1, Steps: 89 | Train Loss: 2.529 Vali Loss: 1.730 Vali Acc: 0.662 Test Loss: 1.730 Test Acc: 0.662
Validation loss decreased (inf --> -0.661543).  Saving model ...
Epoch: 2 cost time: 2.3308651447296143
Epoch: 2, Steps: 89 | Train Loss: 1.116 Vali Loss: 0.700 Vali Acc: 0.856 Test Loss: 0.700 Test Acc: 0.856
Validation loss decreased (-0.661543 --> -0.855843).  Saving model ...
Epoch: 3 cost time: 2.6008872985839844
Epoch: 3, Steps: 89 | Train Loss: 0.506 Vali Loss: 0.400 Vali Acc: 0.914 Test Loss: 0.400 Test Acc: 0.914
Validation loss decreased (-0.855843 --> -0.913645).  Saving model ...
Epoch: 4 cost time: 2.7036421298980713
Epoch: 4, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.283 Vali Acc: 0.928 Test Loss: 0.283 Test Acc: 0.928
Validation loss decreased (-0.913645 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 2.318718671798706
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.219 Vali Acc: 0.943 Test Loss: 0.219 Test Acc: 0.943
Validation loss decreased (-0.927574 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 3.073291778564453
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.942895 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 2.6166467666625977
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 3.0273962020874023
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.969358 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 3.0013692378997803
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 2.577160120010376
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 3.529726028442383
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9968795776367188
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.519375801086426
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.832371234893799
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.509949207305908
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.3559534549713135
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.981 Test Loss: 0.095 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981197).  Saving model ...
Epoch: 17 cost time: 2.546217918395996
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.832448720932007
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.342796564102173
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.174586296081543
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.136791944503784
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3961782455444336
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5271902084350586
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.743283987045288
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.930224657058716
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.45524001121521
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 49346
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7814407348632812
Epoch: 1, Steps: 89 | Train Loss: 2.495 Vali Loss: 1.736 Vali Acc: 0.643 Test Loss: 1.736 Test Acc: 0.643
Validation loss decreased (inf --> -0.643437).  Saving model ...
Epoch: 2 cost time: 2.286080837249756
Epoch: 2, Steps: 89 | Train Loss: 1.131 Vali Loss: 0.742 Vali Acc: 0.845 Test Loss: 0.742 Test Acc: 0.845
Validation loss decreased (-0.643437 --> -0.844700).  Saving model ...
Epoch: 3 cost time: 1.990370750427246
Epoch: 3, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.463 Vali Acc: 0.886 Test Loss: 0.463 Test Acc: 0.886
Validation loss decreased (-0.844700 --> -0.886486).  Saving model ...
Epoch: 4 cost time: 2.2115135192871094
Epoch: 4, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.308 Vali Acc: 0.928 Test Loss: 0.308 Test Acc: 0.928
Validation loss decreased (-0.886486 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.4398818016052246
Epoch: 5, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
Validation loss decreased (-0.928270 --> -0.947769).  Saving model ...
Epoch: 6 cost time: 2.3873682022094727
Epoch: 6, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.206 Vali Acc: 0.951 Test Loss: 0.206 Test Acc: 0.951
Validation loss decreased (-0.947769 --> -0.950555).  Saving model ...
Epoch: 7 cost time: 2.6263349056243896
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 2.380417585372925
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.962394 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 2.617818593978882
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 2.3331706523895264
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5072481632232666
Epoch: 11, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4977517127990723
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 13 cost time: 2.7029879093170166
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8547022342681885
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4036850929260254
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.108 Vali Acc: 0.972 Test Loss: 0.108 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5623364448547363
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.118 Vali Acc: 0.973 Test Loss: 0.118 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3608720302581787
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 18 cost time: 2.3752834796905518
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 2.3186895847320557
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6946301460266113
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.100 Vali Acc: 0.979 Test Loss: 0.100 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979108).  Saving model ...
Epoch: 21 cost time: 3.017505407333374
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.511762857437134
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.066553831100464
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7165603637695312
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.124 Vali Acc: 0.977 Test Loss: 0.124 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.921053647994995
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.637136697769165
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.699928045272827
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4327778816223145
Epoch: 28, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.172 Vali Acc: 0.964 Test Loss: 0.172 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.481900930404663
Epoch: 29, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1020615100860596
Epoch: 30, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.161 Vali Acc: 0.970 Test Loss: 0.161 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 49362
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.106739521026611
Epoch: 1, Steps: 89 | Train Loss: 2.531 Vali Loss: 1.757 Vali Acc: 0.656 Test Loss: 1.757 Test Acc: 0.656
Validation loss decreased (inf --> -0.655971).  Saving model ...
Epoch: 2 cost time: 2.587677478790283
Epoch: 2, Steps: 89 | Train Loss: 1.139 Vali Loss: 0.739 Vali Acc: 0.846 Test Loss: 0.739 Test Acc: 0.846
Validation loss decreased (-0.655971 --> -0.846093).  Saving model ...
Epoch: 3 cost time: 3.04799747467041
Epoch: 3, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.424 Vali Acc: 0.899 Test Loss: 0.424 Test Acc: 0.899
Validation loss decreased (-0.846093 --> -0.899021).  Saving model ...
Epoch: 4 cost time: 2.671342611312866
Epoch: 4, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
Validation loss decreased (-0.899021 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 3.0998127460479736
Epoch: 5, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
Validation loss decreased (-0.945680 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 2.424333095550537
Epoch: 6, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.961001 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 2.446439266204834
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.378659725189209
Epoch: 8, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 2.471449375152588
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 2.410679817199707
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.116 Vali Acc: 0.969 Test Loss: 0.116 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.457486152648926
Epoch: 11, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 2.3599438667297363
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.103 Vali Acc: 0.975 Test Loss: 0.103 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.8785016536712646
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.100 Vali Acc: 0.973 Test Loss: 0.100 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0726194381713867
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9315545558929443
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.894714593887329
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9169394969940186
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6980397701263428
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.332744598388672
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.7471096515655518
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.2709877490997314
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980500).  Saving model ...
Epoch: 22 cost time: 2.846461534500122
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3602800369262695
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2107057571411133
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.8765506744384766
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.286010980606079
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.533607244491577
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7823452949523926
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.475216865539551
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.394272565841675
Epoch: 30, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9725537300109863
Epoch: 31, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 32 cost time: 2.9858458042144775
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 33 cost time: 2.6133313179016113
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 34 cost time: 2.6335246562957764
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.102 Vali Acc: 0.982 Test Loss: 0.102 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 35 cost time: 2.4032368659973145
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 36 cost time: 2.2824718952178955
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.983 Test Loss: 0.105 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.385913610458374
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.24826717376709
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.7276253700256348
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.106 Vali Acc: 0.983 Test Loss: 0.106 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.5276880264282227
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.107 Vali Acc: 0.983 Test Loss: 0.107 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 2.4204485416412354
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.983286).  Saving model ...
Epoch: 42 cost time: 2.931220531463623
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.983 Test Loss: 0.110 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.6546528339385986
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983982).  Saving model ...
Epoch: 44 cost time: 2.649174451828003
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.110 Vali Acc: 0.984 Test Loss: 0.110 Test Acc: 0.984
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.2731449604034424
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.111 Vali Acc: 0.984 Test Loss: 0.111 Test Acc: 0.984
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.831387996673584
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.112 Vali Acc: 0.984 Test Loss: 0.112 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.407960891723633
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.113 Vali Acc: 0.984 Test Loss: 0.113 Test Acc: 0.984
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.5860869884490967
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
Validation loss decreased (-0.983982 --> -0.984679).  Saving model ...
Epoch: 49 cost time: 2.3962783813476562
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.985 Test Loss: 0.114 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.8018040657043457
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.985 Test Loss: 0.115 Test Acc: 0.985
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.475076913833618
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.116 Vali Acc: 0.985 Test Loss: 0.116 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.6796438694000244
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.480664014816284
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.117 Vali Acc: 0.985 Test Loss: 0.117 Test Acc: 0.985
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.7756521701812744
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.985 Test Loss: 0.118 Test Acc: 0.985
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.3396542072296143
Epoch: 55, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.985 Test Loss: 0.119 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 2.665391683578491
Epoch: 56, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 2.403778553009033
Epoch: 57, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.120 Vali Acc: 0.985 Test Loss: 0.120 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 2.620975971221924
Epoch: 58, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.984 Test Loss: 0.121 Test Acc: 0.984
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 48504
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.400129556655884
Epoch: 1, Steps: 89 | Train Loss: 2.465 Vali Loss: 1.705 Vali Acc: 0.657 Test Loss: 1.705 Test Acc: 0.657
Validation loss decreased (inf --> -0.657365).  Saving model ...
Epoch: 2 cost time: 2.451709508895874
Epoch: 2, Steps: 89 | Train Loss: 1.121 Vali Loss: 0.741 Vali Acc: 0.850 Test Loss: 0.741 Test Acc: 0.850
Validation loss decreased (-0.657365 --> -0.850271).  Saving model ...
Epoch: 3 cost time: 2.238032102584839
Epoch: 3, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.460 Vali Acc: 0.898 Test Loss: 0.460 Test Acc: 0.898
Validation loss decreased (-0.850271 --> -0.898324).  Saving model ...
Epoch: 4 cost time: 2.641126871109009
Epoch: 4, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.315 Vali Acc: 0.925 Test Loss: 0.315 Test Acc: 0.925
Validation loss decreased (-0.898324 --> -0.925484).  Saving model ...
Epoch: 5 cost time: 2.4357941150665283
Epoch: 5, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.241 Vali Acc: 0.942 Test Loss: 0.241 Test Acc: 0.942
Validation loss decreased (-0.925484 --> -0.941502).  Saving model ...
Epoch: 6 cost time: 2.461658477783203
Epoch: 6, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.941502 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 3.0700652599334717
Epoch: 7, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.956126 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.7493457794189453
Epoch: 8, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 2.8844542503356934
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 2.6237337589263916
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2347729206085205
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 2.4830777645111084
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0936996936798096
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 14 cost time: 2.8230934143066406
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2544336318969727
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.980 Test Loss: 0.099 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 16 cost time: 2.2222652435302734
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.194767713546753
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7034645080566406
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.211577892303467
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.607154369354248
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0890321731567383
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6795098781585693
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.419821262359619
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.693366765975952
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.322798013687134
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 26 cost time: 2.5872881412506104
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.105 Vali Acc: 0.982 Test Loss: 0.105 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 27 cost time: 2.1262755393981934
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2538490295410156
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.981 Test Loss: 0.111 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.3553290367126465
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.129634141921997
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.982 Test Loss: 0.108 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.020785331726074
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.7214088439941406
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.983 Test Loss: 0.112 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982589).  Saving model ...
Epoch: 33 cost time: 2.7204253673553467
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.983 Test Loss: 0.111 Test Acc: 0.983
Validation loss decreased (-0.982589 --> -0.982589).  Saving model ...
Epoch: 34 cost time: 2.669381856918335
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.118 Vali Acc: 0.979 Test Loss: 0.118 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.499049186706543
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.114 Vali Acc: 0.982 Test Loss: 0.114 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.673319101333618
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.115 Vali Acc: 0.983 Test Loss: 0.115 Test Acc: 0.983
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.230354070663452
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.424443244934082
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.982 Test Loss: 0.119 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.3191773891448975
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.119 Vali Acc: 0.981 Test Loss: 0.119 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.329327344894409
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.267345905303955
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.557284355163574
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.981 Test Loss: 0.125 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.100766181945801
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.980 Test Loss: 0.127 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 48806
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.192424774169922
Epoch: 1, Steps: 89 | Train Loss: 2.476 Vali Loss: 1.716 Vali Acc: 0.660 Test Loss: 1.716 Test Acc: 0.660
Validation loss decreased (inf --> -0.660150).  Saving model ...
Epoch: 2 cost time: 2.685635566711426
Epoch: 2, Steps: 89 | Train Loss: 1.124 Vali Loss: 0.734 Vali Acc: 0.831 Test Loss: 0.734 Test Acc: 0.831
Validation loss decreased (-0.660150 --> -0.830773).  Saving model ...
Epoch: 3 cost time: 2.3948075771331787
Epoch: 3, Steps: 89 | Train Loss: 0.547 Vali Loss: 0.446 Vali Acc: 0.902 Test Loss: 0.446 Test Acc: 0.902
Validation loss decreased (-0.830773 --> -0.901806).  Saving model ...
Epoch: 4 cost time: 2.4046270847320557
Epoch: 4, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.322 Vali Acc: 0.928 Test Loss: 0.322 Test Acc: 0.928
Validation loss decreased (-0.901806 --> -0.927573).  Saving model ...
Epoch: 5 cost time: 2.5826010704040527
Epoch: 5, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.927573 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 2.3168067932128906
Epoch: 6, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.173 Vali Acc: 0.967 Test Loss: 0.173 Test Acc: 0.967
Validation loss decreased (-0.951948 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 2.5147576332092285
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3505358695983887
Epoch: 8, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.139 Vali Acc: 0.961 Test Loss: 0.139 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.909374475479126
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.123 Vali Acc: 0.966 Test Loss: 0.123 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3973817825317383
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 2.487969160079956
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.133 Vali Acc: 0.962 Test Loss: 0.133 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1916797161102295
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.094 Vali Acc: 0.977 Test Loss: 0.094 Test Acc: 0.977
Validation loss decreased (-0.968662 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 2.1609609127044678
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.090 Vali Acc: 0.978 Test Loss: 0.090 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 2.6767871379852295
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1493544578552246
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.086 Vali Acc: 0.979 Test Loss: 0.086 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 16 cost time: 2.214684247970581
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.082 Vali Acc: 0.977 Test Loss: 0.082 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3759121894836426
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1634440422058105
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 19 cost time: 1.8359806537628174
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 2.298753023147583
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9908220767974854
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.079 Vali Acc: 0.980 Test Loss: 0.079 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.4720633029937744
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.075 Vali Acc: 0.981 Test Loss: 0.075 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3601088523864746
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.983286).  Saving model ...
Epoch: 24 cost time: 2.1951918601989746
Epoch: 24, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.655268907546997
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.081 Vali Acc: 0.981 Test Loss: 0.081 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.289299249649048
Epoch: 26, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 27 cost time: 2.439439058303833
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2076022624969482
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.085 Vali Acc: 0.981 Test Loss: 0.085 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2900030612945557
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.984 Test Loss: 0.074 Test Acc: 0.984
Validation loss decreased (-0.983286 --> -0.983983).  Saving model ...
Epoch: 30 cost time: 2.1152567863464355
Epoch: 30, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.073 Vali Acc: 0.983 Test Loss: 0.073 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6613640785217285
Epoch: 31, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.074 Vali Acc: 0.983 Test Loss: 0.074 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.081010341644287
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.075 Vali Acc: 0.984 Test Loss: 0.075 Test Acc: 0.984
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9069011211395264
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.983 Test Loss: 0.079 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.2649950981140137
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.077 Vali Acc: 0.984 Test Loss: 0.077 Test Acc: 0.984
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9447345733642578
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.078 Vali Acc: 0.984 Test Loss: 0.078 Test Acc: 0.984
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9249598979949951
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
Validation loss decreased (-0.983983 --> -0.984679).  Saving model ...
Epoch: 37 cost time: 2.2732698917388916
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.080 Vali Acc: 0.986 Test Loss: 0.080 Test Acc: 0.986
Validation loss decreased (-0.984679 --> -0.986072).  Saving model ...
Epoch: 38 cost time: 2.0619304180145264
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.3961586952209473
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.986 Test Loss: 0.083 Test Acc: 0.986
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.175168991088867
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986072 --> -0.986768).  Saving model ...
Epoch: 41 cost time: 2.251859188079834
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.082 Vali Acc: 0.987 Test Loss: 0.082 Test Acc: 0.987
Validation loss decreased (-0.986768 --> -0.987464).  Saving model ...
Epoch: 42 cost time: 2.2439768314361572
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.6738340854644775
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.445326089859009
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.085 Vali Acc: 0.986 Test Loss: 0.085 Test Acc: 0.986
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.546569585800171
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.083 Vali Acc: 0.987 Test Loss: 0.083 Test Acc: 0.987
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.6496663093566895
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.084 Vali Acc: 0.987 Test Loss: 0.084 Test Acc: 0.987
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.6922998428344727
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.986 Test Loss: 0.090 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.565416097640991
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.088 Vali Acc: 0.986 Test Loss: 0.088 Test Acc: 0.986
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.2596075534820557
Epoch: 49, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.089 Vali Acc: 0.987 Test Loss: 0.089 Test Acc: 0.987
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.236353874206543
Epoch: 50, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.988 Test Loss: 0.090 Test Acc: 0.988
Validation loss decreased (-0.987464 --> -0.988161).  Saving model ...
Epoch: 51 cost time: 1.9379644393920898
Epoch: 51, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.062455892562866
Epoch: 52, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.090 Vali Acc: 0.987 Test Loss: 0.090 Test Acc: 0.987
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.8832170963287354
Epoch: 53, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.987 Test Loss: 0.093 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 2.644498825073242
Epoch: 54, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.988 Test Loss: 0.092 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.3389546871185303
Epoch: 55, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.989 Test Loss: 0.093 Test Acc: 0.989
Validation loss decreased (-0.988161 --> -0.988857).  Saving model ...
Epoch: 56 cost time: 2.5678563117980957
Epoch: 56, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.092 Vali Acc: 0.989 Test Loss: 0.092 Test Acc: 0.989
Validation loss decreased (-0.988857 --> -0.988857).  Saving model ...
Epoch: 57 cost time: 2.450481653213501
Epoch: 57, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.093 Vali Acc: 0.989 Test Loss: 0.093 Test Acc: 0.989
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 2.2260682582855225
Epoch: 58, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.094 Vali Acc: 0.988 Test Loss: 0.094 Test Acc: 0.988
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 2.513805389404297
Epoch: 59, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.987 Test Loss: 0.095 Test Acc: 0.987
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 2.7325313091278076
Epoch: 60, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.095 Vali Acc: 0.988 Test Loss: 0.095 Test Acc: 0.988
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 2.758824586868286
Epoch: 61, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.989 Test Loss: 0.097 Test Acc: 0.989
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 2.3607780933380127
Epoch: 62, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.987 Test Loss: 0.097 Test Acc: 0.987
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 2.2823874950408936
Epoch: 63, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.097 Vali Acc: 0.989 Test Loss: 0.097 Test Acc: 0.989
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 2.438934087753296
Epoch: 64, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.989 Test Loss: 0.099 Test Acc: 0.989
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 2.3896219730377197
Epoch: 65, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.099 Vali Acc: 0.988 Test Loss: 0.099 Test Acc: 0.988
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 2.224323272705078
Epoch: 66, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.101 Vali Acc: 0.988 Test Loss: 0.101 Test Acc: 0.988
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9888579387186629
model parameter : 49690
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.230839729309082
Epoch: 1, Steps: 89 | Train Loss: 2.477 Vali Loss: 1.728 Vali Acc: 0.683 Test Loss: 1.728 Test Acc: 0.683
Validation loss decreased (inf --> -0.683130).  Saving model ...
Epoch: 2 cost time: 2.268495798110962
Epoch: 2, Steps: 89 | Train Loss: 1.123 Vali Loss: 0.741 Vali Acc: 0.848 Test Loss: 0.741 Test Acc: 0.848
Validation loss decreased (-0.683130 --> -0.848182).  Saving model ...
Epoch: 3 cost time: 2.2140936851501465
Epoch: 3, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.457 Vali Acc: 0.902 Test Loss: 0.457 Test Acc: 0.902
Validation loss decreased (-0.848182 --> -0.901806).  Saving model ...
Epoch: 4 cost time: 2.696707248687744
Epoch: 4, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.330 Vali Acc: 0.928 Test Loss: 0.330 Test Acc: 0.928
Validation loss decreased (-0.901806 --> -0.927573).  Saving model ...
Epoch: 5 cost time: 2.333456039428711
Epoch: 5, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.246 Vali Acc: 0.946 Test Loss: 0.246 Test Acc: 0.946
Validation loss decreased (-0.927573 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.5432491302490234
Epoch: 6, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.209 Vali Acc: 0.954 Test Loss: 0.209 Test Acc: 0.954
Validation loss decreased (-0.945680 --> -0.954037).  Saving model ...
Epoch: 7 cost time: 2.609781503677368
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4194788932800293
Epoch: 8, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 2.5302248001098633
Epoch: 9, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.963787 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 2.2649357318878174
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.496857166290283
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1570444107055664
Epoch: 12, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.766261100769043
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 3.045318603515625
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.5500710010528564
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.132 Vali Acc: 0.963 Test Loss: 0.132 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8534433841705322
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.99739933013916
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.5626354217529297
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.628134250640869
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.4930129051208496
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8030879497528076
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.106 Vali Acc: 0.977 Test Loss: 0.106 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 22 cost time: 2.324488639831543
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 23 cost time: 2.308934450149536
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 24 cost time: 3.1820414066314697
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.978411 --> -0.978411).  Saving model ...
Epoch: 25 cost time: 2.855639696121216
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6691110134124756
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.427351474761963
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.5520358085632324
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.5214388370513916
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.105 Vali Acc: 0.980 Test Loss: 0.105 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 30 cost time: 2.810220241546631
Epoch: 30, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.346165418624878
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 32 cost time: 2.85402512550354
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.979 Test Loss: 0.106 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.6368491649627686
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.461808204650879
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.8048975467681885
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.980 Test Loss: 0.109 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.767807960510254
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 37 cost time: 3.3771164417266846
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.554196357727051
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.980 Test Loss: 0.107 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.658536195755005
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.945507526397705
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.7644076347351074
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.443086862564087
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.9770314693450928
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.980 Test Loss: 0.112 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.460571527481079
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.980 Test Loss: 0.114 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 2.7287535667419434
Epoch: 45, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 2.623422861099243
Epoch: 46, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 49850
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8217248916625977
Epoch: 1, Steps: 89 | Train Loss: 2.573 Vali Loss: 1.767 Vali Acc: 0.737 Test Loss: 1.767 Test Acc: 0.737
Validation loss decreased (inf --> -0.737448).  Saving model ...
Epoch: 2 cost time: 2.5093109607696533
Epoch: 2, Steps: 89 | Train Loss: 1.153 Vali Loss: 0.753 Vali Acc: 0.830 Test Loss: 0.753 Test Acc: 0.830
Validation loss decreased (-0.737448 --> -0.830076).  Saving model ...
Epoch: 3 cost time: 2.3098011016845703
Epoch: 3, Steps: 89 | Train Loss: 0.557 Vali Loss: 0.465 Vali Acc: 0.892 Test Loss: 0.465 Test Acc: 0.892
Validation loss decreased (-0.830076 --> -0.892057).  Saving model ...
Epoch: 4 cost time: 2.082115888595581
Epoch: 4, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.306 Vali Acc: 0.925 Test Loss: 0.306 Test Acc: 0.925
Validation loss decreased (-0.892057 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 2.345691204071045
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
Validation loss decreased (-0.924788 --> -0.950555).  Saving model ...
Epoch: 6 cost time: 2.2249341011047363
Epoch: 6, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
Validation loss decreased (-0.950555 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 2.2102420330047607
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
Validation loss decreased (-0.960305 --> -0.968661).  Saving model ...
Epoch: 8 cost time: 2.080913782119751
Epoch: 8, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.968661 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 1.979830026626587
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 2.262815475463867
Epoch: 10, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.101 Vali Acc: 0.977 Test Loss: 0.101 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 2.138170003890991
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.096 Vali Acc: 0.978 Test Loss: 0.096 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 12 cost time: 2.076112747192383
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1050078868865967
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.091 Vali Acc: 0.975 Test Loss: 0.091 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1522483825683594
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.089 Vali Acc: 0.980 Test Loss: 0.089 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 15 cost time: 2.3310654163360596
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.089 Vali Acc: 0.978 Test Loss: 0.089 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.324349880218506
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.070 Vali Acc: 0.982 Test Loss: 0.070 Test Acc: 0.982
Validation loss decreased (-0.979804 --> -0.981893).  Saving model ...
Epoch: 17 cost time: 2.406874656677246
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.097 Vali Acc: 0.971 Test Loss: 0.097 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.514699935913086
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.100 Vali Acc: 0.969 Test Loss: 0.100 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.045151472091675
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.090 Vali Acc: 0.976 Test Loss: 0.090 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.234947919845581
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.076 Vali Acc: 0.982 Test Loss: 0.076 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.22125506401062
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.070 Vali Acc: 0.980 Test Loss: 0.070 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1496498584747314
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.072 Vali Acc: 0.979 Test Loss: 0.072 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.0470807552337646
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.076 Vali Acc: 0.978 Test Loss: 0.076 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4786040782928467
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.070 Vali Acc: 0.978 Test Loss: 0.070 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9336652755737305
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.067 Vali Acc: 0.982 Test Loss: 0.067 Test Acc: 0.982
Validation loss decreased (-0.981893 --> -0.981893).  Saving model ...
Epoch: 26 cost time: 2.018289804458618
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.974 Test Loss: 0.079 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0318140983581543
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.981 Test Loss: 0.080 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.111814260482788
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.084 Vali Acc: 0.981 Test Loss: 0.084 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2210052013397217
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.079 Vali Acc: 0.976 Test Loss: 0.079 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0360524654388428
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.092 Vali Acc: 0.975 Test Loss: 0.092 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1447763442993164
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.074 Vali Acc: 0.978 Test Loss: 0.074 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9143860340118408
Epoch: 32, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.2137796878814697
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.069 Vali Acc: 0.981 Test Loss: 0.069 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.3346035480499268
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.072 Vali Acc: 0.981 Test Loss: 0.072 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1148006916046143
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.071 Vali Acc: 0.982 Test Loss: 0.071 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 49286
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.6843860149383545
Epoch: 1, Steps: 89 | Train Loss: 2.460 Vali Loss: 1.700 Vali Acc: 0.676 Test Loss: 1.700 Test Acc: 0.676
Validation loss decreased (inf --> -0.676167).  Saving model ...
Epoch: 2 cost time: 2.432180643081665
Epoch: 2, Steps: 89 | Train Loss: 1.117 Vali Loss: 0.735 Vali Acc: 0.852 Test Loss: 0.735 Test Acc: 0.852
Validation loss decreased (-0.676167 --> -0.851664).  Saving model ...
Epoch: 3 cost time: 2.6069529056549072
Epoch: 3, Steps: 89 | Train Loss: 0.560 Vali Loss: 0.454 Vali Acc: 0.903 Test Loss: 0.454 Test Acc: 0.903
Validation loss decreased (-0.851664 --> -0.902502).  Saving model ...
Epoch: 4 cost time: 2.7349929809570312
Epoch: 4, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
Validation loss decreased (-0.902502 --> -0.930359).  Saving model ...
Epoch: 5 cost time: 2.4100587368011475
Epoch: 5, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.256 Vali Acc: 0.946 Test Loss: 0.256 Test Acc: 0.946
Validation loss decreased (-0.930359 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.4525346755981445
Epoch: 6, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
Validation loss decreased (-0.945680 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 2.1393420696258545
Epoch: 7, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.170 Vali Acc: 0.961 Test Loss: 0.170 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 2.332765579223633
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 2.5040507316589355
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 2.1809499263763428
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
Validation loss decreased (-0.975626 --> -0.979108).  Saving model ...
Epoch: 11 cost time: 2.681046962738037
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.610718250274658
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
Validation loss decreased (-0.979108 --> -0.981893).  Saving model ...
Epoch: 13 cost time: 2.3507697582244873
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 14 cost time: 2.6313493251800537
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.075 Vali Acc: 0.983 Test Loss: 0.075 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.982590).  Saving model ...
Epoch: 15 cost time: 2.5983009338378906
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.079 Vali Acc: 0.982 Test Loss: 0.079 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7472434043884277
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.915226936340332
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.985 Test Loss: 0.077 Test Acc: 0.985
Validation loss decreased (-0.982590 --> -0.985375).  Saving model ...
Epoch: 18 cost time: 3.1303648948669434
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.076 Vali Acc: 0.986 Test Loss: 0.076 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 19 cost time: 2.3987510204315186
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.980 Test Loss: 0.086 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7380030155181885
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.297041893005371
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.300827741622925
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.083 Vali Acc: 0.983 Test Loss: 0.083 Test Acc: 0.983
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.708292007446289
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.077 Vali Acc: 0.983 Test Loss: 0.077 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4689559936523438
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.078 Vali Acc: 0.986 Test Loss: 0.078 Test Acc: 0.986
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.5695407390594482
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.076 Vali Acc: 0.985 Test Loss: 0.076 Test Acc: 0.985
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7269387245178223
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.414677381515503
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.582671642303467
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.099 Vali Acc: 0.982 Test Loss: 0.099 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 50214
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.565425395965576
Epoch: 1, Steps: 89 | Train Loss: 2.526 Vali Loss: 1.760 Vali Acc: 0.663 Test Loss: 1.760 Test Acc: 0.663
Validation loss decreased (inf --> -0.662935).  Saving model ...
Epoch: 2 cost time: 2.073753595352173
Epoch: 2, Steps: 89 | Train Loss: 1.159 Vali Loss: 0.770 Vali Acc: 0.831 Test Loss: 0.770 Test Acc: 0.831
Validation loss decreased (-0.662935 --> -0.831469).  Saving model ...
Epoch: 3 cost time: 2.063601493835449
Epoch: 3, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.483 Vali Acc: 0.883 Test Loss: 0.483 Test Acc: 0.883
Validation loss decreased (-0.831469 --> -0.883004).  Saving model ...
Epoch: 4 cost time: 2.0234458446502686
Epoch: 4, Steps: 89 | Train Loss: 0.368 Vali Loss: 0.341 Vali Acc: 0.916 Test Loss: 0.341 Test Acc: 0.916
Validation loss decreased (-0.883004 --> -0.915735).  Saving model ...
Epoch: 5 cost time: 2.3437447547912598
Epoch: 5, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.252 Vali Acc: 0.949 Test Loss: 0.252 Test Acc: 0.949
Validation loss decreased (-0.915735 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 2.291285991668701
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2858471870422363
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.949162 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 2.1252615451812744
Epoch: 8, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
Validation loss decreased (-0.963090 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 2.1436290740966797
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1945104598999023
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 2.2222089767456055
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 12 cost time: 1.9764821529388428
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9707412719726562
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7948787212371826
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1444485187530518
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9534664154052734
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.091338872909546
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.109 Vali Acc: 0.975 Test Loss: 0.109 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.058363676071167
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.284388780593872
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5676567554473877
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.563624620437622
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 48384
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7577245235443115
Epoch: 1, Steps: 89 | Train Loss: 2.530 Vali Loss: 1.730 Vali Acc: 0.675 Test Loss: 1.730 Test Acc: 0.675
Validation loss decreased (inf --> -0.675470).  Saving model ...
Epoch: 2 cost time: 1.932509183883667
Epoch: 2, Steps: 89 | Train Loss: 1.126 Vali Loss: 0.739 Vali Acc: 0.847 Test Loss: 0.739 Test Acc: 0.847
Validation loss decreased (-0.675470 --> -0.846789).  Saving model ...
Epoch: 3 cost time: 1.8197026252746582
Epoch: 3, Steps: 89 | Train Loss: 0.545 Vali Loss: 0.477 Vali Acc: 0.885 Test Loss: 0.477 Test Acc: 0.885
Validation loss decreased (-0.846789 --> -0.885093).  Saving model ...
Epoch: 4 cost time: 2.102365255355835
Epoch: 4, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.322 Vali Acc: 0.928 Test Loss: 0.322 Test Acc: 0.928
Validation loss decreased (-0.885093 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.051783561706543
Epoch: 5, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.245 Vali Acc: 0.940 Test Loss: 0.245 Test Acc: 0.940
Validation loss decreased (-0.928270 --> -0.940109).  Saving model ...
Epoch: 6 cost time: 2.1395068168640137
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.212 Vali Acc: 0.950 Test Loss: 0.212 Test Acc: 0.950
Validation loss decreased (-0.940109 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 2.4678030014038086
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.949859 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 2.5971927642822266
Epoch: 8, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 9 cost time: 2.295405149459839
Epoch: 9, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
Validation loss decreased (-0.960305 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 2.4094014167785645
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 2.495706796646118
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.146 Vali Acc: 0.955 Test Loss: 0.146 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4607326984405518
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.112 Vali Acc: 0.973 Test Loss: 0.112 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 2.120636463165283
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.257842779159546
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.105 Vali Acc: 0.972 Test Loss: 0.105 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9342916011810303
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.103 Vali Acc: 0.974 Test Loss: 0.103 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 16 cost time: 2.1035923957824707
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 2.1663002967834473
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9284074306488037
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2946619987487793
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.976322 --> -0.981893).  Saving model ...
Epoch: 20 cost time: 1.8285717964172363
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9989821910858154
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.197341203689575
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9850733280181885
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.012524127960205
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.3411331176757812
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.1372146606445312
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8318495750427246
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.168848991394043
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3806135654449463
Epoch: 29, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 48410
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5075902938842773
Epoch: 1, Steps: 89 | Train Loss: 2.512 Vali Loss: 1.765 Vali Acc: 0.678 Test Loss: 1.765 Test Acc: 0.678
Validation loss decreased (inf --> -0.678255).  Saving model ...
Epoch: 2 cost time: 1.9373383522033691
Epoch: 2, Steps: 89 | Train Loss: 1.147 Vali Loss: 0.755 Vali Acc: 0.845 Test Loss: 0.755 Test Acc: 0.845
Validation loss decreased (-0.678255 --> -0.844700).  Saving model ...
Epoch: 3 cost time: 1.799353837966919
Epoch: 3, Steps: 89 | Train Loss: 0.553 Vali Loss: 0.465 Vali Acc: 0.893 Test Loss: 0.465 Test Acc: 0.893
Validation loss decreased (-0.844700 --> -0.892753).  Saving model ...
Epoch: 4 cost time: 1.7608706951141357
Epoch: 4, Steps: 89 | Train Loss: 0.352 Vali Loss: 0.307 Vali Acc: 0.927 Test Loss: 0.307 Test Acc: 0.927
Validation loss decreased (-0.892753 --> -0.926877).  Saving model ...
Epoch: 5 cost time: 1.8515737056732178
Epoch: 5, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.926877 --> -0.947769).  Saving model ...
Epoch: 6 cost time: 2.049952983856201
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.947769 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 2.051581859588623
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.149 Vali Acc: 0.961 Test Loss: 0.149 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 2.0110666751861572
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.0480847358703613
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.967269 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 2.015986204147339
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.115 Vali Acc: 0.977 Test Loss: 0.115 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 1.9850096702575684
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.359259843826294
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.100 Vali Acc: 0.981 Test Loss: 0.100 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 2.0358638763427734
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.374314546585083
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.096 Vali Acc: 0.979 Test Loss: 0.096 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.294482469558716
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 16 cost time: 2.096020221710205
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.083 Vali Acc: 0.979 Test Loss: 0.083 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1906909942626953
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1818225383758545
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.089 Vali Acc: 0.979 Test Loss: 0.089 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0848965644836426
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.089 Vali Acc: 0.981 Test Loss: 0.089 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 20 cost time: 2.150707483291626
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
Validation loss decreased (-0.981197 --> -0.985375).  Saving model ...
Epoch: 21 cost time: 2.020202875137329
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.085 Vali Acc: 0.980 Test Loss: 0.085 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9166131019592285
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2153704166412354
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.072 Vali Acc: 0.985 Test Loss: 0.072 Test Acc: 0.985
Validation loss decreased (-0.985375 --> -0.985375).  Saving model ...
Epoch: 24 cost time: 2.2021484375
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.087 Vali Acc: 0.982 Test Loss: 0.087 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2319369316101074
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.213440418243408
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.079 Vali Acc: 0.985 Test Loss: 0.079 Test Acc: 0.985
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1547179222106934
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.985 Test Loss: 0.086 Test Acc: 0.985
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1817731857299805
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.075 Vali Acc: 0.986 Test Loss: 0.075 Test Acc: 0.986
Validation loss decreased (-0.985375 --> -0.986072).  Saving model ...
Epoch: 29 cost time: 1.877000093460083
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.040057420730591
Epoch: 30, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.098 Vali Acc: 0.981 Test Loss: 0.098 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.1576833724975586
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.7862403392791748
Epoch: 32, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.096 Vali Acc: 0.982 Test Loss: 0.096 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.044996976852417
Epoch: 33, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.122337579727173
Epoch: 34, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.084 Vali Acc: 0.982 Test Loss: 0.084 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.0698018074035645
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.080 Vali Acc: 0.983 Test Loss: 0.080 Test Acc: 0.983
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.1218953132629395
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.082 Vali Acc: 0.985 Test Loss: 0.082 Test Acc: 0.985
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.0586514472961426
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.985 Test Loss: 0.081 Test Acc: 0.985
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.9961998462677002
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.081 Vali Acc: 0.986 Test Loss: 0.081 Test Acc: 0.986
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9860724233983287
model parameter : 50326
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.412498712539673
Epoch: 1, Steps: 89 | Train Loss: 2.563 Vali Loss: 1.783 Vali Acc: 0.673 Test Loss: 1.783 Test Acc: 0.673
Validation loss decreased (inf --> -0.672684).  Saving model ...
Epoch: 2 cost time: 2.258136749267578
Epoch: 2, Steps: 89 | Train Loss: 1.162 Vali Loss: 0.751 Vali Acc: 0.855 Test Loss: 0.751 Test Acc: 0.855
Validation loss decreased (-0.672684 --> -0.855146).  Saving model ...
Epoch: 3 cost time: 2.3281631469726562
Epoch: 3, Steps: 89 | Train Loss: 0.566 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
Validation loss decreased (-0.855146 --> -0.895539).  Saving model ...
Epoch: 4 cost time: 1.996807336807251
Epoch: 4, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.322 Vali Acc: 0.925 Test Loss: 0.322 Test Acc: 0.925
Validation loss decreased (-0.895539 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 1.9882142543792725
Epoch: 5, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.239 Vali Acc: 0.947 Test Loss: 0.239 Test Acc: 0.947
Validation loss decreased (-0.924788 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 2.34549880027771
Epoch: 6, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.196 Vali Acc: 0.958 Test Loss: 0.196 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.958215).  Saving model ...
Epoch: 7 cost time: 1.912700891494751
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.958215 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 2.2780649662017822
Epoch: 8, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 2.2768921852111816
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0204100608825684
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966573).  Saving model ...
Epoch: 11 cost time: 2.271021842956543
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.127 Vali Acc: 0.964 Test Loss: 0.127 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3945975303649902
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 1.792280912399292
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.972 Test Loss: 0.118 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 14 cost time: 2.533182144165039
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.972144 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 2.124180316925049
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0130248069763184
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979108).  Saving model ...
Epoch: 17 cost time: 2.1978893280029297
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.200387477874756
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.099 Vali Acc: 0.974 Test Loss: 0.099 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.023752450942993
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1588613986968994
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4749319553375244
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.100 Vali Acc: 0.976 Test Loss: 0.100 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.371643543243408
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.121 Vali Acc: 0.964 Test Loss: 0.121 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1562647819519043
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.979 Test Loss: 0.104 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.349902868270874
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.101 Vali Acc: 0.981 Test Loss: 0.101 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.981197).  Saving model ...
Epoch: 25 cost time: 2.08933424949646
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.092 Vali Acc: 0.982 Test Loss: 0.092 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 26 cost time: 2.348790168762207
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 27 cost time: 2.432835340499878
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.096 Vali Acc: 0.981 Test Loss: 0.096 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.238734722137451
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.406259775161743
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.397228956222534
Epoch: 30, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.976 Test Loss: 0.125 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.0783793926239014
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.083927631378174
Epoch: 32, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.0872135162353516
Epoch: 33, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.9089152812957764
Epoch: 34, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7945373058319092
Epoch: 35, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.1636383533477783
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 49454
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.4863510131835938
Epoch: 1, Steps: 89 | Train Loss: 2.501 Vali Loss: 1.733 Vali Acc: 0.703 Test Loss: 1.733 Test Acc: 0.703
Validation loss decreased (inf --> -0.702629).  Saving model ...
Epoch: 2 cost time: 1.9097824096679688
Epoch: 2, Steps: 89 | Train Loss: 1.110 Vali Loss: 0.722 Vali Acc: 0.857 Test Loss: 0.722 Test Acc: 0.857
Validation loss decreased (-0.702629 --> -0.857235).  Saving model ...
Epoch: 3 cost time: 2.0414280891418457
Epoch: 3, Steps: 89 | Train Loss: 0.518 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
Validation loss decreased (-0.857235 --> -0.900414).  Saving model ...
Epoch: 4 cost time: 2.2449963092803955
Epoch: 4, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.242 Vali Acc: 0.945 Test Loss: 0.242 Test Acc: 0.945
Validation loss decreased (-0.900414 --> -0.944984).  Saving model ...
Epoch: 5 cost time: 2.632207155227661
Epoch: 5, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.944984 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 2.6842644214630127
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2127747535705566
Epoch: 7, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 2.265613555908203
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.115 Vali Acc: 0.969 Test Loss: 0.115 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 2.428114891052246
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 2.0299978256225586
Epoch: 10, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 2.876354455947876
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7646214962005615
Epoch: 12, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.086 Vali Acc: 0.977 Test Loss: 0.086 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977019).  Saving model ...
Epoch: 13 cost time: 2.195892095565796
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.100 Vali Acc: 0.974 Test Loss: 0.100 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.339200258255005
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.088 Vali Acc: 0.974 Test Loss: 0.088 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.187246322631836
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.080 Vali Acc: 0.978 Test Loss: 0.080 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 2.0102500915527344
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.077 Vali Acc: 0.981 Test Loss: 0.077 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980501).  Saving model ...
Epoch: 17 cost time: 2.1229958534240723
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.091 Vali Acc: 0.978 Test Loss: 0.091 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1454808712005615
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.089 Vali Acc: 0.977 Test Loss: 0.089 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0353996753692627
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.4458022117614746
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.087 Vali Acc: 0.981 Test Loss: 0.087 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5965640544891357
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5863146781921387
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.4299256801605225
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.095 Vali Acc: 0.978 Test Loss: 0.095 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1312434673309326
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.105 Vali Acc: 0.979 Test Loss: 0.105 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.922081470489502
Epoch: 25, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.8184821605682373
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 50120
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.648571252822876
Epoch: 1, Steps: 89 | Train Loss: 2.436 Vali Loss: 1.684 Vali Acc: 0.698 Test Loss: 1.684 Test Acc: 0.698
Validation loss decreased (inf --> -0.698451).  Saving model ...
Epoch: 2 cost time: 2.3203630447387695
Epoch: 2, Steps: 89 | Train Loss: 1.100 Vali Loss: 0.741 Vali Acc: 0.827 Test Loss: 0.741 Test Acc: 0.827
Validation loss decreased (-0.698451 --> -0.826594).  Saving model ...
Epoch: 3 cost time: 3.0413618087768555
Epoch: 3, Steps: 89 | Train Loss: 0.543 Vali Loss: 0.452 Vali Acc: 0.893 Test Loss: 0.452 Test Acc: 0.893
Validation loss decreased (-0.826594 --> -0.892753).  Saving model ...
Epoch: 4 cost time: 2.722515106201172
Epoch: 4, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.892753 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 2.175992488861084
Epoch: 5, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
Validation loss decreased (-0.926181 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 3.057960271835327
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
Validation loss decreased (-0.951251 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 2.4200620651245117
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
Validation loss decreased (-0.957519 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 2.2857489585876465
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.965876 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 2.348769426345825
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.232978582382202
Epoch: 10, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 2.1849119663238525
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.107 Vali Acc: 0.971 Test Loss: 0.107 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5976760387420654
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2624852657318115
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.101 Vali Acc: 0.971 Test Loss: 0.101 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.705587863922119
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.093 Vali Acc: 0.974 Test Loss: 0.093 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3157105445861816
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.8254597187042236
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0638177394866943
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0896193981170654
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.1302599906921387
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.097 Vali Acc: 0.977 Test Loss: 0.097 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.4085447788238525
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.096 Vali Acc: 0.976 Test Loss: 0.096 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm64_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 50074
model size : 0.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs91_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.184818983078003
Epoch: 1, Steps: 89 | Train Loss: 2.493 Vali Loss: 1.721 Vali Acc: 0.714 Test Loss: 1.721 Test Acc: 0.714
Validation loss decreased (inf --> -0.713771).  Saving model ...
Epoch: 2 cost time: 2.417322874069214
Epoch: 2, Steps: 89 | Train Loss: 1.115 Vali Loss: 0.727 Vali Acc: 0.845 Test Loss: 0.727 Test Acc: 0.845
Validation loss decreased (-0.713771 --> -0.845397).  Saving model ...
Epoch: 3 cost time: 1.8827686309814453
Epoch: 3, Steps: 89 | Train Loss: 0.542 Vali Loss: 0.451 Vali Acc: 0.901 Test Loss: 0.451 Test Acc: 0.901
Validation loss decreased (-0.845397 --> -0.901110).  Saving model ...
Epoch: 4 cost time: 2.4740662574768066
Epoch: 4, Steps: 89 | Train Loss: 0.345 Vali Loss: 0.308 Vali Acc: 0.934 Test Loss: 0.308 Test Acc: 0.934
Validation loss decreased (-0.901110 --> -0.933841).  Saving model ...
Epoch: 5 cost time: 2.1935007572174072
Epoch: 5, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.242 Vali Acc: 0.946 Test Loss: 0.242 Test Acc: 0.946
Validation loss decreased (-0.933841 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 2.045146942138672
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.945680 --> -0.948466).  Saving model ...
Epoch: 7 cost time: 2.103503704071045
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.948466 --> -0.956126).  Saving model ...
Epoch: 8 cost time: 1.9810948371887207
Epoch: 8, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
Validation loss decreased (-0.956126 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 1.946984052658081
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 1.9730002880096436
Epoch: 10, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1413166522979736
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 1.989943027496338
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1639339923858643
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.970 Test Loss: 0.115 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.968489408493042
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.977 Test Loss: 0.104 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6045775413513184
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9297826290130615
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 2.0974364280700684
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3563873767852783
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.213974714279175
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.104 Vali Acc: 0.981 Test Loss: 0.104 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 20 cost time: 2.260011911392212
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2780508995056152
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.980500).  Saving model ...
Epoch: 22 cost time: 1.9939332008361816
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.10457181930542
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.374479055404663
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.134 Vali Acc: 0.975 Test Loss: 0.134 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9747662544250488
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.191270351409912
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.3880441188812256
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.1130082607269287
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9401791095733643
Epoch: 29, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.1624724864959717
Epoch: 30, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.957 Test Loss: 0.218 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7730023860931396
Epoch: 31, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.168 Vali Acc: 0.973 Test Loss: 0.168 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs91_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 47082
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs61_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.04792332649231
Epoch: 1, Steps: 89 | Train Loss: 2.527 Vali Loss: 1.755 Vali Acc: 0.706 Test Loss: 1.755 Test Acc: 0.706
Validation loss decreased (inf --> -0.706111).  Saving model ...
Epoch: 2 cost time: 2.390471935272217
Epoch: 2, Steps: 89 | Train Loss: 1.151 Vali Loss: 0.750 Vali Acc: 0.836 Test Loss: 0.750 Test Acc: 0.836
Validation loss decreased (-0.706111 --> -0.835647).  Saving model ...
Epoch: 3 cost time: 2.4770872592926025
Epoch: 3, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.447 Vali Acc: 0.898 Test Loss: 0.447 Test Acc: 0.898
Validation loss decreased (-0.835647 --> -0.898324).  Saving model ...
Epoch: 4 cost time: 2.3905653953552246
Epoch: 4, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.316 Vali Acc: 0.921 Test Loss: 0.316 Test Acc: 0.921
Validation loss decreased (-0.898324 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 2.4860382080078125
Epoch: 5, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.214 Vali Acc: 0.960 Test Loss: 0.214 Test Acc: 0.960
Validation loss decreased (-0.921306 --> -0.960304).  Saving model ...
Epoch: 6 cost time: 2.2921841144561768
Epoch: 6, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
Validation loss decreased (-0.960304 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 2.3520145416259766
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.966572).  Saving model ...
Epoch: 8 cost time: 1.9779818058013916
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
Validation loss decreased (-0.966572 --> -0.975625).  Saving model ...
Epoch: 9 cost time: 2.1990365982055664
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1861166954040527
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 2.4167187213897705
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 1.9946699142456055
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.101 Vali Acc: 0.980 Test Loss: 0.101 Test Acc: 0.980
Validation loss decreased (-0.977715 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 2.223602294921875
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.551985025405884
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.238743305206299
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.404285430908203
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
Validation loss decreased (-0.979804 --> -0.979804).  Saving model ...
Epoch: 17 cost time: 2.438957691192627
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.346177816390991
Epoch: 18, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.981 Test Loss: 0.093 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 19 cost time: 2.448017120361328
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.098 Vali Acc: 0.977 Test Loss: 0.098 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.6378142833709717
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.092 Vali Acc: 0.979 Test Loss: 0.092 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0921576023101807
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.094 Vali Acc: 0.980 Test Loss: 0.094 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.309136390686035
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.094 Vali Acc: 0.979 Test Loss: 0.094 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1423707008361816
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.092 Vali Acc: 0.981 Test Loss: 0.092 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 1.885301113128662
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.4095685482025146
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.773967981338501
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.086 Vali Acc: 0.982 Test Loss: 0.086 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 27 cost time: 2.8104138374328613
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8427789211273193
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8093643188476562
Epoch: 29, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.179 Vali Acc: 0.962 Test Loss: 0.179 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.321166753768921
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.4352715015411377
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.3635551929473877
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.3225061893463135
Epoch: 33, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.094 Vali Acc: 0.983 Test Loss: 0.094 Test Acc: 0.983
Validation loss decreased (-0.981893 --> -0.982590).  Saving model ...
Epoch: 34 cost time: 2.187451124191284
Epoch: 34, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.093 Vali Acc: 0.983 Test Loss: 0.093 Test Acc: 0.983
Validation loss decreased (-0.982590 --> -0.983286).  Saving model ...
Epoch: 35 cost time: 2.2282040119171143
Epoch: 35, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.9769980907440186
Epoch: 36, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.1949284076690674
Epoch: 37, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.0122902393341064
Epoch: 38, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9715979099273682
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.33191180229187
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.403764009475708
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.4222562313079834
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.6307530403137207
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.104 Vali Acc: 0.980 Test Loss: 0.104 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.0906825065612793
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.105 Vali Acc: 0.981 Test Loss: 0.105 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs61_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 46798
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs46_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.578599452972412
Epoch: 1, Steps: 89 | Train Loss: 2.529 Vali Loss: 1.776 Vali Acc: 0.661 Test Loss: 1.776 Test Acc: 0.661
Validation loss decreased (inf --> -0.660846).  Saving model ...
Epoch: 2 cost time: 2.2939465045928955
Epoch: 2, Steps: 89 | Train Loss: 1.148 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
Validation loss decreased (-0.660846 --> -0.832862).  Saving model ...
Epoch: 3 cost time: 1.8854279518127441
Epoch: 3, Steps: 89 | Train Loss: 0.559 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
Validation loss decreased (-0.832862 --> -0.889271).  Saving model ...
Epoch: 4 cost time: 2.1918554306030273
Epoch: 4, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.337 Vali Acc: 0.920 Test Loss: 0.337 Test Acc: 0.920
Validation loss decreased (-0.889271 --> -0.919913).  Saving model ...
Epoch: 5 cost time: 2.0514862537384033
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.265 Vali Acc: 0.934 Test Loss: 0.265 Test Acc: 0.934
Validation loss decreased (-0.919913 --> -0.933841).  Saving model ...
Epoch: 6 cost time: 2.331068515777588
Epoch: 6, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.201 Vali Acc: 0.953 Test Loss: 0.201 Test Acc: 0.953
Validation loss decreased (-0.933841 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 2.0236270427703857
Epoch: 7, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.959608).  Saving model ...
Epoch: 8 cost time: 2.4305520057678223
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 2.5741682052612305
Epoch: 9, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 2.014225482940674
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 2.1542627811431885
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.529359817504883
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.049511671066284
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973537).  Saving model ...
Epoch: 14 cost time: 2.375384569168091
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.340627670288086
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.110 Vali Acc: 0.973 Test Loss: 0.110 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.124791383743286
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
Validation loss decreased (-0.973537 --> -0.974929).  Saving model ...
Epoch: 17 cost time: 2.3901634216308594
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.099 Vali Acc: 0.979 Test Loss: 0.099 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979108).  Saving model ...
Epoch: 18 cost time: 2.420421600341797
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7782156467437744
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3144233226776123
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.098 Vali Acc: 0.979 Test Loss: 0.098 Test Acc: 0.979
Validation loss decreased (-0.979108 --> -0.979108).  Saving model ...
Epoch: 21 cost time: 2.2818565368652344
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0590429306030273
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3130691051483154
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.979108 --> -0.980500).  Saving model ...
Epoch: 24 cost time: 1.9357318878173828
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2162702083587646
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.3628437519073486
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.321265459060669
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.1725680828094482
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.923154354095459
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.2301294803619385
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.1659533977508545
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.3572838306427
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.127 Vali Acc: 0.977 Test Loss: 0.127 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3041858673095703
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs46_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 46758
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs37_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5317859649658203
Epoch: 1, Steps: 89 | Train Loss: 2.527 Vali Loss: 1.752 Vali Acc: 0.695 Test Loss: 1.752 Test Acc: 0.695
Validation loss decreased (inf --> -0.694969).  Saving model ...
Epoch: 2 cost time: 2.07555890083313
Epoch: 2, Steps: 89 | Train Loss: 1.142 Vali Loss: 0.739 Vali Acc: 0.844 Test Loss: 0.739 Test Acc: 0.844
Validation loss decreased (-0.694969 --> -0.844004).  Saving model ...
Epoch: 3 cost time: 1.8131253719329834
Epoch: 3, Steps: 89 | Train Loss: 0.554 Vali Loss: 0.461 Vali Acc: 0.886 Test Loss: 0.461 Test Acc: 0.886
Validation loss decreased (-0.844004 --> -0.885789).  Saving model ...
Epoch: 4 cost time: 2.4254767894744873
Epoch: 4, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.885789 --> -0.922002).  Saving model ...
Epoch: 5 cost time: 2.226872682571411
Epoch: 5, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.235 Vali Acc: 0.947 Test Loss: 0.235 Test Acc: 0.947
Validation loss decreased (-0.922002 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 2.169053792953491
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
Validation loss decreased (-0.947073 --> -0.958215).  Saving model ...
Epoch: 7 cost time: 2.1643433570861816
Epoch: 7, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
Validation loss decreased (-0.958215 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 2.2288150787353516
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 1.7241885662078857
Epoch: 9, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.149 Vali Acc: 0.965 Test Loss: 0.149 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.114851236343384
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 1.7652549743652344
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.137 Vali Acc: 0.965 Test Loss: 0.137 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0619466304779053
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 2.3016698360443115
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.696021318435669
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9897136688232422
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.996225357055664
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.850799798965454
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2098934650421143
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9638195037841797
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9915988445281982
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.1930675506591797
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.1076607704162598
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs37_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 46818
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs31_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.483365774154663
Epoch: 1, Steps: 89 | Train Loss: 2.541 Vali Loss: 1.742 Vali Acc: 0.682 Test Loss: 1.742 Test Acc: 0.682
Validation loss decreased (inf --> -0.682434).  Saving model ...
Epoch: 2 cost time: 2.4690072536468506
Epoch: 2, Steps: 89 | Train Loss: 1.132 Vali Loss: 0.741 Vali Acc: 0.847 Test Loss: 0.741 Test Acc: 0.847
Validation loss decreased (-0.682434 --> -0.847486).  Saving model ...
Epoch: 3 cost time: 2.105548620223999
Epoch: 3, Steps: 89 | Train Loss: 0.556 Vali Loss: 0.460 Vali Acc: 0.891 Test Loss: 0.460 Test Acc: 0.891
Validation loss decreased (-0.847486 --> -0.890664).  Saving model ...
Epoch: 4 cost time: 2.2815592288970947
Epoch: 4, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.327 Vali Acc: 0.924 Test Loss: 0.327 Test Acc: 0.924
Validation loss decreased (-0.890664 --> -0.924091).  Saving model ...
Epoch: 5 cost time: 2.239164113998413
Epoch: 5, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.234 Vali Acc: 0.953 Test Loss: 0.234 Test Acc: 0.953
Validation loss decreased (-0.924091 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 1.8558201789855957
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.1768574714660645
Epoch: 7, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.165 Vali Acc: 0.963 Test Loss: 0.165 Test Acc: 0.963
Validation loss decreased (-0.961001 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 2.2801103591918945
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
Validation loss decreased (-0.963090 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.150493621826172
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.140 Vali Acc: 0.967 Test Loss: 0.140 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1788604259490967
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 2.1505324840545654
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 1.9793083667755127
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 2.056060314178467
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.069423198699951
Epoch: 14, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.108067274093628
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.507140874862671
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.177678346633911
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0199460983276367
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3350205421447754
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 2.0837972164154053
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 1.91567063331604
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4362120628356934
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.001987934112549
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 24 cost time: 2.160848379135132
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.119 Vali Acc: 0.980 Test Loss: 0.119 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.1098532676696777
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.131 Vali Acc: 0.975 Test Loss: 0.131 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.029587745666504
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.416471481323242
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.300798177719116
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.116 Vali Acc: 0.978 Test Loss: 0.116 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.008387327194214
Epoch: 29, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.321364402770996
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.9693572521209717
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.121 Vali Acc: 0.979 Test Loss: 0.121 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9038491249084473
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.02883243560791
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs31_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 46930
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs26_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2471132278442383
Epoch: 1, Steps: 89 | Train Loss: 2.544 Vali Loss: 1.764 Vali Acc: 0.651 Test Loss: 1.764 Test Acc: 0.651
Validation loss decreased (inf --> -0.651097).  Saving model ...
Epoch: 2 cost time: 1.8908212184906006
Epoch: 2, Steps: 89 | Train Loss: 1.141 Vali Loss: 0.750 Vali Acc: 0.849 Test Loss: 0.750 Test Acc: 0.849
Validation loss decreased (-0.651097 --> -0.848878).  Saving model ...
Epoch: 3 cost time: 2.218036413192749
Epoch: 3, Steps: 89 | Train Loss: 0.570 Vali Loss: 0.481 Vali Acc: 0.886 Test Loss: 0.481 Test Acc: 0.886
Validation loss decreased (-0.848878 --> -0.886485).  Saving model ...
Epoch: 4 cost time: 1.8826642036437988
Epoch: 4, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
Validation loss decreased (-0.886485 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 1.9283862113952637
Epoch: 5, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.265 Vali Acc: 0.942 Test Loss: 0.265 Test Acc: 0.942
Validation loss decreased (-0.919217 --> -0.942198).  Saving model ...
Epoch: 6 cost time: 2.2423436641693115
Epoch: 6, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
Validation loss decreased (-0.942198 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 2.156609296798706
Epoch: 7, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
Validation loss decreased (-0.955430 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.1029248237609863
Epoch: 8, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 2.3567631244659424
Epoch: 9, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.966572 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 2.138347625732422
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
Validation loss decreased (-0.970054 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 2.2138471603393555
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.133 Vali Acc: 0.972 Test Loss: 0.133 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4174327850341797
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 2.169647455215454
Epoch: 13, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0098631381988525
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 15 cost time: 1.9733645915985107
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 1.7489302158355713
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0532867908477783
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9911997318267822
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9437882900238037
Epoch: 19, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 20 cost time: 1.9829308986663818
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7459831237792969
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8763749599456787
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9387271404266357
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.791853904724121
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 25 cost time: 2.1710164546966553
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.973 Test Loss: 0.137 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.3555760383605957
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.2877962589263916
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.435572385787964
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.676567554473877
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 30 cost time: 2.1932239532470703
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.603789806365967
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1667542457580566
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.876678705215454
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.117 Vali Acc: 0.979 Test Loss: 0.117 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.992393970489502
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.116 Vali Acc: 0.979 Test Loss: 0.116 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.964585781097412
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.117 Vali Acc: 0.981 Test Loss: 0.117 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9474210739135742
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.2693543434143066
Epoch: 37, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.981 Test Loss: 0.122 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.0834083557128906
Epoch: 38, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981197).  Saving model ...
Epoch: 39 cost time: 2.0217881202697754
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.309448719024658
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.4128916263580322
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.9240148067474365
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.979 Test Loss: 0.124 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.0693585872650146
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.9721548557281494
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.980 Test Loss: 0.128 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.967552661895752
Epoch: 45, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.9324331283569336
Epoch: 46, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.288034677505493
Epoch: 47, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.0041935443878174
Epoch: 48, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.979 Test Loss: 0.131 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs26_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 46152
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs23_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.682825803756714
Epoch: 1, Steps: 89 | Train Loss: 2.394 Vali Loss: 1.642 Vali Acc: 0.737 Test Loss: 1.642 Test Acc: 0.737
Validation loss decreased (inf --> -0.736752).  Saving model ...
Epoch: 2 cost time: 2.3627865314483643
Epoch: 2, Steps: 89 | Train Loss: 1.069 Vali Loss: 0.713 Vali Acc: 0.842 Test Loss: 0.713 Test Acc: 0.842
Validation loss decreased (-0.736752 --> -0.841915).  Saving model ...
Epoch: 3 cost time: 2.0947954654693604
Epoch: 3, Steps: 89 | Train Loss: 0.529 Vali Loss: 0.431 Vali Acc: 0.898 Test Loss: 0.431 Test Acc: 0.898
Validation loss decreased (-0.841915 --> -0.897628).  Saving model ...
Epoch: 4 cost time: 2.2984883785247803
Epoch: 4, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.309 Vali Acc: 0.928 Test Loss: 0.309 Test Acc: 0.928
Validation loss decreased (-0.897628 --> -0.927574).  Saving model ...
Epoch: 5 cost time: 2.3275036811828613
Epoch: 5, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.257 Vali Acc: 0.939 Test Loss: 0.257 Test Acc: 0.939
Validation loss decreased (-0.927574 --> -0.939412).  Saving model ...
Epoch: 6 cost time: 2.1545748710632324
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.193 Vali Acc: 0.961 Test Loss: 0.193 Test Acc: 0.961
Validation loss decreased (-0.939412 --> -0.961001).  Saving model ...
Epoch: 7 cost time: 2.4412412643432617
Epoch: 7, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.167 Vali Acc: 0.960 Test Loss: 0.167 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.5134410858154297
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.063753128051758
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.81103515625
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
Validation loss decreased (-0.967269 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 2.2525899410247803
Epoch: 11, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 2.414885997772217
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.112 Vali Acc: 0.977 Test Loss: 0.112 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 2.147113561630249
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.848088264465332
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 2.100881814956665
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3267102241516113
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.103 Vali Acc: 0.981 Test Loss: 0.103 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 17 cost time: 2.137575149536133
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.962 Test Loss: 0.135 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6036510467529297
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.2734017372131348
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.101 Vali Acc: 0.979 Test Loss: 0.101 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.416459798812866
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.103 Vali Acc: 0.978 Test Loss: 0.103 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5228748321533203
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.096 Vali Acc: 0.983 Test Loss: 0.096 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 22 cost time: 2.0983893871307373
Epoch: 22, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3546013832092285
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.097 Vali Acc: 0.982 Test Loss: 0.097 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3214035034179688
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.42384672164917
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.982 Test Loss: 0.106 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1957550048828125
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.2906761169433594
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9381532669067383
Epoch: 28, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.0840654373168945
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.8898828029632568
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.3815722465515137
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.110 Vali Acc: 0.982 Test Loss: 0.110 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs23_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 46502
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs21_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.439746856689453
Epoch: 1, Steps: 89 | Train Loss: 2.545 Vali Loss: 1.752 Vali Acc: 0.690 Test Loss: 1.752 Test Acc: 0.690
Validation loss decreased (inf --> -0.690094).  Saving model ...
Epoch: 2 cost time: 1.8164618015289307
Epoch: 2, Steps: 89 | Train Loss: 1.148 Vali Loss: 0.755 Vali Acc: 0.851 Test Loss: 0.755 Test Acc: 0.851
Validation loss decreased (-0.690094 --> -0.850967).  Saving model ...
Epoch: 3 cost time: 2.013946056365967
Epoch: 3, Steps: 89 | Train Loss: 0.561 Vali Loss: 0.469 Vali Acc: 0.888 Test Loss: 0.469 Test Acc: 0.888
Validation loss decreased (-0.850967 --> -0.887878).  Saving model ...
Epoch: 4 cost time: 2.270181655883789
Epoch: 4, Steps: 89 | Train Loss: 0.366 Vali Loss: 0.337 Vali Acc: 0.921 Test Loss: 0.337 Test Acc: 0.921
Validation loss decreased (-0.887878 --> -0.921306).  Saving model ...
Epoch: 5 cost time: 1.8458874225616455
Epoch: 5, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.258 Vali Acc: 0.947 Test Loss: 0.258 Test Acc: 0.947
Validation loss decreased (-0.921306 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 2.2286550998687744
Epoch: 6, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.216 Vali Acc: 0.951 Test Loss: 0.216 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 2.2260191440582275
Epoch: 7, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
Validation loss decreased (-0.951251 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 2.070434808731079
Epoch: 8, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 2.254657745361328
Epoch: 9, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.968661).  Saving model ...
Epoch: 10 cost time: 1.963240385055542
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0540432929992676
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.138 Vali Acc: 0.970 Test Loss: 0.138 Test Acc: 0.970
Validation loss decreased (-0.968661 --> -0.970054).  Saving model ...
Epoch: 12 cost time: 1.9870750904083252
Epoch: 12, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972144).  Saving model ...
Epoch: 13 cost time: 2.061447858810425
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8324525356292725
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.3558783531188965
Epoch: 15, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.102 Vali Acc: 0.974 Test Loss: 0.102 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.050393581390381
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1554267406463623
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.4621095657348633
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 2.1462442874908447
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.204057455062866
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4959120750427246
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.809844732284546
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.394132375717163
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.110 Vali Acc: 0.977 Test Loss: 0.110 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 24 cost time: 2.191925525665283
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0882339477539062
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9758427143096924
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.095963478088379
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.737781286239624
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.883723497390747
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.873605489730835
Epoch: 30, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.7643346786499023
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.111 Vali Acc: 0.979 Test Loss: 0.111 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979108).  Saving model ...
Epoch: 32 cost time: 2.0005040168762207
Epoch: 32, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.940032720565796
Epoch: 33, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.087806463241577
Epoch: 34, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.4042649269104004
Epoch: 35, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.111879825592041
Epoch: 36, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.980 Test Loss: 0.123 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 37 cost time: 1.974104642868042
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 38 cost time: 2.7846689224243164
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.982 Test Loss: 0.122 Test Acc: 0.982
Validation loss decreased (-0.981197 --> -0.981893).  Saving model ...
Epoch: 39 cost time: 2.05055570602417
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.1911964416503906
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.3220715522766113
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.982 Test Loss: 0.124 Test Acc: 0.982
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.005986452102661
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.125 Vali Acc: 0.982 Test Loss: 0.125 Test Acc: 0.982
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.7475810050964355
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.44821834564209
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.15773868560791
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.127 Vali Acc: 0.981 Test Loss: 0.127 Test Acc: 0.981
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.919135808944702
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.343923330307007
Epoch: 47, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.598601818084717
Epoch: 48, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs21_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 47418
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs19_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.180001974105835
Epoch: 1, Steps: 89 | Train Loss: 2.494 Vali Loss: 1.720 Vali Acc: 0.670 Test Loss: 1.720 Test Acc: 0.670
Validation loss decreased (inf --> -0.669899).  Saving model ...
Epoch: 2 cost time: 1.9039676189422607
Epoch: 2, Steps: 89 | Train Loss: 1.123 Vali Loss: 0.737 Vali Acc: 0.845 Test Loss: 0.737 Test Acc: 0.845
Validation loss decreased (-0.669899 --> -0.845397).  Saving model ...
Epoch: 3 cost time: 2.390141487121582
Epoch: 3, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.469 Vali Acc: 0.883 Test Loss: 0.469 Test Acc: 0.883
Validation loss decreased (-0.845397 --> -0.883004).  Saving model ...
Epoch: 4 cost time: 2.1567392349243164
Epoch: 4, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.318 Vali Acc: 0.928 Test Loss: 0.318 Test Acc: 0.928
Validation loss decreased (-0.883004 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 2.135693073272705
Epoch: 5, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.928270 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 2.531337261199951
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.195 Vali Acc: 0.957 Test Loss: 0.195 Test Acc: 0.957
Validation loss decreased (-0.948466 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 2.3068437576293945
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
Validation loss decreased (-0.956823 --> -0.960305).  Saving model ...
Epoch: 8 cost time: 2.3326737880706787
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 2.2886576652526855
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 2.17337965965271
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.135 Vali Acc: 0.973 Test Loss: 0.135 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 2.1002888679504395
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.128 Vali Acc: 0.974 Test Loss: 0.128 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 12 cost time: 1.9999186992645264
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 2.2734899520874023
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 1.941554307937622
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.319208860397339
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4535388946533203
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.210448980331421
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9684321880340576
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.1060140132904053
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.8055570125579834
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.926858901977539
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.629770040512085
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.407888889312744
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.113 Vali Acc: 0.980 Test Loss: 0.113 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979804).  Saving model ...
Epoch: 24 cost time: 1.794236421585083
Epoch: 24, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.204 Vali Acc: 0.961 Test Loss: 0.204 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.445589303970337
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.122 Vali Acc: 0.976 Test Loss: 0.122 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9522716999053955
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.28044056892395
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2378196716308594
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.009821653366089
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.112 Vali Acc: 0.979 Test Loss: 0.112 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.0070571899414062
Epoch: 30, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.110 Vali Acc: 0.979 Test Loss: 0.110 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.011385202407837
Epoch: 31, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.120 Vali Acc: 0.981 Test Loss: 0.120 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 32 cost time: 1.9483561515808105
Epoch: 32, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.118 Vali Acc: 0.980 Test Loss: 0.118 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.267744779586792
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.125 Vali Acc: 0.979 Test Loss: 0.125 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0164172649383545
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.120 Vali Acc: 0.979 Test Loss: 0.120 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.0449440479278564
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.926039457321167
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.119 Vali Acc: 0.979 Test Loss: 0.119 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0198113918304443
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.980 Test Loss: 0.121 Test Acc: 0.980
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.18217134475708
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.120 Vali Acc: 0.982 Test Loss: 0.120 Test Acc: 0.982
Validation loss decreased (-0.980500 --> -0.981893).  Saving model ...
Epoch: 39 cost time: 2.244483709335327
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.096830368041992
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.124 Vali Acc: 0.980 Test Loss: 0.124 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.4306087493896484
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.980 Test Loss: 0.126 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.7909510135650635
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.124311923980713
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.788661241531372
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.0253069400787354
Epoch: 45, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.979 Test Loss: 0.129 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.018637180328369
Epoch: 46, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.981 Test Loss: 0.132 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.77716064453125
Epoch: 47, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.980 Test Loss: 0.130 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8099911212921143
Epoch: 48, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.132 Vali Acc: 0.980 Test Loss: 0.132 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs19_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 47610
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs17_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2536816596984863
Epoch: 1, Steps: 89 | Train Loss: 2.579 Vali Loss: 1.805 Vali Acc: 0.673 Test Loss: 1.805 Test Acc: 0.673
Validation loss decreased (inf --> -0.673380).  Saving model ...
Epoch: 2 cost time: 1.9525105953216553
Epoch: 2, Steps: 89 | Train Loss: 1.166 Vali Loss: 0.761 Vali Acc: 0.860 Test Loss: 0.761 Test Acc: 0.860
Validation loss decreased (-0.673380 --> -0.860020).  Saving model ...
Epoch: 3 cost time: 1.9255321025848389
Epoch: 3, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.482 Vali Acc: 0.886 Test Loss: 0.482 Test Acc: 0.886
Validation loss decreased (-0.860020 --> -0.885789).  Saving model ...
Epoch: 4 cost time: 2.1671977043151855
Epoch: 4, Steps: 89 | Train Loss: 0.371 Vali Loss: 0.333 Vali Acc: 0.923 Test Loss: 0.333 Test Acc: 0.923
Validation loss decreased (-0.885789 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 1.9444143772125244
Epoch: 5, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.260 Vali Acc: 0.943 Test Loss: 0.260 Test Acc: 0.943
Validation loss decreased (-0.922699 --> -0.942894).  Saving model ...
Epoch: 6 cost time: 2.109118700027466
Epoch: 6, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.212 Vali Acc: 0.957 Test Loss: 0.212 Test Acc: 0.957
Validation loss decreased (-0.942894 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 2.0852766036987305
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.179 Vali Acc: 0.968 Test Loss: 0.179 Test Acc: 0.968
Validation loss decreased (-0.956822 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 2.2020046710968018
Epoch: 8, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.163 Vali Acc: 0.965 Test Loss: 0.163 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.098626136779785
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968661).  Saving model ...
Epoch: 10 cost time: 2.3143765926361084
Epoch: 10, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.135 Vali Acc: 0.975 Test Loss: 0.135 Test Acc: 0.975
Validation loss decreased (-0.968661 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 2.0861761569976807
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 12 cost time: 2.2515814304351807
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.128 Vali Acc: 0.972 Test Loss: 0.128 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7762913703918457
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7755780220031738
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9308910369873047
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.945601224899292
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 17 cost time: 2.168099880218506
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.117 Vali Acc: 0.974 Test Loss: 0.117 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.011078119277954
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 1.9738516807556152
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 1.9200348854064941
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.150968313217163
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8207886219024658
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.140 Vali Acc: 0.970 Test Loss: 0.140 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2385339736938477
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.981 Test Loss: 0.110 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.981197).  Saving model ...
Epoch: 24 cost time: 2.159433603286743
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0683369636535645
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.211606740951538
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.2252044677734375
Epoch: 27, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.636409044265747
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.2489326000213623
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.127924919128418
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8815898895263672
Epoch: 31, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.0590999126434326
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.128 Vali Acc: 0.979 Test Loss: 0.128 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9567453861236572
Epoch: 33, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.978 Test Loss: 0.129 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs17_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 47078
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs16_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.2836098670959473
Epoch: 1, Steps: 89 | Train Loss: 2.445 Vali Loss: 1.678 Vali Acc: 0.711 Test Loss: 1.678 Test Acc: 0.711
Validation loss decreased (inf --> -0.710986).  Saving model ...
Epoch: 2 cost time: 2.528697967529297
Epoch: 2, Steps: 89 | Train Loss: 1.100 Vali Loss: 0.741 Vali Acc: 0.838 Test Loss: 0.741 Test Acc: 0.838
Validation loss decreased (-0.710986 --> -0.838433).  Saving model ...
Epoch: 3 cost time: 1.979255199432373
Epoch: 3, Steps: 89 | Train Loss: 0.558 Vali Loss: 0.468 Vali Acc: 0.898 Test Loss: 0.468 Test Acc: 0.898
Validation loss decreased (-0.838433 --> -0.898324).  Saving model ...
Epoch: 4 cost time: 2.2518835067749023
Epoch: 4, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.346 Vali Acc: 0.919 Test Loss: 0.346 Test Acc: 0.919
Validation loss decreased (-0.898324 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 1.841050148010254
Epoch: 5, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
Validation loss decreased (-0.919217 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 1.9675488471984863
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
Validation loss decreased (-0.947073 --> -0.956822).  Saving model ...
Epoch: 7 cost time: 2.2809410095214844
Epoch: 7, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.180 Vali Acc: 0.962 Test Loss: 0.180 Test Acc: 0.962
Validation loss decreased (-0.956822 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 1.8617651462554932
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
Validation loss decreased (-0.962394 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 1.9047746658325195
Epoch: 9, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1597344875335693
Epoch: 10, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.143 Vali Acc: 0.973 Test Loss: 0.143 Test Acc: 0.973
Validation loss decreased (-0.967965 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 2.4353713989257812
Epoch: 11, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
Validation loss decreased (-0.972840 --> -0.972840).  Saving model ...
Epoch: 12 cost time: 2.6785881519317627
Epoch: 12, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9664666652679443
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 14 cost time: 1.9723267555236816
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 2.3994059562683105
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9926621913909912
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.245936393737793
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1666769981384277
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0304436683654785
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.135291576385498
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.9981110095977783
Epoch: 21, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9123194217681885
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.0964345932006836
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 24 cost time: 1.7198586463928223
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.2872111797332764
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.2540900707244873
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 27 cost time: 2.364835262298584
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 28 cost time: 1.6616320610046387
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.4451944828033447
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.5307600498199463
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.2964353561401367
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.3113226890563965
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8820927143096924
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8744893074035645
Epoch: 34, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 35 cost time: 1.9992551803588867
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8268918991088867
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3275034427642822
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.232309579849243
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.204369068145752
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.127 Vali Acc: 0.978 Test Loss: 0.127 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.554591178894043
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.281607151031494
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.041604518890381
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.3764264583587646
Epoch: 43, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.130 Vali Acc: 0.977 Test Loss: 0.130 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.903045892715454
Epoch: 44, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs16_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 48022
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs14_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 2.9611549377441406
Epoch: 1, Steps: 89 | Train Loss: 2.425 Vali Loss: 1.665 Vali Acc: 0.696 Test Loss: 1.665 Test Acc: 0.696
Validation loss decreased (inf --> -0.695666).  Saving model ...
Epoch: 2 cost time: 1.9490065574645996
Epoch: 2, Steps: 89 | Train Loss: 1.089 Vali Loss: 0.728 Vali Acc: 0.825 Test Loss: 0.728 Test Acc: 0.825
Validation loss decreased (-0.695666 --> -0.825202).  Saving model ...
Epoch: 3 cost time: 1.6294476985931396
Epoch: 3, Steps: 89 | Train Loss: 0.541 Vali Loss: 0.440 Vali Acc: 0.900 Test Loss: 0.440 Test Acc: 0.900
Validation loss decreased (-0.825202 --> -0.900413).  Saving model ...
Epoch: 4 cost time: 1.955221176147461
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
Validation loss decreased (-0.900413 --> -0.926181).  Saving model ...
Epoch: 5 cost time: 1.839695692062378
Epoch: 5, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.926181 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 1.7530031204223633
Epoch: 6, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.193 Vali Acc: 0.959 Test Loss: 0.193 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 7 cost time: 1.9739189147949219
Epoch: 7, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963090).  Saving model ...
Epoch: 8 cost time: 1.7685456275939941
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.160 Vali Acc: 0.965 Test Loss: 0.160 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 1.9022626876831055
Epoch: 9, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.968662).  Saving model ...
Epoch: 10 cost time: 1.7684662342071533
Epoch: 10, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 1.8054304122924805
Epoch: 11, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.146538257598877
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.195556879043579
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 2.137380361557007
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.13098406791687
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8291494846343994
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.0905184745788574
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 1.7190625667572021
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7620282173156738
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9941041469573975
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8834130764007568
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 22 cost time: 1.8153603076934814
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.976 Test Loss: 0.126 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.354806423187256
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.700871229171753
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0685551166534424
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.3034920692443848
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0533785820007324
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.134 Vali Acc: 0.974 Test Loss: 0.134 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9876539707183838
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7632131576538086
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.698923110961914
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8487365245819092
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs14_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 46224
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs13_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5073320865631104
Epoch: 1, Steps: 89 | Train Loss: 2.500 Vali Loss: 1.735 Vali Acc: 0.694 Test Loss: 1.735 Test Acc: 0.694
Validation loss decreased (inf --> -0.693576).  Saving model ...
Epoch: 2 cost time: 1.9960730075836182
Epoch: 2, Steps: 89 | Train Loss: 1.135 Vali Loss: 0.759 Vali Acc: 0.818 Test Loss: 0.759 Test Acc: 0.818
Validation loss decreased (-0.693576 --> -0.818238).  Saving model ...
Epoch: 3 cost time: 2.178384780883789
Epoch: 3, Steps: 89 | Train Loss: 0.562 Vali Loss: 0.474 Vali Acc: 0.893 Test Loss: 0.474 Test Acc: 0.893
Validation loss decreased (-0.818238 --> -0.892753).  Saving model ...
Epoch: 4 cost time: 1.5879120826721191
Epoch: 4, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.892753 --> -0.919217).  Saving model ...
Epoch: 5 cost time: 2.063734769821167
Epoch: 5, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.249 Vali Acc: 0.947 Test Loss: 0.249 Test Acc: 0.947
Validation loss decreased (-0.919217 --> -0.947073).  Saving model ...
Epoch: 6 cost time: 1.7668349742889404
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.951251).  Saving model ...
Epoch: 7 cost time: 2.0715599060058594
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.171 Vali Acc: 0.966 Test Loss: 0.171 Test Acc: 0.966
Validation loss decreased (-0.951251 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 2.0591251850128174
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9446613788604736
Epoch: 9, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 1.7693524360656738
Epoch: 10, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3229620456695557
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7153728008270264
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.838529348373413
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 14 cost time: 1.8728203773498535
Epoch: 14, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.126 Vali Acc: 0.970 Test Loss: 0.126 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.001354455947876
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7939245700836182
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7786221504211426
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.976 Test Loss: 0.108 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 18 cost time: 1.9432098865509033
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9334561824798584
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.342756509780884
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.012660264968872
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.248366117477417
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.3130686283111572
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.986975908279419
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 25 cost time: 1.9870097637176514
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.718346357345581
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.874298334121704
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.107 Vali Acc: 0.979 Test Loss: 0.107 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979108).  Saving model ...
Epoch: 28 cost time: 1.9038968086242676
Epoch: 28, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7138428688049316
Epoch: 29, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.108 Vali Acc: 0.980 Test Loss: 0.108 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 30 cost time: 1.8011219501495361
Epoch: 30, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.109 Vali Acc: 0.979 Test Loss: 0.109 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.3866896629333496
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.912700891494751
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.2458629608154297
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1568222045898438
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.050473928451538
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.977 Test Loss: 0.123 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.485886335372925
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.189596652984619
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.117616653442383
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.952855110168457
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs13_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 46266
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs12_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3097422122955322
Epoch: 1, Steps: 89 | Train Loss: 2.499 Vali Loss: 1.737 Vali Acc: 0.705 Test Loss: 1.737 Test Acc: 0.705
Validation loss decreased (inf --> -0.704718).  Saving model ...
Epoch: 2 cost time: 2.004824638366699
Epoch: 2, Steps: 89 | Train Loss: 1.139 Vali Loss: 0.755 Vali Acc: 0.827 Test Loss: 0.755 Test Acc: 0.827
Validation loss decreased (-0.704718 --> -0.827291).  Saving model ...
Epoch: 3 cost time: 1.7730588912963867
Epoch: 3, Steps: 89 | Train Loss: 0.568 Vali Loss: 0.467 Vali Acc: 0.888 Test Loss: 0.467 Test Acc: 0.888
Validation loss decreased (-0.827291 --> -0.887878).  Saving model ...
Epoch: 4 cost time: 1.8629281520843506
Epoch: 4, Steps: 89 | Train Loss: 0.364 Vali Loss: 0.326 Vali Acc: 0.931 Test Loss: 0.326 Test Acc: 0.931
Validation loss decreased (-0.887878 --> -0.931055).  Saving model ...
Epoch: 5 cost time: 1.9067914485931396
Epoch: 5, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.238 Vali Acc: 0.946 Test Loss: 0.238 Test Acc: 0.946
Validation loss decreased (-0.931055 --> -0.946376).  Saving model ...
Epoch: 6 cost time: 1.6967277526855469
Epoch: 6, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.188 Vali Acc: 0.958 Test Loss: 0.188 Test Acc: 0.958
Validation loss decreased (-0.946376 --> -0.957519).  Saving model ...
Epoch: 7 cost time: 1.8896806240081787
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961697).  Saving model ...
Epoch: 8 cost time: 1.6717548370361328
Epoch: 8, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.157 Vali Acc: 0.964 Test Loss: 0.157 Test Acc: 0.964
Validation loss decreased (-0.961697 --> -0.963787).  Saving model ...
Epoch: 9 cost time: 1.7027208805084229
Epoch: 9, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
Validation loss decreased (-0.963787 --> -0.965876).  Saving model ...
Epoch: 10 cost time: 2.0119729042053223
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.141 Vali Acc: 0.968 Test Loss: 0.141 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 11 cost time: 1.8552963733673096
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 2.0526540279388428
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 2.3161792755126953
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0690927505493164
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 1.9135146141052246
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.973419427871704
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.120 Vali Acc: 0.970 Test Loss: 0.120 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7071895599365234
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.125 Vali Acc: 0.966 Test Loss: 0.125 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1124963760375977
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.649160385131836
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 20 cost time: 1.5869178771972656
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2592084407806396
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8082282543182373
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.770841121673584
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.094356060028076
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9188010692596436
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9526076316833496
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.1219496726989746
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.953 Test Loss: 0.176 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.9628729820251465
Epoch: 28, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.126 Vali Acc: 0.973 Test Loss: 0.126 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9277045726776123
Epoch: 29, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs12_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 48198
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs11_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.141200065612793
Epoch: 1, Steps: 89 | Train Loss: 2.575 Vali Loss: 1.773 Vali Acc: 0.678 Test Loss: 1.773 Test Acc: 0.678
Validation loss decreased (inf --> -0.678255).  Saving model ...
Epoch: 2 cost time: 1.8122873306274414
Epoch: 2, Steps: 89 | Train Loss: 1.156 Vali Loss: 0.750 Vali Acc: 0.823 Test Loss: 0.750 Test Acc: 0.823
Validation loss decreased (-0.678255 --> -0.823112).  Saving model ...
Epoch: 3 cost time: 1.7549395561218262
Epoch: 3, Steps: 89 | Train Loss: 0.558 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.823112 --> -0.888575).  Saving model ...
Epoch: 4 cost time: 2.0660605430603027
Epoch: 4, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.327 Vali Acc: 0.925 Test Loss: 0.327 Test Acc: 0.925
Validation loss decreased (-0.888575 --> -0.924788).  Saving model ...
Epoch: 5 cost time: 1.6787831783294678
Epoch: 5, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.246 Vali Acc: 0.949 Test Loss: 0.246 Test Acc: 0.949
Validation loss decreased (-0.924788 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 1.6242249011993408
Epoch: 6, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.206 Vali Acc: 0.953 Test Loss: 0.206 Test Acc: 0.953
Validation loss decreased (-0.949162 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 1.9658136367797852
Epoch: 7, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.175 Vali Acc: 0.961 Test Loss: 0.175 Test Acc: 0.961
Validation loss decreased (-0.952644 --> -0.961001).  Saving model ...
Epoch: 8 cost time: 1.7476539611816406
Epoch: 8, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.159 Vali Acc: 0.964 Test Loss: 0.159 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.964483).  Saving model ...
Epoch: 9 cost time: 1.7933886051177979
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.169 Vali Acc: 0.958 Test Loss: 0.169 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.942397117614746
Epoch: 10, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968661).  Saving model ...
Epoch: 11 cost time: 1.9083130359649658
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 1.9786949157714844
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 13 cost time: 2.0044233798980713
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6938087940216064
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 15 cost time: 2.134843587875366
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.109 Vali Acc: 0.976 Test Loss: 0.109 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 16 cost time: 1.7720327377319336
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8304061889648438
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8406596183776855
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 19 cost time: 2.065046548843384
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.110 Vali Acc: 0.975 Test Loss: 0.110 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8160529136657715
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.115 Vali Acc: 0.975 Test Loss: 0.115 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.180945634841919
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.107 Vali Acc: 0.978 Test Loss: 0.107 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 1.7875149250030518
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.979 Test Loss: 0.102 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979108).  Saving model ...
Epoch: 23 cost time: 2.066333770751953
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0472395420074463
Epoch: 24, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0416016578674316
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.108 Vali Acc: 0.978 Test Loss: 0.108 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0421037673950195
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
Validation loss decreased (-0.979108 --> -0.979804).  Saving model ...
Epoch: 27 cost time: 2.228131055831909
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.103 Vali Acc: 0.980 Test Loss: 0.103 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.785444736480713
Epoch: 28, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.981197).  Saving model ...
Epoch: 29 cost time: 2.0515403747558594
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.107 Vali Acc: 0.981 Test Loss: 0.107 Test Acc: 0.981
Validation loss decreased (-0.981197 --> -0.981197).  Saving model ...
Epoch: 30 cost time: 1.8833670616149902
Epoch: 30, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.980 Test Loss: 0.111 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.814652681350708
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.104 Vali Acc: 0.983 Test Loss: 0.104 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 32 cost time: 2.1226806640625
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.000298261642456
Epoch: 33, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.981 Test Loss: 0.108 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9683513641357422
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.232416868209839
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.109 Vali Acc: 0.981 Test Loss: 0.109 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0592334270477295
Epoch: 36, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.108 Vali Acc: 0.983 Test Loss: 0.108 Test Acc: 0.983
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.9522275924682617
Epoch: 37, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.981 Test Loss: 0.112 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.127121686935425
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.766202449798584
Epoch: 39, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.0971574783325195
Epoch: 40, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.113 Vali Acc: 0.981 Test Loss: 0.113 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.7543919086456299
Epoch: 41, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.112 Vali Acc: 0.982 Test Loss: 0.112 Test Acc: 0.982
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs11_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 47342
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs10_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.218553304672241
Epoch: 1, Steps: 89 | Train Loss: 2.518 Vali Loss: 1.739 Vali Acc: 0.676 Test Loss: 1.739 Test Acc: 0.676
Validation loss decreased (inf --> -0.676166).  Saving model ...
Epoch: 2 cost time: 2.5624067783355713
Epoch: 2, Steps: 89 | Train Loss: 1.127 Vali Loss: 0.745 Vali Acc: 0.845 Test Loss: 0.745 Test Acc: 0.845
Validation loss decreased (-0.676166 --> -0.844700).  Saving model ...
Epoch: 3 cost time: 1.9089751243591309
Epoch: 3, Steps: 89 | Train Loss: 0.557 Vali Loss: 0.451 Vali Acc: 0.898 Test Loss: 0.451 Test Acc: 0.898
Validation loss decreased (-0.844700 --> -0.897628).  Saving model ...
Epoch: 4 cost time: 2.2108001708984375
Epoch: 4, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.897628 --> -0.933145).  Saving model ...
Epoch: 5 cost time: 1.9009389877319336
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.230 Vali Acc: 0.950 Test Loss: 0.230 Test Acc: 0.950
Validation loss decreased (-0.933145 --> -0.949858).  Saving model ...
Epoch: 6 cost time: 2.2565765380859375
Epoch: 6, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.192 Vali Acc: 0.950 Test Loss: 0.192 Test Acc: 0.950
Validation loss decreased (-0.949858 --> -0.949859).  Saving model ...
Epoch: 7 cost time: 2.3950695991516113
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
Validation loss decreased (-0.949859 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 2.0366640090942383
Epoch: 8, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 2.1471681594848633
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8178060054779053
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 2.4527738094329834
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9615135192871094
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.896343469619751
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 2.0411345958709717
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.885768175125122
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7904925346374512
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.100 Vali Acc: 0.978 Test Loss: 0.100 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3605127334594727
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.099 Vali Acc: 0.978 Test Loss: 0.099 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7631025314331055
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.095 Vali Acc: 0.977 Test Loss: 0.095 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4254186153411865
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.105 Vali Acc: 0.975 Test Loss: 0.105 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9869279861450195
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.093 Vali Acc: 0.982 Test Loss: 0.093 Test Acc: 0.982
Validation loss decreased (-0.978411 --> -0.981893).  Saving model ...
Epoch: 21 cost time: 2.0451865196228027
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.4451184272766113
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.113854169845581
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.968 Test Loss: 0.115 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.3348748683929443
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.256186008453369
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.857123851776123
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.095 Vali Acc: 0.979 Test Loss: 0.095 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.410222053527832
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.098 Vali Acc: 0.978 Test Loss: 0.098 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8535428047180176
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.109 Vali Acc: 0.977 Test Loss: 0.109 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9268798828125
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3700575828552246
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs10_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 48024
model size : 0.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                2                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs9_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.417505979537964
Epoch: 1, Steps: 89 | Train Loss: 2.507 Vali Loss: 1.717 Vali Acc: 0.716 Test Loss: 1.717 Test Acc: 0.716
Validation loss decreased (inf --> -0.715860).  Saving model ...
Epoch: 2 cost time: 2.4517555236816406
Epoch: 2, Steps: 89 | Train Loss: 1.119 Vali Loss: 0.746 Vali Acc: 0.833 Test Loss: 0.746 Test Acc: 0.833
Validation loss decreased (-0.715860 --> -0.832862).  Saving model ...
Epoch: 3 cost time: 1.9524123668670654
Epoch: 3, Steps: 89 | Train Loss: 0.558 Vali Loss: 0.462 Vali Acc: 0.888 Test Loss: 0.462 Test Acc: 0.888
Validation loss decreased (-0.832862 --> -0.887878).  Saving model ...
Epoch: 4 cost time: 2.022203207015991
Epoch: 4, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.341 Vali Acc: 0.923 Test Loss: 0.341 Test Acc: 0.923
Validation loss decreased (-0.887878 --> -0.922699).  Saving model ...
Epoch: 5 cost time: 2.0885708332061768
Epoch: 5, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.244 Vali Acc: 0.946 Test Loss: 0.244 Test Acc: 0.946
Validation loss decreased (-0.922699 --> -0.945680).  Saving model ...
Epoch: 6 cost time: 1.803727388381958
Epoch: 6, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.207 Vali Acc: 0.955 Test Loss: 0.207 Test Acc: 0.955
Validation loss decreased (-0.945680 --> -0.955430).  Saving model ...
Epoch: 7 cost time: 2.01719069480896
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7802975177764893
Epoch: 8, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.955430 --> -0.967269).  Saving model ...
Epoch: 9 cost time: 2.214503526687622
Epoch: 9, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.295327663421631
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 11 cost time: 2.344895601272583
Epoch: 11, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.686819314956665
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 13 cost time: 2.429231643676758
Epoch: 13, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 14 cost time: 2.580085277557373
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3187005519866943
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.141529083251953
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.112 Vali Acc: 0.974 Test Loss: 0.112 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6435999870300293
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 1.9159672260284424
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.099 Vali Acc: 0.977 Test Loss: 0.099 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977019).  Saving model ...
Epoch: 19 cost time: 2.163053274154663
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.095 Vali Acc: 0.975 Test Loss: 0.095 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.187537670135498
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.101 Vali Acc: 0.978 Test Loss: 0.101 Test Acc: 0.978
Validation loss decreased (-0.977019 --> -0.977715).  Saving model ...
Epoch: 21 cost time: 1.982039213180542
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.088 Vali Acc: 0.981 Test Loss: 0.088 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.980501).  Saving model ...
Epoch: 22 cost time: 2.2367641925811768
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.103 Vali Acc: 0.976 Test Loss: 0.103 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.225687026977539
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.1888136863708496
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.091 Vali Acc: 0.981 Test Loss: 0.091 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.559386730194092
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.080 Vali Acc: 0.982 Test Loss: 0.080 Test Acc: 0.982
Validation loss decreased (-0.980501 --> -0.981893).  Saving model ...
Epoch: 26 cost time: 2.103008985519409
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.6076414585113525
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.097 Vali Acc: 0.978 Test Loss: 0.097 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.669804096221924
Epoch: 28, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.086 Vali Acc: 0.981 Test Loss: 0.086 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9387319087982178
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.091 Vali Acc: 0.980 Test Loss: 0.091 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2597827911376953
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.094 Vali Acc: 0.982 Test Loss: 0.094 Test Acc: 0.982
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.777358055114746
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.095 Vali Acc: 0.974 Test Loss: 0.095 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.9178969860076904
Epoch: 32, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.100 Vali Acc: 0.977 Test Loss: 0.100 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9712369441986084
Epoch: 33, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.082 Vali Acc: 0.981 Test Loss: 0.082 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.9617760181427002
Epoch: 34, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9596405029296875
Epoch: 35, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.942 Test Loss: 0.253 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_LightTS_UEA_ftM_sl182_ll0_pl0_dm32_cs9_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 47994
model size : 0.19MB
