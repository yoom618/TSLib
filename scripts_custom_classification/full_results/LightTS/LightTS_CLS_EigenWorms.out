Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.184798240661621
Epoch: 1, Steps: 16 | Train Loss: 2.159 Vali Loss: 2.412 Vali Acc: 0.359 Test Loss: 2.412 Test Acc: 0.359
Validation loss decreased (inf --> -0.358755).  Saving model ...
Epoch: 2 cost time: 2.5424559116363525
Epoch: 2, Steps: 16 | Train Loss: 0.277 Vali Loss: 7.421 Vali Acc: 0.351 Test Loss: 7.421 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4584665298461914
Epoch: 3, Steps: 16 | Train Loss: 0.325 Vali Loss: 9.955 Vali Acc: 0.351 Test Loss: 9.955 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4711008071899414
Epoch: 4, Steps: 16 | Train Loss: 0.063 Vali Loss: 11.054 Vali Acc: 0.389 Test Loss: 11.054 Test Acc: 0.389
Validation loss decreased (-0.358755 --> -0.389202).  Saving model ...
Epoch: 5 cost time: 2.674856424331665
Epoch: 5, Steps: 16 | Train Loss: 0.146 Vali Loss: 11.825 Vali Acc: 0.481 Test Loss: 11.825 Test Acc: 0.481
Validation loss decreased (-0.389202 --> -0.480798).  Saving model ...
Epoch: 6 cost time: 2.7380077838897705
Epoch: 6, Steps: 16 | Train Loss: 0.261 Vali Loss: 12.215 Vali Acc: 0.412 Test Loss: 12.215 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.588038682937622
Epoch: 7, Steps: 16 | Train Loss: 0.470 Vali Loss: 13.776 Vali Acc: 0.427 Test Loss: 13.776 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.535435914993286
Epoch: 8, Steps: 16 | Train Loss: 1.081 Vali Loss: 15.576 Vali Acc: 0.489 Test Loss: 15.576 Test Acc: 0.489
Validation loss decreased (-0.480798 --> -0.488394).  Saving model ...
Epoch: 9 cost time: 2.5818593502044678
Epoch: 9, Steps: 16 | Train Loss: 0.358 Vali Loss: 26.790 Vali Acc: 0.351 Test Loss: 26.790 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5240156650543213
Epoch: 10, Steps: 16 | Train Loss: 1.467 Vali Loss: 37.170 Vali Acc: 0.366 Test Loss: 37.170 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.539175033569336
Epoch: 11, Steps: 16 | Train Loss: 3.152 Vali Loss: 35.854 Vali Acc: 0.321 Test Loss: 35.854 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6355676651000977
Epoch: 12, Steps: 16 | Train Loss: 0.212 Vali Loss: 58.366 Vali Acc: 0.412 Test Loss: 58.366 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.5094542503356934
Epoch: 13, Steps: 16 | Train Loss: 0.130 Vali Loss: 85.966 Vali Acc: 0.405 Test Loss: 85.966 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5117695331573486
Epoch: 14, Steps: 16 | Train Loss: 0.290 Vali Loss: 100.949 Vali Acc: 0.374 Test Loss: 100.949 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.678459882736206
Epoch: 15, Steps: 16 | Train Loss: 0.988 Vali Loss: 137.413 Vali Acc: 0.359 Test Loss: 137.413 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.608492136001587
Epoch: 16, Steps: 16 | Train Loss: 0.963 Vali Loss: 102.329 Vali Acc: 0.382 Test Loss: 102.329 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6219475269317627
Epoch: 17, Steps: 16 | Train Loss: 0.004 Vali Loss: 95.749 Vali Acc: 0.382 Test Loss: 95.749 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7139570713043213
Epoch: 18, Steps: 16 | Train Loss: 0.599 Vali Loss: 87.273 Vali Acc: 0.405 Test Loss: 87.273 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 327551937
model size : 1249.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs5995_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.241333961486816
Epoch: 1, Steps: 16 | Train Loss: 1.623 Vali Loss: 3.937 Vali Acc: 0.382 Test Loss: 3.937 Test Acc: 0.382
Validation loss decreased (inf --> -0.381640).  Saving model ...
Epoch: 2 cost time: 2.7681541442871094
Epoch: 2, Steps: 16 | Train Loss: 0.292 Vali Loss: 6.054 Vali Acc: 0.458 Test Loss: 6.054 Test Acc: 0.458
Validation loss decreased (-0.381640 --> -0.457955).  Saving model ...
Epoch: 3 cost time: 2.625568151473999
Epoch: 3, Steps: 16 | Train Loss: 0.042 Vali Loss: 7.254 Vali Acc: 0.427 Test Loss: 7.254 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7398569583892822
Epoch: 4, Steps: 16 | Train Loss: 0.063 Vali Loss: 9.610 Vali Acc: 0.359 Test Loss: 9.610 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5560760498046875
Epoch: 5, Steps: 16 | Train Loss: 0.185 Vali Loss: 11.697 Vali Acc: 0.344 Test Loss: 11.697 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4939653873443604
Epoch: 6, Steps: 16 | Train Loss: 0.283 Vali Loss: 12.329 Vali Acc: 0.420 Test Loss: 12.329 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5948486328125
Epoch: 7, Steps: 16 | Train Loss: 0.302 Vali Loss: 15.479 Vali Acc: 0.374 Test Loss: 15.479 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8636350631713867
Epoch: 8, Steps: 16 | Train Loss: 2.499 Vali Loss: 31.643 Vali Acc: 0.366 Test Loss: 31.643 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.506632089614868
Epoch: 9, Steps: 16 | Train Loss: 0.648 Vali Loss: 41.123 Vali Acc: 0.321 Test Loss: 41.123 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.629427909851074
Epoch: 10, Steps: 16 | Train Loss: 2.173 Vali Loss: 48.865 Vali Acc: 0.366 Test Loss: 48.865 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6664605140686035
Epoch: 11, Steps: 16 | Train Loss: 0.933 Vali Loss: 58.006 Vali Acc: 0.328 Test Loss: 58.006 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.501835823059082
Epoch: 12, Steps: 16 | Train Loss: 1.429 Vali Loss: 59.776 Vali Acc: 0.382 Test Loss: 59.776 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs5995_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 326802703
model size : 1246.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs4496_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.055717468261719
Epoch: 1, Steps: 16 | Train Loss: 1.905 Vali Loss: 3.398 Vali Acc: 0.366 Test Loss: 3.398 Test Acc: 0.366
Validation loss decreased (inf --> -0.366378).  Saving model ...
Epoch: 2 cost time: 2.7593655586242676
Epoch: 2, Steps: 16 | Train Loss: 0.321 Vali Loss: 6.359 Vali Acc: 0.466 Test Loss: 6.359 Test Acc: 0.466
Validation loss decreased (-0.366378 --> -0.465585).  Saving model ...
Epoch: 3 cost time: 2.7583439350128174
Epoch: 3, Steps: 16 | Train Loss: 0.010 Vali Loss: 9.221 Vali Acc: 0.389 Test Loss: 9.221 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7464730739593506
Epoch: 4, Steps: 16 | Train Loss: 0.038 Vali Loss: 9.180 Vali Acc: 0.420 Test Loss: 9.180 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6693503856658936
Epoch: 5, Steps: 16 | Train Loss: 0.026 Vali Loss: 12.054 Vali Acc: 0.389 Test Loss: 12.054 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.491018295288086
Epoch: 6, Steps: 16 | Train Loss: 0.670 Vali Loss: 14.311 Vali Acc: 0.305 Test Loss: 14.311 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.669004201889038
Epoch: 7, Steps: 16 | Train Loss: 0.637 Vali Loss: 23.240 Vali Acc: 0.412 Test Loss: 23.240 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5908899307250977
Epoch: 8, Steps: 16 | Train Loss: 0.381 Vali Loss: 35.792 Vali Acc: 0.420 Test Loss: 35.792 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6886932849884033
Epoch: 9, Steps: 16 | Train Loss: 0.886 Vali Loss: 42.251 Vali Acc: 0.412 Test Loss: 42.251 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6556618213653564
Epoch: 10, Steps: 16 | Train Loss: 0.768 Vali Loss: 48.751 Vali Acc: 0.382 Test Loss: 48.751 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6323037147521973
Epoch: 11, Steps: 16 | Train Loss: 1.066 Vali Loss: 52.605 Vali Acc: 0.328 Test Loss: 52.605 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6227502822875977
Epoch: 12, Steps: 16 | Train Loss: 1.483 Vali Loss: 55.536 Vali Acc: 0.412 Test Loss: 55.536 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs4496_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 326400993
model size : 1245.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.009018898010254
Epoch: 1, Steps: 16 | Train Loss: 1.861 Vali Loss: 2.384 Vali Acc: 0.519 Test Loss: 2.384 Test Acc: 0.519
Validation loss decreased (inf --> -0.519060).  Saving model ...
Epoch: 2 cost time: 2.647501230239868
Epoch: 2, Steps: 16 | Train Loss: 0.414 Vali Loss: 6.552 Vali Acc: 0.427 Test Loss: 6.552 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5821971893310547
Epoch: 3, Steps: 16 | Train Loss: 0.062 Vali Loss: 10.048 Vali Acc: 0.427 Test Loss: 10.048 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4545702934265137
Epoch: 4, Steps: 16 | Train Loss: 0.085 Vali Loss: 11.227 Vali Acc: 0.427 Test Loss: 11.227 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7057201862335205
Epoch: 5, Steps: 16 | Train Loss: 0.249 Vali Loss: 12.404 Vali Acc: 0.351 Test Loss: 12.404 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.513484239578247
Epoch: 6, Steps: 16 | Train Loss: 0.155 Vali Loss: 18.359 Vali Acc: 0.412 Test Loss: 18.359 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.509347438812256
Epoch: 7, Steps: 16 | Train Loss: 0.763 Vali Loss: 24.957 Vali Acc: 0.366 Test Loss: 24.957 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.554730176925659
Epoch: 8, Steps: 16 | Train Loss: 0.545 Vali Loss: 23.589 Vali Acc: 0.328 Test Loss: 23.589 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.588554859161377
Epoch: 9, Steps: 16 | Train Loss: 0.212 Vali Loss: 28.003 Vali Acc: 0.344 Test Loss: 28.003 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6427834033966064
Epoch: 10, Steps: 16 | Train Loss: 0.494 Vali Loss: 35.200 Vali Acc: 0.313 Test Loss: 35.200 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.683004140853882
Epoch: 11, Steps: 16 | Train Loss: 1.623 Vali Loss: 37.663 Vali Acc: 0.366 Test Loss: 37.663 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 326188855
model size : 1244.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.028763771057129
Epoch: 1, Steps: 16 | Train Loss: 1.922 Vali Loss: 3.729 Vali Acc: 0.359 Test Loss: 3.729 Test Acc: 0.359
Validation loss decreased (inf --> -0.358741).  Saving model ...
Epoch: 2 cost time: 2.65321683883667
Epoch: 2, Steps: 16 | Train Loss: 0.379 Vali Loss: 6.698 Vali Acc: 0.374 Test Loss: 6.698 Test Acc: 0.374
Validation loss decreased (-0.358741 --> -0.373979).  Saving model ...
Epoch: 3 cost time: 2.5666215419769287
Epoch: 3, Steps: 16 | Train Loss: 0.133 Vali Loss: 7.404 Vali Acc: 0.435 Test Loss: 7.404 Test Acc: 0.435
Validation loss decreased (-0.373979 --> -0.435040).  Saving model ...
Epoch: 4 cost time: 2.5997164249420166
Epoch: 4, Steps: 16 | Train Loss: 0.036 Vali Loss: 10.683 Vali Acc: 0.405 Test Loss: 10.683 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5855062007904053
Epoch: 5, Steps: 16 | Train Loss: 0.256 Vali Loss: 14.276 Vali Acc: 0.420 Test Loss: 14.276 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.623476505279541
Epoch: 6, Steps: 16 | Train Loss: 0.129 Vali Loss: 15.228 Vali Acc: 0.382 Test Loss: 15.228 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.531566858291626
Epoch: 7, Steps: 16 | Train Loss: 1.103 Vali Loss: 18.910 Vali Acc: 0.351 Test Loss: 18.910 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5847911834716797
Epoch: 8, Steps: 16 | Train Loss: 0.181 Vali Loss: 22.971 Vali Acc: 0.344 Test Loss: 22.971 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.589431047439575
Epoch: 9, Steps: 16 | Train Loss: 0.799 Vali Loss: 26.200 Vali Acc: 0.382 Test Loss: 26.200 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.641622543334961
Epoch: 10, Steps: 16 | Train Loss: 0.256 Vali Loss: 25.863 Vali Acc: 0.397 Test Loss: 25.863 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.56417179107666
Epoch: 11, Steps: 16 | Train Loss: 0.698 Vali Loss: 29.020 Vali Acc: 0.405 Test Loss: 29.020 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4700655937194824
Epoch: 12, Steps: 16 | Train Loss: 0.567 Vali Loss: 36.414 Vali Acc: 0.366 Test Loss: 36.414 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.4629628658294678
Epoch: 13, Steps: 16 | Train Loss: 1.152 Vali Loss: 51.859 Vali Acc: 0.405 Test Loss: 51.859 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 326089489
model size : 1243.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7214577198028564
Epoch: 1, Steps: 16 | Train Loss: 1.920 Vali Loss: 2.983 Vali Acc: 0.519 Test Loss: 2.983 Test Acc: 0.519
Validation loss decreased (inf --> -0.519054).  Saving model ...
Epoch: 2 cost time: 2.5898313522338867
Epoch: 2, Steps: 16 | Train Loss: 0.450 Vali Loss: 5.174 Vali Acc: 0.359 Test Loss: 5.174 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.603351354598999
Epoch: 3, Steps: 16 | Train Loss: 0.192 Vali Loss: 7.852 Vali Acc: 0.427 Test Loss: 7.852 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5626423358917236
Epoch: 4, Steps: 16 | Train Loss: 0.101 Vali Loss: 8.906 Vali Acc: 0.435 Test Loss: 8.906 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4533426761627197
Epoch: 5, Steps: 16 | Train Loss: 0.195 Vali Loss: 11.337 Vali Acc: 0.382 Test Loss: 11.337 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.688143730163574
Epoch: 6, Steps: 16 | Train Loss: 0.314 Vali Loss: 16.657 Vali Acc: 0.397 Test Loss: 16.657 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.8457133769989014
Epoch: 7, Steps: 16 | Train Loss: 0.193 Vali Loss: 25.491 Vali Acc: 0.344 Test Loss: 25.491 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5376837253570557
Epoch: 8, Steps: 16 | Train Loss: 0.423 Vali Loss: 38.925 Vali Acc: 0.412 Test Loss: 38.925 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.521909236907959
Epoch: 9, Steps: 16 | Train Loss: 0.069 Vali Loss: 41.337 Vali Acc: 0.435 Test Loss: 41.337 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.500225782394409
Epoch: 10, Steps: 16 | Train Loss: 0.131 Vali Loss: 46.241 Vali Acc: 0.374 Test Loss: 46.241 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.525374412536621
Epoch: 11, Steps: 16 | Train Loss: 0.470 Vali Loss: 54.124 Vali Acc: 0.351 Test Loss: 54.124 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 326015919
model size : 1243.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6539435386657715
Epoch: 1, Steps: 16 | Train Loss: 1.525 Vali Loss: 3.460 Vali Acc: 0.412 Test Loss: 3.460 Test Acc: 0.412
Validation loss decreased (inf --> -0.412179).  Saving model ...
Epoch: 2 cost time: 2.525858163833618
Epoch: 2, Steps: 16 | Train Loss: 0.135 Vali Loss: 6.957 Vali Acc: 0.443 Test Loss: 6.957 Test Acc: 0.443
Validation loss decreased (-0.412179 --> -0.442679).  Saving model ...
Epoch: 3 cost time: 2.7527599334716797
Epoch: 3, Steps: 16 | Train Loss: 0.069 Vali Loss: 8.016 Vali Acc: 0.435 Test Loss: 8.016 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.503166437149048
Epoch: 4, Steps: 16 | Train Loss: 0.038 Vali Loss: 9.235 Vali Acc: 0.374 Test Loss: 9.235 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.467956304550171
Epoch: 5, Steps: 16 | Train Loss: 0.361 Vali Loss: 12.233 Vali Acc: 0.336 Test Loss: 12.233 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6906301975250244
Epoch: 6, Steps: 16 | Train Loss: 0.494 Vali Loss: 18.129 Vali Acc: 0.344 Test Loss: 18.129 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6089682579040527
Epoch: 7, Steps: 16 | Train Loss: 0.588 Vali Loss: 23.411 Vali Acc: 0.321 Test Loss: 23.411 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6311662197113037
Epoch: 8, Steps: 16 | Train Loss: 0.359 Vali Loss: 25.798 Vali Acc: 0.382 Test Loss: 25.798 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6039071083068848
Epoch: 9, Steps: 16 | Train Loss: 0.150 Vali Loss: 29.857 Vali Acc: 0.366 Test Loss: 29.857 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6043097972869873
Epoch: 10, Steps: 16 | Train Loss: 0.138 Vali Loss: 36.167 Vali Acc: 0.389 Test Loss: 36.167 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.462942600250244
Epoch: 11, Steps: 16 | Train Loss: 0.231 Vali Loss: 39.011 Vali Acc: 0.427 Test Loss: 39.011 Test Acc: 0.427
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4045584201812744
Epoch: 12, Steps: 16 | Train Loss: 0.283 Vali Loss: 46.076 Vali Acc: 0.435 Test Loss: 46.076 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 325825617
model size : 1242.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.931353807449341
Epoch: 1, Steps: 16 | Train Loss: 2.339 Vali Loss: 4.868 Vali Acc: 0.351 Test Loss: 4.868 Test Acc: 0.351
Validation loss decreased (inf --> -0.351096).  Saving model ...
Epoch: 2 cost time: 2.5513153076171875
Epoch: 2, Steps: 16 | Train Loss: 0.447 Vali Loss: 10.330 Vali Acc: 0.443 Test Loss: 10.330 Test Acc: 0.443
Validation loss decreased (-0.351096 --> -0.442645).  Saving model ...
Epoch: 3 cost time: 2.592477798461914
Epoch: 3, Steps: 16 | Train Loss: 0.256 Vali Loss: 11.344 Vali Acc: 0.374 Test Loss: 11.344 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.679553508758545
Epoch: 4, Steps: 16 | Train Loss: 0.094 Vali Loss: 11.538 Vali Acc: 0.389 Test Loss: 11.538 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.623109817504883
Epoch: 5, Steps: 16 | Train Loss: 0.302 Vali Loss: 15.304 Vali Acc: 0.328 Test Loss: 15.304 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.556450366973877
Epoch: 6, Steps: 16 | Train Loss: 0.871 Vali Loss: 22.015 Vali Acc: 0.412 Test Loss: 22.015 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.6204171180725098
Epoch: 7, Steps: 16 | Train Loss: 0.032 Vali Loss: 25.042 Vali Acc: 0.405 Test Loss: 25.042 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6817514896392822
Epoch: 8, Steps: 16 | Train Loss: 0.010 Vali Loss: 27.057 Vali Acc: 0.382 Test Loss: 27.057 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.596006155014038
Epoch: 9, Steps: 16 | Train Loss: 0.040 Vali Loss: 27.897 Vali Acc: 0.397 Test Loss: 27.897 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.7158877849578857
Epoch: 10, Steps: 16 | Train Loss: 0.006 Vali Loss: 27.724 Vali Acc: 0.382 Test Loss: 27.724 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.729327440261841
Epoch: 11, Steps: 16 | Train Loss: 0.829 Vali Loss: 33.765 Vali Acc: 0.366 Test Loss: 33.765 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.59907603263855
Epoch: 12, Steps: 16 | Train Loss: 2.255 Vali Loss: 34.720 Vali Acc: 0.382 Test Loss: 34.720 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 325887799
model size : 1243.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.199475526809692
Epoch: 1, Steps: 16 | Train Loss: 1.775 Vali Loss: 3.967 Vali Acc: 0.481 Test Loss: 3.967 Test Acc: 0.481
Validation loss decreased (inf --> -0.480876).  Saving model ...
Epoch: 2 cost time: 2.602184295654297
Epoch: 2, Steps: 16 | Train Loss: 0.417 Vali Loss: 5.698 Vali Acc: 0.336 Test Loss: 5.698 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.497302770614624
Epoch: 3, Steps: 16 | Train Loss: 0.091 Vali Loss: 7.738 Vali Acc: 0.473 Test Loss: 7.738 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4440245628356934
Epoch: 4, Steps: 16 | Train Loss: 0.153 Vali Loss: 10.350 Vali Acc: 0.382 Test Loss: 10.350 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.523824453353882
Epoch: 5, Steps: 16 | Train Loss: 0.118 Vali Loss: 11.813 Vali Acc: 0.397 Test Loss: 11.813 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.497628688812256
Epoch: 6, Steps: 16 | Train Loss: 0.167 Vali Loss: 13.122 Vali Acc: 0.336 Test Loss: 13.122 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.631389856338501
Epoch: 7, Steps: 16 | Train Loss: 0.640 Vali Loss: 20.441 Vali Acc: 0.359 Test Loss: 20.441 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.6915667057037354
Epoch: 8, Steps: 16 | Train Loss: 0.458 Vali Loss: 25.137 Vali Acc: 0.321 Test Loss: 25.137 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5545456409454346
Epoch: 9, Steps: 16 | Train Loss: 0.658 Vali Loss: 27.945 Vali Acc: 0.336 Test Loss: 27.945 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.556485891342163
Epoch: 10, Steps: 16 | Train Loss: 0.412 Vali Loss: 30.545 Vali Acc: 0.321 Test Loss: 30.545 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.621016502380371
Epoch: 11, Steps: 16 | Train Loss: 10.262 Vali Loss: 55.102 Vali Acc: 0.359 Test Loss: 55.102 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 325818657
model size : 1242.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.830939531326294
Epoch: 1, Steps: 16 | Train Loss: 1.958 Vali Loss: 4.591 Vali Acc: 0.405 Test Loss: 4.591 Test Acc: 0.405
Validation loss decreased (inf --> -0.404534).  Saving model ...
Epoch: 2 cost time: 2.5097193717956543
Epoch: 2, Steps: 16 | Train Loss: 0.321 Vali Loss: 8.897 Vali Acc: 0.397 Test Loss: 8.897 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.572697162628174
Epoch: 3, Steps: 16 | Train Loss: 0.118 Vali Loss: 10.674 Vali Acc: 0.435 Test Loss: 10.674 Test Acc: 0.435
Validation loss decreased (-0.404534 --> -0.435008).  Saving model ...
Epoch: 4 cost time: 2.6018428802490234
Epoch: 4, Steps: 16 | Train Loss: 0.265 Vali Loss: 10.360 Vali Acc: 0.420 Test Loss: 10.360 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.572892189025879
Epoch: 5, Steps: 16 | Train Loss: 0.026 Vali Loss: 17.026 Vali Acc: 0.359 Test Loss: 17.026 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.658769130706787
Epoch: 6, Steps: 16 | Train Loss: 0.358 Vali Loss: 17.269 Vali Acc: 0.389 Test Loss: 17.269 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.589982748031616
Epoch: 7, Steps: 16 | Train Loss: 0.044 Vali Loss: 15.765 Vali Acc: 0.321 Test Loss: 15.765 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5105440616607666
Epoch: 8, Steps: 16 | Train Loss: 0.150 Vali Loss: 16.065 Vali Acc: 0.351 Test Loss: 16.065 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.5279297828674316
Epoch: 9, Steps: 16 | Train Loss: 2.345 Vali Loss: 27.390 Vali Acc: 0.328 Test Loss: 27.390 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.616827964782715
Epoch: 10, Steps: 16 | Train Loss: 1.268 Vali Loss: 47.003 Vali Acc: 0.336 Test Loss: 47.003 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.5928685665130615
Epoch: 11, Steps: 16 | Train Loss: 2.127 Vali Loss: 61.599 Vali Acc: 0.389 Test Loss: 61.599 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.444544792175293
Epoch: 12, Steps: 16 | Train Loss: 0.805 Vali Loss: 75.669 Vali Acc: 0.344 Test Loss: 75.669 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.545457601547241
Epoch: 13, Steps: 16 | Train Loss: 1.325 Vali Loss: 82.590 Vali Acc: 0.374 Test Loss: 82.590 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 325686799
model size : 1242.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.776867628097534
Epoch: 1, Steps: 16 | Train Loss: 1.874 Vali Loss: 3.152 Vali Acc: 0.420 Test Loss: 3.152 Test Acc: 0.420
Validation loss decreased (inf --> -0.419816).  Saving model ...
Epoch: 2 cost time: 2.450448989868164
Epoch: 2, Steps: 16 | Train Loss: 0.265 Vali Loss: 5.190 Vali Acc: 0.427 Test Loss: 5.190 Test Acc: 0.427
Validation loss decreased (-0.419816 --> -0.427429).  Saving model ...
Epoch: 3 cost time: 2.6514556407928467
Epoch: 3, Steps: 16 | Train Loss: 0.084 Vali Loss: 7.008 Vali Acc: 0.374 Test Loss: 7.008 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.460155487060547
Epoch: 4, Steps: 16 | Train Loss: 0.230 Vali Loss: 8.540 Vali Acc: 0.435 Test Loss: 8.540 Test Acc: 0.435
Validation loss decreased (-0.427429 --> -0.435029).  Saving model ...
Epoch: 5 cost time: 2.5299413204193115
Epoch: 5, Steps: 16 | Train Loss: 0.640 Vali Loss: 13.461 Vali Acc: 0.427 Test Loss: 13.461 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4795007705688477
Epoch: 6, Steps: 16 | Train Loss: 2.808 Vali Loss: 14.494 Vali Acc: 0.382 Test Loss: 14.494 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5964243412017822
Epoch: 7, Steps: 16 | Train Loss: 1.675 Vali Loss: 23.036 Vali Acc: 0.389 Test Loss: 23.036 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.619058847427368
Epoch: 8, Steps: 16 | Train Loss: 0.200 Vali Loss: 29.148 Vali Acc: 0.366 Test Loss: 29.148 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.587491512298584
Epoch: 9, Steps: 16 | Train Loss: 0.191 Vali Loss: 30.331 Vali Acc: 0.374 Test Loss: 30.331 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.612278699874878
Epoch: 10, Steps: 16 | Train Loss: 0.014 Vali Loss: 33.281 Vali Acc: 0.397 Test Loss: 33.281 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.578519105911255
Epoch: 11, Steps: 16 | Train Loss: 0.844 Vali Loss: 41.929 Vali Acc: 0.374 Test Loss: 41.929 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.4573988914489746
Epoch: 12, Steps: 16 | Train Loss: 0.881 Vali Loss: 44.852 Vali Acc: 0.321 Test Loss: 44.852 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.6248984336853027
Epoch: 13, Steps: 16 | Train Loss: 0.048 Vali Loss: 43.117 Vali Acc: 0.344 Test Loss: 43.117 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5513195991516113
Epoch: 14, Steps: 16 | Train Loss: 0.156 Vali Loss: 46.316 Vali Acc: 0.313 Test Loss: 46.316 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 325705985
model size : 1242.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.196911573410034
Epoch: 1, Steps: 16 | Train Loss: 1.809 Vali Loss: 3.232 Vali Acc: 0.420 Test Loss: 3.232 Test Acc: 0.420
Validation loss decreased (inf --> -0.419815).  Saving model ...
Epoch: 2 cost time: 2.5145905017852783
Epoch: 2, Steps: 16 | Train Loss: 0.218 Vali Loss: 7.743 Vali Acc: 0.389 Test Loss: 7.743 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6394619941711426
Epoch: 3, Steps: 16 | Train Loss: 0.093 Vali Loss: 9.157 Vali Acc: 0.405 Test Loss: 9.157 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5490431785583496
Epoch: 4, Steps: 16 | Train Loss: 0.087 Vali Loss: 14.828 Vali Acc: 0.389 Test Loss: 14.828 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.655298948287964
Epoch: 5, Steps: 16 | Train Loss: 0.575 Vali Loss: 14.767 Vali Acc: 0.374 Test Loss: 14.767 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.55118465423584
Epoch: 6, Steps: 16 | Train Loss: 0.575 Vali Loss: 14.110 Vali Acc: 0.366 Test Loss: 14.110 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6224024295806885
Epoch: 7, Steps: 16 | Train Loss: 0.511 Vali Loss: 20.386 Vali Acc: 0.412 Test Loss: 20.386 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7117433547973633
Epoch: 8, Steps: 16 | Train Loss: 3.272 Vali Loss: 27.399 Vali Acc: 0.382 Test Loss: 27.399 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.585130214691162
Epoch: 9, Steps: 16 | Train Loss: 0.769 Vali Loss: 43.475 Vali Acc: 0.405 Test Loss: 43.475 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.668755054473877
Epoch: 10, Steps: 16 | Train Loss: 0.277 Vali Loss: 53.307 Vali Acc: 0.405 Test Loss: 53.307 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.486358880996704
Epoch: 11, Steps: 16 | Train Loss: 0.294 Vali Loss: 55.068 Vali Acc: 0.382 Test Loss: 55.068 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4198473282442748
model parameter : 325748535
model size : 1242.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.036144733428955
Epoch: 1, Steps: 16 | Train Loss: 2.316 Vali Loss: 4.033 Vali Acc: 0.450 Test Loss: 4.033 Test Acc: 0.450
Validation loss decreased (inf --> -0.450341).  Saving model ...
Epoch: 2 cost time: 2.3569955825805664
Epoch: 2, Steps: 16 | Train Loss: 0.490 Vali Loss: 10.283 Vali Acc: 0.450 Test Loss: 10.283 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.515227794647217
Epoch: 3, Steps: 16 | Train Loss: 0.131 Vali Loss: 11.619 Vali Acc: 0.366 Test Loss: 11.619 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.602623701095581
Epoch: 4, Steps: 16 | Train Loss: 0.119 Vali Loss: 12.131 Vali Acc: 0.351 Test Loss: 12.131 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6122958660125732
Epoch: 5, Steps: 16 | Train Loss: 0.288 Vali Loss: 14.713 Vali Acc: 0.389 Test Loss: 14.713 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.703648567199707
Epoch: 6, Steps: 16 | Train Loss: 0.013 Vali Loss: 15.526 Vali Acc: 0.374 Test Loss: 15.526 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5928661823272705
Epoch: 7, Steps: 16 | Train Loss: 0.271 Vali Loss: 19.516 Vali Acc: 0.374 Test Loss: 19.516 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5298290252685547
Epoch: 8, Steps: 16 | Train Loss: 0.248 Vali Loss: 23.100 Vali Acc: 0.359 Test Loss: 23.100 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.4487040042877197
Epoch: 9, Steps: 16 | Train Loss: 0.994 Vali Loss: 35.509 Vali Acc: 0.405 Test Loss: 35.509 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.483779191970825
Epoch: 10, Steps: 16 | Train Loss: 1.156 Vali Loss: 54.289 Vali Acc: 0.351 Test Loss: 54.289 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.559619903564453
Epoch: 11, Steps: 16 | Train Loss: 0.821 Vali Loss: 61.025 Vali Acc: 0.382 Test Loss: 61.025 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 325687281
model size : 1242.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8970448970794678
Epoch: 1, Steps: 16 | Train Loss: 1.725 Vali Loss: 2.912 Vali Acc: 0.450 Test Loss: 2.912 Test Acc: 0.450
Validation loss decreased (inf --> -0.450353).  Saving model ...
Epoch: 2 cost time: 2.8170979022979736
Epoch: 2, Steps: 16 | Train Loss: 0.428 Vali Loss: 5.408 Vali Acc: 0.450 Test Loss: 5.408 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5181803703308105
Epoch: 3, Steps: 16 | Train Loss: 0.094 Vali Loss: 9.877 Vali Acc: 0.351 Test Loss: 9.877 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5325138568878174
Epoch: 4, Steps: 16 | Train Loss: 0.225 Vali Loss: 10.169 Vali Acc: 0.435 Test Loss: 10.169 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4638209342956543
Epoch: 5, Steps: 16 | Train Loss: 0.090 Vali Loss: 11.229 Vali Acc: 0.382 Test Loss: 11.229 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.475346326828003
Epoch: 6, Steps: 16 | Train Loss: 0.086 Vali Loss: 15.659 Vali Acc: 0.427 Test Loss: 15.659 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.725471258163452
Epoch: 7, Steps: 16 | Train Loss: 0.239 Vali Loss: 22.563 Vali Acc: 0.443 Test Loss: 22.563 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.54154109954834
Epoch: 8, Steps: 16 | Train Loss: 0.517 Vali Loss: 20.367 Vali Acc: 0.420 Test Loss: 20.367 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6073403358459473
Epoch: 9, Steps: 16 | Train Loss: 0.463 Vali Loss: 18.850 Vali Acc: 0.366 Test Loss: 18.850 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.461632251739502
Epoch: 10, Steps: 16 | Train Loss: 0.810 Vali Loss: 18.737 Vali Acc: 0.420 Test Loss: 18.737 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4516329765319824
Epoch: 11, Steps: 16 | Train Loss: 0.284 Vali Loss: 24.801 Vali Acc: 0.397 Test Loss: 24.801 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 325575407
model size : 1241.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7001144886016846
Epoch: 1, Steps: 16 | Train Loss: 1.769 Vali Loss: 3.926 Vali Acc: 0.405 Test Loss: 3.926 Test Acc: 0.405
Validation loss decreased (inf --> -0.404541).  Saving model ...
Epoch: 2 cost time: 2.7644410133361816
Epoch: 2, Steps: 16 | Train Loss: 0.355 Vali Loss: 5.386 Vali Acc: 0.420 Test Loss: 5.386 Test Acc: 0.420
Validation loss decreased (-0.404541 --> -0.419793).  Saving model ...
Epoch: 3 cost time: 2.591515064239502
Epoch: 3, Steps: 16 | Train Loss: 0.358 Vali Loss: 7.882 Vali Acc: 0.443 Test Loss: 7.882 Test Acc: 0.443
Validation loss decreased (-0.419793 --> -0.442669).  Saving model ...
Epoch: 4 cost time: 2.671396493911743
Epoch: 4, Steps: 16 | Train Loss: 0.138 Vali Loss: 10.571 Vali Acc: 0.458 Test Loss: 10.571 Test Acc: 0.458
Validation loss decreased (-0.442669 --> -0.457910).  Saving model ...
Epoch: 5 cost time: 2.6361258029937744
Epoch: 5, Steps: 16 | Train Loss: 0.242 Vali Loss: 11.456 Vali Acc: 0.397 Test Loss: 11.456 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.590790033340454
Epoch: 6, Steps: 16 | Train Loss: 0.162 Vali Loss: 24.749 Vali Acc: 0.443 Test Loss: 24.749 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5553455352783203
Epoch: 7, Steps: 16 | Train Loss: 0.065 Vali Loss: 24.248 Vali Acc: 0.397 Test Loss: 24.248 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5414116382598877
Epoch: 8, Steps: 16 | Train Loss: 0.114 Vali Loss: 26.686 Vali Acc: 0.366 Test Loss: 26.686 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.6105570793151855
Epoch: 9, Steps: 16 | Train Loss: 0.081 Vali Loss: 27.628 Vali Acc: 0.351 Test Loss: 27.628 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.75889253616333
Epoch: 10, Steps: 16 | Train Loss: 0.333 Vali Loss: 28.743 Vali Acc: 0.366 Test Loss: 28.743 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.617657423019409
Epoch: 11, Steps: 16 | Train Loss: 0.336 Vali Loss: 31.881 Vali Acc: 0.321 Test Loss: 31.881 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5731894969940186
Epoch: 12, Steps: 16 | Train Loss: 0.716 Vali Loss: 29.363 Vali Acc: 0.389 Test Loss: 29.363 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.572737693786621
Epoch: 13, Steps: 16 | Train Loss: 0.328 Vali Loss: 42.585 Vali Acc: 0.374 Test Loss: 42.585 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5286436080932617
Epoch: 14, Steps: 16 | Train Loss: 2.833 Vali Loss: 52.709 Vali Acc: 0.374 Test Loss: 52.709 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 325538289
model size : 1241.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8856685161590576
Epoch: 1, Steps: 16 | Train Loss: 2.021 Vali Loss: 3.425 Vali Acc: 0.420 Test Loss: 3.425 Test Acc: 0.420
Validation loss decreased (inf --> -0.419813).  Saving model ...
Epoch: 2 cost time: 2.5945863723754883
Epoch: 2, Steps: 16 | Train Loss: 0.443 Vali Loss: 7.490 Vali Acc: 0.374 Test Loss: 7.490 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.683652639389038
Epoch: 3, Steps: 16 | Train Loss: 0.143 Vali Loss: 10.245 Vali Acc: 0.397 Test Loss: 10.245 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4666011333465576
Epoch: 4, Steps: 16 | Train Loss: 0.257 Vali Loss: 11.291 Vali Acc: 0.450 Test Loss: 11.291 Test Acc: 0.450
Validation loss decreased (-0.419813 --> -0.450269).  Saving model ...
Epoch: 5 cost time: 2.7552731037139893
Epoch: 5, Steps: 16 | Train Loss: 0.096 Vali Loss: 12.184 Vali Acc: 0.412 Test Loss: 12.184 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7559731006622314
Epoch: 6, Steps: 16 | Train Loss: 0.139 Vali Loss: 12.562 Vali Acc: 0.397 Test Loss: 12.562 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.600834608078003
Epoch: 7, Steps: 16 | Train Loss: 0.353 Vali Loss: 16.337 Vali Acc: 0.366 Test Loss: 16.337 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5669872760772705
Epoch: 8, Steps: 16 | Train Loss: 0.007 Vali Loss: 20.023 Vali Acc: 0.328 Test Loss: 20.023 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5427157878875732
Epoch: 9, Steps: 16 | Train Loss: 0.275 Vali Loss: 26.487 Vali Acc: 0.275 Test Loss: 26.487 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7393949031829834
Epoch: 10, Steps: 16 | Train Loss: 1.536 Vali Loss: 25.898 Vali Acc: 0.359 Test Loss: 25.898 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7520554065704346
Epoch: 11, Steps: 16 | Train Loss: 1.026 Vali Loss: 71.510 Vali Acc: 0.366 Test Loss: 71.510 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.5869202613830566
Epoch: 12, Steps: 16 | Train Loss: 0.995 Vali Loss: 82.585 Vali Acc: 0.359 Test Loss: 82.585 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.7784366607666016
Epoch: 13, Steps: 16 | Train Loss: 0.427 Vali Loss: 89.164 Vali Acc: 0.389 Test Loss: 89.164 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.582077980041504
Epoch: 14, Steps: 16 | Train Loss: 0.868 Vali Loss: 101.257 Vali Acc: 0.351 Test Loss: 101.257 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 325557431
model size : 1241.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.127508878707886
Epoch: 1, Steps: 16 | Train Loss: 1.817 Vali Loss: 3.425 Vali Acc: 0.450 Test Loss: 3.425 Test Acc: 0.450
Validation loss decreased (inf --> -0.450347).  Saving model ...
Epoch: 2 cost time: 2.5446012020111084
Epoch: 2, Steps: 16 | Train Loss: 0.231 Vali Loss: 7.921 Vali Acc: 0.344 Test Loss: 7.921 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5228567123413086
Epoch: 3, Steps: 16 | Train Loss: 0.051 Vali Loss: 8.007 Vali Acc: 0.412 Test Loss: 8.007 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6112422943115234
Epoch: 4, Steps: 16 | Train Loss: 0.092 Vali Loss: 11.244 Vali Acc: 0.397 Test Loss: 11.244 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6300101280212402
Epoch: 5, Steps: 16 | Train Loss: 0.248 Vali Loss: 11.487 Vali Acc: 0.382 Test Loss: 11.487 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.538461446762085
Epoch: 6, Steps: 16 | Train Loss: 0.168 Vali Loss: 14.431 Vali Acc: 0.336 Test Loss: 14.431 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.526890993118286
Epoch: 7, Steps: 16 | Train Loss: 0.007 Vali Loss: 16.707 Vali Acc: 0.313 Test Loss: 16.707 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.500310182571411
Epoch: 8, Steps: 16 | Train Loss: 0.001 Vali Loss: 18.612 Vali Acc: 0.298 Test Loss: 18.612 Test Acc: 0.298
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.490669012069702
Epoch: 9, Steps: 16 | Train Loss: 0.311 Vali Loss: 20.770 Vali Acc: 0.336 Test Loss: 20.770 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.62100887298584
Epoch: 10, Steps: 16 | Train Loss: 0.183 Vali Loss: 30.467 Vali Acc: 0.374 Test Loss: 30.467 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5416626930236816
Epoch: 11, Steps: 16 | Train Loss: 0.842 Vali Loss: 41.180 Vali Acc: 0.412 Test Loss: 41.180 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 325794433
model size : 1242.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8725502490997314
Epoch: 1, Steps: 16 | Train Loss: 1.499 Vali Loss: 2.694 Vali Acc: 0.458 Test Loss: 2.694 Test Acc: 0.458
Validation loss decreased (inf --> -0.457988).  Saving model ...
Epoch: 2 cost time: 2.7386555671691895
Epoch: 2, Steps: 16 | Train Loss: 0.204 Vali Loss: 5.126 Vali Acc: 0.397 Test Loss: 5.126 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5139358043670654
Epoch: 3, Steps: 16 | Train Loss: 0.076 Vali Loss: 6.894 Vali Acc: 0.412 Test Loss: 6.894 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.705772638320923
Epoch: 4, Steps: 16 | Train Loss: 0.195 Vali Loss: 9.544 Vali Acc: 0.420 Test Loss: 9.544 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.4849820137023926
Epoch: 5, Steps: 16 | Train Loss: 0.118 Vali Loss: 10.795 Vali Acc: 0.397 Test Loss: 10.795 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.51153564453125
Epoch: 6, Steps: 16 | Train Loss: 0.639 Vali Loss: 23.132 Vali Acc: 0.489 Test Loss: 23.132 Test Acc: 0.489
Validation loss decreased (-0.457988 --> -0.488318).  Saving model ...
Epoch: 7 cost time: 2.6706066131591797
Epoch: 7, Steps: 16 | Train Loss: 0.389 Vali Loss: 24.302 Vali Acc: 0.397 Test Loss: 24.302 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.615452289581299
Epoch: 8, Steps: 16 | Train Loss: 0.867 Vali Loss: 32.110 Vali Acc: 0.366 Test Loss: 32.110 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6023354530334473
Epoch: 9, Steps: 16 | Train Loss: 0.124 Vali Loss: 40.198 Vali Acc: 0.466 Test Loss: 40.198 Test Acc: 0.466
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5789687633514404
Epoch: 10, Steps: 16 | Train Loss: 0.970 Vali Loss: 44.554 Vali Acc: 0.420 Test Loss: 44.554 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.560398817062378
Epoch: 11, Steps: 16 | Train Loss: 0.984 Vali Loss: 48.991 Vali Acc: 0.321 Test Loss: 48.991 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.569127082824707
Epoch: 12, Steps: 16 | Train Loss: 10.493 Vali Loss: 55.608 Vali Acc: 0.405 Test Loss: 55.608 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.669600486755371
Epoch: 13, Steps: 16 | Train Loss: 0.353 Vali Loss: 67.336 Vali Acc: 0.435 Test Loss: 67.336 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.5909383296966553
Epoch: 14, Steps: 16 | Train Loss: 0.802 Vali Loss: 64.757 Vali Acc: 0.344 Test Loss: 64.757 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.468937635421753
Epoch: 15, Steps: 16 | Train Loss: 0.156 Vali Loss: 78.911 Vali Acc: 0.344 Test Loss: 78.911 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.623096466064453
Epoch: 16, Steps: 16 | Train Loss: 1.039 Vali Loss: 81.519 Vali Acc: 0.336 Test Loss: 81.519 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 325655055
model size : 1242.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8023178577423096
Epoch: 1, Steps: 16 | Train Loss: 1.879 Vali Loss: 2.637 Vali Acc: 0.519 Test Loss: 2.637 Test Acc: 0.519
Validation loss decreased (inf --> -0.519058).  Saving model ...
Epoch: 2 cost time: 2.689077138900757
Epoch: 2, Steps: 16 | Train Loss: 0.304 Vali Loss: 9.066 Vali Acc: 0.336 Test Loss: 9.066 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.628628969192505
Epoch: 3, Steps: 16 | Train Loss: 0.143 Vali Loss: 11.294 Vali Acc: 0.427 Test Loss: 11.294 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.699399948120117
Epoch: 4, Steps: 16 | Train Loss: 0.193 Vali Loss: 15.234 Vali Acc: 0.374 Test Loss: 15.234 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5707576274871826
Epoch: 5, Steps: 16 | Train Loss: 0.198 Vali Loss: 15.692 Vali Acc: 0.359 Test Loss: 15.692 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6003241539001465
Epoch: 6, Steps: 16 | Train Loss: 0.508 Vali Loss: 19.859 Vali Acc: 0.366 Test Loss: 19.859 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.603771924972534
Epoch: 7, Steps: 16 | Train Loss: 0.021 Vali Loss: 25.411 Vali Acc: 0.405 Test Loss: 25.411 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7282469272613525
Epoch: 8, Steps: 16 | Train Loss: 0.229 Vali Loss: 29.103 Vali Acc: 0.435 Test Loss: 29.103 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.773043155670166
Epoch: 9, Steps: 16 | Train Loss: 0.493 Vali Loss: 30.827 Vali Acc: 0.420 Test Loss: 30.827 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6816937923431396
Epoch: 10, Steps: 16 | Train Loss: 1.074 Vali Loss: 34.358 Vali Acc: 0.351 Test Loss: 34.358 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4735658168792725
Epoch: 11, Steps: 16 | Train Loss: 0.171 Vali Loss: 39.831 Vali Acc: 0.282 Test Loss: 39.831 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 325768993
model size : 1242.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.944941520690918
Epoch: 1, Steps: 16 | Train Loss: 1.672 Vali Loss: 4.036 Vali Acc: 0.458 Test Loss: 4.036 Test Acc: 0.458
Validation loss decreased (inf --> -0.457975).  Saving model ...
Epoch: 2 cost time: 2.6509742736816406
Epoch: 2, Steps: 16 | Train Loss: 0.128 Vali Loss: 8.235 Vali Acc: 0.412 Test Loss: 8.235 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7355852127075195
Epoch: 3, Steps: 16 | Train Loss: 0.141 Vali Loss: 10.078 Vali Acc: 0.450 Test Loss: 10.078 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.551107883453369
Epoch: 4, Steps: 16 | Train Loss: 0.070 Vali Loss: 9.574 Vali Acc: 0.397 Test Loss: 9.574 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6319313049316406
Epoch: 5, Steps: 16 | Train Loss: 0.088 Vali Loss: 9.872 Vali Acc: 0.389 Test Loss: 9.872 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.3974528312683105
Epoch: 6, Steps: 16 | Train Loss: 0.004 Vali Loss: 10.658 Vali Acc: 0.405 Test Loss: 10.658 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.563324451446533
Epoch: 7, Steps: 16 | Train Loss: 0.001 Vali Loss: 13.722 Vali Acc: 0.382 Test Loss: 13.722 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.693746328353882
Epoch: 8, Steps: 16 | Train Loss: 0.148 Vali Loss: 14.566 Vali Acc: 0.412 Test Loss: 14.566 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.682421922683716
Epoch: 9, Steps: 16 | Train Loss: 0.243 Vali Loss: 17.735 Vali Acc: 0.366 Test Loss: 17.735 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.6065733432769775
Epoch: 10, Steps: 16 | Train Loss: 0.536 Vali Loss: 23.576 Vali Acc: 0.382 Test Loss: 23.576 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.726900100708008
Epoch: 11, Steps: 16 | Train Loss: 3.933 Vali Loss: 36.627 Vali Acc: 0.313 Test Loss: 36.627 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm512_cs857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 325704119
model size : 1242.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.800107717514038
Epoch: 1, Steps: 16 | Train Loss: 1.851 Vali Loss: 3.511 Vali Acc: 0.351 Test Loss: 3.511 Test Acc: 0.351
Validation loss decreased (inf --> -0.351110).  Saving model ...
Epoch: 2 cost time: 2.7151811122894287
Epoch: 2, Steps: 16 | Train Loss: 0.277 Vali Loss: 5.991 Vali Acc: 0.443 Test Loss: 5.991 Test Acc: 0.443
Validation loss decreased (-0.351110 --> -0.442688).  Saving model ...
Epoch: 3 cost time: 2.5930075645446777
Epoch: 3, Steps: 16 | Train Loss: 0.461 Vali Loss: 9.474 Vali Acc: 0.374 Test Loss: 9.474 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.486475706100464
Epoch: 4, Steps: 16 | Train Loss: 0.220 Vali Loss: 9.423 Vali Acc: 0.359 Test Loss: 9.423 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5785677433013916
Epoch: 5, Steps: 16 | Train Loss: 0.518 Vali Loss: 13.131 Vali Acc: 0.359 Test Loss: 13.131 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6347529888153076
Epoch: 6, Steps: 16 | Train Loss: 0.276 Vali Loss: 14.103 Vali Acc: 0.374 Test Loss: 14.103 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.684311866760254
Epoch: 7, Steps: 16 | Train Loss: 1.220 Vali Loss: 19.815 Vali Acc: 0.344 Test Loss: 19.815 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.636655330657959
Epoch: 8, Steps: 16 | Train Loss: 0.180 Vali Loss: 33.747 Vali Acc: 0.382 Test Loss: 33.747 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.5297861099243164
Epoch: 9, Steps: 16 | Train Loss: 0.179 Vali Loss: 39.555 Vali Acc: 0.412 Test Loss: 39.555 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5576140880584717
Epoch: 10, Steps: 16 | Train Loss: 1.899 Vali Loss: 39.811 Vali Acc: 0.382 Test Loss: 39.811 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.453317880630493
Epoch: 11, Steps: 16 | Train Loss: 0.644 Vali Loss: 52.174 Vali Acc: 0.328 Test Loss: 52.174 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.573394536972046
Epoch: 12, Steps: 16 | Train Loss: 0.497 Vali Loss: 60.372 Vali Acc: 0.321 Test Loss: 60.372 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 325751297
model size : 1242.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs5995_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8784146308898926
Epoch: 1, Steps: 16 | Train Loss: 2.093 Vali Loss: 4.879 Vali Acc: 0.412 Test Loss: 4.879 Test Acc: 0.412
Validation loss decreased (inf --> -0.412165).  Saving model ...
Epoch: 2 cost time: 2.5791447162628174
Epoch: 2, Steps: 16 | Train Loss: 0.297 Vali Loss: 8.904 Vali Acc: 0.466 Test Loss: 8.904 Test Acc: 0.466
Validation loss decreased (-0.412165 --> -0.465560).  Saving model ...
Epoch: 3 cost time: 2.574270248413086
Epoch: 3, Steps: 16 | Train Loss: 0.300 Vali Loss: 9.693 Vali Acc: 0.412 Test Loss: 9.693 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.55546236038208
Epoch: 4, Steps: 16 | Train Loss: 0.002 Vali Loss: 11.524 Vali Acc: 0.427 Test Loss: 11.524 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4733924865722656
Epoch: 5, Steps: 16 | Train Loss: 0.009 Vali Loss: 11.926 Vali Acc: 0.427 Test Loss: 11.926 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6349027156829834
Epoch: 6, Steps: 16 | Train Loss: 0.165 Vali Loss: 12.163 Vali Acc: 0.389 Test Loss: 12.163 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5924625396728516
Epoch: 7, Steps: 16 | Train Loss: 0.305 Vali Loss: 15.175 Vali Acc: 0.397 Test Loss: 15.175 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5429391860961914
Epoch: 8, Steps: 16 | Train Loss: 0.424 Vali Loss: 25.418 Vali Acc: 0.305 Test Loss: 25.418 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6106650829315186
Epoch: 9, Steps: 16 | Train Loss: 0.661 Vali Loss: 31.982 Vali Acc: 0.313 Test Loss: 31.982 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4635801315307617
Epoch: 10, Steps: 16 | Train Loss: 1.247 Vali Loss: 54.252 Vali Acc: 0.382 Test Loss: 54.252 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4840261936187744
Epoch: 11, Steps: 16 | Train Loss: 1.432 Vali Loss: 84.091 Vali Acc: 0.336 Test Loss: 84.091 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6231088638305664
Epoch: 12, Steps: 16 | Train Loss: 0.613 Vali Loss: 97.197 Vali Acc: 0.374 Test Loss: 97.197 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs5995_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 325385679
model size : 1241.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs4496_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.962876319885254
Epoch: 1, Steps: 16 | Train Loss: 1.707 Vali Loss: 3.886 Vali Acc: 0.435 Test Loss: 3.886 Test Acc: 0.435
Validation loss decreased (inf --> -0.435076).  Saving model ...
Epoch: 2 cost time: 2.6490650177001953
Epoch: 2, Steps: 16 | Train Loss: 0.473 Vali Loss: 8.085 Vali Acc: 0.305 Test Loss: 8.085 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.717106580734253
Epoch: 3, Steps: 16 | Train Loss: 0.242 Vali Loss: 11.064 Vali Acc: 0.458 Test Loss: 11.064 Test Acc: 0.458
Validation loss decreased (-0.435076 --> -0.457905).  Saving model ...
Epoch: 4 cost time: 2.4296164512634277
Epoch: 4, Steps: 16 | Train Loss: 0.558 Vali Loss: 12.827 Vali Acc: 0.359 Test Loss: 12.827 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6099491119384766
Epoch: 5, Steps: 16 | Train Loss: 0.468 Vali Loss: 12.857 Vali Acc: 0.328 Test Loss: 12.857 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.471482753753662
Epoch: 6, Steps: 16 | Train Loss: 0.351 Vali Loss: 19.481 Vali Acc: 0.290 Test Loss: 19.481 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.3252246379852295
Epoch: 7, Steps: 16 | Train Loss: 0.579 Vali Loss: 22.351 Vali Acc: 0.305 Test Loss: 22.351 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.570629358291626
Epoch: 8, Steps: 16 | Train Loss: 1.911 Vali Loss: 31.795 Vali Acc: 0.359 Test Loss: 31.795 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.4781999588012695
Epoch: 9, Steps: 16 | Train Loss: 0.309 Vali Loss: 36.650 Vali Acc: 0.397 Test Loss: 36.650 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.5060572624206543
Epoch: 10, Steps: 16 | Train Loss: 0.486 Vali Loss: 37.943 Vali Acc: 0.351 Test Loss: 37.943 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.628314256668091
Epoch: 11, Steps: 16 | Train Loss: 0.343 Vali Loss: 45.163 Vali Acc: 0.435 Test Loss: 45.163 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.57863450050354
Epoch: 12, Steps: 16 | Train Loss: 0.640 Vali Loss: 48.757 Vali Acc: 0.420 Test Loss: 48.757 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.487578868865967
Epoch: 13, Steps: 16 | Train Loss: 0.316 Vali Loss: 56.704 Vali Acc: 0.427 Test Loss: 56.704 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs4496_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 325175841
model size : 1240.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.080930233001709
Epoch: 1, Steps: 16 | Train Loss: 2.369 Vali Loss: 3.089 Vali Acc: 0.305 Test Loss: 3.089 Test Acc: 0.305
Validation loss decreased (inf --> -0.305313).  Saving model ...
Epoch: 2 cost time: 2.7748115062713623
Epoch: 2, Steps: 16 | Train Loss: 0.408 Vali Loss: 10.028 Vali Acc: 0.412 Test Loss: 10.028 Test Acc: 0.412
Validation loss decreased (-0.305313 --> -0.412113).  Saving model ...
Epoch: 3 cost time: 2.81813383102417
Epoch: 3, Steps: 16 | Train Loss: 0.052 Vali Loss: 13.450 Vali Acc: 0.351 Test Loss: 13.450 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7952826023101807
Epoch: 4, Steps: 16 | Train Loss: 0.581 Vali Loss: 16.317 Vali Acc: 0.374 Test Loss: 16.317 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7845091819763184
Epoch: 5, Steps: 16 | Train Loss: 0.564 Vali Loss: 17.574 Vali Acc: 0.374 Test Loss: 17.574 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8053858280181885
Epoch: 6, Steps: 16 | Train Loss: 0.496 Vali Loss: 21.983 Vali Acc: 0.420 Test Loss: 21.983 Test Acc: 0.420
Validation loss decreased (-0.412113 --> -0.419627).  Saving model ...
Epoch: 7 cost time: 2.795670747756958
Epoch: 7, Steps: 16 | Train Loss: 0.168 Vali Loss: 25.492 Vali Acc: 0.382 Test Loss: 25.492 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6466238498687744
Epoch: 8, Steps: 16 | Train Loss: 0.376 Vali Loss: 29.678 Vali Acc: 0.389 Test Loss: 29.678 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.832557439804077
Epoch: 9, Steps: 16 | Train Loss: 0.146 Vali Loss: 30.864 Vali Acc: 0.351 Test Loss: 30.864 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7422003746032715
Epoch: 10, Steps: 16 | Train Loss: 0.092 Vali Loss: 33.127 Vali Acc: 0.397 Test Loss: 33.127 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.927133798599243
Epoch: 11, Steps: 16 | Train Loss: 0.145 Vali Loss: 47.342 Vali Acc: 0.397 Test Loss: 47.342 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.663588523864746
Epoch: 12, Steps: 16 | Train Loss: 0.634 Vali Loss: 56.598 Vali Acc: 0.328 Test Loss: 56.598 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.6467416286468506
Epoch: 13, Steps: 16 | Train Loss: 5.804 Vali Loss: 78.961 Vali Acc: 0.351 Test Loss: 78.961 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7564728260040283
Epoch: 14, Steps: 16 | Train Loss: 0.412 Vali Loss: 96.680 Vali Acc: 0.412 Test Loss: 96.680 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8704376220703125
Epoch: 15, Steps: 16 | Train Loss: 0.950 Vali Loss: 112.948 Vali Acc: 0.298 Test Loss: 112.948 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.759652614593506
Epoch: 16, Steps: 16 | Train Loss: 1.373 Vali Loss: 124.250 Vali Acc: 0.313 Test Loss: 124.250 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4198473282442748
model parameter : 325078775
model size : 1240.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.964249610900879
Epoch: 1, Steps: 16 | Train Loss: 1.765 Vali Loss: 4.023 Vali Acc: 0.405 Test Loss: 4.023 Test Acc: 0.405
Validation loss decreased (inf --> -0.404540).  Saving model ...
Epoch: 2 cost time: 2.5959131717681885
Epoch: 2, Steps: 16 | Train Loss: 0.337 Vali Loss: 9.820 Vali Acc: 0.366 Test Loss: 9.820 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5808072090148926
Epoch: 3, Steps: 16 | Train Loss: 0.181 Vali Loss: 10.349 Vali Acc: 0.351 Test Loss: 10.349 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.526336669921875
Epoch: 4, Steps: 16 | Train Loss: 0.123 Vali Loss: 11.777 Vali Acc: 0.374 Test Loss: 11.777 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.504129409790039
Epoch: 5, Steps: 16 | Train Loss: 2.016 Vali Loss: 11.386 Vali Acc: 0.397 Test Loss: 11.386 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.7559266090393066
Epoch: 6, Steps: 16 | Train Loss: 0.117 Vali Loss: 19.566 Vali Acc: 0.313 Test Loss: 19.566 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5863451957702637
Epoch: 7, Steps: 16 | Train Loss: 0.557 Vali Loss: 22.952 Vali Acc: 0.389 Test Loss: 22.952 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7764415740966797
Epoch: 8, Steps: 16 | Train Loss: 0.352 Vali Loss: 25.151 Vali Acc: 0.321 Test Loss: 25.151 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.693394660949707
Epoch: 9, Steps: 16 | Train Loss: 0.551 Vali Loss: 34.070 Vali Acc: 0.374 Test Loss: 34.070 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.5917320251464844
Epoch: 10, Steps: 16 | Train Loss: 0.864 Vali Loss: 35.043 Vali Acc: 0.336 Test Loss: 35.043 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6956751346588135
Epoch: 11, Steps: 16 | Train Loss: 0.347 Vali Loss: 38.352 Vali Acc: 0.336 Test Loss: 38.352 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.40458015267175573
model parameter : 325056081
model size : 1240.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.299252510070801
Epoch: 1, Steps: 16 | Train Loss: 2.217 Vali Loss: 2.348 Vali Acc: 0.389 Test Loss: 2.348 Test Acc: 0.389
Validation loss decreased (inf --> -0.389289).  Saving model ...
Epoch: 2 cost time: 2.5994508266448975
Epoch: 2, Steps: 16 | Train Loss: 0.349 Vali Loss: 7.264 Vali Acc: 0.351 Test Loss: 7.264 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.629007339477539
Epoch: 3, Steps: 16 | Train Loss: 0.355 Vali Loss: 10.172 Vali Acc: 0.359 Test Loss: 10.172 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.555177927017212
Epoch: 4, Steps: 16 | Train Loss: 0.127 Vali Loss: 10.985 Vali Acc: 0.328 Test Loss: 10.985 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5470356941223145
Epoch: 5, Steps: 16 | Train Loss: 0.244 Vali Loss: 16.531 Vali Acc: 0.389 Test Loss: 16.531 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5983333587646484
Epoch: 6, Steps: 16 | Train Loss: 0.392 Vali Loss: 21.421 Vali Acc: 0.366 Test Loss: 21.421 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.586962938308716
Epoch: 7, Steps: 16 | Train Loss: 0.298 Vali Loss: 20.899 Vali Acc: 0.374 Test Loss: 20.899 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5241754055023193
Epoch: 8, Steps: 16 | Train Loss: 1.835 Vali Loss: 22.000 Vali Acc: 0.359 Test Loss: 22.000 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6568515300750732
Epoch: 9, Steps: 16 | Train Loss: 0.342 Vali Loss: 23.703 Vali Acc: 0.366 Test Loss: 23.703 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8016018867492676
Epoch: 10, Steps: 16 | Train Loss: 0.403 Vali Loss: 32.134 Vali Acc: 0.389 Test Loss: 32.134 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6169941425323486
Epoch: 11, Steps: 16 | Train Loss: 0.085 Vali Loss: 39.466 Vali Acc: 0.389 Test Loss: 39.466 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.3893129770992366
model parameter : 325037295
model size : 1239.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7991886138916016
Epoch: 1, Steps: 16 | Train Loss: 1.945 Vali Loss: 5.040 Vali Acc: 0.382 Test Loss: 5.040 Test Acc: 0.382
Validation loss decreased (inf --> -0.381629).  Saving model ...
Epoch: 2 cost time: 2.5235631465911865
Epoch: 2, Steps: 16 | Train Loss: 0.582 Vali Loss: 8.741 Vali Acc: 0.412 Test Loss: 8.741 Test Acc: 0.412
Validation loss decreased (-0.381629 --> -0.412126).  Saving model ...
Epoch: 3 cost time: 2.4580469131469727
Epoch: 3, Steps: 16 | Train Loss: 0.120 Vali Loss: 12.109 Vali Acc: 0.366 Test Loss: 12.109 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.475424289703369
Epoch: 4, Steps: 16 | Train Loss: 0.003 Vali Loss: 12.906 Vali Acc: 0.366 Test Loss: 12.906 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4971301555633545
Epoch: 5, Steps: 16 | Train Loss: 0.004 Vali Loss: 13.708 Vali Acc: 0.344 Test Loss: 13.708 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.682770252227783
Epoch: 6, Steps: 16 | Train Loss: 0.151 Vali Loss: 12.989 Vali Acc: 0.366 Test Loss: 12.989 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5619301795959473
Epoch: 7, Steps: 16 | Train Loss: 0.107 Vali Loss: 18.010 Vali Acc: 0.397 Test Loss: 18.010 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.601468086242676
Epoch: 8, Steps: 16 | Train Loss: 0.102 Vali Loss: 25.600 Vali Acc: 0.489 Test Loss: 25.600 Test Acc: 0.489
Validation loss decreased (-0.412126 --> -0.488294).  Saving model ...
Epoch: 9 cost time: 2.4897968769073486
Epoch: 9, Steps: 16 | Train Loss: 0.479 Vali Loss: 29.218 Vali Acc: 0.397 Test Loss: 29.218 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5181851387023926
Epoch: 10, Steps: 16 | Train Loss: 1.729 Vali Loss: 47.045 Vali Acc: 0.313 Test Loss: 47.045 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.442697048187256
Epoch: 11, Steps: 16 | Train Loss: 5.216 Vali Loss: 62.882 Vali Acc: 0.366 Test Loss: 62.882 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6122469902038574
Epoch: 12, Steps: 16 | Train Loss: 1.566 Vali Loss: 64.850 Vali Acc: 0.366 Test Loss: 64.850 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.580371141433716
Epoch: 13, Steps: 16 | Train Loss: 0.624 Vali Loss: 68.041 Vali Acc: 0.374 Test Loss: 68.041 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.676751136779785
Epoch: 14, Steps: 16 | Train Loss: 0.327 Vali Loss: 83.103 Vali Acc: 0.420 Test Loss: 83.103 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5554873943328857
Epoch: 15, Steps: 16 | Train Loss: 0.000 Vali Loss: 84.080 Vali Acc: 0.443 Test Loss: 84.080 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.561825752258301
Epoch: 16, Steps: 16 | Train Loss: 0.000 Vali Loss: 84.553 Vali Acc: 0.466 Test Loss: 84.553 Test Acc: 0.466
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.5242466926574707
Epoch: 17, Steps: 16 | Train Loss: 0.000 Vali Loss: 84.643 Vali Acc: 0.466 Test Loss: 84.643 Test Acc: 0.466
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5919809341430664
Epoch: 18, Steps: 16 | Train Loss: 0.000 Vali Loss: 84.633 Vali Acc: 0.466 Test Loss: 84.633 Test Acc: 0.466
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324888209
model size : 1239.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.167088985443115
Epoch: 1, Steps: 16 | Train Loss: 1.980 Vali Loss: 3.687 Vali Acc: 0.435 Test Loss: 3.687 Test Acc: 0.435
Validation loss decreased (inf --> -0.435078).  Saving model ...
Epoch: 2 cost time: 2.514608144760132
Epoch: 2, Steps: 16 | Train Loss: 0.220 Vali Loss: 7.793 Vali Acc: 0.366 Test Loss: 7.793 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5111851692199707
Epoch: 3, Steps: 16 | Train Loss: 0.292 Vali Loss: 9.267 Vali Acc: 0.427 Test Loss: 9.267 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.573406219482422
Epoch: 4, Steps: 16 | Train Loss: 0.263 Vali Loss: 14.615 Vali Acc: 0.336 Test Loss: 14.615 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5254759788513184
Epoch: 5, Steps: 16 | Train Loss: 0.194 Vali Loss: 13.848 Vali Acc: 0.397 Test Loss: 13.848 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6744256019592285
Epoch: 6, Steps: 16 | Train Loss: 0.273 Vali Loss: 16.681 Vali Acc: 0.412 Test Loss: 16.681 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.632967233657837
Epoch: 7, Steps: 16 | Train Loss: 0.246 Vali Loss: 23.959 Vali Acc: 0.397 Test Loss: 23.959 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5973284244537354
Epoch: 8, Steps: 16 | Train Loss: 0.542 Vali Loss: 26.041 Vali Acc: 0.321 Test Loss: 26.041 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6825170516967773
Epoch: 9, Steps: 16 | Train Loss: 0.333 Vali Loss: 27.159 Vali Acc: 0.374 Test Loss: 27.159 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.52134108543396
Epoch: 10, Steps: 16 | Train Loss: 0.856 Vali Loss: 32.835 Vali Acc: 0.328 Test Loss: 32.835 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.6011621952056885
Epoch: 11, Steps: 16 | Train Loss: 2.418 Vali Loss: 40.083 Vali Acc: 0.374 Test Loss: 40.083 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 324982263
model size : 1239.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.237847805023193
Epoch: 1, Steps: 16 | Train Loss: 2.292 Vali Loss: 3.732 Vali Acc: 0.435 Test Loss: 3.732 Test Acc: 0.435
Validation loss decreased (inf --> -0.435077).  Saving model ...
Epoch: 2 cost time: 2.596601963043213
Epoch: 2, Steps: 16 | Train Loss: 0.281 Vali Loss: 12.690 Vali Acc: 0.473 Test Loss: 12.690 Test Acc: 0.473
Validation loss decreased (-0.435077 --> -0.473156).  Saving model ...
Epoch: 3 cost time: 2.7772200107574463
Epoch: 3, Steps: 16 | Train Loss: 0.489 Vali Loss: 15.587 Vali Acc: 0.313 Test Loss: 15.587 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6721861362457275
Epoch: 4, Steps: 16 | Train Loss: 0.141 Vali Loss: 16.175 Vali Acc: 0.282 Test Loss: 16.175 Test Acc: 0.282
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6907927989959717
Epoch: 5, Steps: 16 | Train Loss: 0.239 Vali Loss: 16.376 Vali Acc: 0.382 Test Loss: 16.376 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.670727491378784
Epoch: 6, Steps: 16 | Train Loss: 0.023 Vali Loss: 18.444 Vali Acc: 0.382 Test Loss: 18.444 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.7490644454956055
Epoch: 7, Steps: 16 | Train Loss: 0.207 Vali Loss: 19.470 Vali Acc: 0.389 Test Loss: 19.470 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.5958364009857178
Epoch: 8, Steps: 16 | Train Loss: 0.004 Vali Loss: 21.699 Vali Acc: 0.397 Test Loss: 21.699 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.620680093765259
Epoch: 9, Steps: 16 | Train Loss: 0.211 Vali Loss: 21.289 Vali Acc: 0.420 Test Loss: 21.289 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.6004233360290527
Epoch: 10, Steps: 16 | Train Loss: 0.744 Vali Loss: 20.677 Vali Acc: 0.412 Test Loss: 20.677 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6530606746673584
Epoch: 11, Steps: 16 | Train Loss: 2.876 Vali Loss: 23.531 Vali Acc: 0.359 Test Loss: 23.531 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.623321533203125
Epoch: 12, Steps: 16 | Train Loss: 0.650 Vali Loss: 38.077 Vali Acc: 0.351 Test Loss: 38.077 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324938721
model size : 1239.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8637781143188477
Epoch: 1, Steps: 16 | Train Loss: 2.224 Vali Loss: 2.337 Vali Acc: 0.382 Test Loss: 2.337 Test Acc: 0.382
Validation loss decreased (inf --> -0.381656).  Saving model ...
Epoch: 2 cost time: 2.538763999938965
Epoch: 2, Steps: 16 | Train Loss: 0.272 Vali Loss: 6.594 Vali Acc: 0.443 Test Loss: 6.594 Test Acc: 0.443
Validation loss decreased (-0.381656 --> -0.442682).  Saving model ...
Epoch: 3 cost time: 2.4537758827209473
Epoch: 3, Steps: 16 | Train Loss: 0.313 Vali Loss: 8.218 Vali Acc: 0.443 Test Loss: 8.218 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5938076972961426
Epoch: 4, Steps: 16 | Train Loss: 0.017 Vali Loss: 9.428 Vali Acc: 0.351 Test Loss: 9.428 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.504446506500244
Epoch: 5, Steps: 16 | Train Loss: 0.149 Vali Loss: 12.498 Vali Acc: 0.336 Test Loss: 12.498 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5011844635009766
Epoch: 6, Steps: 16 | Train Loss: 0.289 Vali Loss: 14.310 Vali Acc: 0.351 Test Loss: 14.310 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.638490915298462
Epoch: 7, Steps: 16 | Train Loss: 0.553 Vali Loss: 17.553 Vali Acc: 0.351 Test Loss: 17.553 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.520902633666992
Epoch: 8, Steps: 16 | Train Loss: 0.790 Vali Loss: 23.089 Vali Acc: 0.344 Test Loss: 23.089 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6381871700286865
Epoch: 9, Steps: 16 | Train Loss: 1.192 Vali Loss: 27.248 Vali Acc: 0.405 Test Loss: 27.248 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.4424526691436768
Epoch: 10, Steps: 16 | Train Loss: 0.776 Vali Loss: 34.925 Vali Acc: 0.366 Test Loss: 34.925 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.507150888442993
Epoch: 11, Steps: 16 | Train Loss: 0.673 Vali Loss: 42.752 Vali Acc: 0.397 Test Loss: 42.752 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.442434072494507
Epoch: 12, Steps: 16 | Train Loss: 0.618 Vali Loss: 49.741 Vali Acc: 0.382 Test Loss: 49.741 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324827855
model size : 1239.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.020446300506592
Epoch: 1, Steps: 16 | Train Loss: 1.689 Vali Loss: 3.253 Vali Acc: 0.450 Test Loss: 3.253 Test Acc: 0.450
Validation loss decreased (inf --> -0.450349).  Saving model ...
Epoch: 2 cost time: 2.7663841247558594
Epoch: 2, Steps: 16 | Train Loss: 0.312 Vali Loss: 6.757 Vali Acc: 0.466 Test Loss: 6.757 Test Acc: 0.466
Validation loss decreased (-0.450349 --> -0.465581).  Saving model ...
Epoch: 3 cost time: 2.6626875400543213
Epoch: 3, Steps: 16 | Train Loss: 0.494 Vali Loss: 8.114 Vali Acc: 0.473 Test Loss: 8.114 Test Acc: 0.473
Validation loss decreased (-0.465581 --> -0.473201).  Saving model ...
Epoch: 4 cost time: 2.4669189453125
Epoch: 4, Steps: 16 | Train Loss: 0.102 Vali Loss: 8.086 Vali Acc: 0.374 Test Loss: 8.086 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.480492353439331
Epoch: 5, Steps: 16 | Train Loss: 0.060 Vali Loss: 8.935 Vali Acc: 0.389 Test Loss: 8.935 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.472219467163086
Epoch: 6, Steps: 16 | Train Loss: 0.122 Vali Loss: 14.951 Vali Acc: 0.344 Test Loss: 14.951 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8776161670684814
Epoch: 7, Steps: 16 | Train Loss: 0.525 Vali Loss: 18.545 Vali Acc: 0.321 Test Loss: 18.545 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7687625885009766
Epoch: 8, Steps: 16 | Train Loss: 1.014 Vali Loss: 25.007 Vali Acc: 0.382 Test Loss: 25.007 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.6684606075286865
Epoch: 9, Steps: 16 | Train Loss: 1.686 Vali Loss: 26.525 Vali Acc: 0.382 Test Loss: 26.525 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.703327178955078
Epoch: 10, Steps: 16 | Train Loss: 2.208 Vali Loss: 39.695 Vali Acc: 0.351 Test Loss: 39.695 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7235100269317627
Epoch: 11, Steps: 16 | Train Loss: 0.838 Vali Loss: 61.302 Vali Acc: 0.328 Test Loss: 61.302 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8047614097595215
Epoch: 12, Steps: 16 | Train Loss: 0.347 Vali Loss: 64.807 Vali Acc: 0.351 Test Loss: 64.807 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.6405375003814697
Epoch: 13, Steps: 16 | Train Loss: 1.183 Vali Loss: 66.735 Vali Acc: 0.366 Test Loss: 66.735 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324864449
model size : 1239.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.175484657287598
Epoch: 1, Steps: 16 | Train Loss: 1.659 Vali Loss: 3.424 Vali Acc: 0.450 Test Loss: 3.424 Test Acc: 0.450
Validation loss decreased (inf --> -0.450347).  Saving model ...
Epoch: 2 cost time: 2.598281145095825
Epoch: 2, Steps: 16 | Train Loss: 0.287 Vali Loss: 6.191 Vali Acc: 0.420 Test Loss: 6.191 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4497833251953125
Epoch: 3, Steps: 16 | Train Loss: 0.212 Vali Loss: 8.066 Vali Acc: 0.382 Test Loss: 8.066 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6589972972869873
Epoch: 4, Steps: 16 | Train Loss: 0.101 Vali Loss: 9.610 Vali Acc: 0.351 Test Loss: 9.610 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.681154489517212
Epoch: 5, Steps: 16 | Train Loss: 0.007 Vali Loss: 11.053 Vali Acc: 0.389 Test Loss: 11.053 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6753859519958496
Epoch: 6, Steps: 16 | Train Loss: 0.123 Vali Loss: 13.365 Vali Acc: 0.359 Test Loss: 13.365 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6394269466400146
Epoch: 7, Steps: 16 | Train Loss: 0.151 Vali Loss: 14.548 Vali Acc: 0.443 Test Loss: 14.548 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.494135856628418
Epoch: 8, Steps: 16 | Train Loss: 0.516 Vali Loss: 21.002 Vali Acc: 0.435 Test Loss: 21.002 Test Acc: 0.435
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.36122989654541
Epoch: 9, Steps: 16 | Train Loss: 0.392 Vali Loss: 32.394 Vali Acc: 0.366 Test Loss: 32.394 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4753127098083496
Epoch: 10, Steps: 16 | Train Loss: 1.275 Vali Loss: 40.736 Vali Acc: 0.336 Test Loss: 40.736 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.5439400672912598
Epoch: 11, Steps: 16 | Train Loss: 1.168 Vali Loss: 35.229 Vali Acc: 0.374 Test Loss: 35.229 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 324921719
model size : 1239.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.644117832183838
Epoch: 1, Steps: 16 | Train Loss: 1.668 Vali Loss: 3.178 Vali Acc: 0.458 Test Loss: 3.178 Test Acc: 0.458
Validation loss decreased (inf --> -0.457983).  Saving model ...
Epoch: 2 cost time: 2.495966672897339
Epoch: 2, Steps: 16 | Train Loss: 0.299 Vali Loss: 6.111 Vali Acc: 0.328 Test Loss: 6.111 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.473860502243042
Epoch: 3, Steps: 16 | Train Loss: 0.174 Vali Loss: 9.219 Vali Acc: 0.313 Test Loss: 9.219 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6242642402648926
Epoch: 4, Steps: 16 | Train Loss: 0.201 Vali Loss: 10.988 Vali Acc: 0.405 Test Loss: 10.988 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.522569417953491
Epoch: 5, Steps: 16 | Train Loss: 0.173 Vali Loss: 12.500 Vali Acc: 0.397 Test Loss: 12.500 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.4696478843688965
Epoch: 6, Steps: 16 | Train Loss: 0.144 Vali Loss: 14.435 Vali Acc: 0.405 Test Loss: 14.435 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5022928714752197
Epoch: 7, Steps: 16 | Train Loss: 0.215 Vali Loss: 18.738 Vali Acc: 0.336 Test Loss: 18.738 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.484340190887451
Epoch: 8, Steps: 16 | Train Loss: 0.214 Vali Loss: 25.732 Vali Acc: 0.366 Test Loss: 25.732 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6191956996917725
Epoch: 9, Steps: 16 | Train Loss: 0.416 Vali Loss: 30.029 Vali Acc: 0.351 Test Loss: 30.029 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.459805727005005
Epoch: 10, Steps: 16 | Train Loss: 0.236 Vali Loss: 32.277 Vali Acc: 0.328 Test Loss: 32.277 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.546231508255005
Epoch: 11, Steps: 16 | Train Loss: 0.786 Vali Loss: 32.849 Vali Acc: 0.412 Test Loss: 32.849 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324873137
model size : 1239.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.676030397415161
Epoch: 1, Steps: 16 | Train Loss: 1.781 Vali Loss: 3.337 Vali Acc: 0.412 Test Loss: 3.337 Test Acc: 0.412
Validation loss decreased (inf --> -0.412180).  Saving model ...
Epoch: 2 cost time: 2.602320671081543
Epoch: 2, Steps: 16 | Train Loss: 0.381 Vali Loss: 6.236 Vali Acc: 0.420 Test Loss: 6.236 Test Acc: 0.420
Validation loss decreased (-0.412180 --> -0.419785).  Saving model ...
Epoch: 3 cost time: 2.566216468811035
Epoch: 3, Steps: 16 | Train Loss: 0.209 Vali Loss: 8.337 Vali Acc: 0.496 Test Loss: 8.337 Test Acc: 0.496
Validation loss decreased (-0.419785 --> -0.496100).  Saving model ...
Epoch: 4 cost time: 2.518369197845459
Epoch: 4, Steps: 16 | Train Loss: 0.387 Vali Loss: 10.463 Vali Acc: 0.298 Test Loss: 10.463 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.440812110900879
Epoch: 5, Steps: 16 | Train Loss: 0.147 Vali Loss: 12.647 Vali Acc: 0.435 Test Loss: 12.647 Test Acc: 0.435
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5074989795684814
Epoch: 6, Steps: 16 | Train Loss: 0.192 Vali Loss: 13.712 Vali Acc: 0.427 Test Loss: 13.712 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.469883918762207
Epoch: 7, Steps: 16 | Train Loss: 0.200 Vali Loss: 16.705 Vali Acc: 0.412 Test Loss: 16.705 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.5453858375549316
Epoch: 8, Steps: 16 | Train Loss: 0.377 Vali Loss: 23.233 Vali Acc: 0.389 Test Loss: 23.233 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.663832664489746
Epoch: 9, Steps: 16 | Train Loss: 0.487 Vali Loss: 23.779 Vali Acc: 0.435 Test Loss: 23.779 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.728499412536621
Epoch: 10, Steps: 16 | Train Loss: 0.450 Vali Loss: 25.512 Vali Acc: 0.382 Test Loss: 25.512 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.584346055984497
Epoch: 11, Steps: 16 | Train Loss: 5.103 Vali Loss: 30.054 Vali Acc: 0.382 Test Loss: 30.054 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5573551654815674
Epoch: 12, Steps: 16 | Train Loss: 0.521 Vali Loss: 33.355 Vali Acc: 0.412 Test Loss: 33.355 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.588899612426758
Epoch: 13, Steps: 16 | Train Loss: 0.815 Vali Loss: 41.468 Vali Acc: 0.443 Test Loss: 41.468 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 324772271
model size : 1238.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6880640983581543
Epoch: 1, Steps: 16 | Train Loss: 2.237 Vali Loss: 3.937 Vali Acc: 0.405 Test Loss: 3.937 Test Acc: 0.405
Validation loss decreased (inf --> -0.404541).  Saving model ...
Epoch: 2 cost time: 2.6455698013305664
Epoch: 2, Steps: 16 | Train Loss: 0.428 Vali Loss: 7.107 Vali Acc: 0.420 Test Loss: 7.107 Test Acc: 0.420
Validation loss decreased (-0.404541 --> -0.419776).  Saving model ...
Epoch: 3 cost time: 2.6132588386535645
Epoch: 3, Steps: 16 | Train Loss: 0.085 Vali Loss: 8.043 Vali Acc: 0.412 Test Loss: 8.043 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5515968799591064
Epoch: 4, Steps: 16 | Train Loss: 0.227 Vali Loss: 9.097 Vali Acc: 0.374 Test Loss: 9.097 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4912428855895996
Epoch: 5, Steps: 16 | Train Loss: 0.179 Vali Loss: 10.565 Vali Acc: 0.443 Test Loss: 10.565 Test Acc: 0.443
Validation loss decreased (-0.419776 --> -0.442642).  Saving model ...
Epoch: 6 cost time: 2.478541612625122
Epoch: 6, Steps: 16 | Train Loss: 0.455 Vali Loss: 14.984 Vali Acc: 0.443 Test Loss: 14.984 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5198748111724854
Epoch: 7, Steps: 16 | Train Loss: 0.513 Vali Loss: 16.940 Vali Acc: 0.366 Test Loss: 16.940 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7736990451812744
Epoch: 8, Steps: 16 | Train Loss: 0.423 Vali Loss: 21.672 Vali Acc: 0.427 Test Loss: 21.672 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7282238006591797
Epoch: 9, Steps: 16 | Train Loss: 0.500 Vali Loss: 23.995 Vali Acc: 0.466 Test Loss: 23.995 Test Acc: 0.466
Validation loss decreased (-0.442642 --> -0.465409).  Saving model ...
Epoch: 10 cost time: 2.6995112895965576
Epoch: 10, Steps: 16 | Train Loss: 0.230 Vali Loss: 28.459 Vali Acc: 0.382 Test Loss: 28.459 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4745032787323
Epoch: 11, Steps: 16 | Train Loss: 0.388 Vali Loss: 31.324 Vali Acc: 0.420 Test Loss: 31.324 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4005250930786133
Epoch: 12, Steps: 16 | Train Loss: 0.493 Vali Loss: 37.284 Vali Acc: 0.420 Test Loss: 37.284 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.547748327255249
Epoch: 13, Steps: 16 | Train Loss: 0.707 Vali Loss: 44.723 Vali Acc: 0.389 Test Loss: 44.723 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.60306978225708
Epoch: 14, Steps: 16 | Train Loss: 1.275 Vali Loss: 49.142 Vali Acc: 0.328 Test Loss: 49.142 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.623830556869507
Epoch: 15, Steps: 16 | Train Loss: 1.217 Vali Loss: 52.747 Vali Acc: 0.351 Test Loss: 52.747 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.69067120552063
Epoch: 16, Steps: 16 | Train Loss: 0.596 Vali Loss: 64.282 Vali Acc: 0.366 Test Loss: 64.282 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6661641597747803
Epoch: 17, Steps: 16 | Train Loss: 2.488 Vali Loss: 106.362 Vali Acc: 0.443 Test Loss: 106.362 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7061057090759277
Epoch: 18, Steps: 16 | Train Loss: 2.430 Vali Loss: 133.276 Vali Acc: 0.435 Test Loss: 133.276 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.632943630218506
Epoch: 19, Steps: 16 | Train Loss: 0.314 Vali Loss: 137.954 Vali Acc: 0.427 Test Loss: 137.954 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324744753
model size : 1238.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.194154500961304
Epoch: 1, Steps: 16 | Train Loss: 1.685 Vali Loss: 2.875 Vali Acc: 0.427 Test Loss: 2.875 Test Acc: 0.427
Validation loss decreased (inf --> -0.427452).  Saving model ...
Epoch: 2 cost time: 2.6770033836364746
Epoch: 2, Steps: 16 | Train Loss: 0.142 Vali Loss: 5.439 Vali Acc: 0.458 Test Loss: 5.439 Test Acc: 0.458
Validation loss decreased (-0.427452 --> -0.457961).  Saving model ...
Epoch: 3 cost time: 2.678028106689453
Epoch: 3, Steps: 16 | Train Loss: 0.159 Vali Loss: 7.448 Vali Acc: 0.420 Test Loss: 7.448 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6466245651245117
Epoch: 4, Steps: 16 | Train Loss: 0.154 Vali Loss: 8.667 Vali Acc: 0.374 Test Loss: 8.667 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.712489604949951
Epoch: 5, Steps: 16 | Train Loss: 0.048 Vali Loss: 9.882 Vali Acc: 0.466 Test Loss: 9.882 Test Acc: 0.466
Validation loss decreased (-0.457961 --> -0.465550).  Saving model ...
Epoch: 6 cost time: 2.8162364959716797
Epoch: 6, Steps: 16 | Train Loss: 0.445 Vali Loss: 13.287 Vali Acc: 0.359 Test Loss: 13.287 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7428438663482666
Epoch: 7, Steps: 16 | Train Loss: 2.288 Vali Loss: 27.859 Vali Acc: 0.405 Test Loss: 27.859 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7444772720336914
Epoch: 8, Steps: 16 | Train Loss: 0.669 Vali Loss: 46.619 Vali Acc: 0.420 Test Loss: 46.619 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.739259719848633
Epoch: 9, Steps: 16 | Train Loss: 1.162 Vali Loss: 56.489 Vali Acc: 0.435 Test Loss: 56.489 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6562674045562744
Epoch: 10, Steps: 16 | Train Loss: 1.651 Vali Loss: 59.896 Vali Acc: 0.412 Test Loss: 59.896 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.780503749847412
Epoch: 11, Steps: 16 | Train Loss: 0.432 Vali Loss: 64.870 Vali Acc: 0.366 Test Loss: 64.870 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7632837295532227
Epoch: 12, Steps: 16 | Train Loss: 0.413 Vali Loss: 76.130 Vali Acc: 0.405 Test Loss: 76.130 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.6112053394317627
Epoch: 13, Steps: 16 | Train Loss: 0.320 Vali Loss: 74.412 Vali Acc: 0.412 Test Loss: 74.412 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.748873472213745
Epoch: 14, Steps: 16 | Train Loss: 0.465 Vali Loss: 79.909 Vali Acc: 0.405 Test Loss: 79.909 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.7251954078674316
Epoch: 15, Steps: 16 | Train Loss: 0.897 Vali Loss: 89.218 Vali Acc: 0.359 Test Loss: 89.218 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324772343
model size : 1238.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.907496213912964
Epoch: 1, Steps: 16 | Train Loss: 1.895 Vali Loss: 3.974 Vali Acc: 0.420 Test Loss: 3.974 Test Acc: 0.420
Validation loss decreased (inf --> -0.419808).  Saving model ...
Epoch: 2 cost time: 2.616434097290039
Epoch: 2, Steps: 16 | Train Loss: 0.440 Vali Loss: 5.212 Vali Acc: 0.443 Test Loss: 5.212 Test Acc: 0.443
Validation loss decreased (-0.419808 --> -0.442696).  Saving model ...
Epoch: 3 cost time: 2.6401195526123047
Epoch: 3, Steps: 16 | Train Loss: 0.152 Vali Loss: 8.250 Vali Acc: 0.359 Test Loss: 8.250 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.568605422973633
Epoch: 4, Steps: 16 | Train Loss: 0.059 Vali Loss: 9.637 Vali Acc: 0.382 Test Loss: 9.637 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.591331720352173
Epoch: 5, Steps: 16 | Train Loss: 0.129 Vali Loss: 9.226 Vali Acc: 0.443 Test Loss: 9.226 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.683420181274414
Epoch: 6, Steps: 16 | Train Loss: 0.321 Vali Loss: 10.895 Vali Acc: 0.397 Test Loss: 10.895 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5811350345611572
Epoch: 7, Steps: 16 | Train Loss: 0.847 Vali Loss: 22.910 Vali Acc: 0.305 Test Loss: 22.910 Test Acc: 0.305
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.646676540374756
Epoch: 8, Steps: 16 | Train Loss: 0.232 Vali Loss: 29.819 Vali Acc: 0.328 Test Loss: 29.819 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.609696865081787
Epoch: 9, Steps: 16 | Train Loss: 0.180 Vali Loss: 35.428 Vali Acc: 0.336 Test Loss: 35.428 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5788912773132324
Epoch: 10, Steps: 16 | Train Loss: 0.865 Vali Loss: 35.505 Vali Acc: 0.336 Test Loss: 35.505 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.517887830734253
Epoch: 11, Steps: 16 | Train Loss: 2.340 Vali Loss: 52.872 Vali Acc: 0.420 Test Loss: 52.872 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.4626612663269043
Epoch: 12, Steps: 16 | Train Loss: 2.218 Vali Loss: 57.578 Vali Acc: 0.405 Test Loss: 57.578 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 325016769
model size : 1239.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.061094760894775
Epoch: 1, Steps: 16 | Train Loss: 1.908 Vali Loss: 4.898 Vali Acc: 0.435 Test Loss: 4.898 Test Acc: 0.435
Validation loss decreased (inf --> -0.435066).  Saving model ...
Epoch: 2 cost time: 2.736234426498413
Epoch: 2, Steps: 16 | Train Loss: 0.281 Vali Loss: 8.600 Vali Acc: 0.405 Test Loss: 8.600 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6621346473693848
Epoch: 3, Steps: 16 | Train Loss: 0.215 Vali Loss: 10.849 Vali Acc: 0.397 Test Loss: 10.849 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6320178508758545
Epoch: 4, Steps: 16 | Train Loss: 0.446 Vali Loss: 12.328 Vali Acc: 0.382 Test Loss: 12.328 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6868033409118652
Epoch: 5, Steps: 16 | Train Loss: 0.204 Vali Loss: 18.979 Vali Acc: 0.366 Test Loss: 18.979 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.597102642059326
Epoch: 6, Steps: 16 | Train Loss: 0.053 Vali Loss: 19.378 Vali Acc: 0.389 Test Loss: 19.378 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.5914244651794434
Epoch: 7, Steps: 16 | Train Loss: 0.000 Vali Loss: 20.108 Vali Acc: 0.344 Test Loss: 20.108 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7332210540771484
Epoch: 8, Steps: 16 | Train Loss: 0.001 Vali Loss: 20.144 Vali Acc: 0.328 Test Loss: 20.144 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.775326728820801
Epoch: 9, Steps: 16 | Train Loss: 0.000 Vali Loss: 19.938 Vali Acc: 0.359 Test Loss: 19.938 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7337629795074463
Epoch: 10, Steps: 16 | Train Loss: 0.000 Vali Loss: 19.896 Vali Acc: 0.374 Test Loss: 19.896 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.756328582763672
Epoch: 11, Steps: 16 | Train Loss: 0.000 Vali Loss: 19.883 Vali Acc: 0.366 Test Loss: 19.883 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 324884175
model size : 1239.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8429114818573
Epoch: 1, Steps: 16 | Train Loss: 1.784 Vali Loss: 3.407 Vali Acc: 0.382 Test Loss: 3.407 Test Acc: 0.382
Validation loss decreased (inf --> -0.381645).  Saving model ...
Epoch: 2 cost time: 2.7708895206451416
Epoch: 2, Steps: 16 | Train Loss: 0.618 Vali Loss: 6.910 Vali Acc: 0.481 Test Loss: 6.910 Test Acc: 0.481
Validation loss decreased (-0.381645 --> -0.480847).  Saving model ...
Epoch: 3 cost time: 2.616196870803833
Epoch: 3, Steps: 16 | Train Loss: 0.021 Vali Loss: 7.051 Vali Acc: 0.374 Test Loss: 7.051 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5816776752471924
Epoch: 4, Steps: 16 | Train Loss: 0.134 Vali Loss: 8.397 Vali Acc: 0.366 Test Loss: 8.397 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5783004760742188
Epoch: 5, Steps: 16 | Train Loss: 0.305 Vali Loss: 14.206 Vali Acc: 0.397 Test Loss: 14.206 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7543373107910156
Epoch: 6, Steps: 16 | Train Loss: 0.295 Vali Loss: 14.584 Vali Acc: 0.405 Test Loss: 14.584 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4659743309020996
Epoch: 7, Steps: 16 | Train Loss: 0.351 Vali Loss: 15.195 Vali Acc: 0.405 Test Loss: 15.195 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.566598892211914
Epoch: 8, Steps: 16 | Train Loss: 0.452 Vali Loss: 22.354 Vali Acc: 0.489 Test Loss: 22.354 Test Acc: 0.489
Validation loss decreased (-0.480847 --> -0.488326).  Saving model ...
Epoch: 9 cost time: 2.73649525642395
Epoch: 9, Steps: 16 | Train Loss: 0.006 Vali Loss: 29.615 Vali Acc: 0.397 Test Loss: 29.615 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.584958076477051
Epoch: 10, Steps: 16 | Train Loss: 1.151 Vali Loss: 30.844 Vali Acc: 0.427 Test Loss: 30.844 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5130794048309326
Epoch: 11, Steps: 16 | Train Loss: 0.118 Vali Loss: 49.235 Vali Acc: 0.420 Test Loss: 49.235 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.583463191986084
Epoch: 12, Steps: 16 | Train Loss: 1.057 Vali Loss: 53.369 Vali Acc: 0.366 Test Loss: 53.369 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.752329111099243
Epoch: 13, Steps: 16 | Train Loss: 1.512 Vali Loss: 60.998 Vali Acc: 0.420 Test Loss: 60.998 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.5036733150482178
Epoch: 14, Steps: 16 | Train Loss: 1.878 Vali Loss: 67.221 Vali Acc: 0.374 Test Loss: 67.221 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.475618362426758
Epoch: 15, Steps: 16 | Train Loss: 2.452 Vali Loss: 88.717 Vali Acc: 0.389 Test Loss: 88.717 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5959632396698
Epoch: 16, Steps: 16 | Train Loss: 11.871 Vali Loss: 99.677 Vali Acc: 0.351 Test Loss: 99.677 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.567103862762451
Epoch: 17, Steps: 16 | Train Loss: 0.329 Vali Loss: 105.240 Vali Acc: 0.321 Test Loss: 105.240 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.5135114192962646
Epoch: 18, Steps: 16 | Train Loss: 1.436 Vali Loss: 106.694 Vali Acc: 0.351 Test Loss: 106.694 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 325004129
model size : 1239.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8059463500976562
Epoch: 1, Steps: 16 | Train Loss: 1.812 Vali Loss: 4.093 Vali Acc: 0.427 Test Loss: 4.093 Test Acc: 0.427
Validation loss decreased (inf --> -0.427440).  Saving model ...
Epoch: 2 cost time: 2.594421863555908
Epoch: 2, Steps: 16 | Train Loss: 0.170 Vali Loss: 7.151 Vali Acc: 0.336 Test Loss: 7.151 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5973198413848877
Epoch: 3, Steps: 16 | Train Loss: 0.113 Vali Loss: 8.121 Vali Acc: 0.382 Test Loss: 8.121 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.62670636177063
Epoch: 4, Steps: 16 | Train Loss: 0.188 Vali Loss: 8.023 Vali Acc: 0.351 Test Loss: 8.023 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5772879123687744
Epoch: 5, Steps: 16 | Train Loss: 0.120 Vali Loss: 11.106 Vali Acc: 0.397 Test Loss: 11.106 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5235507488250732
Epoch: 6, Steps: 16 | Train Loss: 0.276 Vali Loss: 15.509 Vali Acc: 0.397 Test Loss: 15.509 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.713696241378784
Epoch: 7, Steps: 16 | Train Loss: 0.240 Vali Loss: 21.528 Vali Acc: 0.405 Test Loss: 21.528 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.537510871887207
Epoch: 8, Steps: 16 | Train Loss: 2.010 Vali Loss: 29.010 Vali Acc: 0.336 Test Loss: 29.010 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.5829861164093018
Epoch: 9, Steps: 16 | Train Loss: 1.061 Vali Loss: 30.877 Vali Acc: 0.366 Test Loss: 30.877 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.4588396549224854
Epoch: 10, Steps: 16 | Train Loss: 0.966 Vali Loss: 33.879 Vali Acc: 0.382 Test Loss: 33.879 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.7675890922546387
Epoch: 11, Steps: 16 | Train Loss: 0.991 Vali Loss: 57.239 Vali Acc: 0.443 Test Loss: 57.239 Test Acc: 0.443
Validation loss decreased (-0.427440 --> -0.442176).  Saving model ...
Epoch: 12 cost time: 2.581745147705078
Epoch: 12, Steps: 16 | Train Loss: 1.990 Vali Loss: 80.385 Vali Acc: 0.366 Test Loss: 80.385 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.564352035522461
Epoch: 13, Steps: 16 | Train Loss: 1.580 Vali Loss: 86.619 Vali Acc: 0.382 Test Loss: 86.619 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6143596172332764
Epoch: 14, Steps: 16 | Train Loss: 0.712 Vali Loss: 81.709 Vali Acc: 0.405 Test Loss: 81.709 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.475175142288208
Epoch: 15, Steps: 16 | Train Loss: 0.438 Vali Loss: 83.258 Vali Acc: 0.405 Test Loss: 83.258 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.839062213897705
Epoch: 16, Steps: 16 | Train Loss: 1.867 Vali Loss: 84.098 Vali Acc: 0.382 Test Loss: 84.098 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.638155698776245
Epoch: 17, Steps: 16 | Train Loss: 1.553 Vali Loss: 78.309 Vali Acc: 0.321 Test Loss: 78.309 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.7005696296691895
Epoch: 18, Steps: 16 | Train Loss: 0.217 Vali Loss: 77.926 Vali Acc: 0.359 Test Loss: 77.926 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.496222972869873
Epoch: 19, Steps: 16 | Train Loss: 0.000 Vali Loss: 78.710 Vali Acc: 0.374 Test Loss: 78.710 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6447722911834717
Epoch: 20, Steps: 16 | Train Loss: 0.000 Vali Loss: 79.153 Vali Acc: 0.382 Test Loss: 79.153 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.7614078521728516
Epoch: 21, Steps: 16 | Train Loss: 0.000 Vali Loss: 79.242 Vali Acc: 0.382 Test Loss: 79.242 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm256_cs857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324944759
model size : 1239.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8660998344421387
Epoch: 1, Steps: 16 | Train Loss: 2.188 Vali Loss: 3.196 Vali Acc: 0.450 Test Loss: 3.196 Test Acc: 0.450
Validation loss decreased (inf --> -0.450350).  Saving model ...
Epoch: 2 cost time: 2.4278438091278076
Epoch: 2, Steps: 16 | Train Loss: 0.455 Vali Loss: 6.388 Vali Acc: 0.489 Test Loss: 6.388 Test Acc: 0.489
Validation loss decreased (-0.450350 --> -0.488486).  Saving model ...
Epoch: 3 cost time: 2.4744105339050293
Epoch: 3, Steps: 16 | Train Loss: 0.187 Vali Loss: 10.080 Vali Acc: 0.351 Test Loss: 10.080 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.442067861557007
Epoch: 4, Steps: 16 | Train Loss: 0.169 Vali Loss: 9.714 Vali Acc: 0.420 Test Loss: 9.714 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5464751720428467
Epoch: 5, Steps: 16 | Train Loss: 0.226 Vali Loss: 12.244 Vali Acc: 0.405 Test Loss: 12.244 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.506725549697876
Epoch: 6, Steps: 16 | Train Loss: 0.549 Vali Loss: 16.243 Vali Acc: 0.321 Test Loss: 16.243 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5331239700317383
Epoch: 7, Steps: 16 | Train Loss: 0.383 Vali Loss: 18.281 Vali Acc: 0.366 Test Loss: 18.281 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.541177749633789
Epoch: 8, Steps: 16 | Train Loss: 0.459 Vali Loss: 20.994 Vali Acc: 0.336 Test Loss: 20.994 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6400322914123535
Epoch: 9, Steps: 16 | Train Loss: 0.573 Vali Loss: 21.282 Vali Acc: 0.374 Test Loss: 21.282 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.470521926879883
Epoch: 10, Steps: 16 | Train Loss: 0.990 Vali Loss: 32.968 Vali Acc: 0.366 Test Loss: 32.968 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.4380176067352295
Epoch: 11, Steps: 16 | Train Loss: 0.531 Vali Loss: 55.833 Vali Acc: 0.344 Test Loss: 55.833 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.424520254135132
Epoch: 12, Steps: 16 | Train Loss: 0.588 Vali Loss: 74.848 Vali Acc: 0.374 Test Loss: 74.848 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324869409
model size : 1239.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs5995_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.936321973800659
Epoch: 1, Steps: 16 | Train Loss: 1.759 Vali Loss: 3.698 Vali Acc: 0.443 Test Loss: 3.698 Test Acc: 0.443
Validation loss decreased (inf --> -0.442711).  Saving model ...
Epoch: 2 cost time: 2.653780221939087
Epoch: 2, Steps: 16 | Train Loss: 0.342 Vali Loss: 8.296 Vali Acc: 0.359 Test Loss: 8.296 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.6139469146728516
Epoch: 3, Steps: 16 | Train Loss: 0.371 Vali Loss: 10.401 Vali Acc: 0.328 Test Loss: 10.401 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8068416118621826
Epoch: 4, Steps: 16 | Train Loss: 0.462 Vali Loss: 10.720 Vali Acc: 0.405 Test Loss: 10.720 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.569972276687622
Epoch: 5, Steps: 16 | Train Loss: 0.164 Vali Loss: 11.146 Vali Acc: 0.427 Test Loss: 11.146 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6512701511383057
Epoch: 6, Steps: 16 | Train Loss: 0.222 Vali Loss: 12.734 Vali Acc: 0.420 Test Loss: 12.734 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.738952875137329
Epoch: 7, Steps: 16 | Train Loss: 0.262 Vali Loss: 16.811 Vali Acc: 0.382 Test Loss: 16.811 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5136585235595703
Epoch: 8, Steps: 16 | Train Loss: 0.072 Vali Loss: 24.945 Vali Acc: 0.374 Test Loss: 24.945 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.6432840824127197
Epoch: 9, Steps: 16 | Train Loss: 0.938 Vali Loss: 21.799 Vali Acc: 0.344 Test Loss: 21.799 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.563992977142334
Epoch: 10, Steps: 16 | Train Loss: 0.530 Vali Loss: 26.230 Vali Acc: 0.351 Test Loss: 26.230 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4346067905426025
Epoch: 11, Steps: 16 | Train Loss: 0.715 Vali Loss: 41.555 Vali Acc: 0.397 Test Loss: 41.555 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs5995_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324695599
model size : 1238.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs4496_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8126344680786133
Epoch: 1, Steps: 16 | Train Loss: 1.945 Vali Loss: 3.302 Vali Acc: 0.366 Test Loss: 3.302 Test Acc: 0.366
Validation loss decreased (inf --> -0.366379).  Saving model ...
Epoch: 2 cost time: 2.432419538497925
Epoch: 2, Steps: 16 | Train Loss: 0.246 Vali Loss: 7.729 Vali Acc: 0.366 Test Loss: 7.729 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.525226593017578
Epoch: 3, Steps: 16 | Train Loss: 0.424 Vali Loss: 9.252 Vali Acc: 0.397 Test Loss: 9.252 Test Acc: 0.397
Validation loss decreased (-0.366379 --> -0.396854).  Saving model ...
Epoch: 4 cost time: 2.5275583267211914
Epoch: 4, Steps: 16 | Train Loss: 0.013 Vali Loss: 10.127 Vali Acc: 0.435 Test Loss: 10.127 Test Acc: 0.435
Validation loss decreased (-0.396854 --> -0.435013).  Saving model ...
Epoch: 5 cost time: 2.665985584259033
Epoch: 5, Steps: 16 | Train Loss: 0.157 Vali Loss: 10.767 Vali Acc: 0.397 Test Loss: 10.767 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6532607078552246
Epoch: 6, Steps: 16 | Train Loss: 0.209 Vali Loss: 11.394 Vali Acc: 0.420 Test Loss: 11.394 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6427407264709473
Epoch: 7, Steps: 16 | Train Loss: 0.212 Vali Loss: 12.352 Vali Acc: 0.435 Test Loss: 12.352 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4903030395507812
Epoch: 8, Steps: 16 | Train Loss: 1.318 Vali Loss: 21.647 Vali Acc: 0.466 Test Loss: 21.647 Test Acc: 0.466
Validation loss decreased (-0.435013 --> -0.465432).  Saving model ...
Epoch: 9 cost time: 2.5716660022735596
Epoch: 9, Steps: 16 | Train Loss: 1.563 Vali Loss: 43.289 Vali Acc: 0.427 Test Loss: 43.289 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.520461082458496
Epoch: 10, Steps: 16 | Train Loss: 3.592 Vali Loss: 61.087 Vali Acc: 0.374 Test Loss: 61.087 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.545248031616211
Epoch: 11, Steps: 16 | Train Loss: 0.691 Vali Loss: 52.491 Vali Acc: 0.321 Test Loss: 52.491 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.5433504581451416
Epoch: 12, Steps: 16 | Train Loss: 1.000 Vali Loss: 54.196 Vali Acc: 0.344 Test Loss: 54.196 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.4768245220184326
Epoch: 13, Steps: 16 | Train Loss: 1.785 Vali Loss: 65.007 Vali Acc: 0.313 Test Loss: 65.007 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.456583261489868
Epoch: 14, Steps: 16 | Train Loss: 0.561 Vali Loss: 72.458 Vali Acc: 0.305 Test Loss: 72.458 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5266799926757812
Epoch: 15, Steps: 16 | Train Loss: 1.976 Vali Loss: 77.402 Vali Acc: 0.305 Test Loss: 77.402 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4730141162872314
Epoch: 16, Steps: 16 | Train Loss: 0.196 Vali Loss: 90.399 Vali Acc: 0.321 Test Loss: 90.399 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6132993698120117
Epoch: 17, Steps: 16 | Train Loss: 0.293 Vali Loss: 102.647 Vali Acc: 0.313 Test Loss: 102.647 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.663433313369751
Epoch: 18, Steps: 16 | Train Loss: 0.243 Vali Loss: 109.402 Vali Acc: 0.359 Test Loss: 109.402 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs4496_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324581697
model size : 1238.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.824779510498047
Epoch: 1, Steps: 16 | Train Loss: 1.721 Vali Loss: 3.457 Vali Acc: 0.405 Test Loss: 3.457 Test Acc: 0.405
Validation loss decreased (inf --> -0.404546).  Saving model ...
Epoch: 2 cost time: 2.6063272953033447
Epoch: 2, Steps: 16 | Train Loss: 0.385 Vali Loss: 7.202 Vali Acc: 0.412 Test Loss: 7.202 Test Acc: 0.412
Validation loss decreased (-0.404546 --> -0.412142).  Saving model ...
Epoch: 3 cost time: 2.5909128189086914
Epoch: 3, Steps: 16 | Train Loss: 0.082 Vali Loss: 9.636 Vali Acc: 0.374 Test Loss: 9.636 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.460461139678955
Epoch: 4, Steps: 16 | Train Loss: 0.155 Vali Loss: 10.329 Vali Acc: 0.366 Test Loss: 10.329 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.59214186668396
Epoch: 5, Steps: 16 | Train Loss: 0.015 Vali Loss: 11.879 Vali Acc: 0.328 Test Loss: 11.879 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.6071369647979736
Epoch: 6, Steps: 16 | Train Loss: 0.151 Vali Loss: 14.603 Vali Acc: 0.366 Test Loss: 14.603 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5039167404174805
Epoch: 7, Steps: 16 | Train Loss: 0.333 Vali Loss: 16.164 Vali Acc: 0.466 Test Loss: 16.164 Test Acc: 0.466
Validation loss decreased (-0.412142 --> -0.465487).  Saving model ...
Epoch: 8 cost time: 2.530000925064087
Epoch: 8, Steps: 16 | Train Loss: 0.987 Vali Loss: 26.460 Vali Acc: 0.397 Test Loss: 26.460 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.511215925216675
Epoch: 9, Steps: 16 | Train Loss: 0.910 Vali Loss: 37.966 Vali Acc: 0.351 Test Loss: 37.966 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5657920837402344
Epoch: 10, Steps: 16 | Train Loss: 2.849 Vali Loss: 41.669 Vali Acc: 0.321 Test Loss: 41.669 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5105395317077637
Epoch: 11, Steps: 16 | Train Loss: 0.796 Vali Loss: 63.476 Vali Acc: 0.344 Test Loss: 63.476 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6232540607452393
Epoch: 12, Steps: 16 | Train Loss: 1.347 Vali Loss: 78.488 Vali Acc: 0.412 Test Loss: 78.488 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.622511386871338
Epoch: 13, Steps: 16 | Train Loss: 0.745 Vali Loss: 58.427 Vali Acc: 0.351 Test Loss: 58.427 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.6767330169677734
Epoch: 14, Steps: 16 | Train Loss: 0.614 Vali Loss: 65.150 Vali Acc: 0.366 Test Loss: 65.150 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.7442901134490967
Epoch: 15, Steps: 16 | Train Loss: 1.387 Vali Loss: 76.637 Vali Acc: 0.389 Test Loss: 76.637 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.703556537628174
Epoch: 16, Steps: 16 | Train Loss: 0.090 Vali Loss: 96.872 Vali Acc: 0.382 Test Loss: 96.872 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5487735271453857
Epoch: 17, Steps: 16 | Train Loss: 0.584 Vali Loss: 97.236 Vali Acc: 0.366 Test Loss: 97.236 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324542167
model size : 1238.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.821713924407959
Epoch: 1, Steps: 16 | Train Loss: 2.009 Vali Loss: 3.276 Vali Acc: 0.435 Test Loss: 3.276 Test Acc: 0.435
Validation loss decreased (inf --> -0.435082).  Saving model ...
Epoch: 2 cost time: 2.550320863723755
Epoch: 2, Steps: 16 | Train Loss: 0.446 Vali Loss: 5.273 Vali Acc: 0.458 Test Loss: 5.273 Test Acc: 0.458
Validation loss decreased (-0.435082 --> -0.457963).  Saving model ...
Epoch: 3 cost time: 2.652653455734253
Epoch: 3, Steps: 16 | Train Loss: 0.221 Vali Loss: 7.174 Vali Acc: 0.405 Test Loss: 7.174 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.560488224029541
Epoch: 4, Steps: 16 | Train Loss: 0.178 Vali Loss: 8.465 Vali Acc: 0.382 Test Loss: 8.465 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.514702558517456
Epoch: 5, Steps: 16 | Train Loss: 0.256 Vali Loss: 14.164 Vali Acc: 0.412 Test Loss: 14.164 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.458965539932251
Epoch: 6, Steps: 16 | Train Loss: 0.059 Vali Loss: 21.865 Vali Acc: 0.450 Test Loss: 21.865 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.5589897632598877
Epoch: 7, Steps: 16 | Train Loss: 0.193 Vali Loss: 26.707 Vali Acc: 0.405 Test Loss: 26.707 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.6801037788391113
Epoch: 8, Steps: 16 | Train Loss: 0.434 Vali Loss: 32.236 Vali Acc: 0.359 Test Loss: 32.236 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.6859254837036133
Epoch: 9, Steps: 16 | Train Loss: 0.836 Vali Loss: 41.495 Vali Acc: 0.344 Test Loss: 41.495 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.5872578620910645
Epoch: 10, Steps: 16 | Train Loss: 0.396 Vali Loss: 49.193 Vali Acc: 0.351 Test Loss: 49.193 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.5468103885650635
Epoch: 11, Steps: 16 | Train Loss: 0.522 Vali Loss: 47.098 Vali Acc: 0.359 Test Loss: 47.098 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.701833963394165
Epoch: 12, Steps: 16 | Train Loss: 0.570 Vali Loss: 48.795 Vali Acc: 0.359 Test Loss: 48.795 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324557809
model size : 1238.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.9718096256256104
Epoch: 1, Steps: 16 | Train Loss: 1.815 Vali Loss: 3.349 Vali Acc: 0.458 Test Loss: 3.349 Test Acc: 0.458
Validation loss decreased (inf --> -0.457982).  Saving model ...
Epoch: 2 cost time: 2.577192783355713
Epoch: 2, Steps: 16 | Train Loss: 0.359 Vali Loss: 7.194 Vali Acc: 0.336 Test Loss: 7.194 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.5868043899536133
Epoch: 3, Steps: 16 | Train Loss: 0.176 Vali Loss: 8.793 Vali Acc: 0.328 Test Loss: 8.793 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.610276460647583
Epoch: 4, Steps: 16 | Train Loss: 0.242 Vali Loss: 10.783 Vali Acc: 0.412 Test Loss: 10.783 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6551637649536133
Epoch: 5, Steps: 16 | Train Loss: 0.125 Vali Loss: 13.912 Vali Acc: 0.397 Test Loss: 13.912 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.5290207862854004
Epoch: 6, Steps: 16 | Train Loss: 0.078 Vali Loss: 16.317 Vali Acc: 0.374 Test Loss: 16.317 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6602559089660645
Epoch: 7, Steps: 16 | Train Loss: 0.065 Vali Loss: 20.225 Vali Acc: 0.397 Test Loss: 20.225 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.7948625087738037
Epoch: 8, Steps: 16 | Train Loss: 0.353 Vali Loss: 18.188 Vali Acc: 0.412 Test Loss: 18.188 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.678645372390747
Epoch: 9, Steps: 16 | Train Loss: 0.348 Vali Loss: 23.051 Vali Acc: 0.397 Test Loss: 23.051 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.643901824951172
Epoch: 10, Steps: 16 | Train Loss: 0.928 Vali Loss: 33.135 Vali Acc: 0.328 Test Loss: 33.135 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.524428129196167
Epoch: 11, Steps: 16 | Train Loss: 1.870 Vali Loss: 66.475 Vali Acc: 0.336 Test Loss: 66.475 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324566415
model size : 1238.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.7899281978607178
Epoch: 1, Steps: 16 | Train Loss: 1.825 Vali Loss: 4.083 Vali Acc: 0.458 Test Loss: 4.083 Test Acc: 0.458
Validation loss decreased (inf --> -0.457974).  Saving model ...
Epoch: 2 cost time: 2.6522510051727295
Epoch: 2, Steps: 16 | Train Loss: 0.324 Vali Loss: 6.900 Vali Acc: 0.450 Test Loss: 6.900 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4045095443725586
Epoch: 3, Steps: 16 | Train Loss: 0.036 Vali Loss: 9.003 Vali Acc: 0.382 Test Loss: 9.003 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.5638225078582764
Epoch: 4, Steps: 16 | Train Loss: 0.052 Vali Loss: 11.342 Vali Acc: 0.382 Test Loss: 11.342 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7461326122283936
Epoch: 5, Steps: 16 | Train Loss: 0.034 Vali Loss: 13.071 Vali Acc: 0.298 Test Loss: 13.071 Test Acc: 0.298
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.611990213394165
Epoch: 6, Steps: 16 | Train Loss: 0.215 Vali Loss: 12.341 Vali Acc: 0.397 Test Loss: 12.341 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.551466941833496
Epoch: 7, Steps: 16 | Train Loss: 0.226 Vali Loss: 13.322 Vali Acc: 0.374 Test Loss: 13.322 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.5160155296325684
Epoch: 8, Steps: 16 | Train Loss: 0.237 Vali Loss: 21.549 Vali Acc: 0.313 Test Loss: 21.549 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.608574628829956
Epoch: 9, Steps: 16 | Train Loss: 3.903 Vali Loss: 32.562 Vali Acc: 0.351 Test Loss: 32.562 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.64274001121521
Epoch: 10, Steps: 16 | Train Loss: 3.914 Vali Loss: 35.871 Vali Acc: 0.351 Test Loss: 35.871 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.4683237075805664
Epoch: 11, Steps: 16 | Train Loss: 2.162 Vali Loss: 37.947 Vali Acc: 0.344 Test Loss: 37.947 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324437937
model size : 1237.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.8411941528320312
Epoch: 1, Steps: 16 | Train Loss: 1.763 Vali Loss: 3.825 Vali Acc: 0.344 Test Loss: 3.825 Test Acc: 0.344
Validation loss decreased (inf --> -0.343473).  Saving model ...
Epoch: 2 cost time: 2.5165774822235107
Epoch: 2, Steps: 16 | Train Loss: 0.422 Vali Loss: 7.986 Vali Acc: 0.389 Test Loss: 7.986 Test Acc: 0.389
Validation loss decreased (-0.343473 --> -0.389233).  Saving model ...
Epoch: 3 cost time: 2.5574045181274414
Epoch: 3, Steps: 16 | Train Loss: 0.239 Vali Loss: 10.837 Vali Acc: 0.374 Test Loss: 10.837 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5994391441345215
Epoch: 4, Steps: 16 | Train Loss: 0.063 Vali Loss: 9.411 Vali Acc: 0.366 Test Loss: 9.411 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6751930713653564
Epoch: 5, Steps: 16 | Train Loss: 0.184 Vali Loss: 14.164 Vali Acc: 0.412 Test Loss: 14.164 Test Acc: 0.412
Validation loss decreased (-0.389233 --> -0.412072).  Saving model ...
Epoch: 6 cost time: 2.507575035095215
Epoch: 6, Steps: 16 | Train Loss: 0.194 Vali Loss: 20.324 Vali Acc: 0.427 Test Loss: 20.324 Test Acc: 0.427
Validation loss decreased (-0.412072 --> -0.427278).  Saving model ...
Epoch: 7 cost time: 2.5689826011657715
Epoch: 7, Steps: 16 | Train Loss: 0.712 Vali Loss: 19.819 Vali Acc: 0.427 Test Loss: 19.819 Test Acc: 0.427
Validation loss decreased (-0.427278 --> -0.427283).  Saving model ...
Epoch: 8 cost time: 2.699033737182617
Epoch: 8, Steps: 16 | Train Loss: 0.977 Vali Loss: 23.733 Vali Acc: 0.290 Test Loss: 23.733 Test Acc: 0.290
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5331051349639893
Epoch: 9, Steps: 16 | Train Loss: 1.245 Vali Loss: 37.385 Vali Acc: 0.397 Test Loss: 37.385 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3987069129943848
Epoch: 10, Steps: 16 | Train Loss: 1.245 Vali Loss: 49.376 Vali Acc: 0.412 Test Loss: 49.376 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.580233335494995
Epoch: 11, Steps: 16 | Train Loss: 0.983 Vali Loss: 62.646 Vali Acc: 0.389 Test Loss: 62.646 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.646847724914551
Epoch: 12, Steps: 16 | Train Loss: 0.182 Vali Loss: 58.380 Vali Acc: 0.351 Test Loss: 58.380 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6265077590942383
Epoch: 13, Steps: 16 | Train Loss: 0.078 Vali Loss: 64.326 Vali Acc: 0.328 Test Loss: 64.326 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7224133014678955
Epoch: 14, Steps: 16 | Train Loss: 0.623 Vali Loss: 74.536 Vali Acc: 0.412 Test Loss: 74.536 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.610490322113037
Epoch: 15, Steps: 16 | Train Loss: 3.037 Vali Loss: 80.107 Vali Acc: 0.366 Test Loss: 80.107 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.558825969696045
Epoch: 16, Steps: 16 | Train Loss: 0.558 Vali Loss: 81.272 Vali Acc: 0.336 Test Loss: 81.272 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6314687728881836
Epoch: 17, Steps: 16 | Train Loss: 1.493 Vali Loss: 85.609 Vali Acc: 0.359 Test Loss: 85.609 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 324547927
model size : 1238.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.710191488265991
Epoch: 1, Steps: 16 | Train Loss: 2.067 Vali Loss: 2.603 Vali Acc: 0.427 Test Loss: 2.603 Test Acc: 0.427
Validation loss decreased (inf --> -0.427455).  Saving model ...
Epoch: 2 cost time: 2.49890398979187
Epoch: 2, Steps: 16 | Train Loss: 0.431 Vali Loss: 7.147 Vali Acc: 0.458 Test Loss: 7.147 Test Acc: 0.458
Validation loss decreased (-0.427455 --> -0.457944).  Saving model ...
Epoch: 3 cost time: 2.4478559494018555
Epoch: 3, Steps: 16 | Train Loss: 0.440 Vali Loss: 9.403 Vali Acc: 0.397 Test Loss: 9.403 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5765185356140137
Epoch: 4, Steps: 16 | Train Loss: 0.097 Vali Loss: 11.814 Vali Acc: 0.420 Test Loss: 11.814 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.634859800338745
Epoch: 5, Steps: 16 | Train Loss: 0.114 Vali Loss: 16.056 Vali Acc: 0.405 Test Loss: 16.056 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5179810523986816
Epoch: 6, Steps: 16 | Train Loss: 0.041 Vali Loss: 17.940 Vali Acc: 0.420 Test Loss: 17.940 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4123241901397705
Epoch: 7, Steps: 16 | Train Loss: 0.169 Vali Loss: 18.259 Vali Acc: 0.374 Test Loss: 18.259 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.647465467453003
Epoch: 8, Steps: 16 | Train Loss: 0.500 Vali Loss: 19.895 Vali Acc: 0.443 Test Loss: 19.895 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.7281816005706787
Epoch: 9, Steps: 16 | Train Loss: 0.516 Vali Loss: 26.551 Vali Acc: 0.412 Test Loss: 26.551 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.565683364868164
Epoch: 10, Steps: 16 | Train Loss: 2.226 Vali Loss: 29.346 Vali Acc: 0.397 Test Loss: 29.346 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6931397914886475
Epoch: 11, Steps: 16 | Train Loss: 1.488 Vali Loss: 35.107 Vali Acc: 0.435 Test Loss: 35.107 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.479846477508545
Epoch: 12, Steps: 16 | Train Loss: 0.125 Vali Loss: 50.902 Vali Acc: 0.427 Test Loss: 50.902 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324517185
model size : 1237.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.2904486656188965
Epoch: 1, Steps: 16 | Train Loss: 2.046 Vali Loss: 3.189 Vali Acc: 0.321 Test Loss: 3.189 Test Acc: 0.321
Validation loss decreased (inf --> -0.320579).  Saving model ...
Epoch: 2 cost time: 2.7585601806640625
Epoch: 2, Steps: 16 | Train Loss: 0.296 Vali Loss: 6.595 Vali Acc: 0.481 Test Loss: 6.595 Test Acc: 0.481
Validation loss decreased (-0.320579 --> -0.480850).  Saving model ...
Epoch: 3 cost time: 2.996965169906616
Epoch: 3, Steps: 16 | Train Loss: 0.278 Vali Loss: 8.251 Vali Acc: 0.458 Test Loss: 8.251 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7963902950286865
Epoch: 4, Steps: 16 | Train Loss: 0.325 Vali Loss: 10.352 Vali Acc: 0.420 Test Loss: 10.352 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0625648498535156
Epoch: 5, Steps: 16 | Train Loss: 0.279 Vali Loss: 14.086 Vali Acc: 0.359 Test Loss: 14.086 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8410191535949707
Epoch: 6, Steps: 16 | Train Loss: 1.918 Vali Loss: 18.152 Vali Acc: 0.321 Test Loss: 18.152 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8040225505828857
Epoch: 7, Steps: 16 | Train Loss: 0.863 Vali Loss: 18.965 Vali Acc: 0.321 Test Loss: 18.965 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.005528688430786
Epoch: 8, Steps: 16 | Train Loss: 0.338 Vali Loss: 23.774 Vali Acc: 0.305 Test Loss: 23.774 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.751147985458374
Epoch: 9, Steps: 16 | Train Loss: 0.754 Vali Loss: 26.597 Vali Acc: 0.366 Test Loss: 26.597 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.817810535430908
Epoch: 10, Steps: 16 | Train Loss: 0.191 Vali Loss: 49.855 Vali Acc: 0.382 Test Loss: 49.855 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8236029148101807
Epoch: 11, Steps: 16 | Train Loss: 0.994 Vali Loss: 55.764 Vali Acc: 0.374 Test Loss: 55.764 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7260866165161133
Epoch: 12, Steps: 16 | Train Loss: 0.234 Vali Loss: 62.052 Vali Acc: 0.359 Test Loss: 62.052 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324416815
model size : 1237.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.0092854499816895
Epoch: 1, Steps: 16 | Train Loss: 2.002 Vali Loss: 4.038 Vali Acc: 0.420 Test Loss: 4.038 Test Acc: 0.420
Validation loss decreased (inf --> -0.419807).  Saving model ...
Epoch: 2 cost time: 2.9396705627441406
Epoch: 2, Steps: 16 | Train Loss: 0.505 Vali Loss: 7.124 Vali Acc: 0.313 Test Loss: 7.124 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1326825618743896
Epoch: 3, Steps: 16 | Train Loss: 0.459 Vali Loss: 8.814 Vali Acc: 0.443 Test Loss: 8.814 Test Acc: 0.443
Validation loss decreased (-0.419807 --> -0.442660).  Saving model ...
Epoch: 4 cost time: 2.803974151611328
Epoch: 4, Steps: 16 | Train Loss: 0.181 Vali Loss: 12.111 Vali Acc: 0.336 Test Loss: 12.111 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.977494955062866
Epoch: 5, Steps: 16 | Train Loss: 0.065 Vali Loss: 13.870 Vali Acc: 0.389 Test Loss: 13.870 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9924838542938232
Epoch: 6, Steps: 16 | Train Loss: 1.051 Vali Loss: 15.377 Vali Acc: 0.374 Test Loss: 15.377 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.880718231201172
Epoch: 7, Steps: 16 | Train Loss: 0.288 Vali Loss: 25.518 Vali Acc: 0.328 Test Loss: 25.518 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.898439645767212
Epoch: 8, Steps: 16 | Train Loss: 0.136 Vali Loss: 32.196 Vali Acc: 0.382 Test Loss: 32.196 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0242996215820312
Epoch: 9, Steps: 16 | Train Loss: 0.599 Vali Loss: 39.374 Vali Acc: 0.351 Test Loss: 39.374 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8604423999786377
Epoch: 10, Steps: 16 | Train Loss: 0.613 Vali Loss: 43.003 Vali Acc: 0.359 Test Loss: 43.003 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9239442348480225
Epoch: 11, Steps: 16 | Train Loss: 1.328 Vali Loss: 39.492 Vali Acc: 0.321 Test Loss: 39.492 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.143048048019409
Epoch: 12, Steps: 16 | Train Loss: 0.670 Vali Loss: 42.028 Vali Acc: 0.405 Test Loss: 42.028 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.96004581451416
Epoch: 13, Steps: 16 | Train Loss: 1.785 Vali Loss: 42.836 Vali Acc: 0.336 Test Loss: 42.836 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324462113
model size : 1237.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.0919740200042725
Epoch: 1, Steps: 16 | Train Loss: 2.169 Vali Loss: 2.597 Vali Acc: 0.397 Test Loss: 2.597 Test Acc: 0.397
Validation loss decreased (inf --> -0.396921).  Saving model ...
Epoch: 2 cost time: 3.110978841781616
Epoch: 2, Steps: 16 | Train Loss: 0.394 Vali Loss: 7.474 Vali Acc: 0.382 Test Loss: 7.474 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8746345043182373
Epoch: 3, Steps: 16 | Train Loss: 0.153 Vali Loss: 11.145 Vali Acc: 0.466 Test Loss: 11.145 Test Acc: 0.466
Validation loss decreased (-0.396921 --> -0.465537).  Saving model ...
Epoch: 4 cost time: 3.2578258514404297
Epoch: 4, Steps: 16 | Train Loss: 0.292 Vali Loss: 10.416 Vali Acc: 0.412 Test Loss: 10.416 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3072025775909424
Epoch: 5, Steps: 16 | Train Loss: 0.130 Vali Loss: 10.967 Vali Acc: 0.466 Test Loss: 10.967 Test Acc: 0.466
Validation loss decreased (-0.465537 --> -0.465539).  Saving model ...
Epoch: 6 cost time: 3.214289426803589
Epoch: 6, Steps: 16 | Train Loss: 0.429 Vali Loss: 14.702 Vali Acc: 0.420 Test Loss: 14.702 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.208737373352051
Epoch: 7, Steps: 16 | Train Loss: 0.408 Vali Loss: 19.477 Vali Acc: 0.412 Test Loss: 19.477 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.068129539489746
Epoch: 8, Steps: 16 | Train Loss: 0.381 Vali Loss: 25.711 Vali Acc: 0.458 Test Loss: 25.711 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.08415150642395
Epoch: 9, Steps: 16 | Train Loss: 1.698 Vali Loss: 32.270 Vali Acc: 0.420 Test Loss: 32.270 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0581676959991455
Epoch: 10, Steps: 16 | Train Loss: 3.272 Vali Loss: 49.461 Vali Acc: 0.412 Test Loss: 49.461 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2788262367248535
Epoch: 11, Steps: 16 | Train Loss: 1.508 Vali Loss: 53.004 Vali Acc: 0.397 Test Loss: 53.004 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.879992723464966
Epoch: 12, Steps: 16 | Train Loss: 0.403 Vali Loss: 59.840 Vali Acc: 0.427 Test Loss: 59.840 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.1837868690490723
Epoch: 13, Steps: 16 | Train Loss: 0.437 Vali Loss: 66.090 Vali Acc: 0.450 Test Loss: 66.090 Test Acc: 0.450
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.949753761291504
Epoch: 14, Steps: 16 | Train Loss: 0.327 Vali Loss: 73.078 Vali Acc: 0.366 Test Loss: 73.078 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.760931968688965
Epoch: 15, Steps: 16 | Train Loss: 0.751 Vali Loss: 81.419 Vali Acc: 0.351 Test Loss: 81.419 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324526743
model size : 1237.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.892489194869995
Epoch: 1, Steps: 16 | Train Loss: 2.018 Vali Loss: 2.456 Vali Acc: 0.481 Test Loss: 2.456 Test Acc: 0.481
Validation loss decreased (inf --> -0.480891).  Saving model ...
Epoch: 2 cost time: 3.0820486545562744
Epoch: 2, Steps: 16 | Train Loss: 0.369 Vali Loss: 8.192 Vali Acc: 0.412 Test Loss: 8.192 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.850100040435791
Epoch: 3, Steps: 16 | Train Loss: 0.318 Vali Loss: 9.063 Vali Acc: 0.389 Test Loss: 9.063 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9896860122680664
Epoch: 4, Steps: 16 | Train Loss: 0.197 Vali Loss: 9.424 Vali Acc: 0.389 Test Loss: 9.424 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.1264567375183105
Epoch: 5, Steps: 16 | Train Loss: 0.243 Vali Loss: 10.641 Vali Acc: 0.344 Test Loss: 10.641 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8519444465637207
Epoch: 6, Steps: 16 | Train Loss: 0.326 Vali Loss: 13.805 Vali Acc: 0.435 Test Loss: 13.805 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.932814836502075
Epoch: 7, Steps: 16 | Train Loss: 0.525 Vali Loss: 18.427 Vali Acc: 0.412 Test Loss: 18.427 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.934283971786499
Epoch: 8, Steps: 16 | Train Loss: 0.096 Vali Loss: 23.459 Vali Acc: 0.397 Test Loss: 23.459 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.989717721939087
Epoch: 9, Steps: 16 | Train Loss: 0.276 Vali Loss: 26.481 Vali Acc: 0.305 Test Loss: 26.481 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.8155574798583984
Epoch: 10, Steps: 16 | Train Loss: 0.593 Vali Loss: 29.587 Vali Acc: 0.382 Test Loss: 29.587 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.9949545860290527
Epoch: 11, Steps: 16 | Train Loss: 2.354 Vali Loss: 41.524 Vali Acc: 0.366 Test Loss: 41.524 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324484497
model size : 1237.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.909100294113159
Epoch: 1, Steps: 16 | Train Loss: 1.721 Vali Loss: 2.752 Vali Acc: 0.313 Test Loss: 2.752 Test Acc: 0.313
Validation loss decreased (inf --> -0.312950).  Saving model ...
Epoch: 2 cost time: 2.9619369506835938
Epoch: 2, Steps: 16 | Train Loss: 0.338 Vali Loss: 5.559 Vali Acc: 0.466 Test Loss: 5.559 Test Acc: 0.466
Validation loss decreased (-0.312950 --> -0.465593).  Saving model ...
Epoch: 3 cost time: 3.1181211471557617
Epoch: 3, Steps: 16 | Train Loss: 0.352 Vali Loss: 7.641 Vali Acc: 0.405 Test Loss: 7.641 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9508352279663086
Epoch: 4, Steps: 16 | Train Loss: 1.445 Vali Loss: 11.685 Vali Acc: 0.412 Test Loss: 11.685 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.171185255050659
Epoch: 5, Steps: 16 | Train Loss: 0.176 Vali Loss: 19.842 Vali Acc: 0.397 Test Loss: 19.842 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1520497798919678
Epoch: 6, Steps: 16 | Train Loss: 0.265 Vali Loss: 23.584 Vali Acc: 0.397 Test Loss: 23.584 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0663902759552
Epoch: 7, Steps: 16 | Train Loss: 0.184 Vali Loss: 23.923 Vali Acc: 0.351 Test Loss: 23.923 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.031010389328003
Epoch: 8, Steps: 16 | Train Loss: 0.162 Vali Loss: 23.561 Vali Acc: 0.405 Test Loss: 23.561 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.108473777770996
Epoch: 9, Steps: 16 | Train Loss: 0.565 Vali Loss: 19.736 Vali Acc: 0.427 Test Loss: 19.736 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.823110342025757
Epoch: 10, Steps: 16 | Train Loss: 0.660 Vali Loss: 31.555 Vali Acc: 0.359 Test Loss: 31.555 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.9763243198394775
Epoch: 11, Steps: 16 | Train Loss: 1.416 Vali Loss: 36.794 Vali Acc: 0.374 Test Loss: 36.794 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8794713020324707
Epoch: 12, Steps: 16 | Train Loss: 0.515 Vali Loss: 42.964 Vali Acc: 0.397 Test Loss: 42.964 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324389135
model size : 1237.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.458410263061523
Epoch: 1, Steps: 16 | Train Loss: 1.946 Vali Loss: 3.567 Vali Acc: 0.397 Test Loss: 3.567 Test Acc: 0.397
Validation loss decreased (inf --> -0.396911).  Saving model ...
Epoch: 2 cost time: 3.0360608100891113
Epoch: 2, Steps: 16 | Train Loss: 0.462 Vali Loss: 5.756 Vali Acc: 0.504 Test Loss: 5.756 Test Acc: 0.504
Validation loss decreased (-0.396911 --> -0.503759).  Saving model ...
Epoch: 3 cost time: 2.939591407775879
Epoch: 3, Steps: 16 | Train Loss: 0.094 Vali Loss: 7.029 Vali Acc: 0.481 Test Loss: 7.029 Test Acc: 0.481
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.027534008026123
Epoch: 4, Steps: 16 | Train Loss: 0.091 Vali Loss: 9.421 Vali Acc: 0.450 Test Loss: 9.421 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9030144214630127
Epoch: 5, Steps: 16 | Train Loss: 0.097 Vali Loss: 11.742 Vali Acc: 0.382 Test Loss: 11.742 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0629680156707764
Epoch: 6, Steps: 16 | Train Loss: 0.075 Vali Loss: 15.508 Vali Acc: 0.351 Test Loss: 15.508 Test Acc: 0.351
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.936493396759033
Epoch: 7, Steps: 16 | Train Loss: 0.371 Vali Loss: 15.394 Vali Acc: 0.389 Test Loss: 15.394 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.047680377960205
Epoch: 8, Steps: 16 | Train Loss: 0.114 Vali Loss: 14.955 Vali Acc: 0.366 Test Loss: 14.955 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.995204210281372
Epoch: 9, Steps: 16 | Train Loss: 0.506 Vali Loss: 27.099 Vali Acc: 0.389 Test Loss: 27.099 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.154224395751953
Epoch: 10, Steps: 16 | Train Loss: 1.986 Vali Loss: 26.178 Vali Acc: 0.328 Test Loss: 26.178 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1531479358673096
Epoch: 11, Steps: 16 | Train Loss: 3.623 Vali Loss: 30.152 Vali Acc: 0.389 Test Loss: 30.152 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7744109630584717
Epoch: 12, Steps: 16 | Train Loss: 0.680 Vali Loss: 55.892 Vali Acc: 0.336 Test Loss: 55.892 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5038167938931297
model parameter : 324366417
model size : 1237.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.850958824157715
Epoch: 1, Steps: 16 | Train Loss: 2.156 Vali Loss: 3.390 Vali Acc: 0.366 Test Loss: 3.390 Test Acc: 0.366
Validation loss decreased (inf --> -0.366378).  Saving model ...
Epoch: 2 cost time: 2.900179624557495
Epoch: 2, Steps: 16 | Train Loss: 0.214 Vali Loss: 10.796 Vali Acc: 0.435 Test Loss: 10.796 Test Acc: 0.435
Validation loss decreased (-0.366378 --> -0.435007).  Saving model ...
Epoch: 3 cost time: 2.77995228767395
Epoch: 3, Steps: 16 | Train Loss: 0.167 Vali Loss: 15.316 Vali Acc: 0.458 Test Loss: 15.316 Test Acc: 0.458
Validation loss decreased (-0.435007 --> -0.457862).  Saving model ...
Epoch: 4 cost time: 2.830824136734009
Epoch: 4, Steps: 16 | Train Loss: 0.238 Vali Loss: 15.244 Vali Acc: 0.344 Test Loss: 15.244 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.163231134414673
Epoch: 5, Steps: 16 | Train Loss: 0.228 Vali Loss: 15.457 Vali Acc: 0.420 Test Loss: 15.457 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.846017360687256
Epoch: 6, Steps: 16 | Train Loss: 0.294 Vali Loss: 22.541 Vali Acc: 0.420 Test Loss: 22.541 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.208670139312744
Epoch: 7, Steps: 16 | Train Loss: 0.951 Vali Loss: 28.015 Vali Acc: 0.313 Test Loss: 28.015 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1408839225769043
Epoch: 8, Steps: 16 | Train Loss: 0.325 Vali Loss: 29.949 Vali Acc: 0.351 Test Loss: 29.949 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.746455430984497
Epoch: 9, Steps: 16 | Train Loss: 0.106 Vali Loss: 33.448 Vali Acc: 0.412 Test Loss: 33.448 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.925520658493042
Epoch: 10, Steps: 16 | Train Loss: 0.189 Vali Loss: 33.160 Vali Acc: 0.443 Test Loss: 33.160 Test Acc: 0.443
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.8867321014404297
Epoch: 11, Steps: 16 | Train Loss: 2.663 Vali Loss: 32.690 Vali Acc: 0.473 Test Loss: 32.690 Test Acc: 0.473
Validation loss decreased (-0.457862 --> -0.472956).  Saving model ...
Epoch: 12 cost time: 2.9451241493225098
Epoch: 12, Steps: 16 | Train Loss: 0.316 Vali Loss: 63.366 Vali Acc: 0.405 Test Loss: 63.366 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.648475408554077
Epoch: 13, Steps: 16 | Train Loss: 0.142 Vali Loss: 77.815 Vali Acc: 0.374 Test Loss: 77.815 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.9211246967315674
Epoch: 14, Steps: 16 | Train Loss: 0.319 Vali Loss: 93.277 Vali Acc: 0.374 Test Loss: 93.277 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8395299911499023
Epoch: 15, Steps: 16 | Train Loss: 0.328 Vali Loss: 96.119 Vali Acc: 0.382 Test Loss: 96.119 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.069296360015869
Epoch: 16, Steps: 16 | Train Loss: 0.390 Vali Loss: 95.292 Vali Acc: 0.397 Test Loss: 95.292 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.897397994995117
Epoch: 17, Steps: 16 | Train Loss: 0.109 Vali Loss: 105.065 Vali Acc: 0.374 Test Loss: 105.065 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.000852346420288
Epoch: 18, Steps: 16 | Train Loss: 0.500 Vali Loss: 103.452 Vali Acc: 0.389 Test Loss: 103.452 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.268918752670288
Epoch: 19, Steps: 16 | Train Loss: 1.635 Vali Loss: 117.162 Vali Acc: 0.359 Test Loss: 117.162 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0255041122436523
Epoch: 20, Steps: 16 | Train Loss: 2.950 Vali Loss: 131.765 Vali Acc: 0.328 Test Loss: 131.765 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.914872169494629
Epoch: 21, Steps: 16 | Train Loss: 3.205 Vali Loss: 175.343 Vali Acc: 0.366 Test Loss: 175.343 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324398231
model size : 1237.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.408264636993408
Epoch: 1, Steps: 16 | Train Loss: 1.884 Vali Loss: 3.993 Vali Acc: 0.321 Test Loss: 3.993 Test Acc: 0.321
Validation loss decreased (inf --> -0.320571).  Saving model ...
Epoch: 2 cost time: 3.1412389278411865
Epoch: 2, Steps: 16 | Train Loss: 0.293 Vali Loss: 7.188 Vali Acc: 0.382 Test Loss: 7.188 Test Acc: 0.382
Validation loss decreased (-0.320571 --> -0.381608).  Saving model ...
Epoch: 3 cost time: 2.9510390758514404
Epoch: 3, Steps: 16 | Train Loss: 0.017 Vali Loss: 7.465 Vali Acc: 0.473 Test Loss: 7.465 Test Acc: 0.473
Validation loss decreased (-0.381608 --> -0.473208).  Saving model ...
Epoch: 4 cost time: 2.896552085876465
Epoch: 4, Steps: 16 | Train Loss: 0.036 Vali Loss: 9.053 Vali Acc: 0.412 Test Loss: 9.053 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2275500297546387
Epoch: 5, Steps: 16 | Train Loss: 0.308 Vali Loss: 11.646 Vali Acc: 0.443 Test Loss: 11.646 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.850926160812378
Epoch: 6, Steps: 16 | Train Loss: 2.236 Vali Loss: 18.412 Vali Acc: 0.489 Test Loss: 18.412 Test Acc: 0.489
Validation loss decreased (-0.473208 --> -0.488366).  Saving model ...
Epoch: 7 cost time: 2.745211601257324
Epoch: 7, Steps: 16 | Train Loss: 2.852 Vali Loss: 27.008 Vali Acc: 0.382 Test Loss: 27.008 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0794050693511963
Epoch: 8, Steps: 16 | Train Loss: 0.863 Vali Loss: 32.518 Vali Acc: 0.351 Test Loss: 32.518 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7383413314819336
Epoch: 9, Steps: 16 | Train Loss: 0.582 Vali Loss: 39.554 Vali Acc: 0.344 Test Loss: 39.554 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9447357654571533
Epoch: 10, Steps: 16 | Train Loss: 1.031 Vali Loss: 42.374 Vali Acc: 0.374 Test Loss: 42.374 Test Acc: 0.374
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8208537101745605
Epoch: 11, Steps: 16 | Train Loss: 0.611 Vali Loss: 47.477 Vali Acc: 0.351 Test Loss: 47.477 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.020284652709961
Epoch: 12, Steps: 16 | Train Loss: 0.709 Vali Loss: 49.328 Vali Acc: 0.374 Test Loss: 49.328 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.0520377159118652
Epoch: 13, Steps: 16 | Train Loss: 0.121 Vali Loss: 52.790 Vali Acc: 0.351 Test Loss: 52.790 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8297367095947266
Epoch: 14, Steps: 16 | Train Loss: 0.327 Vali Loss: 49.889 Vali Acc: 0.374 Test Loss: 49.889 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.810041904449463
Epoch: 15, Steps: 16 | Train Loss: 2.903 Vali Loss: 51.475 Vali Acc: 0.412 Test Loss: 51.475 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.0318219661712646
Epoch: 16, Steps: 16 | Train Loss: 0.204 Vali Loss: 66.717 Vali Acc: 0.344 Test Loss: 66.717 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324646369
model size : 1238.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.012207269668579
Epoch: 1, Steps: 16 | Train Loss: 1.697 Vali Loss: 3.518 Vali Acc: 0.389 Test Loss: 3.518 Test Acc: 0.389
Validation loss decreased (inf --> -0.389278).  Saving model ...
Epoch: 2 cost time: 3.1860291957855225
Epoch: 2, Steps: 16 | Train Loss: 0.337 Vali Loss: 5.851 Vali Acc: 0.466 Test Loss: 5.851 Test Acc: 0.466
Validation loss decreased (-0.389278 --> -0.465590).  Saving model ...
Epoch: 3 cost time: 3.0542104244232178
Epoch: 3, Steps: 16 | Train Loss: 0.051 Vali Loss: 8.217 Vali Acc: 0.466 Test Loss: 8.217 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.053420305252075
Epoch: 4, Steps: 16 | Train Loss: 0.273 Vali Loss: 9.621 Vali Acc: 0.420 Test Loss: 9.621 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9174861907958984
Epoch: 5, Steps: 16 | Train Loss: 1.158 Vali Loss: 10.979 Vali Acc: 0.382 Test Loss: 10.979 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.263974905014038
Epoch: 6, Steps: 16 | Train Loss: 0.642 Vali Loss: 14.606 Vali Acc: 0.450 Test Loss: 14.606 Test Acc: 0.450
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.014058828353882
Epoch: 7, Steps: 16 | Train Loss: 0.381 Vali Loss: 20.610 Vali Acc: 0.366 Test Loss: 20.610 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.712785243988037
Epoch: 8, Steps: 16 | Train Loss: 1.353 Vali Loss: 27.671 Vali Acc: 0.328 Test Loss: 27.671 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.068971633911133
Epoch: 9, Steps: 16 | Train Loss: 0.351 Vali Loss: 38.258 Vali Acc: 0.344 Test Loss: 38.258 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1005139350891113
Epoch: 10, Steps: 16 | Train Loss: 0.413 Vali Loss: 46.099 Vali Acc: 0.389 Test Loss: 46.099 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.016319513320923
Epoch: 11, Steps: 16 | Train Loss: 1.287 Vali Loss: 47.943 Vali Acc: 0.336 Test Loss: 47.943 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.0260214805603027
Epoch: 12, Steps: 16 | Train Loss: 0.428 Vali Loss: 54.902 Vali Acc: 0.405 Test Loss: 54.902 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324517167
model size : 1237.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.166574478149414
Epoch: 1, Steps: 16 | Train Loss: 2.133 Vali Loss: 4.266 Vali Acc: 0.328 Test Loss: 4.266 Test Acc: 0.328
Validation loss decreased (inf --> -0.328202).  Saving model ...
Epoch: 2 cost time: 2.950110673904419
Epoch: 2, Steps: 16 | Train Loss: 0.355 Vali Loss: 9.919 Vali Acc: 0.458 Test Loss: 9.919 Test Acc: 0.458
Validation loss decreased (-0.328202 --> -0.457916).  Saving model ...
Epoch: 3 cost time: 2.7325711250305176
Epoch: 3, Steps: 16 | Train Loss: 0.085 Vali Loss: 11.863 Vali Acc: 0.382 Test Loss: 11.863 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.996091365814209
Epoch: 4, Steps: 16 | Train Loss: 0.224 Vali Loss: 12.392 Vali Acc: 0.374 Test Loss: 12.392 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0881764888763428
Epoch: 5, Steps: 16 | Train Loss: 0.033 Vali Loss: 16.039 Vali Acc: 0.397 Test Loss: 16.039 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8815598487854004
Epoch: 6, Steps: 16 | Train Loss: 0.383 Vali Loss: 17.354 Vali Acc: 0.366 Test Loss: 17.354 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.038738965988159
Epoch: 7, Steps: 16 | Train Loss: 0.341 Vali Loss: 20.066 Vali Acc: 0.427 Test Loss: 20.066 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1440255641937256
Epoch: 8, Steps: 16 | Train Loss: 0.547 Vali Loss: 28.031 Vali Acc: 0.336 Test Loss: 28.031 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.057835578918457
Epoch: 9, Steps: 16 | Train Loss: 6.085 Vali Loss: 31.986 Vali Acc: 0.351 Test Loss: 31.986 Test Acc: 0.351
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8732755184173584
Epoch: 10, Steps: 16 | Train Loss: 0.548 Vali Loss: 56.431 Vali Acc: 0.374 Test Loss: 56.431 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.3223934173583984
Epoch: 11, Steps: 16 | Train Loss: 0.901 Vali Loss: 79.630 Vali Acc: 0.405 Test Loss: 79.630 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.268152952194214
Epoch: 12, Steps: 16 | Train Loss: 1.495 Vali Loss: 91.161 Vali Acc: 0.405 Test Loss: 91.161 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324640129
model size : 1238.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.963746070861816
Epoch: 1, Steps: 16 | Train Loss: 1.807 Vali Loss: 3.528 Vali Acc: 0.374 Test Loss: 3.528 Test Acc: 0.374
Validation loss decreased (inf --> -0.374011).  Saving model ...
Epoch: 2 cost time: 2.984959840774536
Epoch: 2, Steps: 16 | Train Loss: 0.612 Vali Loss: 6.070 Vali Acc: 0.389 Test Loss: 6.070 Test Acc: 0.389
Validation loss decreased (-0.374011 --> -0.389252).  Saving model ...
Epoch: 3 cost time: 2.8496599197387695
Epoch: 3, Steps: 16 | Train Loss: 0.172 Vali Loss: 9.296 Vali Acc: 0.420 Test Loss: 9.296 Test Acc: 0.420
Validation loss decreased (-0.389252 --> -0.419754).  Saving model ...
Epoch: 4 cost time: 3.141123056411743
Epoch: 4, Steps: 16 | Train Loss: 0.310 Vali Loss: 7.695 Vali Acc: 0.397 Test Loss: 7.695 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3174314498901367
Epoch: 5, Steps: 16 | Train Loss: 0.011 Vali Loss: 9.944 Vali Acc: 0.458 Test Loss: 9.944 Test Acc: 0.458
Validation loss decreased (-0.419754 --> -0.457916).  Saving model ...
Epoch: 6 cost time: 3.507256507873535
Epoch: 6, Steps: 16 | Train Loss: 0.033 Vali Loss: 10.590 Vali Acc: 0.427 Test Loss: 10.590 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8613979816436768
Epoch: 7, Steps: 16 | Train Loss: 0.302 Vali Loss: 14.168 Vali Acc: 0.397 Test Loss: 14.168 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8655264377593994
Epoch: 8, Steps: 16 | Train Loss: 1.613 Vali Loss: 23.907 Vali Acc: 0.366 Test Loss: 23.907 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9226276874542236
Epoch: 9, Steps: 16 | Train Loss: 0.875 Vali Loss: 36.755 Vali Acc: 0.412 Test Loss: 36.755 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.889695167541504
Epoch: 10, Steps: 16 | Train Loss: 0.640 Vali Loss: 43.727 Vali Acc: 0.382 Test Loss: 43.727 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0482707023620605
Epoch: 11, Steps: 16 | Train Loss: 1.601 Vali Loss: 56.083 Vali Acc: 0.351 Test Loss: 56.083 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7450172901153564
Epoch: 12, Steps: 16 | Train Loss: 1.000 Vali Loss: 61.674 Vali Acc: 0.412 Test Loss: 61.674 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.8493518829345703
Epoch: 13, Steps: 16 | Train Loss: 1.149 Vali Loss: 65.368 Vali Acc: 0.427 Test Loss: 65.368 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9398999214172363
Epoch: 14, Steps: 16 | Train Loss: 0.711 Vali Loss: 59.705 Vali Acc: 0.405 Test Loss: 59.705 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.9062752723693848
Epoch: 15, Steps: 16 | Train Loss: 0.036 Vali Loss: 64.415 Vali Acc: 0.412 Test Loss: 64.415 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm128_cs857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324583511
model size : 1238.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.597297668457031
Epoch: 1, Steps: 16 | Train Loss: 2.143 Vali Loss: 2.515 Vali Acc: 0.275 Test Loss: 2.515 Test Acc: 0.275
Validation loss decreased (inf --> -0.274784).  Saving model ...
Epoch: 2 cost time: 2.832170009613037
Epoch: 2, Steps: 16 | Train Loss: 0.275 Vali Loss: 7.509 Vali Acc: 0.336 Test Loss: 7.509 Test Acc: 0.336
Validation loss decreased (-0.274784 --> -0.335803).  Saving model ...
Epoch: 3 cost time: 2.7196733951568604
Epoch: 3, Steps: 16 | Train Loss: 0.291 Vali Loss: 10.801 Vali Acc: 0.435 Test Loss: 10.801 Test Acc: 0.435
Validation loss decreased (-0.335803 --> -0.435006).  Saving model ...
Epoch: 4 cost time: 3.0541701316833496
Epoch: 4, Steps: 16 | Train Loss: 0.481 Vali Loss: 13.248 Vali Acc: 0.389 Test Loss: 13.248 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.742349624633789
Epoch: 5, Steps: 16 | Train Loss: 0.114 Vali Loss: 15.760 Vali Acc: 0.351 Test Loss: 15.760 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.8891468048095703
Epoch: 6, Steps: 16 | Train Loss: 0.100 Vali Loss: 18.247 Vali Acc: 0.351 Test Loss: 18.247 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8451685905456543
Epoch: 7, Steps: 16 | Train Loss: 1.575 Vali Loss: 22.990 Vali Acc: 0.366 Test Loss: 22.990 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.6674141883850098
Epoch: 8, Steps: 16 | Train Loss: 0.343 Vali Loss: 27.169 Vali Acc: 0.359 Test Loss: 27.169 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.7010743618011475
Epoch: 9, Steps: 16 | Train Loss: 0.171 Vali Loss: 33.090 Vali Acc: 0.366 Test Loss: 33.090 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.753434658050537
Epoch: 10, Steps: 16 | Train Loss: 0.281 Vali Loss: 31.071 Vali Acc: 0.382 Test Loss: 31.071 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.92877197265625
Epoch: 11, Steps: 16 | Train Loss: 0.341 Vali Loss: 35.995 Vali Acc: 0.344 Test Loss: 35.995 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.789384603500366
Epoch: 12, Steps: 16 | Train Loss: 0.602 Vali Loss: 41.165 Vali Acc: 0.351 Test Loss: 41.165 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.868837356567383
Epoch: 13, Steps: 16 | Train Loss: 1.441 Vali Loss: 49.977 Vali Acc: 0.389 Test Loss: 49.977 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 324433073
model size : 1237.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs5995_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.678290605545044
Epoch: 1, Steps: 16 | Train Loss: 2.378 Vali Loss: 2.729 Vali Acc: 0.237 Test Loss: 2.729 Test Acc: 0.237
Validation loss decreased (inf --> -0.236614).  Saving model ...
Epoch: 2 cost time: 2.9357168674468994
Epoch: 2, Steps: 16 | Train Loss: 0.505 Vali Loss: 9.287 Vali Acc: 0.458 Test Loss: 9.287 Test Acc: 0.458
Validation loss decreased (-0.236614 --> -0.457922).  Saving model ...
Epoch: 3 cost time: 2.988095283508301
Epoch: 3, Steps: 16 | Train Loss: 0.268 Vali Loss: 12.380 Vali Acc: 0.435 Test Loss: 12.380 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.865943193435669
Epoch: 4, Steps: 16 | Train Loss: 0.212 Vali Loss: 12.414 Vali Acc: 0.405 Test Loss: 12.414 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0148608684539795
Epoch: 5, Steps: 16 | Train Loss: 0.524 Vali Loss: 11.246 Vali Acc: 0.374 Test Loss: 11.246 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0732433795928955
Epoch: 6, Steps: 16 | Train Loss: 0.237 Vali Loss: 12.559 Vali Acc: 0.427 Test Loss: 12.559 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1460018157958984
Epoch: 7, Steps: 16 | Train Loss: 1.971 Vali Loss: 14.593 Vali Acc: 0.405 Test Loss: 14.593 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8697264194488525
Epoch: 8, Steps: 16 | Train Loss: 0.156 Vali Loss: 19.731 Vali Acc: 0.412 Test Loss: 19.731 Test Acc: 0.412
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.860805034637451
Epoch: 9, Steps: 16 | Train Loss: 0.079 Vali Loss: 19.758 Vali Acc: 0.473 Test Loss: 19.758 Test Acc: 0.473
Validation loss decreased (-0.457922 --> -0.473085).  Saving model ...
Epoch: 10 cost time: 2.951425790786743
Epoch: 10, Steps: 16 | Train Loss: 0.489 Vali Loss: 30.714 Vali Acc: 0.412 Test Loss: 30.714 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.984983444213867
Epoch: 11, Steps: 16 | Train Loss: 0.711 Vali Loss: 34.048 Vali Acc: 0.328 Test Loss: 34.048 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.181663751602173
Epoch: 12, Steps: 16 | Train Loss: 1.056 Vali Loss: 44.290 Vali Acc: 0.366 Test Loss: 44.290 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.026294708251953
Epoch: 13, Steps: 16 | Train Loss: 0.126 Vali Loss: 54.930 Vali Acc: 0.328 Test Loss: 54.930 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.9177303314208984
Epoch: 14, Steps: 16 | Train Loss: 0.846 Vali Loss: 52.878 Vali Acc: 0.374 Test Loss: 52.878 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.2600784301757812
Epoch: 15, Steps: 16 | Train Loss: 1.292 Vali Loss: 65.265 Vali Acc: 0.298 Test Loss: 65.265 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8599772453308105
Epoch: 16, Steps: 16 | Train Loss: 2.005 Vali Loss: 74.011 Vali Acc: 0.321 Test Loss: 74.011 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.740652084350586
Epoch: 17, Steps: 16 | Train Loss: 0.074 Vali Loss: 87.161 Vali Acc: 0.321 Test Loss: 87.161 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.9244937896728516
Epoch: 18, Steps: 16 | Train Loss: 3.002 Vali Loss: 129.579 Vali Acc: 0.344 Test Loss: 129.579 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.098950147628784
Epoch: 19, Steps: 16 | Train Loss: 0.687 Vali Loss: 155.717 Vali Acc: 0.382 Test Loss: 155.717 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs5995_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324355167
model size : 1237.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs4496_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.271890640258789
Epoch: 1, Steps: 16 | Train Loss: 1.974 Vali Loss: 3.431 Vali Acc: 0.313 Test Loss: 3.431 Test Acc: 0.313
Validation loss decreased (inf --> -0.312943).  Saving model ...
Epoch: 2 cost time: 2.816624641418457
Epoch: 2, Steps: 16 | Train Loss: 0.391 Vali Loss: 6.982 Vali Acc: 0.412 Test Loss: 6.982 Test Acc: 0.412
Validation loss decreased (-0.312943 --> -0.412144).  Saving model ...
Epoch: 3 cost time: 2.897055149078369
Epoch: 3, Steps: 16 | Train Loss: 0.300 Vali Loss: 8.361 Vali Acc: 0.389 Test Loss: 8.361 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.892456531524658
Epoch: 4, Steps: 16 | Train Loss: 0.063 Vali Loss: 8.091 Vali Acc: 0.458 Test Loss: 8.091 Test Acc: 0.458
Validation loss decreased (-0.412144 --> -0.457934).  Saving model ...
Epoch: 5 cost time: 2.995612382888794
Epoch: 5, Steps: 16 | Train Loss: 0.063 Vali Loss: 9.454 Vali Acc: 0.420 Test Loss: 9.454 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.138855218887329
Epoch: 6, Steps: 16 | Train Loss: 0.403 Vali Loss: 15.101 Vali Acc: 0.359 Test Loss: 15.101 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9867098331451416
Epoch: 7, Steps: 16 | Train Loss: 0.040 Vali Loss: 20.490 Vali Acc: 0.359 Test Loss: 20.490 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9702696800231934
Epoch: 8, Steps: 16 | Train Loss: 0.164 Vali Loss: 23.401 Vali Acc: 0.382 Test Loss: 23.401 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.025081157684326
Epoch: 9, Steps: 16 | Train Loss: 0.221 Vali Loss: 20.111 Vali Acc: 0.382 Test Loss: 20.111 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7798690795898438
Epoch: 10, Steps: 16 | Train Loss: 0.461 Vali Loss: 30.179 Vali Acc: 0.359 Test Loss: 30.179 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7420132160186768
Epoch: 11, Steps: 16 | Train Loss: 2.450 Vali Loss: 54.132 Vali Acc: 0.336 Test Loss: 54.132 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1644372940063477
Epoch: 12, Steps: 16 | Train Loss: 2.298 Vali Loss: 67.935 Vali Acc: 0.397 Test Loss: 67.935 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9587278366088867
Epoch: 13, Steps: 16 | Train Loss: 0.736 Vali Loss: 82.059 Vali Acc: 0.344 Test Loss: 82.059 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.585670232772827
Epoch: 14, Steps: 16 | Train Loss: 1.618 Vali Loss: 71.549 Vali Acc: 0.336 Test Loss: 71.549 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs4496_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324289233
model size : 1237.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.085514545440674
Epoch: 1, Steps: 16 | Train Loss: 1.912 Vali Loss: 3.632 Vali Acc: 0.389 Test Loss: 3.632 Test Acc: 0.389
Validation loss decreased (inf --> -0.389277).  Saving model ...
Epoch: 2 cost time: 3.1194372177124023
Epoch: 2, Steps: 16 | Train Loss: 0.324 Vali Loss: 7.530 Vali Acc: 0.458 Test Loss: 7.530 Test Acc: 0.458
Validation loss decreased (-0.389277 --> -0.457940).  Saving model ...
Epoch: 3 cost time: 3.4029664993286133
Epoch: 3, Steps: 16 | Train Loss: 0.092 Vali Loss: 9.100 Vali Acc: 0.321 Test Loss: 9.100 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3094186782836914
Epoch: 4, Steps: 16 | Train Loss: 0.120 Vali Loss: 11.085 Vali Acc: 0.389 Test Loss: 11.085 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9527487754821777
Epoch: 5, Steps: 16 | Train Loss: 0.075 Vali Loss: 14.543 Vali Acc: 0.344 Test Loss: 14.543 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3010151386260986
Epoch: 6, Steps: 16 | Train Loss: 0.467 Vali Loss: 20.044 Vali Acc: 0.282 Test Loss: 20.044 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.020508050918579
Epoch: 7, Steps: 16 | Train Loss: 0.563 Vali Loss: 30.676 Vali Acc: 0.382 Test Loss: 30.676 Test Acc: 0.382
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.2317824363708496
Epoch: 8, Steps: 16 | Train Loss: 0.787 Vali Loss: 37.618 Vali Acc: 0.427 Test Loss: 37.618 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.232099771499634
Epoch: 9, Steps: 16 | Train Loss: 1.745 Vali Loss: 33.694 Vali Acc: 0.450 Test Loss: 33.694 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1109163761138916
Epoch: 10, Steps: 16 | Train Loss: 0.646 Vali Loss: 32.463 Vali Acc: 0.473 Test Loss: 32.463 Test Acc: 0.473
Validation loss decreased (-0.457940 --> -0.472958).  Saving model ...
Epoch: 11 cost time: 2.872342348098755
Epoch: 11, Steps: 16 | Train Loss: 0.534 Vali Loss: 37.717 Vali Acc: 0.481 Test Loss: 37.717 Test Acc: 0.481
Validation loss decreased (-0.472958 --> -0.480539).  Saving model ...
Epoch: 12 cost time: 2.9833412170410156
Epoch: 12, Steps: 16 | Train Loss: 0.589 Vali Loss: 52.710 Vali Acc: 0.420 Test Loss: 52.710 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0180554389953613
Epoch: 13, Steps: 16 | Train Loss: 3.505 Vali Loss: 58.062 Vali Acc: 0.374 Test Loss: 58.062 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1486637592315674
Epoch: 14, Steps: 16 | Train Loss: 0.599 Vali Loss: 70.528 Vali Acc: 0.427 Test Loss: 70.528 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9714620113372803
Epoch: 15, Steps: 16 | Train Loss: 0.730 Vali Loss: 82.992 Vali Acc: 0.443 Test Loss: 82.992 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.1666488647460938
Epoch: 16, Steps: 16 | Train Loss: 0.816 Vali Loss: 95.015 Vali Acc: 0.351 Test Loss: 95.015 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.2409467697143555
Epoch: 17, Steps: 16 | Train Loss: 0.060 Vali Loss: 115.370 Vali Acc: 0.389 Test Loss: 115.370 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.1730124950408936
Epoch: 18, Steps: 16 | Train Loss: 1.490 Vali Loss: 117.618 Vali Acc: 0.374 Test Loss: 117.618 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.166124105453491
Epoch: 19, Steps: 16 | Train Loss: 1.063 Vali Loss: 115.672 Vali Acc: 0.359 Test Loss: 115.672 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.064318895339966
Epoch: 20, Steps: 16 | Train Loss: 2.231 Vali Loss: 122.240 Vali Acc: 0.321 Test Loss: 122.240 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.045098304748535
Epoch: 21, Steps: 16 | Train Loss: 1.761 Vali Loss: 132.761 Vali Acc: 0.344 Test Loss: 132.761 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324278471
model size : 1237.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.979693412780762
Epoch: 1, Steps: 16 | Train Loss: 1.681 Vali Loss: 4.758 Vali Acc: 0.519 Test Loss: 4.758 Test Acc: 0.519
Validation loss decreased (inf --> -0.519036).  Saving model ...
Epoch: 2 cost time: 3.4772253036499023
Epoch: 2, Steps: 16 | Train Loss: 0.221 Vali Loss: 9.540 Vali Acc: 0.359 Test Loss: 9.540 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0889687538146973
Epoch: 3, Steps: 16 | Train Loss: 0.024 Vali Loss: 12.838 Vali Acc: 0.458 Test Loss: 12.838 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.985943078994751
Epoch: 4, Steps: 16 | Train Loss: 0.300 Vali Loss: 15.562 Vali Acc: 0.389 Test Loss: 15.562 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.018810749053955
Epoch: 5, Steps: 16 | Train Loss: 0.159 Vali Loss: 18.516 Vali Acc: 0.366 Test Loss: 18.516 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.977041721343994
Epoch: 6, Steps: 16 | Train Loss: 0.360 Vali Loss: 22.521 Vali Acc: 0.450 Test Loss: 22.521 Test Acc: 0.450
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.9515187740325928
Epoch: 7, Steps: 16 | Train Loss: 1.004 Vali Loss: 25.056 Vali Acc: 0.397 Test Loss: 25.056 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0197436809539795
Epoch: 8, Steps: 16 | Train Loss: 1.309 Vali Loss: 32.563 Vali Acc: 0.313 Test Loss: 32.563 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.1099328994750977
Epoch: 9, Steps: 16 | Train Loss: 0.283 Vali Loss: 36.426 Vali Acc: 0.389 Test Loss: 36.426 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9214634895324707
Epoch: 10, Steps: 16 | Train Loss: 1.398 Vali Loss: 57.076 Vali Acc: 0.290 Test Loss: 57.076 Test Acc: 0.290
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.860790491104126
Epoch: 11, Steps: 16 | Train Loss: 0.876 Vali Loss: 71.927 Vali Acc: 0.351 Test Loss: 71.927 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 324313281
model size : 1237.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.401259422302246
Epoch: 1, Steps: 16 | Train Loss: 2.112 Vali Loss: 2.517 Vali Acc: 0.313 Test Loss: 2.517 Test Acc: 0.313
Validation loss decreased (inf --> -0.312952).  Saving model ...
Epoch: 2 cost time: 2.8379387855529785
Epoch: 2, Steps: 16 | Train Loss: 0.277 Vali Loss: 8.040 Vali Acc: 0.397 Test Loss: 8.040 Test Acc: 0.397
Validation loss decreased (-0.312952 --> -0.396866).  Saving model ...
Epoch: 3 cost time: 3.218153715133667
Epoch: 3, Steps: 16 | Train Loss: 0.223 Vali Loss: 10.782 Vali Acc: 0.397 Test Loss: 10.782 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9609196186065674
Epoch: 4, Steps: 16 | Train Loss: 0.452 Vali Loss: 10.654 Vali Acc: 0.359 Test Loss: 10.654 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0564661026000977
Epoch: 5, Steps: 16 | Train Loss: 0.132 Vali Loss: 13.376 Vali Acc: 0.359 Test Loss: 13.376 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.8826136589050293
Epoch: 6, Steps: 16 | Train Loss: 0.294 Vali Loss: 16.741 Vali Acc: 0.458 Test Loss: 16.741 Test Acc: 0.458
Validation loss decreased (-0.396866 --> -0.457848).  Saving model ...
Epoch: 7 cost time: 2.8348164558410645
Epoch: 7, Steps: 16 | Train Loss: 0.431 Vali Loss: 17.505 Vali Acc: 0.443 Test Loss: 17.505 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1900086402893066
Epoch: 8, Steps: 16 | Train Loss: 0.123 Vali Loss: 13.586 Vali Acc: 0.382 Test Loss: 13.586 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8590681552886963
Epoch: 9, Steps: 16 | Train Loss: 0.515 Vali Loss: 19.218 Vali Acc: 0.351 Test Loss: 19.218 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8874101638793945
Epoch: 10, Steps: 16 | Train Loss: 0.745 Vali Loss: 28.224 Vali Acc: 0.389 Test Loss: 28.224 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9564239978790283
Epoch: 11, Steps: 16 | Train Loss: 1.014 Vali Loss: 27.392 Vali Acc: 0.389 Test Loss: 27.392 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.871058702468872
Epoch: 12, Steps: 16 | Train Loss: 0.633 Vali Loss: 38.527 Vali Acc: 0.397 Test Loss: 38.527 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.717458724975586
Epoch: 13, Steps: 16 | Train Loss: 0.287 Vali Loss: 44.288 Vali Acc: 0.389 Test Loss: 44.288 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.9959123134613037
Epoch: 14, Steps: 16 | Train Loss: 0.446 Vali Loss: 43.630 Vali Acc: 0.366 Test Loss: 43.630 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0345423221588135
Epoch: 15, Steps: 16 | Train Loss: 0.289 Vali Loss: 45.538 Vali Acc: 0.382 Test Loss: 45.538 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9229986667633057
Epoch: 16, Steps: 16 | Train Loss: 0.009 Vali Loss: 47.300 Vali Acc: 0.389 Test Loss: 47.300 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324335583
model size : 1237.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.798462867736816
Epoch: 1, Steps: 16 | Train Loss: 1.720 Vali Loss: 4.906 Vali Acc: 0.397 Test Loss: 4.906 Test Acc: 0.397
Validation loss decreased (inf --> -0.396898).  Saving model ...
Epoch: 2 cost time: 3.1449785232543945
Epoch: 2, Steps: 16 | Train Loss: 0.087 Vali Loss: 9.880 Vali Acc: 0.427 Test Loss: 9.880 Test Acc: 0.427
Validation loss decreased (-0.396898 --> -0.427382).  Saving model ...
Epoch: 3 cost time: 3.043534755706787
Epoch: 3, Steps: 16 | Train Loss: 0.124 Vali Loss: 14.435 Vali Acc: 0.420 Test Loss: 14.435 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5001134872436523
Epoch: 4, Steps: 16 | Train Loss: 0.102 Vali Loss: 15.848 Vali Acc: 0.443 Test Loss: 15.848 Test Acc: 0.443
Validation loss decreased (-0.427382 --> -0.442590).  Saving model ...
Epoch: 5 cost time: 3.1177260875701904
Epoch: 5, Steps: 16 | Train Loss: 0.223 Vali Loss: 18.197 Vali Acc: 0.305 Test Loss: 18.197 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.319976329803467
Epoch: 6, Steps: 16 | Train Loss: 0.380 Vali Loss: 21.311 Vali Acc: 0.427 Test Loss: 21.311 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8755862712860107
Epoch: 7, Steps: 16 | Train Loss: 1.901 Vali Loss: 27.475 Vali Acc: 0.313 Test Loss: 27.475 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.886704206466675
Epoch: 8, Steps: 16 | Train Loss: 1.057 Vali Loss: 27.805 Vali Acc: 0.397 Test Loss: 27.805 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.1502745151519775
Epoch: 9, Steps: 16 | Train Loss: 0.780 Vali Loss: 39.430 Vali Acc: 0.397 Test Loss: 39.430 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.191537857055664
Epoch: 10, Steps: 16 | Train Loss: 0.689 Vali Loss: 40.602 Vali Acc: 0.344 Test Loss: 40.602 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.9907050132751465
Epoch: 11, Steps: 16 | Train Loss: 0.225 Vali Loss: 35.053 Vali Acc: 0.336 Test Loss: 35.053 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9010884761810303
Epoch: 12, Steps: 16 | Train Loss: 0.087 Vali Loss: 35.955 Vali Acc: 0.351 Test Loss: 35.955 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.8733887672424316
Epoch: 13, Steps: 16 | Train Loss: 1.862 Vali Loss: 44.002 Vali Acc: 0.321 Test Loss: 44.002 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.249347686767578
Epoch: 14, Steps: 16 | Train Loss: 0.477 Vali Loss: 77.348 Vali Acc: 0.351 Test Loss: 77.348 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324217409
model size : 1236.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.874787092208862
Epoch: 1, Steps: 16 | Train Loss: 1.864 Vali Loss: 3.248 Vali Acc: 0.397 Test Loss: 3.248 Test Acc: 0.397
Validation loss decreased (inf --> -0.396914).  Saving model ...
Epoch: 2 cost time: 3.1183316707611084
Epoch: 2, Steps: 16 | Train Loss: 0.486 Vali Loss: 6.638 Vali Acc: 0.351 Test Loss: 6.638 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.2875752449035645
Epoch: 3, Steps: 16 | Train Loss: 0.166 Vali Loss: 10.175 Vali Acc: 0.366 Test Loss: 10.175 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.356834650039673
Epoch: 4, Steps: 16 | Train Loss: 0.380 Vali Loss: 11.006 Vali Acc: 0.359 Test Loss: 11.006 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2037839889526367
Epoch: 5, Steps: 16 | Train Loss: 0.174 Vali Loss: 13.535 Vali Acc: 0.382 Test Loss: 13.535 Test Acc: 0.382
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.4957852363586426
Epoch: 6, Steps: 16 | Train Loss: 0.349 Vali Loss: 16.212 Vali Acc: 0.389 Test Loss: 16.212 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.234825611114502
Epoch: 7, Steps: 16 | Train Loss: 0.232 Vali Loss: 19.799 Vali Acc: 0.336 Test Loss: 19.799 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.2800424098968506
Epoch: 8, Steps: 16 | Train Loss: 0.235 Vali Loss: 22.162 Vali Acc: 0.336 Test Loss: 22.162 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.392298460006714
Epoch: 9, Steps: 16 | Train Loss: 0.582 Vali Loss: 24.432 Vali Acc: 0.389 Test Loss: 24.432 Test Acc: 0.389
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.3433241844177246
Epoch: 10, Steps: 16 | Train Loss: 0.002 Vali Loss: 24.013 Vali Acc: 0.359 Test Loss: 24.013 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.272995710372925
Epoch: 11, Steps: 16 | Train Loss: 0.642 Vali Loss: 24.636 Vali Acc: 0.359 Test Loss: 24.636 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.3969465648854962
model parameter : 324335367
model size : 1237.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.248101711273193
Epoch: 1, Steps: 16 | Train Loss: 1.745 Vali Loss: 2.902 Vali Acc: 0.458 Test Loss: 2.902 Test Acc: 0.458
Validation loss decreased (inf --> -0.457986).  Saving model ...
Epoch: 2 cost time: 3.776031494140625
Epoch: 2, Steps: 16 | Train Loss: 0.512 Vali Loss: 6.536 Vali Acc: 0.511 Test Loss: 6.536 Test Acc: 0.511
Validation loss decreased (-0.457986 --> -0.511385).  Saving model ...
Epoch: 3 cost time: 3.1508450508117676
Epoch: 3, Steps: 16 | Train Loss: 0.340 Vali Loss: 10.887 Vali Acc: 0.397 Test Loss: 10.887 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.480273962020874
Epoch: 4, Steps: 16 | Train Loss: 0.120 Vali Loss: 10.864 Vali Acc: 0.420 Test Loss: 10.864 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.093109607696533
Epoch: 5, Steps: 16 | Train Loss: 0.212 Vali Loss: 16.610 Vali Acc: 0.382 Test Loss: 16.610 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.161456346511841
Epoch: 6, Steps: 16 | Train Loss: 0.708 Vali Loss: 17.750 Vali Acc: 0.443 Test Loss: 17.750 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.5016672611236572
Epoch: 7, Steps: 16 | Train Loss: 0.187 Vali Loss: 20.770 Vali Acc: 0.351 Test Loss: 20.770 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.442483425140381
Epoch: 8, Steps: 16 | Train Loss: 0.186 Vali Loss: 22.474 Vali Acc: 0.397 Test Loss: 22.474 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.163010597229004
Epoch: 9, Steps: 16 | Train Loss: 0.436 Vali Loss: 31.612 Vali Acc: 0.389 Test Loss: 31.612 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.17927885055542
Epoch: 10, Steps: 16 | Train Loss: 0.356 Vali Loss: 34.931 Vali Acc: 0.382 Test Loss: 34.931 Test Acc: 0.382
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.1841862201690674
Epoch: 11, Steps: 16 | Train Loss: 1.901 Vali Loss: 38.162 Vali Acc: 0.382 Test Loss: 38.162 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.420910596847534
Epoch: 12, Steps: 16 | Train Loss: 0.989 Vali Loss: 39.939 Vali Acc: 0.412 Test Loss: 39.939 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5114503816793893
model parameter : 324311025
model size : 1237.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.272336483001709
Epoch: 1, Steps: 16 | Train Loss: 1.925 Vali Loss: 3.225 Vali Acc: 0.351 Test Loss: 3.225 Test Acc: 0.351
Validation loss decreased (inf --> -0.351113).  Saving model ...
Epoch: 2 cost time: 3.4769721031188965
Epoch: 2, Steps: 16 | Train Loss: 0.390 Vali Loss: 6.180 Vali Acc: 0.466 Test Loss: 6.180 Test Acc: 0.466
Validation loss decreased (-0.351113 --> -0.465587).  Saving model ...
Epoch: 3 cost time: 3.0882911682128906
Epoch: 3, Steps: 16 | Train Loss: 0.259 Vali Loss: 8.714 Vali Acc: 0.344 Test Loss: 8.714 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.350876569747925
Epoch: 4, Steps: 16 | Train Loss: 0.403 Vali Loss: 11.605 Vali Acc: 0.397 Test Loss: 11.605 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.0359573364257812
Epoch: 5, Steps: 16 | Train Loss: 0.209 Vali Loss: 12.552 Vali Acc: 0.359 Test Loss: 12.552 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9992995262145996
Epoch: 6, Steps: 16 | Train Loss: 0.448 Vali Loss: 15.116 Vali Acc: 0.366 Test Loss: 15.116 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.0418617725372314
Epoch: 7, Steps: 16 | Train Loss: 0.585 Vali Loss: 19.318 Vali Acc: 0.366 Test Loss: 19.318 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.3795809745788574
Epoch: 8, Steps: 16 | Train Loss: 0.457 Vali Loss: 26.658 Vali Acc: 0.397 Test Loss: 26.658 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.070434808731079
Epoch: 9, Steps: 16 | Train Loss: 1.266 Vali Loss: 35.856 Vali Acc: 0.389 Test Loss: 35.856 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.2871499061584473
Epoch: 10, Steps: 16 | Train Loss: 0.437 Vali Loss: 40.693 Vali Acc: 0.351 Test Loss: 40.693 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.5864386558532715
Epoch: 11, Steps: 16 | Train Loss: 0.401 Vali Loss: 41.524 Vali Acc: 0.412 Test Loss: 41.524 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.455263137817383
Epoch: 12, Steps: 16 | Train Loss: 0.118 Vali Loss: 43.459 Vali Acc: 0.443 Test Loss: 43.459 Test Acc: 0.443
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324215903
model size : 1236.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.675929307937622
Epoch: 1, Steps: 16 | Train Loss: 1.777 Vali Loss: 3.522 Vali Acc: 0.389 Test Loss: 3.522 Test Acc: 0.389
Validation loss decreased (inf --> -0.389278).  Saving model ...
Epoch: 2 cost time: 3.861588478088379
Epoch: 2, Steps: 16 | Train Loss: 0.271 Vali Loss: 6.719 Vali Acc: 0.374 Test Loss: 6.719 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7255308628082275
Epoch: 3, Steps: 16 | Train Loss: 0.462 Vali Loss: 9.576 Vali Acc: 0.374 Test Loss: 9.576 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.237898349761963
Epoch: 4, Steps: 16 | Train Loss: 0.126 Vali Loss: 13.926 Vali Acc: 0.443 Test Loss: 13.926 Test Acc: 0.443
Validation loss decreased (-0.389278 --> -0.442609).  Saving model ...
Epoch: 5 cost time: 3.689347982406616
Epoch: 5, Steps: 16 | Train Loss: 0.161 Vali Loss: 14.007 Vali Acc: 0.374 Test Loss: 14.007 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3932859897613525
Epoch: 6, Steps: 16 | Train Loss: 0.195 Vali Loss: 17.352 Vali Acc: 0.351 Test Loss: 17.352 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.428792715072632
Epoch: 7, Steps: 16 | Train Loss: 1.329 Vali Loss: 19.601 Vali Acc: 0.443 Test Loss: 19.601 Test Acc: 0.443
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.329317569732666
Epoch: 8, Steps: 16 | Train Loss: 0.590 Vali Loss: 38.793 Vali Acc: 0.420 Test Loss: 38.793 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.305248498916626
Epoch: 9, Steps: 16 | Train Loss: 0.491 Vali Loss: 43.228 Vali Acc: 0.389 Test Loss: 43.228 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4101779460906982
Epoch: 10, Steps: 16 | Train Loss: 1.032 Vali Loss: 43.482 Vali Acc: 0.420 Test Loss: 43.482 Test Acc: 0.420
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.187709093093872
Epoch: 11, Steps: 16 | Train Loss: 0.001 Vali Loss: 45.841 Vali Acc: 0.412 Test Loss: 45.841 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.534487724304199
Epoch: 12, Steps: 16 | Train Loss: 0.192 Vali Loss: 42.392 Vali Acc: 0.435 Test Loss: 42.392 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.372434139251709
Epoch: 13, Steps: 16 | Train Loss: 0.174 Vali Loss: 53.153 Vali Acc: 0.405 Test Loss: 53.153 Test Acc: 0.405
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.9548237323760986
Epoch: 14, Steps: 16 | Train Loss: 0.354 Vali Loss: 66.775 Vali Acc: 0.344 Test Loss: 66.775 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324265553
model size : 1236.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.453128814697266
Epoch: 1, Steps: 16 | Train Loss: 1.729 Vali Loss: 3.661 Vali Acc: 0.366 Test Loss: 3.661 Test Acc: 0.366
Validation loss decreased (inf --> -0.366376).  Saving model ...
Epoch: 2 cost time: 2.967891216278076
Epoch: 2, Steps: 16 | Train Loss: 0.439 Vali Loss: 7.237 Vali Acc: 0.336 Test Loss: 7.237 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4355945587158203
Epoch: 3, Steps: 16 | Train Loss: 0.511 Vali Loss: 7.659 Vali Acc: 0.412 Test Loss: 7.659 Test Acc: 0.412
Validation loss decreased (-0.366376 --> -0.412137).  Saving model ...
Epoch: 4 cost time: 2.9748239517211914
Epoch: 4, Steps: 16 | Train Loss: 0.175 Vali Loss: 10.240 Vali Acc: 0.382 Test Loss: 10.240 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2347471714019775
Epoch: 5, Steps: 16 | Train Loss: 0.051 Vali Loss: 11.893 Vali Acc: 0.427 Test Loss: 11.893 Test Acc: 0.427
Validation loss decreased (-0.412137 --> -0.427362).  Saving model ...
Epoch: 6 cost time: 3.1867384910583496
Epoch: 6, Steps: 16 | Train Loss: 1.091 Vali Loss: 20.325 Vali Acc: 0.366 Test Loss: 20.325 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1375620365142822
Epoch: 7, Steps: 16 | Train Loss: 1.387 Vali Loss: 24.989 Vali Acc: 0.290 Test Loss: 24.989 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.0066230297088623
Epoch: 8, Steps: 16 | Train Loss: 0.650 Vali Loss: 31.001 Vali Acc: 0.336 Test Loss: 31.001 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9965412616729736
Epoch: 9, Steps: 16 | Train Loss: 0.372 Vali Loss: 31.210 Vali Acc: 0.366 Test Loss: 31.210 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.2683558464050293
Epoch: 10, Steps: 16 | Train Loss: 0.253 Vali Loss: 35.838 Vali Acc: 0.397 Test Loss: 35.838 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.97802996635437
Epoch: 11, Steps: 16 | Train Loss: 0.618 Vali Loss: 39.011 Vali Acc: 0.389 Test Loss: 39.011 Test Acc: 0.389
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0913443565368652
Epoch: 12, Steps: 16 | Train Loss: 2.718 Vali Loss: 64.501 Vali Acc: 0.344 Test Loss: 64.501 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0977120399475098
Epoch: 13, Steps: 16 | Train Loss: 0.659 Vali Loss: 111.935 Vali Acc: 0.374 Test Loss: 111.935 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.470472574234009
Epoch: 14, Steps: 16 | Train Loss: 2.687 Vali Loss: 119.396 Vali Acc: 0.359 Test Loss: 119.396 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0687215328216553
Epoch: 15, Steps: 16 | Train Loss: 1.451 Vali Loss: 121.530 Vali Acc: 0.382 Test Loss: 121.530 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 324333863
model size : 1237.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.424109697341919
Epoch: 1, Steps: 16 | Train Loss: 1.836 Vali Loss: 3.689 Vali Acc: 0.229 Test Loss: 3.689 Test Acc: 0.229
Validation loss decreased (inf --> -0.228971).  Saving model ...
Epoch: 2 cost time: 3.1373469829559326
Epoch: 2, Steps: 16 | Train Loss: 0.340 Vali Loss: 6.007 Vali Acc: 0.344 Test Loss: 6.007 Test Acc: 0.344
Validation loss decreased (-0.228971 --> -0.343451).  Saving model ...
Epoch: 3 cost time: 3.104804515838623
Epoch: 3, Steps: 16 | Train Loss: 0.241 Vali Loss: 7.346 Vali Acc: 0.420 Test Loss: 7.346 Test Acc: 0.420
Validation loss decreased (-0.343451 --> -0.419774).  Saving model ...
Epoch: 4 cost time: 3.392536163330078
Epoch: 4, Steps: 16 | Train Loss: 0.071 Vali Loss: 9.465 Vali Acc: 0.412 Test Loss: 9.465 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1624491214752197
Epoch: 5, Steps: 16 | Train Loss: 0.165 Vali Loss: 12.702 Vali Acc: 0.427 Test Loss: 12.702 Test Acc: 0.427
Validation loss decreased (-0.419774 --> -0.427354).  Saving model ...
Epoch: 6 cost time: 3.222099542617798
Epoch: 6, Steps: 16 | Train Loss: 0.221 Vali Loss: 14.940 Vali Acc: 0.382 Test Loss: 14.940 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.0380594730377197
Epoch: 7, Steps: 16 | Train Loss: 0.209 Vali Loss: 16.236 Vali Acc: 0.420 Test Loss: 16.236 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5411367416381836
Epoch: 8, Steps: 16 | Train Loss: 0.886 Vali Loss: 26.950 Vali Acc: 0.366 Test Loss: 26.950 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6115827560424805
Epoch: 9, Steps: 16 | Train Loss: 0.640 Vali Loss: 42.013 Vali Acc: 0.344 Test Loss: 42.013 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.187316656112671
Epoch: 10, Steps: 16 | Train Loss: 1.114 Vali Loss: 47.508 Vali Acc: 0.366 Test Loss: 47.508 Test Acc: 0.366
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.3197834491729736
Epoch: 11, Steps: 16 | Train Loss: 0.260 Vali Loss: 52.944 Vali Acc: 0.397 Test Loss: 52.944 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4061505794525146
Epoch: 12, Steps: 16 | Train Loss: 0.505 Vali Loss: 58.166 Vali Acc: 0.412 Test Loss: 58.166 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.6881580352783203
Epoch: 13, Steps: 16 | Train Loss: 0.283 Vali Loss: 53.925 Vali Acc: 0.435 Test Loss: 53.925 Test Acc: 0.435
Validation loss decreased (-0.427354 --> -0.434575).  Saving model ...
Epoch: 14 cost time: 3.2015669345855713
Epoch: 14, Steps: 16 | Train Loss: 0.001 Vali Loss: 53.638 Vali Acc: 0.412 Test Loss: 53.638 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.3993113040924072
Epoch: 15, Steps: 16 | Train Loss: 0.026 Vali Loss: 51.852 Vali Acc: 0.374 Test Loss: 51.852 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.497081995010376
Epoch: 16, Steps: 16 | Train Loss: 0.087 Vali Loss: 58.193 Vali Acc: 0.351 Test Loss: 58.193 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.0851128101348877
Epoch: 17, Steps: 16 | Train Loss: 2.287 Vali Loss: 59.416 Vali Acc: 0.344 Test Loss: 59.416 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.4631731510162354
Epoch: 18, Steps: 16 | Train Loss: 1.736 Vali Loss: 51.354 Vali Acc: 0.405 Test Loss: 51.354 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.650313138961792
Epoch: 19, Steps: 16 | Train Loss: 1.085 Vali Loss: 58.275 Vali Acc: 0.435 Test Loss: 58.275 Test Acc: 0.435
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.165107011795044
Epoch: 20, Steps: 16 | Train Loss: 0.311 Vali Loss: 65.710 Vali Acc: 0.427 Test Loss: 65.710 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.3605422973632812
Epoch: 21, Steps: 16 | Train Loss: 0.355 Vali Loss: 99.303 Vali Acc: 0.366 Test Loss: 99.303 Test Acc: 0.366
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5116279125213623
Epoch: 22, Steps: 16 | Train Loss: 5.059 Vali Loss: 153.516 Vali Acc: 0.351 Test Loss: 153.516 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.5825107097625732
Epoch: 23, Steps: 16 | Train Loss: 1.027 Vali Loss: 214.121 Vali Acc: 0.374 Test Loss: 214.121 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4351145038167939
model parameter : 324294785
model size : 1237.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.083093881607056
Epoch: 1, Steps: 16 | Train Loss: 1.977 Vali Loss: 4.735 Vali Acc: 0.282 Test Loss: 4.735 Test Acc: 0.282
Validation loss decreased (inf --> -0.282395).  Saving model ...
Epoch: 2 cost time: 2.9756126403808594
Epoch: 2, Steps: 16 | Train Loss: 0.342 Vali Loss: 10.326 Vali Acc: 0.489 Test Loss: 10.326 Test Acc: 0.489
Validation loss decreased (-0.282395 --> -0.488446).  Saving model ...
Epoch: 3 cost time: 3.276453971862793
Epoch: 3, Steps: 16 | Train Loss: 0.306 Vali Loss: 11.555 Vali Acc: 0.443 Test Loss: 11.555 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.231785297393799
Epoch: 4, Steps: 16 | Train Loss: 0.237 Vali Loss: 13.891 Vali Acc: 0.443 Test Loss: 13.891 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.127593755722046
Epoch: 5, Steps: 16 | Train Loss: 0.294 Vali Loss: 14.551 Vali Acc: 0.397 Test Loss: 14.551 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.1061582565307617
Epoch: 6, Steps: 16 | Train Loss: 0.484 Vali Loss: 16.275 Vali Acc: 0.427 Test Loss: 16.275 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.2113118171691895
Epoch: 7, Steps: 16 | Train Loss: 0.326 Vali Loss: 17.187 Vali Acc: 0.374 Test Loss: 17.187 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.1742606163024902
Epoch: 8, Steps: 16 | Train Loss: 0.224 Vali Loss: 17.171 Vali Acc: 0.405 Test Loss: 17.171 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.1897504329681396
Epoch: 9, Steps: 16 | Train Loss: 0.791 Vali Loss: 25.801 Vali Acc: 0.321 Test Loss: 25.801 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.471421241760254
Epoch: 10, Steps: 16 | Train Loss: 0.758 Vali Loss: 34.808 Vali Acc: 0.359 Test Loss: 34.808 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.085341453552246
Epoch: 11, Steps: 16 | Train Loss: 3.207 Vali Loss: 50.440 Vali Acc: 0.366 Test Loss: 50.440 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.150272846221924
Epoch: 12, Steps: 16 | Train Loss: 0.758 Vali Loss: 72.939 Vali Acc: 0.382 Test Loss: 72.939 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324202175
model size : 1236.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 6.4453301429748535
Epoch: 1, Steps: 16 | Train Loss: 2.365 Vali Loss: 4.829 Vali Acc: 0.313 Test Loss: 4.829 Test Acc: 0.313
Validation loss decreased (inf --> -0.312929).  Saving model ...
Epoch: 2 cost time: 3.146574020385742
Epoch: 2, Steps: 16 | Train Loss: 0.361 Vali Loss: 11.269 Vali Acc: 0.473 Test Loss: 11.269 Test Acc: 0.473
Validation loss decreased (-0.312929 --> -0.473170).  Saving model ...
Epoch: 3 cost time: 3.193345546722412
Epoch: 3, Steps: 16 | Train Loss: 0.222 Vali Loss: 13.323 Vali Acc: 0.389 Test Loss: 13.323 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9494755268096924
Epoch: 4, Steps: 16 | Train Loss: 0.653 Vali Loss: 17.757 Vali Acc: 0.473 Test Loss: 17.757 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.345123052597046
Epoch: 5, Steps: 16 | Train Loss: 1.320 Vali Loss: 17.070 Vali Acc: 0.382 Test Loss: 17.070 Test Acc: 0.382
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.071265697479248
Epoch: 6, Steps: 16 | Train Loss: 0.344 Vali Loss: 18.200 Vali Acc: 0.359 Test Loss: 18.200 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.172441244125366
Epoch: 7, Steps: 16 | Train Loss: 0.854 Vali Loss: 21.188 Vali Acc: 0.443 Test Loss: 21.188 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.188868522644043
Epoch: 8, Steps: 16 | Train Loss: 0.871 Vali Loss: 30.790 Vali Acc: 0.351 Test Loss: 30.790 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9681177139282227
Epoch: 9, Steps: 16 | Train Loss: 2.148 Vali Loss: 37.619 Vali Acc: 0.328 Test Loss: 37.619 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.9974758625030518
Epoch: 10, Steps: 16 | Train Loss: 0.318 Vali Loss: 48.154 Vali Acc: 0.427 Test Loss: 48.154 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.248002290725708
Epoch: 11, Steps: 16 | Train Loss: 0.232 Vali Loss: 56.350 Vali Acc: 0.412 Test Loss: 56.350 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.6839563846588135
Epoch: 12, Steps: 16 | Train Loss: 0.261 Vali Loss: 56.831 Vali Acc: 0.328 Test Loss: 56.831 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324181857
model size : 1236.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.375442266464233
Epoch: 1, Steps: 16 | Train Loss: 2.366 Vali Loss: 2.898 Vali Acc: 0.458 Test Loss: 2.898 Test Acc: 0.458
Validation loss decreased (inf --> -0.457986).  Saving model ...
Epoch: 2 cost time: 3.152419090270996
Epoch: 2, Steps: 16 | Train Loss: 0.313 Vali Loss: 9.771 Vali Acc: 0.458 Test Loss: 9.771 Test Acc: 0.458
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2204971313476562
Epoch: 3, Steps: 16 | Train Loss: 0.267 Vali Loss: 12.294 Vali Acc: 0.412 Test Loss: 12.294 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.3634068965911865
Epoch: 4, Steps: 16 | Train Loss: 0.238 Vali Loss: 15.133 Vali Acc: 0.359 Test Loss: 15.133 Test Acc: 0.359
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.290538787841797
Epoch: 5, Steps: 16 | Train Loss: 0.077 Vali Loss: 18.245 Vali Acc: 0.366 Test Loss: 18.245 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.3621983528137207
Epoch: 6, Steps: 16 | Train Loss: 0.378 Vali Loss: 21.780 Vali Acc: 0.405 Test Loss: 21.780 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1943671703338623
Epoch: 7, Steps: 16 | Train Loss: 0.294 Vali Loss: 18.345 Vali Acc: 0.374 Test Loss: 18.345 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.652463674545288
Epoch: 8, Steps: 16 | Train Loss: 1.017 Vali Loss: 24.871 Vali Acc: 0.412 Test Loss: 24.871 Test Acc: 0.412
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.2234411239624023
Epoch: 9, Steps: 16 | Train Loss: 0.727 Vali Loss: 31.995 Vali Acc: 0.443 Test Loss: 31.995 Test Acc: 0.443
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.235236406326294
Epoch: 10, Steps: 16 | Train Loss: 5.562 Vali Loss: 37.760 Vali Acc: 0.328 Test Loss: 37.760 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.448693037033081
Epoch: 11, Steps: 16 | Train Loss: 1.237 Vali Loss: 56.271 Vali Acc: 0.374 Test Loss: 56.271 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324215783
model size : 1236.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.360128402709961
Epoch: 1, Steps: 16 | Train Loss: 1.799 Vali Loss: 3.816 Vali Acc: 0.466 Test Loss: 3.816 Test Acc: 0.466
Validation loss decreased (inf --> -0.465611).  Saving model ...
Epoch: 2 cost time: 3.3162460327148438
Epoch: 2, Steps: 16 | Train Loss: 0.207 Vali Loss: 8.201 Vali Acc: 0.405 Test Loss: 8.201 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3151965141296387
Epoch: 3, Steps: 16 | Train Loss: 0.225 Vali Loss: 11.905 Vali Acc: 0.489 Test Loss: 11.905 Test Acc: 0.489
Validation loss decreased (-0.465611 --> -0.488431).  Saving model ...
Epoch: 4 cost time: 3.089299440383911
Epoch: 4, Steps: 16 | Train Loss: 0.990 Vali Loss: 11.379 Vali Acc: 0.374 Test Loss: 11.379 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.059054374694824
Epoch: 5, Steps: 16 | Train Loss: 0.665 Vali Loss: 12.479 Vali Acc: 0.458 Test Loss: 12.479 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2300617694854736
Epoch: 6, Steps: 16 | Train Loss: 0.297 Vali Loss: 14.593 Vali Acc: 0.374 Test Loss: 14.593 Test Acc: 0.374
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.250479221343994
Epoch: 7, Steps: 16 | Train Loss: 0.256 Vali Loss: 19.032 Vali Acc: 0.443 Test Loss: 19.032 Test Acc: 0.443
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.308258056640625
Epoch: 8, Steps: 16 | Train Loss: 0.523 Vali Loss: 29.347 Vali Acc: 0.412 Test Loss: 29.347 Test Acc: 0.412
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.237494945526123
Epoch: 9, Steps: 16 | Train Loss: 0.542 Vali Loss: 35.139 Vali Acc: 0.427 Test Loss: 35.139 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.1598782539367676
Epoch: 10, Steps: 16 | Train Loss: 0.809 Vali Loss: 39.656 Vali Acc: 0.473 Test Loss: 39.656 Test Acc: 0.473
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.388090133666992
Epoch: 11, Steps: 16 | Train Loss: 0.133 Vali Loss: 46.498 Vali Acc: 0.435 Test Loss: 46.498 Test Acc: 0.435
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.3069405555725098
Epoch: 12, Steps: 16 | Train Loss: 0.307 Vali Loss: 49.190 Vali Acc: 0.420 Test Loss: 49.190 Test Acc: 0.420
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.290686845779419
Epoch: 13, Steps: 16 | Train Loss: 0.061 Vali Loss: 53.239 Vali Acc: 0.405 Test Loss: 53.239 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324465777
model size : 1237.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.497676372528076
Epoch: 1, Steps: 16 | Train Loss: 2.090 Vali Loss: 2.737 Vali Acc: 0.374 Test Loss: 2.737 Test Acc: 0.374
Validation loss decreased (inf --> -0.374018).  Saving model ...
Epoch: 2 cost time: 3.060758590698242
Epoch: 2, Steps: 16 | Train Loss: 0.464 Vali Loss: 10.430 Vali Acc: 0.466 Test Loss: 10.430 Test Acc: 0.466
Validation loss decreased (-0.374018 --> -0.465545).  Saving model ...
Epoch: 3 cost time: 3.429877996444702
Epoch: 3, Steps: 16 | Train Loss: 0.264 Vali Loss: 10.455 Vali Acc: 0.443 Test Loss: 10.455 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.964393377304077
Epoch: 4, Steps: 16 | Train Loss: 0.017 Vali Loss: 12.711 Vali Acc: 0.344 Test Loss: 12.711 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3633663654327393
Epoch: 5, Steps: 16 | Train Loss: 0.112 Vali Loss: 14.126 Vali Acc: 0.458 Test Loss: 14.126 Test Acc: 0.458
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.490173578262329
Epoch: 6, Steps: 16 | Train Loss: 0.217 Vali Loss: 15.937 Vali Acc: 0.458 Test Loss: 15.937 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.029416799545288
Epoch: 7, Steps: 16 | Train Loss: 0.145 Vali Loss: 16.417 Vali Acc: 0.374 Test Loss: 16.417 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.299943447113037
Epoch: 8, Steps: 16 | Train Loss: 0.433 Vali Loss: 20.454 Vali Acc: 0.489 Test Loss: 20.454 Test Acc: 0.489
Validation loss decreased (-0.465545 --> -0.488345).  Saving model ...
Epoch: 9 cost time: 3.270599603652954
Epoch: 9, Steps: 16 | Train Loss: 0.197 Vali Loss: 24.253 Vali Acc: 0.435 Test Loss: 24.253 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0502631664276123
Epoch: 10, Steps: 16 | Train Loss: 0.517 Vali Loss: 27.815 Vali Acc: 0.458 Test Loss: 27.815 Test Acc: 0.458
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.264864921569824
Epoch: 11, Steps: 16 | Train Loss: 0.661 Vali Loss: 31.976 Vali Acc: 0.405 Test Loss: 31.976 Test Acc: 0.405
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.326192617416382
Epoch: 12, Steps: 16 | Train Loss: 0.443 Vali Loss: 43.362 Vali Acc: 0.344 Test Loss: 43.362 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.137678623199463
Epoch: 13, Steps: 16 | Train Loss: 0.081 Vali Loss: 57.773 Vali Acc: 0.389 Test Loss: 57.773 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1593005657196045
Epoch: 14, Steps: 16 | Train Loss: 1.989 Vali Loss: 55.615 Vali Acc: 0.359 Test Loss: 55.615 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.599497079849243
Epoch: 15, Steps: 16 | Train Loss: 15.398 Vali Loss: 61.058 Vali Acc: 0.344 Test Loss: 61.058 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.520416259765625
Epoch: 16, Steps: 16 | Train Loss: 0.461 Vali Loss: 72.500 Vali Acc: 0.374 Test Loss: 72.500 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.4899582862854004
Epoch: 17, Steps: 16 | Train Loss: 0.684 Vali Loss: 79.655 Vali Acc: 0.397 Test Loss: 79.655 Test Acc: 0.397
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8747782707214355
Epoch: 18, Steps: 16 | Train Loss: 0.077 Vali Loss: 98.205 Vali Acc: 0.389 Test Loss: 98.205 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324338271
model size : 1237.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.141080617904663
Epoch: 1, Steps: 16 | Train Loss: 1.710 Vali Loss: 4.555 Vali Acc: 0.427 Test Loss: 4.555 Test Acc: 0.427
Validation loss decreased (inf --> -0.427435).  Saving model ...
Epoch: 2 cost time: 3.054884672164917
Epoch: 2, Steps: 16 | Train Loss: 0.248 Vali Loss: 9.883 Vali Acc: 0.443 Test Loss: 9.883 Test Acc: 0.443
Validation loss decreased (-0.427435 --> -0.442649).  Saving model ...
Epoch: 3 cost time: 3.1201977729797363
Epoch: 3, Steps: 16 | Train Loss: 0.222 Vali Loss: 12.392 Vali Acc: 0.450 Test Loss: 12.392 Test Acc: 0.450
Validation loss decreased (-0.442649 --> -0.450258).  Saving model ...
Epoch: 4 cost time: 3.1038999557495117
Epoch: 4, Steps: 16 | Train Loss: 0.218 Vali Loss: 10.724 Vali Acc: 0.412 Test Loss: 10.724 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1400434970855713
Epoch: 5, Steps: 16 | Train Loss: 0.266 Vali Loss: 14.393 Vali Acc: 0.405 Test Loss: 14.393 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0385470390319824
Epoch: 6, Steps: 16 | Train Loss: 0.479 Vali Loss: 19.153 Vali Acc: 0.298 Test Loss: 19.153 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0377285480499268
Epoch: 7, Steps: 16 | Train Loss: 0.380 Vali Loss: 21.571 Vali Acc: 0.397 Test Loss: 21.571 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0138916969299316
Epoch: 8, Steps: 16 | Train Loss: 0.439 Vali Loss: 28.558 Vali Acc: 0.466 Test Loss: 28.558 Test Acc: 0.466
Validation loss decreased (-0.450258 --> -0.465363).  Saving model ...
Epoch: 9 cost time: 3.2529735565185547
Epoch: 9, Steps: 16 | Train Loss: 0.261 Vali Loss: 33.491 Vali Acc: 0.450 Test Loss: 33.491 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3623604774475098
Epoch: 10, Steps: 16 | Train Loss: 0.253 Vali Loss: 39.284 Vali Acc: 0.443 Test Loss: 39.284 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.8590426445007324
Epoch: 11, Steps: 16 | Train Loss: 0.094 Vali Loss: 44.370 Vali Acc: 0.427 Test Loss: 44.370 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.008053779602051
Epoch: 12, Steps: 16 | Train Loss: 0.283 Vali Loss: 48.293 Vali Acc: 0.420 Test Loss: 48.293 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.440109968185425
Epoch: 13, Steps: 16 | Train Loss: 0.828 Vali Loss: 74.487 Vali Acc: 0.427 Test Loss: 74.487 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.3963568210601807
Epoch: 14, Steps: 16 | Train Loss: 0.118 Vali Loss: 94.531 Vali Acc: 0.466 Test Loss: 94.531 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.00819993019104
Epoch: 15, Steps: 16 | Train Loss: 2.329 Vali Loss: 107.038 Vali Acc: 0.420 Test Loss: 107.038 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.273784875869751
Epoch: 16, Steps: 16 | Train Loss: 1.075 Vali Loss: 118.322 Vali Acc: 0.420 Test Loss: 118.322 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1729397773742676
Epoch: 17, Steps: 16 | Train Loss: 1.592 Vali Loss: 91.889 Vali Acc: 0.435 Test Loss: 91.889 Test Acc: 0.435
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.4651825428009033
Epoch: 18, Steps: 16 | Train Loss: 0.820 Vali Loss: 76.373 Vali Acc: 0.389 Test Loss: 76.373 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324462737
model size : 1237.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.777739763259888
Epoch: 1, Steps: 16 | Train Loss: 1.865 Vali Loss: 3.901 Vali Acc: 0.351 Test Loss: 3.901 Test Acc: 0.351
Validation loss decreased (inf --> -0.351106).  Saving model ...
Epoch: 2 cost time: 3.2339890003204346
Epoch: 2, Steps: 16 | Train Loss: 0.337 Vali Loss: 6.831 Vali Acc: 0.519 Test Loss: 6.831 Test Acc: 0.519
Validation loss decreased (-0.351106 --> -0.519016).  Saving model ...
Epoch: 3 cost time: 2.7536323070526123
Epoch: 3, Steps: 16 | Train Loss: 0.096 Vali Loss: 9.941 Vali Acc: 0.328 Test Loss: 9.941 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9633443355560303
Epoch: 4, Steps: 16 | Train Loss: 0.065 Vali Loss: 11.294 Vali Acc: 0.382 Test Loss: 11.294 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.886392116546631
Epoch: 5, Steps: 16 | Train Loss: 0.061 Vali Loss: 12.562 Vali Acc: 0.321 Test Loss: 12.562 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.061039447784424
Epoch: 6, Steps: 16 | Train Loss: 0.128 Vali Loss: 11.992 Vali Acc: 0.420 Test Loss: 11.992 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.917532444000244
Epoch: 7, Steps: 16 | Train Loss: 0.093 Vali Loss: 18.444 Vali Acc: 0.374 Test Loss: 18.444 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.0482795238494873
Epoch: 8, Steps: 16 | Train Loss: 0.550 Vali Loss: 21.907 Vali Acc: 0.427 Test Loss: 21.907 Test Acc: 0.427
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.0854671001434326
Epoch: 9, Steps: 16 | Train Loss: 5.430 Vali Loss: 27.409 Vali Acc: 0.427 Test Loss: 27.409 Test Acc: 0.427
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8818624019622803
Epoch: 10, Steps: 16 | Train Loss: 1.438 Vali Loss: 50.039 Vali Acc: 0.427 Test Loss: 50.039 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8624954223632812
Epoch: 11, Steps: 16 | Train Loss: 1.069 Vali Loss: 59.584 Vali Acc: 0.351 Test Loss: 59.584 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.132549524307251
Epoch: 12, Steps: 16 | Train Loss: 0.668 Vali Loss: 67.444 Vali Acc: 0.382 Test Loss: 67.444 Test Acc: 0.382
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm64_cs857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5190839694656488
model parameter : 324407495
model size : 1237.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs8992_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.792114973068237
Epoch: 1, Steps: 16 | Train Loss: 1.830 Vali Loss: 4.942 Vali Acc: 0.344 Test Loss: 4.942 Test Acc: 0.344
Validation loss decreased (inf --> -0.343462).  Saving model ...
Epoch: 2 cost time: 3.0427188873291016
Epoch: 2, Steps: 16 | Train Loss: 0.420 Vali Loss: 8.095 Vali Acc: 0.443 Test Loss: 8.095 Test Acc: 0.443
Validation loss decreased (-0.343462 --> -0.442667).  Saving model ...
Epoch: 3 cost time: 3.354457378387451
Epoch: 3, Steps: 16 | Train Loss: 0.105 Vali Loss: 10.338 Vali Acc: 0.458 Test Loss: 10.338 Test Acc: 0.458
Validation loss decreased (-0.442667 --> -0.457912).  Saving model ...
Epoch: 4 cost time: 3.1597180366516113
Epoch: 4, Steps: 16 | Train Loss: 0.028 Vali Loss: 10.581 Vali Acc: 0.435 Test Loss: 10.581 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.369255781173706
Epoch: 5, Steps: 16 | Train Loss: 0.048 Vali Loss: 15.107 Vali Acc: 0.366 Test Loss: 15.107 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1060268878936768
Epoch: 6, Steps: 16 | Train Loss: 0.445 Vali Loss: 25.887 Vali Acc: 0.351 Test Loss: 25.887 Test Acc: 0.351
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.254032850265503
Epoch: 7, Steps: 16 | Train Loss: 0.821 Vali Loss: 28.444 Vali Acc: 0.359 Test Loss: 28.444 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.4245476722717285
Epoch: 8, Steps: 16 | Train Loss: 2.815 Vali Loss: 27.115 Vali Acc: 0.328 Test Loss: 27.115 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.322923183441162
Epoch: 9, Steps: 16 | Train Loss: 6.423 Vali Loss: 29.774 Vali Acc: 0.405 Test Loss: 29.774 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.344151496887207
Epoch: 10, Steps: 16 | Train Loss: 1.088 Vali Loss: 58.751 Vali Acc: 0.382 Test Loss: 58.751 Test Acc: 0.382
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1420810222625732
Epoch: 11, Steps: 16 | Train Loss: 0.866 Vali Loss: 76.589 Vali Acc: 0.321 Test Loss: 76.589 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.1123883724212646
Epoch: 12, Steps: 16 | Train Loss: 0.920 Vali Loss: 81.814 Vali Acc: 0.313 Test Loss: 81.814 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.3753175735473633
Epoch: 13, Steps: 16 | Train Loss: 0.111 Vali Loss: 86.162 Vali Acc: 0.328 Test Loss: 86.162 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs8992_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324216057
model size : 1236.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs5995_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.735670804977417
Epoch: 1, Steps: 16 | Train Loss: 2.315 Vali Loss: 2.704 Vali Acc: 0.481 Test Loss: 2.704 Test Acc: 0.481
Validation loss decreased (inf --> -0.480889).  Saving model ...
Epoch: 2 cost time: 3.206758737564087
Epoch: 2, Steps: 16 | Train Loss: 0.555 Vali Loss: 9.899 Vali Acc: 0.397 Test Loss: 9.899 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.09317684173584
Epoch: 3, Steps: 16 | Train Loss: 0.251 Vali Loss: 13.024 Vali Acc: 0.427 Test Loss: 13.024 Test Acc: 0.427
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.990952968597412
Epoch: 4, Steps: 16 | Train Loss: 0.519 Vali Loss: 14.313 Vali Acc: 0.366 Test Loss: 14.313 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7569472789764404
Epoch: 5, Steps: 16 | Train Loss: 0.273 Vali Loss: 18.405 Vali Acc: 0.328 Test Loss: 18.405 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.8822250366210938
Epoch: 6, Steps: 16 | Train Loss: 0.446 Vali Loss: 19.830 Vali Acc: 0.466 Test Loss: 19.830 Test Acc: 0.466
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.022172212600708
Epoch: 7, Steps: 16 | Train Loss: 0.918 Vali Loss: 20.418 Vali Acc: 0.466 Test Loss: 20.418 Test Acc: 0.466
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.079756736755371
Epoch: 8, Steps: 16 | Train Loss: 0.188 Vali Loss: 22.226 Vali Acc: 0.321 Test Loss: 22.226 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.8936760425567627
Epoch: 9, Steps: 16 | Train Loss: 0.103 Vali Loss: 27.313 Vali Acc: 0.328 Test Loss: 27.313 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.9909965991973877
Epoch: 10, Steps: 16 | Train Loss: 0.338 Vali Loss: 27.493 Vali Acc: 0.389 Test Loss: 27.493 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 3.2437400817871094
Epoch: 11, Steps: 16 | Train Loss: 0.812 Vali Loss: 38.808 Vali Acc: 0.336 Test Loss: 38.808 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs5995_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324186103
model size : 1236.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs4496_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.7470598220825195
Epoch: 1, Steps: 16 | Train Loss: 2.008 Vali Loss: 3.731 Vali Acc: 0.466 Test Loss: 3.731 Test Acc: 0.466
Validation loss decreased (inf --> -0.465612).  Saving model ...
Epoch: 2 cost time: 2.8099279403686523
Epoch: 2, Steps: 16 | Train Loss: 0.257 Vali Loss: 8.463 Vali Acc: 0.313 Test Loss: 8.463 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0859107971191406
Epoch: 3, Steps: 16 | Train Loss: 0.134 Vali Loss: 11.535 Vali Acc: 0.366 Test Loss: 11.535 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.982595920562744
Epoch: 4, Steps: 16 | Train Loss: 0.501 Vali Loss: 10.789 Vali Acc: 0.282 Test Loss: 10.789 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.6850883960723877
Epoch: 5, Steps: 16 | Train Loss: 0.256 Vali Loss: 11.276 Vali Acc: 0.389 Test Loss: 11.276 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.827167510986328
Epoch: 6, Steps: 16 | Train Loss: 0.540 Vali Loss: 17.394 Vali Acc: 0.435 Test Loss: 17.394 Test Acc: 0.435
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.088948965072632
Epoch: 7, Steps: 16 | Train Loss: 0.690 Vali Loss: 20.278 Vali Acc: 0.374 Test Loss: 20.278 Test Acc: 0.374
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.799147367477417
Epoch: 8, Steps: 16 | Train Loss: 1.319 Vali Loss: 27.092 Vali Acc: 0.397 Test Loss: 27.092 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.656492233276367
Epoch: 9, Steps: 16 | Train Loss: 0.232 Vali Loss: 32.472 Vali Acc: 0.328 Test Loss: 32.472 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.7090251445770264
Epoch: 10, Steps: 16 | Train Loss: 0.332 Vali Loss: 37.672 Vali Acc: 0.351 Test Loss: 37.672 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.8389437198638916
Epoch: 11, Steps: 16 | Train Loss: 1.540 Vali Loss: 38.489 Vali Acc: 0.397 Test Loss: 38.489 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs4496_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324144153
model size : 1236.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs3597_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.800954580307007
Epoch: 1, Steps: 16 | Train Loss: 2.177 Vali Loss: 3.564 Vali Acc: 0.214 Test Loss: 3.564 Test Acc: 0.214
Validation loss decreased (inf --> -0.213705).  Saving model ...
Epoch: 2 cost time: 2.9426350593566895
Epoch: 2, Steps: 16 | Train Loss: 0.429 Vali Loss: 11.591 Vali Acc: 0.305 Test Loss: 11.591 Test Acc: 0.305
Validation loss decreased (-0.213705 --> -0.305228).  Saving model ...
Epoch: 3 cost time: 2.944275379180908
Epoch: 3, Steps: 16 | Train Loss: 0.259 Vali Loss: 17.626 Vali Acc: 0.420 Test Loss: 17.626 Test Acc: 0.420
Validation loss decreased (-0.305228 --> -0.419671).  Saving model ...
Epoch: 4 cost time: 3.1614208221435547
Epoch: 4, Steps: 16 | Train Loss: 0.164 Vali Loss: 16.233 Vali Acc: 0.389 Test Loss: 16.233 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1210107803344727
Epoch: 5, Steps: 16 | Train Loss: 0.242 Vali Loss: 15.389 Vali Acc: 0.458 Test Loss: 15.389 Test Acc: 0.458
Validation loss decreased (-0.419671 --> -0.457861).  Saving model ...
Epoch: 6 cost time: 2.9603610038757324
Epoch: 6, Steps: 16 | Train Loss: 0.064 Vali Loss: 15.986 Vali Acc: 0.405 Test Loss: 15.986 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5970733165740967
Epoch: 7, Steps: 16 | Train Loss: 0.185 Vali Loss: 18.955 Vali Acc: 0.489 Test Loss: 18.955 Test Acc: 0.489
Validation loss decreased (-0.457861 --> -0.488360).  Saving model ...
Epoch: 8 cost time: 2.8260579109191895
Epoch: 8, Steps: 16 | Train Loss: 0.233 Vali Loss: 26.089 Vali Acc: 0.435 Test Loss: 26.089 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.127742052078247
Epoch: 9, Steps: 16 | Train Loss: 1.096 Vali Loss: 28.161 Vali Acc: 0.473 Test Loss: 28.161 Test Acc: 0.473
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.940753936767578
Epoch: 10, Steps: 16 | Train Loss: 0.656 Vali Loss: 32.812 Vali Acc: 0.473 Test Loss: 32.812 Test Acc: 0.473
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.923057794570923
Epoch: 11, Steps: 16 | Train Loss: 0.978 Vali Loss: 39.238 Vali Acc: 0.466 Test Loss: 39.238 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.9339003562927246
Epoch: 12, Steps: 16 | Train Loss: 0.630 Vali Loss: 56.579 Vali Acc: 0.397 Test Loss: 56.579 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.7670249938964844
Epoch: 13, Steps: 16 | Train Loss: 0.439 Vali Loss: 70.398 Vali Acc: 0.328 Test Loss: 70.398 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.710397481918335
Epoch: 14, Steps: 16 | Train Loss: 1.370 Vali Loss: 74.518 Vali Acc: 0.374 Test Loss: 74.518 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9961485862731934
Epoch: 15, Steps: 16 | Train Loss: 0.177 Vali Loss: 70.444 Vali Acc: 0.359 Test Loss: 70.444 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.899038314819336
Epoch: 16, Steps: 16 | Train Loss: 12.900 Vali Loss: 93.084 Vali Acc: 0.344 Test Loss: 93.084 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6619176864624023
Epoch: 17, Steps: 16 | Train Loss: 0.356 Vali Loss: 132.667 Vali Acc: 0.374 Test Loss: 132.667 Test Acc: 0.374
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs3597_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324147775
model size : 1236.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2998_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.4737708568573
Epoch: 1, Steps: 16 | Train Loss: 2.029 Vali Loss: 3.709 Vali Acc: 0.328 Test Loss: 3.709 Test Acc: 0.328
Validation loss decreased (inf --> -0.328207).  Saving model ...
Epoch: 2 cost time: 3.4099581241607666
Epoch: 2, Steps: 16 | Train Loss: 0.437 Vali Loss: 6.355 Vali Acc: 0.420 Test Loss: 6.355 Test Acc: 0.420
Validation loss decreased (-0.328207 --> -0.419784).  Saving model ...
Epoch: 3 cost time: 3.046633720397949
Epoch: 3, Steps: 16 | Train Loss: 0.385 Vali Loss: 7.844 Vali Acc: 0.382 Test Loss: 7.844 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.675858736038208
Epoch: 4, Steps: 16 | Train Loss: 0.597 Vali Loss: 9.004 Vali Acc: 0.412 Test Loss: 9.004 Test Acc: 0.412
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.991281270980835
Epoch: 5, Steps: 16 | Train Loss: 0.185 Vali Loss: 11.903 Vali Acc: 0.366 Test Loss: 11.903 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.0370001792907715
Epoch: 6, Steps: 16 | Train Loss: 0.032 Vali Loss: 14.611 Vali Acc: 0.344 Test Loss: 14.611 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.8974337577819824
Epoch: 7, Steps: 16 | Train Loss: 0.035 Vali Loss: 15.213 Vali Acc: 0.374 Test Loss: 15.213 Test Acc: 0.374
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.8321826457977295
Epoch: 8, Steps: 16 | Train Loss: 0.029 Vali Loss: 18.479 Vali Acc: 0.305 Test Loss: 18.479 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.188613176345825
Epoch: 9, Steps: 16 | Train Loss: 2.046 Vali Loss: 32.460 Vali Acc: 0.397 Test Loss: 32.460 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.3008296489715576
Epoch: 10, Steps: 16 | Train Loss: 0.619 Vali Loss: 44.776 Vali Acc: 0.351 Test Loss: 44.776 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.8293323516845703
Epoch: 11, Steps: 16 | Train Loss: 1.204 Vali Loss: 40.604 Vali Acc: 0.389 Test Loss: 40.604 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.8620357513427734
Epoch: 12, Steps: 16 | Train Loss: 0.285 Vali Loss: 41.130 Vali Acc: 0.313 Test Loss: 41.130 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2998_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4198473282442748
model parameter : 324192169
model size : 1236.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2570_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.728956460952759
Epoch: 1, Steps: 16 | Train Loss: 1.859 Vali Loss: 4.368 Vali Acc: 0.321 Test Loss: 4.368 Test Acc: 0.321
Validation loss decreased (inf --> -0.320567).  Saving model ...
Epoch: 2 cost time: 2.8101563453674316
Epoch: 2, Steps: 16 | Train Loss: 0.646 Vali Loss: 8.090 Vali Acc: 0.344 Test Loss: 8.090 Test Acc: 0.344
Validation loss decreased (-0.320567 --> -0.343431).  Saving model ...
Epoch: 3 cost time: 2.9512295722961426
Epoch: 3, Steps: 16 | Train Loss: 0.152 Vali Loss: 9.307 Vali Acc: 0.435 Test Loss: 9.307 Test Acc: 0.435
Validation loss decreased (-0.343431 --> -0.435021).  Saving model ...
Epoch: 4 cost time: 3.0765810012817383
Epoch: 4, Steps: 16 | Train Loss: 0.157 Vali Loss: 13.923 Vali Acc: 0.481 Test Loss: 13.923 Test Acc: 0.481
Validation loss decreased (-0.435021 --> -0.480777).  Saving model ...
Epoch: 5 cost time: 2.995624542236328
Epoch: 5, Steps: 16 | Train Loss: 0.108 Vali Loss: 16.046 Vali Acc: 0.397 Test Loss: 16.046 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.306420087814331
Epoch: 6, Steps: 16 | Train Loss: 0.514 Vali Loss: 19.698 Vali Acc: 0.389 Test Loss: 19.698 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.985367774963379
Epoch: 7, Steps: 16 | Train Loss: 0.310 Vali Loss: 22.992 Vali Acc: 0.397 Test Loss: 22.992 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8349695205688477
Epoch: 8, Steps: 16 | Train Loss: 1.191 Vali Loss: 26.619 Vali Acc: 0.420 Test Loss: 26.619 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.724424362182617
Epoch: 9, Steps: 16 | Train Loss: 0.964 Vali Loss: 26.170 Vali Acc: 0.443 Test Loss: 26.170 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6451737880706787
Epoch: 10, Steps: 16 | Train Loss: 4.546 Vali Loss: 33.026 Vali Acc: 0.443 Test Loss: 33.026 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.781013011932373
Epoch: 11, Steps: 16 | Train Loss: 1.045 Vali Loss: 45.701 Vali Acc: 0.389 Test Loss: 45.701 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.855924367904663
Epoch: 12, Steps: 16 | Train Loss: 0.516 Vali Loss: 58.337 Vali Acc: 0.344 Test Loss: 58.337 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.845764636993408
Epoch: 13, Steps: 16 | Train Loss: 1.409 Vali Loss: 70.422 Vali Acc: 0.389 Test Loss: 70.422 Test Acc: 0.389
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.686786413192749
Epoch: 14, Steps: 16 | Train Loss: 0.489 Vali Loss: 69.593 Vali Acc: 0.405 Test Loss: 69.593 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2570_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324221319
model size : 1236.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2248_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.523287773132324
Epoch: 1, Steps: 16 | Train Loss: 1.787 Vali Loss: 2.819 Vali Acc: 0.351 Test Loss: 2.819 Test Acc: 0.351
Validation loss decreased (inf --> -0.351117).  Saving model ...
Epoch: 2 cost time: 2.904674530029297
Epoch: 2, Steps: 16 | Train Loss: 0.321 Vali Loss: 5.205 Vali Acc: 0.427 Test Loss: 5.205 Test Acc: 0.427
Validation loss decreased (-0.351117 --> -0.427429).  Saving model ...
Epoch: 3 cost time: 2.9143996238708496
Epoch: 3, Steps: 16 | Train Loss: 0.331 Vali Loss: 6.950 Vali Acc: 0.382 Test Loss: 6.950 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.916393995285034
Epoch: 4, Steps: 16 | Train Loss: 0.160 Vali Loss: 10.600 Vali Acc: 0.366 Test Loss: 10.600 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.1778342723846436
Epoch: 5, Steps: 16 | Train Loss: 0.135 Vali Loss: 12.110 Vali Acc: 0.366 Test Loss: 12.110 Test Acc: 0.366
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.928990364074707
Epoch: 6, Steps: 16 | Train Loss: 0.991 Vali Loss: 14.944 Vali Acc: 0.405 Test Loss: 14.944 Test Acc: 0.405
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.955265998840332
Epoch: 7, Steps: 16 | Train Loss: 2.300 Vali Loss: 28.870 Vali Acc: 0.344 Test Loss: 28.870 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.922166585922241
Epoch: 8, Steps: 16 | Train Loss: 0.651 Vali Loss: 40.263 Vali Acc: 0.366 Test Loss: 40.263 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.91957688331604
Epoch: 9, Steps: 16 | Train Loss: 1.148 Vali Loss: 40.276 Vali Acc: 0.359 Test Loss: 40.276 Test Acc: 0.359
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.0037007331848145
Epoch: 10, Steps: 16 | Train Loss: 0.695 Vali Loss: 39.608 Vali Acc: 0.359 Test Loss: 39.608 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.6697943210601807
Epoch: 11, Steps: 16 | Train Loss: 1.151 Vali Loss: 48.587 Vali Acc: 0.359 Test Loss: 48.587 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.7787909507751465
Epoch: 12, Steps: 16 | Train Loss: 1.298 Vali Loss: 52.092 Vali Acc: 0.328 Test Loss: 52.092 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs2248_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.42748091603053434
model parameter : 324108297
model size : 1236.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1999_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.633272647857666
Epoch: 1, Steps: 16 | Train Loss: 1.946 Vali Loss: 4.155 Vali Acc: 0.313 Test Loss: 4.155 Test Acc: 0.313
Validation loss decreased (inf --> -0.312936).  Saving model ...
Epoch: 2 cost time: 2.9191362857818604
Epoch: 2, Steps: 16 | Train Loss: 0.588 Vali Loss: 7.292 Vali Acc: 0.435 Test Loss: 7.292 Test Acc: 0.435
Validation loss decreased (-0.312936 --> -0.435042).  Saving model ...
Epoch: 3 cost time: 2.9224770069122314
Epoch: 3, Steps: 16 | Train Loss: 0.249 Vali Loss: 9.332 Vali Acc: 0.382 Test Loss: 9.332 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0247178077697754
Epoch: 4, Steps: 16 | Train Loss: 0.286 Vali Loss: 12.674 Vali Acc: 0.366 Test Loss: 12.674 Test Acc: 0.366
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.854154348373413
Epoch: 5, Steps: 16 | Train Loss: 0.575 Vali Loss: 14.118 Vali Acc: 0.443 Test Loss: 14.118 Test Acc: 0.443
Validation loss decreased (-0.435042 --> -0.442607).  Saving model ...
Epoch: 6 cost time: 2.62675142288208
Epoch: 6, Steps: 16 | Train Loss: 0.671 Vali Loss: 20.388 Vali Acc: 0.420 Test Loss: 20.388 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6983485221862793
Epoch: 7, Steps: 16 | Train Loss: 2.728 Vali Loss: 21.647 Vali Acc: 0.397 Test Loss: 21.647 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.805476188659668
Epoch: 8, Steps: 16 | Train Loss: 0.769 Vali Loss: 22.087 Vali Acc: 0.336 Test Loss: 22.087 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8529434204101562
Epoch: 9, Steps: 16 | Train Loss: 0.509 Vali Loss: 26.939 Vali Acc: 0.412 Test Loss: 26.939 Test Acc: 0.412
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.8550899028778076
Epoch: 10, Steps: 16 | Train Loss: 0.026 Vali Loss: 34.293 Vali Acc: 0.427 Test Loss: 34.293 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.929870843887329
Epoch: 11, Steps: 16 | Train Loss: 0.213 Vali Loss: 31.673 Vali Acc: 0.382 Test Loss: 31.673 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.971541404724121
Epoch: 12, Steps: 16 | Train Loss: 0.370 Vali Loss: 45.817 Vali Acc: 0.397 Test Loss: 45.817 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.106955051422119
Epoch: 13, Steps: 16 | Train Loss: 0.761 Vali Loss: 59.635 Vali Acc: 0.344 Test Loss: 59.635 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.261054515838623
Epoch: 14, Steps: 16 | Train Loss: 0.116 Vali Loss: 59.643 Vali Acc: 0.374 Test Loss: 59.643 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.2964882850646973
Epoch: 15, Steps: 16 | Train Loss: 0.038 Vali Loss: 65.630 Vali Acc: 0.412 Test Loss: 65.630 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1999_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324230239
model size : 1236.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1799_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.366953372955322
Epoch: 1, Steps: 16 | Train Loss: 1.966 Vali Loss: 3.693 Vali Acc: 0.359 Test Loss: 3.693 Test Acc: 0.359
Validation loss decreased (inf --> -0.358742).  Saving model ...
Epoch: 2 cost time: 2.635007858276367
Epoch: 2, Steps: 16 | Train Loss: 0.328 Vali Loss: 6.798 Vali Acc: 0.427 Test Loss: 6.798 Test Acc: 0.427
Validation loss decreased (-0.358742 --> -0.427413).  Saving model ...
Epoch: 3 cost time: 2.667281150817871
Epoch: 3, Steps: 16 | Train Loss: 0.209 Vali Loss: 7.982 Vali Acc: 0.382 Test Loss: 7.982 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9397149085998535
Epoch: 4, Steps: 16 | Train Loss: 0.337 Vali Loss: 10.007 Vali Acc: 0.511 Test Loss: 10.007 Test Acc: 0.511
Validation loss decreased (-0.427413 --> -0.511350).  Saving model ...
Epoch: 5 cost time: 2.8532960414886475
Epoch: 5, Steps: 16 | Train Loss: 0.623 Vali Loss: 15.291 Vali Acc: 0.466 Test Loss: 15.291 Test Acc: 0.466
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4810853004455566
Epoch: 6, Steps: 16 | Train Loss: 1.490 Vali Loss: 17.214 Vali Acc: 0.542 Test Loss: 17.214 Test Acc: 0.542
Validation loss decreased (-0.511350 --> -0.541813).  Saving model ...
Epoch: 7 cost time: 2.8811004161834717
Epoch: 7, Steps: 16 | Train Loss: 0.086 Vali Loss: 18.484 Vali Acc: 0.473 Test Loss: 18.484 Test Acc: 0.473
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6460020542144775
Epoch: 8, Steps: 16 | Train Loss: 0.576 Vali Loss: 19.619 Vali Acc: 0.443 Test Loss: 19.619 Test Acc: 0.443
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7368099689483643
Epoch: 9, Steps: 16 | Train Loss: 0.102 Vali Loss: 34.972 Vali Acc: 0.313 Test Loss: 34.972 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.762967824935913
Epoch: 10, Steps: 16 | Train Loss: 0.654 Vali Loss: 40.557 Vali Acc: 0.344 Test Loss: 40.557 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.9426040649414062
Epoch: 11, Steps: 16 | Train Loss: 0.329 Vali Loss: 44.727 Vali Acc: 0.336 Test Loss: 44.727 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.874997138977051
Epoch: 12, Steps: 16 | Train Loss: 0.506 Vali Loss: 41.749 Vali Acc: 0.359 Test Loss: 41.749 Test Acc: 0.359
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7530388832092285
Epoch: 13, Steps: 16 | Train Loss: 0.219 Vali Loss: 46.254 Vali Acc: 0.405 Test Loss: 46.254 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.705730676651001
Epoch: 14, Steps: 16 | Train Loss: 0.782 Vali Loss: 72.210 Vali Acc: 0.359 Test Loss: 72.210 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7582757472991943
Epoch: 15, Steps: 16 | Train Loss: 2.437 Vali Loss: 74.686 Vali Acc: 0.374 Test Loss: 74.686 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.664381980895996
Epoch: 16, Steps: 16 | Train Loss: 0.750 Vali Loss: 74.176 Vali Acc: 0.412 Test Loss: 74.176 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1799_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.5419847328244275
model parameter : 324209097
model size : 1236.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1635_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.671982526779175
Epoch: 1, Steps: 16 | Train Loss: 2.455 Vali Loss: 2.507 Vali Acc: 0.344 Test Loss: 2.507 Test Acc: 0.344
Validation loss decreased (inf --> -0.343486).  Saving model ...
Epoch: 2 cost time: 2.830048084259033
Epoch: 2, Steps: 16 | Train Loss: 0.393 Vali Loss: 6.148 Vali Acc: 0.450 Test Loss: 6.148 Test Acc: 0.450
Validation loss decreased (-0.343486 --> -0.450320).  Saving model ...
Epoch: 3 cost time: 2.7983362674713135
Epoch: 3, Steps: 16 | Train Loss: 0.668 Vali Loss: 10.717 Vali Acc: 0.366 Test Loss: 10.717 Test Acc: 0.366
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2135231494903564
Epoch: 4, Steps: 16 | Train Loss: 0.574 Vali Loss: 14.440 Vali Acc: 0.405 Test Loss: 14.440 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.396284818649292
Epoch: 5, Steps: 16 | Train Loss: 0.788 Vali Loss: 14.831 Vali Acc: 0.435 Test Loss: 14.831 Test Acc: 0.435
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.990051507949829
Epoch: 6, Steps: 16 | Train Loss: 0.136 Vali Loss: 17.495 Vali Acc: 0.366 Test Loss: 17.495 Test Acc: 0.366
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.892035961151123
Epoch: 7, Steps: 16 | Train Loss: 0.473 Vali Loss: 19.839 Vali Acc: 0.389 Test Loss: 19.839 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.9777474403381348
Epoch: 8, Steps: 16 | Train Loss: 1.482 Vali Loss: 26.783 Vali Acc: 0.405 Test Loss: 26.783 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.100522994995117
Epoch: 9, Steps: 16 | Train Loss: 0.789 Vali Loss: 33.023 Vali Acc: 0.405 Test Loss: 33.023 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.1457207202911377
Epoch: 10, Steps: 16 | Train Loss: 0.720 Vali Loss: 37.493 Vali Acc: 0.359 Test Loss: 37.493 Test Acc: 0.359
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.731191396713257
Epoch: 11, Steps: 16 | Train Loss: 2.715 Vali Loss: 55.127 Vali Acc: 0.382 Test Loss: 55.127 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.739348888397217
Epoch: 12, Steps: 16 | Train Loss: 1.660 Vali Loss: 57.807 Vali Acc: 0.397 Test Loss: 57.807 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1635_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.45038167938931295
model parameter : 324116599
model size : 1236.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1499_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.33260440826416
Epoch: 1, Steps: 16 | Train Loss: 2.032 Vali Loss: 5.069 Vali Acc: 0.260 Test Loss: 5.069 Test Acc: 0.260
Validation loss decreased (inf --> -0.259491).  Saving model ...
Epoch: 2 cost time: 2.618431806564331
Epoch: 2, Steps: 16 | Train Loss: 0.558 Vali Loss: 7.798 Vali Acc: 0.374 Test Loss: 7.798 Test Acc: 0.374
Validation loss decreased (-0.259491 --> -0.373968).  Saving model ...
Epoch: 3 cost time: 2.6793594360351562
Epoch: 3, Steps: 16 | Train Loss: 0.301 Vali Loss: 7.305 Vali Acc: 0.496 Test Loss: 7.305 Test Acc: 0.496
Validation loss decreased (-0.373968 --> -0.496110).  Saving model ...
Epoch: 4 cost time: 2.6384637355804443
Epoch: 4, Steps: 16 | Train Loss: 0.451 Vali Loss: 8.625 Vali Acc: 0.420 Test Loss: 8.625 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.590193510055542
Epoch: 5, Steps: 16 | Train Loss: 0.071 Vali Loss: 12.231 Vali Acc: 0.405 Test Loss: 12.231 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5937752723693848
Epoch: 6, Steps: 16 | Train Loss: 0.674 Vali Loss: 15.986 Vali Acc: 0.290 Test Loss: 15.986 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5313568115234375
Epoch: 7, Steps: 16 | Train Loss: 0.812 Vali Loss: 16.803 Vali Acc: 0.427 Test Loss: 16.803 Test Acc: 0.427
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.4225540161132812
Epoch: 8, Steps: 16 | Train Loss: 0.386 Vali Loss: 18.998 Vali Acc: 0.496 Test Loss: 18.998 Test Acc: 0.496
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.73207426071167
Epoch: 9, Steps: 16 | Train Loss: 0.992 Vali Loss: 27.926 Vali Acc: 0.397 Test Loss: 27.926 Test Acc: 0.397
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.6308367252349854
Epoch: 10, Steps: 16 | Train Loss: 1.969 Vali Loss: 47.761 Vali Acc: 0.397 Test Loss: 47.761 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.739720582962036
Epoch: 11, Steps: 16 | Train Loss: 0.805 Vali Loss: 71.242 Vali Acc: 0.344 Test Loss: 71.242 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6289496421813965
Epoch: 12, Steps: 16 | Train Loss: 0.353 Vali Loss: 70.311 Vali Acc: 0.328 Test Loss: 70.311 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7023046016693115
Epoch: 13, Steps: 16 | Train Loss: 0.449 Vali Loss: 61.562 Vali Acc: 0.412 Test Loss: 61.562 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1499_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4961832061068702
model parameter : 324168425
model size : 1236.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1384_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.9918434619903564
Epoch: 1, Steps: 16 | Train Loss: 1.778 Vali Loss: 4.068 Vali Acc: 0.313 Test Loss: 4.068 Test Acc: 0.313
Validation loss decreased (inf --> -0.312936).  Saving model ...
Epoch: 2 cost time: 3.0952672958374023
Epoch: 2, Steps: 16 | Train Loss: 0.398 Vali Loss: 6.724 Vali Acc: 0.427 Test Loss: 6.724 Test Acc: 0.427
Validation loss decreased (-0.312936 --> -0.427414).  Saving model ...
Epoch: 3 cost time: 2.9737586975097656
Epoch: 3, Steps: 16 | Train Loss: 0.148 Vali Loss: 9.256 Vali Acc: 0.397 Test Loss: 9.256 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9802069664001465
Epoch: 4, Steps: 16 | Train Loss: 0.345 Vali Loss: 10.412 Vali Acc: 0.305 Test Loss: 10.412 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7812321186065674
Epoch: 5, Steps: 16 | Train Loss: 0.050 Vali Loss: 11.492 Vali Acc: 0.420 Test Loss: 11.492 Test Acc: 0.420
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.851961612701416
Epoch: 6, Steps: 16 | Train Loss: 0.195 Vali Loss: 13.348 Vali Acc: 0.443 Test Loss: 13.348 Test Acc: 0.443
Validation loss decreased (-0.427414 --> -0.442615).  Saving model ...
Epoch: 7 cost time: 2.8129022121429443
Epoch: 7, Steps: 16 | Train Loss: 0.024 Vali Loss: 16.680 Vali Acc: 0.443 Test Loss: 16.680 Test Acc: 0.443
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.781015396118164
Epoch: 8, Steps: 16 | Train Loss: 1.362 Vali Loss: 18.575 Vali Acc: 0.420 Test Loss: 18.575 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.932980537414551
Epoch: 9, Steps: 16 | Train Loss: 1.316 Vali Loss: 24.465 Vali Acc: 0.397 Test Loss: 24.465 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.996168613433838
Epoch: 10, Steps: 16 | Train Loss: 1.722 Vali Loss: 30.991 Vali Acc: 0.389 Test Loss: 30.991 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6580913066864014
Epoch: 11, Steps: 16 | Train Loss: 0.815 Vali Loss: 40.485 Vali Acc: 0.397 Test Loss: 40.485 Test Acc: 0.397
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.820796489715576
Epoch: 12, Steps: 16 | Train Loss: 1.150 Vali Loss: 54.411 Vali Acc: 0.344 Test Loss: 54.411 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.790372848510742
Epoch: 13, Steps: 16 | Train Loss: 1.740 Vali Loss: 111.541 Vali Acc: 0.321 Test Loss: 111.541 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.9120495319366455
Epoch: 14, Steps: 16 | Train Loss: 0.440 Vali Loss: 114.218 Vali Acc: 0.336 Test Loss: 114.218 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.7304186820983887
Epoch: 15, Steps: 16 | Train Loss: 0.882 Vali Loss: 132.519 Vali Acc: 0.305 Test Loss: 132.519 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8354454040527344
Epoch: 16, Steps: 16 | Train Loss: 0.303 Vali Loss: 155.033 Vali Acc: 0.305 Test Loss: 155.033 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1384_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.44274809160305345
model parameter : 324238575
model size : 1236.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1285_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.553598642349243
Epoch: 1, Steps: 16 | Train Loss: 1.615 Vali Loss: 3.544 Vali Acc: 0.313 Test Loss: 3.544 Test Acc: 0.313
Validation loss decreased (inf --> -0.312942).  Saving model ...
Epoch: 2 cost time: 2.9723963737487793
Epoch: 2, Steps: 16 | Train Loss: 0.569 Vali Loss: 5.789 Vali Acc: 0.382 Test Loss: 5.789 Test Acc: 0.382
Validation loss decreased (-0.312942 --> -0.381621).  Saving model ...
Epoch: 3 cost time: 2.7228548526763916
Epoch: 3, Steps: 16 | Train Loss: 0.376 Vali Loss: 8.506 Vali Acc: 0.305 Test Loss: 8.506 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.737274646759033
Epoch: 4, Steps: 16 | Train Loss: 0.294 Vali Loss: 12.223 Vali Acc: 0.351 Test Loss: 12.223 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.994429111480713
Epoch: 5, Steps: 16 | Train Loss: 0.008 Vali Loss: 13.080 Vali Acc: 0.344 Test Loss: 13.080 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9870765209198
Epoch: 6, Steps: 16 | Train Loss: 0.052 Vali Loss: 14.614 Vali Acc: 0.466 Test Loss: 14.614 Test Acc: 0.466
Validation loss decreased (-0.381621 --> -0.465503).  Saving model ...
Epoch: 7 cost time: 2.9629461765289307
Epoch: 7, Steps: 16 | Train Loss: 0.103 Vali Loss: 14.876 Vali Acc: 0.450 Test Loss: 14.876 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.8573195934295654
Epoch: 8, Steps: 16 | Train Loss: 0.504 Vali Loss: 17.986 Vali Acc: 0.382 Test Loss: 17.986 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.001502275466919
Epoch: 9, Steps: 16 | Train Loss: 1.118 Vali Loss: 23.695 Vali Acc: 0.412 Test Loss: 23.695 Test Acc: 0.412
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.783998966217041
Epoch: 10, Steps: 16 | Train Loss: 0.611 Vali Loss: 26.491 Vali Acc: 0.420 Test Loss: 26.491 Test Acc: 0.420
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.812051296234131
Epoch: 11, Steps: 16 | Train Loss: 0.963 Vali Loss: 32.827 Vali Acc: 0.389 Test Loss: 32.827 Test Acc: 0.389
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8365793228149414
Epoch: 12, Steps: 16 | Train Loss: 0.874 Vali Loss: 77.075 Vali Acc: 0.443 Test Loss: 77.075 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.8216941356658936
Epoch: 13, Steps: 16 | Train Loss: 0.862 Vali Loss: 100.706 Vali Acc: 0.450 Test Loss: 100.706 Test Acc: 0.450
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7456278800964355
Epoch: 14, Steps: 16 | Train Loss: 1.108 Vali Loss: 115.155 Vali Acc: 0.351 Test Loss: 115.155 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.0403358936309814
Epoch: 15, Steps: 16 | Train Loss: 3.645 Vali Loss: 112.963 Vali Acc: 0.382 Test Loss: 112.963 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.7591121196746826
Epoch: 16, Steps: 16 | Train Loss: 1.331 Vali Loss: 114.873 Vali Acc: 0.366 Test Loss: 114.873 Test Acc: 0.366
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1285_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324201081
model size : 1236.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1199_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.081916809082031
Epoch: 1, Steps: 16 | Train Loss: 1.975 Vali Loss: 4.571 Vali Acc: 0.405 Test Loss: 4.571 Test Acc: 0.405
Validation loss decreased (inf --> -0.404534).  Saving model ...
Epoch: 2 cost time: 2.713674306869507
Epoch: 2, Steps: 16 | Train Loss: 0.498 Vali Loss: 9.082 Vali Acc: 0.374 Test Loss: 9.082 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8414175510406494
Epoch: 3, Steps: 16 | Train Loss: 0.408 Vali Loss: 13.454 Vali Acc: 0.389 Test Loss: 13.454 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.612213134765625
Epoch: 4, Steps: 16 | Train Loss: 0.932 Vali Loss: 13.949 Vali Acc: 0.450 Test Loss: 13.949 Test Acc: 0.450
Validation loss decreased (-0.404534 --> -0.450242).  Saving model ...
Epoch: 5 cost time: 2.838942766189575
Epoch: 5, Steps: 16 | Train Loss: 0.510 Vali Loss: 15.083 Vali Acc: 0.420 Test Loss: 15.083 Test Acc: 0.420
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.880654811859131
Epoch: 6, Steps: 16 | Train Loss: 0.029 Vali Loss: 16.340 Vali Acc: 0.458 Test Loss: 16.340 Test Acc: 0.458
Validation loss decreased (-0.450242 --> -0.457852).  Saving model ...
Epoch: 7 cost time: 2.8076894283294678
Epoch: 7, Steps: 16 | Train Loss: 0.350 Vali Loss: 19.929 Vali Acc: 0.435 Test Loss: 19.929 Test Acc: 0.435
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.730463981628418
Epoch: 8, Steps: 16 | Train Loss: 0.137 Vali Loss: 21.543 Vali Acc: 0.374 Test Loss: 21.543 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7611591815948486
Epoch: 9, Steps: 16 | Train Loss: 0.017 Vali Loss: 21.877 Vali Acc: 0.397 Test Loss: 21.877 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6452224254608154
Epoch: 10, Steps: 16 | Train Loss: 0.251 Vali Loss: 28.043 Vali Acc: 0.389 Test Loss: 28.043 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.763828754425049
Epoch: 11, Steps: 16 | Train Loss: 0.759 Vali Loss: 37.134 Vali Acc: 0.427 Test Loss: 37.134 Test Acc: 0.427
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.8173437118530273
Epoch: 12, Steps: 16 | Train Loss: 3.390 Vali Loss: 39.194 Vali Acc: 0.366 Test Loss: 39.194 Test Acc: 0.366
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7978031635284424
Epoch: 13, Steps: 16 | Train Loss: 2.150 Vali Loss: 50.792 Vali Acc: 0.389 Test Loss: 50.792 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6859934329986572
Epoch: 14, Steps: 16 | Train Loss: 0.370 Vali Loss: 59.772 Vali Acc: 0.374 Test Loss: 59.772 Test Acc: 0.374
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.89198899269104
Epoch: 15, Steps: 16 | Train Loss: 0.935 Vali Loss: 69.866 Vali Acc: 0.382 Test Loss: 69.866 Test Acc: 0.382
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.8050761222839355
Epoch: 16, Steps: 16 | Train Loss: 0.398 Vali Loss: 73.004 Vali Acc: 0.405 Test Loss: 73.004 Test Acc: 0.405
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1199_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324109847
model size : 1236.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1124_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.264085531234741
Epoch: 1, Steps: 16 | Train Loss: 2.423 Vali Loss: 2.952 Vali Acc: 0.305 Test Loss: 2.952 Test Acc: 0.305
Validation loss decreased (inf --> -0.305314).  Saving model ...
Epoch: 2 cost time: 2.5656869411468506
Epoch: 2, Steps: 16 | Train Loss: 0.379 Vali Loss: 6.554 Vali Acc: 0.481 Test Loss: 6.554 Test Acc: 0.481
Validation loss decreased (-0.305314 --> -0.480850).  Saving model ...
Epoch: 3 cost time: 2.907292604446411
Epoch: 3, Steps: 16 | Train Loss: 0.286 Vali Loss: 7.367 Vali Acc: 0.374 Test Loss: 7.367 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.044445753097534
Epoch: 4, Steps: 16 | Train Loss: 0.042 Vali Loss: 11.102 Vali Acc: 0.359 Test Loss: 11.102 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.899040699005127
Epoch: 5, Steps: 16 | Train Loss: 0.255 Vali Loss: 11.474 Vali Acc: 0.427 Test Loss: 11.474 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7303900718688965
Epoch: 6, Steps: 16 | Train Loss: 0.441 Vali Loss: 11.401 Vali Acc: 0.458 Test Loss: 11.401 Test Acc: 0.458
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.1443569660186768
Epoch: 7, Steps: 16 | Train Loss: 0.374 Vali Loss: 15.699 Vali Acc: 0.443 Test Loss: 15.699 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.80535888671875
Epoch: 8, Steps: 16 | Train Loss: 0.836 Vali Loss: 32.235 Vali Acc: 0.443 Test Loss: 32.235 Test Acc: 0.443
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9476544857025146
Epoch: 9, Steps: 16 | Train Loss: 2.169 Vali Loss: 53.246 Vali Acc: 0.366 Test Loss: 53.246 Test Acc: 0.366
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.897770881652832
Epoch: 10, Steps: 16 | Train Loss: 2.176 Vali Loss: 55.702 Vali Acc: 0.412 Test Loss: 55.702 Test Acc: 0.412
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.7650561332702637
Epoch: 11, Steps: 16 | Train Loss: 3.384 Vali Loss: 46.309 Vali Acc: 0.374 Test Loss: 46.309 Test Acc: 0.374
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.672905921936035
Epoch: 12, Steps: 16 | Train Loss: 1.598 Vali Loss: 42.377 Vali Acc: 0.427 Test Loss: 42.377 Test Acc: 0.427
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1124_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48091603053435117
model parameter : 324090729
model size : 1236.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1058_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.667769908905029
Epoch: 1, Steps: 16 | Train Loss: 2.260 Vali Loss: 3.140 Vali Acc: 0.282 Test Loss: 3.140 Test Acc: 0.282
Validation loss decreased (inf --> -0.282411).  Saving model ...
Epoch: 2 cost time: 2.7170615196228027
Epoch: 2, Steps: 16 | Train Loss: 0.500 Vali Loss: 6.115 Vali Acc: 0.351 Test Loss: 6.115 Test Acc: 0.351
Validation loss decreased (-0.282411 --> -0.351084).  Saving model ...
Epoch: 3 cost time: 2.8138508796691895
Epoch: 3, Steps: 16 | Train Loss: 0.260 Vali Loss: 8.805 Vali Acc: 0.374 Test Loss: 8.805 Test Acc: 0.374
Validation loss decreased (-0.351084 --> -0.373958).  Saving model ...
Epoch: 4 cost time: 2.9017624855041504
Epoch: 4, Steps: 16 | Train Loss: 0.089 Vali Loss: 8.764 Vali Acc: 0.397 Test Loss: 8.764 Test Acc: 0.397
Validation loss decreased (-0.373958 --> -0.396859).  Saving model ...
Epoch: 5 cost time: 2.783052444458008
Epoch: 5, Steps: 16 | Train Loss: 0.144 Vali Loss: 11.255 Vali Acc: 0.435 Test Loss: 11.255 Test Acc: 0.435
Validation loss decreased (-0.396859 --> -0.435002).  Saving model ...
Epoch: 6 cost time: 2.7413296699523926
Epoch: 6, Steps: 16 | Train Loss: 0.216 Vali Loss: 14.461 Vali Acc: 0.427 Test Loss: 14.461 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.966095209121704
Epoch: 7, Steps: 16 | Train Loss: 0.737 Vali Loss: 15.980 Vali Acc: 0.458 Test Loss: 15.980 Test Acc: 0.458
Validation loss decreased (-0.435002 --> -0.457855).  Saving model ...
Epoch: 8 cost time: 2.8774538040161133
Epoch: 8, Steps: 16 | Train Loss: 0.815 Vali Loss: 22.012 Vali Acc: 0.427 Test Loss: 22.012 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8694231510162354
Epoch: 9, Steps: 16 | Train Loss: 0.396 Vali Loss: 28.029 Vali Acc: 0.405 Test Loss: 28.029 Test Acc: 0.405
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.734954357147217
Epoch: 10, Steps: 16 | Train Loss: 0.811 Vali Loss: 40.600 Vali Acc: 0.389 Test Loss: 40.600 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8687756061553955
Epoch: 11, Steps: 16 | Train Loss: 0.817 Vali Loss: 73.568 Vali Acc: 0.389 Test Loss: 73.568 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.881910800933838
Epoch: 12, Steps: 16 | Train Loss: 1.514 Vali Loss: 88.928 Vali Acc: 0.420 Test Loss: 88.928 Test Acc: 0.420
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6678764820098877
Epoch: 13, Steps: 16 | Train Loss: 0.571 Vali Loss: 75.843 Vali Acc: 0.405 Test Loss: 75.843 Test Acc: 0.405
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.788865804672241
Epoch: 14, Steps: 16 | Train Loss: 1.673 Vali Loss: 79.610 Vali Acc: 0.374 Test Loss: 79.610 Test Acc: 0.374
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8590972423553467
Epoch: 15, Steps: 16 | Train Loss: 1.109 Vali Loss: 86.633 Vali Acc: 0.397 Test Loss: 86.633 Test Acc: 0.397
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.9264276027679443
Epoch: 16, Steps: 16 | Train Loss: 1.177 Vali Loss: 94.276 Vali Acc: 0.412 Test Loss: 94.276 Test Acc: 0.412
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.737726926803589
Epoch: 17, Steps: 16 | Train Loss: 0.000 Vali Loss: 102.405 Vali Acc: 0.397 Test Loss: 102.405 Test Acc: 0.397
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1058_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4580152671755725
model parameter : 324125711
model size : 1236.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1000_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.148991584777832
Epoch: 1, Steps: 16 | Train Loss: 1.920 Vali Loss: 2.513 Vali Acc: 0.466 Test Loss: 2.513 Test Acc: 0.466
Validation loss decreased (inf --> -0.465624).  Saving model ...
Epoch: 2 cost time: 2.7243125438690186
Epoch: 2, Steps: 16 | Train Loss: 0.332 Vali Loss: 9.979 Vali Acc: 0.427 Test Loss: 9.979 Test Acc: 0.427
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.766735315322876
Epoch: 3, Steps: 16 | Train Loss: 0.394 Vali Loss: 14.696 Vali Acc: 0.397 Test Loss: 14.696 Test Acc: 0.397
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.7988107204437256
Epoch: 4, Steps: 16 | Train Loss: 0.356 Vali Loss: 16.544 Vali Acc: 0.397 Test Loss: 16.544 Test Acc: 0.397
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.674484968185425
Epoch: 5, Steps: 16 | Train Loss: 0.326 Vali Loss: 18.748 Vali Acc: 0.466 Test Loss: 18.748 Test Acc: 0.466
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.6725544929504395
Epoch: 6, Steps: 16 | Train Loss: 1.396 Vali Loss: 22.043 Vali Acc: 0.473 Test Loss: 22.043 Test Acc: 0.473
Validation loss decreased (-0.465624 --> -0.473062).  Saving model ...
Epoch: 7 cost time: 2.87919020652771
Epoch: 7, Steps: 16 | Train Loss: 0.500 Vali Loss: 26.451 Vali Acc: 0.389 Test Loss: 26.451 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.802776336669922
Epoch: 8, Steps: 16 | Train Loss: 0.586 Vali Loss: 31.412 Vali Acc: 0.450 Test Loss: 31.412 Test Acc: 0.450
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7556405067443848
Epoch: 9, Steps: 16 | Train Loss: 0.274 Vali Loss: 39.537 Vali Acc: 0.389 Test Loss: 39.537 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7040486335754395
Epoch: 10, Steps: 16 | Train Loss: 0.347 Vali Loss: 44.792 Vali Acc: 0.389 Test Loss: 44.792 Test Acc: 0.389
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.6266119480133057
Epoch: 11, Steps: 16 | Train Loss: 0.473 Vali Loss: 42.497 Vali Acc: 0.359 Test Loss: 42.497 Test Acc: 0.359
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7228877544403076
Epoch: 12, Steps: 16 | Train Loss: 0.349 Vali Loss: 46.901 Vali Acc: 0.382 Test Loss: 46.901 Test Acc: 0.382
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7379846572875977
Epoch: 13, Steps: 16 | Train Loss: 1.739 Vali Loss: 84.898 Vali Acc: 0.420 Test Loss: 84.898 Test Acc: 0.420
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.650963544845581
Epoch: 14, Steps: 16 | Train Loss: 0.994 Vali Loss: 97.914 Vali Acc: 0.405 Test Loss: 97.914 Test Acc: 0.405
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.790553092956543
Epoch: 15, Steps: 16 | Train Loss: 1.503 Vali Loss: 91.450 Vali Acc: 0.359 Test Loss: 91.450 Test Acc: 0.359
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6388065814971924
Epoch: 16, Steps: 16 | Train Loss: 2.023 Vali Loss: 114.303 Vali Acc: 0.359 Test Loss: 114.303 Test Acc: 0.359
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs1000_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324376633
model size : 1237.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs947_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 5.2728002071380615
Epoch: 1, Steps: 16 | Train Loss: 1.949 Vali Loss: 3.814 Vali Acc: 0.344 Test Loss: 3.814 Test Acc: 0.344
Validation loss decreased (inf --> -0.343473).  Saving model ...
Epoch: 2 cost time: 2.7108335494995117
Epoch: 2, Steps: 16 | Train Loss: 0.295 Vali Loss: 6.479 Vali Acc: 0.397 Test Loss: 6.479 Test Acc: 0.397
Validation loss decreased (-0.343473 --> -0.396882).  Saving model ...
Epoch: 3 cost time: 2.699657678604126
Epoch: 3, Steps: 16 | Train Loss: 0.223 Vali Loss: 8.215 Vali Acc: 0.397 Test Loss: 8.215 Test Acc: 0.397
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.589712142944336
Epoch: 4, Steps: 16 | Train Loss: 0.454 Vali Loss: 8.939 Vali Acc: 0.473 Test Loss: 8.939 Test Acc: 0.473
Validation loss decreased (-0.396882 --> -0.473193).  Saving model ...
Epoch: 5 cost time: 2.676159143447876
Epoch: 5, Steps: 16 | Train Loss: 0.378 Vali Loss: 12.356 Vali Acc: 0.412 Test Loss: 12.356 Test Acc: 0.412
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8496413230895996
Epoch: 6, Steps: 16 | Train Loss: 0.449 Vali Loss: 16.345 Vali Acc: 0.290 Test Loss: 16.345 Test Acc: 0.290
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.184504270553589
Epoch: 7, Steps: 16 | Train Loss: 0.526 Vali Loss: 23.581 Vali Acc: 0.290 Test Loss: 23.581 Test Acc: 0.290
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8201797008514404
Epoch: 8, Steps: 16 | Train Loss: 2.503 Vali Loss: 30.875 Vali Acc: 0.435 Test Loss: 30.875 Test Acc: 0.435
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.74957013130188
Epoch: 9, Steps: 16 | Train Loss: 0.483 Vali Loss: 40.330 Vali Acc: 0.351 Test Loss: 40.330 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.9381778240203857
Epoch: 10, Steps: 16 | Train Loss: 1.601 Vali Loss: 48.684 Vali Acc: 0.458 Test Loss: 48.684 Test Acc: 0.458
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6936187744140625
Epoch: 11, Steps: 16 | Train Loss: 0.495 Vali Loss: 59.557 Vali Acc: 0.397 Test Loss: 59.557 Test Acc: 0.397
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9194693565368652
Epoch: 12, Steps: 16 | Train Loss: 0.600 Vali Loss: 57.214 Vali Acc: 0.313 Test Loss: 57.214 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.9000422954559326
Epoch: 13, Steps: 16 | Train Loss: 1.329 Vali Loss: 62.989 Vali Acc: 0.366 Test Loss: 62.989 Test Acc: 0.366
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.819833755493164
Epoch: 14, Steps: 16 | Train Loss: 0.265 Vali Loss: 69.614 Vali Acc: 0.389 Test Loss: 69.614 Test Acc: 0.389
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs947_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.4732824427480916
model parameter : 324249975
model size : 1236.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs900_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 3.6103031635284424
Epoch: 1, Steps: 16 | Train Loss: 1.789 Vali Loss: 3.060 Vali Acc: 0.397 Test Loss: 3.060 Test Acc: 0.397
Validation loss decreased (inf --> -0.396916).  Saving model ...
Epoch: 2 cost time: 2.615079879760742
Epoch: 2, Steps: 16 | Train Loss: 0.565 Vali Loss: 6.783 Vali Acc: 0.420 Test Loss: 6.783 Test Acc: 0.420
Validation loss decreased (-0.396916 --> -0.419779).  Saving model ...
Epoch: 3 cost time: 2.799463987350464
Epoch: 3, Steps: 16 | Train Loss: 0.215 Vali Loss: 9.765 Vali Acc: 0.466 Test Loss: 9.765 Test Acc: 0.466
Validation loss decreased (-0.419779 --> -0.465551).  Saving model ...
Epoch: 4 cost time: 2.7930781841278076
Epoch: 4, Steps: 16 | Train Loss: 0.506 Vali Loss: 9.752 Vali Acc: 0.389 Test Loss: 9.752 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.630288600921631
Epoch: 5, Steps: 16 | Train Loss: 0.324 Vali Loss: 15.239 Vali Acc: 0.374 Test Loss: 15.239 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7894351482391357
Epoch: 6, Steps: 16 | Train Loss: 0.527 Vali Loss: 15.239 Vali Acc: 0.427 Test Loss: 15.239 Test Acc: 0.427
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7703776359558105
Epoch: 7, Steps: 16 | Train Loss: 0.449 Vali Loss: 17.346 Vali Acc: 0.397 Test Loss: 17.346 Test Acc: 0.397
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.724062442779541
Epoch: 8, Steps: 16 | Train Loss: 0.487 Vali Loss: 19.694 Vali Acc: 0.443 Test Loss: 19.694 Test Acc: 0.443
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.763943910598755
Epoch: 9, Steps: 16 | Train Loss: 6.444 Vali Loss: 38.507 Vali Acc: 0.305 Test Loss: 38.507 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.698674201965332
Epoch: 10, Steps: 16 | Train Loss: 1.472 Vali Loss: 50.159 Vali Acc: 0.405 Test Loss: 50.159 Test Acc: 0.405
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.6122887134552
Epoch: 11, Steps: 16 | Train Loss: 0.270 Vali Loss: 52.597 Vali Acc: 0.427 Test Loss: 52.597 Test Acc: 0.427
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.9284651279449463
Epoch: 12, Steps: 16 | Train Loss: 0.221 Vali Loss: 54.326 Vali Acc: 0.351 Test Loss: 54.326 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.8329989910125732
Epoch: 13, Steps: 16 | Train Loss: 0.443 Vali Loss: 65.571 Vali Acc: 0.412 Test Loss: 65.571 Test Acc: 0.412
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs900_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.46564885496183206
model parameter : 324375193
model size : 1237.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EigenWorms      Model:              LightTS             

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EigenWorms
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         8                   
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                3                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

128
131
>>>>>>>start training : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs857_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
128
131
131
Epoch: 1 cost time: 4.237304210662842
Epoch: 1, Steps: 16 | Train Loss: 1.943 Vali Loss: 3.283 Vali Acc: 0.244 Test Loss: 3.283 Test Acc: 0.244
Validation loss decreased (inf --> -0.244242).  Saving model ...
Epoch: 2 cost time: 2.7744157314300537
Epoch: 2, Steps: 16 | Train Loss: 0.661 Vali Loss: 6.184 Vali Acc: 0.359 Test Loss: 6.184 Test Acc: 0.359
Validation loss decreased (-0.244242 --> -0.358717).  Saving model ...
Epoch: 3 cost time: 2.7709176540374756
Epoch: 3, Steps: 16 | Train Loss: 0.240 Vali Loss: 11.018 Vali Acc: 0.489 Test Loss: 11.018 Test Acc: 0.489
Validation loss decreased (-0.358717 --> -0.488439).  Saving model ...
Epoch: 4 cost time: 2.8024327754974365
Epoch: 4, Steps: 16 | Train Loss: 0.362 Vali Loss: 11.652 Vali Acc: 0.450 Test Loss: 11.652 Test Acc: 0.450
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.783407211303711
Epoch: 5, Steps: 16 | Train Loss: 0.231 Vali Loss: 13.315 Vali Acc: 0.389 Test Loss: 13.315 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7444167137145996
Epoch: 6, Steps: 16 | Train Loss: 0.454 Vali Loss: 15.603 Vali Acc: 0.328 Test Loss: 15.603 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.917332887649536
Epoch: 7, Steps: 16 | Train Loss: 0.728 Vali Loss: 20.562 Vali Acc: 0.359 Test Loss: 20.562 Test Acc: 0.359
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.7843377590179443
Epoch: 8, Steps: 16 | Train Loss: 0.383 Vali Loss: 24.274 Vali Acc: 0.405 Test Loss: 24.274 Test Acc: 0.405
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.659116744995117
Epoch: 9, Steps: 16 | Train Loss: 0.601 Vali Loss: 26.962 Vali Acc: 0.305 Test Loss: 26.962 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.582766532897949
Epoch: 10, Steps: 16 | Train Loss: 0.875 Vali Loss: 36.454 Vali Acc: 0.389 Test Loss: 36.454 Test Acc: 0.389
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7263600826263428
Epoch: 11, Steps: 16 | Train Loss: 0.956 Vali Loss: 46.740 Vali Acc: 0.420 Test Loss: 46.740 Test Acc: 0.420
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.774148464202881
Epoch: 12, Steps: 16 | Train Loss: 1.101 Vali Loss: 46.746 Vali Acc: 0.450 Test Loss: 46.746 Test Acc: 0.450
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.7431466579437256
Epoch: 13, Steps: 16 | Train Loss: 2.407 Vali Loss: 64.889 Vali Acc: 0.435 Test Loss: 64.889 Test Acc: 0.435
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EigenWorms_LightTS_UEA_ftM_sl17984_ll0_pl0_dm32_cs857_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
131
test shape: torch.Size([131, 5]) torch.Size([131, 1])
accuracy:0.48854961832061067
model parameter : 324320639
model size : 1237.20MB
